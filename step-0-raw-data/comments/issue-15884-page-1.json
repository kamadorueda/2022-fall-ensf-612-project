[
  {
    "author_association": "CONTRIBUTOR",
    "body": "Switch parameters _explicitly_ and _inherently_ cannot be bound positionally. The workarounds are legion.\r\n\r\n- use `$using:force` instead of passing a parameter at all\r\n- use a boolean parameter instead of a switch when you're writing an Invoke-Command scriptblock, since you know all the parameters _must_ be bound positionally...\r\n- prefix it with `[Parameter(Position=0)]` to make it positional",
    "created_at": "2021-08-23T04:47:50Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15884#issuecomment-903439682",
    "id": 903439682,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15884",
    "node_id": "IC_kwDOAvT7bc412WVC",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/903439682/reactions"
    },
    "updated_at": "2021-08-23T04:48:31Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/903439682",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/192942?v=4",
      "events_url": "https://api.github.com/users/Jaykul/events{/privacy}",
      "followers_url": "https://api.github.com/users/Jaykul/followers",
      "following_url": "https://api.github.com/users/Jaykul/following{/other_user}",
      "gists_url": "https://api.github.com/users/Jaykul/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Jaykul",
      "id": 192942,
      "login": "Jaykul",
      "node_id": "MDQ6VXNlcjE5Mjk0Mg==",
      "organizations_url": "https://api.github.com/users/Jaykul/orgs",
      "received_events_url": "https://api.github.com/users/Jaykul/received_events",
      "repos_url": "https://api.github.com/users/Jaykul/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Jaykul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Jaykul/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Jaykul"
    }
  },
  {
    "author_association": "NONE",
    "body": "@Jaykul I appreciate the response; can you expound upon how you gained this knowledge? Are there other parameters that are affected by this?\r\n\r\n> Switch parameters explicitly and inherently cannot be bound positionally.\r\n\r\nI was attempting to do more research on my own to find where this might be documented and ran across this old post: \r\n\r\nhttps://devblogs.microsoft.com/powershell/how-and-why-to-use-splatting-passing-switch-parameters/\r\n\r\nI suspect that it works because even though it is using [splatting](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_splatting?view=powershell-7.1), it is using the `HashTable` behavior as opposed to the `Array` behavior which would have made it positional.\r\n\r\nAs far as this issue itself, not sure what to do here. I think this is `by-design` and perhaps just closing the issue with a comment to that effect is good enough? Would it be worth documenting anywhere?\n\n<blockquote><img src=\"https://devblogs.microsoft.com/wp-content/uploads/sites/30/2018/09/Powershell_256.png\" width=\"48\" align=\"right\"><div><img src=\"https://devblogs.microsoft.com/powershell/wp-content/uploads/sites/30/2019/02/Powershell_2561.png\" height=\"14\"> PowerShell Team</div><div><strong><a href=\"https://devblogs.microsoft.com/powershell/how-and-why-to-use-splatting-passing-switch-parameters/\">How and Why to Use Splatting (passing [switch] parameters)</a></strong></div><div>On our internal discussion list, someone just asked about how to pass switch parameters from one function to another.  This person asked this as \"Why can’t [switch] parameters be passed as parameters?\". My short answer was simple: \"They Can Be\" Answering this question is a great way to illustrate the value of a PowerShell V2 feature called Splatting. </div></blockquote>",
    "created_at": "2021-08-23T12:55:08Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15884#issuecomment-903738497",
    "id": 903738497,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15884",
    "node_id": "IC_kwDOAvT7bc413fSB",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/903738497/reactions"
    },
    "updated_at": "2021-08-23T12:55:10Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/903738497",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/2592881?v=4",
      "events_url": "https://api.github.com/users/aolszowka/events{/privacy}",
      "followers_url": "https://api.github.com/users/aolszowka/followers",
      "following_url": "https://api.github.com/users/aolszowka/following{/other_user}",
      "gists_url": "https://api.github.com/users/aolszowka/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/aolszowka",
      "id": 2592881,
      "login": "aolszowka",
      "node_id": "MDQ6VXNlcjI1OTI4ODE=",
      "organizations_url": "https://api.github.com/users/aolszowka/orgs",
      "received_events_url": "https://api.github.com/users/aolszowka/received_events",
      "repos_url": "https://api.github.com/users/aolszowka/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/aolszowka/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aolszowka/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/aolszowka"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "It might be worth documenting in one of the remoting articles, or even for Invoke-Command itself. Would also bear mentioning here as well: https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_functions_advanced_parameters?view=powershell-7.1#switch-parameters\n\n<blockquote><img src=\"https://docs.microsoft.com/media/logos/logo-powershell-social.png\" width=\"48\" align=\"right\"><div><strong><a href=\"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_functions_advanced_parameters\">about Functions Advanced Parameters - PowerShell</a></strong></div><div>Explains how to add parameters to advanced functions.</div></blockquote>",
    "created_at": "2021-08-23T18:01:42Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15884#issuecomment-903990705",
    "id": 903990705,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15884",
    "node_id": "IC_kwDOAvT7bc414c2x",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/903990705/reactions"
    },
    "updated_at": "2021-08-23T18:01:44Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/903990705",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/32407840?v=4",
      "events_url": "https://api.github.com/users/vexx32/events{/privacy}",
      "followers_url": "https://api.github.com/users/vexx32/followers",
      "following_url": "https://api.github.com/users/vexx32/following{/other_user}",
      "gists_url": "https://api.github.com/users/vexx32/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vexx32",
      "id": 32407840,
      "login": "vexx32",
      "node_id": "MDQ6VXNlcjMyNDA3ODQw",
      "organizations_url": "https://api.github.com/users/vexx32/orgs",
      "received_events_url": "https://api.github.com/users/vexx32/received_events",
      "repos_url": "https://api.github.com/users/vexx32/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vexx32/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vexx32/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vexx32"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "WG-Remoting:\r\nMarking this as needing documentation.",
    "created_at": "2021-08-23T20:44:14Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15884#issuecomment-904113716",
    "id": 904113716,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15884",
    "node_id": "IC_kwDOAvT7bc414640",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/904113716/reactions"
    },
    "updated_at": "2021-08-23T20:44:14Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/904113716",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/14019529?v=4",
      "events_url": "https://api.github.com/users/PaulHigin/events{/privacy}",
      "followers_url": "https://api.github.com/users/PaulHigin/followers",
      "following_url": "https://api.github.com/users/PaulHigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulHigin/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/PaulHigin",
      "id": 14019529,
      "login": "PaulHigin",
      "node_id": "MDQ6VXNlcjE0MDE5NTI5",
      "organizations_url": "https://api.github.com/users/PaulHigin/orgs",
      "received_events_url": "https://api.github.com/users/PaulHigin/received_events",
      "repos_url": "https://api.github.com/users/PaulHigin/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/PaulHigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulHigin/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/PaulHigin"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Hmm. That's always a fun question: how do you know that?\r\n\r\nI'm honestly not sure how I learned that initially. I noticed it again recently while prototyping ... I was working on something recently in Pester where I needed to replicate positional parameters. I \"knew\" how it worked, but as usual, I prototyped in the terminal to validate my knowledge, and I wrote something like this:\r\n\r\n```PowerShell\r\nfunction Test-Parameter {\r\n  [CmdletBinding()]param(\r\n    [string]$Path,\r\n    [switch]$Force,\r\n    [string]$Destination\r\n  )\r\n}\r\n```\r\n\r\nAnd then ran this to get positional parameters:\r\n\r\n```PowerShell\r\n(Get-Command Test-Parameter).Parameters.Values.Where{ $_.Attributes.Position -ge 0 }\r\n```\r\n\r\n```output\r\n\r\nName            : Path\r\nParameterType   : System.String\r\nParameterSets   : {[__AllParameterSets, System.Management.Automation.ParameterSetMetadata]}\r\nIsDynamic       : False\r\nAliases         : {}\r\nAttributes      : {, System.Management.Automation.ArgumentTypeConverterAttribute}\r\nSwitchParameter : False\r\n\r\nName            : Destination\r\nParameterType   : System.String\r\nParameterSets   : {[__AllParameterSets, System.Management.Automation.ParameterSetMetadata]}\r\nIsDynamic       : False\r\nAliases         : {}\r\nAttributes      : {, System.Management.Automation.ArgumentTypeConverterAttribute}\r\nSwitchParameter : False\r\n\r\n```\r\n\r\nIf you run that without the `.Where` filter, you'll see all the \"built in\" parameters and switch(es), but when you filter for positional parameters, it skips over the `Force` switch. PowerShell adds implicit `[Parameter()]` and `[ArguymentTypeConverter()]` attributes on all parameters, but the implicit ParameterAttribute does not include a Position value for switches (or rather, it's set to `[int]::MinValue`). I was relieved by that (and slightly surprised by the \"ExperimentName\" and \"ExperimentAction\" fields that I had never seen before) and it stuck with me.\r\n\r\nI also know that in C# [the type documentation](https://docs.microsoft.com/en-us/dotnet/api/system.management.automation.switchparameter?view=powershellsdk-7.0.0) says it \"can **only** be used as a switch\" (emphasis mine), so that's clearer than the PowerShell about doc.\r\n\r\nI just opened [a PR against the about topic](https://github.com/MicrosoftDocs/PowerShell-Docs/pull/8027) to make it clearer there.",
    "created_at": "2021-08-28T17:36:18Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15884#issuecomment-907660218",
    "id": 907660218,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15884",
    "node_id": "IC_kwDOAvT7bc42Gcu6",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/907660218/reactions"
    },
    "updated_at": "2021-08-28T17:36:18Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/907660218",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/192942?v=4",
      "events_url": "https://api.github.com/users/Jaykul/events{/privacy}",
      "followers_url": "https://api.github.com/users/Jaykul/followers",
      "following_url": "https://api.github.com/users/Jaykul/following{/other_user}",
      "gists_url": "https://api.github.com/users/Jaykul/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Jaykul",
      "id": 192942,
      "login": "Jaykul",
      "node_id": "MDQ6VXNlcjE5Mjk0Mg==",
      "organizations_url": "https://api.github.com/users/Jaykul/orgs",
      "received_events_url": "https://api.github.com/users/Jaykul/received_events",
      "repos_url": "https://api.github.com/users/Jaykul/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Jaykul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Jaykul/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Jaykul"
    }
  }
]

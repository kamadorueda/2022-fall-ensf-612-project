[
  {
    "author_association": "COLLABORATOR",
    "body": "> The [AddScript documentation](https://docs.microsoft.com/en-us/dotnet/api/system.management.automation.powershell.addscript?view=powershellsdk-7.0.0) appears incorrect -- it only referes to AddCommand in the examples.\r\n\r\nThis must be fixed in the repository (ex., #15568)",
    "created_at": "2022-02-17T14:54:25Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16893#issuecomment-1043035393",
    "id": 1043035393,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16893",
    "node_id": "IC_kwDOAvT7bc4-K3UB",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1043035393/reactions"
    },
    "updated_at": "2022-02-17T14:54:25Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1043035393",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Working example for AddScript https://docs.microsoft.com/en-us/powershell/scripting/developer/hosting/adding-and-invoking-commands?view=powershell-7.2#addscript\n\n<blockquote><img src=\"https://docs.microsoft.com/media/logos/logo-powershell-social.png\" width=\"48\" align=\"right\"><div><strong><a href=\"https://docs.microsoft.com/en-us/powershell/scripting/developer/hosting/adding-and-invoking-commands\">Adding and invoking commands - PowerShell</a></strong></div><div>Adding and invoking commands</div></blockquote>",
    "created_at": "2022-02-17T14:57:53Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16893#issuecomment-1043038992",
    "id": 1043038992,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16893",
    "node_id": "IC_kwDOAvT7bc4-K4MQ",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1043038992/reactions"
    },
    "updated_at": "2022-02-17T14:57:55Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1043038992",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Examples for files\r\nhttps://stackoverflow.com/questions/68941818/how-to-execute-a-powershell-script-using-c-sharp-and-setting-execution-policy\r\nhttps://stackoverflow.com/questions/527513/execute-powershell-script-from-c-sharp-with-commandline-arguments\n\n<blockquote><img src=\"https://cdn.sstatic.net/Sites/stackoverflow/Img/apple-touch-icon@2.png?v=73d79a89bded\" width=\"48\" align=\"right\"><div>Stack Overflow</div><div><strong><a href=\"https://stackoverflow.com/questions/68941818/how-to-execute-a-powershell-script-using-c-sharp-and-setting-execution-policy\">How to execute a powershell script using c# and setting execution policy?</a></strong></div><div>I tried to combine two answers from stackoverflow (first &amp; second)\nInitialSessionState iss = InitialSessionState.CreateDefault();\n// Override ExecutionPolicy\n\nPropertyInfo execPolProp = iss.Get...</div></blockquote>\n<blockquote><img src=\"https://cdn.sstatic.net/Sites/stackoverflow/Img/apple-touch-icon@2.png?v=73d79a89bded\" width=\"48\" align=\"right\"><div>Stack Overflow</div><div><strong><a href=\"https://stackoverflow.com/questions/527513/execute-powershell-script-from-c-sharp-with-commandline-arguments\">Execute PowerShell Script from C# with Commandline Arguments</a></strong></div><div>I need to execute a PowerShell script from within C#. The script needs commandline arguments.\n\nThis is what I have done so far:\n\nRunspaceConfiguration runspaceConfiguration = RunspaceConfiguration....</div></blockquote>",
    "created_at": "2022-02-17T15:02:04Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16893#issuecomment-1043043352",
    "id": 1043043352,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16893",
    "node_id": "IC_kwDOAvT7bc4-K5QY",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1043043352/reactions"
    },
    "updated_at": "2022-02-17T15:02:06Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1043043352",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "@iSazonov  you are a life saver!  Was banging my head against the wall on that one for a while.\r\n\r\nWould it be worth documenting this code path?  It seems like a pretty common pattern to invoke an existing .ps1 file from .NET core.  I don't see any samples in the [MSDN docs](https://docs.microsoft.com/en-us/powershell/scripting/developer/hosting/host-application-samples?view=powershell-7.2) for this use case\r\n\r\nFor those that come across this, here is my final working example for running an external script using the Powershell SDK:\r\n\r\n```csharp\r\nprivate object TestPowershell(string path)\r\n    {\r\n        // not required, but nice to do if you don't want the execution policy to block\r\n        var iss = InitialSessionState.CreateDefault();\r\n        iss.ExecutionPolicy = Microsoft.PowerShell.ExecutionPolicy.Bypass;\r\n\r\n        using var runspace = RunspaceFactory.CreateRunspace(iss);\r\n        runspace.Open();\r\n        using var pipeline = runspace.CreatePipeline();\r\n\r\n        var cmd = new Command(path);\r\n        cmd.Parameters.Add(\"Env\", \"local\");\r\n\r\n        pipeline.Commands.Add(cmd);\r\n\r\n        return pipeline.Invoke();\r\n    }\r\n```",
    "created_at": "2022-02-17T16:12:28Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16893#issuecomment-1043136037",
    "id": 1043136037,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16893",
    "node_id": "IC_kwDOAvT7bc4-LP4l",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1043136037/reactions"
    },
    "updated_at": "2022-02-17T16:13:05Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1043136037",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/19917677?v=4",
      "events_url": "https://api.github.com/users/cmeyertons/events{/privacy}",
      "followers_url": "https://api.github.com/users/cmeyertons/followers",
      "following_url": "https://api.github.com/users/cmeyertons/following{/other_user}",
      "gists_url": "https://api.github.com/users/cmeyertons/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/cmeyertons",
      "id": 19917677,
      "login": "cmeyertons",
      "node_id": "MDQ6VXNlcjE5OTE3Njc3",
      "organizations_url": "https://api.github.com/users/cmeyertons/orgs",
      "received_events_url": "https://api.github.com/users/cmeyertons/received_events",
      "repos_url": "https://api.github.com/users/cmeyertons/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/cmeyertons/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cmeyertons/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/cmeyertons"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "> Would it be worth documenting this code path? It seems like a pretty common pattern to invoke an existing .ps1 file from .NET core. I don't see any samples in the [MSDN docs](https://docs.microsoft.com/en-us/powershell/scripting/developer/hosting/host-application-samples?view=powershell-7.2) for this use case\r\n\r\nYou can open new issue https://github.com/MicrosoftDocs/PowerShell-Docs\n\n<blockquote><img src=\"https://repository-images.githubusercontent.com/44411511/850abe80-7ca6-11e9-886f-a1b13b275ae0\" width=\"48\" align=\"right\"><div><img src=\"https://github.githubassets.com/favicons/favicon.svg\" height=\"14\"> GitHub</div><div><strong><a href=\"https://github.com/MicrosoftDocs/PowerShell-Docs\">GitHub - MicrosoftDocs/PowerShell-Docs: The official PowerShell documentation sources</a></strong></div><div>The official PowerShell documentation sources. Contribute to MicrosoftDocs/PowerShell-Docs development by creating an account on GitHub.</div></blockquote>",
    "created_at": "2022-02-17T17:24:59Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16893#issuecomment-1043214704",
    "id": 1043214704,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16893",
    "node_id": "IC_kwDOAvT7bc4-LjFw",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1043214704/reactions"
    },
    "updated_at": "2022-02-17T17:25:01Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1043214704",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "Done on my side! Feel free to close if desired!",
    "created_at": "2022-02-17T17:31:18Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16893#issuecomment-1043220975",
    "id": 1043220975,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16893",
    "node_id": "IC_kwDOAvT7bc4-Lknv",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1043220975/reactions"
    },
    "updated_at": "2022-02-17T17:31:18Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1043220975",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/19917677?v=4",
      "events_url": "https://api.github.com/users/cmeyertons/events{/privacy}",
      "followers_url": "https://api.github.com/users/cmeyertons/followers",
      "following_url": "https://api.github.com/users/cmeyertons/following{/other_user}",
      "gists_url": "https://api.github.com/users/cmeyertons/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/cmeyertons",
      "id": 19917677,
      "login": "cmeyertons",
      "node_id": "MDQ6VXNlcjE5OTE3Njc3",
      "organizations_url": "https://api.github.com/users/cmeyertons/orgs",
      "received_events_url": "https://api.github.com/users/cmeyertons/received_events",
      "repos_url": "https://api.github.com/users/cmeyertons/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/cmeyertons/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cmeyertons/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/cmeyertons"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "We keep the issue opened to fix docs in code https://github.com/PowerShell/PowerShell/issues/16893#issuecomment-1043035393",
    "created_at": "2022-02-18T04:25:14Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16893#issuecomment-1043867536",
    "id": 1043867536,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16893",
    "node_id": "IC_kwDOAvT7bc4-OCeQ",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1043867536/reactions"
    },
    "updated_at": "2022-02-18T04:25:14Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1043867536",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  }
]

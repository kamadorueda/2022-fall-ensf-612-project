[
  {
    "author_association": "CONTRIBUTOR",
    "body": "I was able to reproduce. At first glance, it looks like it's getting into CryptUIWizDigitalSign() using the correct hash OID, but then CryptUIWizDigitalSign() just seems to ignore it and sign with SHA256. It looks like signtool, which works, uses SignerSignEx2(). I'm curious if the Microsoft guys have any thoughts/opinions.",
    "created_at": "2022-08-23T00:23:01Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17912#issuecomment-1223361283",
    "id": 1223361283,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17912",
    "node_id": "IC_kwDOAvT7bc5I6wMD",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1223361283/reactions"
    },
    "updated_at": "2022-08-23T00:28:11Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1223361283",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12881023?v=4",
      "events_url": "https://api.github.com/users/NoMoreFood/events{/privacy}",
      "followers_url": "https://api.github.com/users/NoMoreFood/followers",
      "following_url": "https://api.github.com/users/NoMoreFood/following{/other_user}",
      "gists_url": "https://api.github.com/users/NoMoreFood/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/NoMoreFood",
      "id": 12881023,
      "login": "NoMoreFood",
      "node_id": "MDQ6VXNlcjEyODgxMDIz",
      "organizations_url": "https://api.github.com/users/NoMoreFood/orgs",
      "received_events_url": "https://api.github.com/users/NoMoreFood/received_events",
      "repos_url": "https://api.github.com/users/NoMoreFood/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/NoMoreFood/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NoMoreFood/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/NoMoreFood"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "I can verify that the `Set-AuthenticodeSignature` is using the provided hash algorithm (SHA384) oid when calling the Windows API.  However, the actual file signature is always the same regardless of what hash algorithm I choose.  So it does appear that the `CryptUIWizDigitalSign` API is ignoring the provided hash algorithm, and defaulting to SHA256.  I see the same behavior with WindowsPowerShell 5.1, so this does not appear to be a regression after @jborean93 refactor of this code.\r\n\r\nWe will need to check with internal teams to find out why the API is behaving this way.",
    "created_at": "2022-08-25T17:23:47Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17912#issuecomment-1227556072",
    "id": 1227556072,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17912",
    "node_id": "IC_kwDOAvT7bc5JKwTo",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1227556072/reactions"
    },
    "updated_at": "2022-08-25T17:23:47Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1227556072",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/14019529?v=4",
      "events_url": "https://api.github.com/users/PaulHigin/events{/privacy}",
      "followers_url": "https://api.github.com/users/PaulHigin/followers",
      "following_url": "https://api.github.com/users/PaulHigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulHigin/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/PaulHigin",
      "id": 14019529,
      "login": "PaulHigin",
      "node_id": "MDQ6VXNlcjE0MDE5NTI5",
      "organizations_url": "https://api.github.com/users/PaulHigin/orgs",
      "received_events_url": "https://api.github.com/users/PaulHigin/received_events",
      "repos_url": "https://api.github.com/users/PaulHigin/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/PaulHigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulHigin/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/PaulHigin"
    }
  }
]

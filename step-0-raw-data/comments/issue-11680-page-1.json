[
  {
    "author_association": "NONE",
    "body": "This is because the shortcut is created for _all users_, rather than in the current user's own program files.  \r\nThe console tries to write something back to where the shortcut was found. IIRC, if you go to the EXE file and launch it without using the short cut, you get a set of defaults and changes are saved to the registry. \r\nIf the shortcut is in the users' programs (as with cmd or windowsPowerShell , IIRC) the user has write access by default, but not if it is in _all Users_ . \r\n\r\nThe cure for this would be for setup to add PowerShell to the current user's profile and the default for new users.\r\n",
    "created_at": "2020-01-26T13:41:34Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11680#issuecomment-578503034",
    "id": 578503034,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11680",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3ODUwMzAzNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/578503034/reactions"
    },
    "updated_at": "2020-01-26T13:41:34Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/578503034",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/16209593?v=4",
      "events_url": "https://api.github.com/users/jhoneill/events{/privacy}",
      "followers_url": "https://api.github.com/users/jhoneill/followers",
      "following_url": "https://api.github.com/users/jhoneill/following{/other_user}",
      "gists_url": "https://api.github.com/users/jhoneill/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jhoneill",
      "id": 16209593,
      "login": "jhoneill",
      "node_id": "MDQ6VXNlcjE2MjA5NTkz",
      "organizations_url": "https://api.github.com/users/jhoneill/orgs",
      "received_events_url": "https://api.github.com/users/jhoneill/received_events",
      "repos_url": "https://api.github.com/users/jhoneill/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jhoneill/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jhoneill/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jhoneill"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "I think modifying the installer to create user-specific shortcuts is definitely called for.\r\n\r\nIn the meantime, here's a workaround:\r\n\r\n**To create a user-modifiable Start Menu shortcut**:\r\n\r\n```powershell\r\n# Create a user-specific Start Menu shortcut\r\nGet-Item \"$env:ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\PowerShell\\*lnk\" |\r\n  Copy-Item -Destination \"$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\"\r\n```\r\n\r\nThis user-specific copy effectively shadows the all-users one in your Start Menu, and PowerShell windows launched from it do permit persisting console settings via their system menu.\r\n\r\n**To pin a user-modifiable shortcut to the task bar** (alternatively or in addition):\r\n * Start PowerShell via the (effectively read-only) Start Menu shortcut.\r\n * Right-click on the running task and select `Pin to taskbar`\r\n   * At that point a _user-specific copy_ of the shortcut (`*.lnk` file) is created, as a pinned taskbar item, in the following location:\r\n        * `\"$env:APPDATA\\Microsoft\\Internet Explorer\\Quick Launch\\User Pinned\\TaskBar\"` \r\n    * **Important**: \r\n       * Close the open window and launch a new one via the new pinned shortcut before trying to modify settings.\r\n       * The mere act of _un_-pinning deletes this user-specific shortcut file again.\r\n       * Even if you create a pinned item from a user-specific Start Menu shortcut, an independent shortcut file is created, with independent settings.",
    "created_at": "2020-01-26T20:45:11Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11680#issuecomment-578541388",
    "id": 578541388,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11680",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3ODU0MTM4OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/578541388/reactions"
    },
    "updated_at": "2020-01-26T20:45:11Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/578541388",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@bergmeister, are you aware of this?",
    "created_at": "2020-02-08T03:05:18Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11680#issuecomment-583696197",
    "id": 583696197,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11680",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4MzY5NjE5Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/583696197/reactions"
    },
    "updated_at": "2020-02-08T03:05:18Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/583696197",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  }
]

[
  {
    "author_association": "COLLABORATOR",
    "body": "@TylerLeonhardt been a while since I played with it, but don't new `[powershell]` instances execute in the current runspace unless you manually assign them a new one?",
    "created_at": "2019-04-07T01:45:07Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9313#issuecomment-480551525",
    "id": 480551525,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9313",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MDU1MTUyNQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/480551525/reactions"
    },
    "updated_at": "2019-04-07T01:45:07Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/480551525",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/32407840?v=4",
      "events_url": "https://api.github.com/users/vexx32/events{/privacy}",
      "followers_url": "https://api.github.com/users/vexx32/followers",
      "following_url": "https://api.github.com/users/vexx32/following{/other_user}",
      "gists_url": "https://api.github.com/users/vexx32/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vexx32",
      "id": 32407840,
      "login": "vexx32",
      "node_id": "MDQ6VXNlcjMyNDA3ODQw",
      "organizations_url": "https://api.github.com/users/vexx32/orgs",
      "received_events_url": "https://api.github.com/users/vexx32/received_events",
      "repos_url": "https://api.github.com/users/vexx32/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vexx32/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vexx32/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vexx32"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "I'm pretty sure they're in a new runspace because `Get-Runspace` returns another runspace. Just to be sure, I tried manually creating a new runspace and the issue still repros:\r\n\r\n```pwsh\r\nclass MyClass {\r\n    # Property: Holds name\r\n    [String] $Name\r\n\r\n    # Constructor: Creates a new MyClass object, with the specified name\r\n    MyClass([String] $NewName) {\r\n        # Set name for MyClass\r\n        $this.Name = $NewName\r\n    }\r\n\r\n    # Method: Method that changes $Name to the default name\r\n    [void] ChangeNameToDefault() {\r\n        $this.Name = \"DefaultName\"\r\n    }\r\n}\r\n$rs = [runspacefactory]::CreateRunspace()\r\n$rs.Open()\r\n[MyClass].GetType()\r\n[PowerShell]::Create($rs).AddScript('[MyClass]::new(\"ffff\")').Invoke()\r\n```",
    "created_at": "2019-04-07T04:39:02Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9313#issuecomment-480558730",
    "id": 480558730,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9313",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MDU1ODczMA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/480558730/reactions"
    },
    "updated_at": "2019-04-07T04:39:02Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/480558730",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/2644648?v=4",
      "events_url": "https://api.github.com/users/TylerLeonhardt/events{/privacy}",
      "followers_url": "https://api.github.com/users/TylerLeonhardt/followers",
      "following_url": "https://api.github.com/users/TylerLeonhardt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TylerLeonhardt/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/TylerLeonhardt",
      "id": 2644648,
      "login": "TylerLeonhardt",
      "node_id": "MDQ6VXNlcjI2NDQ2NDg=",
      "organizations_url": "https://api.github.com/users/TylerLeonhardt/orgs",
      "received_events_url": "https://api.github.com/users/TylerLeonhardt/received_events",
      "repos_url": "https://api.github.com/users/TylerLeonhardt/repos",
      "site_admin": true,
      "starred_url": "https://api.github.com/users/TylerLeonhardt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TylerLeonhardt/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/TylerLeonhardt"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Windows  PowerShell 5.1 behaves the same way.  A loaded type definition is available process wide unless maybe the process is using AppDomains for isolation but 5.1 doesn't appear to use AppDomains.  And there is no support for AppDomains in .NET Core anyway.",
    "created_at": "2019-04-07T19:13:41Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9313#issuecomment-480620522",
    "id": 480620522,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9313",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MDYyMDUyMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/480620522/reactions"
    },
    "updated_at": "2019-04-07T19:13:41Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/480620522",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/5177512?v=4",
      "events_url": "https://api.github.com/users/rkeithhill/events{/privacy}",
      "followers_url": "https://api.github.com/users/rkeithhill/followers",
      "following_url": "https://api.github.com/users/rkeithhill/following{/other_user}",
      "gists_url": "https://api.github.com/users/rkeithhill/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rkeithhill",
      "id": 5177512,
      "login": "rkeithhill",
      "node_id": "MDQ6VXNlcjUxNzc1MTI=",
      "organizations_url": "https://api.github.com/users/rkeithhill/orgs",
      "received_events_url": "https://api.github.com/users/rkeithhill/received_events",
      "repos_url": "https://api.github.com/users/rkeithhill/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rkeithhill/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rkeithhill/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rkeithhill"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@rkeithhill I'd expect the type to still be loaded, but I wouldn't expect PowerShell to resolve it since resolution is scope based:\r\n\r\n```powershell\r\n& {\r\n    class MyClass {}\r\n}\r\n\r\n# Returns the above class\r\n[AppDomain]::CurrentDomain.GetAssemblies().\r\n    Where{\r\n        [Reflection.CustomAttributeExtensions]::IsDefined(\r\n            $_,\r\n            [Management.Automation.DynamicClassImplementationAssemblyAttribute])\r\n    }.ForEach{\r\n        # The types sometimes have a distinguishing namespace\r\n        $_.Modules[0].FindTypes([Reflection.Module]::FilterTypeName, 'MyClass')\r\n    }\r\n\r\n# Throws type not found\r\n[MyClass]\r\n```\r\n\r\n**Edit:** Side note, I can't repro on 5.1 nor 6.2 on Windows. I get an `Unable to find type [MyClass].` error in `Streams.Errors`\r\n\r\nAlso @vexx32 \r\n\r\n> been a while since I played with it, but don't new [powershell] instances execute in the current runspace unless you manually assign them a new one?\r\n\r\nOnly when you pass `[System.Management.Automation.RunspaceMode]::CurrentRunspace`",
    "created_at": "2019-04-08T13:52:00Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9313#issuecomment-480840553",
    "id": 480840553,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9313",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MDg0MDU1Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/480840553/reactions"
    },
    "updated_at": "2019-04-08T17:19:45Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/480840553",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "PSReadLine plays a role in the repo. To get consistent repro on all platforms (including powershell.exe), do the following:\r\n1. start pwsh/powershell.exe with `-noprofile`\r\n2. copy the following to pwsh/powershell.exe:\r\n```\r\nclass MyClass {\r\n    # Property: Holds name\r\n    [String] $Name\r\n\r\n    # Constructor: Creates a new MyClass object, with the specified name\r\n    MyClass([String] $NewName) {\r\n    # Set name for MyClass\r\n      $this.Name = $NewName\r\n    }\r\n\r\n    # Method: Method that changes $Name to the default name\r\n    [void] ChangeNameToDefault() {\r\n      $this.Name = \"DefaultName\"\r\n    }\r\n  }\r\n```\r\n3. copy the following to pwsh/powershell:\r\n```\r\n[MyClass].GetType()\r\n[PowerShell]::Create().AddScript('[MyClass]::new(\"ffff\")').Invoke()\r\n```\r\nThen you will see the `Name: ffff` printed out.\r\n\r\n--------------------------------------------\r\n\r\nThe moment you remove PSReadLine, this won't repro. This is because PSReadLine always parse the input before it's sent to engine to execute. The parsing involves resolving `[MyClass]`, and put it in the type cache with the wrong `TypeResolutionState`.",
    "created_at": "2019-12-05T20:44:09Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9313#issuecomment-562309686",
    "id": 562309686,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9313",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MjMwOTY4Ng==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/562309686/reactions"
    },
    "updated_at": "2019-12-05T20:44:09Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/562309686",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "NONE",
    "body": ":tada:This issue was addressed in #11273, which has now been successfully released as `v7.0.0-rc.1`.:tada:\n\nHandy links:\n* [Release Notes](https://github.com/PowerShell/PowerShell/releases/tag/v7.0.0-rc.1)\n",
    "created_at": "2019-12-16T21:38:08Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9313#issuecomment-566255233",
    "id": 566255233,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9313",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NjI1NTIzMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/566255233/reactions"
    },
    "updated_at": "2019-12-16T21:38:08Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/566255233",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  }
]

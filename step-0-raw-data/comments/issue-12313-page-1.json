[
  {
    "author_association": "COLLABORATOR",
    "body": "The ForEach-Object -Parallel feature uses PowerShell runspaces to run each loop iteration concurrently.  PowerShell runspaces are isolation abstractions and don't provide a way to share state between instances.\r\n\r\nHowever, there are many examples (including this) of reasonable expectations for the loop iteration state to be the same as what the ForEach-Object cmdlet runs in.  One solution is to allow an option that replicates the state, at some cost to performance.  We have a current issue to track this (so I'll close this one). #12240\r\n\r\nAlso, here is an article that goes into greater detail about how ForEach-Object -Parallel works.  But note that one issue, runspace re-use, has been fixed in 7.1 preview (#12122).\r\n\r\nhttps://devblogs.microsoft.com/powershell/powershell-foreach-object-parallel-feature/\n\n<blockquote><img src=\"https://devblogs.microsoft.com/powershell/wp-content/uploads/sites/30/2018/09/Powershell_256.png\" width=\"48\" align=\"right\"><div><img src=\"https://devblogs.microsoft.com/powershell/wp-content/uploads/sites/30/2019/02/Powershell_2561.png\" height=\"14\"> PowerShell</div><div><strong><a href=\"https://devblogs.microsoft.com/powershell/powershell-foreach-object-parallel-feature/\">PowerShell ForEach-Object Parallel Feature | PowerShell</a></strong></div><div>PowerShell ForEach-Object Parallel Feature\nPowerShell 7.0 Preview 3 is now available with a new ForEach-Object Parallel Experimental feature. This feature is a great new tool for parallelizing work, but like any tool, it has its uses and drawbacks.\nThis article describes this new feature,</div></blockquote>",
    "created_at": "2020-04-14T20:19:25Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12313#issuecomment-613660260",
    "id": 613660260,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12313",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxMzY2MDI2MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/613660260/reactions"
    },
    "updated_at": "2020-04-14T20:19:28Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/613660260",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/14019529?v=4",
      "events_url": "https://api.github.com/users/PaulHigin/events{/privacy}",
      "followers_url": "https://api.github.com/users/PaulHigin/followers",
      "following_url": "https://api.github.com/users/PaulHigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulHigin/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/PaulHigin",
      "id": 14019529,
      "login": "PaulHigin",
      "node_id": "MDQ6VXNlcjE0MDE5NTI5",
      "organizations_url": "https://api.github.com/users/PaulHigin/orgs",
      "received_events_url": "https://api.github.com/users/PaulHigin/received_events",
      "repos_url": "https://api.github.com/users/PaulHigin/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/PaulHigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulHigin/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/PaulHigin"
    }
  },
  {
    "author_association": "NONE",
    "body": "> The ForEach-Object -Parallel feature uses PowerShell runspaces to run each loop iteration concurrently. PowerShell runspaces are isolation abstractions and don't provide a way to share state between instances.\r\n> \r\n> However, there are many examples (including this) of reasonable expectations for the loop iteration state to be the same as what the ForEach-Object cmdlet runs in. One solution is to allow an option that replicates the state, at some cost to performance. We have a current issue to track this (so I'll close this one). #12240\r\n> \r\n> Also, here is an article that goes into greater detail about how ForEach-Object -Parallel works. But note that one issue, runspace re-use, has been fixed in 7.1 preview (#12122).\r\n> \r\n> https://devblogs.microsoft.com/powershell/powershell-foreach-object-parallel-feature/\r\n> \r\n> > <img alt=\"\" width=\"48\" src=\"https://camo.githubusercontent.com/81d28cf99fecd33e97c84c06701dff2f5a6bfcd6/68747470733a2f2f646576626c6f67732e6d6963726f736f66742e636f6d2f706f7765727368656c6c2f77702d636f6e74656e742f75706c6f6164732f73697465732f33302f323031382f30392f506f7765727368656c6c5f3235362e706e67\"><img alt=\"\" height=\"14\" src=\"https://camo.githubusercontent.com/9c013a468c6cf48222b871a24273e0b9ba2d9327/68747470733a2f2f646576626c6f67732e6d6963726f736f66742e636f6d2f706f7765727368656c6c2f77702d636f6e74656e742f75706c6f6164732f73697465732f33302f323031392f30322f506f7765727368656c6c5f323536312e706e67\"> PowerShell**[PowerShell ForEach-Object Parallel Feature | PowerShell](https://devblogs.microsoft.com/powershell/powershell-foreach-object-parallel-feature/)**PowerShell ForEach-Object Parallel Feature\r\n> > PowerShell 7.0 Preview 3 is now available with a new ForEach-Object Parallel Experimental feature. This feature is a great new tool for parallelizing work, but like any tool, it has its uses and drawbacks.\r\n> > This article describes this new feature,\r\n\r\nthanks\n\n<blockquote><img src=\"https://devblogs.microsoft.com/powershell/wp-content/uploads/sites/30/2018/09/Powershell_256.png\" width=\"48\" align=\"right\"><div><img src=\"https://devblogs.microsoft.com/powershell/wp-content/uploads/sites/30/2019/02/Powershell_2561.png\" height=\"14\"> PowerShell</div><div><strong><a href=\"https://devblogs.microsoft.com/powershell/powershell-foreach-object-parallel-feature/\">PowerShell ForEach-Object Parallel Feature | PowerShell</a></strong></div><div>PowerShell ForEach-Object Parallel Feature\nPowerShell 7.0 Preview 3 is now available with a new ForEach-Object Parallel Experimental feature. This feature is a great new tool for parallelizing work, but like any tool, it has its uses and drawbacks.\nThis article describes this new feature,</div></blockquote>",
    "created_at": "2020-04-15T05:43:20Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12313#issuecomment-613828979",
    "id": 613828979,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12313",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxMzgyODk3OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/613828979/reactions"
    },
    "updated_at": "2020-04-15T05:43:22Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/613828979",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12989024?v=4",
      "events_url": "https://api.github.com/users/Damag3d/events{/privacy}",
      "followers_url": "https://api.github.com/users/Damag3d/followers",
      "following_url": "https://api.github.com/users/Damag3d/following{/other_user}",
      "gists_url": "https://api.github.com/users/Damag3d/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Damag3d",
      "id": 12989024,
      "login": "Damag3d",
      "node_id": "MDQ6VXNlcjEyOTg5MDI0",
      "organizations_url": "https://api.github.com/users/Damag3d/orgs",
      "received_events_url": "https://api.github.com/users/Damag3d/received_events",
      "repos_url": "https://api.github.com/users/Damag3d/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Damag3d/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Damag3d/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Damag3d"
    }
  }
]

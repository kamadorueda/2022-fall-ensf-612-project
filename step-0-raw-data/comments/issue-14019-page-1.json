[
  {
    "author_association": "NONE",
    "body": "I tried importing the Windows PowerShell version of PSDesiredStateConfiguration module, but I get the same result.\r\n",
    "created_at": "2020-11-09T21:48:40Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14019#issuecomment-724298379",
    "id": 724298379,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14019",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyNDI5ODM3OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/724298379/reactions"
    },
    "updated_at": "2020-11-09T21:48:40Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/724298379",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/35051290?v=4",
      "events_url": "https://api.github.com/users/rgroefer/events{/privacy}",
      "followers_url": "https://api.github.com/users/rgroefer/followers",
      "following_url": "https://api.github.com/users/rgroefer/following{/other_user}",
      "gists_url": "https://api.github.com/users/rgroefer/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rgroefer",
      "id": 35051290,
      "login": "rgroefer",
      "node_id": "MDQ6VXNlcjM1MDUxMjkw",
      "organizations_url": "https://api.github.com/users/rgroefer/orgs",
      "received_events_url": "https://api.github.com/users/rgroefer/received_events",
      "repos_url": "https://api.github.com/users/rgroefer/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rgroefer/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rgroefer/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rgroefer"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "I believe this is because the [Get-DscLocalConfigurationManager](https://docs.microsoft.com/en-us/powershell/module/psdesiredstateconfiguration/get-dsclocalconfigurationmanager?view=powershell-5.1) is only present in the Windows PowerSell (5.1) `PSDesiredStateConfiguration` module. Running `(Get-Command Get-DscLocalConfigurationManager).Definition` will show that it runs it through a proxy function which ultimately uses `Get-PSImplicitRemotingSession` to run it on Windows PowerShell.\r\n\r\nBecause it runs it in a separate process, any data that is exchanged between the 2 sessions need to be serialized to CLIXML which looses any active information, like a CIM connection, and make it effectively read only. This is why the error states it cannot transform `Deserialized.Microsoft.Management.Infrastructure.CimSession` to `Microsoft.Management.Infrastructure.CimSession[]`.\r\n\r\nWhat you can do to run this command from PowerShell 7 is to wrap you entire call in the inside 1 script block like\r\n\r\n```powershell\r\n$implicitSession = New-PSSession -UseWindowsPowerShell\r\n$dscInfo = Invoke-Command -Session $implicitSession -ScriptBlock {\r\n    $cim = New-CimSession -ComputerName myServerFQDN.domain.com\r\n    Get-DscLocalConfigurationManager -CimSession $cim\r\n}\r\n$implicitSession | Remove-PSSession\r\n```\r\n\r\nThis make sure the CimSession you create exists solely in the Windows PowerShell session and doesn't traverse any boundaries. The only way to natively call `Get-DscLocalConfigurationManager` in PowerShell is for that module to be included in `PSDesiredStateConfiguration` that ships with PowerShell. Considering LCM is probably going away at some point in the future I doubt that will happen.",
    "created_at": "2020-11-09T22:12:43Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14019#issuecomment-724309084",
    "id": 724309084,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14019",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyNDMwOTA4NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/724309084/reactions"
    },
    "updated_at": "2020-11-10T03:47:48Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/724309084",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8462645?v=4",
      "events_url": "https://api.github.com/users/jborean93/events{/privacy}",
      "followers_url": "https://api.github.com/users/jborean93/followers",
      "following_url": "https://api.github.com/users/jborean93/following{/other_user}",
      "gists_url": "https://api.github.com/users/jborean93/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jborean93",
      "id": 8462645,
      "login": "jborean93",
      "node_id": "MDQ6VXNlcjg0NjI2NDU=",
      "organizations_url": "https://api.github.com/users/jborean93/orgs",
      "received_events_url": "https://api.github.com/users/jborean93/received_events",
      "repos_url": "https://api.github.com/users/jborean93/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jborean93/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jborean93/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jborean93"
    }
  }
]

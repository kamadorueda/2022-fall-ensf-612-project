[
  {
    "author_association": "COLLABORATOR",
    "body": "Very interesting. This looks like a bug @daxian-dbw ",
    "created_at": "2020-06-03T19:05:47Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12883#issuecomment-638400824",
    "id": 638400824,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12883",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzODQwMDgyNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/638400824/reactions"
    },
    "updated_at": "2020-06-03T19:05:47Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/638400824",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/7009879?v=4",
      "events_url": "https://api.github.com/users/rjmholt/events{/privacy}",
      "followers_url": "https://api.github.com/users/rjmholt/followers",
      "following_url": "https://api.github.com/users/rjmholt/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjmholt/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rjmholt",
      "id": 7009879,
      "login": "rjmholt",
      "node_id": "MDQ6VXNlcjcwMDk4Nzk=",
      "organizations_url": "https://api.github.com/users/rjmholt/orgs",
      "received_events_url": "https://api.github.com/users/rjmholt/received_events",
      "repos_url": "https://api.github.com/users/rjmholt/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rjmholt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjmholt/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rjmholt"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Yeah when you mentioned it on the panel I was confused because I thought I had tried it before and it just straight up didn't work.  Makes sense after looking at the source though.\r\n\r\nAlso probably better to open a new issue for this, but the API doesn't give you an option to specify if a new scope should be created.  As a workaround, you can (*but probably shouldn't*) do this:\r\n\r\n```powershell\r\n$module = [psmoduleinfo]::new($false)\r\n\r\n# Surprised this set accessor is public ü§∑‚Äç‚ôÇÔ∏è\r\n$module.SessionState = $PSCmdlet.SessionState\r\n\r\n& $module { 'new scope in the target session state' }\r\n. $module { 'no new scope in the target session state' }\r\n```",
    "created_at": "2020-06-03T19:33:31Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12883#issuecomment-638415855",
    "id": 638415855,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12883",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzODQxNTg1NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/638415855/reactions"
    },
    "updated_at": "2020-06-03T19:33:31Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/638415855",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@SeeminglyScience  `PSModuleInfo` was only intended to be a public facade for a module that already existed. Take a look at 'ModuleIntrinsics.cs` for the details of module construction. Really, the only recommended way to create a new module is with the `New-Module` cmdlet. Is that insufficient?",
    "created_at": "2020-06-05T17:46:42Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12883#issuecomment-639662905",
    "id": 639662905,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12883",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzOTY2MjkwNQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/639662905/reactions"
    },
    "updated_at": "2020-06-05T17:46:42Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/639662905",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/50499275?v=4",
      "events_url": "https://api.github.com/users/bpayette/events{/privacy}",
      "followers_url": "https://api.github.com/users/bpayette/followers",
      "following_url": "https://api.github.com/users/bpayette/following{/other_user}",
      "gists_url": "https://api.github.com/users/bpayette/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/bpayette",
      "id": 50499275,
      "login": "bpayette",
      "node_id": "MDQ6VXNlcjUwNDk5Mjc1",
      "organizations_url": "https://api.github.com/users/bpayette/orgs",
      "received_events_url": "https://api.github.com/users/bpayette/received_events",
      "repos_url": "https://api.github.com/users/bpayette/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/bpayette/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bpayette/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/bpayette"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@bpayette I don't think that's what this issue is about at all. \r\n\r\n@SeeminglyScience was just demonstrating a hacky workaround that works in the meantime.",
    "created_at": "2020-06-05T18:51:26Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12883#issuecomment-639709977",
    "id": 639709977,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12883",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzOTcwOTk3Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/639709977/reactions"
    },
    "updated_at": "2020-06-05T18:51:26Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/639709977",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/32407840?v=4",
      "events_url": "https://api.github.com/users/vexx32/events{/privacy}",
      "followers_url": "https://api.github.com/users/vexx32/followers",
      "following_url": "https://api.github.com/users/vexx32/following{/other_user}",
      "gists_url": "https://api.github.com/users/vexx32/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vexx32",
      "id": 32407840,
      "login": "vexx32",
      "node_id": "MDQ6VXNlcjMyNDA3ODQw",
      "organizations_url": "https://api.github.com/users/vexx32/orgs",
      "received_events_url": "https://api.github.com/users/vexx32/received_events",
      "repos_url": "https://api.github.com/users/vexx32/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vexx32/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vexx32/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vexx32"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for the explanation and workaround @SeeminglyScience! üéâ This has been driving me nuts!\r\nHopefully it can be fixed soon, but it will still be broken in all prior versions including Windows PowerShell 5.1, so workaround or avoiding `InvokeScript` in these scenarios will have to be my long-term solutions.",
    "created_at": "2021-06-11T18:37:07Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12883#issuecomment-859768669",
    "id": 859768669,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12883",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1OTc2ODY2OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/859768669/reactions"
    },
    "updated_at": "2021-06-11T18:37:07Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/859768669",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/3436158?v=4",
      "events_url": "https://api.github.com/users/fflaten/events{/privacy}",
      "followers_url": "https://api.github.com/users/fflaten/followers",
      "following_url": "https://api.github.com/users/fflaten/following{/other_user}",
      "gists_url": "https://api.github.com/users/fflaten/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/fflaten",
      "id": 3436158,
      "login": "fflaten",
      "node_id": "MDQ6VXNlcjM0MzYxNTg=",
      "organizations_url": "https://api.github.com/users/fflaten/orgs",
      "received_events_url": "https://api.github.com/users/fflaten/received_events",
      "repos_url": "https://api.github.com/users/fflaten/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/fflaten/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fflaten/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/fflaten"
    }
  }
]

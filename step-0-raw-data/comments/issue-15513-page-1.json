[
  {
    "author_association": "COLLABORATOR",
    "body": "//cc @PaulHigin ",
    "created_at": "2021-06-03T05:46:09Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15513#issuecomment-853582459",
    "id": 853582459,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15513",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1MzU4MjQ1OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/853582459/reactions"
    },
    "updated_at": "2021-06-03T05:46:09Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/853582459",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "I can repro on MacOS. This is the stack trace when this error turns up:\r\n```\r\nStackTrace     :    at System.Collections.Generic.HashSet`1.FindItemIndex(T item)\r\n                    at System.Collections.Generic.HashSet`1.Contains(T item)\r\n                    at Microsoft.PowerShell.Commands.WebRequestPSCmdlet.GetRequest(Uri uri)\r\n                    at Microsoft.PowerShell.Commands.WebRequestPSCmdlet.ProcessRecord()\r\n                    at System.Management.Automation.Cmdlet.DoProcessRecord()\r\n                    at System.Management.Automation.CommandProcessor.ProcessRecord()\r\n```",
    "created_at": "2021-06-03T12:25:48Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15513#issuecomment-853829156",
    "id": 853829156,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15513",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1MzgyOTE1Ng==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/853829156/reactions"
    },
    "updated_at": "2021-06-03T12:26:19Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/853829156",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/32407840?v=4",
      "events_url": "https://api.github.com/users/vexx32/events{/privacy}",
      "followers_url": "https://api.github.com/users/vexx32/followers",
      "following_url": "https://api.github.com/users/vexx32/following{/other_user}",
      "gists_url": "https://api.github.com/users/vexx32/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vexx32",
      "id": 32407840,
      "login": "vexx32",
      "node_id": "MDQ6VXNlcjMyNDA3ODQw",
      "organizations_url": "https://api.github.com/users/vexx32/orgs",
      "received_events_url": "https://api.github.com/users/vexx32/received_events",
      "repos_url": "https://api.github.com/users/vexx32/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vexx32/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vexx32/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vexx32"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Looks like it's most likely occurring here:\r\n\r\nhttps://github.com/PowerShell/PowerShell/blob/1ba2960f5c5df9de4c079c97644e9af7bf34385b/src/Microsoft.PowerShell.Commands.Utility/commands/utility/WebCmdlet/Common/WebRequestPSCmdlet.Common.cs#L1090\r\n\r\nThis HttpKnownHeaderNames is using a hashset stored in a static property to handle things; we may need to make that an instance class or threadstatic; there are likely to be errors that will occur running any of the web cmdlets in any kind of parallelized code right now as a result of this design.",
    "created_at": "2021-06-03T12:41:44Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15513#issuecomment-853838066",
    "id": 853838066,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15513",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1MzgzODA2Ng==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/853838066/reactions"
    },
    "updated_at": "2021-06-03T12:43:18Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/853838066",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/32407840?v=4",
      "events_url": "https://api.github.com/users/vexx32/events{/privacy}",
      "followers_url": "https://api.github.com/users/vexx32/followers",
      "following_url": "https://api.github.com/users/vexx32/following{/other_user}",
      "gists_url": "https://api.github.com/users/vexx32/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vexx32",
      "id": 32407840,
      "login": "vexx32",
      "node_id": "MDQ6VXNlcjMyNDA3ODQw",
      "organizations_url": "https://api.github.com/users/vexx32/orgs",
      "received_events_url": "https://api.github.com/users/vexx32/received_events",
      "repos_url": "https://api.github.com/users/vexx32/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vexx32/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vexx32/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vexx32"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "I guess it is in WebRequestSession.ContentHeaders.",
    "created_at": "2021-06-03T14:45:09Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15513#issuecomment-853925733",
    "id": 853925733,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15513",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1MzkyNTczMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/853925733/reactions"
    },
    "updated_at": "2021-06-03T14:45:09Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/853925733",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "Hello, thank you all for the quick response to my issue. Here are the details of the error I managed capture :\r\n\r\n**With $Error[0] | Select-Object**\r\n\r\n```\r\nInvoke-RestMethod: Operations that change non-concurrent collections must have exclusive access. A concurrent update was performed on this collection and corrupted its state. The collection's state is no longer correct.\r\nPS C:\\Users\\dpz83>  $Error[0] | Select-Object *\r\n\r\n\r\nPSMessageDetails      : \r\nException             : System.InvalidOperationException: Operations that change non-concurrent collections must have exclusive access. A concurrent update was performed on this collection and corrupted its state. The collection's state is no longer correct.\r\n                           at System.Collections.Generic.HashSet`1.AddIfNotPresent(T value, Int32& location)\r\n                           at System.Collections.Generic.HashSet`1.Add(T item)\r\n                           at Microsoft.PowerShell.Commands.HttpKnownHeaderNames.get_ContentHeaders()\r\n                           at Microsoft.PowerShell.Commands.WebRequestPSCmdlet.GetRequest(Uri uri)\r\n                           at Microsoft.PowerShell.Commands.WebRequestPSCmdlet.ProcessRecord()\r\n                           at System.Management.Automation.Cmdlet.DoProcessRecord()\r\n                           at System.Management.Automation.CommandProcessor.ProcessRecord()\r\nTargetObject          :\r\nCategoryInfo          : NotSpecified: (:) [Invoke-RestMethod], InvalidOperationException\r\nFullyQualifiedErrorId : System.InvalidOperationException,Microsoft.PowerShell.Commands.InvokeRestMethodCommand\r\nErrorDetails          :\r\nInvocationInfo        : System.Management.Automation.InvocationInfo\r\nScriptStackTrace      : at <ScriptBlock>, <No file>: line 1\r\nPipelineIterationInfo : {}\r\n```\r\n\r\n**And with Get-Error**\r\n\r\n```\r\nPS C:\\Users\\dpz83> Get-Error\r\n\r\n\r\nException             : \r\n    Type       : System.InvalidOperationException\r\n    TargetSite : \r\n        Name          : ThrowInvalidOperationException_ConcurrentOperationsNotSupported\r\n        DeclaringType : System.ThrowHelper, System.Private.CoreLib, Version=5.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e\r\n        MemberType    : Method\r\n        Module        : System.Private.CoreLib.dll\r\n    StackTrace : \r\n   at System.Collections.Generic.HashSet`1.AddIfNotPresent(T value, Int32& location)\r\n   at System.Collections.Generic.HashSet`1.Add(T item)\r\n   at Microsoft.PowerShell.Commands.HttpKnownHeaderNames.get_ContentHeaders()\r\n   at Microsoft.PowerShell.Commands.WebRequestPSCmdlet.GetRequest(Uri uri)\r\n   at Microsoft.PowerShell.Commands.WebRequestPSCmdlet.ProcessRecord()\r\n   at System.Management.Automation.Cmdlet.DoProcessRecord()\r\n   at System.Management.Automation.CommandProcessor.ProcessRecord()\r\n    Message    : Operations that change non-concurrent collections must have exclusive access. A concurrent update was performed on this collection and corrupted its state. The collection's state is no longer correct.\r\n    Source     : System.Private.CoreLib\r\n    HResult    : -2146233079\r\nCategoryInfo          : NotSpecified: (:) [Invoke-RestMethod], InvalidOperationException\r\nFullyQualifiedErrorId : System.InvalidOperationException,Microsoft.PowerShell.Commands.InvokeRestMethodCommand\r\nInvocationInfo        : \r\n    MyCommand        : Invoke-RestMethod\r\n    ScriptLineNumber : 1\r\n    OffsetInLine     : 2\r\n    HistoryId        : 1\r\n    Line             : Invoke-RestMethod -Uri \"www.google.com.br\" -Headers @{\r\n\r\n    PositionMessage  : At line:1 char:2\r\n                       +  Invoke-RestMethod -Uri \"www.google.com.br\" -Headers @{\r\n                       +  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    InvocationName   : Invoke-RestMethod\r\n    CommandOrigin    : Internal\r\nScriptStackTrace      : at <ScriptBlock>, <No file>: line 1\r\n```",
    "created_at": "2021-06-04T03:12:06Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15513#issuecomment-854326056",
    "id": 854326056,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15513",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1NDMyNjA1Ng==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/854326056/reactions"
    },
    "updated_at": "2021-06-04T03:12:06Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/854326056",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/42227137?v=4",
      "events_url": "https://api.github.com/users/dperez83/events{/privacy}",
      "followers_url": "https://api.github.com/users/dperez83/followers",
      "following_url": "https://api.github.com/users/dperez83/following{/other_user}",
      "gists_url": "https://api.github.com/users/dperez83/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/dperez83",
      "id": 42227137,
      "login": "dperez83",
      "node_id": "MDQ6VXNlcjQyMjI3MTM3",
      "organizations_url": "https://api.github.com/users/dperez83/orgs",
      "received_events_url": "https://api.github.com/users/dperez83/received_events",
      "repos_url": "https://api.github.com/users/dperez83/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/dperez83/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dperez83/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/dperez83"
    }
  },
  {
    "author_association": "NONE",
    "body": ":tada:This issue was addressed in #15519, which has now been successfully released as `v7.2.0-preview.9`.:tada:\n\nHandy links:\n* [Release Notes](https://github.com/PowerShell/PowerShell/releases/tag/v7.2.0-preview.9)\n",
    "created_at": "2021-08-23T18:35:59Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15513#issuecomment-904015063",
    "id": 904015063,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15513",
    "node_id": "IC_kwDOAvT7bc414izX",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/904015063/reactions"
    },
    "updated_at": "2021-08-23T18:35:59Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/904015063",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  },
  {
    "author_association": "NONE",
    "body": ":tada:This issue was addressed in #15519, which has now been successfully released as `v7.2.0-preview.10`.:tada:\n\nHandy links:\n* [Release Notes](https://github.com/PowerShell/PowerShell/releases/tag/v7.2.0-preview.10)\n",
    "created_at": "2021-09-28T23:17:50Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15513#issuecomment-929692470",
    "id": 929692470,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15513",
    "node_id": "IC_kwDOAvT7bc43afs2",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/929692470/reactions"
    },
    "updated_at": "2021-09-28T23:17:50Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/929692470",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  }
]

[
  {
    "author_association": "NONE",
    "body": "On Sat, Jul 9, 2022 at 11:55 AM Tolga Balci ***@***.***>\nwrote:\n\n> Prerequisites\n>\n>    - Write a descriptive title.\n>    - Make sure you are able to repro it on the latest released version\n>    <https://github.com/PowerShell/PowerShell/releases>\n>    - Search the existing issues.\n>    - Refer to the FAQ\n>    <https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md>.\n>    - Refer to Differences between Windows PowerShell 5.1 and PowerShell\n>    <https://docs.microsoft.com/powershell/scripting/whats-new/differences-from-windows-powershell>\n>    .\n>\n> Steps to reproduce\n>\n> Issue is -Force does not seem to understand junctions. It thinks they are\n> directories and fails to remove them because they are not empty.\n>\n> Works fine with file types. (see screenshot)\n>\n> Most types including registry entries allow -Force to overwrite the item.\n> Logically -Force should do the same for a Junction.\n>\n> Due to -Force not working you must first Remove-Item prior to New-Item,\n> which works perfectly fine. Remove-Item simply removes the junction and\n> does not complain that it is not empty. New-Item -Force needs the same\n> intelligence.\n> Expected behavior\n>\n> PS> New-Item MyWindows -Type Junction -Value C:\\Windows\\\n> PS> New-Item MyWindows -Type Junction -Value C:\\Windows\\ -Force\n> PS>\n>\n> Actual behavior\n>\n> PS> New-Item MyWindows -Type Junction -Value C:\\Windows\\\n> PS> New-Item MyWindows -Type Junction -Value C:\\Windows\\ -Force\n> New-Item: Directory C:\\Temp\\MyWindows cannot be removed because it is not empty.\n> PS>\n>\n> Error details\n>\n> �[92mException             : �[0m\n>     �[92mType    : �[0mSystem.IO.IOException\n>     �[92mMessage : �[0m�[31;1mDirectory C:\\Temp\\MyWindows cannot be removed because it is not empty.\n>     �[92mHResult : �[0m-2146232800\n> �[92mTargetObject          : �[0mC:\\Temp\\MyWindows\n> �[92mCategoryInfo          : �[0mWriteError: (C:\\Temp\\MyWindows:String) [New-Item], IOException\n> �[92mFullyQualifiedErrorId : �[0mDirectoryNotEmpty,Microsoft.PowerShell.Commands.NewItemCommand\n> �[92mInvocationInfo        : �[0m\n>     �[92mMyCommand        : �[0mNew-Item\n>     �[92mScriptLineNumber : �[0m1\n>     �[92mOffsetInLine     : �[0m1\n>     �[92mHistoryId        : �[0m5\n>     �[92mLine             : �[0mNew-Item MyWindows -Type Junction -Value C:\\Windows\\ -Force\n>     �[92mPositionMessage  : �[0mAt line:1 char:1\n>                        + New-Item MyWindows -Type Junction -Value C:\\Windows\\ -Force\n>                        + �[31;1m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n>     �[92mInvocationName   : �[0mNew-Item\n>     �[92mCommandOrigin    : �[0mInternal\n> �[92mScriptStackTrace      : �[0mat <ScriptBlock>, <No file>: line 1\n> �[92mPipelineIterationInfo : �[0m\n>\n> Environment data\n>\n> �[32;1mName                           Value�[0m\n>\n> �[32;1m----                           -----�[0m\n> PSVersion                      7.2.5\n> PSEdition                      Core\n> GitCommitId                    7.2.5\n> OS                             Microsoft Windows 10.0.19044\n> Platform                       Win32NT\n> PSCompatibleVersions           {1.0, 2.0, 3.0, 4.0ΓÇª}\n> PSRemotingProtocolVersion      2.3\n> SerializationVersion           1.1.0.1\n> WSManStackVersion              3.0\n>\n> Visuals\n>\n> [image: image]\n> <https://user-images.githubusercontent.com/2467618/178114827-34b53f8f-a177-4daf-abc3-c0a4d0640187.png>\n>\n> —\n> Reply to this email directly, view it on GitHub\n> <https://github.com/PowerShell/PowerShell/issues/17656>, or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AV4PEMAP2EE3PI32D6U3RYDVTGVINANCNFSM53DUCNBA>\n> .\n> You are receiving this because you are subscribed to this thread.Message\n> ID: ***@***.***>\n>\n-- \nJennifer Everett\n",
    "created_at": "2022-07-09T16:56:05Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17656#issuecomment-1179573767",
    "id": 1179573767,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17656",
    "node_id": "IC_kwDOAvT7bc5GTt4H",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1179573767/reactions"
    },
    "updated_at": "2022-10-17T16:57:51Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1179573767",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/91812400?v=4",
      "events_url": "https://api.github.com/users/Jeverett3000/events{/privacy}",
      "followers_url": "https://api.github.com/users/Jeverett3000/followers",
      "following_url": "https://api.github.com/users/Jeverett3000/following{/other_user}",
      "gists_url": "https://api.github.com/users/Jeverett3000/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Jeverett3000",
      "id": 91812400,
      "login": "Jeverett3000",
      "node_id": "U_kgDOBXjyMA",
      "organizations_url": "https://api.github.com/users/Jeverett3000/orgs",
      "received_events_url": "https://api.github.com/users/Jeverett3000/received_events",
      "repos_url": "https://api.github.com/users/Jeverett3000/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Jeverett3000/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Jeverett3000/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Jeverett3000"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@PowerShell/wg-powershell-cmdlets reviewed this.  We agree that the behavior using -Force should be consistent for different filesystem types including junctions, so this is a bug that should be fixed.",
    "created_at": "2022-10-05T16:58:14Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17656#issuecomment-1268692085",
    "id": 1268692085,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17656",
    "node_id": "IC_kwDOAvT7bc5LnrR1",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 1,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1268692085/reactions"
    },
    "updated_at": "2022-10-05T16:58:14Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1268692085",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  }
]

[
  {
    "author_association": "CONTRIBUTOR",
    "body": "Some general comments on this: I have a C# project that runs PowerShell. I want to control the streams. When I put logic in place to allow the streams to be controlled, whether or not I have turned the Information stream \"on\", I get output from that stream, with no metadata to let me know if that output should show up or not. This seems like a bug, because `InformationPreference` is `SilentlyContinue`, just like it is for `VerbosePreference` and `DebugPreference`.\r\n\r\nI have found a workaround for this, but it shouldn't be necessary, and I want to make sure it isn't doing something that I don't want to do. If I set `InformationPreference` to `Ignore`, the logic works as expected, and I can turn on Information stream output on demand within my script by using `InformationAction` on commands where I want that output. That workaround seems to be the only way that I can make the `Information` stream behave like it does in native PowerShell, but it shouldn't be necessary. Here is the above snippet with the workaround where I get the results that I expected in the first place:\r\n\r\n```powershell\r\n$ps = [powershell]::Create()\r\n$ps.AddScript(@'\r\n$InformationPreference = [System.Management.Automation.ActionPreference]::Ignore\r\nWrite-Information 'Information'\r\nWrite-Verbose 'Verbose'\r\nWrite-Debug 'Debug'\r\n'@).Invoke()\r\n$ps.Streams.Verbose # Empty, as expected\r\n$ps.Streams.Debug # Empty, as expected\r\n$ps.Streams.Information # Empty, as expected\r\n```\r\n",
    "created_at": "2020-09-14T19:32:20Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13631#issuecomment-692267219",
    "id": 692267219,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13631",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5MjI2NzIxOQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/692267219/reactions"
    },
    "updated_at": "2020-09-14T19:32:31Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/692267219",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/3515485?v=4",
      "events_url": "https://api.github.com/users/KirkMunro/events{/privacy}",
      "followers_url": "https://api.github.com/users/KirkMunro/followers",
      "following_url": "https://api.github.com/users/KirkMunro/following{/other_user}",
      "gists_url": "https://api.github.com/users/KirkMunro/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/KirkMunro",
      "id": 3515485,
      "login": "KirkMunro",
      "node_id": "MDQ6VXNlcjM1MTU0ODU=",
      "organizations_url": "https://api.github.com/users/KirkMunro/orgs",
      "received_events_url": "https://api.github.com/users/KirkMunro/received_events",
      "repos_url": "https://api.github.com/users/KirkMunro/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/KirkMunro/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/KirkMunro/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/KirkMunro"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "After discussing this in Discord, I bet this is probably due to the desire for `Write-Host` output to be capturable in the transcript, but if that is the desired result, the implementation is wrong because there is no use of `Write-Host` here.",
    "created_at": "2020-09-14T19:38:30Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13631#issuecomment-692270291",
    "id": 692270291,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13631",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5MjI3MDI5MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/692270291/reactions"
    },
    "updated_at": "2020-09-14T19:38:30Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/692270291",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/3515485?v=4",
      "events_url": "https://api.github.com/users/KirkMunro/events{/privacy}",
      "followers_url": "https://api.github.com/users/KirkMunro/followers",
      "following_url": "https://api.github.com/users/KirkMunro/following{/other_user}",
      "gists_url": "https://api.github.com/users/KirkMunro/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/KirkMunro",
      "id": 3515485,
      "login": "KirkMunro",
      "node_id": "MDQ6VXNlcjM1MTU0ODU=",
      "organizations_url": "https://api.github.com/users/KirkMunro/orgs",
      "received_events_url": "https://api.github.com/users/KirkMunro/received_events",
      "repos_url": "https://api.github.com/users/KirkMunro/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/KirkMunro/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/KirkMunro/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/KirkMunro"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "`Write-Information` is by default also capturable in a transcript, even if it never appears on screen. I always assumed that was intentional.",
    "created_at": "2020-09-14T20:56:35Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13631#issuecomment-692309666",
    "id": 692309666,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13631",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5MjMwOTY2Ng==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/692309666/reactions"
    },
    "updated_at": "2020-09-14T20:56:35Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/692309666",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/32407840?v=4",
      "events_url": "https://api.github.com/users/vexx32/events{/privacy}",
      "followers_url": "https://api.github.com/users/vexx32/followers",
      "following_url": "https://api.github.com/users/vexx32/following{/other_user}",
      "gists_url": "https://api.github.com/users/vexx32/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vexx32",
      "id": 32407840,
      "login": "vexx32",
      "node_id": "MDQ6VXNlcjMyNDA3ODQw",
      "organizations_url": "https://api.github.com/users/vexx32/orgs",
      "received_events_url": "https://api.github.com/users/vexx32/received_events",
      "repos_url": "https://api.github.com/users/vexx32/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vexx32/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vexx32/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vexx32"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "It is not for Write-Host and not for a transcript. The code explicitly is `if (preference != ActionPreference.Ignore)` - write if not \"Ignore\". I believe it is by design and changing this would be huge breaking change since events are triggered there for other threads.",
    "created_at": "2020-09-15T13:50:33Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13631#issuecomment-692728104",
    "id": 692728104,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13631",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5MjcyODEwNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/692728104/reactions"
    },
    "updated_at": "2020-09-15T13:50:33Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/692728104",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "I suppose, why be consistent, right? Just because the error, warning, verbose, debug and progress streams can be silenced using `System.Management.Automation.ActionPreference.SilentlyContinue`, why should the information stream work the same way? That would make too much sense. 🙄 ",
    "created_at": "2020-09-15T16:32:18Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13631#issuecomment-692830842",
    "id": 692830842,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13631",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5MjgzMDg0Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 1,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/692830842/reactions"
    },
    "updated_at": "2020-09-15T16:32:18Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/692830842",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/3515485?v=4",
      "events_url": "https://api.github.com/users/KirkMunro/events{/privacy}",
      "followers_url": "https://api.github.com/users/KirkMunro/followers",
      "following_url": "https://api.github.com/users/KirkMunro/following{/other_user}",
      "gists_url": "https://api.github.com/users/KirkMunro/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/KirkMunro",
      "id": 3515485,
      "login": "KirkMunro",
      "node_id": "MDQ6VXNlcjM1MTU0ODU=",
      "organizations_url": "https://api.github.com/users/KirkMunro/orgs",
      "received_events_url": "https://api.github.com/users/KirkMunro/received_events",
      "repos_url": "https://api.github.com/users/KirkMunro/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/KirkMunro/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/KirkMunro/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/KirkMunro"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "The code is so simple that I can only say it is definitely by design and I don't know why. Perhaps someone from MSFT team knows this history.\r\n",
    "created_at": "2020-09-15T17:13:22Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13631#issuecomment-692853127",
    "id": 692853127,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13631",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5Mjg1MzEyNw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/692853127/reactions"
    },
    "updated_at": "2020-09-15T17:13:22Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/692853127",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@vexx32, the transcript behavior with respect to `Write-Information` has been fixed (after all, a transcript should not show different output than the console), though I'm not sure in what version exactly, and I'm not aware of an associated bug report (still affects Windows PowerShell; see also: #4645).\r\n\r\nLet me try to summarize the troubling inconsistency (derived from observation, not source-code analysis):\r\n\r\n* Unlike with all other streams, `SilentlyContinue` for stream `6` (`Write-Information`) does _not_ suppress _writing to the stream at the source_.\r\n\r\n* Seemingly, it is unexpectedly left to the _host_ to enforce the silence _for display_.\r\n\r\nThis is easy to demonstrate: a redirection of stream `6` succeeds even with `-InformationAction SilentlyContinue`:\r\n\r\n```powershell\r\nPS> Write-Information info -Infa SilentlyContinue 6>&1 | % { \"[$_]\" }\r\n[info]  # !! stream output was still produced and redirected to the success stream.\r\n```\r\n\r\nTo contrast this with the behavior of the `Write-*` cmdlets for the other streams:\r\n\r\n```powershell\r\n'Write-Error', 'Write-Warning', 'Write-Verbose', 'Write-Debug', 'Write-Information' | % {\r\n  $stream = ($_ -split '-')[-1]\r\n  $htArgs = if ($stream -in 'Debug', 'Verbose') { # Boolean common parameters\r\n    @{\r\n      $stream = $false\r\n    }\r\n  } else { # enum-based common parameters\r\n    @{\r\n      ($stream + 'Action') = 'SilentlyContinue'\r\n    }\r\n  }\r\n  $out = & $_ @htArgs $stream *>&1\r\n  \"redirected $stream`: [$out]\"\r\n}\r\n```\r\n\r\n```none\r\nredirected Error: []\r\nredirected Warning: []\r\nredirected Verbose: []\r\nredirected Debug: []\r\nredirected Information: [Information]\r\n```\r\n\r\n\r\n\r\n\r\n\r\n",
    "created_at": "2020-09-15T18:29:54Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13631#issuecomment-692895500",
    "id": 692895500,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13631",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5Mjg5NTUwMA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 3,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 3,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/692895500/reactions"
    },
    "updated_at": "2020-09-15T18:30:28Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/692895500",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  }
]

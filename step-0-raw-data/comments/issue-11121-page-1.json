[
  {
    "author_association": "MEMBER",
    "body": "@mklement0 I think your test is flawed, your query returns `TargetSite` which itself is an object and only one member of the InnerException.  Here's what I see running it manually:\r\n\r\n```powershell\r\nPS> [int]::Parse('foo')\r\nMethodInvocationException: Exception calling \"Parse\" with \"1\" argument(s): \"Input string was not in a correct format.\"\r\n[30.08ms] /Users/steve/repos/PowerShell [origin/get-error-exception-type]\r\nPS> gerr\r\n\r\nException             :\r\n    ErrorRecord    :\r\n        Exception             :\r\n            Message : Exception calling \"Parse\" with \"1\" argument(s): \"Input string was not in a correct format.\"\r\n            HResult : -2146233087\r\n        CategoryInfo          : NotSpecified: (:) [], ParentContainsErrorRecordException\r\n        FullyQualifiedErrorId : FormatException\r\n        InvocationInfo        :\r\n            ScriptLineNumber : 1\r\n            OffsetInLine     : 1\r\n            HistoryId        : -1\r\n            Line             : [int]::Parse('foo')\r\n            PositionMessage  : At line:1 char:1\r\n                               + [int]::Parse('foo')\r\n                               + ~~~~~~~~~~~~~~~~~~~\r\n            CommandOrigin    : Internal\r\n        ScriptStackTrace      : at <ScriptBlock>, <No file>: line 1\r\n    TargetSite     :\r\n        Name          : ConvertToMethodInvocationException\r\n        DeclaringType : System.Management.Automation.ExceptionHandlingOps\r\n        MemberType    : Method\r\n        Module        : System.Management.Automation.dll\r\n    StackTrace     :\r\n   at System.Management.Automation.ExceptionHandlingOps.ConvertToMethodInvocationException(Exception exception, Type\r\ntypeToThrow, String methodName, Int32 numArgs, MemberInfo memberInfo)\r\n   at CallSite.Target(Closure , CallSite , Type , String )\r\n   at System.Dynamic.UpdateDelegates.UpdateAndExecute2[T0,T1,TRet](CallSite site, T0 arg0, T1 arg1)\r\n   at System.Management.Automation.Interpreter.DynamicInstruction`3.Run(InterpretedFrame frame)\r\n   at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame)\r\n    Message        : Exception calling \"Parse\" with \"1\" argument(s): \"Input string was not in a correct format.\"\r\n    Data           : System.Collections.ListDictionaryInternal\r\n    InnerException :\r\n        TargetSite :\r\n            Name          : ThrowOverflowOrFormatException\r\n            DeclaringType : System.Number\r\n            MemberType    : Method\r\n            Module        : System.Private.CoreLib.dll\r\n        StackTrace :\r\n   at System.Number.ThrowOverflowOrFormatException(ParsingStatus status, TypeCode type)\r\n   at System.Number.ParseInt32(ReadOnlySpan`1 value, NumberStyles styles, NumberFormatInfo info)\r\n   at CallSite.Target(Closure , CallSite , Type , String )\r\n        Message    : Input string was not in a correct format.\r\n        Source     : System.Private.CoreLib\r\n        HResult    : -2146233033\r\n    Source         : System.Management.Automation\r\n    HResult        : -2146233087\r\nCategoryInfo          : NotSpecified: (:) [], MethodInvocationException\r\nFullyQualifiedErrorId : FormatException\r\nInvocationInfo        :\r\n    ScriptLineNumber : 1\r\n    OffsetInLine     : 1\r\n    HistoryId        : -1\r\n    Line             : [int]::Parse('foo')\r\n    PositionMessage  : At line:1 char:1\r\n                       + [int]::Parse('foo')\r\n                       + ~~~~~~~~~~~~~~~~~~~\r\n    CommandOrigin    : Internal\r\nScriptStackTrace      : at <ScriptBlock>, <No file>: line 1\r\n```\r\n\r\nThe InnerException is there and expanded.  It just happens that the colons align but the indentation shows the members.",
    "created_at": "2019-11-19T19:21:04Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11121#issuecomment-555667366",
    "id": 555667366,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11121",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NTY2NzM2Ng==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/555667366/reactions"
    },
    "updated_at": "2019-11-19T19:21:04Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/555667366",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Thanks, @SteveL-MSFT  - indeed I missed that the information is there.\r\n\r\nWhat caused the confusion is that `TargetSite: ` information _comes first_, which I didn't expect.\r\n\r\nHow do you feel about making sure that at least the `Message :` line comes first?",
    "created_at": "2019-11-19T19:24:37Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11121#issuecomment-555668951",
    "id": 555668951,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11121",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NTY2ODk1MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/555668951/reactions"
    },
    "updated_at": "2019-11-19T19:24:37Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/555668951",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Thinking about pending PR, #11076, I suggest making at least the following two lines (properties) _always_ come first:\r\n\r\n * `Type: ` (full exception type name)\r\n\r\n* `Message :`\r\n\r\nIf there are additional properties that are _always_ populated, I suggest listing them before those that are situationally missing.\r\n\r\n",
    "created_at": "2019-11-19T20:13:06Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11121#issuecomment-555691468",
    "id": 555691468,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11121",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NTY5MTQ2OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/555691468/reactions"
    },
    "updated_at": "2019-11-19T20:13:06Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/555691468",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@mklement0 the current order of the properties is what `$_.psobject.properties` returns.  We can certainly change the ordering.  It's hard to rely on properties that are *always* populated as I don't think any of it is enforced and Exceptions and ErrorRecords (particularly nested objects) can be any form.",
    "created_at": "2019-11-19T20:26:25Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11121#issuecomment-555697141",
    "id": 555697141,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11121",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NTY5NzE0MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/555697141/reactions"
    },
    "updated_at": "2019-11-19T20:26:25Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/555697141",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "I think it definitely makes sense to put type and message first - they are always available and the most important properties.\r\n\r\nI suggest putting the non-primitive properties (the ones with properties of their own or  \"noisy\" multi-line values) _last_, in that order:\r\n\r\n* `Data`\r\n* `TargetSite`\r\n* `StackTrace`\r\n\r\nThen follow that by a nested, indented `InnerException` block, as suggested in #11123 \r\n\r\nMy suggestion for the ordering of the remaining standard `System.Exception` properties - to go between type + message and the  non-primitive ones - is this:\r\n\r\n* `Source`\r\n* `HResult`\r\n* `HelpLink`\r\n\r\n\r\n\r\n",
    "created_at": "2019-11-19T21:01:25Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11121#issuecomment-555712295",
    "id": 555712295,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11121",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NTcxMjI5NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/555712295/reactions"
    },
    "updated_at": "2019-11-19T21:01:25Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/555712295",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  }
]

[
  {
    "author_association": "CONTRIBUTOR",
    "body": "> The alternative is to allow opening non-executable files by file name only, but only in the current directory.\r\n\r\nOr maybe if at least a relative path is provided?",
    "created_at": "2019-04-25T22:32:47Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9469#issuecomment-486861403",
    "id": 486861403,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9469",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4Njg2MTQwMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/486861403/reactions"
    },
    "updated_at": "2019-04-25T22:32:47Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/486861403",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/26179051?v=4",
      "events_url": "https://api.github.com/users/msftrncs/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftrncs/followers",
      "following_url": "https://api.github.com/users/msftrncs/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftrncs/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/msftrncs",
      "id": 26179051,
      "login": "msftrncs",
      "node_id": "MDQ6VXNlcjI2MTc5MDUx",
      "organizations_url": "https://api.github.com/users/msftrncs/orgs",
      "received_events_url": "https://api.github.com/users/msftrncs/received_events",
      "repos_url": "https://api.github.com/users/msftrncs/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftrncs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftrncs/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/msftrncs"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@msftrncs: That already works and should continue to work.",
    "created_at": "2019-04-25T22:49:30Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9469#issuecomment-486865058",
    "id": 486865058,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9469",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4Njg2NTA1OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/486865058/reactions"
    },
    "updated_at": "2019-04-25T22:49:30Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/486865058",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "On second thought: To keep things simple, it's better to limit filename-only invocation to _executables_ in `$env:PATH`, so I suggest _always_ requiring a (potentially relative with `./`) path for non-executables (documents).  \r\n\r\nFilename-only targeting (for documents in the current dir.) can be already had via _commands_, namely `Invoke-Item <documentFileName>` and `Start-Process <documentFileName>`.\r\n",
    "created_at": "2019-04-26T01:30:29Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9469#issuecomment-486893259",
    "id": 486893259,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9469",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4Njg5MzI1OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/486893259/reactions"
    },
    "updated_at": "2019-04-26T01:30:29Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/486893259",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "What about script files with shebang? My thoughts is that we don't analyze that file is executable.",
    "created_at": "2019-04-26T06:08:55Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9469#issuecomment-486937902",
    "id": 486937902,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9469",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NjkzNzkwMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/486937902/reactions"
    },
    "updated_at": "2019-04-26T06:08:55Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/486937902",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Let me summarize (partly for myself to get clarity):\r\n\r\n* On Windows, it is only a file's filename extension that determines whether you can directly invoke it _without needing to specify its extension_ (and even native binaries need such an extension on Windows).\r\n\r\n  * If you do specify the filename _with its extension_, there is ultimately no difference between an executable and a document: the file type associated with the filename extension determines (via the registry) determines whether the file is executed directly or what interpreter / application to pass it to.\r\n\r\n* On Unix, it is solely the executable permissions bit (set via `chmod`) that makes a file executable.\r\n\r\n  * If an executable file is a native binary, it executes directly.\r\n  * If it is a plain-text file, it is the shebang line that determines what interpreter the file is passed to for execution.\r\n  * Filename extensions (more typically called _suffixes_ in the Unix world) are _incidental_ to this mechanism - you must always specify the filename exactly in order to execute a file - _including_ the suffix, _if_ it has one, which is unusual in the Unix world (leaving the bad habit of creating shell scripts with suffix `.sh` aside).\r\n  * Non-executable files (documents) can _never_ be executed directly; you either execute the appropriate application instead and pass the document file path to it, or you use a generic utility that locates and executes the appropriate application based on the filename suffix, analogous to file-type definitions on Windows. \r\n  * There is no standard for such a utility in the Unix world, because there is no standardized GUI shell; for instance, macOS has the `open` utility, and `xdg-open` is used on (typically) Linux distros that use [freedesktop.org](http://freedesktop.org)-compliant desktops, such as Ubuntu.\r\n\r\nIn other words: on neither platform do you need to look at the _content_ of the file to determine _whether_ it is executable (and, as stated, if you specify the filename _including extension_ on Windows, any file is \"executable\").\r\n\r\nWhat that means for extension-less files _on Windows_, including those that happen to be plain-text script files with a shebang line:\r\n\r\n* While `*.cmd` exe does allow opening documents (non-executables) by exact filename without a path component via `$env:Path`, by default it does _not_ support that mechanism for _extension-less_ files; extension-less filenames are only supported if you explicitly add pseudo extension `.` to `$env:PATHEXT`.\r\n\r\n  * Note that it is precisely this open-a-document via `$env:Path` behavior I'm proposing be _disabled_ in PowerShell, because to me it makes conceptually more sense to limit `$env:Path` lookups to true executables.\r\nThat way you won't be able to accidentally open a document in a location other than the current one by specifying its file name only: users expect to be able to invoke _executables_ by file name only that are located in some standard location, not _documents_.\r\n\r\n* By contrast, PowerShell _already_ supports direct invocation of extension-less files via `$env:Path`, though by default there is no file type defined for such files, and you - sensibly get the default dialog allowing you to choose what application to open the file with (given that the appropriate application cannot be _inferred_, due to the absence of an extension).\r\n\r\n  * Note that if this proposal is implemented, PowerShell should then _only_ allow direct invocation of extension-less files if pseudo extension `.` has been added to `$env:PATHEXT` (given that without it, such files should be considered _documents_).\r\n\r\n  * To install a custom file type for handling extension-less files, you must define a file type as, say, `HKEY_CLASSES_ROOT\\ShebangFile` and map pseudo extension `.` to it, via `HKEY_CLASSES_ROOT\\.`\r\n  \r\n  * You can use this mechanism to install a _custom_ shebang-line handler: make the file type invoke a helper utility that analyzes the shebang line, if any, of the extension-less file being invoked, and pass the file to the appropriate interpreter (note that installing such a mechanism could be considered a security risk).\r\n\r\n  * The above is what I've attempted in [this Stack Overflow answer](https://stackoverflow.com/a/55619189/45375), but its functioning is currently hampered by PowerShell invariably using `ShellExecute` to invoke extension-less files, which means that the custom handler invariably runs in a _new_ console window - see #9430 and #7769.\r\n\r\n---\r\n\r\nNow, what was your question? 😁\r\n",
    "created_at": "2019-04-26T13:56:40Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9469#issuecomment-487066114",
    "id": 487066114,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9469",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NzA2NjExNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/487066114/reactions"
    },
    "updated_at": "2019-04-26T14:01:02Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/487066114",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  }
]

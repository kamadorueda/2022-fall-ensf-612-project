[
  {
    "author_association": "NONE",
    "body": "This issue causes other issues. In particular it is not possible to use `Microsoft.VisualBasic.Logging.FileLogTraceListener` because its constructor calls `System.Windows.Forms.Application.UserAppDataPath`.",
    "created_at": "2022-09-20T05:51:28Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/18131#issuecomment-1251871950",
    "id": 1251871950,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/18131",
    "node_id": "IC_kwDOAvT7bc5KngzO",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1251871950/reactions"
    },
    "updated_at": "2022-09-20T05:51:49Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1251871950",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/927533?v=4",
      "events_url": "https://api.github.com/users/nightroman/events{/privacy}",
      "followers_url": "https://api.github.com/users/nightroman/followers",
      "following_url": "https://api.github.com/users/nightroman/following{/other_user}",
      "gists_url": "https://api.github.com/users/nightroman/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/nightroman",
      "id": 927533,
      "login": "nightroman",
      "node_id": "MDQ6VXNlcjkyNzUzMw==",
      "organizations_url": "https://api.github.com/users/nightroman/orgs",
      "received_events_url": "https://api.github.com/users/nightroman/received_events",
      "repos_url": "https://api.github.com/users/nightroman/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/nightroman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nightroman/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/nightroman"
    }
  },
  {
    "author_association": "NONE",
    "body": "There is more issues than UserAppDataPath : \r\n\r\n```\r\n>  Add-Type -AssemblyName System.Windows.Forms\r\n\r\n> [System.Windows.Forms.Application]::CommonAppDataPath\r\nOperationStopped: The directory name is invalid. : 'C:\\ProgramData\\Microsoft Corporation\\PowerShell\\7.2.6 SHA: eb2c4accddda2995e50cd349e655888500899d8b'\r\n\r\n> [System.Windows.Forms.Application]::UserAppDataPath\r\nOperationStopped: The directory name is invalid. : 'C:\\Users\\Flavien\\AppData\\Roaming\\Microsoft Corporation\\PowerShell\\7.2.6 SHA: eb2c4accddda2995e50cd349e655888500899d8b'\r\n\r\n> [System.Windows.Forms.Application]::LocalUserAppDataPath\r\nOperationStopped: The directory name is invalid. : 'C:\\Users\\Flavien\\AppData\\Local\\Microsoft Corporation\\PowerShell\\7.2.6 SHA: eb2c4accddda2995e50cd349e655888500899d8b'\r\n\r\n> [System.Windows.Forms.Application]::CommonAppDataRegistry.ToString()\r\nHKEY_LOCAL_MACHINE\\Software\\Microsoft Corporation\\PowerShell\\7.3.0-preview.6 SHA: bcafe74c174091a0f47cf7a5eeb4bca8aefa8718\r\n```\r\n\r\nThe documentation said if a path does not exist, one is created in the following format:\r\n\r\n_Base Path\\CompanyName\\ProductName\\ProductVersion_\r\n\r\nsource : [learn.microsoft.com|Application.UserAppDataPath](https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.application.userappdatapath?view=windowsdesktop-6.0#remarks)\r\n\r\nThe problem is located in pwsh.exe where the ProductVersion contains a \":\" colon.\r\n\r\n```\r\n> (Get-Command powershell.exe | Get-Item).VersionInfo.ProductVersion\r\n10.0.19041.1\r\n\r\n> (Get-Command pwsh.exe | Get-Item).VersionInfo.ProductVersion\r\n7.2.6 SHA: eb2c4accddda2995e50cd349e655888500899d8b\r\n```\r\n\r\n",
    "created_at": "2022-09-22T18:37:02Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/18131#issuecomment-1255406481",
    "id": 1255406481,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/18131",
    "node_id": "IC_kwDOAvT7bc5K0_uR",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1255406481/reactions"
    },
    "updated_at": "2022-09-22T18:37:02Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1255406481",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6187529?v=4",
      "events_url": "https://api.github.com/users/fMichaleczek/events{/privacy}",
      "followers_url": "https://api.github.com/users/fMichaleczek/followers",
      "following_url": "https://api.github.com/users/fMichaleczek/following{/other_user}",
      "gists_url": "https://api.github.com/users/fMichaleczek/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/fMichaleczek",
      "id": 6187529,
      "login": "fMichaleczek",
      "node_id": "MDQ6VXNlcjYxODc1Mjk=",
      "organizations_url": "https://api.github.com/users/fMichaleczek/orgs",
      "received_events_url": "https://api.github.com/users/fMichaleczek/received_events",
      "repos_url": "https://api.github.com/users/fMichaleczek/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/fMichaleczek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fMichaleczek/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/fMichaleczek"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "We followed .Net in this. In 7.0 they changed this to semantic version. We could do the same.\r\n\r\n----\r\n\r\nAlthough it is too reckless for WinForms to trust this attribute. I would advise you to open new issue there too.",
    "created_at": "2022-09-23T04:57:37Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/18131#issuecomment-1255802262",
    "id": 1255802262,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/18131",
    "node_id": "IC_kwDOAvT7bc5K2gWW",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1255802262/reactions"
    },
    "updated_at": "2022-09-23T04:57:37Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1255802262",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "> We followed .Net in this. In 7.0 they changed this to semantic version. We could do the same.\r\n\r\n```\r\n> (Get-Command dotnet.exe | Get-Item).VersionInfo.ProductVersion\r\n7.0.0-preview.7.22375.6 @Commit: eecb02807867cad56cd05badddef65e432248b75\r\n```\r\n\r\nthere is a commit version but dotnet.exe isn't a Windows UI app model, and pwsh.exe is not a console app on Windows ?\r\n\r\n```\r\n> (Get-Item $PSHome\\System.Windows.Forms.dll).VersionInfo.ProductVersion\r\n7.0.0-preview.6.22351.2+f6720164c48ea0de634e574de94dd8450f761b25\r\n```\r\n> Although it is too reckless for WinForms to trust this attribute. I would advise you to open new issue there too.\r\n\r\nProductVersion is a special attribute for Windows UI app mode, it's not a free string in this context.\r\nI don't think we should ask to open a issue about a breaking in the Winforms .NET Framework 1.1 Application API.\r\n\r\n```\r\n> # List Product Version\r\n> (Get-Item $PSHome\\*.dll).VersionInfo.ProductVersion | Select-Object -Unique\r\n```",
    "created_at": "2022-09-23T17:58:26Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/18131#issuecomment-1256513648",
    "id": 1256513648,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/18131",
    "node_id": "IC_kwDOAvT7bc5K5OBw",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1256513648/reactions"
    },
    "updated_at": "2022-09-23T17:58:26Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1256513648",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6187529?v=4",
      "events_url": "https://api.github.com/users/fMichaleczek/events{/privacy}",
      "followers_url": "https://api.github.com/users/fMichaleczek/followers",
      "following_url": "https://api.github.com/users/fMichaleczek/following{/other_user}",
      "gists_url": "https://api.github.com/users/fMichaleczek/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/fMichaleczek",
      "id": 6187529,
      "login": "fMichaleczek",
      "node_id": "MDQ6VXNlcjYxODc1Mjk=",
      "organizations_url": "https://api.github.com/users/fMichaleczek/orgs",
      "received_events_url": "https://api.github.com/users/fMichaleczek/received_events",
      "repos_url": "https://api.github.com/users/fMichaleczek/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/fMichaleczek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fMichaleczek/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/fMichaleczek"
    }
  }
]

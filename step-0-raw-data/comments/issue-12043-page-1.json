[
  {
    "author_association": "CONTRIBUTOR",
    "body": "This is fixed by #11980 \r\n\r\nIn short: depending on the value of `PSModulePath` - in the default case - this line `Import-Module Microsoft.PowerShell.Management -UseWindowsPowerShell -wa si` will import version `7.0.0.0` of the module in Windows PowerShell, so there is no surprise that `Get-WmiObject` is not found.\r\nThis can be checked by running following in the end of repro steps:\r\n```\r\nPS C:\\> $s = Get-PSSession -Name WinPSCompatSession\r\nPS C:\\> Icm $s {Get-Module -Name Microsoft.PowerShell.Management}\r\n\r\nModuleType Version    PreRelease Name                                ExportedCommands                           PSComputerName\r\n---------- -------    ---------- ----                                ----------------                           --------------\r\nManifest   7.0.0.0               Microsoft.PowerShell.Management     {New-ItemProperty, Set-Item, Push-Locatioâ€¦ localhost\r\n```\r\nA workaround can be loading module by path:\r\n`Import-Module \"$env:windir\\System32\\WindowsPowerShell\\v1.0\\Modules\\Microsoft.PowerShell.Management\\Microsoft.PowerShell.Management.psd1\" -UseWindowsPowerShell -wa si`",
    "created_at": "2020-03-06T00:44:53Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12043#issuecomment-595518557",
    "id": 595518557,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12043",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5NTUxODU1Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 1,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/595518557/reactions"
    },
    "updated_at": "2020-03-06T00:44:53Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/595518557",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11860095?v=4",
      "events_url": "https://api.github.com/users/anmenaga/events{/privacy}",
      "followers_url": "https://api.github.com/users/anmenaga/followers",
      "following_url": "https://api.github.com/users/anmenaga/following{/other_user}",
      "gists_url": "https://api.github.com/users/anmenaga/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/anmenaga",
      "id": 11860095,
      "login": "anmenaga",
      "node_id": "MDQ6VXNlcjExODYwMDk1",
      "organizations_url": "https://api.github.com/users/anmenaga/orgs",
      "received_events_url": "https://api.github.com/users/anmenaga/received_events",
      "repos_url": "https://api.github.com/users/anmenaga/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/anmenaga/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/anmenaga/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/anmenaga"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@anmenaga:\r\n\r\nWithout having looked at #11980:\r\n\r\n* The suggested workaround is effective with respect to the ability to call `Get-WmiObject`, but has the major side effect of replacing all `Microsoft.PowerShell.Management` cmdlets with implicitly-remoting WinPS proxy functions, which causes the problems described in  #12014.\r\n\r\n* The problem here is that _in recent Windows 10 versions_ - as of at least version `1909` - the `C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\Modules\\Microsoft.PowerShell.Management` module is unexpectedly - and, I presume, _inappropriately_ - tagged as _being PS Core-compatible_ - see https://github.com/PowerShell/PowerShell/issues/12172#issuecomment-602100870 (update: a [fix is pending](https://github.com/PowerShell/PowerShell/issues/12172#issuecomment-602828905)).\r\n",
    "created_at": "2020-03-21T22:33:02Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12043#issuecomment-602114022",
    "id": 602114022,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12043",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwMjExNDAyMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/602114022/reactions"
    },
    "updated_at": "2020-03-23T20:23:11Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/602114022",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  }
]

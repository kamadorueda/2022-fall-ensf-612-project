[
  {
    "author_association": "COLLABORATOR",
    "body": "Another repo\r\n\r\nSteps to reproduce\r\n------------------\r\n\r\n```powershell\r\n[System.Management.ManagementPath]::DefaultPath\r\n```\r\n\r\nExpected behavior\r\n-----------------\r\n```none\r\nNo exception\r\n```\r\n\r\nActual behavior\r\n---------------\r\n\r\n```\r\nThe type initializer for 'System.Management.ManagementPath' threw an exception.\r\nAt line:1 char:1\r\n+ [System.Management.ManagementPath]::DefaultPath\r\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+ CategoryInfo          : OperationStopped: (:) [], TypeInitializationException\r\n+ FullyQualifiedErrorId : System.TypeInitializationException\r\n\r\n $error[0].Exception | fl -Force\r\n\r\n\r\nTypeName       : System.Management.ManagementPath\r\nMessage        : The type initializer for 'System.Management.ManagementPath' threw an exception.\r\nData           : {}\r\nInnerException : System.TypeInitializationException: The type initializer for\r\n                 'System.Management.WmiNetUtilsHelper' threw an exception. ---> System.ArgumentNullException:\r\n                 Value cannot be null.\r\n                 Parameter name: ptr\r\n                    at System.Runtime.InteropServices.Marshal.GetDelegateForFunctionPointer(IntPtr ptr, Type\r\n                 t)\r\n                    at System.Runtime.InteropServices.Marshal.GetDelegateForFunctionPointer[TDelegate](IntPtr\r\n                 ptr)\r\n                    at System.Management.WmiNetUtilsHelper.LoadDelegate[TDelegate](TDelegate& delegate_f,\r\n                 IntPtr hModule, String procName)\r\n                    at System.Management.WmiNetUtilsHelper..cctor()\r\n                    --- End of inner exception stack trace ---\r\n                    at System.Management.MTAHelper.IsNoContextMTA()\r\n                    at System.Management.MTAHelper.CreateInMTA(Type type)\r\n                    at System.Management.ManagementPath.CreateWbemPath(String path)\r\n                    at System.Management.ManagementPath..ctor(String path)\r\n                    at System.Management.ManagementPath..cctor()\r\nTargetSite     : System.Management.ManagementScope _Clone(System.Management.ManagementScope,\r\n                 System.Management.IdentifierChangedEventHandler)\r\nStackTrace     :    at System.Management.ManagementScope._Clone(ManagementScope scope,\r\n                 IdentifierChangedEventHandler handler)\r\n                    at System.Management.ManagementObjectSearcher..ctor(ManagementScope scope, ObjectQuery\r\n                 query, EnumerationOptions options)\r\n                    at Microsoft.PowerShell.Commands.GetProcessCommand.RetrieveProcessCommandLine(Process\r\n                 process) in Process.cs:line 865\r\n                    at Microsoft.PowerShell.Commands.GetProcessCommand.AddCommandLineToProcess(Process\r\n                 process) in Process.cs:line 843\r\n                    at Microsoft.PowerShell.Commands.GetProcessCommand.ProcessRecord() in Process.cs:line 696\r\n                    at System.Management.Automation.Cmdlet.DoProcessRecord() in cmdlet.cs:line 170\r\n                    at System.Management.Automation.CommandProcessor.ProcessRecord() in CommandProcessor.cs:line\r\n                 346\r\nHelpLink       :\r\nSource         : System.Management\r\nHResult        : -2146233036\r\n\r\n\r\n\r\nPS > $error[0].Exception.InnerException | fl -Force\r\n\r\n\r\nTypeName       : System.Management.WmiNetUtilsHelper\r\nMessage        : The type initializer for 'System.Management.WmiNetUtilsHelper' threw an exception.\r\nData           : {}\r\nInnerException : System.ArgumentNullException: Value cannot be null.\r\n                 Parameter name: ptr\r\n                    at System.Runtime.InteropServices.Marshal.GetDelegateForFunctionPointer(IntPtr ptr, Type\r\n                 t)\r\n                    at System.Runtime.InteropServices.Marshal.GetDelegateForFunctionPointer[TDelegate](IntPtr\r\n                 ptr)\r\n                    at System.Management.WmiNetUtilsHelper.LoadDelegate[TDelegate](TDelegate& delegate_f,\r\n                 IntPtr hModule, String procName)\r\n                    at System.Management.WmiNetUtilsHelper..cctor()\r\nTargetSite     : Boolean IsNoContextMTA()\r\nStackTrace     :    at System.Management.MTAHelper.IsNoContextMTA()\r\n                    at System.Management.MTAHelper.CreateInMTA(Type type)\r\n                    at System.Management.ManagementPath.CreateWbemPath(String path)\r\n                    at System.Management.ManagementPath..ctor(String path)\r\n                    at System.Management.ManagementPath..cctor()\r\nHelpLink       :\r\nSource         : System.Management\r\nHResult        : -2146233036\r\n\r\n```\r\n",
    "created_at": "2018-10-04T10:40:21Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7943#issuecomment-426970284",
    "id": 426970284,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7943",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNjk3MDI4NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/426970284/reactions"
    },
    "updated_at": "2018-10-04T10:40:21Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/426970284",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Seems root problem is in internal CoreFX method `System.Management.WmiNetUtilsHelper..cctor()`\r\n\r\n@SteveL-MSFT @daxian-dbw Can you confirm that the issue is not PowerShell issue. If so I'll open new issue in CoreFX repo.\r\n\r\nPS: I caught this problem when working on #1849 enhancing Get-Process cmdlet I used wmisearcher. (All other wmi code (like get-wmiobject) is excluded from compile. )",
    "created_at": "2018-10-04T10:52:30Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7943#issuecomment-426973458",
    "id": 426973458,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7943",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNjk3MzQ1OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/426973458/reactions"
    },
    "updated_at": "2018-10-04T11:01:34Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/426973458",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "I just got this \r\n\r\n```\r\nPS>  $query = [wmisearcher]\"SELECT * FROM Win32_process WHERE Name LIKE 'p%'\"\r\nPS>  $query.get()\r\n\r\n```\r\nto work\r\n\r\nalso got these to work\r\n\r\n\r\n ```\r\n  $query = [wmisearcher]\"SELECT Commandline FROM Win32_process WHERE Name LIKE 'p%'\"\r\n   $query.get()\r\n  \r\n  $query = [wmisearcher]\"SELECT Commandline FROM Win32_process\"\r\n $query.get()\r\n\r\n\r\n```\r\nYour original code\r\n\r\n```\r\n$query = [wmisearcher]\"SELECT * FROM Win32_process\"\r\n$query.get()\r\n\r\n\r\n```\r\nAlso worked for me\r\n\r\n\r\nI can't reproduce your error\r\n\r\n```\r\nPS>  $PSVersionTable\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      6.1.0\r\nPSEdition                      Core\r\nGitCommitId                    6.1.0\r\nOS                             Microsoft Windows 10.0.17134\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n\r\n```",
    "created_at": "2018-10-04T11:28:26Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7943#issuecomment-426984027",
    "id": 426984027,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7943",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNjk4NDAyNw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/426984027/reactions"
    },
    "updated_at": "2018-10-04T11:28:26Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/426984027",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/7870545?v=4",
      "events_url": "https://api.github.com/users/RichardSiddaway/events{/privacy}",
      "followers_url": "https://api.github.com/users/RichardSiddaway/followers",
      "following_url": "https://api.github.com/users/RichardSiddaway/following{/other_user}",
      "gists_url": "https://api.github.com/users/RichardSiddaway/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/RichardSiddaway",
      "id": 7870545,
      "login": "RichardSiddaway",
      "node_id": "MDQ6VXNlcjc4NzA1NDU=",
      "organizations_url": "https://api.github.com/users/RichardSiddaway/orgs",
      "received_events_url": "https://api.github.com/users/RichardSiddaway/received_events",
      "repos_url": "https://api.github.com/users/RichardSiddaway/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/RichardSiddaway/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RichardSiddaway/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/RichardSiddaway"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@RichardSiddaway Thanks! My system is Microsoft Windows _10.0.10240_ - maybe it matters.",
    "created_at": "2018-10-04T12:57:02Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7943#issuecomment-427008139",
    "id": 427008139,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7943",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNzAwODEzOQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/427008139/reactions"
    },
    "updated_at": "2018-10-04T12:57:02Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/427008139",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@iSazonov not repro'ing on my Win10 (newer internal build as I selfhost):\r\n\r\n```powershell\r\n([wmisearcher]\"select * from win32_computersystem\").Get()\r\n```\r\n",
    "created_at": "2018-10-04T16:24:45Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7943#issuecomment-427082647",
    "id": 427082647,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7943",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNzA4MjY0Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/427082647/reactions"
    },
    "updated_at": "2018-10-04T16:25:05Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/427082647",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@SteveL-MSFT Thanks! I'll close the issue. If the problem only with 10.0.10240 we can reopen.\r\n\r\n(Only __Enterprise__ LTSC 10.0.10240 is supported until 2025, other 2017.)",
    "created_at": "2018-10-05T03:16:09Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7943#issuecomment-427234091",
    "id": 427234091,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7943",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNzIzNDA5MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/427234091/reactions"
    },
    "updated_at": "2018-10-05T03:23:41Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/427234091",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  }
]

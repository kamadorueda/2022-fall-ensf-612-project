[
  {
    "author_association": "NONE",
    "body": "I get the same thing but I have the following changes:\r\n```\r\n    <PackageReference Include=\"Microsoft.PowerShell.Commands.Diagnostics\" Version=\"6.0.0-alpha17\" />\r\n    <PackageReference Include=\"Microsoft.PowerShell.SDK\" Version=\"6.0.0-alpha17\" />\r\n    <PackageReference Include=\"Microsoft.WSMan.Management\" Version=\"6.0.0-alpha17\" />\r\n```\r\n\r\nAnd the following line in Program.cs:\r\n`PowerShellAssemblyLoadContextInitializer.SetPowerShellAssemblyLoadContext(AppContext.BaseDirectory);`",
    "created_at": "2017-03-13T12:05:54Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3311#issuecomment-286089116",
    "id": 286089116,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3311",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4NjA4OTExNg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/286089116/reactions"
    },
    "updated_at": "2017-03-13T15:04:07Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/286089116",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/3199611?v=4",
      "events_url": "https://api.github.com/users/erwinwildenburg/events{/privacy}",
      "followers_url": "https://api.github.com/users/erwinwildenburg/followers",
      "following_url": "https://api.github.com/users/erwinwildenburg/following{/other_user}",
      "gists_url": "https://api.github.com/users/erwinwildenburg/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/erwinwildenburg",
      "id": 3199611,
      "login": "erwinwildenburg",
      "node_id": "MDQ6VXNlcjMxOTk2MTE=",
      "organizations_url": "https://api.github.com/users/erwinwildenburg/orgs",
      "received_events_url": "https://api.github.com/users/erwinwildenburg/received_events",
      "repos_url": "https://api.github.com/users/erwinwildenburg/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/erwinwildenburg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/erwinwildenburg/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/erwinwildenburg"
    }
  },
  {
    "author_association": "NONE",
    "body": "@erwinwildenburg you're right, I should have mentionned that I also have the same installed. I also tried with the AppContext.BaseDirectory without any luck.\r\nDo you remember how you got it to work like you did [here](https://github.com/PowerShell/PowerShell/issues/2291)?",
    "created_at": "2017-03-13T16:00:31Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3311#issuecomment-286152938",
    "id": 286152938,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3311",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4NjE1MjkzOA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/286152938/reactions"
    },
    "updated_at": "2017-03-13T16:00:40Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/286152938",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/1432252?v=4",
      "events_url": "https://api.github.com/users/Diastro/events{/privacy}",
      "followers_url": "https://api.github.com/users/Diastro/followers",
      "following_url": "https://api.github.com/users/Diastro/following{/other_user}",
      "gists_url": "https://api.github.com/users/Diastro/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Diastro",
      "id": 1432252,
      "login": "Diastro",
      "node_id": "MDQ6VXNlcjE0MzIyNTI=",
      "organizations_url": "https://api.github.com/users/Diastro/orgs",
      "received_events_url": "https://api.github.com/users/Diastro/received_events",
      "repos_url": "https://api.github.com/users/Diastro/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Diastro/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Diastro/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Diastro"
    }
  },
  {
    "author_association": "NONE",
    "body": "@Diastro \r\n\r\nI managed to get my code running again :)\r\n\r\nFirst of all you NEED the following dotnet core sdk: https://github.com/dotnet/core/blob/master/release-notes/download-archives/1.0.1-preview2-download.md\r\nAny newer or older version crashes the application.\r\n\r\nI uploaded sample code here that works: https://github.com/erwinwildenburg/PowerShellInDotNetCoreExample",
    "created_at": "2017-03-13T16:46:14Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3311#issuecomment-286167417",
    "id": 286167417,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3311",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4NjE2NzQxNw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/286167417/reactions"
    },
    "updated_at": "2017-03-13T16:46:14Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/286167417",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/3199611?v=4",
      "events_url": "https://api.github.com/users/erwinwildenburg/events{/privacy}",
      "followers_url": "https://api.github.com/users/erwinwildenburg/followers",
      "following_url": "https://api.github.com/users/erwinwildenburg/following{/other_user}",
      "gists_url": "https://api.github.com/users/erwinwildenburg/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/erwinwildenburg",
      "id": 3199611,
      "login": "erwinwildenburg",
      "node_id": "MDQ6VXNlcjMxOTk2MTE=",
      "organizations_url": "https://api.github.com/users/erwinwildenburg/orgs",
      "received_events_url": "https://api.github.com/users/erwinwildenburg/received_events",
      "repos_url": "https://api.github.com/users/erwinwildenburg/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/erwinwildenburg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/erwinwildenburg/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/erwinwildenburg"
    }
  },
  {
    "author_association": "NONE",
    "body": "@erwinwildenburg Thanks for the reply! I'll test this out!\r\n@PowerShellTeam How should this be treated? Seems to me like this is a pretty important scenario.",
    "created_at": "2017-03-13T17:51:43Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3311#issuecomment-286188604",
    "id": 286188604,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3311",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4NjE4ODYwNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/286188604/reactions"
    },
    "updated_at": "2017-03-13T17:51:53Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/286188604",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/1432252?v=4",
      "events_url": "https://api.github.com/users/Diastro/events{/privacy}",
      "followers_url": "https://api.github.com/users/Diastro/followers",
      "following_url": "https://api.github.com/users/Diastro/following{/other_user}",
      "gists_url": "https://api.github.com/users/Diastro/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Diastro",
      "id": 1432252,
      "login": "Diastro",
      "node_id": "MDQ6VXNlcjE0MzIyNTI=",
      "organizations_url": "https://api.github.com/users/Diastro/orgs",
      "received_events_url": "https://api.github.com/users/Diastro/received_events",
      "repos_url": "https://api.github.com/users/Diastro/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Diastro/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Diastro/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Diastro"
    }
  },
  {
    "author_association": "NONE",
    "body": "So last night I debugged the powershell source code a little more and here's what I found : \r\nAt some point the the file ```Types_Ps1Xml.cs``` (line 831) contains a call to ```ResolveType(\"Microsoft.PowerShell.Commands.Security.SecurityDescriptorCommandBase\")```. For some reason it seems like this type cannot be resolve and the call returns null.\r\nThen when ```Types_Ps1Xml.cs``` line 864 call ```GetMethodInfo( <previsouly_resolved_type>, \"GetPath\")``` is invoked, since the previously resolved type is null then the reflection error is thrown. Anyone on the Powershell team can comment on this? What could cause that type to resolve to null?\r\n",
    "created_at": "2017-03-15T16:23:56Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3311#issuecomment-286796835",
    "id": 286796835,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3311",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4Njc5NjgzNQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/286796835/reactions"
    },
    "updated_at": "2017-03-15T16:23:56Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/286796835",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/1432252?v=4",
      "events_url": "https://api.github.com/users/Diastro/events{/privacy}",
      "followers_url": "https://api.github.com/users/Diastro/followers",
      "following_url": "https://api.github.com/users/Diastro/following{/other_user}",
      "gists_url": "https://api.github.com/users/Diastro/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Diastro",
      "id": 1432252,
      "login": "Diastro",
      "node_id": "MDQ6VXNlcjE0MzIyNTI=",
      "organizations_url": "https://api.github.com/users/Diastro/orgs",
      "received_events_url": "https://api.github.com/users/Diastro/received_events",
      "repos_url": "https://api.github.com/users/Diastro/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Diastro/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Diastro/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Diastro"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "> For some reason it seems like this type cannot be resolved and the call returns null.\r\n\r\n@erwinwildenburg @Diastro this happens because you were using the API `SetPowerShellAssemblyLoadContext` in your code, which is not correct. When building your application with .NET CLI, you need to use `InitializeAndCallEntryMethod` to bootstrap your application.\r\n\r\nDue to the lack of necessary APIs to manipulate assemblies in .NET Core, powershell needs to control assembly loading via our customized AssemblyLoadContext in order to do tasks like type resolution. So any applications that need to host powershell (using powershell APIs) needs to be bootstrapped from `PowerShellAssemblyLoadContextInitializer`.\r\n\r\n`PowerShellAssemblyLoadContextInitializer` exposes 3 methods for this purpose: “SetPowerShellAssemblyLoadContext”, “InitializeAndCallEntryMethod” and “InitializeAndLoadEntryAssembly”. They are for different scenarios:\r\n- For `“SetPowerShellAssemblyLoadContext”`, it’s to be used by a native host whose TPA (trusted platform assemblies) doesn’t include powershell assemblies, such as the in-box powershell.exe and other native CoreCLR host in NanoServer.\r\n- For `“InitializeAndCallEntryMethod”` and `“InitializeAndLoadEntryAssembly”`, they are to be used with dotnet.exe where TPA list does include powershell assemblies. powershell core itself also uses it for bootstrapping (see code [here](https://github.com/PowerShell/PowerShell/blob/master/src/powershell/Program.cs#L27)). The only difference between these two methods is that the former calls into the entry point method, while the latter just load the real entry assembly and return it, so it’s up to the user to actually call into the entry point method using the returned assembly.\r\n\r\nThe attached \"Sample.zip\" is an example application that hosts powershell core (dotnet cli 1.0.0-preview3-003705 was used on my local machine). Hopefully this will help you understand the pattern.\r\n\r\n[Sample.zip](https://github.com/PowerShell/PowerShell/files/848392/Sample.zip)\r\n",
    "created_at": "2017-03-16T16:46:28Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3311#issuecomment-287118831",
    "id": 287118831,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3311",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4NzExODgzMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/287118831/reactions"
    },
    "updated_at": "2017-03-16T16:50:15Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/287118831",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "I will update our documentation to have a topic about hosting powershell core. It's an important scenario that we shouldn't have overlooked.",
    "created_at": "2017-03-16T16:58:20Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3311#issuecomment-287122587",
    "id": 287122587,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3311",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4NzEyMjU4Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/287122587/reactions"
    },
    "updated_at": "2017-03-16T16:58:20Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/287122587",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "NONE",
    "body": "Thanks @daxian-dbw ",
    "created_at": "2017-03-16T22:13:40Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3311#issuecomment-287207184",
    "id": 287207184,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3311",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4NzIwNzE4NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/287207184/reactions"
    },
    "updated_at": "2017-03-16T22:13:40Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/287207184",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/1432252?v=4",
      "events_url": "https://api.github.com/users/Diastro/events{/privacy}",
      "followers_url": "https://api.github.com/users/Diastro/followers",
      "following_url": "https://api.github.com/users/Diastro/following{/other_user}",
      "gists_url": "https://api.github.com/users/Diastro/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Diastro",
      "id": 1432252,
      "login": "Diastro",
      "node_id": "MDQ6VXNlcjE0MzIyNTI=",
      "organizations_url": "https://api.github.com/users/Diastro/orgs",
      "received_events_url": "https://api.github.com/users/Diastro/received_events",
      "repos_url": "https://api.github.com/users/Diastro/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Diastro/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Diastro/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Diastro"
    }
  }
]

[
  {
    "author_association": "COLLABORATOR",
    "body": "FYI  I have created an Issue about finalizers not being called for the CLR team(https://github.com/dotnet/coreclr/issues/14889).",
    "created_at": "2017-11-06T22:45:02Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/5356#issuecomment-342313460",
    "id": 342313460,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/5356",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MjMxMzQ2MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/342313460/reactions"
    },
    "updated_at": "2017-11-06T22:45:02Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/342313460",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/14019529?v=4",
      "events_url": "https://api.github.com/users/PaulHigin/events{/privacy}",
      "followers_url": "https://api.github.com/users/PaulHigin/followers",
      "following_url": "https://api.github.com/users/PaulHigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulHigin/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/PaulHigin",
      "id": 14019529,
      "login": "PaulHigin",
      "node_id": "MDQ6VXNlcjE0MDE5NTI5",
      "organizations_url": "https://api.github.com/users/PaulHigin/orgs",
      "received_events_url": "https://api.github.com/users/PaulHigin/received_events",
      "repos_url": "https://api.github.com/users/PaulHigin/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/PaulHigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulHigin/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/PaulHigin"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "It turns out that this \"CLR no longer calling finalizer on shutdown\" is by design.  Making it work across multiple platforms is probably much harder than making it work just on Windows.\r\n\r\nI am going to think about this some more so don't bother reviewing this just yet.  I will look into using the AppDomain.DomainUnload.Unload event.  I suspect it is no more reliable than the finalizer thread, since it is just another thread for clean up, after all.  But we can use it as notification for process shut down.",
    "created_at": "2017-11-07T00:00:36Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/5356#issuecomment-342329264",
    "id": 342329264,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/5356",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MjMyOTI2NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/342329264/reactions"
    },
    "updated_at": "2017-11-07T00:00:36Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/342329264",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/14019529?v=4",
      "events_url": "https://api.github.com/users/PaulHigin/events{/privacy}",
      "followers_url": "https://api.github.com/users/PaulHigin/followers",
      "following_url": "https://api.github.com/users/PaulHigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulHigin/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/PaulHigin",
      "id": 14019529,
      "login": "PaulHigin",
      "node_id": "MDQ6VXNlcjE0MDE5NTI5",
      "organizations_url": "https://api.github.com/users/PaulHigin/orgs",
      "received_events_url": "https://api.github.com/users/PaulHigin/received_events",
      "repos_url": "https://api.github.com/users/PaulHigin/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/PaulHigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulHigin/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/PaulHigin"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "I have removed the \"On Hold\" and \"Workaround\" designations from the title.  After talking with the CLR team, we can no longer rely on CLR events or finalizer calls on exit.  The AppDomain.DomainUnload is not supported.  The AppDomain.ProcessExit event is not helpful since it is only called during application exit which means threads already have to be cleaned up, plus there is a time limit.\r\n\r\nSo we will need to do our own clean up in this change.  \r\nI have introduced a new Runspace property (*IsInteractiveHost*) to indicate that runspace clean up must be performed when the interactive host runspace closes.  I made this public so that other hosts can use it as needed.  ",
    "created_at": "2017-11-13T18:46:07Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/5356#issuecomment-344017591",
    "id": 344017591,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/5356",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0NDAxNzU5MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/344017591/reactions"
    },
    "updated_at": "2017-11-13T18:46:07Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/344017591",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/14019529?v=4",
      "events_url": "https://api.github.com/users/PaulHigin/events{/privacy}",
      "followers_url": "https://api.github.com/users/PaulHigin/followers",
      "following_url": "https://api.github.com/users/PaulHigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulHigin/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/PaulHigin",
      "id": 14019529,
      "login": "PaulHigin",
      "node_id": "MDQ6VXNlcjE0MDE5NTI5",
      "organizations_url": "https://api.github.com/users/PaulHigin/orgs",
      "received_events_url": "https://api.github.com/users/PaulHigin/received_events",
      "repos_url": "https://api.github.com/users/PaulHigin/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/PaulHigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulHigin/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/PaulHigin"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Per offline discussion with Dongbo I will make some changes.  We should not use the term \"Default Runspace\" because it has a current meaning for a runspace per thread that is available to use for running scriptblocks.  This clean up code is meant to be used only once per process session and is intended to prevent process hang on exit due to dangling threads (because runspaces are not cleaned up).\r\n\r\nTherefore this property should be called \"PrimaryRunspace\" and should be static.  When the PrimaryRunspace is closing it means that the PowerShell session is ending and on exit clean should be performed.  I will make it internal for now but feel it should eventually be public so that other hosters of PowerShell can use it.  The purpose of the property is to do on exit clean up.\r\n\r\nI'll submit a new commit with these changes.",
    "created_at": "2017-11-14T16:08:29Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/5356#issuecomment-344308151",
    "id": 344308151,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/5356",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0NDMwODE1MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/344308151/reactions"
    },
    "updated_at": "2017-11-14T16:08:29Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/344308151",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/14019529?v=4",
      "events_url": "https://api.github.com/users/PaulHigin/events{/privacy}",
      "followers_url": "https://api.github.com/users/PaulHigin/followers",
      "following_url": "https://api.github.com/users/PaulHigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulHigin/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/PaulHigin",
      "id": 14019529,
      "login": "PaulHigin",
      "node_id": "MDQ6VXNlcjE0MDE5NTI5",
      "organizations_url": "https://api.github.com/users/PaulHigin/orgs",
      "received_events_url": "https://api.github.com/users/PaulHigin/received_events",
      "repos_url": "https://api.github.com/users/PaulHigin/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/PaulHigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulHigin/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/PaulHigin"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "Merging this PR. I will add the test to this fix soon.",
    "created_at": "2017-11-14T21:52:33Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/5356#issuecomment-344411420",
    "id": 344411420,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/5356",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0NDQxMTQyMA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/344411420/reactions"
    },
    "updated_at": "2017-11-14T21:52:33Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/344411420",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  }
]

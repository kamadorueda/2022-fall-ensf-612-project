[
  {
    "author_association": "COLLABORATOR",
    "body": "/cc @SteveL-MSFT  @adityapatwardhan ",
    "created_at": "2020-07-11T19:46:02Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13157#issuecomment-657118897",
    "id": 657118897,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13157",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1NzExODg5Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/657118897/reactions"
    },
    "updated_at": "2020-07-11T19:46:02Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/657118897",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/32407840?v=4",
      "events_url": "https://api.github.com/users/vexx32/events{/privacy}",
      "followers_url": "https://api.github.com/users/vexx32/followers",
      "following_url": "https://api.github.com/users/vexx32/following{/other_user}",
      "gists_url": "https://api.github.com/users/vexx32/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vexx32",
      "id": 32407840,
      "login": "vexx32",
      "node_id": "MDQ6VXNlcjMyNDA3ODQw",
      "organizations_url": "https://api.github.com/users/vexx32/orgs",
      "received_events_url": "https://api.github.com/users/vexx32/received_events",
      "repos_url": "https://api.github.com/users/vexx32/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vexx32/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vexx32/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vexx32"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "I guess the issue could be already fixed in latest builds but you need to replace Appx module in your repro steps with another module because Appx module is not compatible with latest PowerShell 7.1 Preview builds.",
    "created_at": "2020-07-13T10:58:03Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13157#issuecomment-657490498",
    "id": 657490498,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13157",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1NzQ5MDQ5OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/657490498/reactions"
    },
    "updated_at": "2020-07-13T10:58:03Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/657490498",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@Fs00 The repro project runs correctly for me on Windows 10 1909, where Appx is made compatible with PS 7.0+ (`CompatiblePSEditions = @('Desktop','Core')` in `Appx.psd1`).\r\n\r\nWhat version of Windows are you using? I presume it's not the latest Windows 10 but a downlevel OS, right?\r\nIf you are using a downlevel machine, then `Appx` module there may not be compatible with PS 7, and thus the loading of it would go through the [Windows module compatibility feature](https://docs.microsoft.com/en-us/powershell/scripting/whats-new/module-compatibility?view=powershell-7), and it's possible that caused a hang.\r\n\r\nLoop in @anmenaga to take a look.",
    "created_at": "2020-07-13T16:43:05Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13157#issuecomment-657667786",
    "id": 657667786,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13157",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1NzY2Nzc4Ng==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/657667786/reactions"
    },
    "updated_at": "2020-07-13T16:43:05Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/657667786",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@daxian-dbw I'm using Windows 10 1909 (not the latest cumulative update though, I'm not at home so I cannot check my `Appx.psd1` atm). Did you try it in both the scenarios I listed above?\n\nAnyway, I'm almost sure that on my end my application used WinCompat feature because I happened to see the spawned PowerShell child process in the Task Manager (and now I know why it was there).",
    "created_at": "2020-07-13T18:26:35Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13157#issuecomment-657718606",
    "id": 657718606,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13157",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1NzcxODYwNg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/657718606/reactions"
    },
    "updated_at": "2020-07-13T18:26:35Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/657718606",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/30041551?v=4",
      "events_url": "https://api.github.com/users/Fs00/events{/privacy}",
      "followers_url": "https://api.github.com/users/Fs00/followers",
      "following_url": "https://api.github.com/users/Fs00/following{/other_user}",
      "gists_url": "https://api.github.com/users/Fs00/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Fs00",
      "id": 30041551,
      "login": "Fs00",
      "node_id": "MDQ6VXNlcjMwMDQxNTUx",
      "organizations_url": "https://api.github.com/users/Fs00/orgs",
      "received_events_url": "https://api.github.com/users/Fs00/received_events",
      "repos_url": "https://api.github.com/users/Fs00/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Fs00/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Fs00/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Fs00"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "> Did you try it in both the scenarios I listed above?\r\n\r\nYes, I was able to run both scenarios successfully.\r\n\r\n> Anyway, I'm almost sure that on my end my application used WinCompat feature because I happened to see the spawned PowerShell child process in the Task Manager (and now I know why it was there).\r\n\r\nGood to know, so the Appx module might not have the `CompatiblePSEditions = @('Desktop','Core')` in it. @anmenaga is our SME for the WinCompat module feature, and he will be able to help.",
    "created_at": "2020-07-13T19:33:16Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13157#issuecomment-657750038",
    "id": 657750038,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13157",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1Nzc1MDAzOA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/657750038/reactions"
    },
    "updated_at": "2020-07-13T19:33:16Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/657750038",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Appx does not work with latest PowerShell 7.1 Preview. See #13138.",
    "created_at": "2020-07-14T04:30:59Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13157#issuecomment-657959737",
    "id": 657959737,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13157",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1Nzk1OTczNw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/657959737/reactions"
    },
    "updated_at": "2020-07-14T04:30:59Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/657959737",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@iSazonov Thanks, that's good to know.",
    "created_at": "2020-07-14T08:29:22Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13157#issuecomment-658047044",
    "id": 658047044,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13157",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1ODA0NzA0NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/658047044/reactions"
    },
    "updated_at": "2020-07-14T08:29:22Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/658047044",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/30041551?v=4",
      "events_url": "https://api.github.com/users/Fs00/events{/privacy}",
      "followers_url": "https://api.github.com/users/Fs00/followers",
      "following_url": "https://api.github.com/users/Fs00/following{/other_user}",
      "gists_url": "https://api.github.com/users/Fs00/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Fs00",
      "id": 30041551,
      "login": "Fs00",
      "node_id": "MDQ6VXNlcjMwMDQxNTUx",
      "organizations_url": "https://api.github.com/users/Fs00/orgs",
      "received_events_url": "https://api.github.com/users/Fs00/received_events",
      "repos_url": "https://api.github.com/users/Fs00/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Fs00/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Fs00/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Fs00"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@daxian-dbw @anmenaga I've done some more testing and discovered that the bug happens only when importing WinCompat modules.\r\nI have updated the repro project and the issue description to be more accurate. The project now targets PowerShell 7.1 and .NET 5.\r\nI'm confident that you'll now be able to reproduce the issue and have enough information to investigate it. Let me know if there are any problems.",
    "created_at": "2020-11-16T16:39:06Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13157#issuecomment-728178717",
    "id": 728178717,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13157",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyODE3ODcxNw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/728178717/reactions"
    },
    "updated_at": "2020-11-16T16:39:06Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/728178717",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/30041551?v=4",
      "events_url": "https://api.github.com/users/Fs00/events{/privacy}",
      "followers_url": "https://api.github.com/users/Fs00/followers",
      "following_url": "https://api.github.com/users/Fs00/following{/other_user}",
      "gists_url": "https://api.github.com/users/Fs00/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Fs00",
      "id": 30041551,
      "login": "Fs00",
      "node_id": "MDQ6VXNlcjMwMDQxNTUx",
      "organizations_url": "https://api.github.com/users/Fs00/orgs",
      "received_events_url": "https://api.github.com/users/Fs00/received_events",
      "repos_url": "https://api.github.com/users/Fs00/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Fs00/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Fs00/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Fs00"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "The `Release.pubxml` has 32-bit `<RuntimeIdentifier>win-x86</RuntimeIdentifier>`. Is this intentional?",
    "created_at": "2020-11-25T01:29:30Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13157#issuecomment-733404789",
    "id": 733404789,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13157",
    "node_id": "MDEyOklzc3VlQ29tbWVudDczMzQwNDc4OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/733404789/reactions"
    },
    "updated_at": "2020-11-25T01:29:30Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/733404789",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11860095?v=4",
      "events_url": "https://api.github.com/users/anmenaga/events{/privacy}",
      "followers_url": "https://api.github.com/users/anmenaga/followers",
      "following_url": "https://api.github.com/users/anmenaga/following{/other_user}",
      "gists_url": "https://api.github.com/users/anmenaga/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/anmenaga",
      "id": 11860095,
      "login": "anmenaga",
      "node_id": "MDQ6VXNlcjExODYwMDk1",
      "organizations_url": "https://api.github.com/users/anmenaga/orgs",
      "received_events_url": "https://api.github.com/users/anmenaga/received_events",
      "repos_url": "https://api.github.com/users/anmenaga/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/anmenaga/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/anmenaga/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/anmenaga"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "That's intentional, although I don't know if that has an impact on the bug (I haven't tested with x64).",
    "created_at": "2020-11-25T08:02:14Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13157#issuecomment-733535966",
    "id": 733535966,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13157",
    "node_id": "MDEyOklzc3VlQ29tbWVudDczMzUzNTk2Ng==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/733535966/reactions"
    },
    "updated_at": "2020-11-25T08:02:14Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/733535966",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/30041551?v=4",
      "events_url": "https://api.github.com/users/Fs00/events{/privacy}",
      "followers_url": "https://api.github.com/users/Fs00/followers",
      "following_url": "https://api.github.com/users/Fs00/following{/other_user}",
      "gists_url": "https://api.github.com/users/Fs00/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Fs00",
      "id": 30041551,
      "login": "Fs00",
      "node_id": "MDQ6VXNlcjMwMDQxNTUx",
      "organizations_url": "https://api.github.com/users/Fs00/orgs",
      "received_events_url": "https://api.github.com/users/Fs00/received_events",
      "repos_url": "https://api.github.com/users/Fs00/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Fs00/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Fs00/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Fs00"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Any news on this? Did the latest repro project work?",
    "created_at": "2020-12-06T10:15:40Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13157#issuecomment-739481908",
    "id": 739481908,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13157",
    "node_id": "MDEyOklzc3VlQ29tbWVudDczOTQ4MTkwOA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/739481908/reactions"
    },
    "updated_at": "2020-12-06T10:15:40Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/739481908",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/30041551?v=4",
      "events_url": "https://api.github.com/users/Fs00/events{/privacy}",
      "followers_url": "https://api.github.com/users/Fs00/followers",
      "following_url": "https://api.github.com/users/Fs00/following{/other_user}",
      "gists_url": "https://api.github.com/users/Fs00/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Fs00",
      "id": 30041551,
      "login": "Fs00",
      "node_id": "MDQ6VXNlcjMwMDQxNTUx",
      "organizations_url": "https://api.github.com/users/Fs00/orgs",
      "received_events_url": "https://api.github.com/users/Fs00/received_events",
      "repos_url": "https://api.github.com/users/Fs00/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Fs00/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Fs00/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Fs00"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "The latest repro project did work (when using attached publish profile (`Release.pubxml`), without it it runs fine).\r\nI've looked through WinCompat code and it seems to be behaving as expected, but problems start when it calls PS Remoting code. I assume this has something to do with app running as WoW64 (I vaguely recall remoting bugs with WoW64 from long time ago). This needs more investigation time.\r\n",
    "created_at": "2020-12-08T04:41:41Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13157#issuecomment-740371202",
    "id": 740371202,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13157",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0MDM3MTIwMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/740371202/reactions"
    },
    "updated_at": "2020-12-08T04:41:41Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/740371202",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11860095?v=4",
      "events_url": "https://api.github.com/users/anmenaga/events{/privacy}",
      "followers_url": "https://api.github.com/users/anmenaga/followers",
      "following_url": "https://api.github.com/users/anmenaga/following{/other_user}",
      "gists_url": "https://api.github.com/users/anmenaga/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/anmenaga",
      "id": 11860095,
      "login": "anmenaga",
      "node_id": "MDQ6VXNlcjExODYwMDk1",
      "organizations_url": "https://api.github.com/users/anmenaga/orgs",
      "received_events_url": "https://api.github.com/users/anmenaga/received_events",
      "repos_url": "https://api.github.com/users/anmenaga/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/anmenaga/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/anmenaga/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/anmenaga"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Good to know.\r\nI tried publishing the executable with `<RuntimeIdentifier>win-x64</RuntimeIdentifier>` but it didn't fix the issue, so I don't think the difference in architecture plays a role in this bug.",
    "created_at": "2020-12-09T17:30:09Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13157#issuecomment-741924717",
    "id": 741924717,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13157",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0MTkyNDcxNw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/741924717/reactions"
    },
    "updated_at": "2020-12-09T18:50:29Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/741924717",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/30041551?v=4",
      "events_url": "https://api.github.com/users/Fs00/events{/privacy}",
      "followers_url": "https://api.github.com/users/Fs00/followers",
      "following_url": "https://api.github.com/users/Fs00/following{/other_user}",
      "gists_url": "https://api.github.com/users/Fs00/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Fs00",
      "id": 30041551,
      "login": "Fs00",
      "node_id": "MDQ6VXNlcjMwMDQxNTUx",
      "organizations_url": "https://api.github.com/users/Fs00/orgs",
      "received_events_url": "https://api.github.com/users/Fs00/received_events",
      "repos_url": "https://api.github.com/users/Fs00/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Fs00/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Fs00/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Fs00"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Ok @anmenaga, after some research in the codebase I think I got a decent understanding of the issue.\r\nIn the stack trace I linked in the first comment you can see that the hang occurs when PowerShell tries to import `Microsoft.PowerShell.Utility` module in order to execute `Export-PSSession` to perform a WinCompat import.\r\nThen I saw that PR #12269 introduced a special behavior when importing an engine module via WinCompat:\r\n> If a module falls into one of these buckets, then PS-Core version of the module is imported first **(for engine modules from $PSHOME\\Modules)**\r\n\r\nThe point is, when an application uses only System.Management.Automation (the scenario 1 I mentioned above), the other PS Core engine modules cannot be found in $PSHOME\\Modules, because that folder simply does not exist. It seems likely that the hang is caused by this edge case not being handled correctly.\r\n\r\n_But what about the scenario 2 (Published build with full SDK), in which all PS Core modules should be there?_\r\nThe key to understand this is that **`ModuleIntrinsics.GetPSHomeModulePath()`** ([used here](https://github.com/PowerShell/PowerShell/blob/master/src/System.Management.Automation/engine/Modules/ImportModuleCommand.cs#L1990)) **returns the path to System.Management.Automation.dll** (returned by Utils.DefaultPowerShellAppBase) **+ '/Modules'** .\r\nThe assumption here is that the 'Modules' folder is next to SMA.dll, which is true for Debug builds (`[repro_project_folder]\\bin\\Debug\\net5.0\\runtimes\\win\\lib\\net5.0`) but not for Published builds (SMA.dll is near the published EXE, but 'Modules' folder is still inside `runtimes\\win\\lib\\net5.0`).\r\n",
    "created_at": "2020-12-09T18:50:20Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13157#issuecomment-741975648",
    "id": 741975648,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13157",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0MTk3NTY0OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/741975648/reactions"
    },
    "updated_at": "2021-07-03T14:27:48Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/741975648",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/30041551?v=4",
      "events_url": "https://api.github.com/users/Fs00/events{/privacy}",
      "followers_url": "https://api.github.com/users/Fs00/followers",
      "following_url": "https://api.github.com/users/Fs00/following{/other_user}",
      "gists_url": "https://api.github.com/users/Fs00/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Fs00",
      "id": 30041551,
      "login": "Fs00",
      "node_id": "MDQ6VXNlcjMwMDQxNTUx",
      "organizations_url": "https://api.github.com/users/Fs00/orgs",
      "received_events_url": "https://api.github.com/users/Fs00/received_events",
      "repos_url": "https://api.github.com/users/Fs00/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Fs00/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Fs00/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Fs00"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Hello @anmenaga, is my analysis enough for you to be able to tackle this issue and solve it once and for all?\r\nThanks in advance!",
    "created_at": "2021-02-24T18:29:28Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13157#issuecomment-785282087",
    "id": 785282087,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13157",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4NTI4MjA4Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/785282087/reactions"
    },
    "updated_at": "2021-07-03T14:29:41Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/785282087",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/30041551?v=4",
      "events_url": "https://api.github.com/users/Fs00/events{/privacy}",
      "followers_url": "https://api.github.com/users/Fs00/followers",
      "following_url": "https://api.github.com/users/Fs00/following{/other_user}",
      "gists_url": "https://api.github.com/users/Fs00/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Fs00",
      "id": 30041551,
      "login": "Fs00",
      "node_id": "MDQ6VXNlcjMwMDQxNTUx",
      "organizations_url": "https://api.github.com/users/Fs00/orgs",
      "received_events_url": "https://api.github.com/users/Fs00/received_events",
      "repos_url": "https://api.github.com/users/Fs00/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Fs00/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Fs00/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Fs00"
    }
  },
  {
    "author_association": "NONE",
    "body": ":tada:This issue was addressed in #16628, which has now been successfully released as `v7.3.0-preview.2`.:tada:\n\nHandy links:\n* [Release Notes](https://github.com/PowerShell/PowerShell/releases/tag/v7.3.0-preview.2)\n",
    "created_at": "2022-02-24T23:34:16Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13157#issuecomment-1050364162",
    "id": 1050364162,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13157",
    "node_id": "IC_kwDOAvT7bc4-m0kC",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1050364162/reactions"
    },
    "updated_at": "2022-02-24T23:34:16Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1050364162",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  }
]

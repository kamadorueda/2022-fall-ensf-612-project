[
  {
    "author_association": "CONTRIBUTOR",
    "body": "I'll try take a look at this the next few days",
    "created_at": "2021-07-22T23:39:52Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15816#issuecomment-885304891",
    "id": 885304891,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15816",
    "node_id": "IC_kwDOAvT7bc40xK47",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/885304891/reactions"
    },
    "updated_at": "2021-07-22T23:39:52Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/885304891",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/9250262?v=4",
      "events_url": "https://api.github.com/users/bergmeister/events{/privacy}",
      "followers_url": "https://api.github.com/users/bergmeister/followers",
      "following_url": "https://api.github.com/users/bergmeister/following{/other_user}",
      "gists_url": "https://api.github.com/users/bergmeister/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/bergmeister",
      "id": 9250262,
      "login": "bergmeister",
      "node_id": "MDQ6VXNlcjkyNTAyNjI=",
      "organizations_url": "https://api.github.com/users/bergmeister/orgs",
      "received_events_url": "https://api.github.com/users/bergmeister/received_events",
      "repos_url": "https://api.github.com/users/bergmeister/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/bergmeister/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bergmeister/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/bergmeister"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@krishnan-unni \r\nHi, this is because you do not clear the commands between executions. Adding a `powerShell.Commands.Clear();` between your invocation blocks will make it work.\r\nHaving said that, you can reduce your example to just one invocation because one does not need to manually import PowerShell modules that are on the `PSModulePath` environment variable, which is the case with modules that are installed or part of the OS like e.g. `Dism`.\r\nIf you still have to execute multiple commands, then you could make your own `InvokeAndClear` extension method to keep your code DRY like e.g. here: https://github.com/PowerShell/PSScriptAnalyzer/blob/58c44234d44dfd0db35bb532906963e08fde8621/PSCompatibilityCollector/Microsoft.PowerShell.CrossCompatibility/Utility/PowerShellExtensions.cs#L12\r\nAlso please note that if you want to execute something more complex later on, there is also an `AddScript` method. You are probably already aware but running `get-windowspackage -online` requires admin rights, therefore when you invoke your compiled binary, you will need to run as admin.",
    "created_at": "2021-07-24T16:22:13Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15816#issuecomment-886075389",
    "id": 886075389,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15816",
    "node_id": "IC_kwDOAvT7bc400G_9",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/886075389/reactions"
    },
    "updated_at": "2021-07-24T16:23:16Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/886075389",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/9250262?v=4",
      "events_url": "https://api.github.com/users/bergmeister/events{/privacy}",
      "followers_url": "https://api.github.com/users/bergmeister/followers",
      "following_url": "https://api.github.com/users/bergmeister/following{/other_user}",
      "gists_url": "https://api.github.com/users/bergmeister/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/bergmeister",
      "id": 9250262,
      "login": "bergmeister",
      "node_id": "MDQ6VXNlcjkyNTAyNjI=",
      "organizations_url": "https://api.github.com/users/bergmeister/orgs",
      "received_events_url": "https://api.github.com/users/bergmeister/received_events",
      "repos_url": "https://api.github.com/users/bergmeister/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/bergmeister/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bergmeister/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/bergmeister"
    }
  },
  {
    "author_association": "NONE",
    "body": "@bergmeister Thank you and for pointing out the extension. That sorted out the problem. And yes, the run as admin is expected in this case, I'm aware. 2 questions - is there an official documentation on this Invoke and Clear approach? \r\nWhat is the reasoning behind this design? To have a command be cleared every time its invoked? Why is it not an automatic behavior? \r\nP.S: I am closing the issue since its resolved and the questions are for my own curiosity.",
    "created_at": "2021-07-24T16:29:01Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15816#issuecomment-886076435",
    "id": 886076435,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15816",
    "node_id": "IC_kwDOAvT7bc400HQT",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/886076435/reactions"
    },
    "updated_at": "2021-07-24T16:29:01Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/886076435",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/14880339?v=4",
      "events_url": "https://api.github.com/users/krishnan-unni/events{/privacy}",
      "followers_url": "https://api.github.com/users/krishnan-unni/followers",
      "following_url": "https://api.github.com/users/krishnan-unni/following{/other_user}",
      "gists_url": "https://api.github.com/users/krishnan-unni/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/krishnan-unni",
      "id": 14880339,
      "login": "krishnan-unni",
      "node_id": "MDQ6VXNlcjE0ODgwMzM5",
      "organizations_url": "https://api.github.com/users/krishnan-unni/orgs",
      "received_events_url": "https://api.github.com/users/krishnan-unni/received_events",
      "repos_url": "https://api.github.com/users/krishnan-unni/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/krishnan-unni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/krishnan-unni/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/krishnan-unni"
    }
  }
]

[
  {
    "author_association": "CONTRIBUTOR",
    "body": "I think what the error message is saying is that attributes in general only accept _literals_ as arguments - either as constants or as script-block _literals_.\r\n\r\nIn other words: a script block itself cannot be specified via a _variable_, as you've attempted.\r\n",
    "created_at": "2018-06-25T15:38:06Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7163#issuecomment-399996457",
    "id": 399996457,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7163",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5OTk5NjQ1Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/399996457/reactions"
    },
    "updated_at": "2018-06-25T15:38:06Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/399996457",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "NONE",
    "body": "Well, it is ok, but i think it would be good to be able to pass it as a variable.",
    "created_at": "2018-06-25T15:40:05Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7163#issuecomment-399997207",
    "id": 399997207,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7163",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5OTk5NzIwNw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/399997207/reactions"
    },
    "updated_at": "2018-06-25T15:40:05Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/399997207",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/9363027?v=4",
      "events_url": "https://api.github.com/users/eosfor/events{/privacy}",
      "followers_url": "https://api.github.com/users/eosfor/followers",
      "following_url": "https://api.github.com/users/eosfor/following{/other_user}",
      "gists_url": "https://api.github.com/users/eosfor/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/eosfor",
      "id": 9363027,
      "login": "eosfor",
      "node_id": "MDQ6VXNlcjkzNjMwMjc=",
      "organizations_url": "https://api.github.com/users/eosfor/orgs",
      "received_events_url": "https://api.github.com/users/eosfor/received_events",
      "repos_url": "https://api.github.com/users/eosfor/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/eosfor/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eosfor/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/eosfor"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "If you want to use a variable to store the completer script block (e.g., in order to associate it with _multiple_ functions) you can use the `Register-ArgumentCompleter` _cmdlet_ instead of the `ArgumentCompleter` attribute.",
    "created_at": "2018-06-25T17:40:46Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7163#issuecomment-400035277",
    "id": 400035277,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7163",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMDAzNTI3Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/400035277/reactions"
    },
    "updated_at": "2018-06-25T17:40:46Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/400035277",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "You can also delegate to a function, like \r\n```\r\nfunction completeme{\r\n    param($c, $p, $w, $a, $fb)\r\n    \r\n...\r\n}\r\n\r\nfunction Verb-Noun{\r\n   param(\r\n     [ArgumentCompleter({completeme @args})\r\n     [string] $First\r\n   )\r\n}\r\n\r\n\r\n```",
    "created_at": "2018-06-26T00:06:14Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7163#issuecomment-400133466",
    "id": 400133466,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7163",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMDEzMzQ2Ng==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 1,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/400133466/reactions"
    },
    "updated_at": "2018-06-26T00:06:14Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/400133466",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/3505151?v=4",
      "events_url": "https://api.github.com/users/powercode/events{/privacy}",
      "followers_url": "https://api.github.com/users/powercode/followers",
      "following_url": "https://api.github.com/users/powercode/following{/other_user}",
      "gists_url": "https://api.github.com/users/powercode/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/powercode",
      "id": 3505151,
      "login": "powercode",
      "node_id": "MDQ6VXNlcjM1MDUxNTE=",
      "organizations_url": "https://api.github.com/users/powercode/orgs",
      "received_events_url": "https://api.github.com/users/powercode/received_events",
      "repos_url": "https://api.github.com/users/powercode/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/powercode/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/powercode/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/powercode"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@powercode: That's a great alternative, but I suggest only using it in the context of a _module_, so as to ensure that the delegate (helper function) is packaged with the function(s) that rely on it.",
    "created_at": "2018-06-26T02:26:29Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7163#issuecomment-400156957",
    "id": 400156957,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7163",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMDE1Njk1Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/400156957/reactions"
    },
    "updated_at": "2018-06-26T02:27:00Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/400156957",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "NONE",
    "body": "Well, function is a great option, but in case there is some 'dynamicity' is needed it is easier to generate a scriptblock, than a function",
    "created_at": "2018-06-26T08:05:07Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7163#issuecomment-400218347",
    "id": 400218347,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7163",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMDIxODM0Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/400218347/reactions"
    },
    "updated_at": "2018-06-26T08:05:07Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/400218347",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/9363027?v=4",
      "events_url": "https://api.github.com/users/eosfor/events{/privacy}",
      "followers_url": "https://api.github.com/users/eosfor/followers",
      "following_url": "https://api.github.com/users/eosfor/following{/other_user}",
      "gists_url": "https://api.github.com/users/eosfor/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/eosfor",
      "id": 9363027,
      "login": "eosfor",
      "node_id": "MDQ6VXNlcjkzNjMwMjc=",
      "organizations_url": "https://api.github.com/users/eosfor/orgs",
      "received_events_url": "https://api.github.com/users/eosfor/received_events",
      "repos_url": "https://api.github.com/users/eosfor/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/eosfor/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eosfor/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/eosfor"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@eosfor: I see three basic scenarios:\r\n\r\n* (a) \"Bake\" a script-block literal directly in the function, with no external dependencies (other than relying on standard features and cmdlets to generate completions)\r\n\r\n* (b) In the context of a module, use a helper function that your reference from the script block the way @powercode suggests, so as to either use the same completer with multiple functions or to separate the implementation of a lengthy completer from the function's main code.\r\n\r\n* (c) Associate arbitrary completers with existing functions, possibly by someone other than the function author, using `Register-ArgumentCompleter` - though this technique could also be used module-internally. Completers are indeed passed as _script blocks_ to `Register-ArgumentCompleter`.\r\n\r\nDoes your scenario not fall into one of the 3 categories above?",
    "created_at": "2018-06-26T12:14:50Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7163#issuecomment-400285664",
    "id": 400285664,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7163",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMDI4NTY2NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/400285664/reactions"
    },
    "updated_at": "2018-06-26T12:35:12Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/400285664",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "NONE",
    "body": "@mklement0:\r\n\r\nYes, I think (a) is something I talking about. However if a script-block is big and complex, and we have a lot of parameters to \"auto-complete\", then a function definition will be really long and unreadable. \r\n\r\nUsing variables will give an option to move script-block code off a function definition. But avoiding complexity of generating a full-featured function, especially if a function is not needed for anything else but for completer.\r\n\r\nIMHO of course.\r\n",
    "created_at": "2018-06-26T12:22:09Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7163#issuecomment-400287583",
    "id": 400287583,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7163",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMDI4NzU4Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/400287583/reactions"
    },
    "updated_at": "2018-06-26T12:22:09Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/400287583",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/9363027?v=4",
      "events_url": "https://api.github.com/users/eosfor/events{/privacy}",
      "followers_url": "https://api.github.com/users/eosfor/followers",
      "following_url": "https://api.github.com/users/eosfor/following{/other_user}",
      "gists_url": "https://api.github.com/users/eosfor/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/eosfor",
      "id": 9363027,
      "login": "eosfor",
      "node_id": "MDQ6VXNlcjkzNjMwMjc=",
      "organizations_url": "https://api.github.com/users/eosfor/orgs",
      "received_events_url": "https://api.github.com/users/eosfor/received_events",
      "repos_url": "https://api.github.com/users/eosfor/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/eosfor/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eosfor/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/eosfor"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@eosfor:\r\n\r\n> then a function definition will be really long and unreadable.\r\n\r\nSo in that case you can reference a unit of code the way @powercode suggests, whether that unit of code is\r\na function (`[ArgumentCompleter({ completeme @args })]`)\r\nor a script block (`[ArgumentCompleter({ & $sb2 @args})]`)\r\n\r\n>  avoiding complexity of generating a full-featured function\r\n\r\nThe bodies of functions are script blocks, so the only complexity that a function definition adds is the word `function`:\r\n\r\n```powershell\r\n$sb2 = { ... }\r\n# vs.\r\nfunction sb2 { ... }\r\n```\r\n",
    "created_at": "2018-06-26T13:50:33Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7163#issuecomment-400316017",
    "id": 400316017,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7163",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMDMxNjAxNw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/400316017/reactions"
    },
    "updated_at": "2018-06-26T13:50:33Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/400316017",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "NONE",
    "body": "Aha, this is what i was looking for :). It still isn't obvious :D, IMHO. Kind of script-block calling another script-block, looks like a hack\r\n\r\n```powershell\r\n$sb = {\r\n    Get-Process | select -ExpandProperty name\r\n}\r\n\r\nfunction Verb-Noun {\r\n    [CmdletBinding()]\r\n    param (\r\n        [ArgumentCompleter({ & $sb })]\r\n        $name\r\n    )    \r\n    process {\r\n    }\r\n    \r\n}\r\n```\r\n\r\nEspecially (i'm not a dev however, so may misinterpret things), [here](https://github.com/PowerShell/PowerShell/blob/c1c5344a8897262433141ecbc13bb06ac2c4bbef/src/System.Management.Automation/engine/CommandCompletion/ExtensibleCompletion.cs) there is a piece of code which takes a script-block directly (Line 45):\r\n\r\nhttps://github.com/PowerShell/PowerShell/blob/c1c5344a8897262433141ecbc13bb06ac2c4bbef/src/System.Management.Automation/engine/CommandCompletion/ExtensibleCompletion.cs#L21-L54\r\n\r\nso my expectation were that it should take something of type ScriptBlock, like variable. But looks like this error is generated elsewhere.\r\n\r\nBut, like i said, this ``` { & $sb } ``` approach works for me.\r\n\r\n",
    "created_at": "2018-06-26T14:25:39Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7163#issuecomment-400328428",
    "id": 400328428,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7163",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMDMyODQyOA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/400328428/reactions"
    },
    "updated_at": "2018-06-26T14:26:16Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/400328428",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/9363027?v=4",
      "events_url": "https://api.github.com/users/eosfor/events{/privacy}",
      "followers_url": "https://api.github.com/users/eosfor/followers",
      "following_url": "https://api.github.com/users/eosfor/following{/other_user}",
      "gists_url": "https://api.github.com/users/eosfor/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/eosfor",
      "id": 9363027,
      "login": "eosfor",
      "node_id": "MDQ6VXNlcjkzNjMwMjc=",
      "organizations_url": "https://api.github.com/users/eosfor/orgs",
      "received_events_url": "https://api.github.com/users/eosfor/received_events",
      "repos_url": "https://api.github.com/users/eosfor/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/eosfor/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eosfor/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/eosfor"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@eosfor:\r\n\r\nNote that in order for your completer to work fully as expected you must:\r\n\r\n* pass arguments through to it, as in @powercode's example: `[ArgumentCompleter({ & $sb @Args })]`\r\n\r\n* declare parameters in your script block so you can _access the part (prefix) of the argument to complete that the user has already typed_.\r\n\r\nHere's the full example:\r\n\r\n```powershell\r\n$sb = {\r\n  param($cmdName, $paramName, $wordToComplete)\r\n  Get-Process $wordToComplete* | select-Object -ExpandProperty name\r\n}\r\n\r\nfunction Verb-Noun {\r\n  [CmdletBinding()]\r\n  param (\r\n      [ArgumentCompleter({ & $sb @Args })]\r\n      $name\r\n  )    \r\n  process {\r\n  }\r\n  \r\n}\r\n```\r\n\r\nAgain, note that there's no advantage to using a script block over defining a function here.",
    "created_at": "2018-06-26T15:22:20Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7163#issuecomment-400349828",
    "id": 400349828,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7163",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMDM0OTgyOA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/400349828/reactions"
    },
    "updated_at": "2018-06-26T15:23:10Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/400349828",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "As for the rationale behind only allowing literals (and constants `$null`, `$True`, and `$False`) in attribute arguments:\r\n\r\nOthers are better qualified to comment on that, but my guess is that the main reason is that function definitions are parsed _before_ execution begins, which means that at that time the value of variable `$sb` is not known yet.\r\n\r\nBy contrast, a script-block _literal_ can be parsed, and any variables it references aren't resolved until the block is later _invoked_ at runtime.\r\n\r\n>  Kind of script-block calling another script-block, looks like a hack\r\n\r\nAgain, using a _function_ is the better choice.\r\n\r\n\r\n",
    "created_at": "2018-06-26T15:42:43Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7163#issuecomment-400358104",
    "id": 400358104,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7163",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMDM1ODEwNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/400358104/reactions"
    },
    "updated_at": "2018-06-27T03:39:01Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/400358104",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@eosfor The restriction for static arguments in attibutes is a general check done at parse time. See [SemanticChecks.cs](https://github.com/PowerShell/PowerShell/blob/master/src/System.Management.Automation/engine/parser/SemanticChecks.cs#L247)",
    "created_at": "2018-06-26T19:16:00Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7163#issuecomment-400430756",
    "id": 400430756,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7163",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMDQzMDc1Ng==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/400430756/reactions"
    },
    "updated_at": "2018-06-26T19:16:00Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/400430756",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6876108?v=4",
      "events_url": "https://api.github.com/users/BrucePay/events{/privacy}",
      "followers_url": "https://api.github.com/users/BrucePay/followers",
      "following_url": "https://api.github.com/users/BrucePay/following{/other_user}",
      "gists_url": "https://api.github.com/users/BrucePay/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/BrucePay",
      "id": 6876108,
      "login": "BrucePay",
      "node_id": "MDQ6VXNlcjY4NzYxMDg=",
      "organizations_url": "https://api.github.com/users/BrucePay/orgs",
      "received_events_url": "https://api.github.com/users/BrucePay/received_events",
      "repos_url": "https://api.github.com/users/BrucePay/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/BrucePay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BrucePay/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/BrucePay"
    }
  },
  {
    "author_association": "NONE",
    "body": "I am not really wanting to necro this thread but as someone who was fooling around with this recently, afaict if you use a function in an argument completer attribute then that function has to be exported with the module. I did not see if a script block had the same limitation so do not know if that's an advantage/disadvantage or not. If I figure that out I'll update this comment.\r\n\r\nUpdate: seems maybe this is reported here https://github.com/PowerShell/PowerShell/issues/7265",
    "created_at": "2020-08-12T17:23:56Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7163#issuecomment-673007006",
    "id": 673007006,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7163",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3MzAwNzAwNg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/673007006/reactions"
    },
    "updated_at": "2020-08-12T17:27:14Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/673007006",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/3084796?v=4",
      "events_url": "https://api.github.com/users/ojintoad/events{/privacy}",
      "followers_url": "https://api.github.com/users/ojintoad/followers",
      "following_url": "https://api.github.com/users/ojintoad/following{/other_user}",
      "gists_url": "https://api.github.com/users/ojintoad/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ojintoad",
      "id": 3084796,
      "login": "ojintoad",
      "node_id": "MDQ6VXNlcjMwODQ3OTY=",
      "organizations_url": "https://api.github.com/users/ojintoad/orgs",
      "received_events_url": "https://api.github.com/users/ojintoad/received_events",
      "repos_url": "https://api.github.com/users/ojintoad/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ojintoad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ojintoad/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ojintoad"
    }
  }
]

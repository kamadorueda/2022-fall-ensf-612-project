[
  {
    "author_association": "NONE",
    "body": "AFAIK, Windows supports directory junctions but not file junctions. PowerShell 7.1.0-preview.3 outputs a saner error message than PowerShell 7.0.0, but both lose to Windows PowerShell 5.1. \r\n\r\n## PowerShell 7.1.0-preview.3\r\n\r\n```\r\nPS C:\\temp\\power> New-Item -ItemType Junction -Path .\\link.txt -Target .\\Notice.txt\r\nNew-Item: Could not find item .\\Notice.txt.\r\nPS C:\\temp\\power> New-Item -ItemType Junction -Path C:\\temp\\power\\link.txt -Target C:\\temp\\power\\Notice.txt\r\nNew-Item: A directory is required for the operation. The item 'C:\\temp\\power\\Notice.txt' is not a directory.\r\nPS C:\\temp\\power> New-Item -ItemType Junction -Path C:\\temp\\power\\link.txt -Target C:\\temp\\power\\doesnotexist.txt\r\nNew-Item: Cannot find path 'C:\\temp\\power\\doesnotexist.txt' because it does not exist.\r\nPS C:\\temp\\power> $PSVersionTable\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.1.0-preview.3\r\nPSEdition                      Core\r\nGitCommitId                    7.1.0-preview.3\r\nOS                             Microsoft Windows 10.0.18363\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0…}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n\r\n## PowerShell 7.0.0\r\n\r\n```\r\nPS C:\\temp\\power> New-Item -ItemType Junction -Path .\\link.txt -Target .\\Notice.txt\r\nNew-Item: Could not find item {0}.\r\nPS C:\\temp\\power> New-Item -ItemType Junction -Path C:\\temp\\power\\link.txt -Target C:\\temp\\power\\Notice.txt\r\nNew-Item: A directory is required for the operation. The item 'C:\\temp\\power\\Notice.txt' is not a directory.\r\nPS C:\\temp\\power> New-Item -ItemType Junction -Path C:\\temp\\power\\link.txt -Target C:\\temp\\power\\doesnotexist.txt\r\nNew-Item: Cannot find path 'C:\\temp\\power\\doesnotexist.txt' because it does not exist.\r\nPS C:\\temp\\power> $PSVersionTable\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.0.0\r\nPSEdition                      Core\r\nGitCommitId                    7.0.0\r\nOS                             Microsoft Windows 10.0.18363\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0…}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n\r\n## Windows PowerShell 5.1\r\n\r\n```\r\nPS C:\\temp\\power> New-Item -ItemType Junction -Path .\\link.txt -Target .\\Notice.txt\r\nNew-Item : A directory is required for the operation. The item 'C:\\temp\\power\\Notice.txt' is not a directory.\r\nAt line:1 char:1\r\n+ New-Item -ItemType Junction -Path .\\link.txt -Target .\\Notice.txt\r\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    + CategoryInfo          : InvalidOperation: (C:\\temp\\power\\Notice.txt:String) [New-Item], InvalidOperationExceptio\r\n   n\r\n    + FullyQualifiedErrorId : ItemNotDirectory,Microsoft.PowerShell.Commands.NewItemCommand\r\n\r\nPS C:\\temp\\power> New-Item -ItemType Junction -Path C:\\temp\\power\\link.txt -Target C:\\temp\\power\\Notice.txt\r\nNew-Item : A directory is required for the operation. The item 'C:\\temp\\power\\Notice.txt' is not a directory.\r\nAt line:1 char:1\r\n+ New-Item -ItemType Junction -Path C:\\temp\\power\\link.txt -Target C:\\t ...\r\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    + CategoryInfo          : InvalidOperation: (C:\\temp\\power\\Notice.txt:String) [New-Item], InvalidOperationExceptio\r\n   n\r\n    + FullyQualifiedErrorId : ItemNotDirectory,Microsoft.PowerShell.Commands.NewItemCommand\r\n\r\nPS C:\\temp\\power> New-Item -ItemType Junction -Path C:\\temp\\power\\link.txt -Target C:\\temp\\power\\doesnotexist.txt\r\nNew-Item : Cannot find path 'C:\\temp\\power\\doesnotexist.txt' because it does not exist.\r\nAt line:1 char:1\r\n+ New-Item -ItemType Junction -Path C:\\temp\\power\\link.txt -Target C:\\t ...\r\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    + CategoryInfo          : ObjectNotFound: (C:\\temp\\power\\doesnotexist.txt:String) [New-Item], ItemNotFoundExceptio\r\n   n\r\n    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.NewItemCommand\r\n\r\nPS C:\\temp\\power> $PSVersionTable\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      5.1.18362.752\r\nPSEdition                      Desktop\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\r\nBuildVersion                   10.0.18362.752\r\nCLRVersion                     4.0.30319.42000\r\nWSManStackVersion              3.0\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\n```\r\n\r\n## Windows PowerShell 2.0\r\n\r\nDoes not support `New-Item -ItemType Junction`.\r\n",
    "created_at": "2020-05-25T17:44:31Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12785#issuecomment-633665543",
    "id": 633665543,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12785",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMzY2NTU0Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/633665543/reactions"
    },
    "updated_at": "2020-05-25T17:44:31Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/633665543",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/46201428?v=4",
      "events_url": "https://api.github.com/users/KalleOlaviNiemitalo/events{/privacy}",
      "followers_url": "https://api.github.com/users/KalleOlaviNiemitalo/followers",
      "following_url": "https://api.github.com/users/KalleOlaviNiemitalo/following{/other_user}",
      "gists_url": "https://api.github.com/users/KalleOlaviNiemitalo/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/KalleOlaviNiemitalo",
      "id": 46201428,
      "login": "KalleOlaviNiemitalo",
      "node_id": "MDQ6VXNlcjQ2MjAxNDI4",
      "organizations_url": "https://api.github.com/users/KalleOlaviNiemitalo/orgs",
      "received_events_url": "https://api.github.com/users/KalleOlaviNiemitalo/received_events",
      "repos_url": "https://api.github.com/users/KalleOlaviNiemitalo/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/KalleOlaviNiemitalo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/KalleOlaviNiemitalo/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/KalleOlaviNiemitalo"
    }
  },
  {
    "author_association": "NONE",
    "body": "> ```\r\n> PS C:\\temp\\power> New-Item -ItemType Junction -Path .\\link.txt -Target .\\Notice.txt\r\n> New-Item: Could not find item .\\Notice.txt.\r\n> ```\r\n\r\nProcess Monitor and WinDbg show that PowerShell 7.1.0-preview.3 is calling `GetFileAttributesExW` on `Notice.txt` in the current directory of the process as shown by `[Environment]::CurrentDirectory`, not in the directory that I selected with `Set-Location`.\r\n\r\nPerhaps `FileSystemProvider.NewItem` is calling `GetFileSystemInfo` with a relative path and it needs an absolute path. If I bypass the #8783 change by using a wildcard in `-Target`, then PowerShell 7.1.0-preview.3 gives the correct error message:\r\n\r\n```\r\nPS C:\\temp\\power> New-Item -ItemType Junction -Path .\\link.txt -Target .\\Notic*.txt\r\nNew-Item: A directory is required for the operation. The item 'C:\\temp\\power\\Notice.txt' is not a directory.\r\n```",
    "created_at": "2020-05-25T18:13:09Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12785#issuecomment-633673734",
    "id": 633673734,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12785",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMzY3MzczNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 1,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/633673734/reactions"
    },
    "updated_at": "2020-05-26T07:33:04Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/633673734",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/46201428?v=4",
      "events_url": "https://api.github.com/users/KalleOlaviNiemitalo/events{/privacy}",
      "followers_url": "https://api.github.com/users/KalleOlaviNiemitalo/followers",
      "following_url": "https://api.github.com/users/KalleOlaviNiemitalo/following{/other_user}",
      "gists_url": "https://api.github.com/users/KalleOlaviNiemitalo/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/KalleOlaviNiemitalo",
      "id": 46201428,
      "login": "KalleOlaviNiemitalo",
      "node_id": "MDQ6VXNlcjQ2MjAxNDI4",
      "organizations_url": "https://api.github.com/users/KalleOlaviNiemitalo/orgs",
      "received_events_url": "https://api.github.com/users/KalleOlaviNiemitalo/received_events",
      "repos_url": "https://api.github.com/users/KalleOlaviNiemitalo/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/KalleOlaviNiemitalo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/KalleOlaviNiemitalo/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/KalleOlaviNiemitalo"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "~~Dup~~ Related #12784",
    "created_at": "2020-05-26T05:46:15Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12785#issuecomment-633819360",
    "id": 633819360,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12785",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMzgxOTM2MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/633819360/reactions"
    },
    "updated_at": "2020-06-03T16:40:52Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/633819360",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "@iSazonov - Not sure why this is considered a dup of #12784. One i targeted junctions and the other targeted symlinks and each bug has different symptoms :)",
    "created_at": "2020-06-03T15:59:56Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12785#issuecomment-638291132",
    "id": 638291132,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12785",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzODI5MTEzMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/638291132/reactions"
    },
    "updated_at": "2020-06-03T15:59:56Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/638291132",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/30495043?v=4",
      "events_url": "https://api.github.com/users/sukkergris/events{/privacy}",
      "followers_url": "https://api.github.com/users/sukkergris/followers",
      "following_url": "https://api.github.com/users/sukkergris/following{/other_user}",
      "gists_url": "https://api.github.com/users/sukkergris/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/sukkergris",
      "id": 30495043,
      "login": "sukkergris",
      "node_id": "MDQ6VXNlcjMwNDk1MDQz",
      "organizations_url": "https://api.github.com/users/sukkergris/orgs",
      "received_events_url": "https://api.github.com/users/sukkergris/received_events",
      "repos_url": "https://api.github.com/users/sukkergris/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/sukkergris/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sukkergris/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/sukkergris"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "My thoughts was that it will be fixed in the same place but I am ok to re-open.",
    "created_at": "2020-06-03T16:40:18Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12785#issuecomment-638315424",
    "id": 638315424,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12785",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzODMxNTQyNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/638315424/reactions"
    },
    "updated_at": "2020-06-03T16:40:18Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/638315424",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  }
]

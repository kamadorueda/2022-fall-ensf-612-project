[
  {
    "author_association": "NONE",
    "body": "This is a more general issue â€“ also happens with `ls >out.txt`, `ls | clip`,...\r\n\r\nIt seems that `ls` unconditionally adds the color escape sequences whenever the output is formatted in a table (not sure, but seems like it), without checking if the output actually goes to the terminal.",
    "created_at": "2022-07-06T11:01:32Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17636#issuecomment-1176085426",
    "id": 1176085426,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17636",
    "node_id": "IC_kwDOAvT7bc5GGaOy",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1176085426/reactions"
    },
    "updated_at": "2022-07-25T17:17:57Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1176085426",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6414091?v=4",
      "events_url": "https://api.github.com/users/MatejKafka/events{/privacy}",
      "followers_url": "https://api.github.com/users/MatejKafka/followers",
      "following_url": "https://api.github.com/users/MatejKafka/following{/other_user}",
      "gists_url": "https://api.github.com/users/MatejKafka/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/MatejKafka",
      "id": 6414091,
      "login": "MatejKafka",
      "node_id": "MDQ6VXNlcjY0MTQwOTE=",
      "organizations_url": "https://api.github.com/users/MatejKafka/orgs",
      "received_events_url": "https://api.github.com/users/MatejKafka/received_events",
      "repos_url": "https://api.github.com/users/MatejKafka/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/MatejKafka/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MatejKafka/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/MatejKafka"
    }
  },
  {
    "author_association": "NONE",
    "body": "@MatejKafka No, if I output it to out.txt it isn't there.\r\n\r\nBut I don't know, why they are using on any point of the PowerShell Escape sequences.\r\n\r\nIf I write in C# a program with\r\n```\r\nConsole.ForegroundColor=ConsoleColor.Red;\r\nConsole.Write(\"Hello \");\r\nConsole.ForegroundColor=ConsoleColor.Yellow;\r\nConsole.WriteLine(\"there!\");\r\n```\r\n\r\nI can move it to Out-GridView and every point else and there are no escape sequences.\r\n\r\nIf I write in PowerShell\r\n`Write-Host -ForegroundColor \"Red\" \"Hello \" -NoNewLine ; Write-Host -ForegroundColor \"Yellow\" \"there!\"`\r\n\r\nThats the way  https://github.com/joonro/Get-ChildItemColor works.\r\nAnd Get-ChildItemColor is written in PowerShell, creates an colorizes Get-ChildItem output, and it can be output to Out-GridView without ANSI escape sequences.\r\n\r\nSo why have the current implementation of the Get-ChildItem ANSI escape sequences, when they are not needed and other implementations are possible?\r\n\r\n<blockquote><img src=\"https://opengraph.githubassets.com/b9c9ca2305887b7a3ffc8c45db153fb7bbef54635f935c59137df4a4ac077c1c/joonro/Get-ChildItemColor\" width=\"48\" align=\"right\"><div><img src=\"https://github.githubassets.com/favicons/favicon.svg\" height=\"14\"> GitHub</div><div><strong><a href=\"https://github.com/joonro/Get-ChildItemColor\">GitHub - joonro/Get-ChildItemColor: Provides colorized version of Get-ChildItem Cmdlet of PowerShell.</a></strong></div><div>Provides colorized version of Get-ChildItem Cmdlet of PowerShell. - GitHub - joonro/Get-ChildItemColor: Provides colorized version of Get-ChildItem Cmdlet of PowerShell.</div></blockquote>",
    "created_at": "2022-07-06T12:08:26Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17636#issuecomment-1176142303",
    "id": 1176142303,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17636",
    "node_id": "IC_kwDOAvT7bc5GGoHf",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1176142303/reactions"
    },
    "updated_at": "2022-07-06T12:09:23Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1176142303",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8337032?v=4",
      "events_url": "https://api.github.com/users/theuserbl/events{/privacy}",
      "followers_url": "https://api.github.com/users/theuserbl/followers",
      "following_url": "https://api.github.com/users/theuserbl/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuserbl/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/theuserbl",
      "id": 8337032,
      "login": "theuserbl",
      "node_id": "MDQ6VXNlcjgzMzcwMzI=",
      "organizations_url": "https://api.github.com/users/theuserbl/orgs",
      "received_events_url": "https://api.github.com/users/theuserbl/received_events",
      "repos_url": "https://api.github.com/users/theuserbl/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/theuserbl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuserbl/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/theuserbl"
    }
  },
  {
    "author_association": "NONE",
    "body": "@theuserbl Ah, you're right, the `ls >out.txt` and `ls | clip` scenarios must have been fixed somewhere between -preview.2 (which I use) and -preview.5.\r\n\r\nAs for your other points, I think VT color escape sequences might be used to allow easier configuration using $PSStyle, but I'm only guessing. Also, I think the Win32 API for console colors only supports 16 colors, so using escape sequences might be necessary to get full RGB colors, and it's hard to make Win32 colors work with text remoting (e.g. SSH).",
    "created_at": "2022-07-06T15:14:35Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17636#issuecomment-1176348242",
    "id": 1176348242,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17636",
    "node_id": "IC_kwDOAvT7bc5GHaZS",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1176348242/reactions"
    },
    "updated_at": "2022-07-06T15:20:35Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1176348242",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6414091?v=4",
      "events_url": "https://api.github.com/users/MatejKafka/events{/privacy}",
      "followers_url": "https://api.github.com/users/MatejKafka/followers",
      "following_url": "https://api.github.com/users/MatejKafka/following{/other_user}",
      "gists_url": "https://api.github.com/users/MatejKafka/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/MatejKafka",
      "id": 6414091,
      "login": "MatejKafka",
      "node_id": "MDQ6VXNlcjY0MTQwOTE=",
      "organizations_url": "https://api.github.com/users/MatejKafka/orgs",
      "received_events_url": "https://api.github.com/users/MatejKafka/received_events",
      "repos_url": "https://api.github.com/users/MatejKafka/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/MatejKafka/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MatejKafka/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/MatejKafka"
    }
  },
  {
    "author_association": "NONE",
    "body": "But it's OK if you turn off the experimental feature \"PSAnsiRenderingFileInfo\" . yes ? \r\n\r\n",
    "created_at": "2022-07-06T21:40:14Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17636#issuecomment-1176777496",
    "id": 1176777496,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17636",
    "node_id": "IC_kwDOAvT7bc5GJDMY",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1176777496/reactions"
    },
    "updated_at": "2022-07-06T21:40:14Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1176777496",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/16209593?v=4",
      "events_url": "https://api.github.com/users/jhoneill/events{/privacy}",
      "followers_url": "https://api.github.com/users/jhoneill/followers",
      "following_url": "https://api.github.com/users/jhoneill/following{/other_user}",
      "gists_url": "https://api.github.com/users/jhoneill/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jhoneill",
      "id": 16209593,
      "login": "jhoneill",
      "node_id": "MDQ6VXNlcjE2MjA5NTkz",
      "organizations_url": "https://api.github.com/users/jhoneill/orgs",
      "received_events_url": "https://api.github.com/users/jhoneill/received_events",
      "repos_url": "https://api.github.com/users/jhoneill/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jhoneill/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jhoneill/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jhoneill"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Yes seems to be a bug with the `PSAnsiRenderingFileInfo` experimental feature. The bug does not happen when it is disabled",
    "created_at": "2022-07-11T16:44:18Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17636#issuecomment-1180634392",
    "id": 1180634392,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17636",
    "node_id": "IC_kwDOAvT7bc5GXw0Y",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1180634392/reactions"
    },
    "updated_at": "2022-07-11T16:44:18Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1180634392",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/20605456?v=4",
      "events_url": "https://api.github.com/users/StevenBucher98/events{/privacy}",
      "followers_url": "https://api.github.com/users/StevenBucher98/followers",
      "following_url": "https://api.github.com/users/StevenBucher98/following{/other_user}",
      "gists_url": "https://api.github.com/users/StevenBucher98/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/StevenBucher98",
      "id": 20605456,
      "login": "StevenBucher98",
      "node_id": "MDQ6VXNlcjIwNjA1NDU2",
      "organizations_url": "https://api.github.com/users/StevenBucher98/orgs",
      "received_events_url": "https://api.github.com/users/StevenBucher98/received_events",
      "repos_url": "https://api.github.com/users/StevenBucher98/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/StevenBucher98/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/StevenBucher98/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/StevenBucher98"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "I believe the problem is that `out-gridview` is using the formatdata and not the original object data\r\n",
    "created_at": "2022-07-11T16:48:12Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17636#issuecomment-1180638186",
    "id": 1180638186,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17636",
    "node_id": "IC_kwDOAvT7bc5GXxvq",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1180638186/reactions"
    },
    "updated_at": "2022-07-11T16:48:12Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1180638186",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "Trying to see if this is a somewhat easy fix as this would affect any formatting that adds ANSI escape sequences and used with Out-GridView",
    "created_at": "2022-07-11T17:13:32Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17636#issuecomment-1180661895",
    "id": 1180661895,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17636",
    "node_id": "IC_kwDOAvT7bc5GX3iH",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1180661895/reactions"
    },
    "updated_at": "2022-07-11T17:13:32Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1180661895",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@SteveL-MSFT this is also impacting `Out-ConsoleGridView` https://github.com/PowerShell/GraphicalTools/issues/159. If you fix it for one it may be fixed for both.\r\n\r\n",
    "created_at": "2022-07-11T17:33:33Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17636#issuecomment-1180680939",
    "id": 1180680939,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17636",
    "node_id": "IC_kwDOAvT7bc5GX8Lr",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1180680939/reactions"
    },
    "updated_at": "2022-07-25T17:17:57Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1180680939",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/38873752?v=4",
      "events_url": "https://api.github.com/users/ThomasNieto/events{/privacy}",
      "followers_url": "https://api.github.com/users/ThomasNieto/followers",
      "following_url": "https://api.github.com/users/ThomasNieto/following{/other_user}",
      "gists_url": "https://api.github.com/users/ThomasNieto/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ThomasNieto",
      "id": 38873752,
      "login": "ThomasNieto",
      "node_id": "MDQ6VXNlcjM4ODczNzUy",
      "organizations_url": "https://api.github.com/users/ThomasNieto/orgs",
      "received_events_url": "https://api.github.com/users/ThomasNieto/received_events",
      "repos_url": "https://api.github.com/users/ThomasNieto/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ThomasNieto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ThomasNieto/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ThomasNieto"
    }
  },
  {
    "author_association": "NONE",
    "body": ":tada:This issue was addressed in PowerShell/PowerShell#17664, which has now been successfully released as `v7.3.0-preview.6`.:tada:\n\nHandy links:\n* [Release Notes](https://github.com/PowerShell/PowerShell/releases/tag/v7.3.0-preview.6)\n",
    "created_at": "2022-07-18T21:43:13Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17636#issuecomment-1188348270",
    "id": 1188348270,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17636",
    "node_id": "IC_kwDOAvT7bc5G1MFu",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1188348270/reactions"
    },
    "updated_at": "2022-07-25T17:17:58Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1188348270",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  }
]

[
  {
    "author_association": "NONE",
    "body": "It's not clear if you're using remoting, or if this is a result of putting things in different runspaces on the same machine. \r\n\r\nSerialization has two benefits - firstly if you call a remote server which has the components installed to recognized a `[Microsoft.Teams.ConfigAPI.Cmdlets.Generated.Models.ICallGroupMembershipDetails]` object from a machine that does not, the Deserialized object is understood rather than causing an error.  And secondly even if the object type is understood, the caller does not have the session that was used to get the object so it can't (reliably) do something like \"get this object's parent\", or \"modify this object\" because those expect to be run in the same context as the object was fetched. Something like export-clixml / import-clixml will rehydrate as the same type of object but that isn't possible for every type of object - you need the equivalent of `New-Object  -property @{names=values}  ` (some properties are read-only, and some objects can't be conjured up with New-object) . \r\n\r\nYou haven't said what problem being serialized is causing, but the initial frustration is usually \"I got a widget _there_ and I want to to call it's \"foo\" method _here_ but the method has gone in the serialization process\". Whilst that is the symptom, the foo method often wouldn't work, even if widget objects are understood here.   \r\n\r\n",
    "created_at": "2022-05-10T11:18:58Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17300#issuecomment-1122257397",
    "id": 1122257397,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17300",
    "node_id": "IC_kwDOAvT7bc5C5En1",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1122257397/reactions"
    },
    "updated_at": "2022-05-10T11:18:58Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1122257397",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/16209593?v=4",
      "events_url": "https://api.github.com/users/jhoneill/events{/privacy}",
      "followers_url": "https://api.github.com/users/jhoneill/followers",
      "following_url": "https://api.github.com/users/jhoneill/following{/other_user}",
      "gists_url": "https://api.github.com/users/jhoneill/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jhoneill",
      "id": 16209593,
      "login": "jhoneill",
      "node_id": "MDQ6VXNlcjE2MjA5NTkz",
      "organizations_url": "https://api.github.com/users/jhoneill/orgs",
      "received_events_url": "https://api.github.com/users/jhoneill/received_events",
      "repos_url": "https://api.github.com/users/jhoneill/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jhoneill/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jhoneill/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jhoneill"
    }
  },
  {
    "author_association": "NONE",
    "body": "I'm not sure what the PS Module this command is for ([MicrosoftTeams](https://www.powershellgallery.com/packages/MicrosoftTeams/4.3.0)) does. I just Import it using an `InitialSessionState` using\r\n\r\n```\r\n    var initial = InitialSessionState.CreateDefault();\r\n    initial.ImportPSModule(new string[] { path to module here });\r\n    initial.ExecutionPolicy = Microsoft.PowerShell.ExecutionPolicy.Unrestricted;\r\n    var myRunspacePool = RunspaceFactory.CreateRunspacePool(initialState);\r\n    myRunspacePool .Open();\r\n```\r\nI then connect using \r\n\r\n```\r\n    var ps = PowerShell.Create();\r\n    ps.RunspacePool = myRunspacePool ;\r\n    var myCommand = new Command(\"Connect-MicrosoftTeams\");\r\n    if (!string.IsNullOrEmpty(Config.Login) && Config.Password != null)\r\n    {\r\n         var cred = new PSCredential(Config.Login, Config.Password);\r\n         var param = new CommandParameter(\"Credential\", cred);\r\n          myCommand.Parameters.Add(param);\r\n     }\r\n    ps.Commands.AddCommand(myCommand);\r\n    var result = ps.Invoke();\r\n```\r\n\r\nSo your standard 'run PS command'.\r\n\r\nOnce connected I'd like to run the command I posted above.\r\n\r\nIf I run `Get-CsUserCallingSettings -Identity user4@contoso.com`, I get a PSObject back which has a bunch of properties. Most of them are simple, so they're easy to work with. The property `GroupMembershipDetails` is an array of Objects - that's where the problems start.\r\n\r\nI need to fetch the right item of that list, and modify one of it's property (setting it to another value) and then use the entire modified object that `Get-CsUserCallingSettings` returned as input to another commandlet `Set-CsUserCallingSettings`. The latter won't accept an input of `Deserialized.Whatnot`, but expects the same type that it gave me as return of `Get-CsUserCallingSettings`. No methods will be called... I just need to pick the right item from the list (the one having `CallGroupOwnerId` property equals some value, then set its other property, `NotificationSettings` to a different value), then send the the modified object back.",
    "created_at": "2022-05-10T18:27:09Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17300#issuecomment-1122728697",
    "id": 1122728697,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17300",
    "node_id": "IC_kwDOAvT7bc5C63r5",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1122728697/reactions"
    },
    "updated_at": "2022-05-10T18:29:15Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1122728697",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/2179590?v=4",
      "events_url": "https://api.github.com/users/ssteiner/events{/privacy}",
      "followers_url": "https://api.github.com/users/ssteiner/followers",
      "following_url": "https://api.github.com/users/ssteiner/following{/other_user}",
      "gists_url": "https://api.github.com/users/ssteiner/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ssteiner",
      "id": 2179590,
      "login": "ssteiner",
      "node_id": "MDQ6VXNlcjIxNzk1OTA=",
      "organizations_url": "https://api.github.com/users/ssteiner/orgs",
      "received_events_url": "https://api.github.com/users/ssteiner/received_events",
      "repos_url": "https://api.github.com/users/ssteiner/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ssteiner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ssteiner/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ssteiner"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "It sounds the problem is with the `MicrosoftTeams` module, in that it doesn't support the scenario where result of the `Get-CsUserCallingSettings` can be used as input to another cmdlet `Set-CsUserCallingSettings`.\r\n\r\n@StevenBucher98 and @SydneyhSmith, do either of you knows how to provide feedback to the owner of `MicroosftTeams` about this?",
    "created_at": "2022-05-11T21:49:55Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17300#issuecomment-1124326119",
    "id": 1124326119,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17300",
    "node_id": "IC_kwDOAvT7bc5DA9rn",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1124326119/reactions"
    },
    "updated_at": "2022-05-11T21:49:55Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1124326119",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "I have submitted a contact owners form on PSGallery, hopefully that will get to them. I will do a little more digging to find out owners of `MicrosoftTeams`",
    "created_at": "2022-05-12T15:35:14Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17300#issuecomment-1125143428",
    "id": 1125143428,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17300",
    "node_id": "IC_kwDOAvT7bc5DEFOE",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1125143428/reactions"
    },
    "updated_at": "2022-05-12T15:35:14Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1125143428",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/20605456?v=4",
      "events_url": "https://api.github.com/users/StevenBucher98/events{/privacy}",
      "followers_url": "https://api.github.com/users/StevenBucher98/followers",
      "following_url": "https://api.github.com/users/StevenBucher98/following{/other_user}",
      "gists_url": "https://api.github.com/users/StevenBucher98/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/StevenBucher98",
      "id": 20605456,
      "login": "StevenBucher98",
      "node_id": "MDQ6VXNlcjIwNjA1NDU2",
      "organizations_url": "https://api.github.com/users/StevenBucher98/orgs",
      "received_events_url": "https://api.github.com/users/StevenBucher98/received_events",
      "repos_url": "https://api.github.com/users/StevenBucher98/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/StevenBucher98/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/StevenBucher98/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/StevenBucher98"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@ssteiner I found that opening issue in https://github.com/MicrosoftDocs/office-docs-powershell can get the attention from the `MicrosoftTeams` module owner, one example issue: https://github.com/MicrosoftDocs/office-docs-powershell/issues/9420.\r\nSo, please open an issue about this in that repo, and you will be more likely to get help from the right folks.\n\n<blockquote><img src=\"https://opengraph.githubassets.com/9287505354c455452ceb75fab4f905752e0909851ce18e3ba49ce3768f4a1c75/MicrosoftDocs/office-docs-powershell\" width=\"48\" align=\"right\"><div><img src=\"https://github.githubassets.com/favicons/favicon.svg\" height=\"14\"> GitHub</div><div><strong><a href=\"https://github.com/MicrosoftDocs/office-docs-powershell\">GitHub - MicrosoftDocs/office-docs-powershell: PowerShell Reference for Office Products - Short URL: aka.ms/office-powershell</a></strong></div><div>PowerShell Reference for Office Products - Short URL: aka.ms/office-powershell - GitHub - MicrosoftDocs/office-docs-powershell: PowerShell Reference for Office Products - Short URL: aka.ms/office-p...</div></blockquote>",
    "created_at": "2022-05-12T16:21:50Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17300#issuecomment-1125189673",
    "id": 1125189673,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17300",
    "node_id": "IC_kwDOAvT7bc5DEQgp",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1125189673/reactions"
    },
    "updated_at": "2022-05-12T16:21:52Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1125189673",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "NONE",
    "body": "This issue has been marked as external and has not had any activity for **1 day**. It has been be closed for housekeeping purposes.",
    "created_at": "2022-05-13T19:00:41Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17300#issuecomment-1126357869",
    "id": 1126357869,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17300",
    "node_id": "IC_kwDOAvT7bc5DIttt",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1126357869/reactions"
    },
    "updated_at": "2022-05-13T19:00:41Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1126357869",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  },
  {
    "author_association": "NONE",
    "body": "@ssteiner Thanks for the feedback. \r\n\r\nSet-CsUserCallingSettings does support setting GroupMembershipDetails using the output from Get-CsUserCallingSettings, when run directly in PS. Example 6 in https://docs.microsoft.com/en-us/powershell/module/teams/set-csusercallingsettings?view=teams-ps shows how to do it (fyi, the Index cmd is wrong in the example, since sip: is missing from the user, but I'm in the process of updating the doc).\r\n\r\nI'm not sure why the returned object is different, when running the cmdlet in the SDK. Feel free to contact me offline with more details at jens.trier snablea microsoft.com\n\n<blockquote><img src=\"https://docs.microsoft.com/en-us/media/logos/logo-ms-social.png\" width=\"48\" align=\"right\"><div><strong><a href=\"https://docs.microsoft.com/en-us/powershell/module/teams/set-csusercallingsettings\">Set-CsUserCallingSettings (MicrosoftTeamsPowerShell)</a></strong></div><div>This cmdlet sets the call forwarding, simultaneous ringing and call group settings for the specified user. When specifying settings you need to specify all settings with a settings grouping, for instance, you can't just change a forwarding target. Instead, you need to start by getting the current settings, making the necessary changes, and then setting/writing all settings within the settings group. </div></blockquote>",
    "created_at": "2022-05-16T07:20:27Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17300#issuecomment-1127316258",
    "id": 1127316258,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17300",
    "node_id": "IC_kwDOAvT7bc5DMXsi",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1127316258/reactions"
    },
    "updated_at": "2022-05-16T07:20:29Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1127316258",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/40833221?v=4",
      "events_url": "https://api.github.com/users/JensTrier/events{/privacy}",
      "followers_url": "https://api.github.com/users/JensTrier/followers",
      "following_url": "https://api.github.com/users/JensTrier/following{/other_user}",
      "gists_url": "https://api.github.com/users/JensTrier/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/JensTrier",
      "id": 40833221,
      "login": "JensTrier",
      "node_id": "MDQ6VXNlcjQwODMzMjIx",
      "organizations_url": "https://api.github.com/users/JensTrier/orgs",
      "received_events_url": "https://api.github.com/users/JensTrier/received_events",
      "repos_url": "https://api.github.com/users/JensTrier/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/JensTrier/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JensTrier/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/JensTrier"
    }
  }
]

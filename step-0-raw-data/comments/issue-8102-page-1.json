[
  {
    "author_association": "NONE",
    "body": "BTW, before anyone points me to upgrading to v6.0 core, please note that I have the same issue with v6.0 core:\r\n\r\n```\r\n$PSVersionTable\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      6.0.2\r\nPSEdition                      Core\r\nGitCommitId                    v6.0.2\r\nOS                             Microsoft Windows 10.0.16299\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n\r\nError 404 while trying to open the URI while specifying -Method Head:\r\n\r\n```\r\nInvoke-WebRequest -Uri http://www.fondationlouisvuitton.fr/content/flvinternet/en/expositions/hors-les-murs/philippe-parreno-marilyn/_jcr_content/image.flvcrop.2048.5000.jpeg -Method Head -MaximumRedirection 10\r\n\r\nInvoke-WebRequest : Response status code does not indicate success: 404 (Not Found).\r\nAt line:1 char:1\r\n+ Invoke-WebRequest -Uri http://www.fondationlouisvuitton.fr/content/fl ...\r\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+ CategoryInfo          : InvalidOperation: (Method: HEAD, R...rShell/6.0.2\r\n}:HttpRequestMessage) [Invoke-WebRequest], HttpResponseException\r\n+ FullyQualifiedErrorId : WebCmdletWebResponseException,Microsoft.PowerShell.Commands.InvokeWebRequestCommand\r\n```\r\n\r\nSuccess while trying to open the URI without specifying -Method Head:\r\n\r\n```\r\nInvoke-WebRequest -Uri http://www.fondationlouisvuitton.fr/content/flvinternet/en/expositions/hors-les-murs/philippe-parreno-marilyn/_jcr_content/image.flvcrop.2048.5000.jpeg -MaximumRedirection 10\r\n\r\n\r\nStatusCode        : 200\r\nStatusDescription : OK\r\nContent           : {255, 216, 255, 224...}\r\nRawContent        : HTTP/1.1 200 OK\r\n                    Cache-Control: max-age=7192\r\n                    Connection: close\r\n                    Date: Mon, 22 Oct 2018 09:58:50 GMT\r\n                    Server: Apache\r\n                    X-Content-Type-Options: nosniff\r\n                    X-Frame-Options: SAMEORIGIN\r\n                    Strict-Transport-Sec...\r\nHeaders           : {[Cache-Control, System.String[]], [Connection, System.String[]], [Date, System.String[]], [Server, System.String[]]...}\r\nRawContentLength  : 223987\r\nRelationLink      : {}\r\n```\r\nThen success again while trying to open the URI while specifying -Method Head:\r\n\r\n```\r\nInvoke-WebRequest -Uri http://www.fondationlouisvuitton.fr/content/flvinternet/en/expositions/hors-les-murs/philippe-pa\r\nrreno-marilyn/_jcr_content/image.flvcrop.2048.5000.jpeg -Method Head -MaximumRedirection 10\r\n\r\n\r\nStatusCode        : 200\r\nStatusDescription : OK\r\nContent           : {}\r\nRawContent        : HTTP/1.1 200 OK\r\n                    Cache-Control: max-age=7189\r\n                    Connection: close\r\n                    Date: Mon, 22 Oct 2018 09:58:53 GMT\r\n                    Server: Apache\r\n                    X-Content-Type-Options: nosniff\r\n                    X-Frame-Options: SAMEORIGIN\r\n                    Strict-Transport-Sec...\r\nHeaders           : {[Cache-Control, System.String[]], [Connection, System.String[]], [Date, System.String[]], [Server, System.String[]]...}\r\nRawContentLength  : 0\r\nRelationLink      : {}\r\n```",
    "created_at": "2018-10-22T10:04:50Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8102#issuecomment-431792677",
    "id": 431792677,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8102",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTc5MjY3Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/431792677/reactions"
    },
    "updated_at": "2018-10-22T10:04:50Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/431792677",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/44361972?v=4",
      "events_url": "https://api.github.com/users/FLVSD/events{/privacy}",
      "followers_url": "https://api.github.com/users/FLVSD/followers",
      "following_url": "https://api.github.com/users/FLVSD/following{/other_user}",
      "gists_url": "https://api.github.com/users/FLVSD/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/FLVSD",
      "id": 44361972,
      "login": "FLVSD",
      "node_id": "MDQ6VXNlcjQ0MzYxOTcy",
      "organizations_url": "https://api.github.com/users/FLVSD/orgs",
      "received_events_url": "https://api.github.com/users/FLVSD/received_events",
      "repos_url": "https://api.github.com/users/FLVSD/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/FLVSD/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/FLVSD/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/FLVSD"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Please also take a moment to verify that it does not work with the latest version of PowerShell Core. I believe the updates to the web cmdlet happened after 6.0.2, if I'm not mistaken. :)",
    "created_at": "2018-10-22T11:09:32Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8102#issuecomment-431804621",
    "id": 431804621,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8102",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTgwNDYyMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/431804621/reactions"
    },
    "updated_at": "2018-10-22T11:09:53Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/431804621",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/32407840?v=4",
      "events_url": "https://api.github.com/users/vexx32/events{/privacy}",
      "followers_url": "https://api.github.com/users/vexx32/followers",
      "following_url": "https://api.github.com/users/vexx32/following{/other_user}",
      "gists_url": "https://api.github.com/users/vexx32/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vexx32",
      "id": 32407840,
      "login": "vexx32",
      "node_id": "MDQ6VXNlcjMyNDA3ODQw",
      "organizations_url": "https://api.github.com/users/vexx32/orgs",
      "received_events_url": "https://api.github.com/users/vexx32/received_events",
      "repos_url": "https://api.github.com/users/vexx32/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vexx32/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vexx32/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vexx32"
    }
  },
  {
    "author_association": "NONE",
    "body": "Thanks for your suggestion.\r\n\r\nUpgraded PSH core to v6.1, and got exactly the same behaviour:\r\n\r\n```\r\n$PSVersionTable\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      6.1.0\r\nPSEdition                      Core\r\nGitCommitId                    6.1.0\r\nOS                             Microsoft Windows 10.0.16299\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n```\r\nInvoke-WebRequest -Uri http://www.fondationlouisvuitton.fr/content/flvinternet/en/expositions/hors-les-murs/philippe-parreno-marilyn/_jcr_content/image.flvcrop.2048.5000.jpeg -Method Head -MaximumRedirection 10\r\nInvoke-WebRequest : Response status code does not indicate success: 404 (Not Found).\r\nAt line:1 char:1\r\n+ Invoke-WebRequest -Uri http://www.fondationlouisvuitton.fr/content/fl ...\r\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+ CategoryInfo          : InvalidOperation: (Method: HEAD, R...rShell/6.1.0\r\n}:HttpRequestMessage) [Invoke-WebRequest], HttpResponseException\r\n+ FullyQualifiedErrorId : WebCmdletWebResponseException,Microsoft.PowerShell.Commands.InvokeWebRequestCommand\r\n```\r\n```\r\nInvoke-WebRequest -Uri http://www.fondationlouisvuitton.fr/content/flvinternet/en/expositions/hors-les-murs/philippe-parreno-marilyn/_jcr_content/image.flvcrop.2048.5000.jpeg -MaximumRedirection 10\r\n\r\n\r\nStatusCode        : 200\r\nStatusDescription : OK\r\nContent           : {255, 216, 255, 224...}\r\nRawContent        : HTTP/1.1 200 OK\r\n                    Server: Apache\r\n                    X-Content-Type-Options: nosniff\r\n                    X-Frame-Options: SAMEORIGIN\r\n                    Cache-Control: max-age=1061\r\n                    Date: Mon, 22 Oct 2018 11:40:27 GMT\r\n                    Connection: keep-alive\r\n                    Strict-Transpor...\r\nHeaders           : {[Server, System.String[]], [X-Content-Type-Options, System.String[]], [X-Frame-Options,\r\n                    System.String[]], [Cache-Control, System.String[]]...}\r\nRawContentLength  : 223987\r\nRelationLink      : {}\r\n```\r\n```\r\nInvoke-WebRequest -Uri http://www.fondationlouisvuitton.fr/content/flvinternet/en/expositions/hors-les-murs/philippe-parreno-marilyn/_jcr_content/image.flvcrop.2048.5000.jpeg -Method Head -MaximumRedirection 10\r\n\r\n\r\nStatusCode        : 200\r\nStatusDescription : OK\r\nContent           : {}\r\nRawContent        : HTTP/1.1 200 OK\r\n                    Server: Apache\r\n                    X-Content-Type-Options: nosniff\r\n                    X-Frame-Options: SAMEORIGIN\r\n                    Cache-Control: max-age=1057\r\n                    Date: Mon, 22 Oct 2018 11:40:31 GMT\r\n                    Connection: keep-alive\r\n                    Strict-Transpor...\r\nHeaders           : {[Server, System.String[]], [X-Content-Type-Options, System.String[]], [X-Frame-Options,\r\n                    System.String[]], [Cache-Control, System.String[]]...}\r\nRawContentLength  : 0\r\nRelationLink      : {}\r\n```\r\n",
    "created_at": "2018-10-22T11:46:14Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8102#issuecomment-431811445",
    "id": 431811445,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8102",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTgxMTQ0NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/431811445/reactions"
    },
    "updated_at": "2018-10-22T11:46:14Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/431811445",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/44361972?v=4",
      "events_url": "https://api.github.com/users/FLVSD/events{/privacy}",
      "followers_url": "https://api.github.com/users/FLVSD/followers",
      "following_url": "https://api.github.com/users/FLVSD/following{/other_user}",
      "gists_url": "https://api.github.com/users/FLVSD/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/FLVSD",
      "id": 44361972,
      "login": "FLVSD",
      "node_id": "MDQ6VXNlcjQ0MzYxOTcy",
      "organizations_url": "https://api.github.com/users/FLVSD/orgs",
      "received_events_url": "https://api.github.com/users/FLVSD/received_events",
      "repos_url": "https://api.github.com/users/FLVSD/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/FLVSD/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/FLVSD/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/FLVSD"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "This problem appears to be with the web server you are trying to reach, not with Invoke-WebRequest. I cannot reproduce this with other sites. You will need to contact the owners of that web server for support on accessing their site. They may have ant-scraping or robot protections in place that are being triggered by the request. `HEAD` is not universally supported by all web servers and implementations may vary. The web server may also be filtering based on your IP, User-Agent, and session tokens. These things require additional changes to your calls in order to properly obtain data from some sites.\r\n\r\n\r\n```powershell\r\n$uri = 'https://httpbin.org/redirect-to?status_code=301&url=https://httpbin.org/get'\r\nInvoke-WebRequest -method HEAD -Uri  $uri -MaximumRedirection 10\r\n```",
    "created_at": "2018-10-22T12:15:05Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8102#issuecomment-431817318",
    "id": 431817318,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8102",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTgxNzMxOA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/431817318/reactions"
    },
    "updated_at": "2018-10-22T12:15:05Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/431817318",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6509955?v=4",
      "events_url": "https://api.github.com/users/markekraus/events{/privacy}",
      "followers_url": "https://api.github.com/users/markekraus/followers",
      "following_url": "https://api.github.com/users/markekraus/following{/other_user}",
      "gists_url": "https://api.github.com/users/markekraus/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/markekraus",
      "id": 6509955,
      "login": "markekraus",
      "node_id": "MDQ6VXNlcjY1MDk5NTU=",
      "organizations_url": "https://api.github.com/users/markekraus/orgs",
      "received_events_url": "https://api.github.com/users/markekraus/received_events",
      "repos_url": "https://api.github.com/users/markekraus/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/markekraus/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/markekraus/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/markekraus"
    }
  },
  {
    "author_association": "NONE",
    "body": "Thanks for your comment. The good news is that this website is ours. The bad news is that we are not aware of any exotic configuration that would prevent this.\r\n\r\nWe will however look into this more deeply. It could also be a side effect of the CDN.\r\n\r\nHowever, I still find it strange that it would work without the -Method Head, and that it would work with the -Method Head once it has worked once without. Maybe this could point to a cache effect (and to the CDN).\r\n\r\nI will keep you posted on my finding so that we can hopefully conclude it is not a PSH bug.",
    "created_at": "2018-10-22T12:34:41Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8102#issuecomment-431822141",
    "id": 431822141,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8102",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTgyMjE0MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/431822141/reactions"
    },
    "updated_at": "2018-10-22T12:34:41Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/431822141",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/44361972?v=4",
      "events_url": "https://api.github.com/users/FLVSD/events{/privacy}",
      "followers_url": "https://api.github.com/users/FLVSD/followers",
      "following_url": "https://api.github.com/users/FLVSD/following{/other_user}",
      "gists_url": "https://api.github.com/users/FLVSD/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/FLVSD",
      "id": 44361972,
      "login": "FLVSD",
      "node_id": "MDQ6VXNlcjQ0MzYxOTcy",
      "organizations_url": "https://api.github.com/users/FLVSD/orgs",
      "received_events_url": "https://api.github.com/users/FLVSD/received_events",
      "repos_url": "https://api.github.com/users/FLVSD/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/FLVSD/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/FLVSD/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/FLVSD"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@FLVSD CDN could definitely cause this behavior along with application firewalls. If you are able to run the query directly against your servers instead of the CDN you can at least rule out yor server config.\r\n\r\nCDN's are complex beasts and they are primarily written to work with web browsers. They often have speciqal configurations for curl and wget, but Invoke-WebRequest is not as well known. You may be able to get around CDN issue by using the `-UserAgent` and supplying a User-Gent header for curl or wget.",
    "created_at": "2018-10-22T13:20:44Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8102#issuecomment-431833715",
    "id": 431833715,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8102",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTgzMzcxNQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/431833715/reactions"
    },
    "updated_at": "2018-10-22T13:20:44Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/431833715",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6509955?v=4",
      "events_url": "https://api.github.com/users/markekraus/events{/privacy}",
      "followers_url": "https://api.github.com/users/markekraus/followers",
      "following_url": "https://api.github.com/users/markekraus/following{/other_user}",
      "gists_url": "https://api.github.com/users/markekraus/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/markekraus",
      "id": 6509955,
      "login": "markekraus",
      "node_id": "MDQ6VXNlcjY1MDk5NTU=",
      "organizations_url": "https://api.github.com/users/markekraus/orgs",
      "received_events_url": "https://api.github.com/users/markekraus/received_events",
      "repos_url": "https://api.github.com/users/markekraus/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/markekraus/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/markekraus/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/markekraus"
    }
  },
  {
    "author_association": "NONE",
    "body": "Thanks again for your suggestion.\r\n\r\nWe have good support from our CDN, and I have opened a support ticket with them to plan a diagnostics session. They will also be in a position to give us some highlights on how our servers react, so I guess they should be able to point us in the right direction.",
    "created_at": "2018-10-22T13:47:20Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8102#issuecomment-431840621",
    "id": 431840621,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8102",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTg0MDYyMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/431840621/reactions"
    },
    "updated_at": "2018-10-22T13:47:20Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/431840621",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/44361972?v=4",
      "events_url": "https://api.github.com/users/FLVSD/events{/privacy}",
      "followers_url": "https://api.github.com/users/FLVSD/followers",
      "following_url": "https://api.github.com/users/FLVSD/following{/other_user}",
      "gists_url": "https://api.github.com/users/FLVSD/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/FLVSD",
      "id": 44361972,
      "login": "FLVSD",
      "node_id": "MDQ6VXNlcjQ0MzYxOTcy",
      "organizations_url": "https://api.github.com/users/FLVSD/orgs",
      "received_events_url": "https://api.github.com/users/FLVSD/received_events",
      "repos_url": "https://api.github.com/users/FLVSD/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/FLVSD/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/FLVSD/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/FLVSD"
    }
  }
]

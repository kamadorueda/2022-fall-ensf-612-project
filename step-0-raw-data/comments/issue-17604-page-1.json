[
  {
    "author_association": "NONE",
    "body": "In a c# cmdlet you should be able to use  `base.GetVariableValue(\"VerbosePreference\")` There are few occasions where this is helpful in a script cmdlet \r\n```\r\n        [Parameter(DontShow=$true)]\r\n        [ActionPreference]$VerbosePreference = $PSCmdlet.GetVariableValue('VerbosePreference')\r\n```\r\nSee https://devblogs.microsoft.com/powershell-community/how-to-have-more-control-of-preferences-in-functions-and-the-role-of-modules-on-inheritance/ \r\n\r\n\n\n<blockquote><img src=\"https://devblogs.microsoft.com/powershell-community/wp-content/uploads/sites/69/2021/02/PSHero-240x240-1.png\" width=\"48\" align=\"right\"><div><img src=\"https://devblogs.microsoft.com/powershell-community/wp-content/uploads/sites/69/2021/02/Square150x150Logo.png\" height=\"14\"> PowerShell Community</div><div><strong><a href=\"https://devblogs.microsoft.com/powershell-community/how-to-have-more-control-of-preferences-in-functions-and-the-role-of-modules-on-inheritance/\">On Preferences and Scopes</a></strong></div><div>Progress in PowerShell: a tale of Verbosity and other preferences with lessons in Scopes and Proxies thrown in It started, as these things often do, with someone complaining. In PowerShell Version 7.2 the output of Invoke-WebRequest -Verbose and Invoke-RestMethod -Verbose look like this: VERBOSE: GET with 0-byte payload In all the earlier versions they look like the version below,</div></blockquote>",
    "created_at": "2022-06-29T08:13:37Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17604#issuecomment-1169671435",
    "id": 1169671435,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17604",
    "node_id": "IC_kwDOAvT7bc5Ft8UL",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1169671435/reactions"
    },
    "updated_at": "2022-06-29T08:13:42Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1169671435",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/16209593?v=4",
      "events_url": "https://api.github.com/users/jhoneill/events{/privacy}",
      "followers_url": "https://api.github.com/users/jhoneill/followers",
      "following_url": "https://api.github.com/users/jhoneill/following{/other_user}",
      "gists_url": "https://api.github.com/users/jhoneill/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jhoneill",
      "id": 16209593,
      "login": "jhoneill",
      "node_id": "MDQ6VXNlcjE2MjA5NTkz",
      "organizations_url": "https://api.github.com/users/jhoneill/orgs",
      "received_events_url": "https://api.github.com/users/jhoneill/received_events",
      "repos_url": "https://api.github.com/users/jhoneill/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jhoneill/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jhoneill/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jhoneill"
    }
  },
  {
    "author_association": "NONE",
    "body": "@jhoneill This does not seem to work â€“ in a compiled cmdlet, this gets the preference from the parent scope, meaning setting `$VerbosePreference = \"Continue\"` will work, but passing `-Verbose` will not (`.GetVariableValue(\"VerbosePreference\")` returns `\"SilentlyContinue\"`).\r\n\r\nTest code:\r\n```c#\r\nusing System.Management.Automation;\r\n\r\n[Cmdlet(\"Test\", \"VerbosePreference\")]\r\npublic class TestVerbosePreferenceCommand : PSCmdlet {\r\n    protected override void BeginProcessing() {\r\n        base.BeginProcessing();\r\n        WriteObject(GetVariableValue(\"VerbosePreference\"));\r\n    }\r\n}\r\n```\r\n\r\nInterestingly, `$PSCmdlet.GetVariableValue` works in an advanced function, but apparently not in a compiled cmdlet (I'd guess the variable is not set at all for the cmdlet, so it just inherits the value from the parent scope).",
    "created_at": "2022-06-30T13:54:58Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17604#issuecomment-1171250610",
    "id": 1171250610,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17604",
    "node_id": "IC_kwDOAvT7bc5Fz92y",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1171250610/reactions"
    },
    "updated_at": "2022-06-30T13:56:49Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1171250610",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6414091?v=4",
      "events_url": "https://api.github.com/users/MatejKafka/events{/privacy}",
      "followers_url": "https://api.github.com/users/MatejKafka/followers",
      "following_url": "https://api.github.com/users/MatejKafka/following{/other_user}",
      "gists_url": "https://api.github.com/users/MatejKafka/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/MatejKafka",
      "id": 6414091,
      "login": "MatejKafka",
      "node_id": "MDQ6VXNlcjY0MTQwOTE=",
      "organizations_url": "https://api.github.com/users/MatejKafka/orgs",
      "received_events_url": "https://api.github.com/users/MatejKafka/received_events",
      "repos_url": "https://api.github.com/users/MatejKafka/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/MatejKafka/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MatejKafka/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/MatejKafka"
    }
  },
  {
    "author_association": "NONE",
    "body": "Sorry. What I told you is based on the title, not the body of the question. It will get the variable from outside the cmdlet with a given name. If you want to know if the cmdlet has been run with -Verbose \r\n`base.MyInvocation.BoundParameters.ContainsKey(\"verbose\")`  will tell you if the cmdlet has been run with -Verbose. \r\nYou may need to combine the two because if it is not run with Verbose, do you want to heed what the preference variable says?\r\n\r\n \r\n\r\n",
    "created_at": "2022-06-30T14:18:16Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17604#issuecomment-1171279420",
    "id": 1171279420,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17604",
    "node_id": "IC_kwDOAvT7bc5F0E48",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1171279420/reactions"
    },
    "updated_at": "2022-06-30T14:18:16Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1171279420",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/16209593?v=4",
      "events_url": "https://api.github.com/users/jhoneill/events{/privacy}",
      "followers_url": "https://api.github.com/users/jhoneill/followers",
      "following_url": "https://api.github.com/users/jhoneill/following{/other_user}",
      "gists_url": "https://api.github.com/users/jhoneill/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jhoneill",
      "id": 16209593,
      "login": "jhoneill",
      "node_id": "MDQ6VXNlcjE2MjA5NTkz",
      "organizations_url": "https://api.github.com/users/jhoneill/orgs",
      "received_events_url": "https://api.github.com/users/jhoneill/received_events",
      "repos_url": "https://api.github.com/users/jhoneill/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jhoneill/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jhoneill/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jhoneill"
    }
  },
  {
    "author_association": "NONE",
    "body": "Non-ideal, but it works, thanks. :)",
    "created_at": "2022-06-30T16:48:23Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17604#issuecomment-1171455066",
    "id": 1171455066,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17604",
    "node_id": "IC_kwDOAvT7bc5F0vxa",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1171455066/reactions"
    },
    "updated_at": "2022-06-30T16:48:23Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1171455066",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6414091?v=4",
      "events_url": "https://api.github.com/users/MatejKafka/events{/privacy}",
      "followers_url": "https://api.github.com/users/MatejKafka/followers",
      "following_url": "https://api.github.com/users/MatejKafka/following{/other_user}",
      "gists_url": "https://api.github.com/users/MatejKafka/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/MatejKafka",
      "id": 6414091,
      "login": "MatejKafka",
      "node_id": "MDQ6VXNlcjY0MTQwOTE=",
      "organizations_url": "https://api.github.com/users/MatejKafka/orgs",
      "received_events_url": "https://api.github.com/users/MatejKafka/received_events",
      "repos_url": "https://api.github.com/users/MatejKafka/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/MatejKafka/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MatejKafka/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/MatejKafka"
    }
  },
  {
    "author_association": "NONE",
    "body": "This issue has been marked as answered and has not had any activity for **1 day**. It has been closed for housekeeping purposes.",
    "created_at": "2022-07-02T00:01:13Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17604#issuecomment-1172790297",
    "id": 1172790297,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17604",
    "node_id": "IC_kwDOAvT7bc5F51wZ",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1172790297/reactions"
    },
    "updated_at": "2022-07-02T00:01:13Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1172790297",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  }
]

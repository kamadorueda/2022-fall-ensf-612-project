[
  {
    "author_association": "COLLABORATOR",
    "body": "/cc @PaulHigin \r\n\r\nThis seems kind of strange to me. Does the same thing happen with `Out-Host` as well?",
    "created_at": "2019-11-20T16:58:11Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11134#issuecomment-556102127",
    "id": 556102127,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11134",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NjEwMjEyNw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/556102127/reactions"
    },
    "updated_at": "2019-11-20T16:58:11Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/556102127",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/32407840?v=4",
      "events_url": "https://api.github.com/users/vexx32/events{/privacy}",
      "followers_url": "https://api.github.com/users/vexx32/followers",
      "following_url": "https://api.github.com/users/vexx32/following{/other_user}",
      "gists_url": "https://api.github.com/users/vexx32/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vexx32",
      "id": 32407840,
      "login": "vexx32",
      "node_id": "MDQ6VXNlcjMyNDA3ODQw",
      "organizations_url": "https://api.github.com/users/vexx32/orgs",
      "received_events_url": "https://api.github.com/users/vexx32/received_events",
      "repos_url": "https://api.github.com/users/vexx32/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vexx32/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vexx32/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vexx32"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@vexx32 \r\n\r\n`Out-Host` and `Out-Default` are radically different cmdlets. `Out-Default` is only intended to be used by the host and requires the pipeline to be set up in a specific way to work properly. I have a more detailed description of what's going on in issue #11135",
    "created_at": "2019-11-21T04:29:43Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11134#issuecomment-556914954",
    "id": 556914954,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11134",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NjkxNDk1NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/556914954/reactions"
    },
    "updated_at": "2019-11-21T04:29:43Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/556914954",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6876108?v=4",
      "events_url": "https://api.github.com/users/BrucePay/events{/privacy}",
      "followers_url": "https://api.github.com/users/BrucePay/followers",
      "following_url": "https://api.github.com/users/BrucePay/following{/other_user}",
      "gists_url": "https://api.github.com/users/BrucePay/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/BrucePay",
      "id": 6876108,
      "login": "BrucePay",
      "node_id": "MDQ6VXNlcjY4NzYxMDg=",
      "organizations_url": "https://api.github.com/users/BrucePay/orgs",
      "received_events_url": "https://api.github.com/users/BrucePay/received_events",
      "repos_url": "https://api.github.com/users/BrucePay/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/BrucePay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BrucePay/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/BrucePay"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Good question, @vexx32: Yes, the same thing happens with `Out-Host` (I've updated the title and the OP).\r\n\r\nGiven that `Out-Default` is generally not meant to be used directly, the `Out-Host` case is a more problematic one:\r\n\r\nFor instance, you could be using `| Out-Host` for display-only output.\r\n\r\n(You could also be using it to force _synchronous_ output from implicitly table-formatted cmdlet output, to ensure correct sequencing of intermixed host and success-stream output in the transcript, but the true PowerShell error stream _is_ properly transcribed - leaving  aside that it currently results in _duplicate_ transcript entries; transcribing currently has a number of bugs).\r\n\r\n\r\n\r\n",
    "created_at": "2019-11-21T15:26:51Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11134#issuecomment-557134858",
    "id": 557134858,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11134",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzEzNDg1OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/557134858/reactions"
    },
    "updated_at": "2019-11-21T15:27:22Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/557134858",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@mklement0  Setting aside `Out-Default`, what if you put a `Start-Sleep` before `Stop-Transcription`? Or redirect the streams?\r\n\r\nAre you trying to use `Out-Host` to circumvent format timing issues? Because remember, the pipeline is typically just the output stream.  The other streams still go through formatting and probably hit similar timing issues.",
    "created_at": "2019-11-21T15:48:33Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11134#issuecomment-557144865",
    "id": 557144865,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11134",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzE0NDg2NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/557144865/reactions"
    },
    "updated_at": "2019-11-21T15:49:14Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/557144865",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "The only timing issue I am aware of is the 300 msec. delay when table-formatting is implicitly applied to output types that don't have predefined formatting data (as explained [here](https://stackoverflow.com/a/34858911/45375)). Are there others?\r\n\r\nYes, `Out-Host` solves that timing issue, but that use case isn't problematic, because, as stated in the previous comment, _true error stream content_ IS recorded in that case - it is only _stderr_ output from external programs that is missing.\r\n\r\nI have no personal use case, but it's conceivable that someone just wants to send command output selectively to the host in a script, using `Out-Host`, and that should work with external programs too.\r\n\r\nJust to be safe, I tried adding `Start-Sleep 5` before `Stop-Transcript`, and it made no difference.\r\n\r\nYes, a `2>&1` redirection would solve the problem - but that shouldn't be necessary.\r\n",
    "created_at": "2019-11-21T16:05:29Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11134#issuecomment-557153092",
    "id": 557153092,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11134",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzE1MzA5Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/557153092/reactions"
    },
    "updated_at": "2019-11-21T16:05:48Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/557153092",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Ah.  Yeah you're right.  I think the problem is in the native command processor.  There's a ton of edge cases around what's downstream in the pipeline, etc that determines how stdout/err are directed.  For anyone looking into it I'd recommend starting around here:\r\n\r\nhttps://github.com/PowerShell/PowerShell/blob/8d944fdec28652625d1bb4dadb32d2a581cb8121/src/System.Management.Automation/engine/NativeCommandProcessor.cs#L1191-L1212",
    "created_at": "2019-11-21T16:36:21Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11134#issuecomment-557167401",
    "id": 557167401,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11134",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzE2NzQwMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/557167401/reactions"
    },
    "updated_at": "2019-11-21T16:36:21Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/557167401",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  }
]

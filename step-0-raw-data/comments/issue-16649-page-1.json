[
  {
    "author_association": "COLLABORATOR",
    "body": "@penalvch Could you please check in previous pwsh versions (7.0,7.1,7.2) too?",
    "created_at": "2021-12-19T18:00:49Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16649#issuecomment-997434775",
    "id": 997434775,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16649",
    "node_id": "IC_kwDOAvT7bc47c6WX",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/997434775/reactions"
    },
    "updated_at": "2021-12-19T18:00:49Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/997434775",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "> @penalvch Could you please check in previous pwsh versions (7.0,7.1,7.2) too?\r\n\r\nNo, sorry. I'm just reporting the bug. I'll leave to devs to root cause+resolve.\r\n\r\nThanks!",
    "created_at": "2021-12-19T20:48:18Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16649#issuecomment-997458868",
    "id": 997458868,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16649",
    "node_id": "IC_kwDOAvT7bc47dAO0",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/997458868/reactions"
    },
    "updated_at": "2021-12-19T20:48:18Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/997458868",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8216601?v=4",
      "events_url": "https://api.github.com/users/penalvch-zz/events{/privacy}",
      "followers_url": "https://api.github.com/users/penalvch-zz/followers",
      "following_url": "https://api.github.com/users/penalvch-zz/following{/other_user}",
      "gists_url": "https://api.github.com/users/penalvch-zz/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/penalvch-zz",
      "id": 8216601,
      "login": "penalvch-zz",
      "node_id": "MDQ6VXNlcjgyMTY2MDE=",
      "organizations_url": "https://api.github.com/users/penalvch-zz/orgs",
      "received_events_url": "https://api.github.com/users/penalvch-zz/received_events",
      "repos_url": "https://api.github.com/users/penalvch-zz/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/penalvch-zz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/penalvch-zz/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/penalvch-zz"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "At a guess the problem was caused by https://github.com/PowerShell/PowerShell/commit/ffb1549aa91688bfc910da214fca56b701554aec#diff-042692a5a997e7343b8054779ae2a9cd4a0e697b6270951b8e6fa272ebc64b9eL1721-R1735 which changed the access rights used when opening the service from `SERVICE_CHANGE_CONFIG` to `SERVICE_CHANGE_CONFIG | WRITE_DAC | WRITE_OWNER`. Your account will have the ability to change the config but not write the DAC or owner thus it failing to open the service handle.\r\n\r\nThe extra access rights were added so that it would be able to set the service security descriptor. I think the better option here would be to only add those 2 extra access rights only if `-SecurityDescriptorSddl` was also specified rather than all the time.",
    "created_at": "2021-12-19T21:11:04Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16649#issuecomment-997461884",
    "id": 997461884,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16649",
    "node_id": "IC_kwDOAvT7bc47dA98",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/997461884/reactions"
    },
    "updated_at": "2021-12-19T21:11:19Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/997461884",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8462645?v=4",
      "events_url": "https://api.github.com/users/jborean93/events{/privacy}",
      "followers_url": "https://api.github.com/users/jborean93/followers",
      "following_url": "https://api.github.com/users/jborean93/following{/other_user}",
      "gists_url": "https://api.github.com/users/jborean93/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jborean93",
      "id": 8462645,
      "login": "jborean93",
      "node_id": "MDQ6VXNlcjg0NjI2NDU=",
      "organizations_url": "https://api.github.com/users/jborean93/orgs",
      "received_events_url": "https://api.github.com/users/jborean93/received_events",
      "repos_url": "https://api.github.com/users/jborean93/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jborean93/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jborean93/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jborean93"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "/cc @kvprasoon ",
    "created_at": "2021-12-20T03:38:10Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16649#issuecomment-997566412",
    "id": 997566412,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16649",
    "node_id": "IC_kwDOAvT7bc47dafM",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/997566412/reactions"
    },
    "updated_at": "2021-12-20T03:38:10Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/997566412",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@iSazonov , on it. Thanks for the mention ðŸ˜€.",
    "created_at": "2021-12-20T03:52:21Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16649#issuecomment-997570365",
    "id": 997570365,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16649",
    "node_id": "IC_kwDOAvT7bc47dbc9",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 3,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 3,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/997570365/reactions"
    },
    "updated_at": "2021-12-20T03:52:21Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/997570365",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12897753?v=4",
      "events_url": "https://api.github.com/users/kvprasoon/events{/privacy}",
      "followers_url": "https://api.github.com/users/kvprasoon/followers",
      "following_url": "https://api.github.com/users/kvprasoon/following{/other_user}",
      "gists_url": "https://api.github.com/users/kvprasoon/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/kvprasoon",
      "id": 12897753,
      "login": "kvprasoon",
      "node_id": "MDQ6VXNlcjEyODk3NzUz",
      "organizations_url": "https://api.github.com/users/kvprasoon/orgs",
      "received_events_url": "https://api.github.com/users/kvprasoon/received_events",
      "repos_url": "https://api.github.com/users/kvprasoon/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/kvprasoon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kvprasoon/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/kvprasoon"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@jborean93 like this ?\r\n```\r\nhService = NativeMethods.OpenServiceW(\r\n                        hScManager,\r\n                        Name,\r\n                        string.IsNullOrEmpty(SecurityDescriptorSddl) ? NativeMethods.SERVICE_CHANGE_CONFIG :\r\n                        NativeMethods.SERVICE_CHANGE_CONFIG | NativeMethods.WRITE_DAC | NativeMethods.WRITE_OWNER\r\n                        );\r\n```",
    "created_at": "2021-12-20T11:53:58Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16649#issuecomment-997856886",
    "id": 997856886,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16649",
    "node_id": "IC_kwDOAvT7bc47ehZ2",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/997856886/reactions"
    },
    "updated_at": "2021-12-20T11:53:58Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/997856886",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12897753?v=4",
      "events_url": "https://api.github.com/users/kvprasoon/events{/privacy}",
      "followers_url": "https://api.github.com/users/kvprasoon/followers",
      "following_url": "https://api.github.com/users/kvprasoon/following{/other_user}",
      "gists_url": "https://api.github.com/users/kvprasoon/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/kvprasoon",
      "id": 12897753,
      "login": "kvprasoon",
      "node_id": "MDQ6VXNlcjEyODk3NzUz",
      "organizations_url": "https://api.github.com/users/kvprasoon/orgs",
      "received_events_url": "https://api.github.com/users/kvprasoon/received_events",
      "repos_url": "https://api.github.com/users/kvprasoon/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/kvprasoon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kvprasoon/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/kvprasoon"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Looks like it would work. You could also do something like\r\n\r\n```csharp\r\nvar access = NativeMethods.SERVICE_CHANGE_CONFIG;\r\nif (!string.IsNullOrEmpty(SecurityDescriptorSddl))\r\n    access |= NativeMethods.WRITE_DAC | NativeMethods.WRITE_OWNER;\r\n```\r\n\r\nEither is fine and it's really up to you and whoever reviews your PR :)",
    "created_at": "2021-12-20T19:04:28Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16649#issuecomment-998192973",
    "id": 998192973,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16649",
    "node_id": "IC_kwDOAvT7bc47fzdN",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/998192973/reactions"
    },
    "updated_at": "2021-12-20T19:04:28Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/998192973",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8462645?v=4",
      "events_url": "https://api.github.com/users/jborean93/events{/privacy}",
      "followers_url": "https://api.github.com/users/jborean93/followers",
      "following_url": "https://api.github.com/users/jborean93/following{/other_user}",
      "gists_url": "https://api.github.com/users/jborean93/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jborean93",
      "id": 8462645,
      "login": "jborean93",
      "node_id": "MDQ6VXNlcjg0NjI2NDU=",
      "organizations_url": "https://api.github.com/users/jborean93/orgs",
      "received_events_url": "https://api.github.com/users/jborean93/received_events",
      "repos_url": "https://api.github.com/users/jborean93/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jborean93/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jborean93/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jborean93"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "thanks, this looks more readable.",
    "created_at": "2021-12-22T05:17:56Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16649#issuecomment-999294237",
    "id": 999294237,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16649",
    "node_id": "IC_kwDOAvT7bc47kAUd",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/999294237/reactions"
    },
    "updated_at": "2021-12-22T05:17:56Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/999294237",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12897753?v=4",
      "events_url": "https://api.github.com/users/kvprasoon/events{/privacy}",
      "followers_url": "https://api.github.com/users/kvprasoon/followers",
      "following_url": "https://api.github.com/users/kvprasoon/following{/other_user}",
      "gists_url": "https://api.github.com/users/kvprasoon/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/kvprasoon",
      "id": 12897753,
      "login": "kvprasoon",
      "node_id": "MDQ6VXNlcjEyODk3NzUz",
      "organizations_url": "https://api.github.com/users/kvprasoon/orgs",
      "received_events_url": "https://api.github.com/users/kvprasoon/received_events",
      "repos_url": "https://api.github.com/users/kvprasoon/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/kvprasoon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kvprasoon/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/kvprasoon"
    }
  },
  {
    "author_association": "NONE",
    "body": ":tada:This issue was addressed in #16663, which has now been successfully released as `v7.3.0-preview.4`.:tada:\n\nHandy links:\n* [Release Notes](https://github.com/PowerShell/PowerShell/releases/tag/v7.3.0-preview.4)\n",
    "created_at": "2022-05-23T16:20:47Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16649#issuecomment-1134880786",
    "id": 1134880786,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16649",
    "node_id": "IC_kwDOAvT7bc5DpOgS",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1134880786/reactions"
    },
    "updated_at": "2022-05-23T16:20:47Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1134880786",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  }
]

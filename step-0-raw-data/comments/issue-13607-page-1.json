[
  {
    "author_association": "COLLABORATOR",
    "body": "`$foreach` has no `.Count` property natively, so I'm assuming it causes the enumerator to be iterated to find said count value, similar to how you can iterate an array with `$array.Property` to look at all the `.Property` values in the array. This causes the iterator to be accelerated to the end of the loop entirely as soon as you call `.Count` on it.\r\n\r\nBasically what you're triggering is the same as what this will do:\r\n\r\n```ps1\r\nforeach ($a in 1..10) {\r\n    Write-Host $a\r\n    $foreach.MoveNext()\r\n}\r\n```\r\n\r\nExcept instead of advancing one additional time (skipping values, in effect), you're iterating the whole thing by accident and the next time the loop tries to iterate, it's just told \"we reached the end, exit the loop\".",
    "created_at": "2020-09-09T21:04:01Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13607#issuecomment-689821093",
    "id": 689821093,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13607",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4OTgyMTA5Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/689821093/reactions"
    },
    "updated_at": "2020-09-09T21:04:01Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/689821093",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/32407840?v=4",
      "events_url": "https://api.github.com/users/vexx32/events{/privacy}",
      "followers_url": "https://api.github.com/users/vexx32/followers",
      "following_url": "https://api.github.com/users/vexx32/following{/other_user}",
      "gists_url": "https://api.github.com/users/vexx32/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vexx32",
      "id": 32407840,
      "login": "vexx32",
      "node_id": "MDQ6VXNlcjMyNDA3ODQw",
      "organizations_url": "https://api.github.com/users/vexx32/orgs",
      "received_events_url": "https://api.github.com/users/vexx32/received_events",
      "repos_url": "https://api.github.com/users/vexx32/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vexx32/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vexx32/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vexx32"
    }
  },
  {
    "author_association": "NONE",
    "body": "Thanks for the response. That's a better explanation than what I was able to come up with --- but if that's the case, that's a pretty funky side-effect of calling System.SZArrayEnumerator.Count and is probably never the intention.",
    "created_at": "2020-09-09T21:17:44Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13607#issuecomment-689827132",
    "id": 689827132,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13607",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4OTgyNzEzMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/689827132/reactions"
    },
    "updated_at": "2020-09-09T21:17:44Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/689827132",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/36518357?v=4",
      "events_url": "https://api.github.com/users/ParadoxGBB/events{/privacy}",
      "followers_url": "https://api.github.com/users/ParadoxGBB/followers",
      "following_url": "https://api.github.com/users/ParadoxGBB/following{/other_user}",
      "gists_url": "https://api.github.com/users/ParadoxGBB/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ParadoxGBB",
      "id": 36518357,
      "login": "ParadoxGBB",
      "node_id": "MDQ6VXNlcjM2NTE4MzU3",
      "organizations_url": "https://api.github.com/users/ParadoxGBB/orgs",
      "received_events_url": "https://api.github.com/users/ParadoxGBB/received_events",
      "repos_url": "https://api.github.com/users/ParadoxGBB/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ParadoxGBB/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ParadoxGBB/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ParadoxGBB"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "> that's a pretty funky side-effect of calling System.SZArrayEnumerator.Count and is probably never the intention.\r\n\r\nA bit of a niche scenario for sure, but I would say the example above is as well.  Special casing enumerators here would technically be a [bucket 1 breaking change](https://github.com/PowerShell/PowerShell/blob/b1e998046e12ebe5da9dee479f20d479aa2256d7/docs/dev-process/breaking-change-contract.md#bucket-1-public-contract) (though probably lower impact than that implies), and probably a very small performance hit in the binder.  I don't think it's likely to be changed unless you have a few high impact scenarios you can share.",
    "created_at": "2020-09-10T01:00:13Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13607#issuecomment-689906002",
    "id": 689906002,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13607",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4OTkwNjAwMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/689906002/reactions"
    },
    "updated_at": "2020-09-10T01:00:43Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/689906002",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  },
  {
    "author_association": "NONE",
    "body": "This issue has been marked as answered and has not had any activity for **1 day**. It has been closed for housekeeping purposes.",
    "created_at": "2020-09-11T12:00:12Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13607#issuecomment-691051703",
    "id": 691051703,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13607",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5MTA1MTcwMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/691051703/reactions"
    },
    "updated_at": "2020-09-11T12:00:12Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/691051703",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  }
]

[
  {
    "author_association": "NONE",
    "body": "> Foreign scripts should not be able to pass UAC and execute unseen by piggybacking on other domestic scripts as the $Profile.\r\n\r\nThis is a very good aim.   \r\n\r\nHowever. \r\n1. What is the definition of \"Foreign\" and \"Domestic\".  We know it is common to use the _remote signed_ execution policy but how many unsigned scripts immediately have \"downloaded from the internet\" flag removed. If an attacker is inside already they can sign scripts, and make the them look \"domestic\": when I worked for the the Formula 1 team I gave this pseudo code example that I could put in a signed all-users-all-hosts script (And they said when I was leaving that if something clever and malicious happened they'd blame me!).  \r\n```\r\nif ((james acccount is not present or not enabled) -and (timing looks nasty) -and (account is priviledged) {\r\nget-adComputer | foreach-object -parallel -throttlelimit 10000 {stop-computer $_.name -force}\r\n}\r\n```\r\n2. If I have the access needed to modify your profile, then I can see that it is signed, and I probably have the access I need to sign my version with your certificate. A feature that adds work for me on the basis that if I'm attacked, the attacker will also need to do that work isn't going to win me over. And only a small subset of those who gain access for malice will use this kind of attack, a less oblique attack is much more likely ( IMHO )\r\n3. UAC edits the Administrators  group out of the access token on the shell when a user (other than the default admin) logs on interactively and \"run as admin\" creates a process with the _unedited_ token (some process are automatically trusted and others go via a UAC prompt). Things like scheduled tasks don't do UAC each time, and some roles give privileges to non admin accounts, so the UAC prompt isn't the be-all and end all.\r\n4. A group policy setting which allowed \"require AllSigned  for admin users\" would help: perhaps something which specified paths (with wildcards) which must be signed that could be applied to specific users or specific computers would be better. But we know the people who need it are the ones who don't do security well, and so they are the ones who won't use it. The ones who will use it are doing security well enough that they are very unlikely to need it. Catch-22 :-) \r\n\r\nNone of the above is meant to say this is non-problem, but there is a lot more to it, which needs to be considered in seeking a solution. ",
    "created_at": "2022-04-14T10:16:34Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17148#issuecomment-1099006057",
    "id": 1099006057,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17148",
    "node_id": "IC_kwDOAvT7bc5BgYBp",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1099006057/reactions"
    },
    "updated_at": "2022-04-14T10:16:34Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1099006057",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/16209593?v=4",
      "events_url": "https://api.github.com/users/jhoneill/events{/privacy}",
      "followers_url": "https://api.github.com/users/jhoneill/followers",
      "following_url": "https://api.github.com/users/jhoneill/following{/other_user}",
      "gists_url": "https://api.github.com/users/jhoneill/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jhoneill",
      "id": 16209593,
      "login": "jhoneill",
      "node_id": "MDQ6VXNlcjE2MjA5NTkz",
      "organizations_url": "https://api.github.com/users/jhoneill/orgs",
      "received_events_url": "https://api.github.com/users/jhoneill/received_events",
      "repos_url": "https://api.github.com/users/jhoneill/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jhoneill/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jhoneill/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jhoneill"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@WG-Security\r\nSince you think this may be a security vulnerability, please report it through [Secure@](secure@microsoft.com).  Please see [PowerShell Security Policy](https://github.com/PowerShell/PowerShell/security/policy).\r\n",
    "created_at": "2022-04-18T20:51:07Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17148#issuecomment-1101756434",
    "id": 1101756434,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17148",
    "node_id": "IC_kwDOAvT7bc5Bq3gS",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1101756434/reactions"
    },
    "updated_at": "2022-04-18T20:51:07Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1101756434",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/14019529?v=4",
      "events_url": "https://api.github.com/users/PaulHigin/events{/privacy}",
      "followers_url": "https://api.github.com/users/PaulHigin/followers",
      "following_url": "https://api.github.com/users/PaulHigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulHigin/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/PaulHigin",
      "id": 14019529,
      "login": "PaulHigin",
      "node_id": "MDQ6VXNlcjE0MDE5NTI5",
      "organizations_url": "https://api.github.com/users/PaulHigin/orgs",
      "received_events_url": "https://api.github.com/users/PaulHigin/received_events",
      "repos_url": "https://api.github.com/users/PaulHigin/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/PaulHigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulHigin/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/PaulHigin"
    }
  },
  {
    "author_association": "NONE",
    "body": "> Since you think this may be a security vulnerability, please report it through [Secure@](secure@microsoft.com)\r\n\r\nDone.",
    "created_at": "2022-04-19T06:36:05Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17148#issuecomment-1102148456",
    "id": 1102148456,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17148",
    "node_id": "IC_kwDOAvT7bc5BsXNo",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1102148456/reactions"
    },
    "updated_at": "2022-04-19T06:36:05Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1102148456",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8080834?v=4",
      "events_url": "https://api.github.com/users/iRon7/events{/privacy}",
      "followers_url": "https://api.github.com/users/iRon7/followers",
      "following_url": "https://api.github.com/users/iRon7/following{/other_user}",
      "gists_url": "https://api.github.com/users/iRon7/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iRon7",
      "id": 8080834,
      "login": "iRon7",
      "node_id": "MDQ6VXNlcjgwODA4MzQ=",
      "organizations_url": "https://api.github.com/users/iRon7/orgs",
      "received_events_url": "https://api.github.com/users/iRon7/received_events",
      "repos_url": "https://api.github.com/users/iRon7/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iRon7/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iRon7/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iRon7"
    }
  }
]

[
  {
    "author_association": "NONE",
    "body": "~~From /u/ainesophaur on reddit~~\r\n~~(https://www.reddit.com/r/PowerShell/comments/9doeqm/has_anyone_successfully_been_able_to_get_to_an/)~~\r\n\r\n~~\"There's a github issue about this and ultimately it was stated that authing by key pair will not grant you a kerberos session.. So you're then unable to do remote powershell using kerberos or negotiate auth. Your options are to either sign in with username and password via ssh (which will give you a kerberos ticket) or you have to use basic auth for remote powershell\"~~\r\n\r\n~~This actually makes a lot of sense to me...is that what's going on here?~~\r\n\r\nEDIT: No it's not...",
    "created_at": "2018-09-07T14:15:32Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7728#issuecomment-419453143",
    "id": 419453143,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7728",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxOTQ1MzE0Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/419453143/reactions"
    },
    "updated_at": "2018-09-09T16:45:46Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/419453143",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/10552007?v=4",
      "events_url": "https://api.github.com/users/pldmgg/events{/privacy}",
      "followers_url": "https://api.github.com/users/pldmgg/followers",
      "following_url": "https://api.github.com/users/pldmgg/following{/other_user}",
      "gists_url": "https://api.github.com/users/pldmgg/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/pldmgg",
      "id": 10552007,
      "login": "pldmgg",
      "node_id": "MDQ6VXNlcjEwNTUyMDA3",
      "organizations_url": "https://api.github.com/users/pldmgg/orgs",
      "received_events_url": "https://api.github.com/users/pldmgg/received_events",
      "repos_url": "https://api.github.com/users/pldmgg/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/pldmgg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pldmgg/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/pldmgg"
    }
  },
  {
    "author_association": "NONE",
    "body": "The discussion over here...\r\n\r\nhttps://github.com/PowerShell/Win32-OpenSSH/issues/1246\r\n\r\n...has led me to believe that this is not a Kerberos issue.\r\n\r\nHere's more information.\r\n\r\n### Using Password Auth\r\n\r\nsshd Logs...\r\n(Problems after line 260)\r\nhttps://gist.github.com/pldmgg/2b675389975c19d27ea17cc7da14e52e\r\n\r\nOn the client side, it just hangs...\r\n```powershell\r\nPS C:\\Users\\zeroadmin> New-PSSession -HostName zerowin16sshb\r\nzeroadmin@ZERO@zerowin16sshb's password:\r\n\r\n# I need the Ctrl-C here, otherwise it just hangs indefinitely\r\n```\r\n\r\n### Using SSH (RSA) Cert Auth:\r\n\r\nsshd Logs...\r\n(Problems after line 304)\r\nhttps://gist.github.com/pldmgg/c0172dfbd8a867b5f5c52ae159c14bbd\r\n\r\nOn the client side...\r\n```powershell\r\nPS C:\\Users\\zeroadmin> New-PSSession -HostName zerowin16sshb -UserName zero\\zeroadmin -KeyFilePath \"C:\\Users\\zeroadmin\\.ssh\\zeroadmin_090918_121751-cert.pub\"\r\n\r\n# I need the Ctrl-C here, otherwise it just hangs indefinitely\r\n```\r\n\r\n@dantraMSFT Sorry to bother you, and I'm not really asking for help with diagnosis, but more of a sanity check:\r\n\r\nHave you / anyone you know been able to get pwsh.exe `*-PSSession` cmdlets to work between **two Windows machines** via SSH (i.e. -HostName, -KeyFilePath, -SSHTransport parameter set)? If yes, I'll redouble my efforts to try and diagnose my own problem since I'll know of at least one person that's been successful. But right now, I don't know anyone that's been able to make it work (password auth, key auth, or ssh cert auth).",
    "created_at": "2018-09-09T16:40:11Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7728#issuecomment-419728234",
    "id": 419728234,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7728",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxOTcyODIzNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/419728234/reactions"
    },
    "updated_at": "2018-09-09T16:53:50Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/419728234",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/10552007?v=4",
      "events_url": "https://api.github.com/users/pldmgg/events{/privacy}",
      "followers_url": "https://api.github.com/users/pldmgg/followers",
      "following_url": "https://api.github.com/users/pldmgg/following{/other_user}",
      "gists_url": "https://api.github.com/users/pldmgg/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/pldmgg",
      "id": 10552007,
      "login": "pldmgg",
      "node_id": "MDQ6VXNlcjEwNTUyMDA3",
      "organizations_url": "https://api.github.com/users/pldmgg/orgs",
      "received_events_url": "https://api.github.com/users/pldmgg/received_events",
      "repos_url": "https://api.github.com/users/pldmgg/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/pldmgg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pldmgg/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/pldmgg"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@pldmgg I've been using Server->Server with OpenSSH regularly for the last few weeks; the target is Server 2016 so I've installed OpenSSH there and also PowerShell RC-1. \r\nHere's an example:\r\n\r\n$session = New-PSSession -HostName mytargetserver -UserName testuser -KeyFilePath ~\\.ssh\\testuserprivatekey\r\n\r\nOn the target system, I have the following configuration: \r\n\r\n* sshd_config\r\n\r\n```none\r\nSubsystem\tpowershell c:\\powershell\\pwsh.exe -sshs -NoLogo -NoProfile\r\nPubkeyAuthentication yes\r\nAuthorizedKeysFile\t.ssh/authorized_keys\r\n```\r\n%username%\\.ssh\r\n\r\nI simply copied the public key for my user to authorized_keys. \r\n\r\nI also ran the two permission 'fixing' scripts from the OpenSSH directory (FixHostFilePermissions.ps1 and FixUserFilePermissions.ps1).  Like the Linux versions, OpenSSH requires restricted permissions on various files.\r\n\r\nFinally, if you installed PowerShell under 'Program Files' on the target system, it will not work with OpenSSH due to a [known issue](https://github.com/PowerShell/Win32-OpenSSH/issues/784) with OpenSSH and subsystem paths that contain spaces.  The suggested fix is to create a symlink for pwsh.exe but I found this did not work on my 2016 systems. I ended up creating a directory symlink to the PowerShell Core installation directory. (That's why the above sbsystem references c:\\powershell).  \r\n",
    "created_at": "2018-09-10T17:56:12Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7728#issuecomment-420003367",
    "id": 420003367,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7728",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMDAwMzM2Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/420003367/reactions"
    },
    "updated_at": "2018-09-10T17:56:12Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/420003367",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12105071?v=4",
      "events_url": "https://api.github.com/users/dantraMSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/dantraMSFT/followers",
      "following_url": "https://api.github.com/users/dantraMSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/dantraMSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/dantraMSFT",
      "id": 12105071,
      "login": "dantraMSFT",
      "node_id": "MDQ6VXNlcjEyMTA1MDcx",
      "organizations_url": "https://api.github.com/users/dantraMSFT/orgs",
      "received_events_url": "https://api.github.com/users/dantraMSFT/received_events",
      "repos_url": "https://api.github.com/users/dantraMSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/dantraMSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dantraMSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/dantraMSFT"
    }
  },
  {
    "author_association": "NONE",
    "body": "@dantraMSFT Thanks so much for getting back to me.\r\n\r\nUnfortunately, I still haven't had any success getting the `*-PSSession` cmdlets to work between two Windows 2016 Standard machines. I've tried fresh VMs, different domains, always with the result where pwsh on the client Win16 machine hangs and I need to Ctrl+C.\r\n\r\nI'm certain that I've followed all of the aforementioned guidance (symlinks, permissions, etc), but still no dice.\r\n\r\nI'm not going to close this issue because I really feel like someone should be able to recreate this issue. But I understand if a contributor wants to close this issue without a solution if the issue can't be recreated.",
    "created_at": "2018-09-11T23:37:33Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7728#issuecomment-420461845",
    "id": 420461845,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7728",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMDQ2MTg0NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/420461845/reactions"
    },
    "updated_at": "2018-09-11T23:37:59Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/420461845",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/10552007?v=4",
      "events_url": "https://api.github.com/users/pldmgg/events{/privacy}",
      "followers_url": "https://api.github.com/users/pldmgg/followers",
      "following_url": "https://api.github.com/users/pldmgg/following{/other_user}",
      "gists_url": "https://api.github.com/users/pldmgg/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/pldmgg",
      "id": 10552007,
      "login": "pldmgg",
      "node_id": "MDQ6VXNlcjEwNTUyMDA3",
      "organizations_url": "https://api.github.com/users/pldmgg/orgs",
      "received_events_url": "https://api.github.com/users/pldmgg/received_events",
      "repos_url": "https://api.github.com/users/pldmgg/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/pldmgg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pldmgg/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/pldmgg"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Here are a few things to check:\r\n1: Verify the pwsh.exe symlink actually works. Open a command prompt and attempt to run it as  you have it defined in sshd_config\r\n2: Let's get the Win32 OpenSSH team involved. There's a few errors in the client side log but I don't know how to  interpret them.\r\nEnsure you have logging set up for both client and server as described here: https://github.com/PowerShell/Win32-OpenSSH/wiki/Troubleshooting-Steps\r\nThe I would create an issue here: https://github.com/powershell/Win32-OpenSSH/issues\r\n\r\nFeel free to reference me in the issue so I can stay in the loop.  \r\nI'm going to be unavailable for a few days so be patient if you're looking for a response from me.",
    "created_at": "2018-09-11T23:59:22Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7728#issuecomment-420465831",
    "id": 420465831,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7728",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMDQ2NTgzMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/420465831/reactions"
    },
    "updated_at": "2018-09-11T23:59:22Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/420465831",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12105071?v=4",
      "events_url": "https://api.github.com/users/dantraMSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/dantraMSFT/followers",
      "following_url": "https://api.github.com/users/dantraMSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/dantraMSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/dantraMSFT",
      "id": 12105071,
      "login": "dantraMSFT",
      "node_id": "MDQ6VXNlcjEyMTA1MDcx",
      "organizations_url": "https://api.github.com/users/dantraMSFT/orgs",
      "received_events_url": "https://api.github.com/users/dantraMSFT/received_events",
      "repos_url": "https://api.github.com/users/dantraMSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/dantraMSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dantraMSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/dantraMSFT"
    }
  },
  {
    "author_association": "NONE",
    "body": "HOLY CRAP I figured it out!\r\n\r\nMy mistake was that I was creating the symlink to pwsh.exe directly as opposed to its parent directory, i.e.\r\n\r\n```powershell\r\nNew-Item -ItemType SymbolicLink -Path \"C:\\symlinks\\pwsh.exe\" -Target $(Get-Command pwsh).Source\r\n```\r\n\r\nWhen I made a symlink to pwsh.exe's parent directory (and updated the Subsystem path in sshd_config), the `*-PSSession` cmdlets started working:\r\n\r\n```powershell\r\nNew-Item -ItemType SymbolicLink -Path \"C:\\pwshRoot\" -Target $($(Get-Command pwsh).Source | Split-Path -Parent)\r\n```\r\n\r\nNow we're firing on all cylinders (password auth, key auth, ssh cert auth)\r\n\r\nThanks for your help @dantraMSFT !",
    "created_at": "2018-09-12T12:34:33Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7728#issuecomment-420631496",
    "id": 420631496,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7728",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMDYzMTQ5Ng==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/420631496/reactions"
    },
    "updated_at": "2018-09-12T12:34:33Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/420631496",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/10552007?v=4",
      "events_url": "https://api.github.com/users/pldmgg/events{/privacy}",
      "followers_url": "https://api.github.com/users/pldmgg/followers",
      "following_url": "https://api.github.com/users/pldmgg/following{/other_user}",
      "gists_url": "https://api.github.com/users/pldmgg/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/pldmgg",
      "id": 10552007,
      "login": "pldmgg",
      "node_id": "MDQ6VXNlcjEwNTUyMDA3",
      "organizations_url": "https://api.github.com/users/pldmgg/orgs",
      "received_events_url": "https://api.github.com/users/pldmgg/received_events",
      "repos_url": "https://api.github.com/users/pldmgg/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/pldmgg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pldmgg/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/pldmgg"
    }
  }
]

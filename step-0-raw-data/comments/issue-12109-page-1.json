[
  {
    "author_association": "COLLABORATOR",
    "body": "Why do you use AsPlainText ?",
    "created_at": "2020-03-12T09:17:31Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12109#issuecomment-598084369",
    "id": 598084369,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12109",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5ODA4NDM2OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/598084369/reactions"
    },
    "updated_at": "2020-03-12T09:17:31Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/598084369",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "```powershell\r\n$job = (Start-Job -Name 'a job' -FilePath .\\Exec-Job.ps1 -ArgumentList (ConvertTo-SecureString -String 'aaa'  -Force))            \r\n\r\nConvertTo-SecureString: The parameter value \"aaa\" is not a valid encrypted string.\r\n```\r\n\r\nI'm using a SecureString to specify a machine password in Azure PowerShell.",
    "created_at": "2020-03-12T09:28:06Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12109#issuecomment-598088947",
    "id": 598088947,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12109",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5ODA4ODk0Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/598088947/reactions"
    },
    "updated_at": "2020-03-12T09:28:06Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/598088947",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/43492951?v=4",
      "events_url": "https://api.github.com/users/0x6797/events{/privacy}",
      "followers_url": "https://api.github.com/users/0x6797/followers",
      "following_url": "https://api.github.com/users/0x6797/following{/other_user}",
      "gists_url": "https://api.github.com/users/0x6797/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/0x6797",
      "id": 43492951,
      "login": "0x6797",
      "node_id": "MDQ6VXNlcjQzNDkyOTUx",
      "organizations_url": "https://api.github.com/users/0x6797/orgs",
      "received_events_url": "https://api.github.com/users/0x6797/received_events",
      "repos_url": "https://api.github.com/users/0x6797/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/0x6797/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/0x6797/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/0x6797"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Sorry, I skipped that you use plain text.\r\n\r\nCould you share an error from failed job?",
    "created_at": "2020-03-12T10:22:29Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12109#issuecomment-598111525",
    "id": 598111525,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12109",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5ODExMTUyNQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/598111525/reactions"
    },
    "updated_at": "2020-03-12T10:22:29Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/598111525",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "Never mind.\r\nIt occurs no error in a failed job.\r\n\r\n```powershell\r\n$job = Start-Job -Name \"a job\" -FilePath ./Exec-Job.ps1 -ArgumentList (ConvertTo-SecureString -String 'aaa' -AsPlainText -Force)                                                          \r\n$job | ConvertTo-Json\r\n````\r\n\r\n```json\r\n{\r\n  \"HasMoreData\": false,\r\n  \"StatusMessage\": null,\r\n  \"Location\": \"localhost\",\r\n  \"Command\": \"[CmdletBinding()]\\nparam (\\n    [Parameter(Mandatory=$true, HelpMessage=\\\"The admin password for the VM\\\")]\\n    [System.Security.SecureString] $Password\\n)\\n\\n\\n$DebugPreference = \\\"Continue\\\" \\nSet-StrictMode -Version Latest\\n\\nreturn \\\"Succeeded\\\"\",\r\n  \"JobStateInfo\": {\r\n    \"State\": 3,\r\n    \"Reason\": null\r\n  },\r\n  \"Finished\": {\r\n    \"Handle\": {\r\n      \"value\": 5700\r\n    },\r\n    \"SafeWaitHandle\": {\r\n      \"IsInvalid\": false,\r\n      \"IsClosed\": false\r\n    }\r\n  },\r\n  \"InstanceId\": \"fb2d01c8-b861-4563-bd58-18d0e3cb345e\",\r\n  \"Id\": 3,\r\n  \"Name\": \"a job\",\r\n  \"ChildJobs\": [\r\n    {\r\n      \"StatusMessage\": \"\",\r\n      \"HasMoreData\": false,\r\n      \"Location\": \"localhost\",\r\n      \"Runspace\": \"System.Management.Automation.RemoteRunspace\",\r\n      \"Debugger\": \"System.Management.Automation.RemotingJobDebugger\",\r\n      \"IsAsync\": true,\r\n      \"Command\": \"[CmdletBinding()]\\nparam (\\n    [Parameter(Mandatory=$true, HelpMessage=\\\"The admin password for the VM\\\")]\\n    [System.Security.SecureString] $Password\\n)\\n\\n\\n$DebugPreference = \\\"Continue\\\" \\nSet-StrictMode -Version Latest\\n\\nreturn \\\"Succeeded\\\"\",\r\n      \"JobStateInfo\": \"Failed\",\r\n      \"Finished\": \"System.Threading.ManualResetEvent\",\r\n      \"InstanceId\": \"0371e42b-eb2e-4b26-9787-77c9afeb94bf\",\r\n      \"Id\": 4,\r\n      \"Name\": \"Job4\",\r\n      \"ChildJobs\": \"\",\r\n      \"PSBeginTime\": null,\r\n      \"PSEndTime\": \"2020-03-13T02:05:22.3741521+00:00\",\r\n      \"PSJobTypeName\": \"\",\r\n      \"Output\": \"\",\r\n      \"Error\": \"\",\r\n      \"Progress\": \"\",\r\n      \"Verbose\": \"\",\r\n      \"Debug\": \"\",\r\n      \"Warning\": \"\",\r\n      \"Information\": \"\"\r\n    }\r\n  ],\r\n  \"PSBeginTime\": \"2020-03-13T02:05:21.5682664+00:00\",\r\n  \"PSEndTime\": \"2020-03-13T02:05:22.3741626+00:00\",\r\n  \"PSJobTypeName\": \"BackgroundJob\",\r\n  \"Output\": [],\r\n  \"Error\": [],\r\n  \"Progress\": [],\r\n  \"Verbose\": [],\r\n  \"Debug\": [],\r\n  \"Warning\": [],\r\n  \"Information\": [],\r\n  \"State\": \"Failed\"\r\n}\r\n```\r\n\r\n",
    "created_at": "2020-03-13T02:09:24Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12109#issuecomment-598513578",
    "id": 598513578,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12109",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5ODUxMzU3OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/598513578/reactions"
    },
    "updated_at": "2020-03-13T02:09:24Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/598513578",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/43492951?v=4",
      "events_url": "https://api.github.com/users/0x6797/events{/privacy}",
      "followers_url": "https://api.github.com/users/0x6797/followers",
      "following_url": "https://api.github.com/users/0x6797/following{/other_user}",
      "gists_url": "https://api.github.com/users/0x6797/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/0x6797",
      "id": 43492951,
      "login": "0x6797",
      "node_id": "MDQ6VXNlcjQzNDkyOTUx",
      "organizations_url": "https://api.github.com/users/0x6797/orgs",
      "received_events_url": "https://api.github.com/users/0x6797/received_events",
      "repos_url": "https://api.github.com/users/0x6797/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/0x6797/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/0x6797/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/0x6797"
    }
  },
  {
    "author_association": "NONE",
    "body": "Should I avoid to use SecureString?\r\nhttps://github.com/PowerShell/PowerShell/issues/12114#issuecomment-598192488\r\n\r\nIf so, Could I see a warning or a 'deprecated' message when I would use ConvertTo-SecureString.\r\n",
    "created_at": "2020-03-13T02:26:26Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12109#issuecomment-598517470",
    "id": 598517470,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12109",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5ODUxNzQ3MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/598517470/reactions"
    },
    "updated_at": "2020-03-13T02:26:26Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/598517470",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/43492951?v=4",
      "events_url": "https://api.github.com/users/0x6797/events{/privacy}",
      "followers_url": "https://api.github.com/users/0x6797/followers",
      "following_url": "https://api.github.com/users/0x6797/following{/other_user}",
      "gists_url": "https://api.github.com/users/0x6797/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/0x6797",
      "id": 43492951,
      "login": "0x6797",
      "node_id": "MDQ6VXNlcjQzNDkyOTUx",
      "organizations_url": "https://api.github.com/users/0x6797/orgs",
      "received_events_url": "https://api.github.com/users/0x6797/received_events",
      "repos_url": "https://api.github.com/users/0x6797/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/0x6797/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/0x6797/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/0x6797"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "I ask about error because I guess there is the same error as in https://github.com/PowerShell/PowerShell/issues/4952. I guess it is an issue with libme on Unix/MacOs.\r\nPerhaps @PaulHigin have thoughts.",
    "created_at": "2020-03-13T03:46:32Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12109#issuecomment-598534444",
    "id": 598534444,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12109",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5ODUzNDQ0NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/598534444/reactions"
    },
    "updated_at": "2020-03-13T03:46:32Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/598534444",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "Thank you for your response.\r\nCould you tell me how to get errors in my environment?",
    "created_at": "2020-03-13T03:59:15Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12109#issuecomment-598536759",
    "id": 598536759,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12109",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5ODUzNjc1OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/598536759/reactions"
    },
    "updated_at": "2020-03-13T03:59:15Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/598536759",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/43492951?v=4",
      "events_url": "https://api.github.com/users/0x6797/events{/privacy}",
      "followers_url": "https://api.github.com/users/0x6797/followers",
      "following_url": "https://api.github.com/users/0x6797/following{/other_user}",
      "gists_url": "https://api.github.com/users/0x6797/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/0x6797",
      "id": 43492951,
      "login": "0x6797",
      "node_id": "MDQ6VXNlcjQzNDkyOTUx",
      "organizations_url": "https://api.github.com/users/0x6797/orgs",
      "received_events_url": "https://api.github.com/users/0x6797/received_events",
      "repos_url": "https://api.github.com/users/0x6797/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/0x6797/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/0x6797/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/0x6797"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "If Get-Error show nothing you could build and debug.\r\n\r\nAlso direct call Exec-Job.ps1 works well?",
    "created_at": "2020-03-13T04:28:46Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12109#issuecomment-598542296",
    "id": 598542296,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12109",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5ODU0MjI5Ng==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/598542296/reactions"
    },
    "updated_at": "2020-03-13T04:29:48Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/598542296",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "Is here what you want?\r\n\r\n```yaml\r\nType           : System.Management.Automation.CmdletInvocationException\r\nErrorRecord    : \r\n    Exception             : \r\n        Type        : System.Management.Automation.PSArgumentOutOfRangeException\r\n        ErrorRecord : \r\n            Exception             : \r\n                Type    : System.Management.Automation.ParentContainsErrorRecordException\r\n                Message : The scope number '1' exceeds the number of active scopes. (Parameter 'Scope')\r\n                          Actual value was 1.\r\n                HResult : -2146233087\r\n            CategoryInfo          : InvalidArgument: (:) [], ParentContainsErrorRecordException\r\n            FullyQualifiedErrorId : ArgumentOutOfRange\r\n        Message     : The scope number '1' exceeds the number of active scopes. (Parameter 'Scope')\r\n                      Actual value was 1.\r\n        ActualValue : 1\r\n        ParamName   : Scope\r\n        TargetSite  : \r\n            Name          : GetScopeByID\r\n            DeclaringType : System.Management.Automation.SessionStateInternal, System.Management.Automation, Version=7.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\r\n            MemberType    : Method\r\n            Module        : System.Management.Automation.dll\r\n        StackTrace  : \r\n   at System.Management.Automation.SessionStateInternal.GetScopeByID(Int32 scopeID)\r\n   at System.Management.Automation.SessionStateInternal.GetScopeByID(String scopeID)\r\n   at System.Management.Automation.SessionStateInternal.GetVariableTableAtScope(String scopeID)\r\n   at Microsoft.PowerShell.Commands.VariableCommandBase.GetMatchingVariables(String name, String lookupScope, Boolean& wasFiltered, Boolean quiet)\r\n   at Microsoft.PowerShell.Commands.GetVariableCommand.ProcessRecord()\r\n   at System.Management.Automation.Cmdlet.DoProcessRecord()\r\n   at System.Management.Automation.CommandProcessor.ProcessRecord()\r\n        Source      : System.Management.Automation\r\n        HResult     : -2146233086\r\n    CategoryInfo          : InvalidArgument: (:) [Get-Variable], PSArgumentOutOfRangeException\r\n    FullyQualifiedErrorId : ArgumentOutOfRange,Microsoft.PowerShell.Commands.GetVariableCommand\r\n    InvocationInfo        : \r\n        MyCommand       : Get-Variable\r\n        HistoryId       : 24\r\n        InvocationName  : Get-Variable\r\n        CommandOrigin   : Internal\r\n    ScriptStackTrace      : at <ScriptBlock>, /home/hayashi_toshiki/Documents/azure-powershell-jobs/Exec-Parallel-Jobs.ps1: line 22\r\n                            at <ScriptBlock>, <No file>: line 1\r\n    PipelineIterationInfo :\r\n\r\n\r\n\r\nTargetSite     : \r\n    Name          : Invoke\r\n    DeclaringType : System.Management.Automation.Runspaces.PipelineBase, System.Management.Automation, Version=7.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\r\n    MemberType    : Method\r\n    Module        : System.Management.Automation.dll\r\nStackTrace     : \r\n   at System.Management.Automation.Runspaces.PipelineBase.Invoke(IEnumerable input)\r\n   at System.Management.Automation.Runspaces.Pipeline.Invoke()\r\n   at System.Management.Automation.PowerShell.Worker.ConstructPipelineAndDoWork(Runspace rs, Boolean performSyncInvoke)\r\n   at System.Management.Automation.PowerShell.CoreInvokeHelper[TInput,TOutput](PSDataCollection`1 input, PSDataCollection`1 output, PSInvocationSettings settings)\r\n   at System.Management.Automation.PowerShell.CoreInvoke[TInput,TOutput](PSDataCollection`1 input, PSDataCollection`1 output, PSInvocationSettings settings)\r\n   at System.Management.Automation.PowerShell.CoreInvoke[TOutput](IEnumerable input, PSDataCollection`1 output, PSInvocationSettings settings)\r\n   at System.Management.Automation.PowerShell.Invoke[T](IEnumerable input, IList`1 output, PSInvocationSettings settings)\r\n   at System.Management.Automation.PowerShell.Invoke[T](IEnumerable input, PSInvocationSettings settings)\r\n   at Microsoft.PowerShell.EditorServices.Services.PowerShellContextService.ExecuteCommandAsync[TResult](PSCommand psCommand, StringBuilder errorMessages, ExecutionOptions executionOptions) in D:\\a\\1\\s\\src\\PowerShellEditorServices\\Services\\PowerShellContext\\PowerShellContextService.cs:line 760\r\n   at Microsoft.PowerShell.EditorServices.Services.PowerShellContextService.ExecuteCommandAsync[TResult](PSCommand psCommand, StringBuilder errorMessages, ExecutionOptions executionOptions) in D:\\a\\1\\s\\src\\PowerShellEditorServices\\Services\\PowerShellContext\\PowerShellContextService.cs:line 809\r\nMessage        : The scope number '1' exceeds the number of active scopes. (Parameter 'Scope')\r\n                 Actual value was 1.\r\nInnerException : \r\n    Type        : System.Management.Automation.PSArgumentOutOfRangeException\r\n    ErrorRecord : \r\n        Exception             : \r\n            Type    : System.Management.Automation.ParentContainsErrorRecordException\r\n            Message : The scope number '1' exceeds the number of active scopes. (Parameter 'Scope')\r\n                      Actual value was 1.\r\n            HResult : -2146233087\r\n        CategoryInfo          : InvalidArgument: (:) [], ParentContainsErrorRecordException\r\n        FullyQualifiedErrorId : ArgumentOutOfRange\r\n    Message     : The scope number '1' exceeds the number of active scopes. (Parameter 'Scope')\r\n                  Actual value was 1.\r\n    ActualValue : 1\r\n    ParamName   : Scope\r\n    TargetSite  : \r\n        Name          : GetScopeByID\r\n        DeclaringType : System.Management.Automation.SessionStateInternal, System.Management.Automation, Version=7.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\r\n        MemberType    : Method\r\n        Module        : System.Management.Automation.dll\r\n    StackTrace  : \r\n   at System.Management.Automation.SessionStateInternal.GetScopeByID(Int32 scopeID)\r\n   at System.Management.Automation.SessionStateInternal.GetScopeByID(String scopeID)\r\n   at System.Management.Automation.SessionStateInternal.GetVariableTableAtScope(String scopeID)\r\n   at Microsoft.PowerShell.Commands.VariableCommandBase.GetMatchingVariables(String name, String lookupScope, Boolean& wasFiltered, Boolean quiet)\r\n   at Microsoft.PowerShell.Commands.GetVariableCommand.ProcessRecord()\r\n   at System.Management.Automation.Cmdlet.DoProcessRecord()\r\n   at System.Management.Automation.CommandProcessor.ProcessRecord()\r\n    Source      : System.Management.Automation\r\n    HResult     : -2146233086\r\nSource         : System.Management.Automation\r\nHResult        : -2146233087\r\n```\r\n\r\n> Also direct call Exec-Job.ps1 works well?\r\n\r\nI called Exec-Job.ps1 directly, and it completed normally.\r\nBut, I could see System.Management.Automation.CmdletInvocationException in invoking that script.\r\n\r\nHere is.\r\n\r\n```yaml\r\nType           : System.Management.Automation.CmdletInvocationException\r\nErrorRecord    : \r\n    Exception             : \r\n        Type        : System.Management.Automation.PSArgumentOutOfRangeException\r\n        ErrorRecord : \r\n            Exception             : \r\n                Type    : System.Management.Automation.ParentContainsErrorRecordException\r\n                Message : The scope number '1' exceeds the number of active scopes. (Parameter 'Scope')\r\n                          Actual value was 1.\r\n                HResult : -2146233087\r\n            CategoryInfo          : InvalidArgument: (:) [], ParentContainsErrorRecordException\r\n            FullyQualifiedErrorId : ArgumentOutOfRange\r\n        Message     : The scope number '1' exceeds the number of active scopes. (Parameter 'Scope')\r\n                      Actual value was 1.\r\n        ActualValue : 1\r\n        ParamName   : Scope\r\n        TargetSite  : \r\n            Name          : GetScopeByID\r\n            DeclaringType : System.Management.Automation.SessionStateInternal, System.Management.Automation, Version=7.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\r\n            MemberType    : Method\r\n            Module        : System.Management.Automation.dll\r\n        StackTrace  : \r\n   at System.Management.Automation.SessionStateInternal.GetScopeByID(Int32 scopeID)\r\n   at System.Management.Automation.SessionStateInternal.GetScopeByID(String scopeID)\r\n   at System.Management.Automation.SessionStateInternal.GetVariableTableAtScope(String scopeID)\r\n   at Microsoft.PowerShell.Commands.VariableCommandBase.GetMatchingVariables(String name, String lookupScope, Boolean& wasFiltered, Boolean quiet)\r\n   at Microsoft.PowerShell.Commands.GetVariableCommand.ProcessRecord()\r\n   at System.Management.Automation.Cmdlet.DoProcessRecord()\r\n   at System.Management.Automation.CommandProcessor.ProcessRecord()\r\n        Source      : System.Management.Automation\r\n        HResult     : -2146233086\r\n    CategoryInfo          : InvalidArgument: (:) [Get-Variable], PSArgumentOutOfRangeException\r\n    FullyQualifiedErrorId : ArgumentOutOfRange,Microsoft.PowerShell.Commands.GetVariableCommand\r\n    InvocationInfo        : \r\n        MyCommand       : Get-Variable\r\n        HistoryId       : 32\r\n        InvocationName  : Get-Variable\r\n        CommandOrigin   : Internal\r\n    ScriptStackTrace      : at <ScriptBlock>, /home/hayashi_toshiki/Documents/azure-powershell-jobs/Exec-Job.ps1: line 8\r\n                            at <ScriptBlock>, <No file>: line 1\r\n    PipelineIterationInfo : \r\n\r\n\r\n\r\nTargetSite     : \r\n    Name          : Invoke\r\n    DeclaringType : System.Management.Automation.Runspaces.PipelineBase, System.Management.Automation, Version=7.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\r\n    MemberType    : Method\r\n    Module        : System.Management.Automation.dll\r\nStackTrace     : \r\n   at System.Management.Automation.Runspaces.PipelineBase.Invoke(IEnumerable input)\r\n   at System.Management.Automation.Runspaces.Pipeline.Invoke()\r\n   at System.Management.Automation.PowerShell.Worker.ConstructPipelineAndDoWork(Runspace rs, Boolean performSyncInvoke)\r\n   at System.Management.Automation.PowerShell.CoreInvokeHelper[TInput,TOutput](PSDataCollection`1 input, PSDataCollection`1 output, PSInvocationSettings settings)\r\n   at System.Management.Automation.PowerShell.CoreInvoke[TInput,TOutput](PSDataCollection`1 input, PSDataCollection`1 output, PSInvocationSettings settings)\r\n   at System.Management.Automation.PowerShell.CoreInvoke[TOutput](IEnumerable input, PSDataCollection`1 output, PSInvocationSettings settings)\r\n   at System.Management.Automation.PowerShell.Invoke[T](IEnumerable input, IList`1 output, PSInvocationSettings settings)\r\n   at System.Management.Automation.PowerShell.Invoke[T](IEnumerable input, PSInvocationSettings settings)\r\n   at Microsoft.PowerShell.EditorServices.Services.PowerShellContextService.ExecuteCommandAsync[TResult](PSCommand psCommand, StringBuilder errorMessages, ExecutionOptions executionOptions) in D:\\a\\1\\s\\src\\PowerShellEditorServices\\Services\\PowerShellContext\\PowerShellContextService.cs:line 908\r\n   at Microsoft.PowerShell.EditorServices.Services.PowerShellContextService.ExecuteCommandAsync[TResult](PSCommand psCommand, StringBuilder errorMessages, ExecutionOptions executionOptions) in D:\\a\\1\\s\\src\\PowerShellEditorServices\\Services\\PowerShellContext\\PowerShellContextService.cs:line 908\r\nMessage        : The scope number '1' exceeds the number of active scopes. (Parameter 'Scope')\r\n                 Actual value was 1.\r\nInnerException : \r\n    Type        : System.Management.Automation.PSArgumentOutOfRangeException\r\n    ErrorRecord : \r\n        Exception             : \r\n            Type    : System.Management.Automation.ParentContainsErrorRecordException\r\n            Message : The scope number '1' exceeds the number of active scopes. (Parameter 'Scope')\r\n                      Actual value was 1.\r\n            HResult : -2146233087\r\n        CategoryInfo          : InvalidArgument: (:) [], ParentContainsErrorRecordException\r\n        FullyQualifiedErrorId : ArgumentOutOfRange\r\n    Message     : The scope number '1' exceeds the number of active scopes. (Parameter 'Scope')\r\n                  Actual value was 1.\r\n    ActualValue : 1\r\n    ParamName   : Scope\r\n    TargetSite  : \r\n        Name          : GetScopeByID\r\n        DeclaringType : System.Management.Automation.SessionStateInternal, System.Management.Automation, Version=7.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\r\n        MemberType    : Method\r\n        Module        : System.Management.Automation.dll\r\n    StackTrace  : \r\n   at System.Management.Automation.SessionStateInternal.GetScopeByID(Int32 scopeID)\r\n   at System.Management.Automation.SessionStateInternal.GetScopeByID(String scopeID)\r\n   at System.Management.Automation.SessionStateInternal.GetVariableTableAtScope(String scopeID)\r\n   at Microsoft.PowerShell.Commands.VariableCommandBase.GetMatchingVariables(String name, String lookupScope, Boolean& wasFiltered, Boolean quiet)\r\n   at Microsoft.PowerShell.Commands.GetVariableCommand.ProcessRecord()\r\n   at System.Management.Automation.Cmdlet.DoProcessRecord()\r\n   at System.Management.Automation.CommandProcessor.ProcessRecord()\r\n    Source      : System.Management.Automation\r\n    HResult     : -2146233086\r\nSource         : System.Management.Automation\r\nHResult        : -2146233087\r\n```\r\n",
    "created_at": "2020-03-13T05:51:38Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12109#issuecomment-598562384",
    "id": 598562384,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12109",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5ODU2MjM4NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/598562384/reactions"
    },
    "updated_at": "2020-03-13T05:51:38Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/598562384",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/43492951?v=4",
      "events_url": "https://api.github.com/users/0x6797/events{/privacy}",
      "followers_url": "https://api.github.com/users/0x6797/followers",
      "following_url": "https://api.github.com/users/0x6797/following{/other_user}",
      "gists_url": "https://api.github.com/users/0x6797/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/0x6797",
      "id": 43492951,
      "login": "0x6797",
      "node_id": "MDQ6VXNlcjQzNDkyOTUx",
      "organizations_url": "https://api.github.com/users/0x6797/orgs",
      "received_events_url": "https://api.github.com/users/0x6797/received_events",
      "repos_url": "https://api.github.com/users/0x6797/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/0x6797/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/0x6797/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/0x6797"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "I think the error is unrelated to `SecureString`, and instead relates to scoping:\r\n\r\nThe problem is that by using `Start-Job -FilePath`, the _content_ of the referenced script file executes _directly in the global scope_, and if your script contains attempts  to reference any scope _above_ the current scope - notably via `Get-Variable -Scope 1` - an error occurs, because the global scope is the topmost scope.\r\n\r\nHere's a simple demonstration:\r\n\r\n```powershell\r\n@'\r\n'in'\r\nGet-Variable HOME -Scope 1 -ValueOnly\r\n'out'\r\n'@ > t.ps1\r\n\r\nStart-Job -FilePath ./t.ps1 | Receive-Job -Wait -AutoRemove\r\n```\r\n\r\nIf you run `./t.ps1` directly, it'll work as expected and report the value of the automatic `$HOME` variable.\r\n\r\nBy contrast, the invocation via `Start-Job -FilePath` above yields the following:\r\n\r\n```none\r\nin\r\nGet-Variable: The scope number '1' exceeds the number of active scopes. (Parameter 'Scope')\r\nActual value was 1.\r\nout\r\n```",
    "created_at": "2020-03-14T19:33:09Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12109#issuecomment-599125312",
    "id": 599125312,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12109",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5OTEyNTMxMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/599125312/reactions"
    },
    "updated_at": "2020-03-14T19:33:09Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/599125312",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  }
]

[
  {
    "author_association": "MEMBER",
    "body": "@hoppi1804 can you confirm if this worked with Windows PowerShell 5.1?  Would be good to know if this is a regression.  Thanks.",
    "created_at": "2021-03-04T01:18:01Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14843#issuecomment-790206574",
    "id": 790206574,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14843",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5MDIwNjU3NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/790206574/reactions"
    },
    "updated_at": "2021-03-04T01:18:01Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/790206574",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "NONE",
    "body": "No, with Microsoft.PowerShell.5.1.ReferenceAssemblies v1.0.0 this is not working, either. Using (almost) same code with .NET Framework 4.8.",
    "created_at": "2021-03-04T06:04:44Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14843#issuecomment-790321119",
    "id": 790321119,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14843",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5MDMyMTExOQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/790321119/reactions"
    },
    "updated_at": "2021-03-04T06:05:16Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/790321119",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/14229290?v=4",
      "events_url": "https://api.github.com/users/hoppi1804/events{/privacy}",
      "followers_url": "https://api.github.com/users/hoppi1804/followers",
      "following_url": "https://api.github.com/users/hoppi1804/following{/other_user}",
      "gists_url": "https://api.github.com/users/hoppi1804/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/hoppi1804",
      "id": 14229290,
      "login": "hoppi1804",
      "node_id": "MDQ6VXNlcjE0MjI5Mjkw",
      "organizations_url": "https://api.github.com/users/hoppi1804/orgs",
      "received_events_url": "https://api.github.com/users/hoppi1804/received_events",
      "repos_url": "https://api.github.com/users/hoppi1804/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/hoppi1804/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hoppi1804/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/hoppi1804"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "This seems to be \"by design\" if it doesn't work in 5.1.  cc @PaulHigin if he has any insights",
    "created_at": "2021-03-05T23:08:32Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14843#issuecomment-791779988",
    "id": 791779988,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14843",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5MTc3OTk4OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/791779988/reactions"
    },
    "updated_at": "2021-03-05T23:08:32Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/791779988",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "I see this behavior too, and it looks like a bug to me.\r\n```powershell\r\n$ps.AddScript('icm . { write-verbose \"hello\" -verbose }').Invoke()\r\n$ps.Streams\r\n\r\nError       : {}\r\nProgress    : {}\r\nVerbose     : {}\r\nDebug       : {}\r\nWarning     : {}\r\nInformation : {}\r\n```\r\n\r\nIt looks like Invoke-Command is not writing to the verbose, debug streams.  But it is strange that informational data stream works.\r\nMy guess is that Invoke-Command debug verbose/data is going through client remote host method and bypassing the data stream handling.  There was an issue about this years ago but I don't remember the details.",
    "created_at": "2021-03-05T23:57:51Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14843#issuecomment-791799102",
    "id": 791799102,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14843",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5MTc5OTEwMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/791799102/reactions"
    },
    "updated_at": "2021-03-05T23:58:55Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/791799102",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/14019529?v=4",
      "events_url": "https://api.github.com/users/PaulHigin/events{/privacy}",
      "followers_url": "https://api.github.com/users/PaulHigin/followers",
      "following_url": "https://api.github.com/users/PaulHigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulHigin/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/PaulHigin",
      "id": 14019529,
      "login": "PaulHigin",
      "node_id": "MDQ6VXNlcjE0MDE5NTI5",
      "organizations_url": "https://api.github.com/users/PaulHigin/orgs",
      "received_events_url": "https://api.github.com/users/PaulHigin/received_events",
      "repos_url": "https://api.github.com/users/PaulHigin/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/PaulHigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulHigin/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/PaulHigin"
    }
  },
  {
    "author_association": "NONE",
    "body": "I _think_ I'm seeing the same issue, where my Write-Warning calls seem to ignore ` -WarningAction Continue` when used in a Job in a `ForEach-Object -Parallel` loop - please can someone confirm? If not I'll raise a separate issue:\r\n\r\n```\r\n$InformationPreference = 'Continue'\r\nWrite-Information \"Script start. InformationPreference = $InformationPreference, WarningPreference = $WarningPreference, ErrorActionPreference = $ErrorActionPreference\"\r\n\r\nWrite-Information \"Starting test NOT in parallel loop...\"\r\n\r\n$notInParallelLoopJobScriptBlock = [scriptblock]::Create(\r\n    {\r\n        param($tenant) \r\n        Write-Information \"Started job for $tenant. InformationPreference = $InformationPreference, WarningPreference = $WarningPreference, ErrorActionPreference = $ErrorActionPreference\"\r\n        Start-Sleep -Seconds (Get-Random -Minimum 1 -Maximum 5)\r\n        \r\n        Write-Warning \"Warning here! $tenant\"\r\n        Write-Warning \"Warning here forcing warningAction to continue! $tenant\" -WarningAction Continue\r\n        Write-Information \"Finished job for $tenant\" \r\n    })\r\n\r\n$notInParallelLoopJob = Start-Job $notInParallelLoopJobScriptBlock -ArgumentList 'a'\r\n\r\nWait-Job $notInParallelLoopJob\r\nReceive-Job $notInParallelLoopJob\r\n\r\nWrite-Information \"Finished test NOT in parallel loop.\"\r\nWrite-Information \"Starting test IN parallel loop...\"\r\n\r\n$tenants = 'b'\r\n\r\n$tenants | ForEach-Object -Parallel {\r\n    Write-Information \"Updating $_\"\r\n\r\n    $inParallelLoopJobScriptBlock = [scriptblock]::Create(\r\n        {\r\n            param($tenant) \r\n            Write-Information \"Started job for $tenant. InformationPreference = $InformationPreference, WarningPreference = $WarningPreference, ErrorActionPreference = $ErrorActionPreference\"\r\n            Start-Sleep -Seconds (Get-Random -Minimum 1 -Maximum 5)\r\n            \r\n            Write-Warning \"Warning here! $tenant\"\r\n            Write-Warning \"Warning here! $tenant\" -WarningAction Continue\r\n            Write-Information \"Finished job for $tenant\" \r\n        })\r\n\r\n    $inParallelLoopJob = Start-Job $inParallelLoopJobScriptBlock -ArgumentList $_\r\n    \r\n    Wait-Job $inParallelLoopJob\r\n    Receive-Job $inParallelLoopJob\r\n    \r\n    Write-Information \"Finished $_\"\r\n}\r\n\r\nWrite-Information \"Finished test IN parallel loop.\"\r\nWrite-Information 'Script end'\r\n```\r\n\r\nResults in:\r\n```\r\nScript start. InformationPreference = Continue, WarningPreference = Continue, ErrorActionPreference = Stop\r\nStarting test NOT in parallel loop...\r\n\r\nId     Name            PSJobTypeName   State         HasMoreData     Location             Command\r\n--     ----            -------------   -----         -----------     --------             -------\r\n238    Job238          BackgroundJob   Completed     True            localhost            …\r\nStarted job for a. InformationPreference = SilentlyContinue, WarningPreference = Continue, ErrorActionPreference = Continue\r\nWARNING: Warning here! a\r\nWARNING: Warning here forcing warningAction to continue! a\r\nFinished job for a\r\nFinished test NOT in parallel loop.\r\nStarting test IN parallel loop...\r\nUpdating b\r\n240    Job240          BackgroundJob   Completed     False           localhost            …\r\nStarted job for b. InformationPreference = SilentlyContinue, WarningPreference = Continue, ErrorActionPreference = Continue\r\nFinished job for b\r\nFinished b\r\nFinished test IN parallel loop.\r\nScript end\r\n```\r\n",
    "created_at": "2021-04-03T06:46:28Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14843#issuecomment-812822740",
    "id": 812822740,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14843",
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxMjgyMjc0MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/812822740/reactions"
    },
    "updated_at": "2021-04-03T06:46:28Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/812822740",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/1651763?v=4",
      "events_url": "https://api.github.com/users/PeteBoyRocket/events{/privacy}",
      "followers_url": "https://api.github.com/users/PeteBoyRocket/followers",
      "following_url": "https://api.github.com/users/PeteBoyRocket/following{/other_user}",
      "gists_url": "https://api.github.com/users/PeteBoyRocket/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/PeteBoyRocket",
      "id": 1651763,
      "login": "PeteBoyRocket",
      "node_id": "MDQ6VXNlcjE2NTE3NjM=",
      "organizations_url": "https://api.github.com/users/PeteBoyRocket/orgs",
      "received_events_url": "https://api.github.com/users/PeteBoyRocket/received_events",
      "repos_url": "https://api.github.com/users/PeteBoyRocket/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/PeteBoyRocket/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PeteBoyRocket/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/PeteBoyRocket"
    }
  }
]

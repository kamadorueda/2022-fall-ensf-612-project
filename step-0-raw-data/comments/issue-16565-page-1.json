[
  {
    "author_association": "NONE",
    "body": "![16565](https://user-images.githubusercontent.com/65390418/145017594-e29e7227-1ac7-4ce4-b5d8-14a3eb2a5b75.jpg)\r\n",
    "created_at": "2021-12-07T11:02:28Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16565#issuecomment-987817043",
    "id": 987817043,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16565",
    "node_id": "IC_kwDOAvT7bc464ORT",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/987817043/reactions"
    },
    "updated_at": "2021-12-07T11:02:28Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/987817043",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/65390418?v=4",
      "events_url": "https://api.github.com/users/kasini3000/events{/privacy}",
      "followers_url": "https://api.github.com/users/kasini3000/followers",
      "following_url": "https://api.github.com/users/kasini3000/following{/other_user}",
      "gists_url": "https://api.github.com/users/kasini3000/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/kasini3000",
      "id": 65390418,
      "login": "kasini3000",
      "node_id": "MDQ6VXNlcjY1MzkwNDE4",
      "organizations_url": "https://api.github.com/users/kasini3000/orgs",
      "received_events_url": "https://api.github.com/users/kasini3000/received_events",
      "repos_url": "https://api.github.com/users/kasini3000/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/kasini3000/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kasini3000/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/kasini3000"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "I cannot replicate this normally, I'm able to copy a file to the exact same path on the remote PSSession so I think your error is due to another problem.\r\n\r\nJudging by the error message it seems like the failure is when calling `AlternateDataStreamUtilities.GetStreams(String path)`. The fact that the error is `ERROR_INVALID_PARAMETER` seems to indicate either your `D:` drive on the local does not support alternate data streams. For example if the partition is formatted with something other than NTFS then alternate data streams would not be supported. This could explain why it works when you target a different drive on the local side it is fine.\r\n\r\nAs a side note, you are best testing this with PowerShell 7.2 and not Windows PowerShell. The problem could have been fixed already.",
    "created_at": "2021-12-07T19:43:47Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16565#issuecomment-988215377",
    "id": 988215377,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16565",
    "node_id": "IC_kwDOAvT7bc465vhR",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/988215377/reactions"
    },
    "updated_at": "2021-12-07T19:44:59Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/988215377",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8462645?v=4",
      "events_url": "https://api.github.com/users/jborean93/events{/privacy}",
      "followers_url": "https://api.github.com/users/jborean93/followers",
      "following_url": "https://api.github.com/users/jborean93/following{/other_user}",
      "gists_url": "https://api.github.com/users/jborean93/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jborean93",
      "id": 8462645,
      "login": "jborean93",
      "node_id": "MDQ6VXNlcjg0NjI2NDU=",
      "organizations_url": "https://api.github.com/users/jborean93/orgs",
      "received_events_url": "https://api.github.com/users/jborean93/received_events",
      "repos_url": "https://api.github.com/users/jborean93/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jborean93/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jborean93/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jborean93"
    }
  },
  {
    "author_association": "NONE",
    "body": "![16565_2](https://user-images.githubusercontent.com/65390418/145151001-4d5b7b13-f9ce-4835-a56e-e44b0ca48c4b.png)\r\nsource=win10+ps7.2\r\ntarget=new win11 vm\r\ndrive d on win11 vm =ntfs format",
    "created_at": "2021-12-08T05:01:58Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16565#issuecomment-988500913",
    "id": 988500913,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16565",
    "node_id": "IC_kwDOAvT7bc4661Ox",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/988500913/reactions"
    },
    "updated_at": "2021-12-08T05:01:58Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/988500913",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/65390418?v=4",
      "events_url": "https://api.github.com/users/kasini3000/events{/privacy}",
      "followers_url": "https://api.github.com/users/kasini3000/followers",
      "following_url": "https://api.github.com/users/kasini3000/following{/other_user}",
      "gists_url": "https://api.github.com/users/kasini3000/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/kasini3000",
      "id": 65390418,
      "login": "kasini3000",
      "node_id": "MDQ6VXNlcjY1MzkwNDE4",
      "organizations_url": "https://api.github.com/users/kasini3000/orgs",
      "received_events_url": "https://api.github.com/users/kasini3000/received_events",
      "repos_url": "https://api.github.com/users/kasini3000/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/kasini3000/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kasini3000/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/kasini3000"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "> HResult         : -2147467259\r\n\r\nIt is \"file being opened or locked\"",
    "created_at": "2021-12-08T17:44:30Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16565#issuecomment-989032821",
    "id": 989032821,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16565",
    "node_id": "IC_kwDOAvT7bc4683F1",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/989032821/reactions"
    },
    "updated_at": "2021-12-09T11:59:59Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/989032821",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@iSazonov the key one in particular is `NativeErrorCode: 87` which refers to [ERROR_INVALID_PARAMETER 0x00000057](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-erref/18d8fbe8-a967-4f1c-ae50-99ca8e491d2d). The actual function in question here that is raising the `Win32Exception` is this https://github.com/PowerShell/PowerShell/blob/7dc4587014bfa22919c933607bf564f0ba53db2e/src/System.Management.Automation/namespaces/FileSystemProvider.cs#L8568-L8628\r\n\r\nEssentially either [FindFirstStream](https://docs.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-findfirststreamw) or [FindNextStream](https://docs.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-findnextstreamw) is the function that's failing and the only explicit mention about this is `FindFirstStream` where it states\r\n\r\n> If the filesystem does not support streams, the function fails and GetLastError returns ERROR_INVALID_PARAMETER (87).\r\n\r\n@kasini3000 you said that drive D on the Win 11 (what you said is the target) is NTFS but in reality the error is PowerShell trying to get the streams of drive `D:` on your source (Win 10). Can you verify that is also NTFS or some other file system format. Can you try running\r\n\r\n```powershell\r\nGet-Item -Path D:\\h.txt -Stream *\r\n```",
    "created_at": "2021-12-08T19:18:12Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16565#issuecomment-989122413",
    "id": 989122413,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16565",
    "node_id": "IC_kwDOAvT7bc469M9t",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/989122413/reactions"
    },
    "updated_at": "2021-12-08T19:18:12Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/989122413",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8462645?v=4",
      "events_url": "https://api.github.com/users/jborean93/events{/privacy}",
      "followers_url": "https://api.github.com/users/jborean93/followers",
      "following_url": "https://api.github.com/users/jborean93/following{/other_user}",
      "gists_url": "https://api.github.com/users/jborean93/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jborean93",
      "id": 8462645,
      "login": "jborean93",
      "node_id": "MDQ6VXNlcjg0NjI2NDU=",
      "organizations_url": "https://api.github.com/users/jborean93/orgs",
      "received_events_url": "https://api.github.com/users/jborean93/received_events",
      "repos_url": "https://api.github.com/users/jborean93/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jborean93/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jborean93/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jborean93"
    }
  },
  {
    "author_association": "NONE",
    "body": "@jborean93  oh,my drive \"d\" is fat32 partition, looks like you're close to the truth\r\nIn fact, I don't know whether the problem at the source or the target.\r\nnobody open file ,no lock\r\n\r\n```\r\nPS C:\\ProgramData\\kasini3000> Get-Item -Path D:\\h.txt -Stream *\r\nGet-Item: 参数错误。\r\n```",
    "created_at": "2021-12-09T09:30:57Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16565#issuecomment-989669596",
    "id": 989669596,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16565",
    "node_id": "IC_kwDOAvT7bc46_Sjc",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/989669596/reactions"
    },
    "updated_at": "2021-12-09T09:40:18Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/989669596",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/65390418?v=4",
      "events_url": "https://api.github.com/users/kasini3000/events{/privacy}",
      "followers_url": "https://api.github.com/users/kasini3000/followers",
      "following_url": "https://api.github.com/users/kasini3000/following{/other_user}",
      "gists_url": "https://api.github.com/users/kasini3000/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/kasini3000",
      "id": 65390418,
      "login": "kasini3000",
      "node_id": "MDQ6VXNlcjY1MzkwNDE4",
      "organizations_url": "https://api.github.com/users/kasini3000/orgs",
      "received_events_url": "https://api.github.com/users/kasini3000/received_events",
      "repos_url": "https://api.github.com/users/kasini3000/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/kasini3000/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kasini3000/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/kasini3000"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Thanks for confirming it’s definitely the source. Are you able to update the title of the ticket to reflect that Copy-Item -ToSession doesn’t work for a source on Windows that isn’t on NTFS?",
    "created_at": "2021-12-09T09:41:51Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16565#issuecomment-989677668",
    "id": 989677668,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16565",
    "node_id": "IC_kwDOAvT7bc46_Uhk",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/989677668/reactions"
    },
    "updated_at": "2021-12-09T09:41:51Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/989677668",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8462645?v=4",
      "events_url": "https://api.github.com/users/jborean93/events{/privacy}",
      "followers_url": "https://api.github.com/users/jborean93/followers",
      "following_url": "https://api.github.com/users/jborean93/following{/other_user}",
      "gists_url": "https://api.github.com/users/jborean93/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jborean93",
      "id": 8462645,
      "login": "jborean93",
      "node_id": "MDQ6VXNlcjg0NjI2NDU=",
      "organizations_url": "https://api.github.com/users/jborean93/orgs",
      "received_events_url": "https://api.github.com/users/jborean93/received_events",
      "repos_url": "https://api.github.com/users/jborean93/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jborean93/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jborean93/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jborean93"
    }
  }
]

[
  {
    "author_association": "COLLABORATOR",
    "body": "/cc @DHowett @daxian-dbw for information.",
    "created_at": "2021-11-25T18:16:27Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16518#issuecomment-979409936",
    "id": 979409936,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16518",
    "node_id": "IC_kwDOAvT7bc46YJwQ",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/979409936/reactions"
    },
    "updated_at": "2021-11-25T18:16:27Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/979409936",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@stej Can you please share the specific script/command you ran that triggered this crash?\r\nThe event and the call stacks suggest the exception was thrown from the .NET runtime.\r\n\r\nIf you are able to consistently reproduce the issue, can you please collect a crash dump by following the instructions from https://docs.microsoft.com/en-us/dotnet/core/diagnostics/dumps#collect-dumps-on-crash?\r\nPlease use `MiniDumpWithFullMemory` as the dump type, by setting `DOTNET_DbgMiniDumpType` to `4`.\n\n<blockquote><img src=\"https://docs.microsoft.com/dotnet/media/dotnet-logo.png\" width=\"48\" align=\"right\"><div><strong><a href=\"https://docs.microsoft.com/en-us/dotnet/core/diagnostics/dumps\">Dumps - .NET</a></strong></div><div>An introduction to dumps in .NET.</div></blockquote>",
    "created_at": "2021-12-01T02:23:00Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16518#issuecomment-983222546",
    "id": 983222546,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16518",
    "node_id": "IC_kwDOAvT7bc46mskS",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/983222546/reactions"
    },
    "updated_at": "2021-12-01T02:23:02Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/983222546",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "NONE",
    "body": "Sure, I'll try. Meanwhile the command line looks like this:\r\n\r\n```\r\ncls; $f='c:\\temp\\values.csv';$pre=[float](Import-Csv $f)[-1].Total; C:\\util-setdateToCurrent.ps1 ; C:\\temp\\runDownloadsAndAnalysis.bat; $post=[float](Import-Csv $f)[-1].Total; $diff=\"Difference: $([int]($post-$pre))`$\"; if ($diff -match ' -') { Show-Warning $diff } else { Show-Info $diff }\r\n```\r\n(one line). \r\nWhere \r\n- `util-setdateToCurrent.ps1` calls Set-Date with some time\r\n- `runDownloadsAndAnalysis.bat` - calling pwsh (creates new process), so I don't think it's causing the problem\r\n- `Show-Warning` and `Show-Info` - this is my bet.\r\n\r\nThe body:\r\n```\r\nfunction Show-WpfMessage($title, $str, $headingBackColor, $messageBackColor, $messageColor, $height, $width)\r\n{\r\n  Add-Type -Assembly PresentationFramework\r\n  Add-Type -Assembly PresentationCore\r\n  $xaml = @\"\r\n<Window xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\r\n  Title=\"$title\" Height=\"$height\" Width=\"$width\"\r\n  Opacity=\"10\" OpacityMask=\"Green\" \r\n  Topmost=\"True\" WindowStyle=\"None\" AllowsTransparency=\"True\" Background=\"Transparent\" Padding=\"20\" Top=\"10\" Left=\"10\">\r\n  <DockPanel>\r\n    <Border DockPanel.Dock=\"Top\" CornerRadius=\"10\" BorderThickness=\"2\" BorderBrush=\"Black\" Background=\"$headingBackColor\"\r\n      Padding=\"8\" Margin=\"10\">\r\n      <TextBlock FontSize=\"52\" TextWrapping=\"Wrap\" Margin=\"20\" HorizontalAlignment=\"Center\">$title</TextBlock>\r\n    </Border>\r\n    <Border DockPanel.Dock=\"Bottom\" CornerRadius=\"10\" BorderThickness=\"1\" BorderBrush=\"Black\"\r\n      Padding=\"8\" Margin=\"10\" Background=\"$messageBackColor\">\r\n      <TextBlock Foreground=\"$messageColor\" FontSize=\"42\" Padding=\"60\" TextWrapping=\"Wrap\" HorizontalAlignment=\"Center\">$str</TextBlock>\r\n    </Border>\r\n  </DockPanel>\r\n</Window>\r\n\"@\r\n\r\n  $global:window = [Windows.Markup.XamlReader]::Load((New-Object System.Xml.XmlNodeReader ([Xml]$xaml ) ) )\r\n  $window.Add_MouseLeftButtonDown(  { $_.Handled = $true; $window.DragMove() } )\r\n  $window.Add_MouseRightButtonDown( { $_.Handled = $true; $window.Close()   } )\r\n  $window.ShowDialog()\r\n}\r\n\r\nfunction Show-Info($str) {\r\n  Show-WpfMessage \"Information\" $str -headingBackColor LightBlue -messageBackColor White -messageColor Black 400 800\r\n}\r\nfunction Show-Warning($str) {\r\n  Show-WpfMessage \"Warning\" $str -headingBackColor Yellow -messageBackColor Red -messageColor Black 600 1200\r\n}\r\n\r\n```",
    "created_at": "2021-12-03T13:10:58Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16518#issuecomment-985507054",
    "id": 985507054,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16518",
    "node_id": "IC_kwDOAvT7bc46vaTu",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/985507054/reactions"
    },
    "updated_at": "2021-12-03T13:10:58Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/985507054",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/253560?v=4",
      "events_url": "https://api.github.com/users/stej/events{/privacy}",
      "followers_url": "https://api.github.com/users/stej/followers",
      "following_url": "https://api.github.com/users/stej/following{/other_user}",
      "gists_url": "https://api.github.com/users/stej/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/stej",
      "id": 253560,
      "login": "stej",
      "node_id": "MDQ6VXNlcjI1MzU2MA==",
      "organizations_url": "https://api.github.com/users/stej/orgs",
      "received_events_url": "https://api.github.com/users/stej/received_events",
      "repos_url": "https://api.github.com/users/stej/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/stej/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stej/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/stej"
    }
  },
  {
    "author_association": "NONE",
    "body": "This issue has been marked as \"Waiting on Author\" and has not had any activity for **7 day**. It has been closed for housekeeping purposes.",
    "created_at": "2022-01-15T04:00:42Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16518#issuecomment-1013604621",
    "id": 1013604621,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16518",
    "node_id": "IC_kwDOAvT7bc48amEN",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1013604621/reactions"
    },
    "updated_at": "2022-01-15T04:00:42Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1013604621",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  }
]

[
  {
    "author_association": "COLLABORATOR",
    "body": "@rmbolger Thanks for your investigations!\r\n\r\nPowerShell does directly nothing with SSL - it utilize .Net. HttpClient class. Please open issue in .Net Runtime repository. (If you could make simple C# demo app it helped them.)\r\n\r\nNotice, PowerShell 7.0 is on .Net 3.1, PowerShell 7.1 is on .Net 5.0.",
    "created_at": "2020-11-25T03:45:25Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14253#issuecomment-733444525",
    "id": 733444525,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14253",
    "node_id": "MDEyOklzc3VlQ29tbWVudDczMzQ0NDUyNQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/733444525/reactions"
    },
    "updated_at": "2020-11-25T03:45:25Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/733444525",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "This issue has been marked as external and has not had any activity for **1 day**. It has been be closed for housekeeping purposes.",
    "created_at": "2020-11-26T04:00:03Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14253#issuecomment-734059852",
    "id": 734059852,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14253",
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNDA1OTg1Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/734059852/reactions"
    },
    "updated_at": "2020-11-26T04:00:03Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/734059852",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  },
  {
    "author_association": "NONE",
    "body": "Just to follow up here so answers are easier to find. Here's are the details on what is needed to fix the issue.\r\n\r\nThe crux of the issue deals with a change in the default behavior for TLS in .NET 5.0 that is described in this doc.\r\nhttps://docs.microsoft.com/en-us/dotnet/core/compatibility/cryptography/5.0/default-cipher-suites-for-tls-on-linux\r\n\r\nIn summary, .NET 5.0 will respect `CipherString` settings (among others) in the OS's `/etc/ssl/openssl.cnf` file. But if the settings aren't specified (which is the default in Ubuntu 18.04), .NET 5.0 defaults to a very restrictive/secure/modern default set of ciphers whereas .NET 3.1 defaults to a very loose/compatible set of ciphers. So if you are connecting to services that aren't capable of modern ciphers, you need to configure the OS's config to allow one or more of the ciphers your service *does* support. The other option is a code level change in your app that deals with `CipherSuitePolicy` and `SslStream` objects. But since my issue is with PowerShell, I don't have control of the code. So my only option is the OS config change.\r\n\r\nIn my particular case, I decided to use the [Mozilla SSL Configuration Generator](https://ssl-config.mozilla.org/) on the \"Intermediate\" configuration setting as a guide for what ciphers to allow while remaining compatible, but still as secure as possible. And I added the following to my `/etc/ssl/openssl.cnf` file right before the `[ new_oids ]` section.\r\n\r\n```none\r\nopenssl_conf = default_conf\r\n\r\n[default_conf]\r\nssl_conf = ssl_sect\r\n\r\n[ssl_sect]\r\nsystem_default = system_default_sect\r\n\r\n[system_default_sect]\r\nCipherString = ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384\r\n```\r\n\r\nThe last two in the list match ciphers that are available from the Infoblox appliance. When re-testing both my .NET sample app and PowerShell's web cmdlets, neither throw an error anymore.\n\n<blockquote><img src=\"https://docs.microsoft.com/en-us/media/logos/logo-ms-social.png\" width=\"48\" align=\"right\"><div><strong><a href=\"https://docs.microsoft.com/en-us/dotnet/core/compatibility/cryptography/5.0/default-cipher-suites-for-tls-on-linux\">Breaking change: Default TLS cipher suites for .NET on Linux - .NET Core</a></strong></div><div>Learn about the breaking change in .NET 5.0 where .NET, on Linux, now respects the OpenSSL configuration for default cipher suites when doing TLS/SSL.</div></blockquote>",
    "created_at": "2020-11-26T05:57:41Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14253#issuecomment-734091716",
    "id": 734091716,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14253",
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNDA5MTcxNg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 6,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 6,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/734091716/reactions"
    },
    "updated_at": "2020-11-26T05:57:43Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/734091716",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/2327255?v=4",
      "events_url": "https://api.github.com/users/rmbolger/events{/privacy}",
      "followers_url": "https://api.github.com/users/rmbolger/followers",
      "following_url": "https://api.github.com/users/rmbolger/following{/other_user}",
      "gists_url": "https://api.github.com/users/rmbolger/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rmbolger",
      "id": 2327255,
      "login": "rmbolger",
      "node_id": "MDQ6VXNlcjIzMjcyNTU=",
      "organizations_url": "https://api.github.com/users/rmbolger/orgs",
      "received_events_url": "https://api.github.com/users/rmbolger/received_events",
      "repos_url": "https://api.github.com/users/rmbolger/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rmbolger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rmbolger/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rmbolger"
    }
  }
]

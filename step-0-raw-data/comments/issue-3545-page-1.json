[
  {
    "author_association": "COLLABORATOR",
    "body": "It seems we have two problems.\r\n\r\n>Error resolving full path []\r\n>The shell cannot be started. A failure occurred during initialization:\r\nASSERT: caller makes sure it's not null or empty\r\n\r\nThe first, I fixed by restore \"ProgramFiles\" and \"ProgramFiles(X86)\"environment variables for subprocess.\r\nI don't understand how PowerShell use it in start time and perhaps my fix is not in right place.\r\n\r\nThe second problem is that new PowerShell process get wrong cursor position in the same console windows. I belive we should open new trackig Issue.",
    "created_at": "2017-04-17T14:29:20Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3545#issuecomment-294495976",
    "id": 294495976,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3545",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5NDQ5NTk3Ng==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/294495976/reactions"
    },
    "updated_at": "2017-04-17T14:29:20Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/294495976",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "What `-UseNewEnvironment` appears to be doing is to define _only_ the variables that are _explicitly_ defined, as displayed in System Properties (`sysdm.cpl`) (with user-level definitions taking precedence over system-level ones, as usual).\r\n\r\nHowever, **the _implicitly_ defined environment variables are missing**, among them the two @iSazonov mentions.\r\n\r\nAdditionally, `$env:USERNAME` contains `SYSTEM`, because it is explicitly defined as a system-level variable, but not at the user level (where it is normally implicitly defined to reflect the current user).\r\n\r\nList of missing, normally implicitly defined environment variables (I don't know what mechanism defines them by default):\r\n\r\n```none\r\nALLUSERSPROFILE\r\nAPPDATA\r\nCommonProgramFiles\r\nCommonProgramFiles(x86)\r\nCommonProgramW6432\r\nCOMPUTERNAME\r\nHOMEDRIVE\r\nHOMEPATH\r\nLOCALAPPDATA\r\nLOGONSERVER\r\nProgramData\r\nProgramFiles\r\nProgramFiles(x86)\r\nProgramW6432\r\nPUBLIC\r\nSESSIONNAME\r\nSystemDrive\r\nSystemRoot\r\nUSERDOMAIN\r\nUSERDOMAIN_ROAMINGPROFILE\r\nUSERPROFILE\r\n```\r\n\r\n@iSazonov:\r\n\r\n> The second problem is that new PowerShell process get wrong cursor position in the same console windows. I belive we should open new trackig Issue.\r\n\r\nI think that's an artifact of using `-NoNewWindow` without `-Wait`, which makes the output appear asynchronously.\r\n\r\n(Normally, if you wanted to run a console app synchronously in the _same_ window you wouldn't use `Start-Process` at all; my guess is that @0xfeeddeadbeef only included `-NoNewWindow` so that the error message would show; without it, you'd just see a new window opening and closing right away.)",
    "created_at": "2017-08-07T15:41:01Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3545#issuecomment-320699488",
    "id": 320699488,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3545",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyMDY5OTQ4OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/320699488/reactions"
    },
    "updated_at": "2017-08-07T15:41:01Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/320699488",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "NONE",
    "body": "On Windows, you should use `CreateEnvironmentBlock` function to create a complete block of environment variables for a specified user.",
    "created_at": "2018-06-18T16:00:37Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3545#issuecomment-398105462",
    "id": 398105462,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3545",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5ODEwNTQ2Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 1,
      "laugh": 1,
      "rocket": 1,
      "total_count": 4,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/398105462/reactions"
    },
    "updated_at": "2018-06-18T16:00:37Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/398105462",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/4462444?v=4",
      "events_url": "https://api.github.com/users/GeeLaw/events{/privacy}",
      "followers_url": "https://api.github.com/users/GeeLaw/followers",
      "following_url": "https://api.github.com/users/GeeLaw/following{/other_user}",
      "gists_url": "https://api.github.com/users/GeeLaw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/GeeLaw",
      "id": 4462444,
      "login": "GeeLaw",
      "node_id": "MDQ6VXNlcjQ0NjI0NDQ=",
      "organizations_url": "https://api.github.com/users/GeeLaw/orgs",
      "received_events_url": "https://api.github.com/users/GeeLaw/received_events",
      "repos_url": "https://api.github.com/users/GeeLaw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/GeeLaw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/GeeLaw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/GeeLaw"
    }
  },
  {
    "author_association": "NONE",
    "body": ":tada:This issue was addressed in #10830, which has now been successfully released as `v7.1.0-preview.2`.:tada:\n\nHandy links:\n* [Release Notes](https://github.com/PowerShell/PowerShell/releases/tag/v7.1.0-preview.2)\n",
    "created_at": "2020-04-23T18:03:56Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3545#issuecomment-618556617",
    "id": 618556617,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3545",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxODU1NjYxNw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/618556617/reactions"
    },
    "updated_at": "2020-04-23T18:03:56Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/618556617",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  }
]

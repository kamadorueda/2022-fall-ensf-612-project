[
  {
    "author_association": "COLLABORATOR",
    "body": "It works well without `$ErrorActionPreference = 'Stop'`.\r\n\r\n/cc @PaulHigin ",
    "created_at": "2021-01-12T16:37:42Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14602#issuecomment-758780621",
    "id": 758780621,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14602",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1ODc4MDYyMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/758780621/reactions"
    },
    "updated_at": "2021-01-12T16:37:42Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/758780621",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "> It works well without `$ErrorActionPreference = 'Stop'`.\r\n\r\nActually it doesn't. `Stop` only causes execution to continue, but it still creates error records (note the red output). If you remove `-Parallel`, no error records are created, as expected.",
    "created_at": "2021-01-12T17:10:47Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14602#issuecomment-758805473",
    "id": 758805473,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14602",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1ODgwNTQ3Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/758805473/reactions"
    },
    "updated_at": "2021-01-12T17:10:47Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/758805473",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/496737?v=4",
      "events_url": "https://api.github.com/users/aelij/events{/privacy}",
      "followers_url": "https://api.github.com/users/aelij/followers",
      "following_url": "https://api.github.com/users/aelij/following{/other_user}",
      "gists_url": "https://api.github.com/users/aelij/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/aelij",
      "id": 496737,
      "login": "aelij",
      "node_id": "MDQ6VXNlcjQ5NjczNw==",
      "organizations_url": "https://api.github.com/users/aelij/orgs",
      "received_events_url": "https://api.github.com/users/aelij/received_events",
      "repos_url": "https://api.github.com/users/aelij/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/aelij/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aelij/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/aelij"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "This is a known issue.  Current session state is not propagated to parallel running sessions.  This is currently by design, but there is a work item to address this to some degree.\r\n\r\nhttps://github.com/PowerShell/PowerShell/issues/12240",
    "created_at": "2021-01-12T17:13:21Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14602#issuecomment-758807033",
    "id": 758807033,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14602",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1ODgwNzAzMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/758807033/reactions"
    },
    "updated_at": "2021-01-12T17:13:21Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/758807033",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/14019529?v=4",
      "events_url": "https://api.github.com/users/PaulHigin/events{/privacy}",
      "followers_url": "https://api.github.com/users/PaulHigin/followers",
      "following_url": "https://api.github.com/users/PaulHigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulHigin/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/PaulHigin",
      "id": 14019529,
      "login": "PaulHigin",
      "node_id": "MDQ6VXNlcjE0MDE5NTI5",
      "organizations_url": "https://api.github.com/users/PaulHigin/orgs",
      "received_events_url": "https://api.github.com/users/PaulHigin/received_events",
      "repos_url": "https://api.github.com/users/PaulHigin/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/PaulHigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulHigin/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/PaulHigin"
    }
  },
  {
    "author_association": "NONE",
    "body": "@PaulHigin How are experimental features flags related to a session? They are defined in `powershell.config.json`. Shouldn't every session load it independently?",
    "created_at": "2021-01-12T17:16:12Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14602#issuecomment-758808844",
    "id": 758808844,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14602",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1ODgwODg0NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/758808844/reactions"
    },
    "updated_at": "2021-01-12T17:16:12Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/758808844",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/496737?v=4",
      "events_url": "https://api.github.com/users/aelij/events{/privacy}",
      "followers_url": "https://api.github.com/users/aelij/followers",
      "following_url": "https://api.github.com/users/aelij/following{/other_user}",
      "gists_url": "https://api.github.com/users/aelij/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/aelij",
      "id": 496737,
      "login": "aelij",
      "node_id": "MDQ6VXNlcjQ5NjczNw==",
      "organizations_url": "https://api.github.com/users/aelij/orgs",
      "received_events_url": "https://api.github.com/users/aelij/received_events",
      "repos_url": "https://api.github.com/users/aelij/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/aelij/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aelij/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/aelij"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Sorry, I misread the issue.  I thought this was about propagating the $ErrorActionPreference built-in variable, and it looks like that is being done.  I am not sure about experimental features, but it is likely a similar problem in that it needs to be set in the parallel running sessions.\r\n\r\n@aelij  Please add a comment to issue https://github.com/PowerShell/PowerShell/issues/12240, so that experimental feature enabling is also considered.  Then we can close this issue.",
    "created_at": "2021-01-12T17:26:37Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14602#issuecomment-758815158",
    "id": 758815158,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14602",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1ODgxNTE1OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/758815158/reactions"
    },
    "updated_at": "2021-01-12T17:26:37Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/758815158",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/14019529?v=4",
      "events_url": "https://api.github.com/users/PaulHigin/events{/privacy}",
      "followers_url": "https://api.github.com/users/PaulHigin/followers",
      "following_url": "https://api.github.com/users/PaulHigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulHigin/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/PaulHigin",
      "id": 14019529,
      "login": "PaulHigin",
      "node_id": "MDQ6VXNlcjE0MDE5NTI5",
      "organizations_url": "https://api.github.com/users/PaulHigin/orgs",
      "received_events_url": "https://api.github.com/users/PaulHigin/received_events",
      "repos_url": "https://api.github.com/users/PaulHigin/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/PaulHigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulHigin/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/PaulHigin"
    }
  },
  {
    "author_association": "NONE",
    "body": "I think this should be a different issue.\r\n\r\nThis is about reading the correct config inside `Parallel`, not shared variables/session. It's likely the fix will be different too.",
    "created_at": "2021-01-12T17:40:33Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14602#issuecomment-758823780",
    "id": 758823780,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14602",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1ODgyMzc4MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/758823780/reactions"
    },
    "updated_at": "2021-01-12T17:40:33Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/758823780",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/496737?v=4",
      "events_url": "https://api.github.com/users/aelij/events{/privacy}",
      "followers_url": "https://api.github.com/users/aelij/followers",
      "following_url": "https://api.github.com/users/aelij/following{/other_user}",
      "gists_url": "https://api.github.com/users/aelij/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/aelij",
      "id": 496737,
      "login": "aelij",
      "node_id": "MDQ6VXNlcjQ5NjczNw==",
      "organizations_url": "https://api.github.com/users/aelij/orgs",
      "received_events_url": "https://api.github.com/users/aelij/received_events",
      "repos_url": "https://api.github.com/users/aelij/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/aelij/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aelij/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/aelij"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "It is the same in how the sessions are set up before running in parallel.  There is no point in having multiple issues.  I'll add a note to that relevant issue and close this one.",
    "created_at": "2021-01-12T17:42:44Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14602#issuecomment-758825014",
    "id": 758825014,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14602",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1ODgyNTAxNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/758825014/reactions"
    },
    "updated_at": "2021-01-12T17:42:44Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/758825014",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/14019529?v=4",
      "events_url": "https://api.github.com/users/PaulHigin/events{/privacy}",
      "followers_url": "https://api.github.com/users/PaulHigin/followers",
      "following_url": "https://api.github.com/users/PaulHigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulHigin/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/PaulHigin",
      "id": 14019529,
      "login": "PaulHigin",
      "node_id": "MDQ6VXNlcjE0MDE5NTI5",
      "organizations_url": "https://api.github.com/users/PaulHigin/orgs",
      "received_events_url": "https://api.github.com/users/PaulHigin/received_events",
      "repos_url": "https://api.github.com/users/PaulHigin/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/PaulHigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulHigin/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/PaulHigin"
    }
  },
  {
    "author_association": "NONE",
    "body": "@PaulHigin I've investigated it a bit, and it doesn't seem that the issue is about experimental features at all:\r\n\r\n```powershell\r\n1 | ForEach-Object -Parallel { Get-ExperimentalFeature PSNotApplyErrorActionToStderr }\r\n```\r\n\r\nyields:\r\n```\r\nName                                Enabled Source                              Description\r\n----                                ------- ------                              -----------\r\nPSNotApplyErrorActionToStderr          True PSEngine                            Don't have $ErrorActionPreference affect stderr output\r\n```\r\n\r\nI think the problem is in `NativeCommandProcessor` and how it handles output from background processes. So it should work regardless of the suggested `-UseCurrentState`.\r\n\r\nThis code gets executed only in parallel:\r\n\r\nhttps://github.com/PowerShell/PowerShell/blob/4a09585fe72c3679e23a1aa047b23ac827609c55/src/System.Management.Automation/engine/NativeCommandProcessor.cs#L657-L673\r\n\r\nSo please reopen as it's definitely unrelated to the other issue.",
    "created_at": "2021-01-13T06:52:44Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14602#issuecomment-759246193",
    "id": 759246193,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14602",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1OTI0NjE5Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/759246193/reactions"
    },
    "updated_at": "2021-01-13T06:52:44Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/759246193",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/496737?v=4",
      "events_url": "https://api.github.com/users/aelij/events{/privacy}",
      "followers_url": "https://api.github.com/users/aelij/followers",
      "following_url": "https://api.github.com/users/aelij/following{/other_user}",
      "gists_url": "https://api.github.com/users/aelij/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/aelij",
      "id": 496737,
      "login": "aelij",
      "node_id": "MDQ6VXNlcjQ5NjczNw==",
      "organizations_url": "https://api.github.com/users/aelij/orgs",
      "received_events_url": "https://api.github.com/users/aelij/received_events",
      "repos_url": "https://api.github.com/users/aelij/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/aelij/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aelij/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/aelij"
    }
  },
  {
    "author_association": "NONE",
    "body": "This issue has been marked as duplicate and has not had any activity for **1 day**. It has been closed for housekeeping purposes.",
    "created_at": "2021-01-14T11:00:07Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14602#issuecomment-760122798",
    "id": 760122798,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14602",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2MDEyMjc5OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/760122798/reactions"
    },
    "updated_at": "2021-01-14T11:00:07Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/760122798",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  }
]

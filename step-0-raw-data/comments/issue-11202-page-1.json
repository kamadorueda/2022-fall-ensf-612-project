[
  {
    "author_association": "MEMBER",
    "body": "@anmenaga  can you take a look?",
    "created_at": "2019-11-26T20:53:49Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11202#issuecomment-558812809",
    "id": 558812809,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11202",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1ODgxMjgwOQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/558812809/reactions"
    },
    "updated_at": "2019-11-26T20:53:49Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/558812809",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Interesting... Importing `BestPractices` module in Windows PS actually breaks `Get-FormatData` cmdlet:\r\n![BestPractCapture](https://user-images.githubusercontent.com/11860095/69674860-3aea0780-1052-11ea-938d-350c6a944550.png)\r\nThis breaks `WinCompat` because `Get-FormatData` is used in implicit remoting call chain: `Import-Module -UseWindowsPowerShell -> [implicit PS remoting code] -> Export-PSSession -FormatTypeName \"*\" -Session $s -> [in session $s] Get-FormatData -TypeName '*'`\r\n\r\nAnother issue is that we are missing an error-reporting path in one case in implicit remoting code; this should be fixed independently.",
    "created_at": "2019-11-26T21:46:14Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11202#issuecomment-558830772",
    "id": 558830772,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11202",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1ODgzMDc3Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/558830772/reactions"
    },
    "updated_at": "2019-11-26T21:46:14Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/558830772",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11860095?v=4",
      "events_url": "https://api.github.com/users/anmenaga/events{/privacy}",
      "followers_url": "https://api.github.com/users/anmenaga/followers",
      "following_url": "https://api.github.com/users/anmenaga/following{/other_user}",
      "gists_url": "https://api.github.com/users/anmenaga/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/anmenaga",
      "id": 11860095,
      "login": "anmenaga",
      "node_id": "MDQ6VXNlcjExODYwMDk1",
      "organizations_url": "https://api.github.com/users/anmenaga/orgs",
      "received_events_url": "https://api.github.com/users/anmenaga/received_events",
      "repos_url": "https://api.github.com/users/anmenaga/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/anmenaga/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/anmenaga/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/anmenaga"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "I think the priority here is to fix it so that an error is reported to the user.",
    "created_at": "2019-11-26T22:31:45Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11202#issuecomment-558846038",
    "id": 558846038,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11202",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1ODg0NjAzOA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/558846038/reactions"
    },
    "updated_at": "2019-11-26T22:31:45Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/558846038",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "I'd LIKE the priority to be getting the module to work either natively or via the new compat logic.\r\n\r\nBut if that can't happen, then at least an error message back to the user.",
    "created_at": "2019-11-28T16:44:33Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11202#issuecomment-559557411",
    "id": 559557411,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11202",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTU1NzQxMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/559557411/reactions"
    },
    "updated_at": "2019-11-28T16:44:33Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/559557411",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/3630329?v=4",
      "events_url": "https://api.github.com/users/doctordns/events{/privacy}",
      "followers_url": "https://api.github.com/users/doctordns/followers",
      "following_url": "https://api.github.com/users/doctordns/following{/other_user}",
      "gists_url": "https://api.github.com/users/doctordns/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/doctordns",
      "id": 3630329,
      "login": "doctordns",
      "node_id": "MDQ6VXNlcjM2MzAzMjk=",
      "organizations_url": "https://api.github.com/users/doctordns/orgs",
      "received_events_url": "https://api.github.com/users/doctordns/received_events",
      "repos_url": "https://api.github.com/users/doctordns/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/doctordns/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/doctordns/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/doctordns"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "In RC1, there is a new and different error message. The best practices module still does not load fully:\r\n\r\n```powershell\r\nPS C:\\Foo> # Import the BestPracticesmodule\r\nPS C:\\Foo> Import-module BestPractices   # produces no error\r\nImport-Module: Failed to generate proxies for remote module 'BestPractices'. Running the Get-FormatData command in a remote session reported the following error: Unable to cast object of type 'Microsoft.PowerShell.Commands.Internal.Format.ControlReference' to type 'Microsoft.PowerShell.Commands.Internal.Format.ComplexControlBody'..\r\n```",
    "created_at": "2020-01-11T20:34:16Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11202#issuecomment-573352135",
    "id": 573352135,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11202",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MzM1MjEzNQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/573352135/reactions"
    },
    "updated_at": "2020-01-11T20:34:16Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/573352135",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/3630329?v=4",
      "events_url": "https://api.github.com/users/doctordns/events{/privacy}",
      "followers_url": "https://api.github.com/users/doctordns/followers",
      "following_url": "https://api.github.com/users/doctordns/following{/other_user}",
      "gists_url": "https://api.github.com/users/doctordns/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/doctordns",
      "id": 3630329,
      "login": "doctordns",
      "node_id": "MDQ6VXNlcjM2MzAzMjk=",
      "organizations_url": "https://api.github.com/users/doctordns/orgs",
      "received_events_url": "https://api.github.com/users/doctordns/received_events",
      "repos_url": "https://api.github.com/users/doctordns/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/doctordns/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/doctordns/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/doctordns"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Basically the remaining issue here is that implicit PS Remoting code is doing a blanket `Export-PSSession -FormatTypeName \"*\"`. It needs to collect data only for types needed by the remote module; this is not trivial; needs some prototyping.",
    "created_at": "2020-01-30T01:26:03Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11202#issuecomment-580041940",
    "id": 580041940,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11202",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4MDA0MTk0MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/580041940/reactions"
    },
    "updated_at": "2020-01-30T01:26:03Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/580041940",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11860095?v=4",
      "events_url": "https://api.github.com/users/anmenaga/events{/privacy}",
      "followers_url": "https://api.github.com/users/anmenaga/followers",
      "following_url": "https://api.github.com/users/anmenaga/following{/other_user}",
      "gists_url": "https://api.github.com/users/anmenaga/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/anmenaga",
      "id": 11860095,
      "login": "anmenaga",
      "node_id": "MDQ6VXNlcjExODYwMDk1",
      "organizations_url": "https://api.github.com/users/anmenaga/orgs",
      "received_events_url": "https://api.github.com/users/anmenaga/received_events",
      "repos_url": "https://api.github.com/users/anmenaga/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/anmenaga/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/anmenaga/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/anmenaga"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "An important side effect - importing `BestPractices` module through WinCompat, makes it impossible to load any other module into that WinCompat session.\r\n```\r\nPS E:\\> ipmo BestPractices\r\nImport-Module: Failed to generate proxies for remote module 'BestPractices'. Running the Get-FormatData command in a remote session reported the following error: Unable to cast object of type 'Microsoft.PowerShell.Commands.Internal.Format.ControlReference' to type 'Microsoft.PowerShell.Commands.Internal.Format.ComplexControlBody'..\r\nPS E:\\> ipmo ServerManager\r\nImport-Module: Failed to generate proxies for remote module 'ServerManager'. Running the Get-FormatData command in a remote session reported the following error: Unable to cast object of type 'Microsoft.PowerShell.Commands.Internal.Format.ControlReference' to type 'Microsoft.PowerShell.Commands.Internal.Format.ComplexControlBody'..\r\nPS E:\\>\r\n```\r\n",
    "created_at": "2020-01-30T21:03:13Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11202#issuecomment-580458629",
    "id": 580458629,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11202",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4MDQ1ODYyOQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 1,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/580458629/reactions"
    },
    "updated_at": "2020-01-30T21:03:13Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/580458629",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11860095?v=4",
      "events_url": "https://api.github.com/users/anmenaga/events{/privacy}",
      "followers_url": "https://api.github.com/users/anmenaga/followers",
      "following_url": "https://api.github.com/users/anmenaga/following{/other_user}",
      "gists_url": "https://api.github.com/users/anmenaga/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/anmenaga",
      "id": 11860095,
      "login": "anmenaga",
      "node_id": "MDQ6VXNlcjExODYwMDk1",
      "organizations_url": "https://api.github.com/users/anmenaga/orgs",
      "received_events_url": "https://api.github.com/users/anmenaga/received_events",
      "repos_url": "https://api.github.com/users/anmenaga/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/anmenaga/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/anmenaga/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/anmenaga"
    }
  },
  {
    "author_association": "NONE",
    "body": "@anmenaga Should I expect that the fix for this would have to come via an update to Windows PowerShell?  Or do you foresee a workaround being implemented in PowerShell core edition?",
    "created_at": "2020-04-23T14:39:14Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11202#issuecomment-618433316",
    "id": 618433316,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11202",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxODQzMzMxNg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/618433316/reactions"
    },
    "updated_at": "2020-04-23T14:39:14Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/618433316",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11237922?v=4",
      "events_url": "https://api.github.com/users/alx9r/events{/privacy}",
      "followers_url": "https://api.github.com/users/alx9r/followers",
      "following_url": "https://api.github.com/users/alx9r/following{/other_user}",
      "gists_url": "https://api.github.com/users/alx9r/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/alx9r",
      "id": 11237922,
      "login": "alx9r",
      "node_id": "MDQ6VXNlcjExMjM3OTIy",
      "organizations_url": "https://api.github.com/users/alx9r/orgs",
      "received_events_url": "https://api.github.com/users/alx9r/received_events",
      "repos_url": "https://api.github.com/users/alx9r/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/alx9r/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alx9r/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/alx9r"
    }
  }
]

[
  {
    "author_association": "NONE",
    "body": "I did some digging in the source and stepped through it with a debugger and I think I know what is happening.\r\n\r\nIt seems to be an issue with the path parameter value being quoted.\r\nWhen the trying to autocomplete the parameters the GetDynamicParameters of GetChildrendCommand is being called, the path that is passed to that include the quotations and using double quotes also extra escape chars.\r\n\r\nSo path becomes `\\\"c:\\\\\\\"` or if single quoted it gets passed `'c:\\'`\r\n\r\nDuring resolving of the path the path is determined to be DRIVE-QUALIFIED which is correct but then in the call to GetDriveRootRelativePathFromPSPath and in then IsAbsolutePath in `LocationGlobber.cs` that is supposed to return the driveName is looking for the : in the string and  then end up returning the driveName like this\r\n\r\n`driveName = path.Substring(0, index);`\r\n\r\nProblem with that is the string still has quotes before the driveletter, resulting in the driveName being returned as `'c` or even `\\\"c`\r\n\r\nThis then causes the lookup of the drive information to throw an `System.Management.Automation.DriveNotFoundException`exception, this causes the dynamic parameters function to return null and that is why the dynamic parameters is not getting shown when the path is quoted and contains a : in the path",
    "created_at": "2019-07-02T22:19:20Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9983#issuecomment-507865738",
    "id": 507865738,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9983",
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNzg2NTczOA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/507865738/reactions"
    },
    "updated_at": "2019-07-02T22:19:20Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/507865738",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/26866146?v=4",
      "events_url": "https://api.github.com/users/ViperTG/events{/privacy}",
      "followers_url": "https://api.github.com/users/ViperTG/followers",
      "following_url": "https://api.github.com/users/ViperTG/following{/other_user}",
      "gists_url": "https://api.github.com/users/ViperTG/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ViperTG",
      "id": 26866146,
      "login": "ViperTG",
      "node_id": "MDQ6VXNlcjI2ODY2MTQ2",
      "organizations_url": "https://api.github.com/users/ViperTG/orgs",
      "received_events_url": "https://api.github.com/users/ViperTG/received_events",
      "repos_url": "https://api.github.com/users/ViperTG/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ViperTG/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ViperTG/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ViperTG"
    }
  },
  {
    "author_association": "NONE",
    "body": "Also `-LiteralPath` parameter shows same behavior.",
    "created_at": "2019-07-02T22:27:13Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9983#issuecomment-507867581",
    "id": 507867581,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9983",
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNzg2NzU4MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 1,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/507867581/reactions"
    },
    "updated_at": "2019-07-02T22:27:13Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/507867581",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/26866146?v=4",
      "events_url": "https://api.github.com/users/ViperTG/events{/privacy}",
      "followers_url": "https://api.github.com/users/ViperTG/followers",
      "following_url": "https://api.github.com/users/ViperTG/following{/other_user}",
      "gists_url": "https://api.github.com/users/ViperTG/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ViperTG",
      "id": 26866146,
      "login": "ViperTG",
      "node_id": "MDQ6VXNlcjI2ODY2MTQ2",
      "organizations_url": "https://api.github.com/users/ViperTG/orgs",
      "received_events_url": "https://api.github.com/users/ViperTG/received_events",
      "repos_url": "https://api.github.com/users/ViperTG/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ViperTG/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ViperTG/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ViperTG"
    }
  },
  {
    "author_association": "NONE",
    "body": "Issue still persists in 6.2.2 and 7.0 preview 2\r\n\r\n````\r\nName                           Value\r\n----                           -----\r\nPSVersion                      6.2.2\r\nPSEdition                      Core\r\nGitCommitId                    6.2.2\r\nOS                             Microsoft Windows 10.0.18362\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0…}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n````\r\n\r\n````\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.0.0-preview.2\r\nPSEdition                      Core\r\nGitCommitId                    7.0.0-preview.2\r\nOS                             Microsoft Windows 10.0.18362\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0…}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n````",
    "created_at": "2019-08-06T17:45:16Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9983#issuecomment-518772881",
    "id": 518772881,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9983",
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxODc3Mjg4MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/518772881/reactions"
    },
    "updated_at": "2019-08-06T17:45:16Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/518772881",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/26866146?v=4",
      "events_url": "https://api.github.com/users/ViperTG/events{/privacy}",
      "followers_url": "https://api.github.com/users/ViperTG/followers",
      "following_url": "https://api.github.com/users/ViperTG/following{/other_user}",
      "gists_url": "https://api.github.com/users/ViperTG/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ViperTG",
      "id": 26866146,
      "login": "ViperTG",
      "node_id": "MDQ6VXNlcjI2ODY2MTQ2",
      "organizations_url": "https://api.github.com/users/ViperTG/orgs",
      "received_events_url": "https://api.github.com/users/ViperTG/received_events",
      "repos_url": "https://api.github.com/users/ViperTG/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ViperTG/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ViperTG/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ViperTG"
    }
  },
  {
    "author_association": "NONE",
    "body": "From more testing this affects all CmdLets that have -Path or -LiteralPath and have dynamic parameters also.\r\n\r\nSo this affects resolving any of the dynamic parameters in all these cmdlets\r\n```none\r\nCommandType Name          Version Source                          DynamicParameters\r\n----------- ----          ------- ------                          -----------------\r\n     Cmdlet Add-Content   7.0.0.0 Microsoft.PowerShell.Management NoNewline,Encoding,AsByteStream,Stream\r\n     Cmdlet Clear-Content 7.0.0.0 Microsoft.PowerShell.Management Stream\r\n     Cmdlet Copy-Item     7.0.0.0 Microsoft.PowerShell.Management FromSession,ToSession\r\n     Cmdlet Get-ChildItem 7.0.0.0 Microsoft.PowerShell.Management Attributes,FollowSymlink,Directory,File,Hidden,ReadOnly,System\r\n     Cmdlet Get-Content   7.0.0.0 Microsoft.PowerShell.Management Delimiter,Wait,Raw,Encoding,AsByteStream,Stream\r\n     Cmdlet Get-Item      7.0.0.0 Microsoft.PowerShell.Management Stream\r\n     Cmdlet Remove-Item   7.0.0.0 Microsoft.PowerShell.Management Stream\r\n     Cmdlet Set-Content   7.0.0.0 Microsoft.PowerShell.Management NoNewline,Encoding,AsByteStream,Stream\r\n     Cmdlet Test-Path     7.0.0.0 Microsoft.PowerShell.Management OlderThan,NewerThan\r\n```\r\n\r\nI have tested all these and weirdly `Copy-Item` is not affected for it's dynamic parameters, bu all the rest shows this problem of failing to show their dynamic parameters.\r\n\r\nWhat happens is not the : but rather the path being quoted, to `c:\\`works but `\"c:\\\"` fails. When the path is quoted then LocationGlobber is passed a escaped string or something like `\\\"c:\\\\\\\"` and then it fails to parse that to a drive and throws a `System.Management.Automation.DriveNotFoundException` and then the dynamic parameter parsing stops. \r\n\r\nNote this is only happening in the Intelllisense and the execution is working fine.",
    "created_at": "2019-11-24T19:04:49Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9983#issuecomment-557917752",
    "id": 557917752,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9983",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzkxNzc1Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/557917752/reactions"
    },
    "updated_at": "2019-11-24T19:04:49Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/557917752",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/26866146?v=4",
      "events_url": "https://api.github.com/users/ViperTG/events{/privacy}",
      "followers_url": "https://api.github.com/users/ViperTG/followers",
      "following_url": "https://api.github.com/users/ViperTG/following{/other_user}",
      "gists_url": "https://api.github.com/users/ViperTG/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ViperTG",
      "id": 26866146,
      "login": "ViperTG",
      "node_id": "MDQ6VXNlcjI2ODY2MTQ2",
      "organizations_url": "https://api.github.com/users/ViperTG/orgs",
      "received_events_url": "https://api.github.com/users/ViperTG/received_events",
      "repos_url": "https://api.github.com/users/ViperTG/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ViperTG/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ViperTG/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ViperTG"
    }
  },
  {
    "author_association": "NONE",
    "body": "Still present in 7.0.0-preview.6\r\n\r\n```none\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.0.0-preview.6\r\nPSEdition                      Core\r\nGitCommitId                    7.0.0-preview.6\r\nOS                             Microsoft Windows 10.0.18363\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0…}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```",
    "created_at": "2019-11-25T21:38:47Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9983#issuecomment-558351781",
    "id": 558351781,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9983",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1ODM1MTc4MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/558351781/reactions"
    },
    "updated_at": "2019-11-25T21:38:47Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/558351781",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/26866146?v=4",
      "events_url": "https://api.github.com/users/ViperTG/events{/privacy}",
      "followers_url": "https://api.github.com/users/ViperTG/followers",
      "following_url": "https://api.github.com/users/ViperTG/following{/other_user}",
      "gists_url": "https://api.github.com/users/ViperTG/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ViperTG",
      "id": 26866146,
      "login": "ViperTG",
      "node_id": "MDQ6VXNlcjI2ODY2MTQ2",
      "organizations_url": "https://api.github.com/users/ViperTG/orgs",
      "received_events_url": "https://api.github.com/users/ViperTG/received_events",
      "repos_url": "https://api.github.com/users/ViperTG/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ViperTG/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ViperTG/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ViperTG"
    }
  },
  {
    "author_association": "NONE",
    "body": "Still present in 7.0.1 and 7.1.0 preview-2\r\n\r\n```\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.0.1\r\nPSEdition                      Core\r\nGitCommitId                    7.0.1\r\nOS                             Microsoft Windows 10.0.18363\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0…}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n\r\n```\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.1.0-preview.2\r\nPSEdition                      Core\r\nGitCommitId                    7.1.0-preview.2\r\nOS                             Microsoft Windows 10.0.18363\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0…}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```",
    "created_at": "2020-05-15T21:01:19Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9983#issuecomment-629481268",
    "id": 629481268,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9983",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyOTQ4MTI2OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/629481268/reactions"
    },
    "updated_at": "2020-05-15T21:01:19Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/629481268",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/26866146?v=4",
      "events_url": "https://api.github.com/users/ViperTG/events{/privacy}",
      "followers_url": "https://api.github.com/users/ViperTG/followers",
      "following_url": "https://api.github.com/users/ViperTG/following{/other_user}",
      "gists_url": "https://api.github.com/users/ViperTG/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ViperTG",
      "id": 26866146,
      "login": "ViperTG",
      "node_id": "MDQ6VXNlcjI2ODY2MTQ2",
      "organizations_url": "https://api.github.com/users/ViperTG/orgs",
      "received_events_url": "https://api.github.com/users/ViperTG/received_events",
      "repos_url": "https://api.github.com/users/ViperTG/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ViperTG/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ViperTG/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ViperTG"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "I can confirm that this behavior still exists in PowerShell 7.2.2 as described above. Thank you @ViperTG for the investigation.  I will discuss with the working group as we investigate on our side.",
    "created_at": "2022-05-23T16:40:01Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9983#issuecomment-1134900006",
    "id": 1134900006,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9983",
    "node_id": "IC_kwDOAvT7bc5DpTMm",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1134900006/reactions"
    },
    "updated_at": "2022-05-23T16:40:01Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1134900006",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12662278?v=4",
      "events_url": "https://api.github.com/users/theJasonHelmick/events{/privacy}",
      "followers_url": "https://api.github.com/users/theJasonHelmick/followers",
      "following_url": "https://api.github.com/users/theJasonHelmick/following{/other_user}",
      "gists_url": "https://api.github.com/users/theJasonHelmick/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/theJasonHelmick",
      "id": 12662278,
      "login": "theJasonHelmick",
      "node_id": "MDQ6VXNlcjEyNjYyMjc4",
      "organizations_url": "https://api.github.com/users/theJasonHelmick/orgs",
      "received_events_url": "https://api.github.com/users/theJasonHelmick/received_events",
      "repos_url": "https://api.github.com/users/theJasonHelmick/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/theJasonHelmick/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theJasonHelmick/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/theJasonHelmick"
    }
  },
  {
    "author_association": "NONE",
    "body": ":tada:This issue was addressed in #17661, which has now been successfully released as `v7.3.0-preview.7`.:tada:\n\nHandy links:\n* [Release Notes](https://github.com/PowerShell/PowerShell/releases/tag/v7.3.0-preview.7)\n",
    "created_at": "2022-08-11T23:59:56Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9983#issuecomment-1212602861",
    "id": 1212602861,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9983",
    "node_id": "IC_kwDOAvT7bc5IRtnt",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1212602861/reactions"
    },
    "updated_at": "2022-08-11T23:59:56Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1212602861",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  }
]

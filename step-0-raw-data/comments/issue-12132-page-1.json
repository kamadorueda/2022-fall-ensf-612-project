[
  {
    "author_association": "COLLABORATOR",
    "body": "Add-Type uses \"Microsoft.PowerShell.Commands.AddType.AutoGeneratedTypes\" as namespace. So \"[Microsoft.PowerShell.Commands.AddType.AutoGeneratedTypes.ValidatePrinterExistsAttribute()]\" could work.",
    "created_at": "2020-03-16T09:55:57Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12132#issuecomment-599443720",
    "id": 599443720,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12132",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5OTQ0MzcyMA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/599443720/reactions"
    },
    "updated_at": "2020-03-16T09:55:57Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/599443720",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "\r\n\r\n> Add-Type uses \"Microsoft.PowerShell.Commands.AddType.AutoGeneratedTypes\" as namespace. So \"[Microsoft.PowerShell.Commands.AddType.AutoGeneratedTypes.ValidatePrinterExistsAttribute()]\" could work.\r\n\r\nSadly, not\r\n```\r\n>[Microsoft.PowerShell.Commands.AddType.AutoGeneratedTypes.ValidatePrinterExistsAttribute] \r\nInvalidOperation: Unable to find type [Microsoft.PowerShell.Commands.AddType.AutoGeneratedTypes.ValidatePrinterExistsAttribute].\r\n```\r\n\r\nBut it is present to do the validation\r\n```\r\n>test2 fax\r\nfax\r\n>test2 foobar\r\ntest2: Cannot validate argument on parameter 'name'. 'foobar' is not a valid printer name.\r\n```",
    "created_at": "2020-03-16T10:48:04Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12132#issuecomment-599468450",
    "id": 599468450,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12132",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5OTQ2ODQ1MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/599468450/reactions"
    },
    "updated_at": "2020-03-16T10:48:04Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/599468450",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/16209593?v=4",
      "events_url": "https://api.github.com/users/jhoneill/events{/privacy}",
      "followers_url": "https://api.github.com/users/jhoneill/followers",
      "following_url": "https://api.github.com/users/jhoneill/following{/other_user}",
      "gists_url": "https://api.github.com/users/jhoneill/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jhoneill",
      "id": 16209593,
      "login": "jhoneill",
      "node_id": "MDQ6VXNlcjE2MjA5NTkz",
      "organizations_url": "https://api.github.com/users/jhoneill/orgs",
      "received_events_url": "https://api.github.com/users/jhoneill/received_events",
      "repos_url": "https://api.github.com/users/jhoneill/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jhoneill/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jhoneill/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jhoneill"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@jhoneill Please add more strong repo steps for both cases including the module sources - it would safe time of reviewers. Thanks!",
    "created_at": "2020-03-16T11:13:30Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12132#issuecomment-599478887",
    "id": 599478887,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12132",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5OTQ3ODg4Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/599478887/reactions"
    },
    "updated_at": "2020-03-16T11:13:30Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/599478887",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "> @jhoneill Please add more strong repo steps for both cases including the module sources - it would safe time of reviewers. Thanks!\r\n\r\nSimple demo. There are comments in the PSM1 / PSD1 to show which lines to enable to change where the loading happens.  \r\nYou can import the module and run test2 <<printer name>> or try doing that with load.ps1 or by dot sourcing load.ps1 and comparing the results. \r\n\r\nAs well as test2.ps1  You can compare the c# class behaviour e.g.\r\n`[ValidPrinterSetGenerator]::new().GetValidValues()` \r\nand ps class behaviour e.g. \r\n`[ValidatePrinterExistsAttribute]\r\n`\r\n\r\n[classtest.zip](https://github.com/PowerShell/PowerShell/files/4337898/classtest.zip)\r\n\r\nThanks !!\r\n",
    "created_at": "2020-03-16T11:36:41Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12132#issuecomment-599488581",
    "id": 599488581,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12132",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5OTQ4ODU4MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/599488581/reactions"
    },
    "updated_at": "2020-03-16T11:36:41Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/599488581",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/16209593?v=4",
      "events_url": "https://api.github.com/users/jhoneill/events{/privacy}",
      "followers_url": "https://api.github.com/users/jhoneill/followers",
      "following_url": "https://api.github.com/users/jhoneill/following{/other_user}",
      "gists_url": "https://api.github.com/users/jhoneill/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jhoneill",
      "id": 16209593,
      "login": "jhoneill",
      "node_id": "MDQ6VXNlcjE2MjA5NTkz",
      "organizations_url": "https://api.github.com/users/jhoneill/orgs",
      "received_events_url": "https://api.github.com/users/jhoneill/received_events",
      "repos_url": "https://api.github.com/users/jhoneill/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jhoneill/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jhoneill/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jhoneill"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "> 1. Make import and using/requires consistent  and / or\r\n\r\nThey've mentioned a few times that requiring `using` was a design decision because classes are largely a parse time concept, so a parse time import was needed.\r\n\r\n> 2. Provide a way to export PS classes from a module, rather than pre-loading them and/or\r\n\r\nIf the classes are defined within the psm1, `using module` will import them.  This is currently the only \"proper\" way to define classes to be exported.",
    "created_at": "2020-03-16T12:16:22Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12132#issuecomment-599504037",
    "id": 599504037,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12132",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5OTUwNDAzNw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/599504037/reactions"
    },
    "updated_at": "2020-03-16T12:16:22Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/599504037",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "This looks like dup #1762.",
    "created_at": "2020-03-16T12:30:08Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12132#issuecomment-599509739",
    "id": 599509739,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12132",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5OTUwOTczOQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/599509739/reactions"
    },
    "updated_at": "2020-03-16T12:30:08Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/599509739",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "> > 1. Make import and using/requires consistent  and / or\r\n> \r\n> They've mentioned a few times that requiring `using` was a design decision because classes are largely a parse time concept, so a parse time import was needed.\r\n> \r\n> > 1. Provide a way to export PS classes from a module, rather than pre-loading them and/or\r\n> \r\n> If the classes are defined within the psm1, `using module` will import them. This is currently the only \"proper\" way to define classes to be exported.\r\n\r\nWell, partly. If the classes are in the PSM1 file, instead of Dot-Sourced into I can have this as my PSM\r\n```\r\nusing namespace System.Drawing.Printing\r\nusing namespace System.Management.Automation\r\nusing namespace System.Management.Automation.Language\r\nclass ValidatePrinterExistsAttribute : ValidateArgumentsAttribute {\r\n    [void] Validate([object]$Argument, [EngineIntrinsics]$EngineIntrinsics) {\r\n        if(-not ($Argument -in [PrinterSettings]::InstalledPrinters)) {\r\n          Throw [ParameterBindingException]::new(\"'$Argument' is not a valid printer name.\")\r\n        }\r\n    }\r\n}\r\n\r\nfunction test2 {\r\nparam (\r\n    [ValidatePrinterExistsAttribute()]\r\n    $name\r\n)\r\n$name\r\n}\r\n\r\n```  \r\nThen \r\n`ipmo .\\classtest.psm1 ; test2 fax ; test2 foo; [ValidatePrinterExistsAttribute] `\r\nvalidates _but_ can't find the attribute class and as you say \r\n\r\n`using module .\\classtest.psm1`\r\n`test2 fax ; test2 foo; [ValidatePrinterExistsAttribute]`\r\nValidates and **does** find the attribute class \r\n\r\nOK. So 2 learnings\r\n1.  Put the classes **directly into the PSM** . Dot Sourcing them in does not work.  Those people who like a minimal PSM1 file will have to learn to cope.  \r\n2.  `Using` loads more `than` import-module ` does (and I think `requires`  is like using, not like import\r\n\r\nPasting the using ... & `test...` lines into load2.ps1 and running that ...  validates and finds the class but after loading\r\n```\r\n>test2 foo\r\ntest2: Cannot validate argument on parameter 'name'. 'foo' is not a valid printer name.\r\n> [ValidatePrinterExistsAttribute]\r\nInvalidOperation: Unable to find type [ValidatePrinterExistsAttribute].\r\n```\r\nThe  module's function is there and calls the class, but the class isn't visible outside the script which loaded the module... unless I dot source load2.ps1.  So Dot sourcing is required in one place, and fails in another. \r\n\r\n\r\n",
    "created_at": "2020-03-16T12:55:05Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12132#issuecomment-599520589",
    "id": 599520589,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12132",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5OTUyMDU4OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/599520589/reactions"
    },
    "updated_at": "2020-03-16T12:55:05Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/599520589",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/16209593?v=4",
      "events_url": "https://api.github.com/users/jhoneill/events{/privacy}",
      "followers_url": "https://api.github.com/users/jhoneill/followers",
      "following_url": "https://api.github.com/users/jhoneill/following{/other_user}",
      "gists_url": "https://api.github.com/users/jhoneill/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jhoneill",
      "id": 16209593,
      "login": "jhoneill",
      "node_id": "MDQ6VXNlcjE2MjA5NTkz",
      "organizations_url": "https://api.github.com/users/jhoneill/orgs",
      "received_events_url": "https://api.github.com/users/jhoneill/received_events",
      "repos_url": "https://api.github.com/users/jhoneill/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jhoneill/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jhoneill/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jhoneill"
    }
  },
  {
    "author_association": "NONE",
    "body": "> This looks like dup #1762.\r\nOverlaps but not exactly a dup :-) \r\nThe difference by adding classes to the PSM that @SeeminglyScience  called out is new (and very useful) information.\r\n[Might have to blog that]",
    "created_at": "2020-03-16T13:09:35Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12132#issuecomment-599526877",
    "id": 599526877,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12132",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5OTUyNjg3Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/599526877/reactions"
    },
    "updated_at": "2020-03-16T13:10:10Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/599526877",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/16209593?v=4",
      "events_url": "https://api.github.com/users/jhoneill/events{/privacy}",
      "followers_url": "https://api.github.com/users/jhoneill/followers",
      "following_url": "https://api.github.com/users/jhoneill/following{/other_user}",
      "gists_url": "https://api.github.com/users/jhoneill/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jhoneill",
      "id": 16209593,
      "login": "jhoneill",
      "node_id": "MDQ6VXNlcjE2MjA5NTkz",
      "organizations_url": "https://api.github.com/users/jhoneill/orgs",
      "received_events_url": "https://api.github.com/users/jhoneill/received_events",
      "repos_url": "https://api.github.com/users/jhoneill/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jhoneill/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jhoneill/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jhoneill"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "> > This looks like dup #1762.\r\n> > Overlaps but not exactly a dup :-)\r\n> > The difference by adding classes to the PSM that @SeeminglyScience  called out is new (and very useful) information.\r\n> > [Might have to blog that]\r\n\r\nNah it's the same thing I think.  My guess is that the bug is related to when the resolution of the `ITypeName` is cached.  It applies to most instances of trying to use an attribute that is loaded (even with `Add-Type -TypeDef`, even with `Add-Type -Path` to a dll).  Type resolution for attributes outside of the built in ones is sorta borked.",
    "created_at": "2020-03-16T13:14:56Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12132#issuecomment-599529518",
    "id": 599529518,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12132",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5OTUyOTUxOA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/599529518/reactions"
    },
    "updated_at": "2020-03-16T13:15:19Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/599529518",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Can confirm, I've seen a lot of funkiness when using custom attributes. Sometimes it's fine to call them `NameAttribute` and PS picks it up fine with `[Name()]`, other times it refuses to find it and you've gotta just call the class itself `[Name]`.\r\n\r\nAmong many other oddities that are frustrating as all heck to reliably reproduce.",
    "created_at": "2020-03-16T13:16:33Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12132#issuecomment-599530279",
    "id": 599530279,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12132",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5OTUzMDI3OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/599530279/reactions"
    },
    "updated_at": "2020-03-16T13:16:33Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/599530279",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/32407840?v=4",
      "events_url": "https://api.github.com/users/vexx32/events{/privacy}",
      "followers_url": "https://api.github.com/users/vexx32/followers",
      "following_url": "https://api.github.com/users/vexx32/following{/other_user}",
      "gists_url": "https://api.github.com/users/vexx32/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vexx32",
      "id": 32407840,
      "login": "vexx32",
      "node_id": "MDQ6VXNlcjMyNDA3ODQw",
      "organizations_url": "https://api.github.com/users/vexx32/orgs",
      "received_events_url": "https://api.github.com/users/vexx32/received_events",
      "repos_url": "https://api.github.com/users/vexx32/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vexx32/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vexx32/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vexx32"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "I set \"answered\" since we have a workaround and cross-reference with meta-issue #6652.",
    "created_at": "2020-03-16T13:28:06Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12132#issuecomment-599535929",
    "id": 599535929,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12132",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5OTUzNTkyOQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/599535929/reactions"
    },
    "updated_at": "2020-03-16T14:14:10Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/599535929",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "@vexx32  yes saw your comments on 1762 , and had the same with where you can omit 'attribute' and next thing you find you can't  - and agree it's full of oddities. \r\n  \r\n@iSazonov  Makes sense :-) \r\n\r\n",
    "created_at": "2020-03-16T13:34:23Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12132#issuecomment-599539019",
    "id": 599539019,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12132",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5OTUzOTAxOQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/599539019/reactions"
    },
    "updated_at": "2020-03-16T13:34:23Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/599539019",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/16209593?v=4",
      "events_url": "https://api.github.com/users/jhoneill/events{/privacy}",
      "followers_url": "https://api.github.com/users/jhoneill/followers",
      "following_url": "https://api.github.com/users/jhoneill/following{/other_user}",
      "gists_url": "https://api.github.com/users/jhoneill/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jhoneill",
      "id": 16209593,
      "login": "jhoneill",
      "node_id": "MDQ6VXNlcjE2MjA5NTkz",
      "organizations_url": "https://api.github.com/users/jhoneill/orgs",
      "received_events_url": "https://api.github.com/users/jhoneill/received_events",
      "repos_url": "https://api.github.com/users/jhoneill/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jhoneill/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jhoneill/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jhoneill"
    }
  },
  {
    "author_association": "NONE",
    "body": "@vexx32 It might amused you that after this a penny dropped that one of the problems I was getting might be because I'd removed \"attribute\" ... just put it back in into close to 100  places where I'd replaced a dynamic parameters with static ones and a validate class and now things behave (as above) without . sourcing ",
    "created_at": "2020-03-17T16:21:04Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12132#issuecomment-600163125",
    "id": 600163125,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12132",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwMDE2MzEyNQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 1,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/600163125/reactions"
    },
    "updated_at": "2020-03-17T16:21:04Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/600163125",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/16209593?v=4",
      "events_url": "https://api.github.com/users/jhoneill/events{/privacy}",
      "followers_url": "https://api.github.com/users/jhoneill/followers",
      "following_url": "https://api.github.com/users/jhoneill/following{/other_user}",
      "gists_url": "https://api.github.com/users/jhoneill/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jhoneill",
      "id": 16209593,
      "login": "jhoneill",
      "node_id": "MDQ6VXNlcjE2MjA5NTkz",
      "organizations_url": "https://api.github.com/users/jhoneill/orgs",
      "received_events_url": "https://api.github.com/users/jhoneill/received_events",
      "repos_url": "https://api.github.com/users/jhoneill/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jhoneill/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jhoneill/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jhoneill"
    }
  },
  {
    "author_association": "NONE",
    "body": "> If the classes are defined within the psm1, `using module` will import them. This is currently the only \"proper\" way to define classes to be exported.\r\n\r\nFrom what I can tell, this is apparently still true. But this doesn't make any sense to me. I download a psm1 file from my repo as pure text over TLS, and I convert  it to a dynamic module via New-Module and then import it into memory with Import-Module. Now I can access the functions as I wish, and when I am done, I have nothing to cleanup on the file system. Why cannot I do the same thing with a class? I should be able to download the class file, whether in a psm1 or ps1 file, as pure text over TLS and then import it easily into memory for instantiation. Logically, it makes sense to just import it with a module OR import it with another such command. For example:\r\n\r\n```\r\n$fooClass = New-Class -ScriptBlock $fooClassAsText\r\n$fooClass | Import-Class\r\n$myFooObj = [Foo]::new()  #If the class import was unsuccessful, I'll get an exception here telling me that Foo doesn't exist\r\n```",
    "created_at": "2020-04-28T20:40:24Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12132#issuecomment-620842696",
    "id": 620842696,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12132",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMDg0MjY5Ng==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/620842696/reactions"
    },
    "updated_at": "2020-04-28T20:40:24Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/620842696",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/26101661?v=4",
      "events_url": "https://api.github.com/users/TitaniumCoder477/events{/privacy}",
      "followers_url": "https://api.github.com/users/TitaniumCoder477/followers",
      "following_url": "https://api.github.com/users/TitaniumCoder477/following{/other_user}",
      "gists_url": "https://api.github.com/users/TitaniumCoder477/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/TitaniumCoder477",
      "id": 26101661,
      "login": "TitaniumCoder477",
      "node_id": "MDQ6VXNlcjI2MTAxNjYx",
      "organizations_url": "https://api.github.com/users/TitaniumCoder477/orgs",
      "received_events_url": "https://api.github.com/users/TitaniumCoder477/received_events",
      "repos_url": "https://api.github.com/users/TitaniumCoder477/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/TitaniumCoder477/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TitaniumCoder477/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/TitaniumCoder477"
    }
  }
]

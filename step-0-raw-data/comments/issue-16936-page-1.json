[
  {
    "author_association": "COLLABORATOR",
    "body": "As alternative for discussion - introduce new parameter (-NoPrefix/-RemovePrefix).\r\n\r\nAlso question for discussion - is the prefix a strong contact from module author?",
    "created_at": "2022-03-02T07:37:30Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16936#issuecomment-1056469248",
    "id": 1056469248,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16936",
    "node_id": "IC_kwDOAvT7bc4--HEA",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1056469248/reactions"
    },
    "updated_at": "2022-03-02T07:37:30Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1056469248",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@iSazonov I don't think it should be a strong contract. A \"proper\" module (at least script wise) I write as if it has no prefix, all the commands and references are of the non-prefixed version. If a prefix is specified, everything continues to work as expected. The user can specify multiple prefixes potentially and import the module multiple times to address multiple target scenarios, so they can use `Get-SourceMyFunction` and `Get-DestinationMyFunction` for instance if the connection context is kept at module scope.\r\n\r\nI do think that the specified bool should not be IsNullOrEmpty but simply a null check, so that an empty '' can indicate `I don't want a prefix`, however I understand that is more breaking than `-NoPrefix` so I\"m fine with that too.\r\n\r\nMy current main issue pain point here is in Pester Testing, the only way I can specify my pester test commands after importing the module is to make a completely different non-prefixed manifest, or use a prefix (but then in VSCode, my GoTo references no longer work). I want to use the same non-prefixed commands that I have defined during testing without having to make an entirely separate manifest file.",
    "created_at": "2022-03-09T17:18:52Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16936#issuecomment-1063166835",
    "id": 1063166835,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16936",
    "node_id": "IC_kwDOAvT7bc4_XqNz",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1063166835/reactions"
    },
    "updated_at": "2022-03-09T17:20:13Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1063166835",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/15258962?v=4",
      "events_url": "https://api.github.com/users/JustinGrote/events{/privacy}",
      "followers_url": "https://api.github.com/users/JustinGrote/followers",
      "following_url": "https://api.github.com/users/JustinGrote/following{/other_user}",
      "gists_url": "https://api.github.com/users/JustinGrote/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/JustinGrote",
      "id": 15258962,
      "login": "JustinGrote",
      "node_id": "MDQ6VXNlcjE1MjU4OTYy",
      "organizations_url": "https://api.github.com/users/JustinGrote/orgs",
      "received_events_url": "https://api.github.com/users/JustinGrote/received_events",
      "repos_url": "https://api.github.com/users/JustinGrote/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/JustinGrote/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JustinGrote/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/JustinGrote"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "I made the following workaround, the regexes are fragile but it works for my use case\r\n```powershell\r\nfunction Import-ModuleWithoutPrefix {\r\n  [CmdletBinding()]\r\n  param(\r\n    [Parameter(Mandatory, ValueFromPipeline)]$ManifestPath,\r\n    [Switch]$Force,\r\n    $TempPath = 'TEMP:'\r\n  )\r\n  $path = Resolve-Path $ManifestPath\r\n  $manifestDir = Split-Path $Path -Parent\r\n  $fileName = [io.path]::GetFileNameWithoutExtension($path)\r\n  #Manifest file name must be the same\r\n  $tempPath = \"TEMP:\\$(New-Guid)\\$fileName.psd1\"\r\n\r\n  $manifestContent = Get-Content -Raw $path\r\n  $rootModuleRegex = '(?<=RootModule\\s*?=\\s*?[''\"])(.+?)(?=[''\"])'\r\n  if ($manifestContent -notmatch $rootModuleRegex) {\r\n    throw \"Could not find RootModule entry in manifest $path\"\r\n  }\r\n  $rootModulePath = [io.path]::IsPathRooted($matches[1]) ? $matches[1] : $(Join-Path $manifestDir $matches[1])\r\n  $resolvedRootModulePath = Resolve-Path $rootModulePath\r\n  $manifestContent = $manifestContent -replace $rootModuleRegex, $resolvedRootModulePath\r\n\r\n  #Remove any prefix entry present. If this doesn't exist we don't error out\r\n  $manifestContent = $manifestContent -replace 'DefaultCommandPrefix\\s*?=\\s*?[''\"].+?[''\"]'\r\n\r\n  #This should be unique\r\n  New-Item -ItemType File -Force -Path $tempPath -Value $manifestContent | Out-Null\r\n\r\n  Write-Verbose \"Importing module $path without prefix from $tempPath\"\r\n  Import-Module $tempPath -Force:$Force -PassThru\r\n}\r\n```",
    "created_at": "2022-03-10T22:25:57Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16936#issuecomment-1064567687",
    "id": 1064567687,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16936",
    "node_id": "IC_kwDOAvT7bc4_dAOH",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1064567687/reactions"
    },
    "updated_at": "2022-03-10T22:25:57Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1064567687",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/15258962?v=4",
      "events_url": "https://api.github.com/users/JustinGrote/events{/privacy}",
      "followers_url": "https://api.github.com/users/JustinGrote/followers",
      "following_url": "https://api.github.com/users/JustinGrote/following{/other_user}",
      "gists_url": "https://api.github.com/users/JustinGrote/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/JustinGrote",
      "id": 15258962,
      "login": "JustinGrote",
      "node_id": "MDQ6VXNlcjE1MjU4OTYy",
      "organizations_url": "https://api.github.com/users/JustinGrote/orgs",
      "received_events_url": "https://api.github.com/users/JustinGrote/received_events",
      "repos_url": "https://api.github.com/users/JustinGrote/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/JustinGrote/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JustinGrote/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/JustinGrote"
    }
  }
]

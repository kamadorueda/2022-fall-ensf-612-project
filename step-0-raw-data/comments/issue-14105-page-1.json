[
  {
    "author_association": "NONE",
    "body": "I found the \"Provider\" property here:\r\n\r\n```powershell\r\n$Cert.PrivateKey.Key.Provider\r\n```\r\n\r\nI guess this solves my issue.  I'll still ask - is this different on purpose, or is this still a valid issue?  It feels like a breaking change between 5.1 and 7, which I am not sure is a concern for the developers or not.  I can add logic to test either way based on the PSVersionTable I suppose, though that does stink a little.",
    "created_at": "2020-11-16T20:01:25Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14105#issuecomment-728292294",
    "id": 728292294,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14105",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyODI5MjI5NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/728292294/reactions"
    },
    "updated_at": "2020-11-16T20:01:25Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/728292294",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/18154705?v=4",
      "events_url": "https://api.github.com/users/JeremyTBradshaw/events{/privacy}",
      "followers_url": "https://api.github.com/users/JeremyTBradshaw/followers",
      "following_url": "https://api.github.com/users/JeremyTBradshaw/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyTBradshaw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/JeremyTBradshaw",
      "id": 18154705,
      "login": "JeremyTBradshaw",
      "node_id": "MDQ6VXNlcjE4MTU0NzA1",
      "organizations_url": "https://api.github.com/users/JeremyTBradshaw/orgs",
      "received_events_url": "https://api.github.com/users/JeremyTBradshaw/received_events",
      "repos_url": "https://api.github.com/users/JeremyTBradshaw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/JeremyTBradshaw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyTBradshaw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/JeremyTBradshaw"
    }
  },
  {
    "author_association": "NONE",
    "body": "Last thing I can think to say - while I have PowerShell 7 installed, I can't install PowerShell 6.  I'd like to know if PowerShell 6 has these properties the same way as 7, or as 5.1, so that I can build logic into my module to test for the provider based on the PSVersionTable.  I'll find a box to install it on, but just as a general question, I'm wondering if I should suspect 6 to be like 7, or like 5.1 as a rule of thumb?  Or should I simply never try to accommodate both PSEditions Core/Desktop with the same pieces of code (which I'd like to do).",
    "created_at": "2020-11-16T20:11:49Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14105#issuecomment-728297721",
    "id": 728297721,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14105",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyODI5NzcyMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/728297721/reactions"
    },
    "updated_at": "2020-11-16T20:11:49Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/728297721",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/18154705?v=4",
      "events_url": "https://api.github.com/users/JeremyTBradshaw/events{/privacy}",
      "followers_url": "https://api.github.com/users/JeremyTBradshaw/followers",
      "following_url": "https://api.github.com/users/JeremyTBradshaw/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyTBradshaw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/JeremyTBradshaw",
      "id": 18154705,
      "login": "JeremyTBradshaw",
      "node_id": "MDQ6VXNlcjE4MTU0NzA1",
      "organizations_url": "https://api.github.com/users/JeremyTBradshaw/orgs",
      "received_events_url": "https://api.github.com/users/JeremyTBradshaw/received_events",
      "repos_url": "https://api.github.com/users/JeremyTBradshaw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/JeremyTBradshaw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyTBradshaw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/JeremyTBradshaw"
    }
  },
  {
    "author_association": "NONE",
    "body": "```powershell\r\n$certProvider = $null\r\nif ($PSVersionTable.PSEdition -eq 'Desktop') {\r\n\r\n    $certProvider = $Certificate.PrivateKey.CspKeyContainerInfo.ProviderName\r\n}\r\nelse {\r\n    $certProvider = $Certificate.PrivateKey.Key.Provider\r\n}\r\n    \r\nif ($certProvider -ne 'Microsoft Enhanced RSA and AES Cryptographic Provider') { <# do my stuff here #> }\r\n```\r\n\r\nClosing issue, leaving the code in case it helps anyone.",
    "created_at": "2020-11-16T20:24:18Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14105#issuecomment-728303756",
    "id": 728303756,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14105",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyODMwMzc1Ng==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/728303756/reactions"
    },
    "updated_at": "2020-11-16T20:24:18Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/728303756",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/18154705?v=4",
      "events_url": "https://api.github.com/users/JeremyTBradshaw/events{/privacy}",
      "followers_url": "https://api.github.com/users/JeremyTBradshaw/followers",
      "following_url": "https://api.github.com/users/JeremyTBradshaw/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyTBradshaw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/JeremyTBradshaw",
      "id": 18154705,
      "login": "JeremyTBradshaw",
      "node_id": "MDQ6VXNlcjE4MTU0NzA1",
      "organizations_url": "https://api.github.com/users/JeremyTBradshaw/orgs",
      "received_events_url": "https://api.github.com/users/JeremyTBradshaw/received_events",
      "repos_url": "https://api.github.com/users/JeremyTBradshaw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/JeremyTBradshaw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyTBradshaw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/JeremyTBradshaw"
    }
  }
]

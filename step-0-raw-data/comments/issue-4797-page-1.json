[
  {
    "author_association": "NONE",
    "body": "I looked into this a little and here's what I found. I used 65,000 empty files in a tmpfs on Debian Stretch. Tab completion in this directory took more than 16 seconds to complete. Pretty much all of the time spent during tab completion is focused in two places:\r\n\r\nThe globbing done here took around 25% of the time:\r\nhttps://github.com/PowerShell/PowerShell/blob/16d7a62195cb15156c134748e72ae23bd8923241/src/System.Management.Automation/engine/CommandCompletion/CompletionCompleters.cs#L4072-L4077\r\nGlobbing in general seems to be slower than Bash. Running `Get-ChildItem *` in PowerShell in the directory with 65,000 files takes around 12 seconds compared to less than a second for the Bash equivalent.\r\n\r\nThe remaining 75% of the time is spent in this large loop:\r\nhttps://github.com/PowerShell/PowerShell/blob/16d7a62195cb15156c134748e72ae23bd8923241/src/System.Management.Automation/engine/CommandCompletion/CompletionCompleters.cs#L4215-L4373\r\n\r\n[This flame graph](https://github.com/PowerShell/PowerShell/files/1755724/flame.svg.gz), can give some insight into areas that could be improved. The most notable functions are `CompletionRequiresQuotes()`, `ExecuteCurrentPowerShell()`, `get_ProviderPath()`, and `NormalizeRelativePath()`. @smaeul and @vors discussed how the provider path could be an easy target for optimization given that all of the results of the tab completion should share the same provider.",
    "created_at": "2018-02-25T05:43:49Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/4797#issuecomment-368285313",
    "id": 368285313,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/4797",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2ODI4NTMxMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/368285313/reactions"
    },
    "updated_at": "2018-02-25T05:43:49Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/368285313",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/10768051?v=4",
      "events_url": "https://api.github.com/users/Scholars-Mate/events{/privacy}",
      "followers_url": "https://api.github.com/users/Scholars-Mate/followers",
      "following_url": "https://api.github.com/users/Scholars-Mate/following{/other_user}",
      "gists_url": "https://api.github.com/users/Scholars-Mate/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Scholars-Mate",
      "id": 10768051,
      "login": "Scholars-Mate",
      "node_id": "MDQ6VXNlcjEwNzY4MDUx",
      "organizations_url": "https://api.github.com/users/Scholars-Mate/orgs",
      "received_events_url": "https://api.github.com/users/Scholars-Mate/received_events",
      "repos_url": "https://api.github.com/users/Scholars-Mate/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Scholars-Mate/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Scholars-Mate/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Scholars-Mate"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Thank you @Scholars-Mate for investigating this!\r\nHere is a small glimpse into the flame graph, to encourage others to take a look at it\r\n\r\n![image](https://user-images.githubusercontent.com/816680/36638613-728a02de-19bf-11e8-8393-a88a77ddfad3.png)",
    "created_at": "2018-02-25T06:05:42Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/4797#issuecomment-368286245",
    "id": 368286245,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/4797",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2ODI4NjI0NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/368286245/reactions"
    },
    "updated_at": "2018-02-25T06:05:42Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/368286245",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/816680?v=4",
      "events_url": "https://api.github.com/users/vors/events{/privacy}",
      "followers_url": "https://api.github.com/users/vors/followers",
      "following_url": "https://api.github.com/users/vors/following{/other_user}",
      "gists_url": "https://api.github.com/users/vors/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vors",
      "id": 816680,
      "login": "vors",
      "node_id": "MDQ6VXNlcjgxNjY4MA==",
      "organizations_url": "https://api.github.com/users/vors/orgs",
      "received_events_url": "https://api.github.com/users/vors/received_events",
      "repos_url": "https://api.github.com/users/vors/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vors/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vors"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "There is a lot of work going on in .NET core in this area that we should get with the 2.1 release.",
    "created_at": "2018-02-26T05:37:18Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/4797#issuecomment-368395341",
    "id": 368395341,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/4797",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2ODM5NTM0MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/368395341/reactions"
    },
    "updated_at": "2018-02-26T05:37:18Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/368395341",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/3505151?v=4",
      "events_url": "https://api.github.com/users/powercode/events{/privacy}",
      "followers_url": "https://api.github.com/users/powercode/followers",
      "following_url": "https://api.github.com/users/powercode/following{/other_user}",
      "gists_url": "https://api.github.com/users/powercode/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/powercode",
      "id": 3505151,
      "login": "powercode",
      "node_id": "MDQ6VXNlcjM1MDUxNTE=",
      "organizations_url": "https://api.github.com/users/powercode/orgs",
      "received_events_url": "https://api.github.com/users/powercode/received_events",
      "repos_url": "https://api.github.com/users/powercode/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/powercode/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/powercode/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/powercode"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@powercode do you mean perf tools or performance work we will benefit from? Are we getting something for free in the new dotnet core?",
    "created_at": "2018-02-27T00:23:21Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/4797#issuecomment-368700562",
    "id": 368700562,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/4797",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2ODcwMDU2Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/368700562/reactions"
    },
    "updated_at": "2018-02-27T00:23:21Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/368700562",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/816680?v=4",
      "events_url": "https://api.github.com/users/vors/events{/privacy}",
      "followers_url": "https://api.github.com/users/vors/followers",
      "following_url": "https://api.github.com/users/vors/following{/other_user}",
      "gists_url": "https://api.github.com/users/vors/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vors",
      "id": 816680,
      "login": "vors",
      "node_id": "MDQ6VXNlcjgxNjY4MA==",
      "organizations_url": "https://api.github.com/users/vors/orgs",
      "received_events_url": "https://api.github.com/users/vors/received_events",
      "repos_url": "https://api.github.com/users/vors/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vors/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vors"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@vors They are doing a ton of work regarding efficient file enumeration/projection, and a lot of getting `Span<T>` based interfaces in place to reduce allocations. Looks very promising.\r\n\r\nI'm a bit involved in getting better abstractions for efficient regex's so we can make `Select-String` fast.\r\n",
    "created_at": "2018-02-27T12:37:34Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/4797#issuecomment-368860019",
    "id": 368860019,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/4797",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2ODg2MDAxOQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/368860019/reactions"
    },
    "updated_at": "2018-02-27T12:37:34Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/368860019",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/3505151?v=4",
      "events_url": "https://api.github.com/users/powercode/events{/privacy}",
      "followers_url": "https://api.github.com/users/powercode/followers",
      "following_url": "https://api.github.com/users/powercode/following{/other_user}",
      "gists_url": "https://api.github.com/users/powercode/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/powercode",
      "id": 3505151,
      "login": "powercode",
      "node_id": "MDQ6VXNlcjM1MDUxNTE=",
      "organizations_url": "https://api.github.com/users/powercode/orgs",
      "received_events_url": "https://api.github.com/users/powercode/received_events",
      "repos_url": "https://api.github.com/users/powercode/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/powercode/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/powercode/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/powercode"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@Scholars-Mate, @vors do you remember how you created that flame graph? It would be really nice to reproduce that for other performance issues!",
    "created_at": "2018-07-18T23:57:22Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/4797#issuecomment-406110134",
    "id": 406110134,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/4797",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNjExMDEzNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/406110134/reactions"
    },
    "updated_at": "2018-07-18T23:57:22Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/406110134",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/7009879?v=4",
      "events_url": "https://api.github.com/users/rjmholt/events{/privacy}",
      "followers_url": "https://api.github.com/users/rjmholt/followers",
      "following_url": "https://api.github.com/users/rjmholt/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjmholt/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rjmholt",
      "id": 7009879,
      "login": "rjmholt",
      "node_id": "MDQ6VXNlcjcwMDk4Nzk=",
      "organizations_url": "https://api.github.com/users/rjmholt/orgs",
      "received_events_url": "https://api.github.com/users/rjmholt/received_events",
      "repos_url": "https://api.github.com/users/rjmholt/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rjmholt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjmholt/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rjmholt"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "I think we followed this article http://blogs.microsoft.co.il/sasha/2017/02/27/profiling-a-net-core-application-on-linux/\r\nThere was not much customization, just make sure to run a debug build with symbols, so the names are populated.",
    "created_at": "2018-07-19T01:18:56Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/4797#issuecomment-406123708",
    "id": 406123708,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/4797",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNjEyMzcwOA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/406123708/reactions"
    },
    "updated_at": "2018-07-19T01:18:56Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/406123708",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/816680?v=4",
      "events_url": "https://api.github.com/users/vors/events{/privacy}",
      "followers_url": "https://api.github.com/users/vors/followers",
      "following_url": "https://api.github.com/users/vors/following{/other_user}",
      "gists_url": "https://api.github.com/users/vors/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vors",
      "id": 816680,
      "login": "vors",
      "node_id": "MDQ6VXNlcjgxNjY4MA==",
      "organizations_url": "https://api.github.com/users/vors/orgs",
      "received_events_url": "https://api.github.com/users/vors/received_events",
      "repos_url": "https://api.github.com/users/vors/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vors/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vors"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Oh awesome! Thanks @vors!",
    "created_at": "2018-07-19T01:33:00Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/4797#issuecomment-406125968",
    "id": 406125968,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/4797",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNjEyNTk2OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/406125968/reactions"
    },
    "updated_at": "2018-07-19T01:33:00Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/406125968",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/7009879?v=4",
      "events_url": "https://api.github.com/users/rjmholt/events{/privacy}",
      "followers_url": "https://api.github.com/users/rjmholt/followers",
      "following_url": "https://api.github.com/users/rjmholt/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjmholt/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rjmholt",
      "id": 7009879,
      "login": "rjmholt",
      "node_id": "MDQ6VXNlcjcwMDk4Nzk=",
      "organizations_url": "https://api.github.com/users/rjmholt/orgs",
      "received_events_url": "https://api.github.com/users/rjmholt/received_events",
      "repos_url": "https://api.github.com/users/rjmholt/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rjmholt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjmholt/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rjmholt"
    }
  }
]

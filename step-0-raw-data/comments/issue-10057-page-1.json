[
  {
    "author_association": "CONTRIBUTOR",
    "body": "Note that you are running code on an STA thread, creating COM objects, but not cleaning them up. Then the STA thread terminates (calling CoUninitialize) and leaves the COM objects to be collected by the finalizer.\r\n\r\nI don't know how robust the finalizer is when the underlying thread and COM apartment already have been terminated, in native code you get an access violation if you try to release an object whose apartment is already gone. This is not a request to change anything, just a heads-up so you know to identify potential sources of crashes.\r\n\r\nThe only \"alternative\" I know of is to deterministically release the COM references via `Marshal.ReleaseComObject` for every RCW crossing the COM-NET boundary. This is very tedious and error prone and requires exact knowledge of when RCW reference counts are incremented and when they aren't.\r\n\r\nAn ugly workaround, should it come to crashes due to this, is to force GC collection & draining the finalizer queue before terminating the STA thread. This way the RCW finalizer can release the COM object before the apartment is closed.",
    "created_at": "2019-07-03T19:40:53Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/10057#issuecomment-508229627",
    "id": 508229627,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/10057",
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwODIyOTYyNw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/508229627/reactions"
    },
    "updated_at": "2019-07-03T19:48:25Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/508229627",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/5845814?v=4",
      "events_url": "https://api.github.com/users/weltkante/events{/privacy}",
      "followers_url": "https://api.github.com/users/weltkante/followers",
      "following_url": "https://api.github.com/users/weltkante/following{/other_user}",
      "gists_url": "https://api.github.com/users/weltkante/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/weltkante",
      "id": 5845814,
      "login": "weltkante",
      "node_id": "MDQ6VXNlcjU4NDU4MTQ=",
      "organizations_url": "https://api.github.com/users/weltkante/orgs",
      "received_events_url": "https://api.github.com/users/weltkante/received_events",
      "repos_url": "https://api.github.com/users/weltkante/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/weltkante/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/weltkante/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/weltkante"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Yeah thats fine, I don't mind it, like I said just giving some heads-up if you should start seeing some new kind of crashes. Switching to WPF will probably be for the better since they seem to be more careful with their cleanup (they are doing the `Marshal.ReleaseComObject` calls I mentioned).",
    "created_at": "2019-07-03T19:58:38Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/10057#issuecomment-508234728",
    "id": 508234728,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/10057",
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwODIzNDcyOA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/508234728/reactions"
    },
    "updated_at": "2019-07-03T19:58:38Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/508234728",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/5845814?v=4",
      "events_url": "https://api.github.com/users/weltkante/events{/privacy}",
      "followers_url": "https://api.github.com/users/weltkante/followers",
      "following_url": "https://api.github.com/users/weltkante/following{/other_user}",
      "gists_url": "https://api.github.com/users/weltkante/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/weltkante",
      "id": 5845814,
      "login": "weltkante",
      "node_id": "MDQ6VXNlcjU4NDU4MTQ=",
      "organizations_url": "https://api.github.com/users/weltkante/orgs",
      "received_events_url": "https://api.github.com/users/weltkante/received_events",
      "repos_url": "https://api.github.com/users/weltkante/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/weltkante/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/weltkante/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/weltkante"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for the review. I am now much happier with it as well. Finger's crossed that this fixes the problems. In the far future, we will replace the implementation with APIs by WPF (this depends on a PR by me to be able to create an elevated JumpList though that might take some times to get merged). We should get this into `7.0-preview2` and get the folks from the issue hooked on re-testing again fort a week and if successful, backport to 6.1/6.2\r\n@AaronRobinsonMSFT Can you give it one final review again please?",
    "created_at": "2019-07-05T23:05:42Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/10057#issuecomment-508877307",
    "id": 508877307,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/10057",
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwODg3NzMwNw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/508877307/reactions"
    },
    "updated_at": "2019-07-05T23:07:51Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/508877307",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/9250262?v=4",
      "events_url": "https://api.github.com/users/bergmeister/events{/privacy}",
      "followers_url": "https://api.github.com/users/bergmeister/followers",
      "following_url": "https://api.github.com/users/bergmeister/following{/other_user}",
      "gists_url": "https://api.github.com/users/bergmeister/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/bergmeister",
      "id": 9250262,
      "login": "bergmeister",
      "node_id": "MDQ6VXNlcjkyNTAyNjI=",
      "organizations_url": "https://api.github.com/users/bergmeister/orgs",
      "received_events_url": "https://api.github.com/users/bergmeister/received_events",
      "repos_url": "https://api.github.com/users/bergmeister/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/bergmeister/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bergmeister/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/bergmeister"
    }
  },
  {
    "author_association": "NONE",
    "body": ":tada:`v7.0.0-preview.2` has been released which incorporates this pull request.:tada:\n\nHandy links:\n* [Release Notes](https://github.com/PowerShell/PowerShell/releases/tag/v7.0.0-preview.2)\n",
    "created_at": "2019-07-17T20:56:27Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/10057#issuecomment-512565456",
    "id": 512565456,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/10057",
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxMjU2NTQ1Ng==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/512565456/reactions"
    },
    "updated_at": "2019-07-17T20:56:27Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/512565456",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  }
]

[
  {
    "author_association": "COLLABORATOR",
    "body": "The underlying API (`Get/SetConsoleScreenBuffer`) does not have a [virtual terminal equivalent](https://docs.microsoft.com/en-us/windows/console/getconsolescreenbufferinfoex#remarks) so I'm not sure it makes sense to later this API.\r\n\r\nIf you want to programmatically set specific cells, it may be better to set cursor position via escape sequences, e.g.\r\n\r\n```powershell\r\n\"`e[s\"         + # Safe cursor position\r\n    \"`e[1;1H\"  + # Set cursor position to 1,1\r\n    \"`e[30m\"   + # Change color\r\n    \"testing\"  + # String to write\r\n    \"`e[0m\"    + # Reset color\r\n    \"`e[u\"     + # Reset cursor position\r\n\r\n",
    "created_at": "2021-11-04T12:58:43Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16364#issuecomment-960866629",
    "id": 960866629,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16364",
    "node_id": "IC_kwDOAvT7bc45RalF",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/960866629/reactions"
    },
    "updated_at": "2021-11-04T12:58:43Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/960866629",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  },
  {
    "author_association": "NONE",
    "body": "@SeeminglyScience - Thank you for the suggestion! This is what I do in the current incarnation of the code. Problem is, performance is _very much_ a consideration in this case, and SetBufferContents _vastly_ outperforms this option.\r\n\r\nBesides, it seems wrong somehow that the \"proper\" way of populating the console programmatically can only cover a tiny subset of what can actually be rendered (colors, symbols, etc.)",
    "created_at": "2021-11-04T19:13:23Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16364#issuecomment-961341560",
    "id": 961341560,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16364",
    "node_id": "IC_kwDOAvT7bc45TOh4",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/961341560/reactions"
    },
    "updated_at": "2021-11-04T19:13:23Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/961341560",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/40332187?v=4",
      "events_url": "https://api.github.com/users/NotNotWrongUsually/events{/privacy}",
      "followers_url": "https://api.github.com/users/NotNotWrongUsually/followers",
      "following_url": "https://api.github.com/users/NotNotWrongUsually/following{/other_user}",
      "gists_url": "https://api.github.com/users/NotNotWrongUsually/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/NotNotWrongUsually",
      "id": 40332187,
      "login": "NotNotWrongUsually",
      "node_id": "MDQ6VXNlcjQwMzMyMTg3",
      "organizations_url": "https://api.github.com/users/NotNotWrongUsually/orgs",
      "received_events_url": "https://api.github.com/users/NotNotWrongUsually/received_events",
      "repos_url": "https://api.github.com/users/NotNotWrongUsually/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/NotNotWrongUsually/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NotNotWrongUsually/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/NotNotWrongUsually"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "> @SeeminglyScience - Thank you for the suggestion! This is what I do in the current incarnation of the code. Problem is, performance is _very much_ a consideration in this case, and SetBufferContents _vastly_ outperforms this option.\r\n\r\nIf the API in `PSHost` were to be changed to support escape sequences, it would need to do some form of what I have above.  The API it uses is provided by the operating system, if it's not updated to support escape sequences, then there isn't much for PowerShell to do.\r\n\r\nThat said, yes the above is going to lack in performance.  Updates need to sort of be batched together and ideally not duplicate redundant escapes.  In some cases it may be cheaper to redraw the screen.\r\n\r\n> Besides, it seems wrong somehow that the \"proper\" way of populating the console programmatically can only cover a tiny subset of what can actually be rendered (colors, symbols, etc.)\r\n\r\nI think it would be more accurate to refer to it as the old way of doing it.  The operating system does not support using these APIs with escape sequences and that team has made it clear that they don't plan to change that in the future.  For example, this warning is on the [`WriteConsoleOutput`](https://docs.microsoft.com/en-us/windows/console/writeconsoleoutput) function used by PowerShell [here](https://github.com/PowerShell/PowerShell/blob/0f2f23f67a2c3ec53cf82c8d1a67b479f62934e4/src/Microsoft.PowerShell.ConsoleHost/host/msh/ConsoleControl.cs#L3146):\r\n\r\n> This document describes console platform functionality that is no longer a part of our ecosystem roadmap. We do not recommend using this content in new products, but we will continue to support existing usages for the indefinite future. Our preferred modern solution focuses on virtual terminal sequences for maximum compatibility in cross-platform scenarios. You can find more information about this design decision in our classic console vs. virtual terminal document.\r\n\r\nand also this warning:\r\n\r\n> This API has a virtual terminal equivalent in the text formatting and cursor positioning sequences. Move the cursor to the location to insert, apply the formatting desired, and write out the text. Virtual terminal sequences are recommended for all new and ongoing development.\r\n",
    "created_at": "2021-11-04T21:46:44Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16364#issuecomment-961455454",
    "id": 961455454,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16364",
    "node_id": "IC_kwDOAvT7bc45TqVe",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/961455454/reactions"
    },
    "updated_at": "2021-11-04T21:46:44Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/961455454",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  },
  {
    "author_association": "NONE",
    "body": "This issue has been marked as answered and has not had any activity for **1 day**. It has been closed for housekeeping purposes.",
    "created_at": "2021-11-12T00:00:44Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16364#issuecomment-966710254",
    "id": 966710254,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16364",
    "node_id": "IC_kwDOAvT7bc45ntPu",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/966710254/reactions"
    },
    "updated_at": "2021-11-12T00:00:44Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/966710254",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  }
]

[
  {
    "author_association": "MEMBER",
    "body": "`PowerShell.Invoke` handles `PowerShell.Stop` in the same way as how <kbd>Ctrl+c</kbd> is handled in PowerShell console: the `PipelineStoppedException` is ignored [when the pipeline was stopped](https://github.com/PowerShell/PowerShell/blob/49288e4289dc46a28bac79ff89257e744ff55a25/src/System.Management.Automation/engine/hostifaces/pipelinebase.cs#L398-L401).\r\n\r\nThe api `PowerShell.Invoke` is used as the _primary pipeline_ for many interactive hosts that are built on top of PowerShell packages (e.g. powershell sub-kernel in .NET interactive). For such a host, it's important to act similarly to the PowerShell console, including how <kbd>Ctrl+c</kbd> is handled (the implementation of which would be very likely just calling `PowerShell.Stop`). From this perspective, it seems reasonable for `PowerShell.Invoke` to behave exactly the same as a PowerShell console `LocalPipeline`.\r\n\r\n`PowerShell.InvokeAsync` ( wrapper over `PowerShell.BeginInvoke/EndInvoke`) is for advanced asynchronous scenarios. I think throwing `PipelineStoppedException` makes perfect sense for this API, as I need to know whether my task succeeded or failed, and for what reason if it failed.\r\n\r\nWe probably cannot afford any breaking changes in either of these 2 APIs. I think what we can do is to add a `<remark>` section to the XML document for those 2 APIs, to describe their behaviors regarding to dealing with `Stop`.\r\n\r\n--------------------------------------------\r\n\r\n> when a `PSDataCollection<PSObject>` is passed into the `InvokeAsync()` call, no results are ever inserted and the `DataAdding` and `DataAdded` events are never fired. Am I missing something?\r\n\r\nThe `System.Management.Automation.PSDataCollection[TOutput] output` parameter seems to work as expected from the below snippet. This is with `7.2.0-preview.4`. Am I missing something?\r\n\r\n```\r\nPS:1> $ps = [powershell]::Create()\r\nPS:2> $out = [System.Management.Automation.PSDataCollection[psobject]]::new()\r\nPS:3> $ps.AddScript(\"1;2;3;sleep 90;4;5;6\") > $null\r\nPS:4> $a = $ps.InvokeAsync([System.Management.Automation.PSDataCollection[psobject]]$null, $out); sleep 2; $ps.Stop()\r\nPS:5> $out\r\n1\r\n2\r\n3\r\nPS:6>\r\n```",
    "created_at": "2021-04-11T06:20:32Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15173#issuecomment-817256886",
    "id": 817256886,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15173",
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxNzI1Njg4Ng==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 1,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/817256886/reactions"
    },
    "updated_at": "2021-04-11T06:22:40Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/817256886",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Thanks @daxian-dbw this is exactly the information I was looking for.\r\n\r\nI've realised my original issue statement has a flaw in it where I didn't use the `PSDataCollection` properly (used as the wrong argument), so will update that. Passing the collection in properly works.\r\n\r\nBut I think the `remarks` addition would be useful",
    "created_at": "2021-04-13T19:43:52Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15173#issuecomment-819005624",
    "id": 819005624,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15173",
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxOTAwNTYyNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/819005624/reactions"
    },
    "updated_at": "2021-04-13T19:46:55Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/819005624",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/7009879?v=4",
      "events_url": "https://api.github.com/users/rjmholt/events{/privacy}",
      "followers_url": "https://api.github.com/users/rjmholt/followers",
      "following_url": "https://api.github.com/users/rjmholt/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjmholt/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rjmholt",
      "id": 7009879,
      "login": "rjmholt",
      "node_id": "MDQ6VXNlcjcwMDk4Nzk=",
      "organizations_url": "https://api.github.com/users/rjmholt/orgs",
      "received_events_url": "https://api.github.com/users/rjmholt/received_events",
      "repos_url": "https://api.github.com/users/rjmholt/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rjmholt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjmholt/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rjmholt"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@rjmholt Since you are going to submit the XML doc PR, I will assign this issue to you :)\r\nNote that, you may need to update the XML document for `PowerShell.EndInvoke` as well, it's essentially what `PowerShell.InvokeAsync` does.",
    "created_at": "2021-04-29T17:54:01Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15173#issuecomment-829468423",
    "id": 829468423,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15173",
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyOTQ2ODQyMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/829468423/reactions"
    },
    "updated_at": "2021-04-29T17:54:01Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/829468423",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "NONE",
    "body": ":tada:This issue was addressed in #15324, which has now been successfully released as `v7.2.0-preview.7`.:tada:\n\nHandy links:\n* [Release Notes](https://github.com/PowerShell/PowerShell/releases/tag/v7.2.0-preview.7)\n",
    "created_at": "2021-06-17T16:57:57Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15173#issuecomment-863405290",
    "id": 863405290,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15173",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MzQwNTI5MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/863405290/reactions"
    },
    "updated_at": "2021-06-17T16:57:57Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/863405290",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  }
]

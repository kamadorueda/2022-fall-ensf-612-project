[
  {
    "author_association": "COLLABORATOR",
    "body": "/cc @anmenaga for information.",
    "created_at": "2020-04-22T17:13:02Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12427#issuecomment-617912072",
    "id": 617912072,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12427",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxNzkxMjA3Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/617912072/reactions"
    },
    "updated_at": "2020-04-22T17:13:02Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/617912072",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "This is same as #11202 - a bug in implicit remoting code.\r\n@alx9r can you please confirm this by running commands [from this screenshot](https://github.com/PowerShell/PowerShell/issues/11202#issuecomment-558830772) in Windows PS (replacing module to be `Wdac`); thank you.",
    "created_at": "2020-04-22T19:26:43Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12427#issuecomment-617982879",
    "id": 617982879,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12427",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxNzk4Mjg3OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/617982879/reactions"
    },
    "updated_at": "2020-04-22T19:26:43Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/617982879",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11860095?v=4",
      "events_url": "https://api.github.com/users/anmenaga/events{/privacy}",
      "followers_url": "https://api.github.com/users/anmenaga/followers",
      "following_url": "https://api.github.com/users/anmenaga/following{/other_user}",
      "gists_url": "https://api.github.com/users/anmenaga/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/anmenaga",
      "id": 11860095,
      "login": "anmenaga",
      "node_id": "MDQ6VXNlcjExODYwMDk1",
      "organizations_url": "https://api.github.com/users/anmenaga/orgs",
      "received_events_url": "https://api.github.com/users/anmenaga/received_events",
      "repos_url": "https://api.github.com/users/anmenaga/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/anmenaga/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/anmenaga/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/anmenaga"
    }
  },
  {
    "author_association": "NONE",
    "body": "@anmenaga The behavior is not quite the same as for [#11202 (screenshot)](https://github.com/PowerShell/PowerShell/issues/11202#issuecomment-558830772).  I ran the following in a fresh instance of `pwsh`:\r\n\r\n```PowerShell\r\nGet-FormatData -TypeName '*' | Out-Null\r\n'before'\r\nImport-Module Wdac\r\n'after'\r\nGet-FormatData -TypeName '*' | Out-Null\r\n```\r\n\r\nThe output was\r\n\r\n```\r\nbefore\r\nImport-Module: C:\\script.ps1:3\r\nLine |\r\n   3 |  Import-Module Wdac\r\n     |  ~~~~~~~~~~~~~~~~~~\r\n     | Failed to generate proxies for remote module 'Wdac'. Running the Get-FormatData command in a remote session\r\n     | reported the following error: Unable to cast object of type\r\n     | 'Microsoft.PowerShell.Commands.Internal.Format.ControlReference' to type\r\n     | 'Microsoft.PowerShell.Commands.Internal.Format.ComplexControlBody'..\r\nafter\r\n```",
    "created_at": "2020-04-22T20:17:18Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12427#issuecomment-618016344",
    "id": 618016344,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12427",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxODAxNjM0NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/618016344/reactions"
    },
    "updated_at": "2020-04-22T20:17:18Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/618016344",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11237922?v=4",
      "events_url": "https://api.github.com/users/alx9r/events{/privacy}",
      "followers_url": "https://api.github.com/users/alx9r/followers",
      "following_url": "https://api.github.com/users/alx9r/following{/other_user}",
      "gists_url": "https://api.github.com/users/alx9r/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/alx9r",
      "id": 11237922,
      "login": "alx9r",
      "node_id": "MDQ6VXNlcjExMjM3OTIy",
      "organizations_url": "https://api.github.com/users/alx9r/orgs",
      "received_events_url": "https://api.github.com/users/alx9r/received_events",
      "repos_url": "https://api.github.com/users/alx9r/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/alx9r/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alx9r/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/alx9r"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Those screenshot steps have to be run in Windows PowerShell 5.1\r\nLooks like you ran them in PS Core. Please try them in Windows PowerShell.\r\n",
    "created_at": "2020-04-22T20:28:10Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12427#issuecomment-618021845",
    "id": 618021845,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12427",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxODAyMTg0NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/618021845/reactions"
    },
    "updated_at": "2020-04-22T20:28:10Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/618021845",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11860095?v=4",
      "events_url": "https://api.github.com/users/anmenaga/events{/privacy}",
      "followers_url": "https://api.github.com/users/anmenaga/followers",
      "following_url": "https://api.github.com/users/anmenaga/following{/other_user}",
      "gists_url": "https://api.github.com/users/anmenaga/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/anmenaga",
      "id": 11860095,
      "login": "anmenaga",
      "node_id": "MDQ6VXNlcjExODYwMDk1",
      "organizations_url": "https://api.github.com/users/anmenaga/orgs",
      "received_events_url": "https://api.github.com/users/anmenaga/received_events",
      "repos_url": "https://api.github.com/users/anmenaga/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/anmenaga/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/anmenaga/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/anmenaga"
    }
  },
  {
    "author_association": "NONE",
    "body": "@anmenaga I see.  My apologies.  I missed that detail.  Here is the output from Windows PS:\r\n\r\n```\r\nbefore\r\nafter\r\nGet-FormatData : Unable to cast object of type 'Microsoft.PowerShell.Commands.Internal.Format.ControlReference' to\r\ntype 'Microsoft.PowerShell.Commands.Internal.Format.ComplexControlBody'.\r\nAt C:\\script.ps1:5 char:1\r\n+ Get-FormatData -TypeName '*' | Out-Null\r\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    + CategoryInfo          : NotSpecified: (:) [Get-FormatData], InvalidCastException\r\n    + FullyQualifiedErrorId : System.InvalidCastException,Microsoft.PowerShell.Commands.GetFormatDataCommand\r\n```",
    "created_at": "2020-04-22T20:31:30Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12427#issuecomment-618023514",
    "id": 618023514,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12427",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxODAyMzUxNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/618023514/reactions"
    },
    "updated_at": "2020-04-22T20:31:30Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/618023514",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11237922?v=4",
      "events_url": "https://api.github.com/users/alx9r/events{/privacy}",
      "followers_url": "https://api.github.com/users/alx9r/followers",
      "following_url": "https://api.github.com/users/alx9r/following{/other_user}",
      "gists_url": "https://api.github.com/users/alx9r/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/alx9r",
      "id": 11237922,
      "login": "alx9r",
      "node_id": "MDQ6VXNlcjExMjM3OTIy",
      "organizations_url": "https://api.github.com/users/alx9r/orgs",
      "received_events_url": "https://api.github.com/users/alx9r/received_events",
      "repos_url": "https://api.github.com/users/alx9r/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/alx9r/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alx9r/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/alx9r"
    }
  },
  {
    "author_association": "NONE",
    "body": "Hi, I have the same error on Powershell 7.0.0 using **Add-OdbcDsn**:\r\n\r\n`The 'Add-OdbcDsn' command was found in the module 'Wdac', but the module could not be loaded. For more information, run 'Import-Module Wdac'.`\r\n\r\nBy running **Import-Module Wdac**:\r\n\r\n`Import-Module: Failed to generate proxies for remote module 'Wdac'. Running the Get-FormatData command in a remote session reported the following error: Unable to cast object of type 'Microsoft.PowerShell.Commands.Internal.Format.ControlReference' to type 'Microsoft.PowerShell.Commands.Internal.Format.ComplexControlBody'.`",
    "created_at": "2020-05-05T10:51:46Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12427#issuecomment-623985228",
    "id": 623985228,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12427",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMzk4NTIyOA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/623985228/reactions"
    },
    "updated_at": "2020-05-05T10:51:46Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/623985228",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/58071067?v=4",
      "events_url": "https://api.github.com/users/dgpsh/events{/privacy}",
      "followers_url": "https://api.github.com/users/dgpsh/followers",
      "following_url": "https://api.github.com/users/dgpsh/following{/other_user}",
      "gists_url": "https://api.github.com/users/dgpsh/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/dgpsh",
      "id": 58071067,
      "login": "dgpsh",
      "node_id": "MDQ6VXNlcjU4MDcxMDY3",
      "organizations_url": "https://api.github.com/users/dgpsh/orgs",
      "received_events_url": "https://api.github.com/users/dgpsh/received_events",
      "repos_url": "https://api.github.com/users/dgpsh/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/dgpsh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dgpsh/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/dgpsh"
    }
  },
  {
    "author_association": "NONE",
    "body": "@dgpsh The closest workaround I've found is using the CIM APIs via `Invoke-CimMethod`.  I've posted the snippet in [this gist](https://gist.github.com/alx9r/1a1d158646866818131c52a38226cd78).  They're definitely not directly replacements for the commands in the Wdac module, but they seem to be the closest in functionality I've found.\r\n\r\nThere does seem to be [this limitation](https://stackoverflow.com/questions/61398748) compared with `Add-OdbcDsn` that is currently unresolved.  I was hoping someone more familiar with the Wdac module and/or CIM could provide some guidance to overcome that limitation.  That would mean I could arrive on a replacement for Wdac that doesn't involve Windows PowerShell.",
    "created_at": "2020-05-05T14:31:24Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12427#issuecomment-624090879",
    "id": 624090879,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12427",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNDA5MDg3OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624090879/reactions"
    },
    "updated_at": "2020-05-05T19:20:54Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624090879",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11237922?v=4",
      "events_url": "https://api.github.com/users/alx9r/events{/privacy}",
      "followers_url": "https://api.github.com/users/alx9r/followers",
      "following_url": "https://api.github.com/users/alx9r/following{/other_user}",
      "gists_url": "https://api.github.com/users/alx9r/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/alx9r",
      "id": 11237922,
      "login": "alx9r",
      "node_id": "MDQ6VXNlcjExMjM3OTIy",
      "organizations_url": "https://api.github.com/users/alx9r/orgs",
      "received_events_url": "https://api.github.com/users/alx9r/received_events",
      "repos_url": "https://api.github.com/users/alx9r/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/alx9r/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alx9r/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/alx9r"
    }
  },
  {
    "author_association": "NONE",
    "body": "@dgpsh \r\n\r\nThere is a better workaround reported and tested by @fMichaleczek in #12578:\r\n\r\n>Import-Module Wdac -SkipEditionCheck\r\n\r\nIt's not clear to me what degree of support to expect for importing the `Wdac` module into PowerShell 7 in this manner, but it seems to be the best option at this point.  I expect to use this technique until #11202 is fixed.",
    "created_at": "2020-05-06T18:16:53Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12427#issuecomment-624808785",
    "id": 624808785,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12427",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNDgwODc4NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624808785/reactions"
    },
    "updated_at": "2020-05-06T18:17:05Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624808785",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11237922?v=4",
      "events_url": "https://api.github.com/users/alx9r/events{/privacy}",
      "followers_url": "https://api.github.com/users/alx9r/followers",
      "following_url": "https://api.github.com/users/alx9r/following{/other_user}",
      "gists_url": "https://api.github.com/users/alx9r/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/alx9r",
      "id": 11237922,
      "login": "alx9r",
      "node_id": "MDQ6VXNlcjExMjM3OTIy",
      "organizations_url": "https://api.github.com/users/alx9r/orgs",
      "received_events_url": "https://api.github.com/users/alx9r/received_events",
      "repos_url": "https://api.github.com/users/alx9r/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/alx9r/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alx9r/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/alx9r"
    }
  }
]

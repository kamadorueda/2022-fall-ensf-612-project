[
  {
    "author_association": "COLLABORATOR",
    "body": "/cc @PaulHigin Have you any thoughts about the issue?",
    "created_at": "2020-11-11T12:07:50Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14032#issuecomment-725387071",
    "id": 725387071,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14032",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyNTM4NzA3MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/725387071/reactions"
    },
    "updated_at": "2020-11-11T12:07:50Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/725387071",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "### Summary : \r\n- **The issue occurs only with asp.net core SDK**, not with the dot.net core SDK\r\n- **The issue is only related to RunspaceFactory.CreateOutOfProcessRunspace** , CreateOutOfProcessRunspace(null) had the same error\r\n- The main message error is **BinaryFormatter serialization and deserialization are disabled within this application**\r\n\r\n### Solution : \r\nAdd a property **EnableUnsafeBinaryFormatterSerialization** set to **true** in your project\r\n```\r\n<Project Sdk=\"Microsoft.NET.Sdk.Web\">\r\n\t<PropertyGroup>\r\n\t\t<TargetFramework>net5.0</TargetFramework>\r\n\t\t<OutputType>Exe</OutputType>\r\n\t\t<EnableUnsafeBinaryFormatterSerialization>true</EnableUnsafeBinaryFormatterSerialization>\r\n\t</PropertyGroup>\r\n\t<ItemGroup>\r\n\t\t<PackageReference Include=\"system.management.automation\" Version=\"7.0.3\" />\r\n\t</ItemGroup>\r\n</Project>\r\n```\r\n\r\n@PaulHigin I think PS Team should add the property EnableUnsafeBinaryFormatterSerialization to every project in this repo which depends on Binary Formatter Serialization.  I don't know if PowerShell depends on EnableUnsafeUTF7Encoding too. See this post, if you want to see all new properties in net5.0\r\nhttps://github.com/PowerShell/PowerShell/issues/13755#issuecomment-704948203",
    "created_at": "2020-11-12T03:09:34Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14032#issuecomment-725800387",
    "id": 725800387,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14032",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyNTgwMDM4Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/725800387/reactions"
    },
    "updated_at": "2020-11-12T03:09:34Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/725800387",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6187529?v=4",
      "events_url": "https://api.github.com/users/fMichaleczek/events{/privacy}",
      "followers_url": "https://api.github.com/users/fMichaleczek/followers",
      "following_url": "https://api.github.com/users/fMichaleczek/following{/other_user}",
      "gists_url": "https://api.github.com/users/fMichaleczek/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/fMichaleczek",
      "id": 6187529,
      "login": "fMichaleczek",
      "node_id": "MDQ6VXNlcjYxODc1Mjk=",
      "organizations_url": "https://api.github.com/users/fMichaleczek/orgs",
      "received_events_url": "https://api.github.com/users/fMichaleczek/received_events",
      "repos_url": "https://api.github.com/users/fMichaleczek/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/fMichaleczek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fMichaleczek/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/fMichaleczek"
    }
  },
  {
    "author_association": "NONE",
    "body": "@fMichaleczek Thanks a lot for providing these directions, it works like a charm here.\r\n\r\n> @PaulHigin I think PS Team should add the property EnableUnsafeBinaryFormatterSerialization to every project in this repo which depends on Binary Formatter Serialization. I don't know if PowerShell depends on EnableUnsafeUTF7Encoding too. See this post, if you want to see all new properties in net5.0\r\n> [#13755 (comment)](https://github.com/PowerShell/PowerShell/issues/13755#issuecomment-704948203)\r\n\r\nGiven the security vulnerabilities noted, wouldn't it be better not to use the Binary Formatter serialization at all? Or is this simply not possible? If not, I guess the .NET team should be aware of PowerShell being impacted by this.",
    "created_at": "2020-11-12T09:03:50Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14032#issuecomment-725943207",
    "id": 725943207,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14032",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyNTk0MzIwNw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/725943207/reactions"
    },
    "updated_at": "2020-11-12T09:04:05Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/725943207",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/3049216?v=4",
      "events_url": "https://api.github.com/users/leonardder/events{/privacy}",
      "followers_url": "https://api.github.com/users/leonardder/followers",
      "following_url": "https://api.github.com/users/leonardder/following{/other_user}",
      "gists_url": "https://api.github.com/users/leonardder/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/leonardder",
      "id": 3049216,
      "login": "leonardder",
      "node_id": "MDQ6VXNlcjMwNDkyMTY=",
      "organizations_url": "https://api.github.com/users/leonardder/orgs",
      "received_events_url": "https://api.github.com/users/leonardder/received_events",
      "repos_url": "https://api.github.com/users/leonardder/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/leonardder/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/leonardder/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/leonardder"
    }
  },
  {
    "author_association": "NONE",
    "body": "@leonardder Good news ! Nothing is deprecrated, it's only to force people to know what they do. I think it's better to separate this issue from the BinaryFormatter security discussion, could you : \r\n- change the title to something more precise like \"PowerShell Remoting isn't working in the Asp.Net Core SDK 5.0 \" and close it.\r\n- open a new one to ask PSTeam about PowerShell and BinaryFormatter security guide\r\nhttps://docs.microsoft.com/en-us/dotnet/standard/serialization/binaryformatter-security-guide\r\n\r\n@PaulHigin I confirm it will break too in dotnet sdk in the future\r\nsee https://github.com/dotnet/sdk/pull/12434#issuecomment-657867794\n\n<blockquote><img src=\"https://docs.microsoft.com/en-us/media/logos/logo-ms-social.png\" width=\"48\" align=\"right\"><div><strong><a href=\"https://docs.microsoft.com/en-us/dotnet/standard/serialization/binaryformatter-security-guide\">BinaryFormatter security guide</a></strong></div><div>This article describes the security risks inherent in the BinaryFormatter type and recommendations for different serializers to use.</div></blockquote>",
    "created_at": "2020-11-12T10:26:16Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14032#issuecomment-725988556",
    "id": 725988556,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14032",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyNTk4ODU1Ng==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/725988556/reactions"
    },
    "updated_at": "2020-11-12T10:26:18Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/725988556",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6187529?v=4",
      "events_url": "https://api.github.com/users/fMichaleczek/events{/privacy}",
      "followers_url": "https://api.github.com/users/fMichaleczek/followers",
      "following_url": "https://api.github.com/users/fMichaleczek/following{/other_user}",
      "gists_url": "https://api.github.com/users/fMichaleczek/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/fMichaleczek",
      "id": 6187529,
      "login": "fMichaleczek",
      "node_id": "MDQ6VXNlcjYxODc1Mjk=",
      "organizations_url": "https://api.github.com/users/fMichaleczek/orgs",
      "received_events_url": "https://api.github.com/users/fMichaleczek/received_events",
      "repos_url": "https://api.github.com/users/fMichaleczek/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/fMichaleczek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fMichaleczek/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/fMichaleczek"
    }
  },
  {
    "author_association": "NONE",
    "body": "> @leonardder Good news ! Nothing is deprecrated, it's only to force people to know what they do. \r\n\r\n\r\nFrom https://github.com/dotnet/designs/pull/141#issue-448990656\r\n\r\n> Eventually all code within the dotnet repo is to be migrated fully off of BinaryFormatter, at which point the implementation is to be removed from the runtime.\r\n\r\nI hear your request to close the current issue, but I think there are still two outstanding points:\r\n\r\n1. Your idea in https://github.com/PowerShell/PowerShell/issues/14032#issuecomment-725800387 to add this to all projects.\r\n2. The fact that this is currently not documented on PowerSHell's end. Or do you think that falls in scope of another issue to be created?",
    "created_at": "2020-11-12T10:35:46Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14032#issuecomment-725993555",
    "id": 725993555,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14032",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyNTk5MzU1NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/725993555/reactions"
    },
    "updated_at": "2020-11-12T10:35:46Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/725993555",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/3049216?v=4",
      "events_url": "https://api.github.com/users/leonardder/events{/privacy}",
      "followers_url": "https://api.github.com/users/leonardder/followers",
      "following_url": "https://api.github.com/users/leonardder/following{/other_user}",
      "gists_url": "https://api.github.com/users/leonardder/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/leonardder",
      "id": 3049216,
      "login": "leonardder",
      "node_id": "MDQ6VXNlcjMwNDkyMTY=",
      "organizations_url": "https://api.github.com/users/leonardder/orgs",
      "received_events_url": "https://api.github.com/users/leonardder/received_events",
      "repos_url": "https://api.github.com/users/leonardder/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/leonardder/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/leonardder/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/leonardder"
    }
  },
  {
    "author_association": "NONE",
    "body": "@leonardder \r\n> 1. Your idea in [#14032 (comment)](https://github.com/PowerShell/PowerShell/issues/14032#issuecomment-725800387) to add this to all projects.\r\n\r\nAfter reading the document [BinaryFormatter Obsoletion Strategy](https://github.com/dotnet/designs/blob/main/accepted/2020/better-obsoletion/binaryformatter-obsoletion.md), it's wrong. BinaryFormatter will be disabled by default across all project types for .NET 7  (Nov 2022).\r\n\r\n> 2. The fact that this is currently not documented on PowerSHell's end. Or do you think that falls in scope of another issue to be created?\r\n\r\nI created issues to ask : \r\n- to define a PowerShell BinaryFormatter Obsoletion Strategy https://github.com/PowerShell/PowerShell/issues/14054\r\n- to document this issue https://github.com/MicrosoftDocs/PowerShell-Docs/issues/6879\r\n\r\n",
    "created_at": "2020-11-12T12:03:27Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14032#issuecomment-726036371",
    "id": 726036371,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14032",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyNjAzNjM3MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/726036371/reactions"
    },
    "updated_at": "2020-11-12T12:03:27Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/726036371",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6187529?v=4",
      "events_url": "https://api.github.com/users/fMichaleczek/events{/privacy}",
      "followers_url": "https://api.github.com/users/fMichaleczek/followers",
      "following_url": "https://api.github.com/users/fMichaleczek/following{/other_user}",
      "gists_url": "https://api.github.com/users/fMichaleczek/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/fMichaleczek",
      "id": 6187529,
      "login": "fMichaleczek",
      "node_id": "MDQ6VXNlcjYxODc1Mjk=",
      "organizations_url": "https://api.github.com/users/fMichaleczek/orgs",
      "received_events_url": "https://api.github.com/users/fMichaleczek/received_events",
      "repos_url": "https://api.github.com/users/fMichaleczek/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/fMichaleczek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fMichaleczek/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/fMichaleczek"
    }
  },
  {
    "author_association": "NONE",
    "body": "Thanks for this. Closing as requested.",
    "created_at": "2020-11-12T12:06:29Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14032#issuecomment-726037687",
    "id": 726037687,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14032",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyNjAzNzY4Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/726037687/reactions"
    },
    "updated_at": "2020-11-12T12:06:29Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/726037687",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/3049216?v=4",
      "events_url": "https://api.github.com/users/leonardder/events{/privacy}",
      "followers_url": "https://api.github.com/users/leonardder/followers",
      "following_url": "https://api.github.com/users/leonardder/following{/other_user}",
      "gists_url": "https://api.github.com/users/leonardder/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/leonardder",
      "id": 3049216,
      "login": "leonardder",
      "node_id": "MDQ6VXNlcjMwNDkyMTY=",
      "organizations_url": "https://api.github.com/users/leonardder/orgs",
      "received_events_url": "https://api.github.com/users/leonardder/received_events",
      "repos_url": "https://api.github.com/users/leonardder/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/leonardder/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/leonardder/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/leonardder"
    }
  }
]

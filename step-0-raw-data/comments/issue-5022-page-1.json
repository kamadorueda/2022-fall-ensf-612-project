[
  {
    "author_association": "CONTRIBUTOR",
    "body": "Why do you put `Add-Type` in `catch`? You could also put `using assembly System.Configuration` on top of script.",
    "created_at": "2017-10-05T19:57:16Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/5022#issuecomment-334574962",
    "id": 334574962,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/5022",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNDU3NDk2Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/334574962/reactions"
    },
    "updated_at": "2017-10-05T19:57:16Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/334574962",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/17184058?v=4",
      "events_url": "https://api.github.com/users/PetSerAl/events{/privacy}",
      "followers_url": "https://api.github.com/users/PetSerAl/followers",
      "following_url": "https://api.github.com/users/PetSerAl/following{/other_user}",
      "gists_url": "https://api.github.com/users/PetSerAl/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/PetSerAl",
      "id": 17184058,
      "login": "PetSerAl",
      "node_id": "MDQ6VXNlcjE3MTg0MDU4",
      "organizations_url": "https://api.github.com/users/PetSerAl/orgs",
      "received_events_url": "https://api.github.com/users/PetSerAl/received_events",
      "repos_url": "https://api.github.com/users/PetSerAl/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/PetSerAl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PetSerAl/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/PetSerAl"
    }
  },
  {
    "author_association": "NONE",
    "body": "I, too, have used this in a script of mine. It would absolutely be beneficial to be able to include it this way.",
    "created_at": "2017-10-05T20:23:47Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/5022#issuecomment-334581506",
    "id": 334581506,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/5022",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNDU4MTUwNg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/334581506/reactions"
    },
    "updated_at": "2017-10-05T20:23:47Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/334581506",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/29762998?v=4",
      "events_url": "https://api.github.com/users/JasonG-STCU/events{/privacy}",
      "followers_url": "https://api.github.com/users/JasonG-STCU/followers",
      "following_url": "https://api.github.com/users/JasonG-STCU/following{/other_user}",
      "gists_url": "https://api.github.com/users/JasonG-STCU/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/JasonG-STCU",
      "id": 29762998,
      "login": "JasonG-STCU",
      "node_id": "MDQ6VXNlcjI5NzYyOTk4",
      "organizations_url": "https://api.github.com/users/JasonG-STCU/orgs",
      "received_events_url": "https://api.github.com/users/JasonG-STCU/received_events",
      "repos_url": "https://api.github.com/users/JasonG-STCU/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/JasonG-STCU/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JasonG-STCU/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/JasonG-STCU"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@PetSerAl I wasn't aware of the [`using`](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_using?view=powershell-5.1) keyword, though I don't see `assembly` documented as an argument to it. Also, our servers are not uniformly on PowerShell 5 just yet, so that extended syntax isn't something we can fully rely on yet (my workstation is stuck on version 5.0.10105.0-April2015Preview which doesn't support `using assembly`, and I'm unable to upgrade or downgrade or uninstall it from Windows 7). It seems odd to have _another_ thing that must come first in the script, along with `[CmdletBinding()]Param(…)`. It looks like `using` *must* precede `[CmdletBinding()]Param(…)`.\r\n\r\nThe reason I use the above formulation is to `Add-Type` only if referencing the type causes an exception, that way I'm only adding it once per session.",
    "created_at": "2017-10-05T21:44:24Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/5022#issuecomment-334600740",
    "id": 334600740,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/5022",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNDYwMDc0MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/334600740/reactions"
    },
    "updated_at": "2017-10-05T21:44:41Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/334600740",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8332839?v=4",
      "events_url": "https://api.github.com/users/brianary/events{/privacy}",
      "followers_url": "https://api.github.com/users/brianary/followers",
      "following_url": "https://api.github.com/users/brianary/following{/other_user}",
      "gists_url": "https://api.github.com/users/brianary/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/brianary",
      "id": 8332839,
      "login": "brianary",
      "node_id": "MDQ6VXNlcjgzMzI4Mzk=",
      "organizations_url": "https://api.github.com/users/brianary/orgs",
      "received_events_url": "https://api.github.com/users/brianary/received_events",
      "repos_url": "https://api.github.com/users/brianary/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/brianary/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brianary/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/brianary"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "> The reason I use the above formulation is to `Add-Type` only if referencing the type causes an exception, that way I'm only adding it once per session.\r\n\r\nYou can not load same assembly twice anyway. No harm on calling `Add-Type` for already loaded assembly.\r\n```powershell\r\n$a = Add-Type -AssemblyName System.Configuration -PassThru | Select-Object -First 1 -ExpandProperty Assembly\r\n$b = Add-Type -AssemblyName System.Configuration -PassThru | Select-Object -First 1 -ExpandProperty Assembly\r\n[Object]::ReferenceEquals($a, $b)\r\n```",
    "created_at": "2017-10-06T04:12:45Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/5022#issuecomment-334653342",
    "id": 334653342,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/5022",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNDY1MzM0Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/334653342/reactions"
    },
    "updated_at": "2017-10-06T04:12:45Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/334653342",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/17184058?v=4",
      "events_url": "https://api.github.com/users/PetSerAl/events{/privacy}",
      "followers_url": "https://api.github.com/users/PetSerAl/followers",
      "following_url": "https://api.github.com/users/PetSerAl/following{/other_user}",
      "gists_url": "https://api.github.com/users/PetSerAl/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/PetSerAl",
      "id": 17184058,
      "login": "PetSerAl",
      "node_id": "MDQ6VXNlcjE3MTg0MDU4",
      "organizations_url": "https://api.github.com/users/PetSerAl/orgs",
      "received_events_url": "https://api.github.com/users/PetSerAl/received_events",
      "repos_url": "https://api.github.com/users/PetSerAl/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/PetSerAl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PetSerAl/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/PetSerAl"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "I'll have to look into the `using` syntax (I hope it gets added to the docs, and is officially supported) once I can finally upgrade things and get the new features.\r\n\r\nHowever, even on a newer machine, there's a pretty big performance difference:\r\n```\r\nPS C:\\Users\\me> \"$(Measure-Command {0..10000|% {iex 'using assembly System.Configuration'}})\"\r\n00:00:08.2655849\r\nPS C:\\Users\\me> \"$(Measure-Command {0..10000|% {Add-Type -AN System.Configuration}})\"\r\n00:00:04.6386843\r\nPS C:\\Users\\me> \"$(Measure-Command {0..10000|% {try{[void][Configuration.ConfigurationManager]}catch{Add-Type -AN System.Configuration}}})\"\r\n00:00:00.0728870\r\n```\r\non my older machine, it's even bigger:\r\n```\r\nPS C:\\Users\\me> \"$(Measure-Command {0..10000|% {Add-Type -AN System.Configuration}})\"\r\n00:00:08.1306933\r\nPS C:\\Users\\me> \"$(Measure-Command {0..10000|% {try{[void][Configuration.ConfigurationManager]}catch{Add-Type -AN System.Configuration}}})\"\r\n00:00:00.2983187\r\n```",
    "created_at": "2017-10-06T16:45:04Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/5022#issuecomment-334808757",
    "id": 334808757,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/5022",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNDgwODc1Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/334808757/reactions"
    },
    "updated_at": "2017-10-06T16:45:04Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/334808757",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8332839?v=4",
      "events_url": "https://api.github.com/users/brianary/events{/privacy}",
      "followers_url": "https://api.github.com/users/brianary/followers",
      "following_url": "https://api.github.com/users/brianary/following{/other_user}",
      "gists_url": "https://api.github.com/users/brianary/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/brianary",
      "id": 8332839,
      "login": "brianary",
      "node_id": "MDQ6VXNlcjgzMzI4Mzk=",
      "organizations_url": "https://api.github.com/users/brianary/orgs",
      "received_events_url": "https://api.github.com/users/brianary/received_events",
      "repos_url": "https://api.github.com/users/brianary/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/brianary/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brianary/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/brianary"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "I've opened [an RFC](https://github.com/PowerShell/PowerShell-RFC/pull/122) on updating the behaviour of `#requires`. Please feel free to comment in the PR.",
    "created_at": "2018-03-23T18:33:57Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/5022#issuecomment-375760999",
    "id": 375760999,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/5022",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NTc2MDk5OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/375760999/reactions"
    },
    "updated_at": "2018-03-23T18:33:57Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/375760999",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/7009879?v=4",
      "events_url": "https://api.github.com/users/rjmholt/events{/privacy}",
      "followers_url": "https://api.github.com/users/rjmholt/followers",
      "following_url": "https://api.github.com/users/rjmholt/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjmholt/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rjmholt",
      "id": 7009879,
      "login": "rjmholt",
      "node_id": "MDQ6VXNlcjcwMDk4Nzk=",
      "organizations_url": "https://api.github.com/users/rjmholt/orgs",
      "received_events_url": "https://api.github.com/users/rjmholt/received_events",
      "repos_url": "https://api.github.com/users/rjmholt/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rjmholt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjmholt/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rjmholt"
    }
  },
  {
    "author_association": "NONE",
    "body": "This issue has been marked as answered and has not had any activity for **1 day**. It has been closed for housekeeping purposes.",
    "created_at": "2020-01-30T12:00:05Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/5022#issuecomment-580220297",
    "id": 580220297,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/5022",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4MDIyMDI5Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/580220297/reactions"
    },
    "updated_at": "2020-01-30T12:00:05Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/580220297",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  }
]

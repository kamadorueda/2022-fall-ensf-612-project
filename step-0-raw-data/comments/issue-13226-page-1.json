[
  {
    "author_association": "MEMBER",
    "body": "Loop in @PaulHigin for insights.",
    "created_at": "2020-07-22T18:26:16Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13226#issuecomment-662613011",
    "id": 662613011,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13226",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2MjYxMzAxMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/662613011/reactions"
    },
    "updated_at": "2020-07-22T18:26:16Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/662613011",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "This is by design.  Invoke-Command returns a RemoteException that wraps the original CommandNotFoundException as the serialized remote exception.  The ActionPreferenceStopException wraps it yet again.  You can see the original exception by:\r\n\r\n```powershell\r\n$err = Get-Error\r\n$err.ErrorRecord.Exception.SerializedRemoteException\r\n```",
    "created_at": "2020-07-22T20:17:34Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13226#issuecomment-662674260",
    "id": 662674260,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13226",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2MjY3NDI2MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/662674260/reactions"
    },
    "updated_at": "2020-07-22T20:17:34Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/662674260",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/14019529?v=4",
      "events_url": "https://api.github.com/users/PaulHigin/events{/privacy}",
      "followers_url": "https://api.github.com/users/PaulHigin/followers",
      "following_url": "https://api.github.com/users/PaulHigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulHigin/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/PaulHigin",
      "id": 14019529,
      "login": "PaulHigin",
      "node_id": "MDQ6VXNlcjE0MDE5NTI5",
      "organizations_url": "https://api.github.com/users/PaulHigin/orgs",
      "received_events_url": "https://api.github.com/users/PaulHigin/received_events",
      "repos_url": "https://api.github.com/users/PaulHigin/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/PaulHigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulHigin/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/PaulHigin"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@PaulHigin. Yes the original error is wrapped, but it normally - sensibly - still presents _like the original error_.\r\n\r\nAs stated, the nondescript wrapping only happens _if the executable path happens to be a UNC path_.\r\n\r\nContrast the behavior demonstrated in the OP (UNC path) with a local (non-existent) path:\r\n\r\n```powershell\r\n# OK:\r\nPS>  Invoke-Command -ComputerName . { & 'c:\\foo\\bar' }\r\nObjectNotFound: The term 'c:\\foo\\bar' is not recognized as the name of a cmdlet, function, script file, \r\nor operable program. \r\n```",
    "created_at": "2020-07-22T21:07:03Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13226#issuecomment-662696934",
    "id": 662696934,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13226",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2MjY5NjkzNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/662696934/reactions"
    },
    "updated_at": "2020-07-22T21:07:03Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/662696934",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "More equivalently it would be:\r\n```powershell\r\nInvoke-Command -ComputerName . { & 'c:\\foo\\bar' } -ErrorAction Stop\r\nObjectNotFound: The term 'c:\\foo\\bar' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.\r\n\r\n$err = Get-Error\r\n$err.ErrorRecord.FullyQualifiedErrorId\r\nCommandNotFoundException\r\n```\r\nThe problem is that in one case an ErrorRecord is returned and the other a RuntimeException, and seems to be how ErrorAction throws a terminating error.  This appears not be related to Invoke-Command since I can get the same results with this:\r\n\r\n```powershell\r\n& { $ErrorActionPreference = \"Stop\"; & 'c:\\foo\\bar' }\r\n$err = Get-Error\r\n$err.ErrorRecord.FullyQualifiedErrorId\r\nCommandNotFoundException\r\n```",
    "created_at": "2020-07-22T21:37:55Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13226#issuecomment-662710643",
    "id": 662710643,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13226",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2MjcxMDY0Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/662710643/reactions"
    },
    "updated_at": "2020-07-22T21:37:55Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/662710643",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/14019529?v=4",
      "events_url": "https://api.github.com/users/PaulHigin/events{/privacy}",
      "followers_url": "https://api.github.com/users/PaulHigin/followers",
      "following_url": "https://api.github.com/users/PaulHigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulHigin/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/PaulHigin",
      "id": 14019529,
      "login": "PaulHigin",
      "node_id": "MDQ6VXNlcjE0MDE5NTI5",
      "organizations_url": "https://api.github.com/users/PaulHigin/orgs",
      "received_events_url": "https://api.github.com/users/PaulHigin/received_events",
      "repos_url": "https://api.github.com/users/PaulHigin/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/PaulHigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulHigin/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/PaulHigin"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "The only reason I brought `-ErrorAction Stop` into the mix was for the sake of the Pester test, so let's leave it out of the picture.\r\n\r\nTo recapitulate the original concern:\r\n\r\nIf a non-UNC path yields the expected error message on the caller's side:\r\n\r\n```powershell\r\n# OK\r\nPS>  Invoke-Command -ComputerName . { & 'c:\\foo\\bar' }\r\nObjectNotFound: The term 'c:\\foo\\bar' is not recognized as the name of a cmdlet, function, script file, \r\nor operable program. \r\n```\r\n\r\nthen I see no reason why a UNC path should act differently, given that in local, direct invocation the two scenarios yield the _same_ error message:\r\n\r\n```powershell\r\n# !! Unexpectedly yields nondescript error.\r\nPS>  Invoke-Command -ComputerName . { & '\\\\foo\\bar' }\r\nRuntimeException: An error occurred while creating the pipeline.\r\n```\r\n\r\n",
    "created_at": "2020-07-23T02:35:10Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13226#issuecomment-662790950",
    "id": 662790950,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13226",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2Mjc5MDk1MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/662790950/reactions"
    },
    "updated_at": "2020-07-23T02:35:10Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/662790950",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Hmm, I don't see that behavior with my latest local build of 7.1.0-preview.5.  I get the same RemoteErrorRecord error object in each case you show above.  I get the RuntimeException object only if I use `-ErrorAction Stop` or set `$ErrorActionPreference = 'Stop'` as shown in by above examples.",
    "created_at": "2020-07-23T16:21:09Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13226#issuecomment-663101134",
    "id": 663101134,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13226",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2MzEwMTEzNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/663101134/reactions"
    },
    "updated_at": "2020-07-23T16:21:09Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/663101134",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/14019529?v=4",
      "events_url": "https://api.github.com/users/PaulHigin/events{/privacy}",
      "followers_url": "https://api.github.com/users/PaulHigin/followers",
      "following_url": "https://api.github.com/users/PaulHigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulHigin/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/PaulHigin",
      "id": 14019529,
      "login": "PaulHigin",
      "node_id": "MDQ6VXNlcjE0MDE5NTI5",
      "organizations_url": "https://api.github.com/users/PaulHigin/orgs",
      "received_events_url": "https://api.github.com/users/PaulHigin/received_events",
      "repos_url": "https://api.github.com/users/PaulHigin/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/PaulHigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulHigin/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/PaulHigin"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "I just tried again in a loaded-without-profiles elevated preview-5 session with `$ErrorActionPreference` at its default (`Continue`), and I can reliably reproduce the symptom (on Windows 10 version 1909, but I presume that doesn't matter):\r\n\r\n```powershell\r\nPS> icm -cn . { & C:\\no\\such }; '---'; icm -cn . { & \\\\no\\such }\r\n\r\nObjectNotFound: The term 'C:\\no\\such' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.\r\n---\r\nRuntimeException: An error occurred while creating the pipeline.\r\n```\r\n",
    "created_at": "2020-07-25T13:56:09Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13226#issuecomment-663858290",
    "id": 663858290,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13226",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2Mzg1ODI5MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/663858290/reactions"
    },
    "updated_at": "2020-07-25T13:56:09Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/663858290",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  }
]

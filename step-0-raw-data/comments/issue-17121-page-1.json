[
  {
    "author_association": "COLLABORATOR",
    "body": "> ConvertTo-Json (even at max depth) either throws an error or doesn't continue to serialize this much data from a \"simple\" object.\r\n\r\nI wouldn't really call it a simple object. At least without special handling to cherry pick the important properties.\r\n\r\nEspecially once you hit `Exception.TargetSite` you get a whole lot of branching recursive references. Short of hard coding handling for `Exception` I'm not sure what can be done here.",
    "created_at": "2022-04-07T20:29:32Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17121#issuecomment-1092172197",
    "id": 1092172197,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17121",
    "node_id": "IC_kwDOAvT7bc5BGTml",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1092172197/reactions"
    },
    "updated_at": "2022-04-07T20:29:32Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1092172197",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "We kind of blindly fire stuff through `ConvertTo-Json` in PSU and I think that's part of my problem. We've worked around this by using async pipeline processing and terminating the pipe if it doesn't return after a few seconds of serialization. I'll just put some warnings on our docs and stuff (or may right in the UI) about it. \r\n\r\nIt looks like NewtonSoft ignores TargetSite or has some special handling for exceptions. We were using NewtonSoft previously but it doesn't handle PSObjects well. \r\n\r\n```\r\nPS C:\\Users\\adamr> $var = try { invoke } catch { [NewtonSoft.Json.JsonConvert]::SerializeObject($error[0].Exception)  }\r\nPS C:\\Users\\adamr> ConvertFrom-Json $var\r\n\r\nClassName              : System.Management.Automation.CommandNotFoundException\r\nMessage                : The term 'invoke' is not recognized as a name of a cmdlet, function, script file, or\r\n                         executable program.\r\n                         Check the spelling of the name, or if a path was included, verify that the path is correct\r\n                         and try again.\r\nData                   : @{System.Management.Automation.Interpreter.InterpretedFrameInfo,\r\n                         System.Management.Automation, Version=7.2.2.500, Culture=neutral,\r\n                         PublicKeyToken=31bf3856ad364e35=System.Object[]}\r\nInnerException         :\r\nHelpURL                :\r\nStackTraceString       :    at System.Management.Automation.ExceptionHandlingOps.CheckActionPreference(FunctionContext\r\n                         funcContext, Exception exception)\r\n                            at System.Management.Automation.Interpreter.ActionCallInstruction`2.Run(InterpretedFrame\r\n                         frame)\r\n                            at\r\n                         System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame\r\n                         frame)\r\n                            at\r\n                         System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame\r\n                         frame)\r\nRemoteStackTraceString :\r\nRemoteStackIndex       : 0\r\nExceptionMethod        :\r\nHResult                : -2146233087\r\nSource                 : System.Management.Automation\r\nWatsonBuckets          :\r\nErrorId                : RuntimeException\r\nErrorCategory          : 0\r\nCommandName            : invoke\r\n```\r\n\r\nI guess I just didn't really grasp the impact of -Depth 100. It must never reach that depth while trying to serialize the world. \r\n",
    "created_at": "2022-04-07T21:18:13Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17121#issuecomment-1092208363",
    "id": 1092208363,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17121",
    "node_id": "IC_kwDOAvT7bc5BGcbr",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1092208363/reactions"
    },
    "updated_at": "2022-04-07T21:19:03Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1092208363",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/1256531?v=4",
      "events_url": "https://api.github.com/users/adamdriscoll/events{/privacy}",
      "followers_url": "https://api.github.com/users/adamdriscoll/followers",
      "following_url": "https://api.github.com/users/adamdriscoll/following{/other_user}",
      "gists_url": "https://api.github.com/users/adamdriscoll/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/adamdriscoll",
      "id": 1256531,
      "login": "adamdriscoll",
      "node_id": "MDQ6VXNlcjEyNTY1MzE=",
      "organizations_url": "https://api.github.com/users/adamdriscoll/orgs",
      "received_events_url": "https://api.github.com/users/adamdriscoll/received_events",
      "repos_url": "https://api.github.com/users/adamdriscoll/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/adamdriscoll/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/adamdriscoll/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/adamdriscoll"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Found it: https://github.com/JamesNK/Newtonsoft.Json/blob/f7e7bd05d9280f17993500085202ff4ea150564a/Src/Newtonsoft.Json/Serialization/DefaultContractResolver.cs#L302\n\n<blockquote><img src=\"https://opengraph.githubassets.com/e39986999f4a0dd6573e84474d1817be5d9ddfc0b37fd297b65810b5d1aecc67/JamesNK/Newtonsoft.Json\" width=\"48\" align=\"right\"><div><img src=\"https://github.githubassets.com/favicons/favicon.svg\" height=\"14\"> GitHub</div><div><strong><a href=\"https://github.com/JamesNK/Newtonsoft.Json\">Newtonsoft.Json/DefaultContractResolver.cs at f7e7bd05d9280f17993500085202ff4ea150564a · JamesNK/Newtonsoft.Json</a></strong></div><div>Json.NET is a popular high-performance JSON framework for .NET - Newtonsoft.Json/DefaultContractResolver.cs at f7e7bd05d9280f17993500085202ff4ea150564a · JamesNK/Newtonsoft.Json</div></blockquote>",
    "created_at": "2022-04-07T21:21:59Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17121#issuecomment-1092211199",
    "id": 1092211199,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17121",
    "node_id": "IC_kwDOAvT7bc5BGdH_",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1092211199/reactions"
    },
    "updated_at": "2022-04-07T21:22:01Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1092211199",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/1256531?v=4",
      "events_url": "https://api.github.com/users/adamdriscoll/events{/privacy}",
      "followers_url": "https://api.github.com/users/adamdriscoll/followers",
      "following_url": "https://api.github.com/users/adamdriscoll/following{/other_user}",
      "gists_url": "https://api.github.com/users/adamdriscoll/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/adamdriscoll",
      "id": 1256531,
      "login": "adamdriscoll",
      "node_id": "MDQ6VXNlcjEyNTY1MzE=",
      "organizations_url": "https://api.github.com/users/adamdriscoll/orgs",
      "received_events_url": "https://api.github.com/users/adamdriscoll/received_events",
      "repos_url": "https://api.github.com/users/adamdriscoll/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/adamdriscoll/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/adamdriscoll/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/adamdriscoll"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "> I guess I just didn't really grasp the impact of -Depth 100. It must never reach that depth while trying to serialize the world.\r\n\r\nYeah `MethodInfo` has a ton of properties that cycle. Each layer of depth exponentially increases the total tree size. Depth 100 would take *some time* to hit 😁 ",
    "created_at": "2022-04-08T00:41:33Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17121#issuecomment-1092330431",
    "id": 1092330431,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17121",
    "node_id": "IC_kwDOAvT7bc5BG6O_",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1092330431/reactions"
    },
    "updated_at": "2022-04-08T00:41:33Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1092330431",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  }
]

[
  {
    "author_association": "CONTRIBUTOR",
    "body": "`calc.exe` is a GUI-based app and it shouldn't be open at all on the remote computer using the `Invoke-Command`.",
    "created_at": "2019-03-05T17:48:08Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9061#issuecomment-469781670",
    "id": 469781670,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9061",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2OTc4MTY3MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/469781670/reactions"
    },
    "updated_at": "2019-03-05T17:48:08Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/469781670",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/3135708?v=4",
      "events_url": "https://api.github.com/users/alexandair/events{/privacy}",
      "followers_url": "https://api.github.com/users/alexandair/followers",
      "following_url": "https://api.github.com/users/alexandair/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexandair/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/alexandair",
      "id": 3135708,
      "login": "alexandair",
      "node_id": "MDQ6VXNlcjMxMzU3MDg=",
      "organizations_url": "https://api.github.com/users/alexandair/orgs",
      "received_events_url": "https://api.github.com/users/alexandair/received_events",
      "repos_url": "https://api.github.com/users/alexandair/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/alexandair/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexandair/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/alexandair"
    }
  },
  {
    "author_association": "NONE",
    "body": "The real reason is job control and `calc.exe` being a launcher.\r\n\r\nIf you `Invoke-Command -ComputerName RemoteComputer -ScriptBlock { some-app.exe }`, the remote computer will faithfully invoke `some-app.exe`. Let's try these:\r\n\r\n```powershell\r\n$cn = Get-ComputerInfo -Property csname | select -expand csname\r\n$cr = Get-Credential # Input the credential for the interactive user\r\nEnable-PSRemoting -SkipNetworkProfileCheck\r\n\r\nwrite-host 'before 1'\r\nInvoke-Command -ComputerName $cn -Credential $cr -Command { calc; notepad; }\r\nwrite-host 'after 1, before 2'\r\nInvoke-Command -ComputerName $cn -Credential $cr -Command { start notepad -wait; }\r\nwrite-host 'after 2, before 3'\r\nInvoke-Command -ComputerName $cn -Credential $cr -Command { start calc -wait; }\r\nwrite-host 'after 3'\r\n\r\n# revert the settings\r\nDisable-PSRemoting\r\n```\r\n\r\nWhat you will see is:\r\n\r\n1. Calculator opens or does not open.\r\n2. Notepad does not open.\r\n3. Console writes `before 1`.\r\n4. Console writes `after 1, before 2`.\r\n5. A black window opens, which is actually Notepad.\r\n6. After you close the black window, console writes `after 2, before 3`.\r\n7. Calculator opens (another window is opened if Calculator opened in step 1).\r\n8. Console writes `after 3`.\r\n\r\n**The reason**:\r\n\r\n- Commands run remotely are not supposed to be interactive.\r\n- After finishing the command, any subprocesses are terminated because of job control.\r\n- `calc.exe` is not the app itself. It's a launcher for the WinRT version of Calculator. In command 1, it might successfully spawn the subprocess before it's terminated, or not. In command 3, it always succeeds because we waited for it. The real parent process of Calculator (`Calculator.exe`) is `svchost.exe`.\r\n- `notepad.exe` is the app itself. In command 1, it's terminated as soon as it's spawned, having no chance to display its GUI (or you might see a black window flickering). In command 2, its GUI glitches because of incorrect configuration.\r\n\r\nSimilarly, you could open `microsoft-edge:https://bing.com/` with no problem, but you couldn't open `mspaint.exe`.\r\n\r\nIf you are sure your command is being sent to an **interactive** session **with Explorer** (which might be false), and you want to launch a program in the interactive session, you can ask Explorer to do it for you. Use the program found [here](https://blogs.msdn.microsoft.com/oldnewthing/20131118-00/?p=2643/). For example,\r\n\r\n```powershell\r\n# shexp = ShellExecute from Explorer\r\n# the second example elevates notepad.exe\r\nInvoke-Command -ComputerName $cn -Credential $cr -Command {\r\nstart \"$env:USERPROFILE\\documents\\playground\\shexp.exe\" -args 'notepad' -wait\r\nstart \"$env:USERPROFILE\\documents\\playground\\shexp.exe\" -args 'notepad \"\" \"\" runas' -wait\r\n}\r\n```",
    "created_at": "2019-03-08T08:22:03Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9061#issuecomment-470845522",
    "id": 470845522,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9061",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MDg0NTUyMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/470845522/reactions"
    },
    "updated_at": "2019-03-08T08:22:03Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/470845522",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/4462444?v=4",
      "events_url": "https://api.github.com/users/GeeLaw/events{/privacy}",
      "followers_url": "https://api.github.com/users/GeeLaw/followers",
      "following_url": "https://api.github.com/users/GeeLaw/following{/other_user}",
      "gists_url": "https://api.github.com/users/GeeLaw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/GeeLaw",
      "id": 4462444,
      "login": "GeeLaw",
      "node_id": "MDQ6VXNlcjQ0NjI0NDQ=",
      "organizations_url": "https://api.github.com/users/GeeLaw/orgs",
      "received_events_url": "https://api.github.com/users/GeeLaw/received_events",
      "repos_url": "https://api.github.com/users/GeeLaw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/GeeLaw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/GeeLaw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/GeeLaw"
    }
  },
  {
    "author_association": "NONE",
    "body": "This issue has been marked as answered and has not had any activity for **1 day**. It has been closed for housekeeping purposes.",
    "created_at": "2019-06-01T00:00:18Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9061#issuecomment-497893476",
    "id": 497893476,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9061",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5Nzg5MzQ3Ng==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/497893476/reactions"
    },
    "updated_at": "2019-06-01T00:00:18Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/497893476",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  }
]

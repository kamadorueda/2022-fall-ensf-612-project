[
  {
    "author_association": "COLLABORATOR",
    "body": "Do you really mean a file or just redirected (not a tty/console). IIRC, there is logic in the native command processor that computes whether the output is redirected or not. ",
    "created_at": "2017-03-29T20:43:56Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3452#issuecomment-290219777",
    "id": 290219777,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3452",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5MDIxOTc3Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/290219777/reactions"
    },
    "updated_at": "2017-03-29T20:43:56Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/290219777",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6876108?v=4",
      "events_url": "https://api.github.com/users/BrucePay/events{/privacy}",
      "followers_url": "https://api.github.com/users/BrucePay/followers",
      "following_url": "https://api.github.com/users/BrucePay/following{/other_user}",
      "gists_url": "https://api.github.com/users/BrucePay/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/BrucePay",
      "id": 6876108,
      "login": "BrucePay",
      "node_id": "MDQ6VXNlcjY4NzYxMDg=",
      "organizations_url": "https://api.github.com/users/BrucePay/orgs",
      "received_events_url": "https://api.github.com/users/BrucePay/received_events",
      "repos_url": "https://api.github.com/users/BrucePay/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/BrucePay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BrucePay/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/BrucePay"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "I think it depends,\r\n\r\nIf `tmux` or `screen` is using redirection, then you'd still like your escape sequences.\r\nBut if I run `powershell -file script.ps1 > out.txt`, then that's also simple redirection where you don't want escape sequences.\r\n\r\nThe bottom line here is that PowerShell should make it easy (if it isn't already) to support these scenarios in custom formatting, or alternatively strip (some limited) ANSI escape sequences automatically.",
    "created_at": "2017-03-29T21:01:17Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3452#issuecomment-290224594",
    "id": 290224594,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3452",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5MDIyNDU5NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/290224594/reactions"
    },
    "updated_at": "2017-03-29T21:01:17Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/290224594",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/2148248?v=4",
      "events_url": "https://api.github.com/users/lzybkr/events{/privacy}",
      "followers_url": "https://api.github.com/users/lzybkr/followers",
      "following_url": "https://api.github.com/users/lzybkr/following{/other_user}",
      "gists_url": "https://api.github.com/users/lzybkr/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/lzybkr",
      "id": 2148248,
      "login": "lzybkr",
      "node_id": "MDQ6VXNlcjIxNDgyNDg=",
      "organizations_url": "https://api.github.com/users/lzybkr/orgs",
      "received_events_url": "https://api.github.com/users/lzybkr/received_events",
      "repos_url": "https://api.github.com/users/lzybkr/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/lzybkr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lzybkr/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/lzybkr"
    }
  },
  {
    "author_association": "NONE",
    "body": "I've been struggling with this for a little while - I rewrote my `ls` alias to output similar to Linux's `ls -F --color`, but if I forget to write `gci` instead in a pipeline, all sorts of weird things happen.\r\n\r\nAt first I tried calling `GetFileType(GetStdHandle(STD_OUTPUT_HANDLE))` from an `Add-Type` block, but this doesn't work. It seems that PowerShell code in a pipeline doesn't change the actual stdout handle and I can't see anything that exposes the redirection to the script.\r\n\r\nWhen calling native code though, it does replace the handles as you'd expect, so I wrote a small C++ program, which seems to be the only way to tell if a stream is redirected or it's part of a pipeline.\r\n\r\nSince calling a native program does what you'd expect, I can't imagine it'd be too hard to add something like `$MyInvocation.Is<Input|Output|Error>Redirected`.",
    "created_at": "2021-09-24T04:24:02Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3452#issuecomment-926331474",
    "id": 926331474,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3452",
    "node_id": "IC_kwDOAvT7bc43NrJS",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/926331474/reactions"
    },
    "updated_at": "2021-09-24T04:24:02Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/926331474",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/1094150?v=4",
      "events_url": "https://api.github.com/users/parkovski/events{/privacy}",
      "followers_url": "https://api.github.com/users/parkovski/followers",
      "following_url": "https://api.github.com/users/parkovski/following{/other_user}",
      "gists_url": "https://api.github.com/users/parkovski/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/parkovski",
      "id": 1094150,
      "login": "parkovski",
      "node_id": "MDQ6VXNlcjEwOTQxNTA=",
      "organizations_url": "https://api.github.com/users/parkovski/orgs",
      "received_events_url": "https://api.github.com/users/parkovski/received_events",
      "repos_url": "https://api.github.com/users/parkovski/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/parkovski/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/parkovski/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/parkovski"
    }
  }
]

[
  {
    "author_association": "NONE",
    "body": "There is a good detailed blog post on how to implement this in PowerShell today: [Cancelling a Pipeline](http://community.idera.com/powershell/powershell_com_featured_blogs/b/tobias/posts/cancelling-a-pipeline). I think it would be useful to implement something like as a built-in cmdlet.\r\n",
    "created_at": "2017-05-20T00:25:17Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3821#issuecomment-302837990",
    "id": 302837990,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3821",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMjgzNzk5MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/302837990/reactions"
    },
    "updated_at": "2017-05-20T00:25:17Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/302837990",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/20375201?v=4",
      "events_url": "https://api.github.com/users/dragonwolf83/events{/privacy}",
      "followers_url": "https://api.github.com/users/dragonwolf83/followers",
      "following_url": "https://api.github.com/users/dragonwolf83/following{/other_user}",
      "gists_url": "https://api.github.com/users/dragonwolf83/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/dragonwolf83",
      "id": 20375201,
      "login": "dragonwolf83",
      "node_id": "MDQ6VXNlcjIwMzc1MjAx",
      "organizations_url": "https://api.github.com/users/dragonwolf83/orgs",
      "received_events_url": "https://api.github.com/users/dragonwolf83/received_events",
      "repos_url": "https://api.github.com/users/dragonwolf83/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/dragonwolf83/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dragonwolf83/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/dragonwolf83"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Thanks, @dragonwolf83; the blog post's author, Tobias Weltner, is the same person who created the linked uservoice.com issue; the blog post elicited the following @jpsnover  response (dated \"over 7 years ago\"):\r\n\r\n> We have wanted to add pipeline stopping for quite a while and it never got raised above the bar.  \r\n\r\nThat's one lofty bar! :)",
    "created_at": "2017-05-20T01:55:26Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3821#issuecomment-302843719",
    "id": 302843719,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3821",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMjg0MzcxOQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/302843719/reactions"
    },
    "updated_at": "2017-05-20T01:55:26Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/302843719",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "Things that don't necessarily align with the PowerShell Team's priorities (which is not static) can still get done if contributed by the community :)",
    "created_at": "2017-05-20T03:50:57Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3821#issuecomment-302848492",
    "id": 302848492,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3821",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMjg0ODQ5Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 2,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/302848492/reactions"
    },
    "updated_at": "2017-05-20T03:50:57Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/302848492",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "We need RFC for new cmdlet and examples of how to use the cmdlet.",
    "created_at": "2017-05-20T16:10:19Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3821#issuecomment-302882538",
    "id": 302882538,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3821",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMjg4MjUzOA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/302882538/reactions"
    },
    "updated_at": "2017-05-20T16:10:19Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/302882538",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "Does anyone have a working link to Tobias' blog post mentioned above?  That link seems to be dead.",
    "created_at": "2018-01-01T18:27:43Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3821#issuecomment-354667959",
    "id": 354667959,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3821",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NDY2Nzk1OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/354667959/reactions"
    },
    "updated_at": "2018-01-01T18:27:43Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/354667959",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11237922?v=4",
      "events_url": "https://api.github.com/users/alx9r/events{/privacy}",
      "followers_url": "https://api.github.com/users/alx9r/followers",
      "following_url": "https://api.github.com/users/alx9r/following{/other_user}",
      "gists_url": "https://api.github.com/users/alx9r/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/alx9r",
      "id": 11237922,
      "login": "alx9r",
      "node_id": "MDQ6VXNlcjExMjM3OTIy",
      "organizations_url": "https://api.github.com/users/alx9r/orgs",
      "received_events_url": "https://api.github.com/users/alx9r/received_events",
      "repos_url": "https://api.github.com/users/alx9r/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/alx9r/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alx9r/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/alx9r"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Here‘s some material: http://www.powertheshell.com/stop_pipeline/",
    "created_at": "2018-01-02T10:41:27Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3821#issuecomment-354739868",
    "id": 354739868,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3821",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NDczOTg2OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/354739868/reactions"
    },
    "updated_at": "2018-01-02T10:41:27Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/354739868",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/20953725?v=4",
      "events_url": "https://api.github.com/users/TobiasPSP/events{/privacy}",
      "followers_url": "https://api.github.com/users/TobiasPSP/followers",
      "following_url": "https://api.github.com/users/TobiasPSP/following{/other_user}",
      "gists_url": "https://api.github.com/users/TobiasPSP/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/TobiasPSP",
      "id": 20953725,
      "login": "TobiasPSP",
      "node_id": "MDQ6VXNlcjIwOTUzNzI1",
      "organizations_url": "https://api.github.com/users/TobiasPSP/orgs",
      "received_events_url": "https://api.github.com/users/TobiasPSP/received_events",
      "repos_url": "https://api.github.com/users/TobiasPSP/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/TobiasPSP/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TobiasPSP/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/TobiasPSP"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Adding `Needs-Triage` so `WG-Engine` can discuss it. This comes up surprisingly often. Typically for profile functions, but still. The lengths one has to go through to get the same behavior is pretty wild (and unsupported).\r\n\r\nMy proposal:\r\n\r\n```diff\r\n  namespace System.Management.Automation\r\n  {\r\n      public abstract class PSCmdlet\r\n      {\r\n+         [DoesNotReturn]\r\n+         public void StopUpstreamCommands();\r\n      }\r\n  }\r\n```\r\n\r\nIf added this should be tested both for binary cmdlets (`this.StopUpstreamCommands()`) and script cmdlets (`$PSCmdlet.StopUpstreamCommands()`)",
    "created_at": "2022-06-20T16:49:55Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3821#issuecomment-1160662810",
    "id": 1160662810,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3821",
    "node_id": "IC_kwDOAvT7bc5FLk8a",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 6,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 6,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1160662810/reactions"
    },
    "updated_at": "2022-06-20T16:51:29Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1160662810",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "WG-Engine discussed this today (6/23/2022).\r\n\r\nWe agree that users should have access to this functionality in some way that is not exclusive to `Select-Object`. It came up in discussion that there may be undesirable elements of the current behaviour of `Select-Object -First $x`; for instance, it doesn't appear to call upstream C# cmdlets' `StopProcessing()` when it cancels the remainder of a pipeline.\r\n\r\nWe need more investigation on whether this behaviour would be problematic to expose as a commonly usable API, and whether we should:\r\n\r\n- Make changes to the existing behaviour of the pipeline's handling of `StopUpstreamCommandsException`, and/or:\r\n  - Expose the same `Select-Object -First $x` behaviour as-is as a public API similar to the suggestions in this issue, or\r\n  - Expose a new public API that handles the stop upstream commands request somewhat differently to the current method used for `Select-Object -First $x`",
    "created_at": "2022-06-23T20:43:31Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3821#issuecomment-1164855541",
    "id": 1164855541,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3821",
    "node_id": "IC_kwDOAvT7bc5Fbkj1",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1164855541/reactions"
    },
    "updated_at": "2022-06-23T21:04:36Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1164855541",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/32407840?v=4",
      "events_url": "https://api.github.com/users/vexx32/events{/privacy}",
      "followers_url": "https://api.github.com/users/vexx32/followers",
      "following_url": "https://api.github.com/users/vexx32/following{/other_user}",
      "gists_url": "https://api.github.com/users/vexx32/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vexx32",
      "id": 32407840,
      "login": "vexx32",
      "node_id": "MDQ6VXNlcjMyNDA3ODQw",
      "organizations_url": "https://api.github.com/users/vexx32/orgs",
      "received_events_url": "https://api.github.com/users/vexx32/received_events",
      "repos_url": "https://api.github.com/users/vexx32/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vexx32/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vexx32/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vexx32"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "I went through every command that overrides `StopProcessing` but does not implement `IDisposable` with this command:\r\n\r\n```powershell\r\nFind-Type -Base System.Management.Automation.PSCmdlet |\r\n    Find-Type -Not -ImplementsInterface System.IDisposable |\r\n    Find-Member StopProcessing -Force -Declared |\r\n    ForEach-Object {\r\n        dnSpy.Console.exe $_.Module.Assembly.Location --md $_.MetadataToken --no-tokens |\r\n            bat --language cs --style 'grid,numbers,snip'\r\n\r\n        Read-Host -Prompt 'Press enter to continue'\r\n    }\r\n```\r\n\r\nOf all of them I found only one command that is using `StopProcessing` for resource cleanup (`Get-Counter`).\r\n\r\nI would recommend we just fix `Get-Counter` as pipeline terminating errors, `Select-Object -First 1` and pipeline stop exceptions thrown outside of stop requests will already cause a leak here.",
    "created_at": "2022-06-24T15:06:47Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3821#issuecomment-1165666151",
    "id": 1165666151,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3821",
    "node_id": "IC_kwDOAvT7bc5Feqdn",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1165666151/reactions"
    },
    "updated_at": "2022-06-24T15:06:47Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1165666151",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  }
]

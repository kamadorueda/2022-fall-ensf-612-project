[
  {
    "author_association": "NONE",
    "body": "This \r\n```\r\n>  Add-Type -AssemblyName System.Runtime.WindowsRuntime\r\n> $asTaskGeneric = ([System.WindowsRuntimeSystemExtensions].GetMethods() | ? { $_.Name -eq 'AsTask' -and $_.GetParameters().Count -eq 1 -and $_.GetParameters()[0].ParameterType.Name -eq 'IAsyncOperation`1' })[0]\r\n\r\nMethodInvocationException: Exception calling \"GetParameters\" with \"0\" argument(s): \"Operation is not supported on this \r\nplatform. (0x80131539)\"\r\n```\r\n\r\nsuggests you've cut and pasted something tied to .NET Framework 4 into the .NET 6. version of PowerShell. \r\n\r\nIt simplifies to \r\n```\r\n> $asTaskMethods = [System.WindowsRuntimeSystemExtensions].GetMethods()  | where-object name -eq 'AsTask'                                                                                                         > $asTaskMethods[0].GetParameters()\r\nMethodInvocationException: Exception calling \"GetParameters\" with \"0\" argument(s): \"Operation is not supported on this platform. (0x80131539)\"\r\n``` \r\n\r\nAnd the equivalent in C# would give the same error if compiled with the current .NET. \r\n\r\n\r\n\r\n\r\n",
    "created_at": "2022-01-11T16:53:54Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16731#issuecomment-1010163394",
    "id": 1010163394,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16731",
    "node_id": "IC_kwDOAvT7bc48Nd7C",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010163394/reactions"
    },
    "updated_at": "2022-01-11T16:53:54Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010163394",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/16209593?v=4",
      "events_url": "https://api.github.com/users/jhoneill/events{/privacy}",
      "followers_url": "https://api.github.com/users/jhoneill/followers",
      "following_url": "https://api.github.com/users/jhoneill/following{/other_user}",
      "gists_url": "https://api.github.com/users/jhoneill/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jhoneill",
      "id": 16209593,
      "login": "jhoneill",
      "node_id": "MDQ6VXNlcjE2MjA5NTkz",
      "organizations_url": "https://api.github.com/users/jhoneill/orgs",
      "received_events_url": "https://api.github.com/users/jhoneill/received_events",
      "repos_url": "https://api.github.com/users/jhoneill/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jhoneill/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jhoneill/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jhoneill"
    }
  },
  {
    "author_association": "NONE",
    "body": "Fine, but how to I set inside the PowerShell script to use .NET version 4.x instead? Or just autodetect?",
    "created_at": "2022-01-11T16:56:13Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16731#issuecomment-1010165524",
    "id": 1010165524,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16731",
    "node_id": "IC_kwDOAvT7bc48NecU",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010165524/reactions"
    },
    "updated_at": "2022-01-11T16:56:13Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010165524",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8339596?v=4",
      "events_url": "https://api.github.com/users/superbonaci/events{/privacy}",
      "followers_url": "https://api.github.com/users/superbonaci/followers",
      "following_url": "https://api.github.com/users/superbonaci/following{/other_user}",
      "gists_url": "https://api.github.com/users/superbonaci/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/superbonaci",
      "id": 8339596,
      "login": "superbonaci",
      "node_id": "MDQ6VXNlcjgzMzk1OTY=",
      "organizations_url": "https://api.github.com/users/superbonaci/orgs",
      "received_events_url": "https://api.github.com/users/superbonaci/received_events",
      "repos_url": "https://api.github.com/users/superbonaci/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/superbonaci/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/superbonaci/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/superbonaci"
    }
  },
  {
    "author_association": "NONE",
    "body": "> It simplifies to\r\n\r\nLines\r\n````\r\nAdd-Type -AssemblyName System.Runtime.WindowsRuntime\r\n$asTaskGeneric = ([System.WindowsRuntimeSystemExtensions].GetMethods() | ? { $_.Name -eq 'AsTask' -and $_.GetParameters().Count -eq 1 -and $_.GetParameters()[0].ParameterType.Name -eq 'IAsyncOperation`1' })[0]\r\n````\r\nand\r\n````\r\n$asTaskMethods = [System.WindowsRuntimeSystemExtensions].GetMethods()  | where-object name -eq 'AsTask'\r\n````\r\n\r\nare not equivalent:\r\n````\r\n.\\Set-bluetooth.ps1\r\n\r\ncmdlet Set-bluetooth.ps1 at command pipeline position 1\r\nSupply values for the following parameters:\r\nBluetoothStatus: On\r\nYou cannot call a method on a null-valued expression.\r\nAt C:\\bin\\Set-bluetooth.ps1:7 char:5\r\n+     $asTask = $asTaskGeneric.MakeGenericMethod($ResultType)\r\n+     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    + CategoryInfo          : InvalidOperation: (:) [], RuntimeException\r\n    + FullyQualifiedErrorId : InvokeMethodOnNull\r\n\r\nYou cannot call a method on a null-valued expression.\r\nAt C:\\bin\\Set-bluetooth.ps1:8 char:5\r\n+     $netTask = $asTask.Invoke($null, @($WinRtTask))\r\n+     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    + CategoryInfo          : InvalidOperation: (:) [], RuntimeException\r\n    + FullyQualifiedErrorId : InvokeMethodOnNull\r\n\r\nYou cannot call a method on a null-valued expression.\r\nAt C:\\bin\\Set-bluetooth.ps1:9 char:5\r\n+     $netTask.Wait(-1) | Out-Null\r\n+     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    + CategoryInfo          : InvalidOperation: (:) [], RuntimeException\r\n    + FullyQualifiedErrorId : InvokeMethodOnNull\r\n\r\nYou cannot call a method on a null-valued expression.\r\nAt C:\\bin\\Set-bluetooth.ps1:7 char:5\r\n+     $asTask = $asTaskGeneric.MakeGenericMethod($ResultType)\r\n+     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    + CategoryInfo          : InvalidOperation: (:) [], RuntimeException\r\n    + FullyQualifiedErrorId : InvokeMethodOnNull\r\n\r\nYou cannot call a method on a null-valued expression.\r\nAt C:\\bin\\Set-bluetooth.ps1:8 char:5\r\n+     $netTask = $asTask.Invoke($null, @($WinRtTask))\r\n+     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    + CategoryInfo          : InvalidOperation: (:) [], RuntimeException\r\n    + FullyQualifiedErrorId : InvokeMethodOnNull\r\n\r\nYou cannot call a method on a null-valued expression.\r\nAt C:\\bin\\Set-bluetooth.ps1:9 char:5\r\n+     $netTask.Wait(-1) | Out-Null\r\n+     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    + CategoryInfo          : InvalidOperation: (:) [], RuntimeException\r\n    + FullyQualifiedErrorId : InvokeMethodOnNull\r\n\r\nYou cannot call a method on a null-valued expression.\r\nAt C:\\bin\\Set-bluetooth.ps1:18 char:1\r\n+ Await ($bluetooth.SetStateAsync($BluetoothStatus)) ([Windows.Devices. ...\r\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    + CategoryInfo          : InvalidOperation: (:) [], RuntimeException\r\n    + FullyQualifiedErrorId : InvokeMethodOnNull\r\n````\r\nPlease make tests before reporting invalid bugs.",
    "created_at": "2022-01-11T17:13:58Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16731#issuecomment-1010181788",
    "id": 1010181788,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16731",
    "node_id": "IC_kwDOAvT7bc48Niac",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010181788/reactions"
    },
    "updated_at": "2022-01-11T17:15:35Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010181788",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8339596?v=4",
      "events_url": "https://api.github.com/users/superbonaci/events{/privacy}",
      "followers_url": "https://api.github.com/users/superbonaci/followers",
      "following_url": "https://api.github.com/users/superbonaci/following{/other_user}",
      "gists_url": "https://api.github.com/users/superbonaci/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/superbonaci",
      "id": 8339596,
      "login": "superbonaci",
      "node_id": "MDQ6VXNlcjgzMzk1OTY=",
      "organizations_url": "https://api.github.com/users/superbonaci/orgs",
      "received_events_url": "https://api.github.com/users/superbonaci/received_events",
      "repos_url": "https://api.github.com/users/superbonaci/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/superbonaci/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/superbonaci/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/superbonaci"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "It is know issue. WinRT support was removed from .Net 6.0 and as result from PowerShell 7.2 too.",
    "created_at": "2022-01-11T17:23:01Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16731#issuecomment-1010189698",
    "id": 1010189698,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16731",
    "node_id": "IC_kwDOAvT7bc48NkWC",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010189698/reactions"
    },
    "updated_at": "2022-01-11T17:23:01Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010189698",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "How can I tell PowerShell to use .NET 4.x from inside the script instead of \"default\" 6.x?",
    "created_at": "2022-01-11T17:25:47Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16731#issuecomment-1010192150",
    "id": 1010192150,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16731",
    "node_id": "IC_kwDOAvT7bc48Nk8W",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010192150/reactions"
    },
    "updated_at": "2022-01-11T17:25:47Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010192150",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8339596?v=4",
      "events_url": "https://api.github.com/users/superbonaci/events{/privacy}",
      "followers_url": "https://api.github.com/users/superbonaci/followers",
      "following_url": "https://api.github.com/users/superbonaci/following{/other_user}",
      "gists_url": "https://api.github.com/users/superbonaci/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/superbonaci",
      "id": 8339596,
      "login": "superbonaci",
      "node_id": "MDQ6VXNlcjgzMzk1OTY=",
      "organizations_url": "https://api.github.com/users/superbonaci/orgs",
      "received_events_url": "https://api.github.com/users/superbonaci/received_events",
      "repos_url": "https://api.github.com/users/superbonaci/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/superbonaci/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/superbonaci/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/superbonaci"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Only way is to run Windows PowerShell.\r\n\r\nPS: there is separate project to support WinRT in .Net but MSFT PowerShell team want to keep PowerShell as small as possible so we could expect WinRT support will be added as an optional component/module in future.",
    "created_at": "2022-01-11T17:31:10Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16731#issuecomment-1010196674",
    "id": 1010196674,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16731",
    "node_id": "IC_kwDOAvT7bc48NmDC",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010196674/reactions"
    },
    "updated_at": "2022-01-11T17:31:10Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010196674",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "Can I run Windows PowerShell from inside the ps1 script?\r\nSo when I call `.\\Set-bluetooth.ps1` it autodetects if must run Windows Powershell or Powershell Core.",
    "created_at": "2022-01-11T17:36:08Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16731#issuecomment-1010200742",
    "id": 1010200742,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16731",
    "node_id": "IC_kwDOAvT7bc48NnCm",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010200742/reactions"
    },
    "updated_at": "2022-01-11T17:36:08Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010200742",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8339596?v=4",
      "events_url": "https://api.github.com/users/superbonaci/events{/privacy}",
      "followers_url": "https://api.github.com/users/superbonaci/followers",
      "following_url": "https://api.github.com/users/superbonaci/following{/other_user}",
      "gists_url": "https://api.github.com/users/superbonaci/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/superbonaci",
      "id": 8339596,
      "login": "superbonaci",
      "node_id": "MDQ6VXNlcjgzMzk1OTY=",
      "organizations_url": "https://api.github.com/users/superbonaci/orgs",
      "received_events_url": "https://api.github.com/users/superbonaci/received_events",
      "repos_url": "https://api.github.com/users/superbonaci/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/superbonaci/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/superbonaci/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/superbonaci"
    }
  },
  {
    "author_association": "NONE",
    "body": "> Please make tests before reporting invalid bugs.\r\n@superbonaci  you might want to heed your own advice\r\n\r\nHere is your error\r\n```\r\n$asTask = $asTaskGeneric.MakeGenericMethod($ResultType)\r\n\r\nYou cannot call a method on a null-valued expression.\r\n```\r\n\r\nWhat method is being called, and what expression is null-valued ?   It's `$asTaskGeneric`.    \r\nSo where is `$asTaskGeneric`  set ? \r\n\r\n```\r\nps >   Add-Type -AssemblyName System.Runtime.WindowsRuntime\r\nps >    $asTaskGeneric = ([System.WindowsRuntimeSystemExtensions].GetMethods() | ? { $_.Name -eq 'AsTask' -and $_.GetParameters().Count -eq 1 -and $_.GetParameters()[0].ParameterType.Name -eq 'IAsyncOperation`1' })[0]\r\n```\r\nIf I paste those into PowerShell 7.2.1 I get multiple instances of \r\n\r\n```\r\nMethodInvocationException: Exception calling \"GetParameters\" with \"0\" argument(s): \"Operation is not supported on this \r\nplatform. (0x80131539)\"\r\n``` \r\n\r\nOK. \r\nSo lets see where the second line breaks, \r\n```\r\nps >   $one = [System.WindowsRuntimeSystemExtensions].GetMethods()  \r\n```\r\nOK\r\n```\r\nps >  $two =  $one | ? { $_.Name -eq 'AsTask'}\r\n```\r\nOK\r\n```\r\nps > $three = $two | ? {$_.GetParameters().Count -eq 1}\r\n\r\nMethodInvocationException: Exception calling \"GetParameters\" with \"0\" argument(s): \"Operation is not supported on this platform. (0x80131539)\"\r\n```\r\n\r\n\r\n> How can I tell PowerShell to use .NET 4.x from inside the script instead of \"default\" 6.x?\r\n\r\n.NET 6 is hard wired into PowerShell 7.2 , just as Dot net framework 4 is hardwired into Windows PowerShell 5.1\r\n\r\nI can't find where I used it but somewhere I have some code like this \r\n\r\n```\r\nif ($PSVersionTable.PSVersion -ge \"6.0.0\") {\r\n    powershell.exe $MyInvocation.Line  \r\n    return\r\n}\r\n``` \r\nWhich will run the same ps1 with the same parameters in the other version of PowerShell. \r\n\r\n\r\n\r\n\r\n\r\n",
    "created_at": "2022-01-11T17:36:49Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16731#issuecomment-1010201304",
    "id": 1010201304,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16731",
    "node_id": "IC_kwDOAvT7bc48NnLY",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010201304/reactions"
    },
    "updated_at": "2022-01-11T17:36:49Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010201304",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/16209593?v=4",
      "events_url": "https://api.github.com/users/jhoneill/events{/privacy}",
      "followers_url": "https://api.github.com/users/jhoneill/followers",
      "following_url": "https://api.github.com/users/jhoneill/following{/other_user}",
      "gists_url": "https://api.github.com/users/jhoneill/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jhoneill",
      "id": 16209593,
      "login": "jhoneill",
      "node_id": "MDQ6VXNlcjE2MjA5NTkz",
      "organizations_url": "https://api.github.com/users/jhoneill/orgs",
      "received_events_url": "https://api.github.com/users/jhoneill/received_events",
      "repos_url": "https://api.github.com/users/jhoneill/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jhoneill/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jhoneill/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jhoneill"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "You may be able to do this:\r\n\r\n```powershell\r\n$session = New-PSSession -UseWindowsPowerShell\r\nInvoke-Command -Session $session {\r\n    code here\r\n}\r\n```",
    "created_at": "2022-01-11T17:37:22Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16731#issuecomment-1010201762",
    "id": 1010201762,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16731",
    "node_id": "IC_kwDOAvT7bc48NnSi",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010201762/reactions"
    },
    "updated_at": "2022-01-11T17:37:22Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010201762",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  },
  {
    "author_association": "NONE",
    "body": "@SeeminglyScience what happens if I am running that script inside PowerShell 7.x and `Windows PowerShell` is removed in a future Windows 11 update? Would that script fail?",
    "created_at": "2022-01-11T17:38:34Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16731#issuecomment-1010202768",
    "id": 1010202768,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16731",
    "node_id": "IC_kwDOAvT7bc48NniQ",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010202768/reactions"
    },
    "updated_at": "2022-01-11T17:38:34Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010202768",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8339596?v=4",
      "events_url": "https://api.github.com/users/superbonaci/events{/privacy}",
      "followers_url": "https://api.github.com/users/superbonaci/followers",
      "following_url": "https://api.github.com/users/superbonaci/following{/other_user}",
      "gists_url": "https://api.github.com/users/superbonaci/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/superbonaci",
      "id": 8339596,
      "login": "superbonaci",
      "node_id": "MDQ6VXNlcjgzMzk1OTY=",
      "organizations_url": "https://api.github.com/users/superbonaci/orgs",
      "received_events_url": "https://api.github.com/users/superbonaci/received_events",
      "repos_url": "https://api.github.com/users/superbonaci/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/superbonaci/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/superbonaci/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/superbonaci"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "> what happens if I am running that script inside PowerShell 7.x and Windows PowerShell is removed in a future Windows 11 update? Would that script fail?\r\n\r\n@superbonaci  - that is almost never going to happen as it is part of the OS and whilst **may** become an optional feature, will be supported for at least another 10 years due to the Windows support lifecycle",
    "created_at": "2022-01-11T17:44:10Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16731#issuecomment-1010207986",
    "id": 1010207986,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16731",
    "node_id": "IC_kwDOAvT7bc48Nozy",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010207986/reactions"
    },
    "updated_at": "2022-01-11T17:44:10Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010207986",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6355225?v=4",
      "events_url": "https://api.github.com/users/kilasuit/events{/privacy}",
      "followers_url": "https://api.github.com/users/kilasuit/followers",
      "following_url": "https://api.github.com/users/kilasuit/following{/other_user}",
      "gists_url": "https://api.github.com/users/kilasuit/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/kilasuit",
      "id": 6355225,
      "login": "kilasuit",
      "node_id": "MDQ6VXNlcjYzNTUyMjU=",
      "organizations_url": "https://api.github.com/users/kilasuit/orgs",
      "received_events_url": "https://api.github.com/users/kilasuit/received_events",
      "repos_url": "https://api.github.com/users/kilasuit/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/kilasuit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kilasuit/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/kilasuit"
    }
  },
  {
    "author_association": "NONE",
    "body": "> You may be able to do this:\r\n> \r\n> ```powershell\r\n> $session = New-PSSession -UseWindowsPowerShell\r\n> Invoke-Command -Session $session {\r\n>     code here\r\n> }\r\n> ```\r\n\r\nYour code works now if the script is run inside PowerShell Core 7.x, however is not backwards compatible with Windows PowerShell. It must be backward compatible:\r\n````\r\n$PSVersionTable\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      5.1.22000.282\r\nPSEdition                      Desktop\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\r\nBuildVersion                   10.0.22000.282\r\nCLRVersion                     4.0.30319.42000\r\nWSManStackVersion              3.0\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\n````\r\n````\r\n .\\bluetooth.ps1\r\nNew-PSSession : A parameter cannot be found that matches parameter name 'UseWindowsPowerShell'.\r\nAt C:\\bin\\bluetooth.ps1:1 char:26\r\n+ $session = New-PSSession -UseWindowsPowerShell\r\n+                          ~~~~~~~~~~~~~~~~~~~~~\r\n    + CategoryInfo          : InvalidArgument: (:) [New-PSSession], ParameterBindingException\r\n    + FullyQualifiedErrorId : NamedParameterNotFound,Microsoft.PowerShell.Commands.NewPSSessionCommand\r\n\r\nInvoke-Command : Cannot validate argument on parameter 'Session'. The argument is null or empty. Provide an argument that is not null or empty, and then try the command again.\r\nAt C:\\bin\\bluetooth.ps1:2 char:25\r\n+ Invoke-Command -Session $session {\r\n+                         ~~~~~~~~\r\n    + CategoryInfo          : InvalidData: (:) [Invoke-Command], ParameterBindingValidationException\r\n    + FullyQualifiedErrorId : ParameterArgumentValidationError,Microsoft.PowerShell.Commands.InvokeCommandCommand\r\n````",
    "created_at": "2022-01-11T17:46:28Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16731#issuecomment-1010209822",
    "id": 1010209822,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16731",
    "node_id": "IC_kwDOAvT7bc48NpQe",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010209822/reactions"
    },
    "updated_at": "2022-01-11T17:46:28Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010209822",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8339596?v=4",
      "events_url": "https://api.github.com/users/superbonaci/events{/privacy}",
      "followers_url": "https://api.github.com/users/superbonaci/followers",
      "following_url": "https://api.github.com/users/superbonaci/following{/other_user}",
      "gists_url": "https://api.github.com/users/superbonaci/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/superbonaci",
      "id": 8339596,
      "login": "superbonaci",
      "node_id": "MDQ6VXNlcjgzMzk1OTY=",
      "organizations_url": "https://api.github.com/users/superbonaci/orgs",
      "received_events_url": "https://api.github.com/users/superbonaci/received_events",
      "repos_url": "https://api.github.com/users/superbonaci/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/superbonaci/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/superbonaci/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/superbonaci"
    }
  },
  {
    "author_association": "NONE",
    "body": "They haven't removed cmd.exe or Wscript yet, so it's a bit early to be worrying about Windows PowerShell being removed.   \r\n\r\n@SeeminglyScience   that's good if you know the script will run in 7.2 but it won't run natively on 5. That's why I dropped back\r\nto saying \"run the same command line in PowerShell.exe\" and if the script is in the middle of a pipeline that won't work. \r\n\r\n@superbonaci  see the end of my previous comment for how to do that. \r\n\r\n\r\n\r\n  ",
    "created_at": "2022-01-11T17:48:21Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16731#issuecomment-1010211404",
    "id": 1010211404,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16731",
    "node_id": "IC_kwDOAvT7bc48NppM",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010211404/reactions"
    },
    "updated_at": "2022-01-11T17:48:21Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010211404",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/16209593?v=4",
      "events_url": "https://api.github.com/users/jhoneill/events{/privacy}",
      "followers_url": "https://api.github.com/users/jhoneill/followers",
      "following_url": "https://api.github.com/users/jhoneill/following{/other_user}",
      "gists_url": "https://api.github.com/users/jhoneill/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jhoneill",
      "id": 16209593,
      "login": "jhoneill",
      "node_id": "MDQ6VXNlcjE2MjA5NTkz",
      "organizations_url": "https://api.github.com/users/jhoneill/orgs",
      "received_events_url": "https://api.github.com/users/jhoneill/received_events",
      "repos_url": "https://api.github.com/users/jhoneill/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jhoneill/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jhoneill/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jhoneill"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "> Your code works now if the script is run inside PowerShell Core 7.x, however is not backwards compatible with Windows PowerShell. It must be backward compatible:\r\n\r\nYeah for sure, I'm just offering a work around. You'll need to apply it selectively with version checks if you want it to run no matter what executable it's invoked in.\r\n\r\nThe main issue of WinRT support being dropped is discussed in more detail in #13138.",
    "created_at": "2022-01-11T17:58:06Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16731#issuecomment-1010219128",
    "id": 1010219128,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16731",
    "node_id": "IC_kwDOAvT7bc48Nrh4",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010219128/reactions"
    },
    "updated_at": "2022-01-11T17:58:06Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010219128",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  },
  {
    "author_association": "NONE",
    "body": "> ```\r\n> if ($PSVersionTable.PSVersion -ge \"6.0.0\") {\r\n>     powershell.exe $MyInvocation.Line  \r\n>     return\r\n> }\r\n> ```\r\n> \r\n> Which will run the same ps1 with the same parameters in the other version of PowerShell.\r\n\r\nHow can I convert all existing code to a function?\r\n````\r\nif ($PSVersionTable.PSVersion -ge \"6.0.0\") {\r\n    powershell.exe callcode()\r\n    return\r\n}\r\n\r\ncallcode(){\r\n    original code\r\n}\r\n````\r\nso `callcode()` just runs the existing code pasted in 1st post?",
    "created_at": "2022-01-11T18:12:22Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16731#issuecomment-1010230766",
    "id": 1010230766,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16731",
    "node_id": "IC_kwDOAvT7bc48NuXu",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010230766/reactions"
    },
    "updated_at": "2022-01-11T18:12:59Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010230766",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8339596?v=4",
      "events_url": "https://api.github.com/users/superbonaci/events{/privacy}",
      "followers_url": "https://api.github.com/users/superbonaci/followers",
      "following_url": "https://api.github.com/users/superbonaci/following{/other_user}",
      "gists_url": "https://api.github.com/users/superbonaci/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/superbonaci",
      "id": 8339596,
      "login": "superbonaci",
      "node_id": "MDQ6VXNlcjgzMzk1OTY=",
      "organizations_url": "https://api.github.com/users/superbonaci/orgs",
      "received_events_url": "https://api.github.com/users/superbonaci/received_events",
      "repos_url": "https://api.github.com/users/superbonaci/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/superbonaci/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/superbonaci/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/superbonaci"
    }
  },
  {
    "author_association": "NONE",
    "body": "> How can I convert all existing code to a function?\r\n\r\nJust insert this checking after param block.",
    "created_at": "2022-01-11T18:54:48Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16731#issuecomment-1010264389",
    "id": 1010264389,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16731",
    "node_id": "IC_kwDOAvT7bc48N2lF",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010264389/reactions"
    },
    "updated_at": "2022-01-11T18:54:48Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010264389",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/78153320?v=4",
      "events_url": "https://api.github.com/users/237dmitry/events{/privacy}",
      "followers_url": "https://api.github.com/users/237dmitry/followers",
      "following_url": "https://api.github.com/users/237dmitry/following{/other_user}",
      "gists_url": "https://api.github.com/users/237dmitry/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/237dmitry",
      "id": 78153320,
      "login": "237dmitry",
      "node_id": "MDQ6VXNlcjc4MTUzMzIw",
      "organizations_url": "https://api.github.com/users/237dmitry/orgs",
      "received_events_url": "https://api.github.com/users/237dmitry/received_events",
      "repos_url": "https://api.github.com/users/237dmitry/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/237dmitry/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/237dmitry/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/237dmitry"
    }
  },
  {
    "author_association": "NONE",
    "body": "> > How can I convert all existing code to a function?\r\n> \r\n> Just insert this checking after param block.\r\n\r\nHow would the code look like?",
    "created_at": "2022-01-11T19:08:39Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16731#issuecomment-1010275509",
    "id": 1010275509,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16731",
    "node_id": "IC_kwDOAvT7bc48N5S1",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010275509/reactions"
    },
    "updated_at": "2022-01-11T19:08:39Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010275509",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8339596?v=4",
      "events_url": "https://api.github.com/users/superbonaci/events{/privacy}",
      "followers_url": "https://api.github.com/users/superbonaci/followers",
      "following_url": "https://api.github.com/users/superbonaci/following{/other_user}",
      "gists_url": "https://api.github.com/users/superbonaci/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/superbonaci",
      "id": 8339596,
      "login": "superbonaci",
      "node_id": "MDQ6VXNlcjgzMzk1OTY=",
      "organizations_url": "https://api.github.com/users/superbonaci/orgs",
      "received_events_url": "https://api.github.com/users/superbonaci/received_events",
      "repos_url": "https://api.github.com/users/superbonaci/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/superbonaci/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/superbonaci/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/superbonaci"
    }
  },
  {
    "author_association": "NONE",
    "body": "> How would the code look like?\r\n```\r\n[CmdletBinding()] Param (\r\n    [Parameter(Mandatory=$true)][ValidateSet('Off', 'On')][string]$BluetoothStatus\r\n)\r\n\r\nif ($PSEdition -eq 'Core') {\r\n    powershell.exe $MyInvocation.Line\r\n    return\r\n}\r\n...\r\n```",
    "created_at": "2022-01-11T19:48:33Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16731#issuecomment-1010306290",
    "id": 1010306290,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16731",
    "node_id": "IC_kwDOAvT7bc48OAzy",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010306290/reactions"
    },
    "updated_at": "2022-01-11T19:48:33Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010306290",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/78153320?v=4",
      "events_url": "https://api.github.com/users/237dmitry/events{/privacy}",
      "followers_url": "https://api.github.com/users/237dmitry/followers",
      "following_url": "https://api.github.com/users/237dmitry/following{/other_user}",
      "gists_url": "https://api.github.com/users/237dmitry/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/237dmitry",
      "id": 78153320,
      "login": "237dmitry",
      "node_id": "MDQ6VXNlcjc4MTUzMzIw",
      "organizations_url": "https://api.github.com/users/237dmitry/orgs",
      "received_events_url": "https://api.github.com/users/237dmitry/received_events",
      "repos_url": "https://api.github.com/users/237dmitry/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/237dmitry/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/237dmitry/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/237dmitry"
    }
  },
  {
    "author_association": "NONE",
    "body": "> > How would the code look like?\r\n> \r\n> ```\r\n> [CmdletBinding()] Param (\r\n>     [Parameter(Mandatory=$true)][ValidateSet('Off', 'On')][string]$BluetoothStatus\r\n> )\r\n> \r\n> if ($PSEdition -eq 'Core') {\r\n>     powershell.exe $MyInvocation.Line\r\n>     return\r\n> }\r\n> ...\r\n> ```\r\n\r\nThat code asks twice for parameter if no arguments are given, which does not happen on original script. If argument is given then only asks one time.",
    "created_at": "2022-01-11T21:55:18Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16731#issuecomment-1010393318",
    "id": 1010393318,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16731",
    "node_id": "IC_kwDOAvT7bc48OWDm",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010393318/reactions"
    },
    "updated_at": "2022-01-11T22:03:47Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010393318",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8339596?v=4",
      "events_url": "https://api.github.com/users/superbonaci/events{/privacy}",
      "followers_url": "https://api.github.com/users/superbonaci/followers",
      "following_url": "https://api.github.com/users/superbonaci/following{/other_user}",
      "gists_url": "https://api.github.com/users/superbonaci/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/superbonaci",
      "id": 8339596,
      "login": "superbonaci",
      "node_id": "MDQ6VXNlcjgzMzk1OTY=",
      "organizations_url": "https://api.github.com/users/superbonaci/orgs",
      "received_events_url": "https://api.github.com/users/superbonaci/received_events",
      "repos_url": "https://api.github.com/users/superbonaci/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/superbonaci/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/superbonaci/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/superbonaci"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Close as dup #13138.",
    "created_at": "2022-01-12T03:33:00Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16731#issuecomment-1010597805",
    "id": 1010597805,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16731",
    "node_id": "IC_kwDOAvT7bc48PH-t",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010597805/reactions"
    },
    "updated_at": "2022-01-12T03:33:00Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010597805",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "This issue has been marked as duplicate and has not had any activity for **1 day**. It has been closed for housekeeping purposes.",
    "created_at": "2022-01-13T05:00:40Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16731#issuecomment-1011797717",
    "id": 1011797717,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16731",
    "node_id": "IC_kwDOAvT7bc48Ts7V",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1011797717/reactions"
    },
    "updated_at": "2022-01-13T05:00:40Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1011797717",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  }
]

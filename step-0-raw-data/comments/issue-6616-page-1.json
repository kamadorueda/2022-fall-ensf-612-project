[
  {
    "author_association": "COLLABORATOR",
    "body": "@Chirishman Thanks for opening this. I'll take a look.",
    "created_at": "2018-04-10T17:01:14Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6616#issuecomment-380174571",
    "id": 380174571,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6616",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4MDE3NDU3MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/380174571/reactions"
    },
    "updated_at": "2018-04-10T17:01:14Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/380174571",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6876108?v=4",
      "events_url": "https://api.github.com/users/BrucePay/events{/privacy}",
      "followers_url": "https://api.github.com/users/BrucePay/followers",
      "following_url": "https://api.github.com/users/BrucePay/following{/other_user}",
      "gists_url": "https://api.github.com/users/BrucePay/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/BrucePay",
      "id": 6876108,
      "login": "BrucePay",
      "node_id": "MDQ6VXNlcjY4NzYxMDg=",
      "organizations_url": "https://api.github.com/users/BrucePay/orgs",
      "received_events_url": "https://api.github.com/users/BrucePay/received_events",
      "repos_url": "https://api.github.com/users/BrucePay/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/BrucePay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BrucePay/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/BrucePay"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "I do think this was done originally because the dot syntax for accessing a property always converts the value to a string. V2 reports the same error, so it's definitely not a new(ish) thing.\r\n\r\nIt might be overly restrictive, but you can always use apis to construct your hashtable.",
    "created_at": "2018-04-10T17:06:09Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6616#issuecomment-380176030",
    "id": 380176030,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6616",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4MDE3NjAzMA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/380176030/reactions"
    },
    "updated_at": "2018-04-10T17:06:09Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/380176030",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/2148248?v=4",
      "events_url": "https://api.github.com/users/lzybkr/events{/privacy}",
      "followers_url": "https://api.github.com/users/lzybkr/followers",
      "following_url": "https://api.github.com/users/lzybkr/following{/other_user}",
      "gists_url": "https://api.github.com/users/lzybkr/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/lzybkr",
      "id": 2148248,
      "login": "lzybkr",
      "node_id": "MDQ6VXNlcjIxNDgyNDg=",
      "organizations_url": "https://api.github.com/users/lzybkr/orgs",
      "received_events_url": "https://api.github.com/users/lzybkr/received_events",
      "repos_url": "https://api.github.com/users/lzybkr/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/lzybkr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lzybkr/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/lzybkr"
    }
  },
  {
    "author_association": "NONE",
    "body": "@lzybkr  Did you see my edit above re: dot syntax not always casting to string?",
    "created_at": "2018-04-10T17:41:18Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6616#issuecomment-380186901",
    "id": 380186901,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6616",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4MDE4NjkwMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/380186901/reactions"
    },
    "updated_at": "2018-04-10T17:41:18Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/380186901",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/7658840?v=4",
      "events_url": "https://api.github.com/users/Chirishman/events{/privacy}",
      "followers_url": "https://api.github.com/users/Chirishman/followers",
      "following_url": "https://api.github.com/users/Chirishman/following{/other_user}",
      "gists_url": "https://api.github.com/users/Chirishman/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Chirishman",
      "id": 7658840,
      "login": "Chirishman",
      "node_id": "MDQ6VXNlcjc2NTg4NDA=",
      "organizations_url": "https://api.github.com/users/Chirishman/orgs",
      "received_events_url": "https://api.github.com/users/Chirishman/received_events",
      "repos_url": "https://api.github.com/users/Chirishman/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Chirishman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Chirishman/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Chirishman"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@Chirishman - I did. I can't test V1, but I think that might have changed between V1 and V2, possibly by me.",
    "created_at": "2018-04-10T17:47:35Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6616#issuecomment-380188885",
    "id": 380188885,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6616",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4MDE4ODg4NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/380188885/reactions"
    },
    "updated_at": "2018-04-10T17:47:35Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/380188885",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/2148248?v=4",
      "events_url": "https://api.github.com/users/lzybkr/events{/privacy}",
      "followers_url": "https://api.github.com/users/lzybkr/followers",
      "following_url": "https://api.github.com/users/lzybkr/following{/other_user}",
      "gists_url": "https://api.github.com/users/lzybkr/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/lzybkr",
      "id": 2148248,
      "login": "lzybkr",
      "node_id": "MDQ6VXNlcjIxNDgyNDg=",
      "organizations_url": "https://api.github.com/users/lzybkr/orgs",
      "received_events_url": "https://api.github.com/users/lzybkr/received_events",
      "repos_url": "https://api.github.com/users/lzybkr/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/lzybkr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lzybkr/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/lzybkr"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "> you can always use apis to construct your hashtable.\r\n\r\nActually, a cast is all it takes to bypass the problem, so, @Chirishman, your tl;dr example actually shows the _workaround_, not the failure:\r\n\r\n```powershell\r\n@{ 1 = 'int'; '1' = 'string' } # BREAKS\r\n@{ [int] 1 = 'int'; '1' = 'string' } # Workaround: use cast\r\n```\r\n\r\n_Any_ numerical cast bypasses the problem at definition time.\r\n\r\nIn short: Given that a cast bypasses the problem and allows later access to both keys, **the problem affects only hashtable _literals_.**\r\n\r\n---\r\n\r\nHowever, when accessing the keys later there is a **pitfall** as well:\r\n\r\nWhile the distinction between numeric keys (unquoted; e.g., `1`) and string keys (quoted; e.g., `'1'`) works in principle, the specific integer type chosen is based on the value:\r\n\r\n`[int]` (`[int32]`) by default, with implicit widening to `[int64]` -> `[decimal]` -> `[double]` as \r\nneeded to accommodate larger values.\r\n\r\nThus, if the key type is `[int64]`, for instance, but a given key value is small enough to fit into `[int]`, the lookup won't work, and an indexed lookup with an explicit cast must be used.\r\n\r\n```powershell\r\n$ht = @{ [int64] 1 = 'int'; '1' = 'string' }\r\n\r\n$ht.1 # !! FAILS, because 1 is treated as [int]\r\n$ht[1] # ditto\r\n\r\n$ht[[int64] 1]  # OK - using index syntax with a cast is the only option in this case.\r\n```\r\n\r\n\r\n\r\n",
    "created_at": "2018-04-11T02:43:37Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6616#issuecomment-380308775",
    "id": 380308775,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6616",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4MDMwODc3NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/380308775/reactions"
    },
    "updated_at": "2018-04-11T02:49:33Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/380308775",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "P.S.: The problem applies to keys that look like floating-point literals too (without the spurious duplicate problem, they become `[double]` keys):\r\n\r\n```powershell\r\n@{ 1.2 = 'double'; '1.2' = 'string' }  # BREAKS\r\n```\r\n\r\nIn short: All the usual number-literal parsing rules apply (including negative numbers, hex. numbers, exponential notation, type-specifier suffixes).\r\n\r\nAlso note that the faulty hash-table-literal duplicate detection clearly goes out of its way to treat an unquoted number-like key as a string:\r\n\r\n```powershell\r\n@{ 1L =  'long'; '1' = 'string' }  # STILL BREAKS; despite the attempt to type 1 as [long]\r\n```\r\n\r\n---\r\n\r\nAs an aside:\r\n\r\nPerhaps surprisingly, accessing a `[double]` key works even with dot notation, even though it looks like _nested_ access:\r\n```powershell\r\n@{ 1.2 = 'double' }.1.2   # OK\r\n```\r\n\r\nEven mixing that with nested access works:\r\n```powershell\r\n@{ 1.2 = @{ 3 = '1-2-3' } }.1.2.3   # OK too \r\n```\r\n",
    "created_at": "2018-04-11T03:15:10Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6616#issuecomment-380313473",
    "id": 380313473,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6616",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4MDMxMzQ3Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/380313473/reactions"
    },
    "updated_at": "2018-04-11T03:24:53Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/380313473",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "P.P.S.: \r\n\r\nPerhaps a more puzzling example:\r\n\r\n```powershell\r\n@{ 1e2 = 'double'; '100' = 'string' }  # BREAKS\r\n```\r\n\r\nHaven't looked at the source code, but it seems that the duplicate-detection mechanism performs the equivalent of `1e2 -eq '100'`; i.e., the string-valued RHS is coerced to the LHS's number type before comparing, whereas using a cast is seemingly taking a different code path.\r\n\r\n",
    "created_at": "2018-04-11T11:42:46Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6616#issuecomment-380422603",
    "id": 380422603,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6616",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4MDQyMjYwMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/380422603/reactions"
    },
    "updated_at": "2018-04-11T11:42:46Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/380422603",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  }
]

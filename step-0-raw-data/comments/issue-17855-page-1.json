[
  {
    "author_association": "NONE",
    "body": "Have you try \"-SkipHeaderValidation\" ? \r\n\r\nNobody can reproduce your problem (and you forget to specify which command), you should provide a equivalent curl to show it's not a problem with the webserver.\r\n\r\nIf you want general support about PowerShell, StackOverflow or discussions is a better place to discuss.\r\n\r\n\r\n",
    "created_at": "2022-08-05T20:35:02Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17855#issuecomment-1206844194",
    "id": 1206844194,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17855",
    "node_id": "IC_kwDOAvT7bc5H7vsi",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1206844194/reactions"
    },
    "updated_at": "2022-08-05T20:35:39Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1206844194",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6187529?v=4",
      "events_url": "https://api.github.com/users/fMichaleczek/events{/privacy}",
      "followers_url": "https://api.github.com/users/fMichaleczek/followers",
      "following_url": "https://api.github.com/users/fMichaleczek/following{/other_user}",
      "gists_url": "https://api.github.com/users/fMichaleczek/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/fMichaleczek",
      "id": 6187529,
      "login": "fMichaleczek",
      "node_id": "MDQ6VXNlcjYxODc1Mjk=",
      "organizations_url": "https://api.github.com/users/fMichaleczek/orgs",
      "received_events_url": "https://api.github.com/users/fMichaleczek/received_events",
      "repos_url": "https://api.github.com/users/fMichaleczek/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/fMichaleczek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fMichaleczek/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/fMichaleczek"
    }
  },
  {
    "author_association": "NONE",
    "body": "@Clifra-Jones You should read this issue https://github.com/PowerShell/PowerShell/issues/2895#issuecomment-360118454 and the link to the blog.\r\n\r\nI will create an issue in PowerShell Docs about \"Header Strict Validation\"",
    "created_at": "2022-08-05T22:49:28Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17855#issuecomment-1207073744",
    "id": 1207073744,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17855",
    "node_id": "IC_kwDOAvT7bc5H8nvQ",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1207073744/reactions"
    },
    "updated_at": "2022-08-05T23:18:04Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1207073744",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6187529?v=4",
      "events_url": "https://api.github.com/users/fMichaleczek/events{/privacy}",
      "followers_url": "https://api.github.com/users/fMichaleczek/followers",
      "following_url": "https://api.github.com/users/fMichaleczek/following{/other_user}",
      "gists_url": "https://api.github.com/users/fMichaleczek/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/fMichaleczek",
      "id": 6187529,
      "login": "fMichaleczek",
      "node_id": "MDQ6VXNlcjYxODc1Mjk=",
      "organizations_url": "https://api.github.com/users/fMichaleczek/orgs",
      "received_events_url": "https://api.github.com/users/fMichaleczek/received_events",
      "repos_url": "https://api.github.com/users/fMichaleczek/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/fMichaleczek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fMichaleczek/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/fMichaleczek"
    }
  },
  {
    "author_association": "NONE",
    "body": "Could you show a little code where you build the parameters and call Invoke-RestMethod / Invoke-WebRequest ? Generally, building a header like that isn't needed. The `-ContentType` is a command line parameter, not passed as header, the size is calculated for you \r\nI'd expect something like this to work \r\n```\r\n$headers = @{authorization='bearer xyz123' }\r\ninvoke-restmethod -method Post -headers $headers -infile <whatever> -contentType <mimetime>\r\n```\r\n\r\n\r\n",
    "created_at": "2022-08-07T14:12:33Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17855#issuecomment-1207417401",
    "id": 1207417401,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17855",
    "node_id": "IC_kwDOAvT7bc5H97o5",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1207417401/reactions"
    },
    "updated_at": "2022-08-07T14:12:33Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1207417401",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/16209593?v=4",
      "events_url": "https://api.github.com/users/jhoneill/events{/privacy}",
      "followers_url": "https://api.github.com/users/jhoneill/followers",
      "following_url": "https://api.github.com/users/jhoneill/following{/other_user}",
      "gists_url": "https://api.github.com/users/jhoneill/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jhoneill",
      "id": 16209593,
      "login": "jhoneill",
      "node_id": "MDQ6VXNlcjE2MjA5NTkz",
      "organizations_url": "https://api.github.com/users/jhoneill/orgs",
      "received_events_url": "https://api.github.com/users/jhoneill/received_events",
      "repos_url": "https://api.github.com/users/jhoneill/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jhoneill/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jhoneill/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jhoneill"
    }
  },
  {
    "author_association": "NONE",
    "body": "> Could you show a little code where you build the parameters and call Invoke-RestMethod / Invoke-WebRequest ? Generally, building a header like that isn't needed. The `-ContentType` is a command line parameter, not passed as header, the size is calculated for you I'd expect something like this to work\r\n> \r\n> ```\r\n> $headers = @{authorization='bearer xyz123' }\r\n> invoke-restmethod -method Post -headers $headers -infile <whatever> -contentType <mimetime>\r\n> ```\r\n\r\nThanks @jhoneill I was able to get past the error with this.",
    "created_at": "2022-08-08T13:02:56Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17855#issuecomment-1208100036",
    "id": 1208100036,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17855",
    "node_id": "IC_kwDOAvT7bc5IAiTE",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1208100036/reactions"
    },
    "updated_at": "2022-08-08T13:02:56Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1208100036",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/35309080?v=4",
      "events_url": "https://api.github.com/users/Clifra-Jones/events{/privacy}",
      "followers_url": "https://api.github.com/users/Clifra-Jones/followers",
      "following_url": "https://api.github.com/users/Clifra-Jones/following{/other_user}",
      "gists_url": "https://api.github.com/users/Clifra-Jones/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Clifra-Jones",
      "id": 35309080,
      "login": "Clifra-Jones",
      "node_id": "MDQ6VXNlcjM1MzA5MDgw",
      "organizations_url": "https://api.github.com/users/Clifra-Jones/orgs",
      "received_events_url": "https://api.github.com/users/Clifra-Jones/received_events",
      "repos_url": "https://api.github.com/users/Clifra-Jones/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Clifra-Jones/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Clifra-Jones/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Clifra-Jones"
    }
  },
  {
    "author_association": "NONE",
    "body": "I closed this earlier today but I'm posting this because I solved this issue so that anyone looking this up can find the answer.\r\nUsing the -InFile parameter DOES NOT WORK with the Smartsheet API. After using Postman and looking at Postman's Powershell Code example I found the solution.\r\n\r\nManually build the headers as a hash table:\r\n\r\nContent-Type                   application/vnd.openxmlformats-officedocument.wordprocessingml.document\r\nAuthorization                  Bearer VcjJj....\r\nContent-Disposition            attachment; filename=\"CWilliams.docx\"\r\n\r\n\r\nRead the file in as a byte array:\r\n`$body = [System.IO.File]::ReadAllBytes($path)`\r\n\r\nIssue the following Command:\r\n`$response = Invoke-RestMethod -Method 'POST' -Uri $Uri -Headers $Headers -Body $body`\r\n\r\nThis works.\r\nI was trying this before but adding 'Content-Length ' to the Headers. If you add that it fails with odd errors.\r\n\r\nWhat ever headers -InFile is producing doesn't work properly with the Smartsheet API.",
    "created_at": "2022-08-08T18:26:30Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17855#issuecomment-1208462439",
    "id": 1208462439,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17855",
    "node_id": "IC_kwDOAvT7bc5IB6xn",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1208462439/reactions"
    },
    "updated_at": "2022-08-08T18:28:34Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1208462439",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/35309080?v=4",
      "events_url": "https://api.github.com/users/Clifra-Jones/events{/privacy}",
      "followers_url": "https://api.github.com/users/Clifra-Jones/followers",
      "following_url": "https://api.github.com/users/Clifra-Jones/following{/other_user}",
      "gists_url": "https://api.github.com/users/Clifra-Jones/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Clifra-Jones",
      "id": 35309080,
      "login": "Clifra-Jones",
      "node_id": "MDQ6VXNlcjM1MzA5MDgw",
      "organizations_url": "https://api.github.com/users/Clifra-Jones/orgs",
      "received_events_url": "https://api.github.com/users/Clifra-Jones/received_events",
      "repos_url": "https://api.github.com/users/Clifra-Jones/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Clifra-Jones/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Clifra-Jones/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Clifra-Jones"
    }
  }
]

[
  {
    "author_association": "COLLABORATOR",
    "body": "@alx9r When you're dotsourcing a module bound scriptblock, the current scope will be the `ModuleScope` (same as psm1) while it's being invoked.  So \"Scope 1\" there is global.",
    "created_at": "2019-03-06T18:09:31Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9077#issuecomment-470214159",
    "id": 470214159,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9077",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MDIxNDE1OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/470214159/reactions"
    },
    "updated_at": "2019-03-06T18:09:31Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/470214159",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Also, @alx9r, ~~there's only _one_ module instance in your code, `$m`, and all your `.` invocations happen in its top-level scope~~ (where, as @SeeminglyScience points out, `-Scope 1` refers to the _global_ scope).\r\n",
    "created_at": "2019-03-06T18:16:06Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9077#issuecomment-470216361",
    "id": 470216361,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9077",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MDIxNjM2MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/470216361/reactions"
    },
    "updated_at": "2019-03-06T19:08:20Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/470216361",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "NONE",
    "body": ">So \"Scope 1\" there is global.\r\n\r\nOh I see.  Thanks @SeeminglyScience.  \r\n\r\n(For posterity, that link to \"global\" is more nuanced than I remembered: See [\"One last detail...\" in #6139](https://github.com/PowerShell/PowerShell/issues/6139#issuecomment-364262570).)\r\n\r\n>there's only one module instance in your code, $m, and all your . invocations happen in its top-level scope\r\n\r\nI count 7 module instances: `$m` plus the 6 produced by the 6 invocations of .GetNewClosure().  @mklement0 are you saying that those are all actually the same module?  \r\n\r\nInvoking \r\n\r\n```PowerShell\r\n$m = New-Module {}\r\n$m.Name\r\n\r\nforeach ($sb in @(\r\n    { $v = 'normal assignment'                        }\r\n    { Set-Variable v 'Set-Variable'                   }\r\n    { Set-Variable v 'Set-Variable -Scope 1' -Scope 1 }\r\n))\r\n{\r\n    $sb  | . $m { process { $_.GetNewClosure() } } | % {$_.Module.Name}\r\n    {$v} | . $m { process { $_.GetNewClosure() } } | % {$_.Module.Name}\r\n}\r\n```\r\n\r\nshows 7 different module names on my computer.",
    "created_at": "2019-03-06T19:00:36Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9077#issuecomment-470232458",
    "id": 470232458,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9077",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MDIzMjQ1OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/470232458/reactions"
    },
    "updated_at": "2019-03-06T19:00:36Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/470232458",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11237922?v=4",
      "events_url": "https://api.github.com/users/alx9r/events{/privacy}",
      "followers_url": "https://api.github.com/users/alx9r/followers",
      "following_url": "https://api.github.com/users/alx9r/following{/other_user}",
      "gists_url": "https://api.github.com/users/alx9r/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/alx9r",
      "id": 11237922,
      "login": "alx9r",
      "node_id": "MDQ6VXNlcjExMjM3OTIy",
      "organizations_url": "https://api.github.com/users/alx9r/orgs",
      "received_events_url": "https://api.github.com/users/alx9r/received_events",
      "repos_url": "https://api.github.com/users/alx9r/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/alx9r/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alx9r/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/alx9r"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Thanks, @alx9r - clearly I had a misconception there. \r\n\r\nI missed that `.GetNewClosure()` _creates_ a new module, correct?\r\n\r\n\r\n",
    "created_at": "2019-03-06T19:07:25Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9077#issuecomment-470235025",
    "id": 470235025,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9077",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MDIzNTAyNQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/470235025/reactions"
    },
    "updated_at": "2019-03-06T19:08:33Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/470235025",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "NONE",
    "body": ">I missed that .GetNewClosure() creates a new module, correct?\r\n\r\n@mklement0 That's my current understanding of what happens.",
    "created_at": "2019-03-06T19:12:44Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9077#issuecomment-470237035",
    "id": 470237035,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9077",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MDIzNzAzNQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/470237035/reactions"
    },
    "updated_at": "2019-03-06T19:12:44Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/470237035",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11237922?v=4",
      "events_url": "https://api.github.com/users/alx9r/events{/privacy}",
      "followers_url": "https://api.github.com/users/alx9r/followers",
      "following_url": "https://api.github.com/users/alx9r/following{/other_user}",
      "gists_url": "https://api.github.com/users/alx9r/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/alx9r",
      "id": 11237922,
      "login": "alx9r",
      "node_id": "MDQ6VXNlcjExMjM3OTIy",
      "organizations_url": "https://api.github.com/users/alx9r/orgs",
      "received_events_url": "https://api.github.com/users/alx9r/received_events",
      "repos_url": "https://api.github.com/users/alx9r/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/alx9r/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alx9r/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/alx9r"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "As for the link to the global scope: it is possible - though I've never seen it in the wild - to create a module that _doesn't_ have that link - or, rather, it _does and it doesn't_. A bug?\r\n\r\n@PetSerAl  pointed me to this [`PSModuleInfo` constructor](https://docs.microsoft.com/en-us/dotnet/api/system.management.automation.psmoduleinfo.-ctor?view=powershellsdk-1.1.0#System_Management_Automation_PSModuleInfo__ctor_System_Boolean_) that, when passed `$false`, purports to create a module that opts out of the link:\r\n\r\n```powershell\r\n# WITH link to global scope.\r\nPS> $global:var = 42; . ([psmoduleinfo]::new($true)) { $global:var }\r\n42\r\n\r\n# WITHOUT link to global scope.\r\nPS> $global:var = 42; . ([psmoduleinfo]::new($false)) { $global:var }\r\n  # NO OUTPUT. Get-Variable -Scope Global var would fail.\r\n```\r\n\r\nHowever, _without a scope qualifier_ the global variable _is_ seen:\r\n\r\n```powershell\r\n# WITHOUT link to global scope, but REFERENCE WITHOUT SCOPE QUALIFIER\r\nPS> $global:var = 42; . ([psmoduleinfo]::new($false)) { $var }\r\n42 # !! Unexpectedly still seen; ditto with `Get-Variable var` (without -Scope)\r\n```\r\n\r\n",
    "created_at": "2019-03-06T19:30:46Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9077#issuecomment-470243685",
    "id": 470243685,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9077",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MDI0MzY4NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/470243685/reactions"
    },
    "updated_at": "2019-03-06T20:48:55Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/470243685",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "NONE",
    "body": "@mklement0 It seems like that might be a bug.  It reminds me of the inconsistent behavior in #6378.  That turned out to be a bug.",
    "created_at": "2019-03-06T21:06:07Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9077#issuecomment-470276390",
    "id": 470276390,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9077",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MDI3NjM5MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/470276390/reactions"
    },
    "updated_at": "2019-03-06T21:06:07Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/470276390",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11237922?v=4",
      "events_url": "https://api.github.com/users/alx9r/events{/privacy}",
      "followers_url": "https://api.github.com/users/alx9r/followers",
      "following_url": "https://api.github.com/users/alx9r/following{/other_user}",
      "gists_url": "https://api.github.com/users/alx9r/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/alx9r",
      "id": 11237922,
      "login": "alx9r",
      "node_id": "MDQ6VXNlcjExMjM3OTIy",
      "organizations_url": "https://api.github.com/users/alx9r/orgs",
      "received_events_url": "https://api.github.com/users/alx9r/received_events",
      "repos_url": "https://api.github.com/users/alx9r/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/alx9r/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alx9r/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/alx9r"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Thanks, @alx9r  - I've created #9080.",
    "created_at": "2019-03-06T21:45:06Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9077#issuecomment-470289667",
    "id": 470289667,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9077",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MDI4OTY2Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/470289667/reactions"
    },
    "updated_at": "2019-03-06T21:45:06Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/470289667",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  }
]

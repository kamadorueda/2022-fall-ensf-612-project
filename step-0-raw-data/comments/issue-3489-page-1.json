[
  {
    "author_association": "CONTRIBUTOR",
    "body": "`Export-Clixml` does not include extended properties, when object is not wrapped into `PSObject`.\r\n```powershell\r\nPS> $hash = @{ a=1 }\r\nPS> Add-Member -InputObject $hash -NotePropertyName b -NotePropertyValue 2\r\nPS> $array = $hash, [PSObject]$hash\r\nPS> [System.Management.Automation.PSSerializer]::Serialize($array)\r\n<Objs Version=\"1.1.0.1\" xmlns=\"http://schemas.microsoft.com/powershell/2004/04\">\r\n  <Obj RefId=\"0\">\r\n    <TN RefId=\"0\">\r\n      <T>System.Object[]</T>\r\n      <T>System.Array</T>\r\n      <T>System.Object</T>\r\n    </TN>\r\n    <LST>\r\n      <Obj RefId=\"1\">\r\n        <TN RefId=\"1\">\r\n          <T>System.Collections.Hashtable</T>\r\n          <T>System.Object</T>\r\n        </TN>\r\n        <DCT>\r\n          <En>\r\n            <S N=\"Key\">a</S>\r\n            <I32 N=\"Value\">1</I32>\r\n          </En>\r\n        </DCT>\r\n      </Obj>\r\n      <Obj RefId=\"2\">\r\n        <TNRef RefId=\"1\" />\r\n        <DCT>\r\n          <En>\r\n            <S N=\"Key\">a</S>\r\n            <I32 N=\"Value\">1</I32>\r\n          </En>\r\n        </DCT>\r\n        <MS>\r\n          <I32 N=\"b\">2</I32>\r\n        </MS>\r\n      </Obj>\r\n    </LST>\r\n  </Obj>\r\n</Objs>\r\n```\r\nThe\r\n```xml\r\n<MS>\r\n  <I32 N=\"b\">2</I32>\r\n</MS>\r\n```\r\nhere for second element, but not for first.",
    "created_at": "2017-04-05T16:26:30Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3489#issuecomment-291917245",
    "id": 291917245,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3489",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5MTkxNzI0NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/291917245/reactions"
    },
    "updated_at": "2017-04-05T16:28:13Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/291917245",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/17184058?v=4",
      "events_url": "https://api.github.com/users/PetSerAl/events{/privacy}",
      "followers_url": "https://api.github.com/users/PetSerAl/followers",
      "following_url": "https://api.github.com/users/PetSerAl/following{/other_user}",
      "gists_url": "https://api.github.com/users/PetSerAl/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/PetSerAl",
      "id": 17184058,
      "login": "PetSerAl",
      "node_id": "MDQ6VXNlcjE3MTg0MDU4",
      "organizations_url": "https://api.github.com/users/PetSerAl/orgs",
      "received_events_url": "https://api.github.com/users/PetSerAl/received_events",
      "repos_url": "https://api.github.com/users/PetSerAl/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/PetSerAl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PetSerAl/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/PetSerAl"
    }
  },
  {
    "author_association": "NONE",
    "body": "Thanks @PetSerAl .\r\n\r\nHowever I'm not sure this can be an intended: the `noteproperty` of the top-level hashtable is stored.  The `noteproperty` of the nested hashtable is not stored.  That doesn't seem right.  As a client I've just go two hashtables with noteproperties.  No casting to `[psobject]` for either; but the behavior is different.  The behavior is not described in the `-detail`ed help either., nor is there any `verbose` or `warning` stream output telling me that information-loss has occurred.\r\n\r\nI really think that exporting noteproperties is surely what callers would expect.  If I get a complex-ly nested hashtable object out of a third-party module which I want to store, I'd export `export-clixml` / `import-clixml` to allow me to store that object with very high fidelity.",
    "created_at": "2017-04-07T18:54:22Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3489#issuecomment-292622406",
    "id": 292622406,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3489",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5MjYyMjQwNg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/292622406/reactions"
    },
    "updated_at": "2017-04-07T18:54:22Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/292622406",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/26512373?v=4",
      "events_url": "https://api.github.com/users/wisemoth/events{/privacy}",
      "followers_url": "https://api.github.com/users/wisemoth/followers",
      "following_url": "https://api.github.com/users/wisemoth/following{/other_user}",
      "gists_url": "https://api.github.com/users/wisemoth/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/wisemoth",
      "id": 26512373,
      "login": "wisemoth",
      "node_id": "MDQ6VXNlcjI2NTEyMzcz",
      "organizations_url": "https://api.github.com/users/wisemoth/orgs",
      "received_events_url": "https://api.github.com/users/wisemoth/received_events",
      "repos_url": "https://api.github.com/users/wisemoth/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/wisemoth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wisemoth/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/wisemoth"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": ">No casting to [psobject] for either; but the behavior is different.\r\n\r\n`InputObject` parameter of `Export-Clixml` cmdlet is types as `PSObject`:\r\n```powershell\r\n(Get-Command Export-Clixml).Parameters.InputObject.ParameterType\r\n```\r\nSo there is implicit cast for top level object to `PSObject`.",
    "created_at": "2017-04-07T19:38:39Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3489#issuecomment-292632588",
    "id": 292632588,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3489",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5MjYzMjU4OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/292632588/reactions"
    },
    "updated_at": "2017-04-07T19:38:39Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/292632588",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/17184058?v=4",
      "events_url": "https://api.github.com/users/PetSerAl/events{/privacy}",
      "followers_url": "https://api.github.com/users/PetSerAl/followers",
      "following_url": "https://api.github.com/users/PetSerAl/following{/other_user}",
      "gists_url": "https://api.github.com/users/PetSerAl/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/PetSerAl",
      "id": 17184058,
      "login": "PetSerAl",
      "node_id": "MDQ6VXNlcjE3MTg0MDU4",
      "organizations_url": "https://api.github.com/users/PetSerAl/orgs",
      "received_events_url": "https://api.github.com/users/PetSerAl/received_events",
      "repos_url": "https://api.github.com/users/PetSerAl/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/PetSerAl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PetSerAl/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/PetSerAl"
    }
  },
  {
    "author_association": "NONE",
    "body": "But the *intent* surely of the implementer at the time was not to have such awkward lossy semantics? I think you are highlighting how the code is - rather than how it was intended or should be.",
    "created_at": "2017-04-24T09:26:05Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3489#issuecomment-296592478",
    "id": 296592478,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3489",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5NjU5MjQ3OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/296592478/reactions"
    },
    "updated_at": "2017-04-24T09:26:05Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/296592478",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/26512373?v=4",
      "events_url": "https://api.github.com/users/wisemoth/events{/privacy}",
      "followers_url": "https://api.github.com/users/wisemoth/followers",
      "following_url": "https://api.github.com/users/wisemoth/following{/other_user}",
      "gists_url": "https://api.github.com/users/wisemoth/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/wisemoth",
      "id": 26512373,
      "login": "wisemoth",
      "node_id": "MDQ6VXNlcjI2NTEyMzcz",
      "organizations_url": "https://api.github.com/users/wisemoth/orgs",
      "received_events_url": "https://api.github.com/users/wisemoth/received_events",
      "repos_url": "https://api.github.com/users/wisemoth/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/wisemoth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wisemoth/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/wisemoth"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Is this still an issue worth looking at? \r\n\r\nI have seen no real need for this in the community - but I may have missed something! :-)\r\n\r\n",
    "created_at": "2022-05-07T17:28:06Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3489#issuecomment-1120246015",
    "id": 1120246015,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3489",
    "node_id": "IC_kwDOAvT7bc5CxZj_",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1120246015/reactions"
    },
    "updated_at": "2022-05-07T17:28:06Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1120246015",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/3630329?v=4",
      "events_url": "https://api.github.com/users/doctordns/events{/privacy}",
      "followers_url": "https://api.github.com/users/doctordns/followers",
      "following_url": "https://api.github.com/users/doctordns/following{/other_user}",
      "gists_url": "https://api.github.com/users/doctordns/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/doctordns",
      "id": 3630329,
      "login": "doctordns",
      "node_id": "MDQ6VXNlcjM2MzAzMjk=",
      "organizations_url": "https://api.github.com/users/doctordns/orgs",
      "received_events_url": "https://api.github.com/users/doctordns/received_events",
      "repos_url": "https://api.github.com/users/doctordns/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/doctordns/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/doctordns/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/doctordns"
    }
  },
  {
    "author_association": "NONE",
    "body": "> I have seen no real need for this in the community \r\n\r\nThere is a need which is why I raised the issue.\r\n\r\nThe documentation for `export-clixml` does not suggest the lossiness implied by this issue.  As soon as you embed an object with `NoteProperty` members into some other object, the former will be serialized with lossiness.  This would cause rather difficult to find issues.\r\n\r\nUnless we want everyone to encode their own non-lossy encoders, `export-clixml` itself should perform non-lossy serialization (which is likely what people believe it *does* do at present).\r\n\r\n",
    "created_at": "2022-05-16T08:12:22Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3489#issuecomment-1127365236",
    "id": 1127365236,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3489",
    "node_id": "IC_kwDOAvT7bc5DMjp0",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1127365236/reactions"
    },
    "updated_at": "2022-05-16T08:12:22Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1127365236",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/26512373?v=4",
      "events_url": "https://api.github.com/users/wisemoth/events{/privacy}",
      "followers_url": "https://api.github.com/users/wisemoth/followers",
      "following_url": "https://api.github.com/users/wisemoth/following{/other_user}",
      "gists_url": "https://api.github.com/users/wisemoth/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/wisemoth",
      "id": 26512373,
      "login": "wisemoth",
      "node_id": "MDQ6VXNlcjI2NTEyMzcz",
      "organizations_url": "https://api.github.com/users/wisemoth/orgs",
      "received_events_url": "https://api.github.com/users/wisemoth/received_events",
      "repos_url": "https://api.github.com/users/wisemoth/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/wisemoth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wisemoth/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/wisemoth"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@PowerShell/wg-powershell-cmdlets reviewed this.  Based on @SeeminglyScience's observation, this appears to be a bug that has existed for sometime.  We would be ok with an `ExperimentalFeature` that fixes this bug, however, we would want to verify what happens if you export from PS7 (with the change) and then try to import on WinPS (or older PS7).",
    "created_at": "2022-06-01T16:17:35Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3489#issuecomment-1143816359",
    "id": 1143816359,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3489",
    "node_id": "IC_kwDOAvT7bc5ELUCn",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1143816359/reactions"
    },
    "updated_at": "2022-06-01T16:17:35Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1143816359",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "For a fix I'd probably look at changing this code:\r\n\r\nhttps://github.com/PowerShell/PowerShell/blob/5b6407741cd2b85409538c1b99e858846a1259e7/src/System.Management.Automation/engine/serialization.cs#L1263-L1266\r\n\r\nto use `PSObject.HasInstanceMembers(object, out PSMemberInfoInternalCollection<PSMemberInfo>)`, or just always wrap with `PSObject.AsPSObject(object)`\r\n\r\nAs a work around, you can explicitly wrap objects you want to retain ETS members for. In the repro steps if you add this before the export, it'll retain them:\r\n\r\n```powershell\r\n$d.hash = [psobject]$d.hash\r\n```",
    "created_at": "2022-06-01T16:58:27Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3489#issuecomment-1143877745",
    "id": 1143877745,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3489",
    "node_id": "IC_kwDOAvT7bc5ELjBx",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1143877745/reactions"
    },
    "updated_at": "2022-06-01T16:58:27Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1143877745",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  }
]

[
  {
    "author_association": "NONE",
    "body": "I have same issue here, but with the fx-dependent package\r\nAfter enabling PSRemoting the file ```C:\\Windows\\System32\\PowerShell\\7-preview\\RemotePowerShellConfig.txt``` is created and populated with two directives all of which pointi the $PSHOME folder\r\n\r\n```\r\nPSHOMEDIR=C:\\Program Files\\Powershell\\7-preview\r\nCORECLRDIR=C:\\Program Files\\Powershell\\7-preview\r\n```\r\nI tried to change the last one, setting it to the folder where the runtime is installed (```C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\\7.0.0-preview.4.22229.4```), this way the error changes from ```Code=\"2689860592\"``` to ```Code=\"2689860587\"```:\r\n\r\n```\r\nNew-PSSession: [10.30.60.5] Connecting to remote server 10.30.60.5 failed with the following error message : <f:WSManFault xmlns:f=\"http://schemas.microsoft.com/wbem/wsman/1/wsmanfault\" Code=\"2689860587\" Machine=\"10.30.60.5\"><f:Message><f:ProviderFault provider=\"PowerShell.7-preview\" path=\"C:\\Windows\\system32\\PowerShell\\7-preview\\pwrshplugin.dll\"></f:ProviderFault></f:Message></f:WSManFault> For more information, see the about_Remote_Troubleshooting Help topic.\r\n```\r\n\r\nThis example is with PS7.3.0-preview.4 but I get the same error also with the fx-dependent pacakge of the versions ```7.2.4```, ```7.0.11``` and ```6.2.4``` (at least, these are the versions I tested)\r\n\r\n**Note** that if on a machine with a working PSRemoting (e.g. with a PS7 installed from the ```.msi``` package) I change the ```CORECLRDIR``` to a random value PS return the same error as the fx-dependent version (with ```Code=\"2689860592\"```)",
    "created_at": "2022-05-29T17:31:27Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14274#issuecomment-1140492466",
    "id": 1140492466,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14274",
    "node_id": "IC_kwDOAvT7bc5D-oiy",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1140492466/reactions"
    },
    "updated_at": "2022-05-29T17:33:22Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1140492466",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11667486?v=4",
      "events_url": "https://api.github.com/users/leoniDEV/events{/privacy}",
      "followers_url": "https://api.github.com/users/leoniDEV/followers",
      "following_url": "https://api.github.com/users/leoniDEV/following{/other_user}",
      "gists_url": "https://api.github.com/users/leoniDEV/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/leoniDEV",
      "id": 11667486,
      "login": "leoniDEV",
      "node_id": "MDQ6VXNlcjExNjY3NDg2",
      "organizations_url": "https://api.github.com/users/leoniDEV/orgs",
      "received_events_url": "https://api.github.com/users/leoniDEV/received_events",
      "repos_url": "https://api.github.com/users/leoniDEV/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/leoniDEV/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/leoniDEV/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/leoniDEV"
    }
  },
  {
    "author_association": "NONE",
    "body": "We have the same problem on pwsh 7.2.4, but only if we limit the permissions of the user we use to make the connection to \"Remote Management Users\" on the target machine. If we put it into the \"Administrators\" group instead the connection works.\r\n\r\nThis is not ideal, since we are required by company guidelines to limit each users permissions as much as possible and \"Administrators\" is the exact opposite of that.",
    "created_at": "2022-06-08T10:11:10Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14274#issuecomment-1149725623",
    "id": 1149725623,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14274",
    "node_id": "IC_kwDOAvT7bc5Eh2u3",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1149725623/reactions"
    },
    "updated_at": "2022-06-08T10:11:10Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1149725623",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8030636?v=4",
      "events_url": "https://api.github.com/users/vomaufgang/events{/privacy}",
      "followers_url": "https://api.github.com/users/vomaufgang/followers",
      "following_url": "https://api.github.com/users/vomaufgang/following{/other_user}",
      "gists_url": "https://api.github.com/users/vomaufgang/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vomaufgang",
      "id": 8030636,
      "login": "vomaufgang",
      "node_id": "MDQ6VXNlcjgwMzA2MzY=",
      "organizations_url": "https://api.github.com/users/vomaufgang/orgs",
      "received_events_url": "https://api.github.com/users/vomaufgang/received_events",
      "repos_url": "https://api.github.com/users/vomaufgang/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vomaufgang/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vomaufgang/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vomaufgang"
    }
  },
  {
    "author_association": "NONE",
    "body": "Having the exact same problem as @vomaufgang. User in Active Directory Administrator group works just fine. User in local \"Remote Management\" group gets the above error message.\r\n\r\nUsing PowerShell 7.2.4",
    "created_at": "2022-06-09T06:28:21Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14274#issuecomment-1150723373",
    "id": 1150723373,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14274",
    "node_id": "IC_kwDOAvT7bc5ElqUt",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1150723373/reactions"
    },
    "updated_at": "2022-06-09T06:28:21Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1150723373",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/43034898?v=4",
      "events_url": "https://api.github.com/users/sevi-kun/events{/privacy}",
      "followers_url": "https://api.github.com/users/sevi-kun/followers",
      "following_url": "https://api.github.com/users/sevi-kun/following{/other_user}",
      "gists_url": "https://api.github.com/users/sevi-kun/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/sevi-kun",
      "id": 43034898,
      "login": "sevi-kun",
      "node_id": "MDQ6VXNlcjQzMDM0ODk4",
      "organizations_url": "https://api.github.com/users/sevi-kun/orgs",
      "received_events_url": "https://api.github.com/users/sevi-kun/received_events",
      "repos_url": "https://api.github.com/users/sevi-kun/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/sevi-kun/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sevi-kun/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/sevi-kun"
    }
  },
  {
    "author_association": "NONE",
    "body": "I was reading through issue #17367 and found informations about the PowerShell remote plugin.\r\n\r\n@PaulHigin mentioned the following:\r\n\r\n>  The C:\\Windows\\System32\\Powershell\\7.2.4 path needs to be writeable because that is where the configuration information, which the remote plugin needs, is stored.\r\n\r\nSo I gave my user write premissions, and it worked!\r\n\r\nHopefully this will get changed ASAP, because it kind of seems like a security risk..",
    "created_at": "2022-06-09T08:46:30Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14274#issuecomment-1150845985",
    "id": 1150845985,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14274",
    "node_id": "IC_kwDOAvT7bc5EmIQh",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1150845985/reactions"
    },
    "updated_at": "2022-06-09T08:47:20Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1150845985",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/43034898?v=4",
      "events_url": "https://api.github.com/users/sevi-kun/events{/privacy}",
      "followers_url": "https://api.github.com/users/sevi-kun/followers",
      "following_url": "https://api.github.com/users/sevi-kun/following{/other_user}",
      "gists_url": "https://api.github.com/users/sevi-kun/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/sevi-kun",
      "id": 43034898,
      "login": "sevi-kun",
      "node_id": "MDQ6VXNlcjQzMDM0ODk4",
      "organizations_url": "https://api.github.com/users/sevi-kun/orgs",
      "received_events_url": "https://api.github.com/users/sevi-kun/received_events",
      "repos_url": "https://api.github.com/users/sevi-kun/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/sevi-kun/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sevi-kun/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/sevi-kun"
    }
  }
]

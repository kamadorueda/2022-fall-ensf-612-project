[
  {
    "author_association": "NONE",
    "body": "This has been driving me nuts the past few days.  Maybe a quick solution is to _not_ add the WorkingDirectory parameter to the shortcuts...?  Developers/desktop users are always going to set the default location via profile, not by changing the shortcut value.  WorkingDirectory seems only useful for automating a script or running one remotely.  But, to be honest, even then I wouldn't rely upon it; if my script had to be in a default location at start-up I would ensure that at the beginning of the script itself and not trust that the shell had been opened to the correct default location.",
    "created_at": "2018-10-11T12:11:17Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7895#issuecomment-428931531",
    "id": 428931531,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7895",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyODkzMTUzMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/428931531/reactions"
    },
    "updated_at": "2018-10-11T12:11:17Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/428931531",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/2632539?v=4",
      "events_url": "https://api.github.com/users/DTW-DanWard/events{/privacy}",
      "followers_url": "https://api.github.com/users/DTW-DanWard/followers",
      "following_url": "https://api.github.com/users/DTW-DanWard/following{/other_user}",
      "gists_url": "https://api.github.com/users/DTW-DanWard/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/DTW-DanWard",
      "id": 2632539,
      "login": "DTW-DanWard",
      "node_id": "MDQ6VXNlcjI2MzI1Mzk=",
      "organizations_url": "https://api.github.com/users/DTW-DanWard/orgs",
      "received_events_url": "https://api.github.com/users/DTW-DanWard/received_events",
      "repos_url": "https://api.github.com/users/DTW-DanWard/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/DTW-DanWard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DTW-DanWard/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/DTW-DanWard"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "We should rather fix this properly in the implementation of the new `Workingdirectory` parameter that was introduced in PR #6612 to help start PowerShell by default in the user folder instead of its installation folder and for an issue with the explorer context menu. cc @SteveL-MSFT \r\nThe proposed design would be to have the WorkingDirectory ready before execution of the $PROFILE script instead afterwards.",
    "created_at": "2018-10-11T15:36:19Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7895#issuecomment-429002731",
    "id": 429002731,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7895",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyOTAwMjczMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/429002731/reactions"
    },
    "updated_at": "2018-10-11T15:36:19Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/429002731",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/9250262?v=4",
      "events_url": "https://api.github.com/users/bergmeister/events{/privacy}",
      "followers_url": "https://api.github.com/users/bergmeister/followers",
      "following_url": "https://api.github.com/users/bergmeister/following{/other_user}",
      "gists_url": "https://api.github.com/users/bergmeister/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/bergmeister",
      "id": 9250262,
      "login": "bergmeister",
      "node_id": "MDQ6VXNlcjkyNTAyNjI=",
      "organizations_url": "https://api.github.com/users/bergmeister/orgs",
      "received_events_url": "https://api.github.com/users/bergmeister/received_events",
      "repos_url": "https://api.github.com/users/bergmeister/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/bergmeister/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bergmeister/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/bergmeister"
    }
  },
  {
    "author_association": "NONE",
    "body": "If the working directory is going to be set the user should be given the option of overriding the default when PowerShell is installed. we get the option to override the install folder why not the workingdirectory?",
    "created_at": "2018-10-18T16:12:03Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7895#issuecomment-431069775",
    "id": 431069775,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7895",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTA2OTc3NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/431069775/reactions"
    },
    "updated_at": "2018-10-18T16:12:03Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/431069775",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/7870545?v=4",
      "events_url": "https://api.github.com/users/RichardSiddaway/events{/privacy}",
      "followers_url": "https://api.github.com/users/RichardSiddaway/followers",
      "following_url": "https://api.github.com/users/RichardSiddaway/following{/other_user}",
      "gists_url": "https://api.github.com/users/RichardSiddaway/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/RichardSiddaway",
      "id": 7870545,
      "login": "RichardSiddaway",
      "node_id": "MDQ6VXNlcjc4NzA1NDU=",
      "organizations_url": "https://api.github.com/users/RichardSiddaway/orgs",
      "received_events_url": "https://api.github.com/users/RichardSiddaway/received_events",
      "repos_url": "https://api.github.com/users/RichardSiddaway/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/RichardSiddaway/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RichardSiddaway/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/RichardSiddaway"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@RichardSiddaway We could certainly add an option to specify a different working directory for the start menu shortcut (or nothing at all, pwsh would then start in the installation folder) but this would not address the problem highlighted by this issue where the working directory gets set too late.\r\nThe reason why the user can choose the installation folder is just because it is part of the basic WiX template that provides this functionality out of the box for free.",
    "created_at": "2018-10-18T17:17:08Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7895#issuecomment-431091152",
    "id": 431091152,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7895",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTA5MTE1Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/431091152/reactions"
    },
    "updated_at": "2018-10-18T17:20:03Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/431091152",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/9250262?v=4",
      "events_url": "https://api.github.com/users/bergmeister/events{/privacy}",
      "followers_url": "https://api.github.com/users/bergmeister/followers",
      "following_url": "https://api.github.com/users/bergmeister/following{/other_user}",
      "gists_url": "https://api.github.com/users/bergmeister/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/bergmeister",
      "id": 9250262,
      "login": "bergmeister",
      "node_id": "MDQ6VXNlcjkyNTAyNjI=",
      "organizations_url": "https://api.github.com/users/bergmeister/orgs",
      "received_events_url": "https://api.github.com/users/bergmeister/received_events",
      "repos_url": "https://api.github.com/users/bergmeister/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/bergmeister/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bergmeister/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/bergmeister"
    }
  },
  {
    "author_association": "NONE",
    "body": "It may not solve the conflict between the profile and the -workingdirectory parameter but it would effectively remove the conflict or the need to set a directory in your profile. It  would also be a potential (partial) solution to issue  #8069 ",
    "created_at": "2018-10-18T17:29:45Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7895#issuecomment-431095139",
    "id": 431095139,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7895",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTA5NTEzOQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/431095139/reactions"
    },
    "updated_at": "2018-10-18T17:29:45Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/431095139",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/7870545?v=4",
      "events_url": "https://api.github.com/users/RichardSiddaway/events{/privacy}",
      "followers_url": "https://api.github.com/users/RichardSiddaway/followers",
      "following_url": "https://api.github.com/users/RichardSiddaway/following{/other_user}",
      "gists_url": "https://api.github.com/users/RichardSiddaway/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/RichardSiddaway",
      "id": 7870545,
      "login": "RichardSiddaway",
      "node_id": "MDQ6VXNlcjc4NzA1NDU=",
      "organizations_url": "https://api.github.com/users/RichardSiddaway/orgs",
      "received_events_url": "https://api.github.com/users/RichardSiddaway/received_events",
      "repos_url": "https://api.github.com/users/RichardSiddaway/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/RichardSiddaway/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RichardSiddaway/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/RichardSiddaway"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "I think for the majority of users, having the `-WorkingDirectory ~` in the shortcut is the preferred experience to have it default to their home directory than $PSHOME.  The fix for this immediate problem is simple, just move the processing of `-WorkingDirectory` earlier although it could have a breaking change impact if $PROFILE expects to start in $PSHOME.",
    "created_at": "2018-10-19T01:07:42Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7895#issuecomment-431212379",
    "id": 431212379,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7895",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTIxMjM3OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/431212379/reactions"
    },
    "updated_at": "2018-10-19T01:07:42Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/431212379",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  }
]

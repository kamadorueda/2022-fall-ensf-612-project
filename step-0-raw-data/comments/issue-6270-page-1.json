[
  {
    "author_association": "COLLABORATOR",
    "body": "/cc @adityapatwardhan Could you please comment the Issue?",
    "created_at": "2018-02-28T18:45:30Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6270#issuecomment-369340857",
    "id": 369340857,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6270",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2OTM0MDg1Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/369340857/reactions"
    },
    "updated_at": "2018-02-28T18:45:30Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/369340857",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@jherby2k Did you upgrade versions for `Microsoft.PowerShell.Commands.Diagnostics` and `Microsoft.WSMan.Management` to `6.0.1.1` as well?\r\n\r\nYou can remove those from 6.0.1.1+ since the `Microsoft.PowerShell.SDK` includes them as a dependency.",
    "created_at": "2018-02-28T20:08:23Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6270#issuecomment-369366511",
    "id": 369366511,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6270",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2OTM2NjUxMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/369366511/reactions"
    },
    "updated_at": "2018-02-28T20:08:23Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/369366511",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12820925?v=4",
      "events_url": "https://api.github.com/users/adityapatwardhan/events{/privacy}",
      "followers_url": "https://api.github.com/users/adityapatwardhan/followers",
      "following_url": "https://api.github.com/users/adityapatwardhan/following{/other_user}",
      "gists_url": "https://api.github.com/users/adityapatwardhan/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/adityapatwardhan",
      "id": 12820925,
      "login": "adityapatwardhan",
      "node_id": "MDQ6VXNlcjEyODIwOTI1",
      "organizations_url": "https://api.github.com/users/adityapatwardhan/orgs",
      "received_events_url": "https://api.github.com/users/adityapatwardhan/received_events",
      "repos_url": "https://api.github.com/users/adityapatwardhan/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/adityapatwardhan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/adityapatwardhan/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/adityapatwardhan"
    }
  },
  {
    "author_association": "NONE",
    "body": "I did upgrade all 3, and then noticed the dependencies were added (thanks!), so removed them. Regardless, same issue.\n\nI made sure my build directories were clean, etc.\n\n",
    "created_at": "2018-02-28T20:14:29Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6270#issuecomment-369368183",
    "id": 369368183,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6270",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2OTM2ODE4Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/369368183/reactions"
    },
    "updated_at": "2018-02-28T20:14:29Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/369368183",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/9419251?v=4",
      "events_url": "https://api.github.com/users/jherby2k/events{/privacy}",
      "followers_url": "https://api.github.com/users/jherby2k/followers",
      "following_url": "https://api.github.com/users/jherby2k/following{/other_user}",
      "gists_url": "https://api.github.com/users/jherby2k/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jherby2k",
      "id": 9419251,
      "login": "jherby2k",
      "node_id": "MDQ6VXNlcjk0MTkyNTE=",
      "organizations_url": "https://api.github.com/users/jherby2k/orgs",
      "received_events_url": "https://api.github.com/users/jherby2k/received_events",
      "repos_url": "https://api.github.com/users/jherby2k/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jherby2k/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jherby2k/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jherby2k"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@jherby2k After running the tests on upgrading to `6.0.1.1` I am seeing these errors:\r\n```\r\n System.AggregateException : One or more errors occurred. (Object reference not set to an instance of an object.) (The following constructor parameters did not have matching fixture data: ModuleFixture moduleFixture)\r\n      ---- System.NullReferenceException : Object reference not set to an instance of an object.\r\n      ---- The following constructor parameters did not have matching fixture data: ModuleFixture moduleFixture\r\n      Stack Trace:\r\n\r\n        ----- Inner Stack Trace #1 (System.NullReferenceException) -----\r\n        D:\\OpenPowershell\\aditya\\AudioWorks\\AudioWorks\\AudioWorks.Commands.Tests\\ModuleFixture.cs(19,0): at AudioWorks.Commands.Tests.ModuleFixture..ctor()\r\n        ----- Inner Stack Trace #2 (Xunit.Sdk.TestClassException) -----\r\n```\r\n\r\nIs this what you see?",
    "created_at": "2018-02-28T23:05:46Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6270#issuecomment-369415144",
    "id": 369415144,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6270",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2OTQxNTE0NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/369415144/reactions"
    },
    "updated_at": "2018-02-28T23:05:46Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/369415144",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12820925?v=4",
      "events_url": "https://api.github.com/users/adityapatwardhan/events{/privacy}",
      "followers_url": "https://api.github.com/users/adityapatwardhan/followers",
      "following_url": "https://api.github.com/users/adityapatwardhan/following{/other_user}",
      "gists_url": "https://api.github.com/users/adityapatwardhan/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/adityapatwardhan",
      "id": 12820925,
      "login": "adityapatwardhan",
      "node_id": "MDQ6VXNlcjEyODIwOTI1",
      "organizations_url": "https://api.github.com/users/adityapatwardhan/orgs",
      "received_events_url": "https://api.github.com/users/adityapatwardhan/received_events",
      "repos_url": "https://api.github.com/users/adityapatwardhan/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/adityapatwardhan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/adityapatwardhan/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/adityapatwardhan"
    }
  },
  {
    "author_association": "NONE",
    "body": "Mmm, sort of. Are you using dotnet xunit? There is a known issue (i'm not sure how to fix) when running tests that way, regardless of PS SDK version. Using dotnet test, or Visual Studio, I get the following:\r\n\r\nSystem.AggregateException : One or more errors occurred. (Could not load file or assembly 'System.Management.Automation, Version=6.0.1.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'. The system cannot find the file specified.) (The following constructor parameters did not have matching fixture data: ModuleFixture moduleFixture)\r\n---- System.IO.FileNotFoundException : Could not load file or assembly 'System.Management.Automation, Version=6.0.1.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'. The system cannot find the file specified.\r\n---- The following constructor parameters did not have matching fixture data: ModuleFixture moduleFixture\r\n\r\nI use an xunit test fixture “Modulefixture” to create the PSCore runspace and load my module, and the constructor is failing because it can’t find System.Management.Automation version 6.0.1.0:\r\n\r\n            var state = InitialSessionState.CreateDefault();\r\n            state.ImportPSModule(new[]\r\n            {\r\n                Path.Combine(new DirectoryInfo(Directory.GetCurrentDirectory()).FullName, $\"{_moduleProject}.dll\")\r\n            });\r\n            Runspace = RunspaceFactory.CreateRunspace(state);\r\n            Runspace.Open();",
    "created_at": "2018-02-28T23:47:35Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6270#issuecomment-369423895",
    "id": 369423895,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6270",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2OTQyMzg5NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/369423895/reactions"
    },
    "updated_at": "2018-02-28T23:51:33Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/369423895",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/9419251?v=4",
      "events_url": "https://api.github.com/users/jherby2k/events{/privacy}",
      "followers_url": "https://api.github.com/users/jherby2k/followers",
      "following_url": "https://api.github.com/users/jherby2k/following{/other_user}",
      "gists_url": "https://api.github.com/users/jherby2k/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jherby2k",
      "id": 9419251,
      "login": "jherby2k",
      "node_id": "MDQ6VXNlcjk0MTkyNTE=",
      "organizations_url": "https://api.github.com/users/jherby2k/orgs",
      "received_events_url": "https://api.github.com/users/jherby2k/received_events",
      "repos_url": "https://api.github.com/users/jherby2k/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jherby2k/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jherby2k/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jherby2k"
    }
  },
  {
    "author_association": "NONE",
    "body": "I am having the same issue.\r\n\r\nI think this is due to the fact that `Microsoft.PowerShell.SDK` references `System.Management.Automation` at 6.0.1.1, but the _actual_ version of `System.Management.Automation` in the NuGet package appears to be 6.0.1.0.",
    "created_at": "2018-03-10T08:47:05Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6270#issuecomment-372014184",
    "id": 372014184,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6270",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MjAxNDE4NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/372014184/reactions"
    },
    "updated_at": "2018-03-10T08:47:05Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/372014184",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/549523?v=4",
      "events_url": "https://api.github.com/users/twitchax/events{/privacy}",
      "followers_url": "https://api.github.com/users/twitchax/followers",
      "following_url": "https://api.github.com/users/twitchax/following{/other_user}",
      "gists_url": "https://api.github.com/users/twitchax/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/twitchax",
      "id": 549523,
      "login": "twitchax",
      "node_id": "MDQ6VXNlcjU0OTUyMw==",
      "organizations_url": "https://api.github.com/users/twitchax/orgs",
      "received_events_url": "https://api.github.com/users/twitchax/received_events",
      "repos_url": "https://api.github.com/users/twitchax/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/twitchax/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/twitchax/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/twitchax"
    }
  },
  {
    "author_association": "NONE",
    "body": "Indeed, if i look in the nuget package 6.0.1.1, all the System.Management.Automation.dll libs are version 6.0.1.0. Surprised this got past QC.",
    "created_at": "2018-03-10T20:58:40Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6270#issuecomment-372066178",
    "id": 372066178,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6270",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MjA2NjE3OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/372066178/reactions"
    },
    "updated_at": "2018-03-10T20:58:40Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/372066178",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/9419251?v=4",
      "events_url": "https://api.github.com/users/jherby2k/events{/privacy}",
      "followers_url": "https://api.github.com/users/jherby2k/followers",
      "following_url": "https://api.github.com/users/jherby2k/following{/other_user}",
      "gists_url": "https://api.github.com/users/jherby2k/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jherby2k",
      "id": 9419251,
      "login": "jherby2k",
      "node_id": "MDQ6VXNlcjk0MTkyNTE=",
      "organizations_url": "https://api.github.com/users/jherby2k/orgs",
      "received_events_url": "https://api.github.com/users/jherby2k/received_events",
      "repos_url": "https://api.github.com/users/jherby2k/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jherby2k/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jherby2k/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jherby2k"
    }
  },
  {
    "author_association": "NONE",
    "body": "@jherby2k, despite the version issue, you might want to try looking around your dependencies and targets files.  I found a rogue `<PackageReference Include=\"System.Management.Automation\" Version=\"6.0.0\" />` that caused problems.  Fixed that, and everything was good.",
    "created_at": "2018-03-11T02:08:08Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6270#issuecomment-372083272",
    "id": 372083272,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6270",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MjA4MzI3Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/372083272/reactions"
    },
    "updated_at": "2018-03-11T02:08:08Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/372083272",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/549523?v=4",
      "events_url": "https://api.github.com/users/twitchax/events{/privacy}",
      "followers_url": "https://api.github.com/users/twitchax/followers",
      "following_url": "https://api.github.com/users/twitchax/following{/other_user}",
      "gists_url": "https://api.github.com/users/twitchax/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/twitchax",
      "id": 549523,
      "login": "twitchax",
      "node_id": "MDQ6VXNlcjU0OTUyMw==",
      "organizations_url": "https://api.github.com/users/twitchax/orgs",
      "received_events_url": "https://api.github.com/users/twitchax/received_events",
      "repos_url": "https://api.github.com/users/twitchax/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/twitchax/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/twitchax/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/twitchax"
    }
  },
  {
    "author_association": "NONE",
    "body": "Found the problem - the project referencing Microsoft.PowerShell.SDK is a test project, which is testing a binary module that uses the PowerShell Standard 5.1 (preview) library. That includes its own stub version of System.Management.Automation. Not sure why this is only a problem as of 6.0.1.1, but whatever. Since its not really a compile-time dependency (i'm importing the module into the runspace), I changed it to an after-build xcopy, and now everthing is fine. In case anyone else encounters this.",
    "created_at": "2018-03-20T15:49:47Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6270#issuecomment-374648853",
    "id": 374648853,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6270",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NDY0ODg1Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/374648853/reactions"
    },
    "updated_at": "2018-03-20T15:49:47Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/374648853",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/9419251?v=4",
      "events_url": "https://api.github.com/users/jherby2k/events{/privacy}",
      "followers_url": "https://api.github.com/users/jherby2k/followers",
      "following_url": "https://api.github.com/users/jherby2k/following{/other_user}",
      "gists_url": "https://api.github.com/users/jherby2k/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jherby2k",
      "id": 9419251,
      "login": "jherby2k",
      "node_id": "MDQ6VXNlcjk0MTkyNTE=",
      "organizations_url": "https://api.github.com/users/jherby2k/orgs",
      "received_events_url": "https://api.github.com/users/jherby2k/received_events",
      "repos_url": "https://api.github.com/users/jherby2k/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jherby2k/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jherby2k/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jherby2k"
    }
  }
]

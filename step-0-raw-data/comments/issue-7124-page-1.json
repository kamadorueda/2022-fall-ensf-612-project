[
  {
    "author_association": "MEMBER",
    "body": "There are certainly some significant performance gains possible, but I don't think targeting the `Write-` commands is a good approach.\r\n\r\nSome issues:\r\n\r\n* What if the command is a function or alias, not the built in cmdlet?\r\n* What if the command forces the action, e.g. `Write-Verbose \"Hi there\" -Verbose`?\r\n\r\nThese 2 issues hit general performance issues (command lookup and parameter binding) that have room for **major** improvements.\r\n\r\nIf command lookup and parameter binding are fast, I have a feeling you won't care about the minor overhead of actually calling into the `Write-` commands.",
    "created_at": "2018-06-21T17:46:23Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7124#issuecomment-399187825",
    "id": 399187825,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7124",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5OTE4NzgyNQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/399187825/reactions"
    },
    "updated_at": "2018-06-21T17:46:23Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/399187825",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/2148248?v=4",
      "events_url": "https://api.github.com/users/lzybkr/events{/privacy}",
      "followers_url": "https://api.github.com/users/lzybkr/followers",
      "following_url": "https://api.github.com/users/lzybkr/following{/other_user}",
      "gists_url": "https://api.github.com/users/lzybkr/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/lzybkr",
      "id": 2148248,
      "login": "lzybkr",
      "node_id": "MDQ6VXNlcjIxNDgyNDg=",
      "organizations_url": "https://api.github.com/users/lzybkr/orgs",
      "received_events_url": "https://api.github.com/users/lzybkr/received_events",
      "repos_url": "https://api.github.com/users/lzybkr/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/lzybkr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lzybkr/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/lzybkr"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Thanks @lzybkr, that's good food for thought.",
    "created_at": "2018-06-21T18:35:19Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7124#issuecomment-399201951",
    "id": 399201951,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7124",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5OTIwMTk1MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/399201951/reactions"
    },
    "updated_at": "2018-06-21T18:35:19Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/399201951",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/3515485?v=4",
      "events_url": "https://api.github.com/users/KirkMunro/events{/privacy}",
      "followers_url": "https://api.github.com/users/KirkMunro/followers",
      "following_url": "https://api.github.com/users/KirkMunro/following{/other_user}",
      "gists_url": "https://api.github.com/users/KirkMunro/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/KirkMunro",
      "id": 3515485,
      "login": "KirkMunro",
      "node_id": "MDQ6VXNlcjM1MTU0ODU=",
      "organizations_url": "https://api.github.com/users/KirkMunro/orgs",
      "received_events_url": "https://api.github.com/users/KirkMunro/received_events",
      "repos_url": "https://api.github.com/users/KirkMunro/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/KirkMunro/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/KirkMunro/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/KirkMunro"
    }
  },
  {
    "author_association": "NONE",
    "body": "I came to the same question from a security and performance view, taking the following example:\r\n\r\n```\r\n$Credential = Get-Credential\r\nWrite-Debug \"Password: $(($credential.GetNetworkCredential()).Password)\"\r\n```\r\n<sub>(I suspect that the plaintext password will always be visible in memory using the above command even your not in debug mode)</sub>\r\n\r\n<del>That the `Write-Debug` evaluates the message appears from:\r\nWrite-Debug \"$(Write-Host 'Host') Debug\"\r\nWhere the word `Host` is always displayed no matter of the `$DebugPreference`</del>\r\n\r\nFrom my point of view it would make sense that the `$DebugPreference` (and similar `Write-*` cmdlets) would have (default?) `Bypass` value.\r\n",
    "created_at": "2018-10-25T15:16:42Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7124#issuecomment-433091974",
    "id": 433091974,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7124",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMzA5MTk3NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/433091974/reactions"
    },
    "updated_at": "2018-10-26T10:11:40Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/433091974",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8080834?v=4",
      "events_url": "https://api.github.com/users/iRon7/events{/privacy}",
      "followers_url": "https://api.github.com/users/iRon7/followers",
      "following_url": "https://api.github.com/users/iRon7/following{/other_user}",
      "gists_url": "https://api.github.com/users/iRon7/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iRon7",
      "id": 8080834,
      "login": "iRon7",
      "node_id": "MDQ6VXNlcjgwODA4MzQ=",
      "organizations_url": "https://api.github.com/users/iRon7/orgs",
      "received_events_url": "https://api.github.com/users/iRon7/received_events",
      "repos_url": "https://api.github.com/users/iRon7/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iRon7/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iRon7/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iRon7"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "`Write-Host` is explicitly coded to display by default unless you set `-InformationAction Ignore`, it's kind of what it's designed for. Subexpressions are evaluated before being passed to the command invocation.\r\n\r\nI'd also contend that silencing or skipping the write cmdlets entirely would only ever make sense if their corresponding `Action` parameter or `Preference` variable is set explicitly to `Ignore` -- in all other cases users or administrators will often want the data to be captured in a transcript if one is running, so skipping the call completely isn't often really an option.\r\n\r\n@lzybkr you mention that there are improvements to be made here. Is this a current focus for the PS team, or is this something I could take a look at? (And if so, I'd appreciate a pointer to where this code is so I or others can check it out!) ðŸ˜„ ",
    "created_at": "2018-10-25T15:31:47Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7124#issuecomment-433097988",
    "id": 433097988,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7124",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMzA5Nzk4OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/433097988/reactions"
    },
    "updated_at": "2018-10-25T15:31:47Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/433097988",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/32407840?v=4",
      "events_url": "https://api.github.com/users/vexx32/events{/privacy}",
      "followers_url": "https://api.github.com/users/vexx32/followers",
      "following_url": "https://api.github.com/users/vexx32/following{/other_user}",
      "gists_url": "https://api.github.com/users/vexx32/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vexx32",
      "id": 32407840,
      "login": "vexx32",
      "node_id": "MDQ6VXNlcjMyNDA3ODQw",
      "organizations_url": "https://api.github.com/users/vexx32/orgs",
      "received_events_url": "https://api.github.com/users/vexx32/received_events",
      "repos_url": "https://api.github.com/users/vexx32/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vexx32/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vexx32/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vexx32"
    }
  },
  {
    "author_association": "NONE",
    "body": "Hello vexx32,\r\n\r\nThanks for the comment. You are right, the string is of cause already evaluated before it is passed to the `Write-Debug` cmdlet. I wonder whether being able to provide a `ScriptBlock`  for the `-Message` parameter (which is then evaluated by the `Write-*` cmdlets: `&$Message`) would make sense.\r\n\r\nSomething like:\r\n\r\n````\r\nWrite-Verbose -Message {Get-Service | Format-List * | Out-String}\r\n````\r\n\r\nor:\r\n\r\n````\r\nWrite-Debug -Message {\"Password: $(($credential.GetNetworkCredential()).Password)\"}\r\n````\r\n\r\nOr is that where KirkMunro actually asks for?\r\n\r\n",
    "created_at": "2018-10-25T15:53:39Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7124#issuecomment-433106221",
    "id": 433106221,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7124",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMzEwNjIyMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/433106221/reactions"
    },
    "updated_at": "2018-10-25T15:59:07Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/433106221",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8080834?v=4",
      "events_url": "https://api.github.com/users/iRon7/events{/privacy}",
      "followers_url": "https://api.github.com/users/iRon7/followers",
      "following_url": "https://api.github.com/users/iRon7/following{/other_user}",
      "gists_url": "https://api.github.com/users/iRon7/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iRon7",
      "id": 8080834,
      "login": "iRon7",
      "node_id": "MDQ6VXNlcjgwODA4MzQ=",
      "organizations_url": "https://api.github.com/users/iRon7/orgs",
      "received_events_url": "https://api.github.com/users/iRon7/received_events",
      "repos_url": "https://api.github.com/users/iRon7/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iRon7/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iRon7/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iRon7"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "I believe @KirkMunro is asking for something like [ConditionalAttribute](https://docs.microsoft.com/en-us/dotnet/api/system.diagnostics.conditionalattribute?view=netframework-4.7.2) with the difference being PowerShell would inject a runtime check for the preference variable around the call to the command.\r\n\r\n@vexx32 - the improvements I have in mind are a major work item and I'm not aware of anyone that is seriously looking at. The basic idea is to use dynamic sites (like what is used for operators and member access) for command lookup and parameter binding, basically introducing a layer on top of the existing code. These areas probably have room for more incremental improvements too, but it will take some digging with a profiler and probably some creativity combined with some deep understanding of how those areas work.",
    "created_at": "2018-10-25T16:34:51Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7124#issuecomment-433120529",
    "id": 433120529,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7124",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMzEyMDUyOQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/433120529/reactions"
    },
    "updated_at": "2018-10-25T16:34:51Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/433120529",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/2148248?v=4",
      "events_url": "https://api.github.com/users/lzybkr/events{/privacy}",
      "followers_url": "https://api.github.com/users/lzybkr/followers",
      "following_url": "https://api.github.com/users/lzybkr/following{/other_user}",
      "gists_url": "https://api.github.com/users/lzybkr/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/lzybkr",
      "id": 2148248,
      "login": "lzybkr",
      "node_id": "MDQ6VXNlcjIxNDgyNDg=",
      "organizations_url": "https://api.github.com/users/lzybkr/orgs",
      "received_events_url": "https://api.github.com/users/lzybkr/received_events",
      "repos_url": "https://api.github.com/users/lzybkr/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/lzybkr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lzybkr/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/lzybkr"
    }
  }
]

[
  {
    "author_association": "NONE",
    "body": "Can verify this reproduces\n",
    "created_at": "2016-08-29T15:42:15Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2108#issuecomment-243162781",
    "id": 243162781,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2108",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0MzE2Mjc4MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/243162781/reactions"
    },
    "updated_at": "2016-08-29T15:42:15Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/243162781",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6564656?v=4",
      "events_url": "https://api.github.com/users/JanivZ/events{/privacy}",
      "followers_url": "https://api.github.com/users/JanivZ/followers",
      "following_url": "https://api.github.com/users/JanivZ/following{/other_user}",
      "gists_url": "https://api.github.com/users/JanivZ/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/JanivZ",
      "id": 6564656,
      "login": "JanivZ",
      "node_id": "MDQ6VXNlcjY1NjQ2NTY=",
      "organizations_url": "https://api.github.com/users/JanivZ/orgs",
      "received_events_url": "https://api.github.com/users/JanivZ/received_events",
      "repos_url": "https://api.github.com/users/JanivZ/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/JanivZ/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JanivZ/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/JanivZ"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Thank you for reporting it @svick !\n\nIndeed, the nuget package provided `Microsoft.PowerShell.SDK` for alpha9 has windows-specific implementation.\nThe scenario that you are describing (hosting PS in you own program) is not currently supported. There are mulitply issues that we need to address first to enable it. Here are few:\n- Remove need in [custom Assembly Load Context](https://github.com/PowerShell/PowerShell/blob/61255447a03730592dd55623e5a559eacdcac7ba/src/powershell/Program.cs#L27) (ALC for short). This is CoreCLR hosting model and we are blocked until CoreCLR will have an equivalent of `AppDomain.GetAssemblies()`. This is the biggest issue and external blocker for us.\n- Create nuget packages that contains both unix and windows compiled assemblies.\n- Publish `Microsoft.PowerShell.Diagnostics` nuget package (the current list is [here](https://github.com/PowerShell/PowerShell/blob/61255447a03730592dd55623e5a559eacdcac7ba/build.psm1#L1164))\n\nThe scenario that we are targeting with current `Microsoft.PowerShell.SDK` is the following:\nYou should be able to author a **binary powershell module** and use it later in the powershell session.\n",
    "created_at": "2016-08-31T12:15:45Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2108#issuecomment-243745770",
    "id": 243745770,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2108",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0Mzc0NTc3MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 3,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 3,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/243745770/reactions"
    },
    "updated_at": "2016-08-31T12:16:47Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/243745770",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/816680?v=4",
      "events_url": "https://api.github.com/users/vors/events{/privacy}",
      "followers_url": "https://api.github.com/users/vors/followers",
      "following_url": "https://api.github.com/users/vors/following{/other_user}",
      "gists_url": "https://api.github.com/users/vors/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vors",
      "id": 816680,
      "login": "vors",
      "node_id": "MDQ6VXNlcjgxNjY4MA==",
      "organizations_url": "https://api.github.com/users/vors/orgs",
      "received_events_url": "https://api.github.com/users/vors/received_events",
      "repos_url": "https://api.github.com/users/vors/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vors/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vors"
    }
  },
  {
    "author_association": "NONE",
    "body": "I am doing the following as a workaround, but it is not ideal. Anyone knows of a better way to use powershell from dotnet core linux?\n\n```\n        ProcessStartInfo psi = new ProcessStartInfo();\n        psi.FileName = \"powershell\";\n        psi.UseShellExecute = false;\n        psi.RedirectStandardOutput = true;\n\n        psi.Arguments = \"Get-Host\";\n        Process p  = Process.Start(psi);\n        string strOutput = p.StandardOutput.ReadToEnd();\n        p.WaitForExit();\n        Console.WriteLine(strOutput);\n```\n",
    "created_at": "2016-10-14T00:33:40Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2108#issuecomment-253678515",
    "id": 253678515,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2108",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1MzY3ODUxNQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/253678515/reactions"
    },
    "updated_at": "2016-10-14T00:33:40Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/253678515",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22827336?v=4",
      "events_url": "https://api.github.com/users/enriquelk/events{/privacy}",
      "followers_url": "https://api.github.com/users/enriquelk/followers",
      "following_url": "https://api.github.com/users/enriquelk/following{/other_user}",
      "gists_url": "https://api.github.com/users/enriquelk/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/enriquelk",
      "id": 22827336,
      "login": "enriquelk",
      "node_id": "MDQ6VXNlcjIyODI3MzM2",
      "organizations_url": "https://api.github.com/users/enriquelk/orgs",
      "received_events_url": "https://api.github.com/users/enriquelk/received_events",
      "repos_url": "https://api.github.com/users/enriquelk/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/enriquelk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/enriquelk/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/enriquelk"
    }
  },
  {
    "author_association": "NONE",
    "body": "Hi @svick \r\n\r\nDid you find out the way to execute PS file in .Net core?\r\nI have installed .Net core 2.0 preview but it does not seems to work.\r\n\r\n\r\n",
    "created_at": "2017-06-08T09:03:30Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2108#issuecomment-307044200",
    "id": 307044200,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2108",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNzA0NDIwMA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/307044200/reactions"
    },
    "updated_at": "2017-06-08T09:03:30Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/307044200",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/5907220?v=4",
      "events_url": "https://api.github.com/users/sonphnt/events{/privacy}",
      "followers_url": "https://api.github.com/users/sonphnt/followers",
      "following_url": "https://api.github.com/users/sonphnt/following{/other_user}",
      "gists_url": "https://api.github.com/users/sonphnt/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/sonphnt",
      "id": 5907220,
      "login": "sonphnt",
      "node_id": "MDQ6VXNlcjU5MDcyMjA=",
      "organizations_url": "https://api.github.com/users/sonphnt/orgs",
      "received_events_url": "https://api.github.com/users/sonphnt/received_events",
      "repos_url": "https://api.github.com/users/sonphnt/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/sonphnt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sonphnt/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/sonphnt"
    }
  },
  {
    "author_association": "NONE",
    "body": "How's the progress of \"hosting PS in you own program\" doing?\r\nI need this feature badly. :sweat_smile:",
    "created_at": "2017-08-13T11:24:01Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2108#issuecomment-322036240",
    "id": 322036240,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2108",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyMjAzNjI0MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/322036240/reactions"
    },
    "updated_at": "2017-08-13T11:24:17Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/322036240",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/10591975?v=4",
      "events_url": "https://api.github.com/users/WilliamWsyHK/events{/privacy}",
      "followers_url": "https://api.github.com/users/WilliamWsyHK/followers",
      "following_url": "https://api.github.com/users/WilliamWsyHK/following{/other_user}",
      "gists_url": "https://api.github.com/users/WilliamWsyHK/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/WilliamWsyHK",
      "id": 10591975,
      "login": "WilliamWsyHK",
      "node_id": "MDQ6VXNlcjEwNTkxOTc1",
      "organizations_url": "https://api.github.com/users/WilliamWsyHK/orgs",
      "received_events_url": "https://api.github.com/users/WilliamWsyHK/received_events",
      "repos_url": "https://api.github.com/users/WilliamWsyHK/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/WilliamWsyHK/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WilliamWsyHK/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/WilliamWsyHK"
    }
  },
  {
    "author_association": "NONE",
    "body": "I'm encounting this issue now, trying to unit test a binary module I am writing for PowerShell core. This is a big issue! Any workaround??\r\n\r\nStill an issue with .NET core 2.0 (rtm) test project and PowerShell Core 6.0.0 beta 6.",
    "created_at": "2017-08-15T15:42:55Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2108#issuecomment-322505318",
    "id": 322505318,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2108",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyMjUwNTMxOA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/322505318/reactions"
    },
    "updated_at": "2017-08-15T15:43:30Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/322505318",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/9419251?v=4",
      "events_url": "https://api.github.com/users/jherby2k/events{/privacy}",
      "followers_url": "https://api.github.com/users/jherby2k/followers",
      "following_url": "https://api.github.com/users/jherby2k/following{/other_user}",
      "gists_url": "https://api.github.com/users/jherby2k/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jherby2k",
      "id": 9419251,
      "login": "jherby2k",
      "node_id": "MDQ6VXNlcjk0MTkyNTE=",
      "organizations_url": "https://api.github.com/users/jherby2k/orgs",
      "received_events_url": "https://api.github.com/users/jherby2k/received_events",
      "repos_url": "https://api.github.com/users/jherby2k/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jherby2k/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jherby2k/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jherby2k"
    }
  },
  {
    "author_association": "NONE",
    "body": "@sonphnt, @WilliamWsyHK, @jherby2k \r\n\r\nIt works, but it's not like the old way where you just reference System.Management.Automation.   I ran into the same issue and found this page.  Then I started to look in the docs in the repo and found:\r\nhttps://github.com/PowerShell/PowerShell/tree/master/docs/host-powershell\r\n\r\nThere is a sample app here: https://github.com/PowerShell/PowerShell/tree/master/docs/host-powershell/sample-dotnet2.0-powershell.beta.3\r\n\r\nyou need to copy the Nuget.config from the project. If you're using VS, target the powershell feed withing the UI. \r\n\r\nthen install the following packages\r\n```xml\r\n    <PackageReference Include=\"Microsoft.PowerShell.SDK\" Version=\"6.0.0-beta.7\" />\r\n    <PackageReference Include=\"Microsoft.WSMan.Management\" Version=\"6.0.0-beta.7\" />\r\n    <PackageReference Include=\"Microsoft.PowerShell.Commands.Diagnostics\" Version=\"6.0.0-beta.7\" />\r\n```\r\n\r\n",
    "created_at": "2017-09-18T03:25:57Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2108#issuecomment-330122545",
    "id": 330122545,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2108",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMDEyMjU0NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 5,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 5,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/330122545/reactions"
    },
    "updated_at": "2017-09-18T03:25:57Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/330122545",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/16062541?v=4",
      "events_url": "https://api.github.com/users/michaelherndon/events{/privacy}",
      "followers_url": "https://api.github.com/users/michaelherndon/followers",
      "following_url": "https://api.github.com/users/michaelherndon/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelherndon/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/michaelherndon",
      "id": 16062541,
      "login": "michaelherndon",
      "node_id": "MDQ6VXNlcjE2MDYyNTQx",
      "organizations_url": "https://api.github.com/users/michaelherndon/orgs",
      "received_events_url": "https://api.github.com/users/michaelherndon/received_events",
      "repos_url": "https://api.github.com/users/michaelherndon/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/michaelherndon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelherndon/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/michaelherndon"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@SteveL-MSFT Can we close the Issue because we update nuget SDK package and docs?",
    "created_at": "2017-09-29T09:20:31Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2108#issuecomment-333076625",
    "id": 333076625,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2108",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMzA3NjYyNQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/333076625/reactions"
    },
    "updated_at": "2017-09-29T09:20:31Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/333076625",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "I'm getting the same exception in version 6.0.1",
    "created_at": "2018-02-12T12:31:16Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2108#issuecomment-364909490",
    "id": 364909490,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2108",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2NDkwOTQ5MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/364909490/reactions"
    },
    "updated_at": "2018-02-12T12:31:16Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/364909490",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/2167301?v=4",
      "events_url": "https://api.github.com/users/ahmadalli/events{/privacy}",
      "followers_url": "https://api.github.com/users/ahmadalli/followers",
      "following_url": "https://api.github.com/users/ahmadalli/following{/other_user}",
      "gists_url": "https://api.github.com/users/ahmadalli/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ahmadalli",
      "id": 2167301,
      "login": "ahmadalli",
      "node_id": "MDQ6VXNlcjIxNjczMDE=",
      "organizations_url": "https://api.github.com/users/ahmadalli/orgs",
      "received_events_url": "https://api.github.com/users/ahmadalli/received_events",
      "repos_url": "https://api.github.com/users/ahmadalli/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ahmadalli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ahmadalli/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ahmadalli"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "A new nuget package is being published (6.0.1.1) which will include cross platform runtimes instead of being Windows specific.  Should be this week.",
    "created_at": "2018-02-12T18:19:47Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2108#issuecomment-365013136",
    "id": 365013136,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2108",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2NTAxMzEzNg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/365013136/reactions"
    },
    "updated_at": "2018-02-12T18:19:47Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/365013136",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "NONE",
    "body": "This is still reproducing for me with `<PackageReference Include=\"System.Management.Automation\" Version=\"6.2.2\" />` on Windows 10 with `dotnet test`\r\n\r\n",
    "created_at": "2019-08-16T11:43:47Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2108#issuecomment-521981450",
    "id": 521981450,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2108",
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyMTk4MTQ1MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/521981450/reactions"
    },
    "updated_at": "2019-08-16T11:43:57Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/521981450",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/7135690?v=4",
      "events_url": "https://api.github.com/users/cosminstirbu/events{/privacy}",
      "followers_url": "https://api.github.com/users/cosminstirbu/followers",
      "following_url": "https://api.github.com/users/cosminstirbu/following{/other_user}",
      "gists_url": "https://api.github.com/users/cosminstirbu/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/cosminstirbu",
      "id": 7135690,
      "login": "cosminstirbu",
      "node_id": "MDQ6VXNlcjcxMzU2OTA=",
      "organizations_url": "https://api.github.com/users/cosminstirbu/orgs",
      "received_events_url": "https://api.github.com/users/cosminstirbu/received_events",
      "repos_url": "https://api.github.com/users/cosminstirbu/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/cosminstirbu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cosminstirbu/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/cosminstirbu"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@cosminstirbu Please open new issue with repo steps.",
    "created_at": "2019-08-16T13:35:07Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2108#issuecomment-522010788",
    "id": 522010788,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2108",
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyMjAxMDc4OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/522010788/reactions"
    },
    "updated_at": "2019-08-16T13:35:07Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/522010788",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "@cosminstirbu for me it was enough to install Microsoft.PowerShell.SDK (6.2.3)",
    "created_at": "2019-09-27T05:35:01Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2108#issuecomment-535793465",
    "id": 535793465,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2108",
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzNTc5MzQ2NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/535793465/reactions"
    },
    "updated_at": "2019-09-27T05:35:01Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/535793465",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24812998?v=4",
      "events_url": "https://api.github.com/users/steinbachio/events{/privacy}",
      "followers_url": "https://api.github.com/users/steinbachio/followers",
      "following_url": "https://api.github.com/users/steinbachio/following{/other_user}",
      "gists_url": "https://api.github.com/users/steinbachio/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/steinbachio",
      "id": 24812998,
      "login": "steinbachio",
      "node_id": "MDQ6VXNlcjI0ODEyOTk4",
      "organizations_url": "https://api.github.com/users/steinbachio/orgs",
      "received_events_url": "https://api.github.com/users/steinbachio/received_events",
      "repos_url": "https://api.github.com/users/steinbachio/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/steinbachio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steinbachio/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/steinbachio"
    }
  },
  {
    "author_association": "NONE",
    "body": "Yeap, I confirm that installing Microsoft.PowerShell.SDK (6.2.3) did the trick.",
    "created_at": "2019-09-27T08:30:40Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2108#issuecomment-535846424",
    "id": 535846424,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2108",
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzNTg0NjQyNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 5,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 5,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/535846424/reactions"
    },
    "updated_at": "2019-09-27T08:30:40Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/535846424",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/7135690?v=4",
      "events_url": "https://api.github.com/users/cosminstirbu/events{/privacy}",
      "followers_url": "https://api.github.com/users/cosminstirbu/followers",
      "following_url": "https://api.github.com/users/cosminstirbu/following{/other_user}",
      "gists_url": "https://api.github.com/users/cosminstirbu/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/cosminstirbu",
      "id": 7135690,
      "login": "cosminstirbu",
      "node_id": "MDQ6VXNlcjcxMzU2OTA=",
      "organizations_url": "https://api.github.com/users/cosminstirbu/orgs",
      "received_events_url": "https://api.github.com/users/cosminstirbu/received_events",
      "repos_url": "https://api.github.com/users/cosminstirbu/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/cosminstirbu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cosminstirbu/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/cosminstirbu"
    }
  },
  {
    "author_association": "NONE",
    "body": "If I use Microsoft.PowerShell.SDK (6.2.3), I am getting the below error.\r\n\r\nThe term 'Add-MpPreference' is not recognized as the name of a cmdlet, function, script file, or operable program.\r\n\r\nIs there any workaround to fix this?",
    "created_at": "2021-10-18T07:30:38Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2108#issuecomment-945444153",
    "id": 945444153,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2108",
    "node_id": "IC_kwDOAvT7bc44WlU5",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/945444153/reactions"
    },
    "updated_at": "2021-10-18T07:30:38Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/945444153",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/7305865?v=4",
      "events_url": "https://api.github.com/users/lalitzz/events{/privacy}",
      "followers_url": "https://api.github.com/users/lalitzz/followers",
      "following_url": "https://api.github.com/users/lalitzz/following{/other_user}",
      "gists_url": "https://api.github.com/users/lalitzz/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/lalitzz",
      "id": 7305865,
      "login": "lalitzz",
      "node_id": "MDQ6VXNlcjczMDU4NjU=",
      "organizations_url": "https://api.github.com/users/lalitzz/orgs",
      "received_events_url": "https://api.github.com/users/lalitzz/received_events",
      "repos_url": "https://api.github.com/users/lalitzz/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/lalitzz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lalitzz/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/lalitzz"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "> Add-MpPreference\r\n\r\nI guess the module is not compatible with PowerShell Core. You can try to run the cmdlet in interactive session. Also you could try WinCompat feature of Import-Module cmdlet.",
    "created_at": "2021-10-18T07:54:30Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2108#issuecomment-945462435",
    "id": 945462435,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2108",
    "node_id": "IC_kwDOAvT7bc44Wpyj",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/945462435/reactions"
    },
    "updated_at": "2021-10-18T07:54:30Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/945462435",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "For anyone referring this later.\r\n\r\nI manually added the modules.\r\nTried this:\r\n```csharp\r\n  var initialState = InitialSessionState.CreateDefault2();\r\n  initialState.ExecutionPolicy = Microsoft.PowerShell.ExecutionPolicy.Unrestricted;\r\n  if (this.options.ModulesToImport != null && this.options.ModulesToImport.Any())\r\n  {\r\n      initialState.ImportPSModule(this.options.ModulesToImport.ToArray());\r\n  }\r\n\r\n  string[] foo = { \"ConfigDefender\" };\r\n  initialState.ImportPSModule(foo);\r\n```\r\n\r\nAlso this:\r\n```csharp\r\nvar powerShell = System.Management.Automation.PowerShell.Create()\r\npowerShell.AddCommand(\"Import-Module\");\r\npowerShell.AddParameter(\"SkipEditionCheck\");\r\npowerShell.AddArgument(\"ConfigDefender\");\r\npowerShell.Invoke();\r\n```\r\n\r\nLastly got stuck with permission issue:\r\n```\r\nYou don't have enough permissions to perform the requested operation.) ---> Microsoft.Management.Infrastructure.CimException: You don't have enough permissions to perform the requested operation\r\n```\r\n\r\nI guess the only fix for the above is to open the powershell session  as an admin(Not sure if this is possible with the current library). Would really appreciate if someone can provide pointer to this?",
    "created_at": "2021-10-18T12:04:30Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2108#issuecomment-945695742",
    "id": 945695742,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2108",
    "node_id": "IC_kwDOAvT7bc44Xiv-",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/945695742/reactions"
    },
    "updated_at": "2021-10-18T12:04:30Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/945695742",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/7305865?v=4",
      "events_url": "https://api.github.com/users/lalitzz/events{/privacy}",
      "followers_url": "https://api.github.com/users/lalitzz/followers",
      "following_url": "https://api.github.com/users/lalitzz/following{/other_user}",
      "gists_url": "https://api.github.com/users/lalitzz/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/lalitzz",
      "id": 7305865,
      "login": "lalitzz",
      "node_id": "MDQ6VXNlcjczMDU4NjU=",
      "organizations_url": "https://api.github.com/users/lalitzz/orgs",
      "received_events_url": "https://api.github.com/users/lalitzz/received_events",
      "repos_url": "https://api.github.com/users/lalitzz/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/lalitzz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lalitzz/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/lalitzz"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "> I guess the only fix for the above is to open the powershell session as an admin(Not sure if this is possible with the current library). Would really appreciate if someone can provide pointer to this?\r\n\r\nYou should run elevated process - parent or child.",
    "created_at": "2021-10-18T13:26:31Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2108#issuecomment-945766548",
    "id": 945766548,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2108",
    "node_id": "IC_kwDOAvT7bc44X0CU",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/945766548/reactions"
    },
    "updated_at": "2021-10-18T13:26:31Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/945766548",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  }
]

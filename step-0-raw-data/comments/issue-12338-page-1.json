[
  {
    "author_association": "COLLABORATOR",
    "body": "If an event is raised on a thread other than the default runspace thread then that's expected.  That is (I assume) a large part of why `Register-ObjectEvent` exists.  Is there an issue you're running into that you believe using the add accessor directly would resolve?",
    "created_at": "2020-04-16T12:47:03Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12338#issuecomment-614630713",
    "id": 614630713,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12338",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxNDYzMDcxMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/614630713/reactions"
    },
    "updated_at": "2020-04-16T12:47:03Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/614630713",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  },
  {
    "author_association": "NONE",
    "body": "I am surprised that this would fail when other Add_EventName methods work for objects like buttons and other controls for forms. If I understand your explanation, this is specifically related to the fact that the event source is derived from a child process, right?\r\n\r\nAt a glance there is no functional difference for me to use Register-ObjectEvent for my use case. It is purely stylistic preference.",
    "created_at": "2020-04-16T14:26:46Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12338#issuecomment-614687410",
    "id": 614687410,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12338",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxNDY4NzQxMA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/614687410/reactions"
    },
    "updated_at": "2020-04-16T14:27:57Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/614687410",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/58513470?v=4",
      "events_url": "https://api.github.com/users/mosullivan-wyse/events{/privacy}",
      "followers_url": "https://api.github.com/users/mosullivan-wyse/followers",
      "following_url": "https://api.github.com/users/mosullivan-wyse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mosullivan-wyse/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mosullivan-wyse",
      "id": 58513470,
      "login": "mosullivan-wyse",
      "node_id": "MDQ6VXNlcjU4NTEzNDcw",
      "organizations_url": "https://api.github.com/users/mosullivan-wyse/orgs",
      "received_events_url": "https://api.github.com/users/mosullivan-wyse/received_events",
      "repos_url": "https://api.github.com/users/mosullivan-wyse/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mosullivan-wyse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mosullivan-wyse/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mosullivan-wyse"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "> If I understand your explanation, this is specifically related to the fact that the event source is derived from a child process, right?\r\n\r\nIt's dependent on what thread the event is raised on. For example take this class:\r\n\r\n```powershell\r\nAdd-Type -TypeDefinition '\r\n    using System;\r\n    using System.Threading;\r\n\r\n    public class Test\r\n    {\r\n        public event EventHandler ThingHappened;\r\n\r\n        public void TriggerThingHappened()\r\n        {\r\n            new Thread(() => this.ThingHappened?.Invoke(this, null)).Start();\r\n        }\r\n    }'\r\n\r\n$test = [test]::new()\r\n$test.add_ThingHappened({})\r\n$test.TriggerThingHappened()\r\n```\r\n\r\nThere's significantly more logic that goes into `Register-ObjectEvent` that makes it possible to reroute the raised event to the right thread.  When you're using the add accessor directly, you're just creating a very thin wrapper around a script block that C# code knows how to invoke.  It doesn't know anything about what context to invoke it in though, so sometimes it will work sometimes it won't depending on the implementation of the class you're utilizing.",
    "created_at": "2020-04-16T14:41:40Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12338#issuecomment-614696377",
    "id": 614696377,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12338",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxNDY5NjM3Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/614696377/reactions"
    },
    "updated_at": "2020-04-16T14:41:40Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/614696377",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "> Please let the 5.1 team(s) know, too. \r\n\r\nWindows PowerShell is frozen and get only critical and security fixes. All new work is only for PowerShell 7+.\r\n\r\nPlease repeat your tests with latest PowerShell 7.1 preview build.",
    "created_at": "2020-04-16T14:54:20Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12338#issuecomment-614704003",
    "id": 614704003,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12338",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxNDcwNDAwMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/614704003/reactions"
    },
    "updated_at": "2020-04-16T14:54:20Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/614704003",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "Thanks @SeeminglyScience, your example makes it more clear where the behaviour originates.\r\n\r\n@iSazonov I have tested both my example & the one given by @SeeminglyScience on the latest preview build and it behaves the same. Register-ObjectEvent is robust enough for my situation, however.\r\n\r\nApologies for the confusion. Had I tried it in >PS5.1 I would have found better keywords. I will close this ticket as I believe this to be related to the below items and is understood:\r\nhttps://github.com/PowerShell/PowerShell/issues/11658\r\nhttps://github.com/dotnet/runtime/issues/2024",
    "created_at": "2020-04-16T16:05:46Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12338#issuecomment-614745118",
    "id": 614745118,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12338",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxNDc0NTExOA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/614745118/reactions"
    },
    "updated_at": "2020-04-16T16:05:46Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/614745118",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/58513470?v=4",
      "events_url": "https://api.github.com/users/mosullivan-wyse/events{/privacy}",
      "followers_url": "https://api.github.com/users/mosullivan-wyse/followers",
      "following_url": "https://api.github.com/users/mosullivan-wyse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mosullivan-wyse/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mosullivan-wyse",
      "id": 58513470,
      "login": "mosullivan-wyse",
      "node_id": "MDQ6VXNlcjU4NTEzNDcw",
      "organizations_url": "https://api.github.com/users/mosullivan-wyse/orgs",
      "received_events_url": "https://api.github.com/users/mosullivan-wyse/received_events",
      "repos_url": "https://api.github.com/users/mosullivan-wyse/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mosullivan-wyse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mosullivan-wyse/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mosullivan-wyse"
    }
  },
  {
    "author_association": "NONE",
    "body": "How do I get a reliably ordered stdout or stderr from a spawned process that I want to monitor in real time?  Is there a work-around for Powershell 5.1?  Or was the issue rooted in .Net Core? (Then why did the issue manifest in Powershell 5.1 and 7?)\r\n\r\nI switched to pwsh 7.3.0-preview.4 but still got the stdout of a monitored process in a wrong order (even after using a synchronized queue in the event handler to store the output and dequeue-ing in the main loop waiting on the application to exit).\r\n",
    "created_at": "2022-06-18T06:36:57Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12338#issuecomment-1159373813",
    "id": 1159373813,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12338",
    "node_id": "IC_kwDOAvT7bc5FGqP1",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1159373813/reactions"
    },
    "updated_at": "2022-06-20T02:49:17Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1159373813",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/30419?v=4",
      "events_url": "https://api.github.com/users/ilatypov/events{/privacy}",
      "followers_url": "https://api.github.com/users/ilatypov/followers",
      "following_url": "https://api.github.com/users/ilatypov/following{/other_user}",
      "gists_url": "https://api.github.com/users/ilatypov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ilatypov",
      "id": 30419,
      "login": "ilatypov",
      "node_id": "MDQ6VXNlcjMwNDE5",
      "organizations_url": "https://api.github.com/users/ilatypov/orgs",
      "received_events_url": "https://api.github.com/users/ilatypov/received_events",
      "repos_url": "https://api.github.com/users/ilatypov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ilatypov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ilatypov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ilatypov"
    }
  }
]

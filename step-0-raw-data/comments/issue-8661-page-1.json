[
  {
    "author_association": "COLLABORATOR",
    "body": "@SeeminglyScience Interestingly it does work properly in version 2:\r\n```powershell\r\nPS[2] (4) > $emptyResult = $null | ForEach-Object { }\r\nPS[2] (5) > [Math]::Round($emptyResult)\r\n0\r\n```\r\nThe original intent was that `AutomationNull` should never end up in a variable. It's supposed to be converted to `$null` during the assignment. V2 works properly so it might have been broken in the move to the DLR but it's such an obscure thing no one ever noticed. \r\n",
    "created_at": "2019-01-16T17:39:53Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8661#issuecomment-454870981",
    "id": 454870981,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8661",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NDg3MDk4MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/454870981/reactions"
    },
    "updated_at": "2019-01-16T17:39:53Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/454870981",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6876108?v=4",
      "events_url": "https://api.github.com/users/BrucePay/events{/privacy}",
      "followers_url": "https://api.github.com/users/BrucePay/followers",
      "following_url": "https://api.github.com/users/BrucePay/following{/other_user}",
      "gists_url": "https://api.github.com/users/BrucePay/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/BrucePay",
      "id": 6876108,
      "login": "BrucePay",
      "node_id": "MDQ6VXNlcjY4NzYxMDg=",
      "organizations_url": "https://api.github.com/users/BrucePay/orgs",
      "received_events_url": "https://api.github.com/users/BrucePay/received_events",
      "repos_url": "https://api.github.com/users/BrucePay/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/BrucePay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BrucePay/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/BrucePay"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "> V2 works properly so it might have been broken in the move to the DLR but it's such an obscure thing no one ever noticed.\r\n\r\nAh yes, that would make sense since it throws here:\r\n\r\nhttps://github.com/PowerShell/PowerShell/blob/1be3f4cc0e465ae11ad8e59e9060f5a59e4762eb/src/System.Management.Automation/engine/runtime/Binding/Binders.cs#L254-L257\r\n\r\nIt's not *immediately* apparent that `Expression.Constant` could throw there, very easy to miss.\r\n\r\nThat said, I'm not sure what the desired behavior is exactly.  My first instinct is it should follow conversion rules for `$null`, *but* `AutomationNull` does handle value types a little differently in conversions.\r\n\r\n```powershell\r\n# $null throws without a specific conversion rule (e.g. null to int)\r\n> [System.Reflection.Metadata.MethodDefinitionHandle]$null\r\nCannot convert null to type \"System.Reflection.Metadata.MethodDefinitionHandle\".\r\nAt line:1 char:1\r\n+ [System.Reflection.Metadata.MethodDefinitionHandle]$null\r\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+ CategoryInfo          : InvalidArgument: (:) [], RuntimeException\r\n+ FullyQualifiedErrorId : nullToObjectInvalidCast\r\n\r\n# AutomationNull seems to use Expression.Default(type)\r\n> [System.Reflection.Metadata.MethodDefinitionHandle][System.Management.Automation.Internal.AutomationNull]::Value\r\nIsNil\r\n-----\r\n True",
    "created_at": "2019-01-16T19:12:10Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8661#issuecomment-454902538",
    "id": 454902538,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8661",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NDkwMjUzOA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/454902538/reactions"
    },
    "updated_at": "2019-01-16T19:13:18Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/454902538",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "`AutomationNull` represents the absence of a value which really only makes sense in a stream (pipeline). In a value context, `AutomationNull` is intended to become a `null`. Now `null` in a numeric value context becomes 0 so I assume that the converter for `AutomationNull` skips the intermediate step and is going to the default value for the target type. IIRC we also (but I guess inconsistently) use `default()` for `null` conversion too so there may be a bug in the actual null conversions. @lzybkr might know more.",
    "created_at": "2019-01-17T19:20:46Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8661#issuecomment-455297803",
    "id": 455297803,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8661",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NTI5NzgwMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/455297803/reactions"
    },
    "updated_at": "2019-01-17T19:20:46Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/455297803",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6876108?v=4",
      "events_url": "https://api.github.com/users/BrucePay/events{/privacy}",
      "followers_url": "https://api.github.com/users/BrucePay/followers",
      "following_url": "https://api.github.com/users/BrucePay/following{/other_user}",
      "gists_url": "https://api.github.com/users/BrucePay/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/BrucePay",
      "id": 6876108,
      "login": "BrucePay",
      "node_id": "MDQ6VXNlcjY4NzYxMDg=",
      "organizations_url": "https://api.github.com/users/BrucePay/orgs",
      "received_events_url": "https://api.github.com/users/BrucePay/received_events",
      "repos_url": "https://api.github.com/users/BrucePay/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/BrucePay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BrucePay/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/BrucePay"
    }
  }
]

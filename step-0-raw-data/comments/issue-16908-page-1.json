[
  {
    "author_association": "COLLABORATOR",
    "body": "> Invoke-WebRequest: The token supplied to the function is invalid\r\n\r\nIt is not PowerShell error. It comes from underlying OS and says the OS has a cryptographic algorithm disabled.\r\nSee https://stackoverflow.com/questions/40939031/tls-1-2-the-token-supplied-to-the-function-is-invalid\n\n<blockquote><img src=\"https://cdn.sstatic.net/Sites/stackoverflow/Img/apple-touch-icon@2.png?v=73d79a89bded\" width=\"48\" align=\"right\"><div>Stack Overflow</div><div><strong><a href=\"https://stackoverflow.com/questions/40939031/tls-1-2-the-token-supplied-to-the-function-is-invalid\">TLS 1.2 - The token supplied to the function is invalid</a></strong></div><div>I have this strange problem, SslStream.AuthenticateAsClient() throws following exception:\n\nSystem.Security.Authentication.AuthenticationException : A call to SSPI failed, see inner exception.\n  ---...</div></blockquote>",
    "created_at": "2022-02-23T18:32:51Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16908#issuecomment-1049087325",
    "id": 1049087325,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16908",
    "node_id": "IC_kwDOAvT7bc4-h81d",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1049087325/reactions"
    },
    "updated_at": "2022-02-23T18:32:54Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1049087325",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "I have looked at that article previously, as part of my earlier troubelshooting.\r\nIf that is the case, why does it work on the same system with PowerShell 5.1 but fail with PowerShell 7.2.1?\r\nI also created a test script that iterated through setting\r\n`$ProtocolList = @( 'SystemDefault'; 'Ssl3'; 'Tls'; 'Tls11'; 'Tls12'; 'Tls13' ); $ProtocolList | Foreach-Object { $protocol = $_; [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::($protocol); Invoke-WebRequest -Uri \"https://www.google.com\" }`\r\nAnd it failed for every protocol with the same error. It got a different error with SystemDefault because it didn't understand that protocol, but the rest all say \"The token supplied to the function in invalid\"\r\nThe cryptographic protocols enabled in the registry are\r\n`RSA/SHA256\r\nRSA/SHA384\r\nRSA/SHA1\r\nECDSA/SHA256\r\nECDSA/SHA384\r\nECDSA/SHA1\r\nDSA/SHA1\r\nRSA/SHA512\r\nECDSA/SHA512`\r\nWhat is the best way to get a better error?\r\nWould that be a packet capture and study the SSL logs or can PowerShell provide any detailed logging on that aspect of the problem?",
    "created_at": "2022-02-24T15:40:00Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16908#issuecomment-1049986699",
    "id": 1049986699,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16908",
    "node_id": "IC_kwDOAvT7bc4-lYaL",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1049986699/reactions"
    },
    "updated_at": "2022-02-24T15:40:00Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1049986699",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/4934498?v=4",
      "events_url": "https://api.github.com/users/wordeater/events{/privacy}",
      "followers_url": "https://api.github.com/users/wordeater/followers",
      "following_url": "https://api.github.com/users/wordeater/following{/other_user}",
      "gists_url": "https://api.github.com/users/wordeater/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/wordeater",
      "id": 4934498,
      "login": "wordeater",
      "node_id": "MDQ6VXNlcjQ5MzQ0OTg=",
      "organizations_url": "https://api.github.com/users/wordeater/orgs",
      "received_events_url": "https://api.github.com/users/wordeater/received_events",
      "repos_url": "https://api.github.com/users/wordeater/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/wordeater/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wordeater/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/wordeater"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "You can use Wireshark (or another sniffer) to troubleshot TLS negotiations\r\nhttps://kb.vmware.com/s/article/2960967\n\n<blockquote><div><strong><a href=\"https://kb.vmware.com/s/article/2960967\">Access Denied</a></strong></div></blockquote>",
    "created_at": "2022-02-24T18:32:40Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16908#issuecomment-1050143164",
    "id": 1050143164,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16908",
    "node_id": "IC_kwDOAvT7bc4-l-m8",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1050143164/reactions"
    },
    "updated_at": "2022-02-24T18:32:42Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1050143164",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "This issue has been marked as answered and has not had any activity for **1 day**. It has been closed for housekeeping purposes.",
    "created_at": "2022-02-26T00:00:40Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16908#issuecomment-1051382278",
    "id": 1051382278,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16908",
    "node_id": "IC_kwDOAvT7bc4-qtIG",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1051382278/reactions"
    },
    "updated_at": "2022-02-26T00:00:40Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1051382278",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  }
]

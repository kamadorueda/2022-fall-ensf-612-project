[
  {
    "author_association": "NONE",
    "body": "The sample.evtx was attached in the above repro steps.",
    "created_at": "2018-08-31T00:22:26Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7664#issuecomment-417509706",
    "id": 417509706,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7664",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNzUwOTcwNg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/417509706/reactions"
    },
    "updated_at": "2018-08-31T00:22:26Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/417509706",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/29964207?v=4",
      "events_url": "https://api.github.com/users/ryhayash/events{/privacy}",
      "followers_url": "https://api.github.com/users/ryhayash/followers",
      "following_url": "https://api.github.com/users/ryhayash/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryhayash/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ryhayash",
      "id": 29964207,
      "login": "ryhayash",
      "node_id": "MDQ6VXNlcjI5OTY0MjA3",
      "organizations_url": "https://api.github.com/users/ryhayash/orgs",
      "received_events_url": "https://api.github.com/users/ryhayash/received_events",
      "repos_url": "https://api.github.com/users/ryhayash/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ryhayash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryhayash/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ryhayash"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@ryhayash Thans for the report and great repo!\r\n\r\nIt's not clear to me where this should be fixed in the repo or in Windows code. Although if it works in wevtutil and Event Viewer we could fix this in PowerShell.\r\n\r\n@ryhayash Do you want to offer PR?",
    "created_at": "2018-08-31T05:40:44Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7664#issuecomment-417557641",
    "id": 417557641,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7664",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNzU1NzY0MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/417557641/reactions"
    },
    "updated_at": "2018-08-31T05:40:44Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/417557641",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "Thanks @iSazonov for looking into this. Yes, that would be great if we can fix this as the event message become able to be displayed correctly. Should I create a PR although I've never done that before?\r\n\r\nThis might not be best way but just simply adding a case for ERROR_EVT_UNRESOLVED_PARAMETER_INSERT would resolve this issue like below. I've already confirmed actual code for 'error' and 'status' in EvtFormatMessageRenderName during repro from iDNA trace and the 'status' was E_FAIL(0x80004005) and 'error' was UnsafeNativeMethods.ERROR_EVT_UNRESOLVED_PARAMETER_INSERT(0x3ab6). So below code would be able to handle this case.\r\n\r\nEvtFormatMessageRenderName:\r\nhttps://referencesource.microsoft.com/#system.core/System/Diagnostics/Eventing/Reader/NativeWrapper.cs,38a28b69081629e4\r\n\r\n\r\nLine 998:\r\n````\r\n            sb.EnsureCapacity(bufferNeeded);\r\n            status = UnsafeNativeMethods.EvtFormatMessage(pmHandle, eventHandle, 0, 0, null, flag, bufferNeeded, sb, out bufferNeeded);\r\n            error = Marshal.GetLastWin32Error();\r\n \r\n            if (!status && error != UnsafeNativeMethods.ERROR_EVT_UNRESOLVED_VALUE_INSERT)            \r\n            {\r\n                switch (error) {\r\n                    case UnsafeNativeMethods.ERROR_EVT_UNRESOLVED_PARAMETER_INSERT:  <----- Add this line\r\n                        return sb.ToString();                                        <----- Add this line.\r\n                    case UnsafeNativeMethods.ERROR_EVT_MESSAGE_NOT_FOUND:\r\n                    case UnsafeNativeMethods.ERROR_EVT_MESSAGE_ID_NOT_FOUND:\r\n                    case UnsafeNativeMethods.ERROR_EVT_MESSAGE_LOCALE_NOT_FOUND:\r\n                    case UnsafeNativeMethods.ERROR_RESOURCE_LANG_NOT_FOUND:\r\n                    case UnsafeNativeMethods.ERROR_MUI_FILE_NOT_FOUND:\r\n                        return null;\r\n                }\r\n                EventLogException.Throw(error);\r\n            }\r\n            return sb.ToString();\r\n        }\r\n\r\n````",
    "created_at": "2018-08-31T06:27:51Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7664#issuecomment-417565369",
    "id": 417565369,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7664",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNzU2NTM2OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/417565369/reactions"
    },
    "updated_at": "2018-08-31T06:27:51Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/417565369",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/29964207?v=4",
      "events_url": "https://api.github.com/users/ryhayash/events{/privacy}",
      "followers_url": "https://api.github.com/users/ryhayash/followers",
      "following_url": "https://api.github.com/users/ryhayash/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryhayash/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ryhayash",
      "id": 29964207,
      "login": "ryhayash",
      "node_id": "MDQ6VXNlcjI5OTY0MjA3",
      "organizations_url": "https://api.github.com/users/ryhayash/orgs",
      "received_events_url": "https://api.github.com/users/ryhayash/received_events",
      "repos_url": "https://api.github.com/users/ryhayash/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ryhayash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryhayash/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ryhayash"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "> Should I create a PR although I've never done that before?\r\n\r\nIt is _Open project_ - feel free to contribute if you want. We welcome everyone who wants to develop the project. \r\n\r\nAlso if you think that the fix should be in .Net please open issue in CoreFX repo https://github.com/dotnet/corefx.",
    "created_at": "2018-08-31T07:37:59Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7664#issuecomment-417579964",
    "id": 417579964,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7664",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNzU3OTk2NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/417579964/reactions"
    },
    "updated_at": "2018-08-31T07:37:59Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/417579964",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "Thanks, just let me double check. The issue was in EvtFormatMessageRenderName() in system.core.ni.dll, and the dll belongs to the CoreFX. Is that correct? If so, I will file this to the CoreFX and please close the issue.",
    "created_at": "2018-08-31T08:22:52Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7664#issuecomment-417591296",
    "id": 417591296,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7664",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNzU5MTI5Ng==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/417591296/reactions"
    },
    "updated_at": "2018-08-31T08:22:52Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/417591296",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/29964207?v=4",
      "events_url": "https://api.github.com/users/ryhayash/events{/privacy}",
      "followers_url": "https://api.github.com/users/ryhayash/followers",
      "following_url": "https://api.github.com/users/ryhayash/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryhayash/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ryhayash",
      "id": 29964207,
      "login": "ryhayash",
      "node_id": "MDQ6VXNlcjI5OTY0MjA3",
      "organizations_url": "https://api.github.com/users/ryhayash/orgs",
      "received_events_url": "https://api.github.com/users/ryhayash/received_events",
      "repos_url": "https://api.github.com/users/ryhayash/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ryhayash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryhayash/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ryhayash"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "No need open an issue in CoreFX repo. The classes in not in .Net Core. We have them temporary in the PowerShell repo.\r\nYou can find the line with proposed fix here\r\nhttps://github.com/PowerShell/PowerShell/blob/master/src/Microsoft.PowerShell.CoreCLR.Eventing/DotNetCode/Eventing/Reader/NativeWrapper.cs\r\n\r\n",
    "created_at": "2018-08-31T10:12:09Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7664#issuecomment-417619388",
    "id": 417619388,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7664",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNzYxOTM4OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/417619388/reactions"
    },
    "updated_at": "2018-08-31T10:12:09Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/417619388",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  }
]

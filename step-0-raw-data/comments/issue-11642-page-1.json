[
  {
    "author_association": "COLLABORATOR",
    "body": "Does setting `[Console]::OutputEncoding` to a Unicode encoding not allow PS to read the incoming text properly? ðŸ¤” ",
    "created_at": "2020-01-21T13:47:27Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11642#issuecomment-576689230",
    "id": 576689230,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11642",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3NjY4OTIzMA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/576689230/reactions"
    },
    "updated_at": "2020-01-21T13:47:27Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/576689230",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/32407840?v=4",
      "events_url": "https://api.github.com/users/vexx32/events{/privacy}",
      "followers_url": "https://api.github.com/users/vexx32/followers",
      "following_url": "https://api.github.com/users/vexx32/following{/other_user}",
      "gists_url": "https://api.github.com/users/vexx32/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vexx32",
      "id": 32407840,
      "login": "vexx32",
      "node_id": "MDQ6VXNlcjMyNDA3ODQw",
      "organizations_url": "https://api.github.com/users/vexx32/orgs",
      "received_events_url": "https://api.github.com/users/vexx32/received_events",
      "repos_url": "https://api.github.com/users/vexx32/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vexx32/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vexx32/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vexx32"
    }
  },
  {
    "author_association": "NONE",
    "body": "```\r\nPowerShell 6.2.3\r\n\r\nhttps://aka.ms/pscore6-docs\r\nType 'help' to get help.\r\n\r\nLoading personal and system profiles took 3772ms.\r\n tatsu@TATSU-NB-3RD î‚° î˜† base î‚° ~ î‚° [Console]::OutputEncoding\r\n\r\nPreamble          :\r\nBodyName          : utf-8\r\nEncodingName      : Unicode (UTF-8)\r\nHeaderName        : utf-8\r\nWebName           : utf-8\r\nWindowsCodePage   : 1200\r\nIsBrowserDisplay  : True\r\nIsBrowserSave     : True\r\nIsMailNewsDisplay : True\r\nIsMailNewsSave    : True\r\nIsSingleByte      : False\r\nDecoderFallback   : System.Text.DecoderReplacementFallback\r\nIsReadOnly        : False\r\nCodePage          : 65001\r\n\r\n\r\n tatsu@TATSU-NB-3RD î‚° î˜† base î‚° ~ î‚° [System.Text.Encoding]::UTF8\r\n\r\nPreamble          :\r\nBodyName          : utf-8\r\nEncodingName      : Unicode (UTF-8)\r\nHeaderName        : utf-8\r\nWebName           : utf-8\r\nWindowsCodePage   : 1200\r\nIsBrowserDisplay  : True\r\nIsBrowserSave     : True\r\nIsMailNewsDisplay : True\r\nIsMailNewsSave    : True\r\nIsSingleByte      : False\r\nEncoderFallback   : System.Text.EncoderReplacementFallback\r\nDecoderFallback   : System.Text.DecoderReplacementFallback\r\nIsReadOnly        : True\r\nCodePage          : 65001\r\n\r\n\r\n```\r\n\r\nSeems not to have a problem on this.  This also happens on Legacy PowerShell (5.1).",
    "created_at": "2020-01-21T15:57:44Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11642#issuecomment-576748958",
    "id": 576748958,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11642",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3Njc0ODk1OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/576748958/reactions"
    },
    "updated_at": "2020-01-21T15:57:44Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/576748958",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12870451?v=4",
      "events_url": "https://api.github.com/users/tats-u/events{/privacy}",
      "followers_url": "https://api.github.com/users/tats-u/followers",
      "following_url": "https://api.github.com/users/tats-u/following{/other_user}",
      "gists_url": "https://api.github.com/users/tats-u/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/tats-u",
      "id": 12870451,
      "login": "tats-u",
      "node_id": "MDQ6VXNlcjEyODcwNDUx",
      "organizations_url": "https://api.github.com/users/tats-u/orgs",
      "received_events_url": "https://api.github.com/users/tats-u/received_events",
      "repos_url": "https://api.github.com/users/tats-u/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/tats-u/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tats-u/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/tats-u"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@vexx32  is correct in principle: `[Console]::OutputEncoding` is the encoding PowerShell uses to decode output from external programs such as `cmd`.\r\n\r\nIf you use `cmd /u` (for \"Unicode\", i.e. UTF-16LE output), you'd have to use\r\n `[Console]::OutputEncoding = [Text.Encoding]::Unicode`\r\n\r\nUnfortunately, doing so doesn't work in v6.2.3, due a bug that has since been fixed (since v7.0.0-preview.6): #10789\r\n",
    "created_at": "2020-01-23T02:37:50Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11642#issuecomment-577478541",
    "id": 577478541,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11642",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3NzQ3ODU0MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/577478541/reactions"
    },
    "updated_at": "2020-01-23T02:37:50Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/577478541",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "NONE",
    "body": "Worked in Legacy 5.1.\r\nI wonder why `[Console]::OutputEncoding` must be changed for pipe in PowerShell even though don't have to for direct output.",
    "created_at": "2020-01-23T05:34:46Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11642#issuecomment-577512854",
    "id": 577512854,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11642",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3NzUxMjg1NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/577512854/reactions"
    },
    "updated_at": "2020-01-23T05:35:06Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/577512854",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12870451?v=4",
      "events_url": "https://api.github.com/users/tats-u/events{/privacy}",
      "followers_url": "https://api.github.com/users/tats-u/followers",
      "following_url": "https://api.github.com/users/tats-u/following{/other_user}",
      "gists_url": "https://api.github.com/users/tats-u/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/tats-u",
      "id": 12870451,
      "login": "tats-u",
      "node_id": "MDQ6VXNlcjEyODcwNDUx",
      "organizations_url": "https://api.github.com/users/tats-u/orgs",
      "received_events_url": "https://api.github.com/users/tats-u/received_events",
      "repos_url": "https://api.github.com/users/tats-u/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/tats-u/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tats-u/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/tats-u"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "The _bug_ wasn't there in 5.1, but you still had to change `[Console]::OutputEncoding` to match the command's output encoding; e.g.:\r\n\r\n```powershell\r\n# Does NOT work by default - note the extra \"spaces\" representing NULs\r\nPS> $out = cmd /u /c echo hi; $out\r\nh i\r\n```",
    "created_at": "2020-01-23T13:26:02Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11642#issuecomment-577680336",
    "id": 577680336,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11642",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3NzY4MDMzNg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/577680336/reactions"
    },
    "updated_at": "2020-01-23T13:26:21Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/577680336",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "NONE",
    "body": "@mklement0 Of course.  What I said means that Legacy PowerShell (and future PowerShell 7) can convert output from `cmd /u` to string correctly **as long as** `[Console]::Output` has been changed , and that I don't know why `cmd /c \"echo æ¼¢å­—\"; cmd /u /c \"echo æ¼¢å­—\"` succeeds without doing else  but `$success = cmd /c \"echo æ¼¢å­—\"; $fails = cmd /u /c \"echo æ¼¢å­—\"` doesn't without changing `[Console]::OutputEncoding` before `cmd /u`?",
    "created_at": "2020-01-23T15:25:31Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11642#issuecomment-577730280",
    "id": 577730280,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11642",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3NzczMDI4MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/577730280/reactions"
    },
    "updated_at": "2020-01-23T15:25:31Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/577730280",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12870451?v=4",
      "events_url": "https://api.github.com/users/tats-u/events{/privacy}",
      "followers_url": "https://api.github.com/users/tats-u/followers",
      "following_url": "https://api.github.com/users/tats-u/following{/other_user}",
      "gists_url": "https://api.github.com/users/tats-u/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/tats-u",
      "id": 12870451,
      "login": "tats-u",
      "node_id": "MDQ6VXNlcjEyODcwNDUx",
      "organizations_url": "https://api.github.com/users/tats-u/orgs",
      "received_events_url": "https://api.github.com/users/tats-u/received_events",
      "repos_url": "https://api.github.com/users/tats-u/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/tats-u/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tats-u/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/tats-u"
    }
  },
  {
    "author_association": "NONE",
    "body": "This issue can be divided into a fixed bug (only in development version) and a missing feature, so I'll close this and make one for the latter as a feature request later.",
    "created_at": "2020-01-23T15:30:41Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11642#issuecomment-577732568",
    "id": 577732568,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11642",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3NzczMjU2OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/577732568/reactions"
    },
    "updated_at": "2020-01-23T15:30:41Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/577732568",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12870451?v=4",
      "events_url": "https://api.github.com/users/tats-u/events{/privacy}",
      "followers_url": "https://api.github.com/users/tats-u/followers",
      "following_url": "https://api.github.com/users/tats-u/following{/other_user}",
      "gists_url": "https://api.github.com/users/tats-u/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/tats-u",
      "id": 12870451,
      "login": "tats-u",
      "node_id": "MDQ6VXNlcjEyODcwNDUx",
      "organizations_url": "https://api.github.com/users/tats-u/orgs",
      "received_events_url": "https://api.github.com/users/tats-u/received_events",
      "repos_url": "https://api.github.com/users/tats-u/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/tats-u/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tats-u/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/tats-u"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Yes, the bug is specific to 6.x.\r\n\r\n`cmd /u /c \"echo æ¼¢å­—\"` works (if you have the right font selected), because it prints _directly to the console_, presumably using the Unicode version of the [`WriteConsole` WinAPI function](https://docs.microsoft.com/en-us/windows/console/writeconsole) - PowerShell passes the output _through_, and performs _no decoding_.\r\n\r\nIn other words: the need to set `[Console]::OutputEncoding`  only arises if you _capture, pipe, or redirect_ the external program's output.",
    "created_at": "2020-01-23T15:33:24Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11642#issuecomment-577733804",
    "id": 577733804,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11642",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3NzczMzgwNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/577733804/reactions"
    },
    "updated_at": "2020-01-23T15:38:25Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/577733804",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Given the explanation above, do you still think there is a missing feature?\r\n\r\nIf you want to _interpret_ the output from an external program _as text_, there is no way around telling PowerShell what the source character encoding is - I don't think we should be employing heuristics there.\r\n",
    "created_at": "2020-01-23T15:35:13Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11642#issuecomment-577734661",
    "id": 577734661,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11642",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3NzczNDY2MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/577734661/reactions"
    },
    "updated_at": "2020-01-23T15:35:13Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/577734661",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "NONE",
    "body": "1. Can't PowerShell tell whether external programs output text via `WriteConsoleW` or `WriteConsoleA`?\r\n2. If not, Does PowerShell try to reinterpret UTF-16 LE `wchar_t*` text from `WriteConsoleW` to multibyte `char*` text encoded in `OutputEncoding`, and convert it to UTF-16 LE string (PowerShell native string) according to `OutputEncoding` again?",
    "created_at": "2020-01-24T04:10:36Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11642#issuecomment-577983520",
    "id": 577983520,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11642",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3Nzk4MzUyMA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/577983520/reactions"
    },
    "updated_at": "2020-01-24T04:13:51Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/577983520",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12870451?v=4",
      "events_url": "https://api.github.com/users/tats-u/events{/privacy}",
      "followers_url": "https://api.github.com/users/tats-u/followers",
      "following_url": "https://api.github.com/users/tats-u/following{/other_user}",
      "gists_url": "https://api.github.com/users/tats-u/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/tats-u",
      "id": 12870451,
      "login": "tats-u",
      "node_id": "MDQ6VXNlcjEyODcwNDUx",
      "organizations_url": "https://api.github.com/users/tats-u/orgs",
      "received_events_url": "https://api.github.com/users/tats-u/received_events",
      "repos_url": "https://api.github.com/users/tats-u/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/tats-u/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tats-u/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/tats-u"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "`WriteConsole()` is truly just for writing to the _console_ (from the linked docs):\r\n\r\n> WriteConsole fails if it is used with a standard handle that is redirected to a file. [...]\r\n If the handle is a console handle, call WriteConsole. If the handle is not a console handle, the output is redirected and you should call WriteFile to perform the I/O.\r\n\r\nThat is, it doesn't apply in the capture/redirect/pipe case. \r\n\r\nAlso, more generally, not all console programs can be assumed to use the WinAPI, and there's no telling from the outside how a given console program is implemented.\r\n\r\nGenerally, console programs (when not printing directly to the screen), are expected to use the active code page's encoding, as reflected in the output of `chcp.com` and in `[Console]::OutputEncoding`.\r\n\r\nIf a given program uses a different encoding (as is the case when you use `cmd /u ...`), you need to (temporarily) set  `[Console]::OutputEncoding` to that encoding in order for PowerShell to interpret the output correctly.",
    "created_at": "2020-01-25T03:10:14Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11642#issuecomment-578371262",
    "id": 578371262,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11642",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3ODM3MTI2Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/578371262/reactions"
    },
    "updated_at": "2020-01-25T03:10:14Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/578371262",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "NONE",
    "body": "`WriteConsole` is more complex than I thought.  Thank you for detailed explanation.  Anyway, I have to write:\r\n\r\n```powershell\r\n$enc = [Console]::OutputEncoding\r\n[Console]::OutputEncoding = [Text.Encoding]::Unicode\r\n$result = cmd /u /c \"foo bar\"\r\n[Console]::OutputEncoding = $enc\r\n```\r\n\r\nI wish it were just one line.",
    "created_at": "2020-01-25T05:50:31Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11642#issuecomment-578379749",
    "id": 578379749,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11642",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3ODM3OTc0OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/578379749/reactions"
    },
    "updated_at": "2020-01-25T05:50:31Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/578379749",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12870451?v=4",
      "events_url": "https://api.github.com/users/tats-u/events{/privacy}",
      "followers_url": "https://api.github.com/users/tats-u/followers",
      "following_url": "https://api.github.com/users/tats-u/following{/other_user}",
      "gists_url": "https://api.github.com/users/tats-u/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/tats-u",
      "id": 12870451,
      "login": "tats-u",
      "node_id": "MDQ6VXNlcjEyODcwNDUx",
      "organizations_url": "https://api.github.com/users/tats-u/orgs",
      "received_events_url": "https://api.github.com/users/tats-u/received_events",
      "repos_url": "https://api.github.com/users/tats-u/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/tats-u/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tats-u/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/tats-u"
    }
  }
]

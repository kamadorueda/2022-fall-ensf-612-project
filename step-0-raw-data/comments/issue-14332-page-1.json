[
  {
    "author_association": "COLLABORATOR",
    "body": "@Fs00 Thanks for your contribution!\r\nI hope that we will soon be able to use .Net 6.0 Source Generators. So I'm going to refactor PSVersionInfo class and move all version constants to new GitInfo class. Later we will be able to generate it with a simple source generator and thereby remove all reflection overhead.\r\nI will use your idea in follow PR.\r\n\r\n\r\n",
    "created_at": "2020-12-06T16:33:28Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/14332#issuecomment-739527355",
    "id": 739527355,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14332",
    "node_id": "MDEyOklzc3VlQ29tbWVudDczOTUyNzM1NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/739527355/reactions"
    },
    "updated_at": "2020-12-06T16:33:28Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/739527355",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "[![CLA assistant check](https://cla.opensource.microsoft.com/pull/badge/signed)](https://cla.opensource.microsoft.com/PowerShell/PowerShell?pullRequest=14332) <br/>All CLA requirements met.",
    "created_at": "2020-12-06T17:37:20Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/14332#issuecomment-739536275",
    "id": 739536275,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14332",
    "node_id": "MDEyOklzc3VlQ29tbWVudDczOTUzNjI3NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/739536275/reactions"
    },
    "updated_at": "2020-12-06T17:44:02Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/739536275",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/66420?v=4",
      "events_url": "https://api.github.com/users/microsoft-cla-retired%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/microsoft-cla-retired%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/microsoft-cla-retired%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/microsoft-cla-retired%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/microsoft-cla-retired",
      "id": 65984493,
      "login": "microsoft-cla-retired[bot]",
      "node_id": "MDM6Qm90NjU5ODQ0OTM=",
      "organizations_url": "https://api.github.com/users/microsoft-cla-retired%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/microsoft-cla-retired%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/microsoft-cla-retired%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/microsoft-cla-retired%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/microsoft-cla-retired%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/microsoft-cla-retired%5Bbot%5D"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@iSazonov Good to know.\r\nSince it isn't sure when the refactoring with source generators will be done, could this PR be merged in the meantime? It would still be an improvement on the current situation and would allow me to test System.Management.Automation on single-file applications to see if there are any other issues.",
    "created_at": "2020-12-06T18:04:04Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/14332#issuecomment-739539861",
    "id": 739539861,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14332",
    "node_id": "MDEyOklzc3VlQ29tbWVudDczOTUzOTg2MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/739539861/reactions"
    },
    "updated_at": "2020-12-06T18:04:04Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/739539861",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/30041551?v=4",
      "events_url": "https://api.github.com/users/Fs00/events{/privacy}",
      "followers_url": "https://api.github.com/users/Fs00/followers",
      "following_url": "https://api.github.com/users/Fs00/following{/other_user}",
      "gists_url": "https://api.github.com/users/Fs00/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Fs00",
      "id": 30041551,
      "login": "Fs00",
      "node_id": "MDQ6VXNlcjMwMDQxNTUx",
      "organizations_url": "https://api.github.com/users/Fs00/orgs",
      "received_events_url": "https://api.github.com/users/Fs00/received_events",
      "repos_url": "https://api.github.com/users/Fs00/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Fs00/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Fs00/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Fs00"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "> Since it isn't sure when the refactoring with source generators will be done, could this PR be merged in the meantime?\r\n\r\nI see with the PR PowerShell loads less assembles at startup - it is great perf improvement! I think we will merge the PR.",
    "created_at": "2020-12-06T18:13:31Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/14332#issuecomment-739541054",
    "id": 739541054,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14332",
    "node_id": "MDEyOklzc3VlQ29tbWVudDczOTU0MTA1NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/739541054/reactions"
    },
    "updated_at": "2020-12-06T18:13:31Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/739541054",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "I see `System.Diagnostics.FileVersionInfo.dll` is still loaded on Windows in AmsiUtils.Init()\r\nhttps://github.com/PowerShell/PowerShell/blob/ea3036dc6d5bcbd58ee2b3b1960a3647467d0801/src/System.Management.Automation/security/SecuritySupport.cs#L1355-L1357\r\n\r\n@PaulHigin @TravisEz13 Do we really need the `FileVersionInfo.ProductVersion`? Can we use the same approach as @Fs00 in the PR?\r\n\r\nAlso GetMainModule() is very expensive. Could we use `Assembly.GetEntryAssembly().FullName`? On my laptop it is 5 ms vs 27 ms.\r\nOr P/Invoke [GetModuleFileName](https://docs.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-getmodulefilenamew)? In .Net 6.0 the `GetModuleFileName` is exposed as `System.Environment.ProcessPath`.",
    "created_at": "2020-12-06T19:21:33Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/14332#issuecomment-739549844",
    "id": 739549844,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14332",
    "node_id": "MDEyOklzc3VlQ29tbWVudDczOTU0OTg0NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/739549844/reactions"
    },
    "updated_at": "2020-12-07T07:29:40Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/739549844",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@Fs00 Thanks for your contribution!",
    "created_at": "2020-12-12T06:32:26Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/14332#issuecomment-743712614",
    "id": 743712614,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14332",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0MzcxMjYxNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/743712614/reactions"
    },
    "updated_at": "2020-12-12T06:32:26Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/743712614",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": ":tada:`v7.2.0-preview.3` has been released which incorporates this pull request.:tada:\n\nHandy links:\n* [Release Notes](https://github.com/PowerShell/PowerShell/releases/tag/v7.2.0-preview.3)\n",
    "created_at": "2021-02-12T02:07:31Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/14332#issuecomment-777921106",
    "id": 777921106,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14332",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3NzkyMTEwNg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/777921106/reactions"
    },
    "updated_at": "2021-02-12T02:07:31Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/777921106",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  },
  {
    "author_association": "NONE",
    "body": "@Fs00 Late to the party but please accept my gratitude for your efforts to bring PowerShell closer to single-file-application-friendly!",
    "created_at": "2021-02-13T23:21:01Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/14332#issuecomment-778692399",
    "id": 778692399,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14332",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3ODY5MjM5OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 2,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/778692399/reactions"
    },
    "updated_at": "2021-02-13T23:21:01Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/778692399",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/365255?v=4",
      "events_url": "https://api.github.com/users/ALIENQuake/events{/privacy}",
      "followers_url": "https://api.github.com/users/ALIENQuake/followers",
      "following_url": "https://api.github.com/users/ALIENQuake/following{/other_user}",
      "gists_url": "https://api.github.com/users/ALIENQuake/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ALIENQuake",
      "id": 365255,
      "login": "ALIENQuake",
      "node_id": "MDQ6VXNlcjM2NTI1NQ==",
      "organizations_url": "https://api.github.com/users/ALIENQuake/orgs",
      "received_events_url": "https://api.github.com/users/ALIENQuake/received_events",
      "repos_url": "https://api.github.com/users/ALIENQuake/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ALIENQuake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ALIENQuake/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ALIENQuake"
    }
  }
]

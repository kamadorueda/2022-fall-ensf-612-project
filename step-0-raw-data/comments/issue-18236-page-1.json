[
  {
    "author_association": "COLLABORATOR",
    "body": "> The error remains, removing any other PowerShell-Versions from the system except 5.1. It works as long as you do not install PowerShell 7.2.0 or 7.3.0-preview8 side-by-side with PowerShell 5.1.\r\n\r\nI guess PSModulePath env variable is a key here. Compere it before and after installing pwsh.",
    "created_at": "2022-10-07T16:50:19Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/18236#issuecomment-1271823676",
    "id": 1271823676,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/18236",
    "node_id": "IC_kwDOAvT7bc5Lzn08",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1271823676/reactions"
    },
    "updated_at": "2022-10-07T16:50:19Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1271823676",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "> > The error remains, removing any other PowerShell-Versions from the system except 5.1. It works as long as you do not install PowerShell 7.2.0 or 7.3.0-preview8 side-by-side with PowerShell 5.1.\r\n> \r\n> I guess PSModulePath env variable is a key here. Compere it before and after installing pwsh.\r\n\r\n```\r\n> $env:PSModulePath -split ';'\r\n%USERPROFILE%\\Documents\\WindowsPowerShell\\Modules\r\nC:\\Program Files\\WindowsPowerShell\\Modules\r\nC:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\Modules\r\nC:\\Program Files (x86)\\Windows Kits\\10\\Microsoft Application Virtualization\\Sequencer\\AppvPkgConverter\r\nC:\\Program Files (x86)\\Windows Kits\\10\\Microsoft Application Virtualization\\Sequencer\\AppvSequencer\r\nC:\\Program Files (x86)\\Windows Kits\\10\\Microsoft Application Virtualization\\\r\nC:\\Program Files (x86)\\AutoIt3\\AutoItX\r\n```\r\nEmpty or not existing are:\r\n```\r\n%USERPROFILE%\\Documents\\WindowsPowerShell\\Modules\r\n```\r\nAfter Installing PowerShell 7.3.0-preview8 nothing changes. $env:PSModulePath is the same before and after.\r\nBut within `C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\Modules` there are changes. May it be if PowerShell 7.3.0-preview8 is installed with admin-rights it overwrites modules provided by both: PowerShell 5.1 and PowerShell 7.3.0-preview8?\r\n",
    "created_at": "2022-10-09T21:30:27Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/18236#issuecomment-1272631908",
    "id": 1272631908,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/18236",
    "node_id": "IC_kwDOAvT7bc5L2tJk",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1272631908/reactions"
    },
    "updated_at": "2022-10-09T21:30:27Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1272631908",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/702156?v=4",
      "events_url": "https://api.github.com/users/tps800/events{/privacy}",
      "followers_url": "https://api.github.com/users/tps800/followers",
      "following_url": "https://api.github.com/users/tps800/following{/other_user}",
      "gists_url": "https://api.github.com/users/tps800/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/tps800",
      "id": 702156,
      "login": "tps800",
      "node_id": "MDQ6VXNlcjcwMjE1Ng==",
      "organizations_url": "https://api.github.com/users/tps800/orgs",
      "received_events_url": "https://api.github.com/users/tps800/received_events",
      "repos_url": "https://api.github.com/users/tps800/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/tps800/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tps800/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/tps800"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "> After Installing PowerShell 7.3.0-preview8 nothing changes. $env:PSModulePath is the same before and after.\r\n> But within `C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\Modules` there are changes. May it be if PowerShell 7.3.0-preview8 is installed with admin-rights it overwrites modules provided by both: PowerShell 5.1 and PowerShell 7.3.0-preview8?\r\n\r\nPlease share more information what changes you see there.",
    "created_at": "2022-10-10T04:18:26Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/18236#issuecomment-1272767573",
    "id": 1272767573,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/18236",
    "node_id": "IC_kwDOAvT7bc5L3ORV",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1272767573/reactions"
    },
    "updated_at": "2022-10-10T04:18:26Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1272767573",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "In each of the PS versions, can you provide output of:\r\n\r\n```powershell\r\n(gcm get-counter).module.path\r\n```\r\n\r\nMake sure to run this from a new start of each version of PS and not starting PS within PS.  It looks like 5.1 is somehow picking up the PS7 version?",
    "created_at": "2022-10-10T18:14:54Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/18236#issuecomment-1273662773",
    "id": 1273662773,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/18236",
    "node_id": "IC_kwDOAvT7bc5L6o01",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1273662773/reactions"
    },
    "updated_at": "2022-10-10T18:14:54Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1273662773",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "NONE",
    "body": "**Windows PowerShell 5.1:**\r\n`C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\Modules\\Microsoft.PowerShell.Diagnostics\\Microsoft.PowerShell.Diagnostics.psd1`\r\n\r\n```\r\n> .\\perfcnt2.ps1\r\nGet-Counter : Das angegebene Objekt wurde nicht auf dem Computer gefunden.\r\nIn C:\\Users\\sct-muc\\Projects\\PowerShell-Kurs\\perfcnt2.ps1:12 Zeichen:5\r\n+     Get-Counter -Counter \"\\Logischer DatentrÃ¤ger(*)\\Freier Speicherp ...\r\n+     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    + CategoryInfo          : InvalidResult: (:) [Get-Counter], Exception\r\n    + FullyQualifiedErrorId : CounterApiError,Microsoft.PowerShell.Commands.GetCounterCommand\r\n\r\nGet-Counter : Das angegebene Objekt wurde nicht auf dem Computer gefunden.\r\nIn C:\\Users\\sct-muc\\Projects\\PowerShell-Kurs\\perfcnt2.ps1:12 Zeichen:5\r\n+     Get-Counter -Counter \"\\Logischer DatentrÃ¤ger(*)\\Freier Speicherp ...\r\n+     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    + CategoryInfo          : InvalidResult: (:) [Get-Counter], Exception\r\n    + FullyQualifiedErrorId : CounterApiError,Microsoft.PowerShell.Commands.GetCounterCommand\r\n```\r\n\r\n**PowerShell 7.2.6:**\r\n`C:\\program files\\powershell\\7\\Modules\\Microsoft.PowerShell.Diagnostics\\Microsoft.PowerShell.Diagnostics.psd1`\r\n\r\n```\r\n> .\\perfcnt2.ps1\r\n\r\nTimestamp           Path                                                                                    Value\r\n---------           ----                                                                                    -----\r\n14.10.2022 09:54:58 \\\\swps7\\logischer datenträger(harddiskvolume1)\\freier speicherplatz (%) 90,5444126074499\r\n14.10.2022 09:54:58 \\\\swps7\\logischer datenträger(c:)\\freier speicherplatz (%)              12,5020292296825\r\n14.10.2022 09:54:58 \\\\swps7\\logischer datenträger(harddiskvolume3)\\freier speicherplatz (%)       99,4140625\r\n14.10.2022 09:54:58 \\\\swps7\\logischer datenträger(_total)\\freier speicherplatz (%)          13,4302672555041\r\n14.10.2022 09:54:59 \\\\swps7\\logischer datenträger(harddiskvolume1)\\freier speicherplatz (%) 90,5444126074499\r\n14.10.2022 09:54:59 \\\\swps7\\logischer datenträger(c:)\\freier speicherplatz (%)              12,5020292296825\r\n14.10.2022 09:54:59 \\\\swps7\\logischer datenträger(harddiskvolume3)\\freier speicherplatz (%)       99,4140625\r\n14.10.2022 09:54:59 \\\\swps7\\logischer datenträger(_total)\\freier speicherplatz (%)          13,4302672555041```\r\n```\r\n\r\n**PowerShell 7.3.0-preview.8:**\r\n`C:\\program files\\powershell\\7-preview\\Modules\\Microsoft.PowerShell.Diagnostics\\Microsoft.PowerShell.Diagnostics.psd1`\r\n\r\n```\r\n> .\\perfcnt2.ps1\r\n\r\nTimestamp           Path                                                                         Value\r\n---------           ----                                                                         -----\r\n14.10.2022 09:55:37 \\\\swps7\\logischer datenträger(harddiskvolume1)\\freier speicherplatz (%) 90,54\r\n14.10.2022 09:55:37 \\\\swps7\\logischer datenträger(c:)\\freier speicherplatz (%)              12,50\r\n14.10.2022 09:55:37 \\\\swps7\\logischer datenträger(harddiskvolume3)\\freier speicherplatz (%) 99,41\r\n14.10.2022 09:55:37 \\\\swps7\\logischer datenträger(_total)\\freier speicherplatz (%)          13,43\r\n14.10.2022 09:55:38 \\\\swps7\\logischer datenträger(harddiskvolume1)\\freier speicherplatz (%) 90,54\r\n14.10.2022 09:55:38 \\\\swps7\\logischer datenträger(c:)\\freier speicherplatz (%)              12,50\r\n14.10.2022 09:55:38 \\\\swps7\\logischer datenträger(harddiskvolume3)\\freier speicherplatz (%) 99,41\r\n14.10.2022 09:55:38 \\\\swps7\\logischer datenträger(_total)\\freier speicherplatz (%)          13,43```\r\n```\r\n\r\n**The same on a system with only PowerShell 5.1 installed:**\r\n`C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\Modules\\Microsoft.PowerShell.Diagnostics\\Microsoft.PowerShell.Diagnostics.psd1`\r\n\r\n```\r\n> .\\perfcnt2.ps1\r\n\r\nTimestamp           Path                                                                                      Value\r\n---------           ----                                                                                      -----\r\n14.10.2022 10:10:07 \\\\sops5\\logischer datenträger(c:)\\freier speicherplatz (%)              19,3412432086929\r\n14.10.2022 10:10:07 \\\\sops5\\logischer datenträger(harddiskvolume5)\\freier speicherplatz (%) 35,1190476190476\r\n14.10.2022 10:10:07 \\\\sops5\\logischer datenträger(e:)\\freier speicherplatz (%)              99,5014339634437\r\n14.10.2022 10:10:07 \\\\sops5\\logischer datenträger(_total)\\freier speicherplatz (%)          92,3084582068004\r\n14.10.2022 10:10:08 \\\\sops5\\logischer datenträger(c:)\\freier speicherplatz (%)              19,3412432086929\r\n14.10.2022 10:10:08 \\\\sops5\\logischer datenträger(harddiskvolume5)\\freier speicherplatz (%) 35,1190476190476\r\n14.10.2022 10:10:08 \\\\sops5\\logischer datenträger(e:)\\freier speicherplatz (%)              99,5014339634437\r\n14.10.2022 10:10:08 \\\\sops5\\logischer datenträger(_total)\\freier speicherplatz (%)          92,3084582068004\r\n```\r\n\r\n\r\n**For all four systems the script called was:**\r\n```\r\n$counters = @(\r\n    '\\Logischer Datenträger(*)\\Freier Speicherplatz (%)'\r\n    '\\Logischer Datenträger(*)\\MB frei'\r\n)\r\n\r\nforeach ($counter in $counters) {\r\n    Get-Counter -Counter \"\\Logischer Datenträger(*)\\Freier Speicherplatz (%)\" -MaxSamples 1 | ForEach-Object {\r\n        $_.CounterSamples | ForEach-Object {\r\n            [PSCustomObject]@{\r\n                Timestamp = $_.Timestamp;\r\n                Path = $_.Path;\r\n                Value = $_.CookedValue;\r\n            }\r\n        }\r\n    }\r\n}\r\n```\r\n",
    "created_at": "2022-10-14T08:33:16Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/18236#issuecomment-1278673711",
    "id": 1278673711,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/18236",
    "node_id": "IC_kwDOAvT7bc5MNwMv",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1278673711/reactions"
    },
    "updated_at": "2022-10-14T08:37:21Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1278673711",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/702156?v=4",
      "events_url": "https://api.github.com/users/tps800/events{/privacy}",
      "followers_url": "https://api.github.com/users/tps800/followers",
      "following_url": "https://api.github.com/users/tps800/following{/other_user}",
      "gists_url": "https://api.github.com/users/tps800/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/tps800",
      "id": 702156,
      "login": "tps800",
      "node_id": "MDQ6VXNlcjcwMjE1Ng==",
      "organizations_url": "https://api.github.com/users/tps800/orgs",
      "received_events_url": "https://api.github.com/users/tps800/received_events",
      "repos_url": "https://api.github.com/users/tps800/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/tps800/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tps800/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/tps800"
    }
  }
]

[
  {
    "author_association": "MEMBER",
    "body": "The example looks like what one would pass via the `--command`/`-c` flag, or the `[script]` argument. `-EncodedCommand` wouldn't have much of a place on Linux, as Bash will do your interpolation. Now, inside of PowerShell, passing to another PowerShell instance, I could see this being useful.\n",
    "created_at": "2016-03-21T15:35:55Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/712#issuecomment-199343553",
    "id": 199343553,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/712",
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5OTM0MzU1Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/199343553/reactions"
    },
    "updated_at": "2016-03-21T15:35:55Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/199343553",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/2226434?v=4",
      "events_url": "https://api.github.com/users/andschwa/events{/privacy}",
      "followers_url": "https://api.github.com/users/andschwa/followers",
      "following_url": "https://api.github.com/users/andschwa/following{/other_user}",
      "gists_url": "https://api.github.com/users/andschwa/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/andschwa",
      "id": 2226434,
      "login": "andschwa",
      "node_id": "MDQ6VXNlcjIyMjY0MzQ=",
      "organizations_url": "https://api.github.com/users/andschwa/orgs",
      "received_events_url": "https://api.github.com/users/andschwa/received_events",
      "repos_url": "https://api.github.com/users/andschwa/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/andschwa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/andschwa/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/andschwa"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "See [here](https://blogs.msdn.microsoft.com/timid/2014/03/26/powershell-encodedcommand-and-round-trips/). The pieces are in place, we just need to support `-EncodedCommand`.\n",
    "created_at": "2016-04-13T17:53:52Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/712#issuecomment-209566248",
    "id": 209566248,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/712",
    "node_id": "MDEyOklzc3VlQ29tbWVudDIwOTU2NjI0OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/209566248/reactions"
    },
    "updated_at": "2016-04-13T17:53:52Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/209566248",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/2226434?v=4",
      "events_url": "https://api.github.com/users/andschwa/events{/privacy}",
      "followers_url": "https://api.github.com/users/andschwa/followers",
      "following_url": "https://api.github.com/users/andschwa/following{/other_user}",
      "gists_url": "https://api.github.com/users/andschwa/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/andschwa",
      "id": 2226434,
      "login": "andschwa",
      "node_id": "MDQ6VXNlcjIyMjY0MzQ=",
      "organizations_url": "https://api.github.com/users/andschwa/orgs",
      "received_events_url": "https://api.github.com/users/andschwa/received_events",
      "repos_url": "https://api.github.com/users/andschwa/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/andschwa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/andschwa/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/andschwa"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "We should add a method GetEncodedCommand or property EncodedCommand to the ScriptBlock type (and maybe a function to go the other way around).\n\ne.g. {get-process }.GetEncodedCommand() \n",
    "created_at": "2016-04-14T23:10:10Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/712#issuecomment-210198064",
    "id": 210198064,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/712",
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxMDE5ODA2NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/210198064/reactions"
    },
    "updated_at": "2016-04-14T23:10:10Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/210198064",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6188114?v=4",
      "events_url": "https://api.github.com/users/jpsnover/events{/privacy}",
      "followers_url": "https://api.github.com/users/jpsnover/followers",
      "following_url": "https://api.github.com/users/jpsnover/following{/other_user}",
      "gists_url": "https://api.github.com/users/jpsnover/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jpsnover",
      "id": 6188114,
      "login": "jpsnover",
      "node_id": "MDQ6VXNlcjYxODgxMTQ=",
      "organizations_url": "https://api.github.com/users/jpsnover/orgs",
      "received_events_url": "https://api.github.com/users/jpsnover/received_events",
      "repos_url": "https://api.github.com/users/jpsnover/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jpsnover/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jpsnover/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jpsnover"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@palladia You implemented this, right? If so please add tests and close.\n",
    "created_at": "2016-04-20T23:38:44Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/712#issuecomment-212652735",
    "id": 212652735,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/712",
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxMjY1MjczNQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/212652735/reactions"
    },
    "updated_at": "2016-04-20T23:38:44Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/212652735",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/2226434?v=4",
      "events_url": "https://api.github.com/users/andschwa/events{/privacy}",
      "followers_url": "https://api.github.com/users/andschwa/followers",
      "following_url": "https://api.github.com/users/andschwa/following{/other_user}",
      "gists_url": "https://api.github.com/users/andschwa/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/andschwa",
      "id": 2226434,
      "login": "andschwa",
      "node_id": "MDQ6VXNlcjIyMjY0MzQ=",
      "organizations_url": "https://api.github.com/users/andschwa/orgs",
      "received_events_url": "https://api.github.com/users/andschwa/received_events",
      "repos_url": "https://api.github.com/users/andschwa/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/andschwa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/andschwa/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/andschwa"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "I've got this @palladia.\n",
    "created_at": "2016-04-21T23:00:21Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/712#issuecomment-213151851",
    "id": 213151851,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/712",
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxMzE1MTg1MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/213151851/reactions"
    },
    "updated_at": "2016-04-21T23:00:21Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/213151851",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/2226434?v=4",
      "events_url": "https://api.github.com/users/andschwa/events{/privacy}",
      "followers_url": "https://api.github.com/users/andschwa/followers",
      "following_url": "https://api.github.com/users/andschwa/following{/other_user}",
      "gists_url": "https://api.github.com/users/andschwa/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/andschwa",
      "id": 2226434,
      "login": "andschwa",
      "node_id": "MDQ6VXNlcjIyMjY0MzQ=",
      "organizations_url": "https://api.github.com/users/andschwa/orgs",
      "received_events_url": "https://api.github.com/users/andschwa/received_events",
      "repos_url": "https://api.github.com/users/andschwa/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/andschwa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/andschwa/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/andschwa"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "I've revisited this a bit, and I'm more confused than ever on whether I implemented this correctly.  If you search 64-bit encoding, some websites say to use System.Text.Encoding.Unicode, and some say to use System.Text.Encoding.UTF8.  Unfortunately, they aren't compatible.  From my testing, Unicode generates an extra byte per character.\n",
    "created_at": "2016-04-21T23:12:19Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/712#issuecomment-213154133",
    "id": 213154133,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/712",
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxMzE1NDEzMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/213154133/reactions"
    },
    "updated_at": "2016-04-21T23:12:19Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/213154133",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/16566935?v=4",
      "events_url": "https://api.github.com/users/palladia/events{/privacy}",
      "followers_url": "https://api.github.com/users/palladia/followers",
      "following_url": "https://api.github.com/users/palladia/following{/other_user}",
      "gists_url": "https://api.github.com/users/palladia/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/palladia",
      "id": 16566935,
      "login": "palladia",
      "node_id": "MDQ6VXNlcjE2NTY2OTM1",
      "organizations_url": "https://api.github.com/users/palladia/orgs",
      "received_events_url": "https://api.github.com/users/palladia/received_events",
      "repos_url": "https://api.github.com/users/palladia/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/palladia/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/palladia/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/palladia"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "Yeah I was talking with Jim about it. He suggests we use Unicode as PowerShell's original implementation does the same.\n\nThe problem is that this breaks compatibility with Linux where most things are UTF8 (i.e. if you do `echo get-location | base64` and use that as the input, it fails).\n\nWe _could_ be platform specific about it by using Unicode on Windows and UTF8 on Linux, but should we?\n",
    "created_at": "2016-04-21T23:17:13Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/712#issuecomment-213155218",
    "id": 213155218,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/712",
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxMzE1NTIxOA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/213155218/reactions"
    },
    "updated_at": "2016-04-21T23:17:13Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/213155218",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/2226434?v=4",
      "events_url": "https://api.github.com/users/andschwa/events{/privacy}",
      "followers_url": "https://api.github.com/users/andschwa/followers",
      "following_url": "https://api.github.com/users/andschwa/following{/other_user}",
      "gists_url": "https://api.github.com/users/andschwa/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/andschwa",
      "id": 2226434,
      "login": "andschwa",
      "node_id": "MDQ6VXNlcjIyMjY0MzQ=",
      "organizations_url": "https://api.github.com/users/andschwa/orgs",
      "received_events_url": "https://api.github.com/users/andschwa/received_events",
      "repos_url": "https://api.github.com/users/andschwa/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/andschwa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/andschwa/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/andschwa"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "I have a branch up that adds tests and swaps it to Unicode, which is probably the right thing to do for now.\n",
    "created_at": "2016-04-21T23:17:43Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/712#issuecomment-213155458",
    "id": 213155458,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/712",
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxMzE1NTQ1OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/213155458/reactions"
    },
    "updated_at": "2016-04-21T23:17:43Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/213155458",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/2226434?v=4",
      "events_url": "https://api.github.com/users/andschwa/events{/privacy}",
      "followers_url": "https://api.github.com/users/andschwa/followers",
      "following_url": "https://api.github.com/users/andschwa/following{/other_user}",
      "gists_url": "https://api.github.com/users/andschwa/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/andschwa",
      "id": 2226434,
      "login": "andschwa",
      "node_id": "MDQ6VXNlcjIyMjY0MzQ=",
      "organizations_url": "https://api.github.com/users/andschwa/orgs",
      "received_events_url": "https://api.github.com/users/andschwa/received_events",
      "repos_url": "https://api.github.com/users/andschwa/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/andschwa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/andschwa/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/andschwa"
    }
  },
  {
    "author_association": "NONE",
    "body": "Brief idea: I don't think there's a valid character for a script to start with that would cause the second byte of a utf-16 encoding to be anything other than 0x00, and I don't think a valid utf-8 script longer than 1 byte can have 0x00 as the second byte. (BOMs notwithstanding, but those are well-defined.) I've struggled with the cross-platformness of -EncodedCommand before, and been equally frustrated at the needlessly space-wasting utf-16 encoding making the base64 strings *just* too long for, say, including in an unattend.xml file (where command length is limited to 255 characters).\r\n\r\nCouldn't we perform encoding detection between UTF-8 and UTF-16, and do it on both platforms? Pseudocode:\r\n\r\n    System.Text.Encoding detectEncoding(byte[] cmd) {\r\n        if (cmd.length <= 1) return System.Text.Encoding.UTF8;\r\n        if (cmd[0] == 0xFF && cmd[1] == 0xFE) return System.Text.Encoding.Unicode;\r\n        if (cmd.length >= 3 && cmd[0] == 0xEF && cmd[1] == 0xBB && cmd[2] == 0xBF) return System.Text.Encoding.UTF8;\r\n        if (cmd[1] == 0x00) return System.Text.Encoding.Unicode;\r\n        return System.Text.Encoding.UTF8;\r\n    }\r\n\r\nI'd be happy to work up a PR if needed.",
    "created_at": "2018-01-15T16:42:04Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/712#issuecomment-357734560",
    "id": 357734560,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/712",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NzczNDU2MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/357734560/reactions"
    },
    "updated_at": "2018-01-15T16:42:04Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/357734560",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/645226?v=4",
      "events_url": "https://api.github.com/users/mrnerdhair/events{/privacy}",
      "followers_url": "https://api.github.com/users/mrnerdhair/followers",
      "following_url": "https://api.github.com/users/mrnerdhair/following{/other_user}",
      "gists_url": "https://api.github.com/users/mrnerdhair/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mrnerdhair",
      "id": 645226,
      "login": "mrnerdhair",
      "node_id": "MDQ6VXNlcjY0NTIyNg==",
      "organizations_url": "https://api.github.com/users/mrnerdhair/orgs",
      "received_events_url": "https://api.github.com/users/mrnerdhair/received_events",
      "repos_url": "https://api.github.com/users/mrnerdhair/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mrnerdhair/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mrnerdhair/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mrnerdhair"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@reidrankin Sorry for the late reply. Could you please open new Issue to discuss?",
    "created_at": "2018-02-08T06:50:42Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/712#issuecomment-364018811",
    "id": 364018811,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/712",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2NDAxODgxMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/364018811/reactions"
    },
    "updated_at": "2018-02-08T06:50:42Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/364018811",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  }
]

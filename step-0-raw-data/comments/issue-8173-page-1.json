[
  {
    "author_association": "MEMBER",
    "body": "Note that the exception due to `-ErrorAction Stop` wraps the ErrorRecord that has the correct line number.  Unless we can determine if there's value in wrapping the ErrorRecord, perhaps the best thing is just to not wrap so the right line number is shown without the user having to dig into the exception for it.",
    "created_at": "2018-11-02T00:48:24Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8173#issuecomment-435235079",
    "id": 435235079,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8173",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNTIzNTA3OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/435235079/reactions"
    },
    "updated_at": "2018-11-02T00:48:24Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/435235079",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Wouldn't this result in deploying the contents of defined module functions as well?\n\nIn most cases an error that is emitted is due primarily to user input, if the script or module is designed well. As such, I would contend that it makes more sense to show the user just the command call as it does now, as for many third party module functions  the innards are less relevant than the call to the command, which probably passed it the bad parameter in the first place... I think.",
    "created_at": "2018-11-02T00:52:47Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8173#issuecomment-435235884",
    "id": 435235884,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8173",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNTIzNTg4NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/435235884/reactions"
    },
    "updated_at": "2018-11-02T00:52:47Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/435235884",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/32407840?v=4",
      "events_url": "https://api.github.com/users/vexx32/events{/privacy}",
      "followers_url": "https://api.github.com/users/vexx32/followers",
      "following_url": "https://api.github.com/users/vexx32/following{/other_user}",
      "gists_url": "https://api.github.com/users/vexx32/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vexx32",
      "id": 32407840,
      "login": "vexx32",
      "node_id": "MDQ6VXNlcjMyNDA3ODQw",
      "organizations_url": "https://api.github.com/users/vexx32/orgs",
      "received_events_url": "https://api.github.com/users/vexx32/received_events",
      "repos_url": "https://api.github.com/users/vexx32/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vexx32/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vexx32/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vexx32"
    }
  },
  {
    "author_association": "NONE",
    "body": "From the perspective of the script author having the correct line number is of course very important. That is primarily who the information is for, I would think. If the thinking is that the user doesn't care, which is a legit position, then the line number should be omitted entirely. But having incorrect information is bad for either case.\r\n\r\nOmitting the information doesn't help anyone - I would argue it makes no difference to an end user (non-author), while it only hurts the author's ability to troubleshoot. Putting the correct info makes life substantially better for the author, while again making little to no difference to the end user.",
    "created_at": "2018-11-02T01:02:16Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8173#issuecomment-435237445",
    "id": 435237445,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8173",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNTIzNzQ0NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/435237445/reactions"
    },
    "updated_at": "2018-11-02T01:02:16Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/435237445",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/42390724?v=4",
      "events_url": "https://api.github.com/users/LyleCorbin/events{/privacy}",
      "followers_url": "https://api.github.com/users/LyleCorbin/followers",
      "following_url": "https://api.github.com/users/LyleCorbin/following{/other_user}",
      "gists_url": "https://api.github.com/users/LyleCorbin/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/LyleCorbin",
      "id": 42390724,
      "login": "LyleCorbin",
      "node_id": "MDQ6VXNlcjQyMzkwNzI0",
      "organizations_url": "https://api.github.com/users/LyleCorbin/orgs",
      "received_events_url": "https://api.github.com/users/LyleCorbin/received_events",
      "repos_url": "https://api.github.com/users/LyleCorbin/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/LyleCorbin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/LyleCorbin/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/LyleCorbin"
    }
  },
  {
    "author_association": "NONE",
    "body": "I would like to re-iterate as well that I'm 100% certain this is a regression from at least v4, when I was doing extensive script authoring and never saw this problem. Unfortunately, I don't know exactly when the behavior changed.",
    "created_at": "2018-11-02T01:04:30Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8173#issuecomment-435237811",
    "id": 435237811,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8173",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNTIzNzgxMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/435237811/reactions"
    },
    "updated_at": "2018-11-02T01:04:30Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/435237811",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/42390724?v=4",
      "events_url": "https://api.github.com/users/LyleCorbin/events{/privacy}",
      "followers_url": "https://api.github.com/users/LyleCorbin/followers",
      "following_url": "https://api.github.com/users/LyleCorbin/following{/other_user}",
      "gists_url": "https://api.github.com/users/LyleCorbin/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/LyleCorbin",
      "id": 42390724,
      "login": "LyleCorbin",
      "node_id": "MDQ6VXNlcjQyMzkwNzI0",
      "organizations_url": "https://api.github.com/users/LyleCorbin/orgs",
      "received_events_url": "https://api.github.com/users/LyleCorbin/received_events",
      "repos_url": "https://api.github.com/users/LyleCorbin/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/LyleCorbin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/LyleCorbin/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/LyleCorbin"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "Not wrapping the ErrorRecord with an exception when $ErrorActionPreference = Stop by cause unintended side effects.  Another option to address the user experience issue is updating the default error view to show ErrorRecords and/or InnerExceptions https://github.com/PowerShell/PowerShell/issues/3647",
    "created_at": "2018-11-02T01:20:18Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8173#issuecomment-435240493",
    "id": 435240493,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8173",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNTI0MDQ5Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/435240493/reactions"
    },
    "updated_at": "2018-11-02T01:20:18Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/435240493",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "NONE",
    "body": "Note also difference in the script name for two reported errors:\r\n```text\r\nAt D:\\junk\\error.ps1:10 char:5\r\nAt line:1 char:1\r\n```\r\n\r\nFirst thing points to line 10 in the script. Second one points to line 1 in the console, not in the script.",
    "created_at": "2018-11-02T13:05:06Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8173#issuecomment-435372991",
    "id": 435372991,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8173",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNTM3Mjk5MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/435372991/reactions"
    },
    "updated_at": "2018-11-02T13:05:06Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/435372991",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/15923171?v=4",
      "events_url": "https://api.github.com/users/iricigor/events{/privacy}",
      "followers_url": "https://api.github.com/users/iricigor/followers",
      "following_url": "https://api.github.com/users/iricigor/following{/other_user}",
      "gists_url": "https://api.github.com/users/iricigor/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iricigor",
      "id": 15923171,
      "login": "iricigor",
      "node_id": "MDQ6VXNlcjE1OTIzMTcx",
      "organizations_url": "https://api.github.com/users/iricigor/orgs",
      "received_events_url": "https://api.github.com/users/iricigor/received_events",
      "repos_url": "https://api.github.com/users/iricigor/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iricigor/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iricigor/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iricigor"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "That is certainly an unusual discrepancy, indeed. Two sources of information here in the one error message! ðŸ˜„ ",
    "created_at": "2018-11-02T13:07:37Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8173#issuecomment-435373851",
    "id": 435373851,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8173",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNTM3Mzg1MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/435373851/reactions"
    },
    "updated_at": "2018-11-02T13:07:37Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/435373851",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/32407840?v=4",
      "events_url": "https://api.github.com/users/vexx32/events{/privacy}",
      "followers_url": "https://api.github.com/users/vexx32/followers",
      "following_url": "https://api.github.com/users/vexx32/following{/other_user}",
      "gists_url": "https://api.github.com/users/vexx32/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vexx32",
      "id": 32407840,
      "login": "vexx32",
      "node_id": "MDQ6VXNlcjMyNDA3ODQw",
      "organizations_url": "https://api.github.com/users/vexx32/orgs",
      "received_events_url": "https://api.github.com/users/vexx32/received_events",
      "repos_url": "https://api.github.com/users/vexx32/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vexx32/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vexx32/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vexx32"
    }
  },
  {
    "author_association": "NONE",
    "body": "Save this example as a `loc.ps1` file and run it::\r\n```PowerShell\r\nfunction diverr {\r\n    [CmdletBinding()]\r\n    param()\r\n    1/0  # line 4\r\n}\r\ndiverr -ErrorAction Stop  # line 6\r\n```\r\n\r\nWith `-ErrorAction Stop` error is reported in line 6. Without `-ErrorAction Stop`, error is reported in line 4.",
    "created_at": "2018-11-02T13:12:47Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8173#issuecomment-435375705",
    "id": 435375705,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8173",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNTM3NTcwNQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/435375705/reactions"
    },
    "updated_at": "2018-11-02T13:18:11Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/435375705",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/15923171?v=4",
      "events_url": "https://api.github.com/users/iricigor/events{/privacy}",
      "followers_url": "https://api.github.com/users/iricigor/followers",
      "following_url": "https://api.github.com/users/iricigor/following{/other_user}",
      "gists_url": "https://api.github.com/users/iricigor/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iricigor",
      "id": 15923171,
      "login": "iricigor",
      "node_id": "MDQ6VXNlcjE1OTIzMTcx",
      "organizations_url": "https://api.github.com/users/iricigor/orgs",
      "received_events_url": "https://api.github.com/users/iricigor/received_events",
      "repos_url": "https://api.github.com/users/iricigor/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iricigor/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iricigor/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iricigor"
    }
  },
  {
    "author_association": "NONE",
    "body": "I also hit this issue of incorrectly displayed error line numbers when debugging a script that has $ErrorAction=\"Stop\".\r\n\r\nFor now, my workaround is to set the prompt function in my profile to include a check for a nested error:\r\n\r\n```\r\nFunction prompt {\r\n    if (-not $?) {\r\n        $err = $error[0]\r\n        $cmdId = $(get-history -Count 1).id\r\n        # Prevent redisplay of the error if there was no new command (e.g., just pressing enter)\r\n        if ($cmdId -ne $global:profile_lastCmdId) {  \r\n        if ($err | gm ErrorRecord) {\r\n        if ($err.ErrorRecord | gm Exception) {\r\n        if ($err.ErrorRecord.Exception | gm ErrorRecord) {\r\n            $err.ErrorRecord.Exception.ErrorRecord | out-Host\r\n    }}}}}\r\n\r\n    # ... any additional prompt logic\r\n    \"PS $($executionContext.SessionState.Path.CurrentLocation)$('>' * ($nestedPromptLevel + 1))\"\r\n\r\n     $global:profile_lastCmdId = $(get-history -Count 1).id\r\n}\r\n```\r\n\r\nSeems to work reasonably well, but won't save the initial headache for those running into this issue for the first time. \r\n",
    "created_at": "2021-05-28T07:38:11Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8173#issuecomment-850217352",
    "id": 850217352,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8173",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1MDIxNzM1Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/850217352/reactions"
    },
    "updated_at": "2021-05-28T23:05:04Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/850217352",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/7946390?v=4",
      "events_url": "https://api.github.com/users/kganjam/events{/privacy}",
      "followers_url": "https://api.github.com/users/kganjam/followers",
      "following_url": "https://api.github.com/users/kganjam/following{/other_user}",
      "gists_url": "https://api.github.com/users/kganjam/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/kganjam",
      "id": 7946390,
      "login": "kganjam",
      "node_id": "MDQ6VXNlcjc5NDYzOTA=",
      "organizations_url": "https://api.github.com/users/kganjam/orgs",
      "received_events_url": "https://api.github.com/users/kganjam/received_events",
      "repos_url": "https://api.github.com/users/kganjam/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/kganjam/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kganjam/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/kganjam"
    }
  }
]

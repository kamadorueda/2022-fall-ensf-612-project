[
  {
    "author_association": "COLLABORATOR",
    "body": "Trying to enumerate manually gives a more specific error message:\r\n\r\n```powershell\r\n$cim = [CimSession]::Create('.')\r\n$cim.EnumerateInstances('root/wmi', 'BatteryStaticData')\r\n# InvalidOperation: An error occurred while enumerating through a collection: The WS-Management service cannot process the request. The request contains an invalid datetime. The string **************.********** does not represent any of these types: xs:dateTime, xs:date, or xs:time..\r\n```\r\n\r\n<details>\r\n\r\n<summary>Get-Error output</summary>\r\n\r\n```powershell\r\n$Error[0].Exception.InnerException|Get-Error\r\n\r\nType            : Microsoft.Management.Infrastructure.CimException\r\nNativeErrorCode : Failed\r\nErrorData       : MSFT_WmiError\r\nMessageId       : HRESULT 0x80338041\r\nStatusCode      : 1\r\nTargetSite      :\r\n    Name          : MoveNext\r\n    DeclaringType : Microsoft.Management.Infrastructure.Internal.Operations.CimSyncEnumeratorBase`1[T]\r\n    MemberType    : Method\r\n    Module        : Microsoft.Management.Infrastructure.dll\r\nStackTrace      :\r\n   at Microsoft.Management.Infrastructure.Internal.Operations.CimSyncEnumeratorBase`1.MoveNext()\r\n   at System.Management.Automation.EnumerableOps.MoveNext(ExecutionContext context, IEnumerator enumerator)\r\nMessage         : The WS-Management service cannot process the request. The request contains an invalid datetime. The string\r\n**************.********** does not represent any of these types: xs:dateTime, xs:date, or xs:time.\r\nSource          : Microsoft.Management.Infrastructure\r\nHResult         : -2146233088\r\n```\r\n\r\n</details>\r\n",
    "created_at": "2021-07-19T17:16:08Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15799#issuecomment-882719132",
    "id": 882719132,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15799",
    "node_id": "IC_kwDOAvT7bc40nTmc",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/882719132/reactions"
    },
    "updated_at": "2021-07-19T17:16:08Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/882719132",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  },
  {
    "author_association": "NONE",
    "body": "Great addition, thank you @SeeminglyScience !\r\n\r\nVerified the same additional output:\r\n```ps\r\nPS C:\\> $cim = [CimSession]::Create('.')\r\nPS C:\\> $cim.EnumerateInstances('root/wmi', 'BatteryStaticData')\r\nInvalidOperation: An error occurred while enumerating through a collection: The WS-Management service cannot process the request. The request contains an invalid datetime. The string **************.********** does not represent any of these types: xs:dateTime, xs:date, or xs:time..\r\n```\r\n\r\n<details><summary>Get-Error details</summary><p>\r\n\r\n```ps\r\nPS C:\\> Get-Error\r\n\r\nException             :\r\n    Type           : System.Management.Automation.RuntimeException\r\n    ErrorRecord    :\r\n        Exception             :\r\n            Type    : System.Management.Automation.ParentContainsErrorRecordException\r\n            Message : An error occurred while enumerating through a collection: The WS-Management service cannot\r\nprocess the request. The request contains an invalid datetime. The string **************.********** does not represent\r\nany of these types: xs:dateTime, xs:date, or xs:time..\r\n            HResult : -2146233087\r\n        CategoryInfo          : InvalidOperation: (Microsoft.Managemen…cInstanceEnumerator:CimSyncInstanceEnumerator)\r\n[], ParentContainsErrorRecordException\r\n        FullyQualifiedErrorId : BadEnumeration\r\n        InvocationInfo        :\r\n            ScriptLineNumber : 1\r\n            OffsetInLine     : 1\r\n            HistoryId        : -1\r\n            Line             : $cim.EnumerateInstances('root/wmi', 'BatteryStaticData')\r\n            PositionMessage  : At line:1 char:1\r\n                               + $cim.EnumerateInstances('root/wmi', 'BatteryStaticData')\r\n                               + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n            CommandOrigin    : Internal\r\n        ScriptStackTrace      : at <ScriptBlock>, <No file>: line 1\r\n    TargetSite     :\r\n        Name          : MoveNext\r\n        DeclaringType : System.Management.Automation.EnumerableOps, System.Management.Automation, Version=7.1.3.0,\r\nCulture=neutral, PublicKeyToken=31bf3856ad364e35\r\n        MemberType    : Method\r\n        Module        : System.Management.Automation.dll\r\n    StackTrace     :\r\n   at System.Management.Automation.EnumerableOps.MoveNext(ExecutionContext context, IEnumerator enumerator)\r\n   at System.Management.Automation.EnumerableOps.WriteEnumerableToPipe(IEnumerator enumerator, Pipe pipe,\r\nExecutionContext context, Boolean dispose)\r\n   at System.Dynamic.UpdateDelegates.UpdateAndExecuteVoid3[T0,T1,T2](CallSite site, T0 arg0, T1 arg1, T2 arg2)\r\n   at System.Management.Automation.Interpreter.ActionCallInstruction`5.Invoke(Object arg0, Object arg1, Object arg2,\r\nObject arg3, Object arg4)\r\n   at System.Management.Automation.Interpreter.CallInstruction.InvokeInstance(Object instance, Object[] args)\r\n   at System.Management.Automation.Interpreter.DynamicInstructionN.Run(InterpretedFrame frame)\r\n   at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame)\r\n    Message        : An error occurred while enumerating through a collection: The WS-Management service cannot\r\nprocess the request. The request contains an invalid datetime. The string **************.********** does not represent\r\nany of these types: xs:dateTime, xs:date, or xs:time..\r\n    Data           : System.Collections.ListDictionaryInternal\r\n    InnerException :\r\n        Type            : Microsoft.Management.Infrastructure.CimException\r\n        NativeErrorCode : Failed\r\n        ErrorData       : MSFT_WmiError\r\n        MessageId       : HRESULT 0x80338041\r\n        StatusCode      : 1\r\n        TargetSite      :\r\n            Name          : MoveNext\r\n            DeclaringType : Microsoft.Management.Infrastructure.Internal.Operations.CimSyncEnumeratorBase`1[T]\r\n            MemberType    : Method\r\n            Module        : Microsoft.Management.Infrastructure.dll\r\n        StackTrace      :\r\n   at Microsoft.Management.Infrastructure.Internal.Operations.CimSyncEnumeratorBase`1.MoveNext()\r\n   at System.Management.Automation.EnumerableOps.MoveNext(ExecutionContext context, IEnumerator enumerator)\r\n        Message         : The WS-Management service cannot process the request. The request contains an invalid\r\ndatetime. The string **************.********** does not represent any of these types: xs:dateTime, xs:date, or xs:time.\r\n        Source          : Microsoft.Management.Infrastructure\r\n        HResult         : -2146233088\r\n    Source         : System.Management.Automation\r\n    HResult        : -2146233087\r\nCategoryInfo          : InvalidOperation: (Microsoft.Managemen…cInstanceEnumerator:CimSyncInstanceEnumerator) [],\r\nRuntimeException\r\nFullyQualifiedErrorId : BadEnumeration\r\nInvocationInfo        :\r\n    ScriptLineNumber : 1\r\n    OffsetInLine     : 1\r\n    HistoryId        : -1\r\n    Line             : $cim.EnumerateInstances('root/wmi', 'BatteryStaticData')\r\n    PositionMessage  : At line:1 char:1\r\n                       + $cim.EnumerateInstances('root/wmi', 'BatteryStaticData')\r\n                       + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    CommandOrigin    : Internal\r\nScriptStackTrace      : at <ScriptBlock>, <No file>: line 1\r\n```</p></details>",
    "created_at": "2021-07-19T17:29:13Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15799#issuecomment-882727993",
    "id": 882727993,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15799",
    "node_id": "IC_kwDOAvT7bc40nVw5",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/882727993/reactions"
    },
    "updated_at": "2021-07-19T17:40:59Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/882727993",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/32749858?v=4",
      "events_url": "https://api.github.com/users/hkystar35/events{/privacy}",
      "followers_url": "https://api.github.com/users/hkystar35/followers",
      "following_url": "https://api.github.com/users/hkystar35/following{/other_user}",
      "gists_url": "https://api.github.com/users/hkystar35/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/hkystar35",
      "id": 32749858,
      "login": "hkystar35",
      "node_id": "MDQ6VXNlcjMyNzQ5ODU4",
      "organizations_url": "https://api.github.com/users/hkystar35/orgs",
      "received_events_url": "https://api.github.com/users/hkystar35/received_events",
      "repos_url": "https://api.github.com/users/hkystar35/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/hkystar35/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hkystar35/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/hkystar35"
    }
  },
  {
    "author_association": "NONE",
    "body": "A little code, to determinate which property is failed.\r\n\r\n```\r\nGet-CimInstance -Namespace root/wmi -ClassName BatteryStaticData -KeyOnly | \r\nGet-Member -MemberType Properties | \r\nWhere-Object Name -ne PSComputerName | \r\nForEach-Object { $_.Name ; Get-CimInstance -Namespace root/wmi -ClassName BatteryStaticData -Property $_.Name | Out-Null }\r\n```\r\n\r\nSo it's ManufactureDate\r\n\r\nI exclude it.\r\n```\r\nGet-CimInstance -Namespace root/wmi -ClassName BatteryStaticData -Property 'Active', 'Capabilities', 'Caption', 'Chemistry', 'CriticalBias', 'DefaultAlert1', 'DefaultAlert2', 'Description', 'DesignedCapacity', 'DeviceName', 'Frequency_Object', 'Frequency_PerfTime', 'Frequency_Sys100NS', 'Granularity0', 'Granularity1', 'Granularity2', 'Granularity3', 'InstanceName', 'ManufactureName', 'Name', 'SerialNumber', 'Tag', 'Technology', 'Timestamp_Object', 'Timestamp_PerfTime', 'Timestamp_Sys100NS', 'UniqueID'\r\n```\r\n\r\nWorkaround is working :)\r\n\r\nThe WMI command shows the same value as you for my old Dell. \r\n`ManufactureDate    : **************.**********`\r\n\r\nI will test on another computer later.\r\n\r\n",
    "created_at": "2021-07-20T10:20:49Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15799#issuecomment-883278778",
    "id": 883278778,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15799",
    "node_id": "IC_kwDOAvT7bc40pcO6",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/883278778/reactions"
    },
    "updated_at": "2021-07-20T10:20:49Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/883278778",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6187529?v=4",
      "events_url": "https://api.github.com/users/fMichaleczek/events{/privacy}",
      "followers_url": "https://api.github.com/users/fMichaleczek/followers",
      "following_url": "https://api.github.com/users/fMichaleczek/following{/other_user}",
      "gists_url": "https://api.github.com/users/fMichaleczek/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/fMichaleczek",
      "id": 6187529,
      "login": "fMichaleczek",
      "node_id": "MDQ6VXNlcjYxODc1Mjk=",
      "organizations_url": "https://api.github.com/users/fMichaleczek/orgs",
      "received_events_url": "https://api.github.com/users/fMichaleczek/received_events",
      "repos_url": "https://api.github.com/users/fMichaleczek/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/fMichaleczek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fMichaleczek/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/fMichaleczek"
    }
  },
  {
    "author_association": "NONE",
    "body": "СIM is much poorer than WMI in terms of functionality. But what we have, we use. A tribute to modern technologies at the expense of existing ones.",
    "created_at": "2021-07-20T15:56:57Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15799#issuecomment-883506442",
    "id": 883506442,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15799",
    "node_id": "IC_kwDOAvT7bc40qT0K",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/883506442/reactions"
    },
    "updated_at": "2021-07-20T15:56:57Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/883506442",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/78153320?v=4",
      "events_url": "https://api.github.com/users/237dmitry/events{/privacy}",
      "followers_url": "https://api.github.com/users/237dmitry/followers",
      "following_url": "https://api.github.com/users/237dmitry/following{/other_user}",
      "gists_url": "https://api.github.com/users/237dmitry/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/237dmitry",
      "id": 78153320,
      "login": "237dmitry",
      "node_id": "MDQ6VXNlcjc4MTUzMzIw",
      "organizations_url": "https://api.github.com/users/237dmitry/orgs",
      "received_events_url": "https://api.github.com/users/237dmitry/received_events",
      "repos_url": "https://api.github.com/users/237dmitry/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/237dmitry/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/237dmitry/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/237dmitry"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "The reason CIM fails here is essentially because it tries to be helpful and convert the wmi/cim datetime value to a usable DateTime object in .NET. Arguably, an improvement more than anything.\r\n\r\nIt would be a good idea to have a fallback to return the raw value (or just nothing), for cases like this where the property's value is unusable.",
    "created_at": "2021-07-20T16:12:07Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15799#issuecomment-883517987",
    "id": 883517987,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15799",
    "node_id": "IC_kwDOAvT7bc40qWoj",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/883517987/reactions"
    },
    "updated_at": "2021-07-20T16:12:26Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/883517987",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/32407840?v=4",
      "events_url": "https://api.github.com/users/vexx32/events{/privacy}",
      "followers_url": "https://api.github.com/users/vexx32/followers",
      "following_url": "https://api.github.com/users/vexx32/following{/other_user}",
      "gists_url": "https://api.github.com/users/vexx32/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vexx32",
      "id": 32407840,
      "login": "vexx32",
      "node_id": "MDQ6VXNlcjMyNDA3ODQw",
      "organizations_url": "https://api.github.com/users/vexx32/orgs",
      "received_events_url": "https://api.github.com/users/vexx32/received_events",
      "repos_url": "https://api.github.com/users/vexx32/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vexx32/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vexx32/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vexx32"
    }
  },
  {
    "author_association": "NONE",
    "body": "> The reason CIM fails here is essentially because it tries to be helpful and convert the wmi/cim datetime value to a usable DateTime object in .NET. Arguably, an improvement more than anything.\r\n> \r\n> It would be a good idea to have a fallback to return the raw value (or just nothing), for cases like this where the property's value is unusable.\r\n\r\nThis issue should be moved to this repository https://github.com/PowerShell/MMI\r\n\r\n\n\n<blockquote><img src=\"https://opengraph.githubassets.com/aadc50178300335b30911ebbe2add4aaeff7aea91a6ecbe214a127b3e2262471/PowerShell/MMI\" width=\"48\" align=\"right\"><div><img src=\"https://github.githubassets.com/favicons/favicon.svg\" height=\"14\"> GitHub</div><div><strong><a href=\"https://github.com/PowerShell/MMI\">PowerShell/MMI</a></strong></div><div>Contribute to PowerShell/MMI development by creating an account on GitHub.</div></blockquote>",
    "created_at": "2021-07-20T16:51:53Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15799#issuecomment-883544113",
    "id": 883544113,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15799",
    "node_id": "IC_kwDOAvT7bc40qdAx",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/883544113/reactions"
    },
    "updated_at": "2021-07-20T16:51:54Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/883544113",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6187529?v=4",
      "events_url": "https://api.github.com/users/fMichaleczek/events{/privacy}",
      "followers_url": "https://api.github.com/users/fMichaleczek/followers",
      "following_url": "https://api.github.com/users/fMichaleczek/following{/other_user}",
      "gists_url": "https://api.github.com/users/fMichaleczek/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/fMichaleczek",
      "id": 6187529,
      "login": "fMichaleczek",
      "node_id": "MDQ6VXNlcjYxODc1Mjk=",
      "organizations_url": "https://api.github.com/users/fMichaleczek/orgs",
      "received_events_url": "https://api.github.com/users/fMichaleczek/received_events",
      "repos_url": "https://api.github.com/users/fMichaleczek/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/fMichaleczek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fMichaleczek/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/fMichaleczek"
    }
  }
]

[
  {
    "author_association": "MEMBER",
    "body": "[Move discussion comments from MSTeam to Github]\r\n`Add-Type` can be made smarter to do better choice about what explicitly given reference assemblies to ignore and what to included implicitly. The user probably should be notified that the ignored ref assemblies are not necessary, probably through a warning message.",
    "created_at": "2017-05-13T00:37:35Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3779#issuecomment-301213800",
    "id": 301213800,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3779",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMTIxMzgwMA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/301213800/reactions"
    },
    "updated_at": "2017-05-13T00:37:35Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/301213800",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "The problem we need to solve (or at least mitigate) is to avoid requiring conditional logic about how to specify `-ReferenceAssembly` parameter when using `Add-Type` in a script that would run on Windows PowerShell and PowerShell Core. Ideally, a single set of arguments for `-ReferenceAssembly` should work on both Windows PowerShell and PowerShell Core.",
    "created_at": "2017-05-13T00:59:09Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3779#issuecomment-301215302",
    "id": 301215302,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3779",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMTIxNTMwMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/301215302/reactions"
    },
    "updated_at": "2017-05-13T01:01:59Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/301215302",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@daxian-dbw It seems you already fixed the Issue.",
    "created_at": "2017-11-20T12:50:54Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3779#issuecomment-345686556",
    "id": 345686556,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3779",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0NTY4NjU1Ng==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/345686556/reactions"
    },
    "updated_at": "2017-11-20T12:50:54Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/345686556",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@iSazonov If I remember it correctly, running `Add-Assembly` with the same script may require different reference assemblies on Wndows PowerShell and PowerShell Core, so a conditional logic is needed if `Add-Type` is needed for a module targeting both Windows PowerShell and PowerShell Core. This issue is for solving or mitigating that problem.",
    "created_at": "2017-11-20T22:48:45Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3779#issuecomment-345857858",
    "id": 345857858,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3779",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0NTg1Nzg1OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/345857858/reactions"
    },
    "updated_at": "2017-11-20T22:48:45Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/345857858",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@daxian-dbw Thanks for clarify! The repo and workaround from the Issue don't work now. Have you new repo?",
    "created_at": "2017-11-21T05:23:52Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3779#issuecomment-345920547",
    "id": 345920547,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3779",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0NTkyMDU0Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/345920547/reactions"
    },
    "updated_at": "2017-11-21T05:23:52Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/345920547",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@iSazonov I have updated the repro steps in the issue description. It should demonstrate that the same script runs on Windows PowerShell but fails on PowerShell Core.",
    "created_at": "2017-11-29T06:09:53Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3779#issuecomment-347762962",
    "id": 347762962,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3779",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0Nzc2Mjk2Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/347762962/reactions"
    },
    "updated_at": "2017-11-29T06:09:53Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/347762962",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@daxian-dbw Thanks for the update!\r\nIf we remove `-ReferencedAssemblies` the code works on both versions - so the reference on the assembly is not mandatory for Windows PowerShell. The error is because _required_ assemblies is missing from this list `-ReferencedAssemblies`. If replace `s_autoReferencedAssemblies.Value` with `s_defaultAssemblies.Value` in [the line](https://github.com/PowerShell/PowerShell/blob/master/src/Microsoft.PowerShell.Commands.Utility/commands/utility/AddType.cs#L1158) the Issue is resolved. If it is a right fix I can add it to [my fork ](https://github.com/iSazonov/PowerShell/blob/addtype-enhance1/src/Microsoft.PowerShell.Commands.Utility/commands/utility/AddType.cs) where I work on SyntaxTree integration.",
    "created_at": "2017-11-29T08:01:57Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3779#issuecomment-347781829",
    "id": 347781829,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3779",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0Nzc4MTgyOQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/347781829/reactions"
    },
    "updated_at": "2017-11-29T08:01:57Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/347781829",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@iSazonov The repro is just a demonstration, there could be other examples which you can come up with yourself once leaned the code that causes the issue.\r\n\r\nIf I remember correctly, you will also need to resolve the conflicts between what are specified by the user with `-ReferenceAssemblies` and the default references we use. The default ones are pointing to the reference assemblies in the `/refs` folder. If the user specify a dll path points to the runtime dll, you may get `ambiguous type identity` or other issues during the compilation. But sometimes it's OK to use a runtime dll path so that you can use types that are not included in the reference dlls that we include (we only include the standard .NET Core 2.0 reference assemblies, but say you want to use `Json.net.dll`).\r\n\r\nCurrently, we include the default references (all .NET Core 2.0 ref assemblies) only if `-ReferenceAssemblies` is not specified. It will be tricky if you want to always include them.",
    "created_at": "2017-11-29T18:51:38Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3779#issuecomment-347958627",
    "id": 347958627,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3779",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0Nzk1ODYyNw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/347958627/reactions"
    },
    "updated_at": "2017-11-29T18:51:38Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/347958627",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  }
]

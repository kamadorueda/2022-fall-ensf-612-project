[
  {
    "author_association": "COLLABORATOR",
    "body": "This may just need to be documented.  I'm not sure what the binder can really do here other than iterate `object[]` arrays looking for `PSObject`'s to replace with the underlying object. Plus nested arrays, other complex objects like hashtable, etc. Gets even more complicated (though also more unlikely) with collections like `ReadOnlyCollection<object>`.\r\n\r\nThis is also one of the few situations where autonull can leak into a dotnet method.",
    "created_at": "2021-02-17T17:34:36Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14829#issuecomment-780724088",
    "id": 780724088,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14829",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4MDcyNDA4OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/780724088/reactions"
    },
    "updated_at": "2021-02-17T17:35:59Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/780724088",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Thanks, @SeeminglyScience. I agree that trying to fix the problem in the binder is not the right place (and that documentation is called for, for old PowerShell versions alone).\r\n\r\nThe larger question is if we can eliminate the `[psobject]` wrapping that automatically happens when _compiled_ cmdlets (only) write to the pipeline, with `.WriteObject()` - I don't know if these wrappers are ever _needed_, but as this example and the other ones in  #5579 show, they certainly cause subtle bugs - and no one should be _relying_ on them, given that they're implementation details.\r\n\r\nCompiled cmdlet:\r\n\r\n```powershell\r\nAdd-Type @'\r\nusing System.Management.Automation;\r\n[Cmdlet(\"Get\", \"Foo\")]\r\npublic class GetFooCmdlet : PSCmdlet {\r\n  protected override void ProcessRecord() {\r\n    WriteObject(42);\r\n  }\r\n}\r\n'@ -PassThru | % Assembly | Import-Module\r\n\r\n(Get-Foo) -is [psobject] # -> $true - the [int] instance was [psobject] wrapped\r\n```\r\n\r\nPowerShell code:\r\n\r\n```powershell\r\nfunction Get-Foo { 42 }\r\n\r\n(Get-Foo) -is [psobject] # -> $false - NO [psobject] wrapper\r\n```\r\n\r\n",
    "created_at": "2021-02-17T18:36:02Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14829#issuecomment-780762350",
    "id": 780762350,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14829",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4MDc2MjM1MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/780762350/reactions"
    },
    "updated_at": "2021-02-17T18:36:53Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/780762350",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  }
]

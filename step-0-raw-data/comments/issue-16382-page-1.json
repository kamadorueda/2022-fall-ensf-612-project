[
  {
    "author_association": "COLLABORATOR",
    "body": "The WSMan operation rely on PowerShell being able to load `libpsrpclient` and then subsequently `libmi` in the `pwsh` directory. This has gotten harder over time as `libmi.so` is reliant on OpenSSL 1.0.2 and and failures loading a dependency will cause a failure trying to load the parent library itself. On a brand new Docker image of CentOS 7 here are some of the details I can find\r\n\r\n```\r\n[root@7dc31d837336 /]# ldd /opt/microsoft/powershell/7/libpsrpclient.so\r\nldd: warning: you do not have execution permission for `/opt/microsoft/powershell/7/libpsrpclient.so'\r\n        linux-vdso.so.1 =>  (0x00007ffc279de000)\r\n        libmi.so => /opt/microsoft/powershell/7/libmi.so (0x00007f0cc6092000)\r\n        libpthread.so.0 => /lib64/libpthread.so.0 (0x00007f0cc5bd9000)\r\n        libc.so.6 => /lib64/libc.so.6 (0x00007f0cc580b000)\r\n        libdl.so.2 => /lib64/libdl.so.2 (0x00007f0cc5607000)\r\n        libpam.so.0 => /lib64/libpam.so.0 (0x00007f0cc53f8000)\r\n        libssl.so.1.0.0 => /opt/microsoft/powershell/7/libssl.so.1.0.0 (0x00007f0cc5186000)\r\n        libcrypto.so.1.0.0 => /opt/microsoft/powershell/7/libcrypto.so.1.0.0 (0x00007f0cc4d23000)\r\n        /lib64/ld-linux-x86-64.so.2 (0x00007f0cc6045000)\r\n        libaudit.so.1 => /lib64/libaudit.so.1 (0x00007f0cc4afa000)\r\n        libgssapi_krb5.so.2 => /lib64/libgssapi_krb5.so.2 (0x00007f0cc48ad000)\r\n        libkrb5.so.3 => /lib64/libkrb5.so.3 (0x00007f0cc45c4000)\r\n        libcom_err.so.2 => /lib64/libcom_err.so.2 (0x00007f0cc43c0000)\r\n        libk5crypto.so.3 => /lib64/libk5crypto.so.3 (0x00007f0cc418d000)\r\n        libz.so.1 => /lib64/libz.so.1 (0x00007f0cc3f77000)\r\n        libcap-ng.so.0 => /lib64/libcap-ng.so.0 (0x00007f0cc3d71000)\r\n        libkrb5support.so.0 => /lib64/libkrb5support.so.0 (0x00007f0cc3b61000)\r\n        libkeyutils.so.1 => /lib64/libkeyutils.so.1 (0x00007f0cc395d000)\r\n        libresolv.so.2 => /lib64/libresolv.so.2 (0x00007f0cc3743000)\r\n        libselinux.so.1 => /lib64/libselinux.so.1 (0x00007f0cc351c000)\r\n        libpcre.so.1 => /lib64/libpcre.so.1 (0x00007f0cc32ba000)\r\n\r\n[root@7dc31d837336 /]# ldd /opt/microsoft/powershell/7/libmi.so\r\nldd: warning: you do not have execution permission for `/opt/microsoft/powershell/7/libmi.so'\r\n        linux-vdso.so.1 =>  (0x00007fff8bbdd000)\r\n        libpthread.so.0 => /lib64/libpthread.so.0 (0x00007f3ec871f000)\r\n        libdl.so.2 => /lib64/libdl.so.2 (0x00007f3ec851b000)\r\n        libpam.so.0 => /lib64/libpam.so.0 (0x00007f3ec830c000)\r\n        libssl.so.1.0.0 => /opt/microsoft/powershell/7/libssl.so.1.0.0 (0x00007f3ec809a000)\r\n        libcrypto.so.1.0.0 => /opt/microsoft/powershell/7/libcrypto.so.1.0.0 (0x00007f3ec7c37000)\r\n        libc.so.6 => /lib64/libc.so.6 (0x00007f3ec7869000)\r\n        /lib64/ld-linux-x86-64.so.2 (0x00007f3ec893b000)\r\n        libaudit.so.1 => /lib64/libaudit.so.1 (0x00007f3ec7640000)\r\n        libgssapi_krb5.so.2 => /lib64/libgssapi_krb5.so.2 (0x00007f3ec73f3000)\r\n        libkrb5.so.3 => /lib64/libkrb5.so.3 (0x00007f3ec710a000)\r\n        libcom_err.so.2 => /lib64/libcom_err.so.2 (0x00007f3ec6f06000)\r\n        libk5crypto.so.3 => /lib64/libk5crypto.so.3 (0x00007f3ec6cd3000)\r\n        libz.so.1 => /lib64/libz.so.1 (0x00007f3ec6abd000)\r\n        libcap-ng.so.0 => /lib64/libcap-ng.so.0 (0x00007f3ec68b7000)\r\n        libkrb5support.so.0 => /lib64/libkrb5support.so.0 (0x00007f3ec66a7000)\r\n        libkeyutils.so.1 => /lib64/libkeyutils.so.1 (0x00007f3ec64a3000)\r\n        libresolv.so.2 => /lib64/libresolv.so.2 (0x00007f3ec6289000)\r\n        libselinux.so.1 => /lib64/libselinux.so.1 (0x00007f3ec6062000)\r\n        libpcre.so.1 => /lib64/libpcre.so.1 (0x00007f3ec5e00000)\r\n\r\n[root@7dc31d837336 /]# ls -al /opt/microsoft/powershell/7/libssl.so.1.0.0\r\nlrwxrwxrwx. 1 root root 19 Nov  8 22:07 /opt/microsoft/powershell/7/libssl.so.1.0.0 -> /lib64/libssl.so.10\r\n\r\n[root@7dc31d837336 /]# ls -al /opt/microsoft/powershell/7/libcrypto.so.1.0.0\r\nlrwxrwxrwx. 1 root root 22 Nov  8 22:07 /opt/microsoft/powershell/7/libcrypto.so.1.0.0 -> /lib64/libcrypto.so.10\r\n```\r\n\r\nIn particular I can see that `libcrypto` and `libssl` are pointed to the OpenSSL 1.0.2 install of OpenSSL on the system. This is usually the cause of a failure when trying to load `libmi` but your `ldd` outputs might show another problem.\r\n\r\nYou might be interested in my [PSWSMan](https://www.powershellgallery.com/packages/PSWSMan/2.2.1) module which ships with a patched copy of `libpsrpclient` and `libmi` that fixes a few problems and also adds support for OpenSSL 1.1.x and 3.x removing the need for the older OpenSSL version altogether. This is not supported by Microsoft or the PowerShell team but in the current state of OMI I would argue neither is the one shipped by PowerShell. Ultimately it's up to you to decide what you are happy to use. You can find more details of my fork at https://github.com/jborean93/omi.\n\n<blockquote><img src=\"https://opengraph.githubassets.com/bd7d507a6ec8b4ba8461f2fc65b2d90216323600125143a3c6d375acf634e22c/jborean93/omi\" width=\"48\" align=\"right\"><div><img src=\"https://github.githubassets.com/favicons/favicon.svg\" height=\"14\"> GitHub</div><div><strong><a href=\"https://github.com/jborean93/omi\">GitHub - jborean93/omi: Open Management Infrastructure</a></strong></div><div>Open Management Infrastructure. Contribute to jborean93/omi development by creating an account on GitHub.</div></blockquote>",
    "created_at": "2021-11-08T22:13:21Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16382#issuecomment-963622504",
    "id": 963622504,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16382",
    "node_id": "IC_kwDOAvT7bc45b7Zo",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/963622504/reactions"
    },
    "updated_at": "2021-11-08T22:13:24Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/963622504",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8462645?v=4",
      "events_url": "https://api.github.com/users/jborean93/events{/privacy}",
      "followers_url": "https://api.github.com/users/jborean93/followers",
      "following_url": "https://api.github.com/users/jborean93/following{/other_user}",
      "gists_url": "https://api.github.com/users/jborean93/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jborean93",
      "id": 8462645,
      "login": "jborean93",
      "node_id": "MDQ6VXNlcjg0NjI2NDU=",
      "organizations_url": "https://api.github.com/users/jborean93/orgs",
      "received_events_url": "https://api.github.com/users/jborean93/received_events",
      "repos_url": "https://api.github.com/users/jborean93/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jborean93/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jborean93/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jborean93"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@WG-Remoting\r\nRemoting working group confirms that WinRM/OMI remoting on non-Windows platforms is no longer supported since OMI is no longer supported (#15310).  Our hope is that support will be picked up by community members using the new custom remoting connections (#16923).",
    "created_at": "2022-04-07T18:01:15Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16382#issuecomment-1092042926",
    "id": 1092042926,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16382",
    "node_id": "IC_kwDOAvT7bc5BF0Cu",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1092042926/reactions"
    },
    "updated_at": "2022-04-07T18:01:15Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1092042926",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/14019529?v=4",
      "events_url": "https://api.github.com/users/PaulHigin/events{/privacy}",
      "followers_url": "https://api.github.com/users/PaulHigin/followers",
      "following_url": "https://api.github.com/users/PaulHigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulHigin/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/PaulHigin",
      "id": 14019529,
      "login": "PaulHigin",
      "node_id": "MDQ6VXNlcjE0MDE5NTI5",
      "organizations_url": "https://api.github.com/users/PaulHigin/orgs",
      "received_events_url": "https://api.github.com/users/PaulHigin/received_events",
      "repos_url": "https://api.github.com/users/PaulHigin/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/PaulHigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulHigin/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/PaulHigin"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Closing and resolving as answered.",
    "created_at": "2022-04-07T18:01:46Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16382#issuecomment-1092044146",
    "id": 1092044146,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16382",
    "node_id": "IC_kwDOAvT7bc5BF0Vy",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1092044146/reactions"
    },
    "updated_at": "2022-04-07T18:01:46Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1092044146",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/14019529?v=4",
      "events_url": "https://api.github.com/users/PaulHigin/events{/privacy}",
      "followers_url": "https://api.github.com/users/PaulHigin/followers",
      "following_url": "https://api.github.com/users/PaulHigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulHigin/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/PaulHigin",
      "id": 14019529,
      "login": "PaulHigin",
      "node_id": "MDQ6VXNlcjE0MDE5NTI5",
      "organizations_url": "https://api.github.com/users/PaulHigin/orgs",
      "received_events_url": "https://api.github.com/users/PaulHigin/received_events",
      "repos_url": "https://api.github.com/users/PaulHigin/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/PaulHigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulHigin/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/PaulHigin"
    }
  }
]

[
  {
    "author_association": "NONE",
    "body": "Seems to be a duplicate to https://github.com/PowerShell/PowerShell/issues/12240",
    "created_at": "2020-04-29T11:32:59Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12518#issuecomment-621144652",
    "id": 621144652,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12518",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMTE0NDY1Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/621144652/reactions"
    },
    "updated_at": "2020-04-29T11:32:59Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/621144652",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/34173158?v=4",
      "events_url": "https://api.github.com/users/Schwanowski/events{/privacy}",
      "followers_url": "https://api.github.com/users/Schwanowski/followers",
      "following_url": "https://api.github.com/users/Schwanowski/following{/other_user}",
      "gists_url": "https://api.github.com/users/Schwanowski/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Schwanowski",
      "id": 34173158,
      "login": "Schwanowski",
      "node_id": "MDQ6VXNlcjM0MTczMTU4",
      "organizations_url": "https://api.github.com/users/Schwanowski/orgs",
      "received_events_url": "https://api.github.com/users/Schwanowski/received_events",
      "repos_url": "https://api.github.com/users/Schwanowski/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Schwanowski/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Schwanowski/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Schwanowski"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "You can reference items from the main runspace with `$using:varName`; `$global:` will not work as far as I'm aware. However, a majority of collections are not threadsafe, and you will encounter what can only be described as 'undefined behaviour' when trying to use them from more than one thread/runspace simultaneously as you are here.\r\n\r\nYou can prepare a hashtable for use in threaded operations using the static `Synchronize` method, like so:\r\n```ps1\r\n$results = [hashtable]::Synchronized(@{ })\r\n```\r\n\r\nWhich you can then safely use via `$using:results` in Foreach-Object -Parallel. There are other, more sophisticated collection types that can be used in a multithreaded context, but that's probably closest to what's familiar. Multithreading something correctly isn't easy, and the complexity of some of the threadsafe types reflects that.\r\n\r\nDo note that `$using:var` doesn't permit assignment, or (I think?) indexing operations... so you may need to do something like `$myResults = $using:Results` at the start of the parallel scriptblock, and then reference the hashtable with that when adding entries.",
    "created_at": "2020-04-29T12:33:51Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12518#issuecomment-621173621",
    "id": 621173621,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12518",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMTE3MzYyMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/621173621/reactions"
    },
    "updated_at": "2020-04-29T12:34:59Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/621173621",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/32407840?v=4",
      "events_url": "https://api.github.com/users/vexx32/events{/privacy}",
      "followers_url": "https://api.github.com/users/vexx32/followers",
      "following_url": "https://api.github.com/users/vexx32/following{/other_user}",
      "gists_url": "https://api.github.com/users/vexx32/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vexx32",
      "id": 32407840,
      "login": "vexx32",
      "node_id": "MDQ6VXNlcjMyNDA3ODQw",
      "organizations_url": "https://api.github.com/users/vexx32/orgs",
      "received_events_url": "https://api.github.com/users/vexx32/received_events",
      "repos_url": "https://api.github.com/users/vexx32/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vexx32/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vexx32/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vexx32"
    }
  },
  {
    "author_association": "NONE",
    "body": "Thanks already for your response, I will try this later today.\r\n\r\nBut one question: I have read some time ago that I should use System.Collections.Generic.Dictionary instead of an hashtable is this true? Can I use a dictonary instead of a hashtable or is this not possible in this case?\r\n\r\nThanks,\r\n\r\nAlex",
    "created_at": "2020-04-29T12:50:58Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12518#issuecomment-621183055",
    "id": 621183055,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12518",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMTE4MzA1NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/621183055/reactions"
    },
    "updated_at": "2020-04-29T12:50:58Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/621183055",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/34173158?v=4",
      "events_url": "https://api.github.com/users/Schwanowski/events{/privacy}",
      "followers_url": "https://api.github.com/users/Schwanowski/followers",
      "following_url": "https://api.github.com/users/Schwanowski/following{/other_user}",
      "gists_url": "https://api.github.com/users/Schwanowski/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Schwanowski",
      "id": 34173158,
      "login": "Schwanowski",
      "node_id": "MDQ6VXNlcjM0MTczMTU4",
      "organizations_url": "https://api.github.com/users/Schwanowski/orgs",
      "received_events_url": "https://api.github.com/users/Schwanowski/received_events",
      "repos_url": "https://api.github.com/users/Schwanowski/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Schwanowski/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Schwanowski/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Schwanowski"
    }
  },
  {
    "author_association": "NONE",
    "body": "I have tested it with \r\n$myResults = $using:Results\r\nand it works all fine\r\n\r\nThanks",
    "created_at": "2020-04-29T13:28:48Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12518#issuecomment-621206392",
    "id": 621206392,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12518",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMTIwNjM5Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/621206392/reactions"
    },
    "updated_at": "2020-04-29T13:29:06Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/621206392",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/34173158?v=4",
      "events_url": "https://api.github.com/users/Schwanowski/events{/privacy}",
      "followers_url": "https://api.github.com/users/Schwanowski/followers",
      "following_url": "https://api.github.com/users/Schwanowski/following{/other_user}",
      "gists_url": "https://api.github.com/users/Schwanowski/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Schwanowski",
      "id": 34173158,
      "login": "Schwanowski",
      "node_id": "MDQ6VXNlcjM0MTczMTU4",
      "organizations_url": "https://api.github.com/users/Schwanowski/orgs",
      "received_events_url": "https://api.github.com/users/Schwanowski/received_events",
      "repos_url": "https://api.github.com/users/Schwanowski/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Schwanowski/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Schwanowski/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Schwanowski"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "You can use a Dictionary, sure, but you can't use _that_ kind of dictionary due to the aforementioned threading issues. It also doesn't have a `Synchronized()` method like Hashtable does.\r\n\r\nIf you want a type-safe _and_ thread-safe dictionary, you'll need to look to [`System.Collections.Concurrent.ConcurrentDictionary`](https://docs.microsoft.com/en-us/dotnet/api/system.collections.concurrent.concurrentdictionary-2?view=netcore-3.1).\r\n\r\nAs you'll see if you look through some of its methods, it has to be handled a good bit differently, with things like `TryAdd()` which _can_ fail and may need to be retried. It's a bit more complicated, but probably a lot more efficient to work with.",
    "created_at": "2020-04-29T14:38:24Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12518#issuecomment-621253808",
    "id": 621253808,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12518",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMTI1MzgwOA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/621253808/reactions"
    },
    "updated_at": "2020-04-29T14:40:11Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/621253808",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/32407840?v=4",
      "events_url": "https://api.github.com/users/vexx32/events{/privacy}",
      "followers_url": "https://api.github.com/users/vexx32/followers",
      "following_url": "https://api.github.com/users/vexx32/following{/other_user}",
      "gists_url": "https://api.github.com/users/vexx32/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vexx32",
      "id": 32407840,
      "login": "vexx32",
      "node_id": "MDQ6VXNlcjMyNDA3ODQw",
      "organizations_url": "https://api.github.com/users/vexx32/orgs",
      "received_events_url": "https://api.github.com/users/vexx32/received_events",
      "repos_url": "https://api.github.com/users/vexx32/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vexx32/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vexx32/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vexx32"
    }
  },
  {
    "author_association": "NONE",
    "body": "Thank you so much for your support",
    "created_at": "2020-04-30T07:39:47Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12518#issuecomment-621668694",
    "id": 621668694,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12518",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMTY2ODY5NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 1,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/621668694/reactions"
    },
    "updated_at": "2020-04-30T07:39:47Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/621668694",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/34173158?v=4",
      "events_url": "https://api.github.com/users/Schwanowski/events{/privacy}",
      "followers_url": "https://api.github.com/users/Schwanowski/followers",
      "following_url": "https://api.github.com/users/Schwanowski/following{/other_user}",
      "gists_url": "https://api.github.com/users/Schwanowski/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Schwanowski",
      "id": 34173158,
      "login": "Schwanowski",
      "node_id": "MDQ6VXNlcjM0MTczMTU4",
      "organizations_url": "https://api.github.com/users/Schwanowski/orgs",
      "received_events_url": "https://api.github.com/users/Schwanowski/received_events",
      "repos_url": "https://api.github.com/users/Schwanowski/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Schwanowski/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Schwanowski/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Schwanowski"
    }
  }
]

[
  {
    "author_association": "MEMBER",
    "body": "@rockerinthelocker Can you please provide a simpler repro? That would be very helpful. Or, please add instructions about how to set up to reproduce with the `MaxMind` assemblies.\r\n\r\nWe started to use dotnet core 2.1 from preview.3, so there is a possibility that this is due to changes in .NET Core. /cc @adityapatwardhan ",
    "created_at": "2018-07-20T22:12:08Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7326#issuecomment-406739743",
    "id": 406739743,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7326",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNjczOTc0Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/406739743/reactions"
    },
    "updated_at": "2018-07-20T22:14:29Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/406739743",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "I can load an assembly from local folder without problem. I guess the issue is only with MaxMind assemblies.",
    "created_at": "2018-07-22T06:57:38Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7326#issuecomment-406845655",
    "id": 406845655,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7326",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNjg0NTY1NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/406845655/reactions"
    },
    "updated_at": "2018-07-22T06:57:38Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/406845655",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "@daxian-dbw @adityapatwardhan @iSazonov\r\nThe setup is quite simple and takes just a couple of minutes.\r\n\r\n1) Open a command prompt, create folder C:\\GeoIP, and cd to it.\r\n\r\n2) Install the MaxMind GeoIP2 package (available at https://www.nuget.org/packages/MaxMind.GeoIP2/) via nuget.exe (https://www.nuget.org/downloads) like so:\r\n\r\n```\r\nnuget install MaxMind.GeoIP2 -Version 3.0.0\r\n```\r\n\r\n3) For testing purposes, the .NET flavor (net45, netstandard 2.0, etc.) of the DLLs included in the packages does not matter so simply grab\r\n\r\n```\r\nC:\\GeoIP\\MaxMind.GeoIP2.3.0.0\\lib\\netstandard2.0\\MaxMind.GeoIP2.dll\r\nC:\\GeoIP\\MaxMind.Db.2.4.0\\lib\\netstandard2.0\\MaxMind.Db.dll\r\nC:\\GeoIP\\Newtonsoft.Json.11.0.2\\lib\\netstandard2.0\\Newtonsoft.Json.dll\r\n```\r\n\r\nand copy to C:\\GeoIP.\r\n\r\n4) Download the GeoLite2 ASN database from http://geolite.maxmind.com/download/geoip/database/GeoLite2-ASN.tar.gz and unpack 'GeoLite2-ASN.mmdb' included in the archive to C:\\GeoIP.\r\n\r\nNow, there should be\r\n\r\n```\r\nGeoLite2-ASN.mmdb\r\nMaxMind.Db.dll\r\nMaxMind.GeoIP2.dll\r\nNewtonsoft.Json.dll\r\n```\r\n\r\nin C:\\GeoIP and all is set.\r\n\r\n5) Finally, execute\r\n\r\n```\r\n$GeoIpDbPath = 'C:\\GeoIP\\'\r\n$GeoIpLibrary = $GeoIpDbPath + 'MaxMind.GeoIP2.dll'\r\n$GeoIpDbLibrary = $GeoIpDbPath + 'MaxMind.Db.dll'\r\n$GeoIpNewtonJson = $GeoIpDbPath + 'Newtonsoft.Json.dll'\r\n$GeoIpAsnDb = $GeoIpDbPath + 'GeoLite2-ASN.mmdb'\r\n\r\n[System.Reflection.Assembly]::LoadFile($GeoIpLibrary)\r\n[System.Reflection.Assembly]::LoadFile($GeoIpDbLibrary)\r\n[System.Reflection.Assembly]::LoadFile($GeoIpNewtonJson)\r\n\r\n$asnReader = [MaxMind.GeoIP2.DatabaseReader]::new($GeoIpAsnDb)\r\n```\r\n\r\n\r\nThank you!\r\n",
    "created_at": "2018-07-22T17:32:26Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7326#issuecomment-406883555",
    "id": 406883555,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7326",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNjg4MzU1NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/406883555/reactions"
    },
    "updated_at": "2018-07-22T17:32:26Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/406883555",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/30327597?v=4",
      "events_url": "https://api.github.com/users/rockerinthelocker/events{/privacy}",
      "followers_url": "https://api.github.com/users/rockerinthelocker/followers",
      "following_url": "https://api.github.com/users/rockerinthelocker/following{/other_user}",
      "gists_url": "https://api.github.com/users/rockerinthelocker/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rockerinthelocker",
      "id": 30327597,
      "login": "rockerinthelocker",
      "node_id": "MDQ6VXNlcjMwMzI3NTk3",
      "organizations_url": "https://api.github.com/users/rockerinthelocker/orgs",
      "received_events_url": "https://api.github.com/users/rockerinthelocker/received_events",
      "repos_url": "https://api.github.com/users/rockerinthelocker/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rockerinthelocker/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rockerinthelocker/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rockerinthelocker"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "I can repo. I got the error after `[MaxMind.GeoIP2.DatabaseReader]::new` (without parameter and brackets):\r\n```powershell\r\n$error[0].Exception | fl -Force\r\n\r\n\r\nErrorRecord                 : The following exception occurred while retrieving member \"New\": \"Could not load file or\r\n                              assembly 'MaxMind.Db, Version=2.0.0.0, Culture=neutral,\r\n                              PublicKeyToken=66afa4cc5ae853ac'. The system cannot find the file specified.\"\r\nWasThrownFromThrowStatement : False\r\nMessage                     : The following exception occurred while retrieving member \"New\": \"Could not load file or\r\n                              assembly 'MaxMind.Db, Version=2.0.0.0, Culture=neutral,\r\n                              PublicKeyToken=66afa4cc5ae853ac'. The system cannot find the file specified.\"\r\nData                        : {System.Management.Automation.Interpreter.InterpretedFrameInfo}\r\nInnerException              : System.IO.FileNotFoundException: Could not load file or assembly 'MaxMind.Db,\r\n                              Version=2.0.0.0, Culture=neutral, PublicKeyToken=66afa4cc5ae853ac'. The system cannot\r\n                              find the file specified.\r\n                              File name: 'MaxMind.Db, Version=2.0.0.0, Culture=neutral,\r\n                              PublicKeyToken=66afa4cc5ae853ac' ---> System.IO.FileNotFoundException: Could not load\r\n                              the specified file.\r\n                              File name: 'MaxMind.Db'\r\n                                 at System.Runtime.Loader.AssemblyLoadContext.ResolveUsingEvent(AssemblyName\r\n                              assemblyName)\r\n                                 at System.Runtime.Loader.AssemblyLoadContext.ResolveUsingResolvingEvent(IntPtr\r\n                              gchManagedAssemblyLoadContext, AssemblyName assemblyName)\r\n                                 at System.Signature.GetSignature(Void* pCorSig, Int32 cCorSig,\r\n                              RuntimeFieldHandleInternal fieldHandle, IRuntimeMethodInfo methodHandle, RuntimeType\r\n                              declaringType)\r\n                                 at System.Reflection.RuntimeConstructorInfo.get_Signature()\r\n                                 at System.Reflection.RuntimeConstructorInfo.GetParametersNoCopy()\r\n                                 at System.Reflection.RuntimeConstructorInfo.GetParameters()\r\n                                 at System.Management.Automation.MethodInformation..ctor(MethodBase method, Int32\r\n                              parametersToIgnore) in C:\\Users\\sie\\Documents\\GitHub\\iSazonov\\PowerShell\\src\\System.Manag\r\n                              ement.Automation\\engine\\CoreAdapter.cs:line 1876\r\n                                 at System.Management.Automation.DotNetAdapter.GetMethodInformationArray(MethodBase[]\r\n                              methods) in C:\\Users\\sie\\Documents\\GitHub\\iSazonov\\PowerShell\\src\\System.Management.Autom\r\n                              ation\\engine\\CoreAdapter.cs:line 3869\r\n                                 at System.Management.Automation.DotNetAdapter.MethodCacheEntry..ctor(MethodBase[]\r\n                              methods) in C:\\Users\\sie\\Documents\\GitHub\\iSazonov\\PowerShell\\src\\System.Management.Autom\r\n                              ation\\engine\\CoreAdapter.cs:line 2347\r\n                                 at System.Management.Automation.DotNetAdapter.PopulateMethodReflectionTable(Type\r\n                              type, CacheTable typeMethods, BindingFlags bindingFlags) in C:\\Users\\sie\\Documents\\GitHub\r\n                              \\iSazonov\\PowerShell\\src\\System.Management.Automation\\engine\\CoreAdapter.cs:line 2882\r\n                                 at System.Management.Automation.DotNetAdapter.GetStaticMethodReflectionTable(Type\r\n                              type) in C:\\Users\\sie\\Documents\\GitHub\\iSazonov\\PowerShell\\src\\System.Management.Automati\r\n                              on\\engine\\CoreAdapter.cs:line 3179\r\n                                 at System.Management.Automation.DotNetAdapter.GetDotNetMethod[T](Object obj, String\r\n                              methodName) in C:\\Users\\sie\\Documents\\GitHub\\iSazonov\\PowerShell\\src\\System.Management.Au\r\n                              tomation\\engine\\CoreAdapter.cs:line 3353\r\n                                 at System.Management.Automation.DotNetAdapter.GetMember[T](Object obj, String\r\n                              memberName) in C:\\Users\\sie\\Documents\\GitHub\\iSazonov\\PowerShell\\src\\System.Management.Au\r\n                              tomation\\engine\\CoreAdapter.cs:line 3542\r\n                                 at System.Management.Automation.Adapter.BaseGetMember[T](Object obj, String\r\n                              memberName) in C:\\Users\\sie\\Documents\\GitHub\\iSazonov\\PowerShell\\src\\System.Management.Au\r\n                              tomation\\engine\\CoreAdapter.cs:line 375\r\n\r\n\r\nTargetSite                  : T BaseGetMember[T](System.Object, System.String)\r\nStackTrace                  :    at System.Management.Automation.Adapter.BaseGetMember[T](Object obj, String\r\n                              memberName) in C:\\Users\\sie\\Documents\\GitHub\\iSazonov\\PowerShell\\src\\System.Management.Au\r\n                              tomation\\engine\\CoreAdapter.cs:line 380\r\n                                 at System.Management.Automation.PSObject.GetStaticCLRMember(Object obj, String\r\n                              methodName) in C:\\Users\\sie\\Documents\\GitHub\\iSazonov\\PowerShell\\src\\System.Management.Au\r\n                              tomation\\engine\\MshObject.cs:line 1014\r\n                                 at System.Management.Automation.Language.PSGetMemberBinder.GetPSMemberInfo(DynamicMeta\r\n                              Object target, BindingRestrictions& restrictions, Boolean& canOptimize, Type&\r\n                              aliasConversionType, MemberTypes memberTypeToOperateOn, HashSet`1 aliases, List`1\r\n                              aliasRestrictions) in C:\\Users\\sie\\Documents\\GitHub\\iSazonov\\PowerShell\\src\\System.Manage\r\n                              ment.Automation\\engine\\runtime\\Binding\\Binders.cs:line 5446\r\n                                 at System.Management.Automation.Language.PSGetMemberBinder.FallbackGetMember(DynamicMe\r\n                              taObject target, DynamicMetaObject errorSuggestion) in C:\\Users\\sie\\Documents\\GitHub\\iSaz\r\n                              onov\\PowerShell\\src\\System.Management.Automation\\engine\\runtime\\Binding\\Binders.cs:line\r\n                              5055\r\n                                 at System.Dynamic.DynamicMetaObject.BindGetMember(GetMemberBinder binder)\r\n                                 at System.Dynamic.GetMemberBinder.Bind(DynamicMetaObject target, DynamicMetaObject[]\r\n                              args)\r\n                                 at System.Dynamic.DynamicMetaObjectBinder.Bind(Object[] args, ReadOnlyCollection`1\r\n                              parameters, LabelTarget returnLabel)\r\n                                 at System.Runtime.CompilerServices.CallSiteBinder.BindCore[T](CallSite`1 site,\r\n                              Object[] args)\r\n                                 at System.Dynamic.UpdateDelegates.UpdateAndExecute1[T0,TRet](CallSite site, T0 arg0)\r\n                                 at System.Management.Automation.Interpreter.DynamicInstruction`2.Run(InterpretedFrame\r\n                              frame) in C:\\Users\\sie\\Documents\\GitHub\\iSazonov\\PowerShell\\src\\System.Management.Automat\r\n                              ion\\engine\\interpreter\\DynamicInstructions.Generated.cs:line 139\r\n                                 at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(Interp\r\n                              retedFrame frame) in C:\\Users\\sie\\Documents\\GitHub\\iSazonov\\PowerShell\\src\\System.Managem\r\n                              ent.Automation\\engine\\interpreter\\ControlFlowInstructions.cs:line 356\r\nHelpLink                    :\r\nSource                      : System.Management.Automation\r\nHResult                     : -2146233087\r\n\r\n```",
    "created_at": "2018-07-23T04:34:04Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7326#issuecomment-406936333",
    "id": 406936333,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7326",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNjkzNjMzMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/406936333/reactions"
    },
    "updated_at": "2018-07-23T04:34:04Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/406936333",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "@iSazonov , Thanks for taking the time and providing further details!\r\n\r\n@daxian-dbw , It seems you're right and it's a .NET Core 2.1 issue.\r\n\r\n@coolcsh  , Looks like something related to loading non-GAC DLLs is broken in .NET Core 2.1. Maybe you can get someone looking into this? Thank you!\r\n",
    "created_at": "2018-07-23T18:05:12Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7326#issuecomment-407148894",
    "id": 407148894,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7326",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNzE0ODg5NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/407148894/reactions"
    },
    "updated_at": "2018-07-23T18:05:12Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/407148894",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/30327597?v=4",
      "events_url": "https://api.github.com/users/rockerinthelocker/events{/privacy}",
      "followers_url": "https://api.github.com/users/rockerinthelocker/followers",
      "following_url": "https://api.github.com/users/rockerinthelocker/following{/other_user}",
      "gists_url": "https://api.github.com/users/rockerinthelocker/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rockerinthelocker",
      "id": 30327597,
      "login": "rockerinthelocker",
      "node_id": "MDQ6VXNlcjMwMzI3NTk3",
      "organizations_url": "https://api.github.com/users/rockerinthelocker/orgs",
      "received_events_url": "https://api.github.com/users/rockerinthelocker/received_events",
      "repos_url": "https://api.github.com/users/rockerinthelocker/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rockerinthelocker/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rockerinthelocker/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rockerinthelocker"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@rockerinthelocker can you open an issue in the coreclr repo?  Will get more immediate attention I think.",
    "created_at": "2018-07-26T19:04:47Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7326#issuecomment-408202222",
    "id": 408202222,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7326",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwODIwMjIyMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/408202222/reactions"
    },
    "updated_at": "2018-07-26T19:04:47Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/408202222",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "NONE",
    "body": "To make this work simply change the `[System.Reflection.Assembly]::LoadFile` to `[System.Reflection.Assembly]::LoadFrom`. With that your repro works on the 6.1.0-preview.4.\r\n\r\nThe reason this fails with `LoadFile` is that `LoadFile` loads the specified assembly into its own `AssemblyLoadContext` (ALC) and thus the 3 files are loaded into different ALCs and don't \"see each other\". Unlike on desktop, the .NET Core runtime will not look for assemblies \"next-to\" the one it's currently using, so the one loaded by `LoadFile` also doesn't see the files on disk right next to it.\r\n`LoadFrom` is different, it loads the assemblies into the Default ALC so basically to the same set as everything else (namely PS in this case). It also implements a file based lookup, so it will load files \"next to\". The downside of this approach is that you can't load the same assembly twice into the Default ALC. So if there's a version collision between PS and your \"plugin\" (GeoIP), then it won't work.\r\n\r\nWith 6.1.0-preview.4 PS happens to use the same version of Newtonsoft.Json as the GeoIP v3.0.0, so it works. I also tried this on 6.0.3 PS and there it fails because PS uses older version of Newtonsoft.Json.\r\n\r\n@daxian-dbw I don't see how this behavior changed in .NET Core. The above behavior of `LoadFile` versus `LoadFrom` is the same in .NET Core 2.0 and 2.1. If you do have a version where this used to work and now it doesn't I would be very interesting in it.\r\n\r\nWe are working on providing actually working and easy to use solution for scenarios like this for .NET Core 3. In .NET Core 2.1, it is possible to make it work, but it requires an implementation of a custom `AssemblyLoadContext`. While possible to code this up in PS, it's definitely not \"simple\".",
    "created_at": "2018-08-06T13:42:33Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7326#issuecomment-410712145",
    "id": 410712145,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7326",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMDcxMjE0NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/410712145/reactions"
    },
    "updated_at": "2018-08-06T13:42:33Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/410712145",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/10670590?v=4",
      "events_url": "https://api.github.com/users/vitek-karas/events{/privacy}",
      "followers_url": "https://api.github.com/users/vitek-karas/followers",
      "following_url": "https://api.github.com/users/vitek-karas/following{/other_user}",
      "gists_url": "https://api.github.com/users/vitek-karas/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vitek-karas",
      "id": 10670590,
      "login": "vitek-karas",
      "node_id": "MDQ6VXNlcjEwNjcwNTkw",
      "organizations_url": "https://api.github.com/users/vitek-karas/orgs",
      "received_events_url": "https://api.github.com/users/vitek-karas/received_events",
      "repos_url": "https://api.github.com/users/vitek-karas/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vitek-karas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vitek-karas/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vitek-karas"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "> Unlike on desktop, the .NET Core runtime will not look for assemblies \"next-to\" the one it's currently using, so the one loaded by LoadFile also doesn't see the files on disk right next to it.\r\n\r\n`LoadFile` on desktop does not look \"next-to\" for dependencies either. The behavior of LoadFile is the same between desktop and .NET Core in this regard.",
    "created_at": "2018-08-06T14:08:50Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7326#issuecomment-410720609",
    "id": 410720609,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7326",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMDcyMDYwOQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/410720609/reactions"
    },
    "updated_at": "2018-08-06T14:08:50Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/410720609",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6668460?v=4",
      "events_url": "https://api.github.com/users/jkotas/events{/privacy}",
      "followers_url": "https://api.github.com/users/jkotas/followers",
      "following_url": "https://api.github.com/users/jkotas/following{/other_user}",
      "gists_url": "https://api.github.com/users/jkotas/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jkotas",
      "id": 6668460,
      "login": "jkotas",
      "node_id": "MDQ6VXNlcjY2Njg0NjA=",
      "organizations_url": "https://api.github.com/users/jkotas/orgs",
      "received_events_url": "https://api.github.com/users/jkotas/received_events",
      "repos_url": "https://api.github.com/users/jkotas/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jkotas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jkotas/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jkotas"
    }
  },
  {
    "author_association": "NONE",
    "body": "Thanks @jkotas, didn't know that.",
    "created_at": "2018-08-06T14:23:47Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7326#issuecomment-410725642",
    "id": 410725642,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7326",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMDcyNTY0Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/410725642/reactions"
    },
    "updated_at": "2018-08-06T14:23:47Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/410725642",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/10670590?v=4",
      "events_url": "https://api.github.com/users/vitek-karas/events{/privacy}",
      "followers_url": "https://api.github.com/users/vitek-karas/followers",
      "following_url": "https://api.github.com/users/vitek-karas/following{/other_user}",
      "gists_url": "https://api.github.com/users/vitek-karas/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vitek-karas",
      "id": 10670590,
      "login": "vitek-karas",
      "node_id": "MDQ6VXNlcjEwNjcwNTkw",
      "organizations_url": "https://api.github.com/users/vitek-karas/orgs",
      "received_events_url": "https://api.github.com/users/vitek-karas/received_events",
      "repos_url": "https://api.github.com/users/vitek-karas/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vitek-karas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vitek-karas/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vitek-karas"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@vitek-karas and @jkotas, thank you for the clarification, it's very helpful!",
    "created_at": "2018-08-06T17:44:37Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7326#issuecomment-410791594",
    "id": 410791594,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7326",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMDc5MTU5NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/410791594/reactions"
    },
    "updated_at": "2018-08-06T17:44:37Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/410791594",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "NONE",
    "body": "@vitek-karas @jkotas @daxian-dbw  , Unfortunately, using LoadFrom instead of LoadFile doesn't work either (see below).\r\n\r\n```\r\nException calling \".ctor\" with \"1\" argument(s): \"Could not load type 'System.IO.MemoryMappedFiles.MemoryMappedFileSecurity' from assembly 'System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.\"\r\nAt line:1 char:1\r\n+ $asnReader = [MaxMind.GeoIP2.DatabaseReader]::new($GeoIpAsnDb)\r\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+ CategoryInfo          : NotSpecified: (:) [], MethodInvocationException\r\n+ FullyQualifiedErrorId : TypeLoadException\r\n```\r\n\r\n",
    "created_at": "2018-08-07T20:22:00Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7326#issuecomment-411189237",
    "id": 411189237,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7326",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMTE4OTIzNw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/411189237/reactions"
    },
    "updated_at": "2018-08-07T20:22:00Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/411189237",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/30327597?v=4",
      "events_url": "https://api.github.com/users/rockerinthelocker/events{/privacy}",
      "followers_url": "https://api.github.com/users/rockerinthelocker/followers",
      "following_url": "https://api.github.com/users/rockerinthelocker/following{/other_user}",
      "gists_url": "https://api.github.com/users/rockerinthelocker/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rockerinthelocker",
      "id": 30327597,
      "login": "rockerinthelocker",
      "node_id": "MDQ6VXNlcjMwMzI3NTk3",
      "organizations_url": "https://api.github.com/users/rockerinthelocker/orgs",
      "received_events_url": "https://api.github.com/users/rockerinthelocker/received_events",
      "repos_url": "https://api.github.com/users/rockerinthelocker/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rockerinthelocker/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rockerinthelocker/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rockerinthelocker"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "> Could not load type 'System.IO.MemoryMappedFiles.MemoryMappedFileSecurity\r\n\r\nThe assembly you are trying to run is not compatible with .NET Core.\r\n\r\nThis type does not exist in .NET Core today. It is tracked by https://github.com/dotnet/corefx/issues/29546",
    "created_at": "2018-08-07T20:45:42Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7326#issuecomment-411196425",
    "id": 411196425,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7326",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMTE5NjQyNQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/411196425/reactions"
    },
    "updated_at": "2018-08-07T20:45:42Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/411196425",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6668460?v=4",
      "events_url": "https://api.github.com/users/jkotas/events{/privacy}",
      "followers_url": "https://api.github.com/users/jkotas/followers",
      "following_url": "https://api.github.com/users/jkotas/following{/other_user}",
      "gists_url": "https://api.github.com/users/jkotas/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jkotas",
      "id": 6668460,
      "login": "jkotas",
      "node_id": "MDQ6VXNlcjY2Njg0NjA=",
      "organizations_url": "https://api.github.com/users/jkotas/orgs",
      "received_events_url": "https://api.github.com/users/jkotas/received_events",
      "repos_url": "https://api.github.com/users/jkotas/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jkotas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jkotas/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jkotas"
    }
  },
  {
    "author_association": "NONE",
    "body": "@jkotas, Glad you figured that LoadFile no longer works with PowerShell v6.1.0-preview.3+.",
    "created_at": "2018-08-08T06:24:47Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7326#issuecomment-411299567",
    "id": 411299567,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7326",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMTI5OTU2Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/411299567/reactions"
    },
    "updated_at": "2018-08-08T06:24:47Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/411299567",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/30327597?v=4",
      "events_url": "https://api.github.com/users/rockerinthelocker/events{/privacy}",
      "followers_url": "https://api.github.com/users/rockerinthelocker/followers",
      "following_url": "https://api.github.com/users/rockerinthelocker/following{/other_user}",
      "gists_url": "https://api.github.com/users/rockerinthelocker/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rockerinthelocker",
      "id": 30327597,
      "login": "rockerinthelocker",
      "node_id": "MDQ6VXNlcjMwMzI3NTk3",
      "organizations_url": "https://api.github.com/users/rockerinthelocker/orgs",
      "received_events_url": "https://api.github.com/users/rockerinthelocker/received_events",
      "repos_url": "https://api.github.com/users/rockerinthelocker/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rockerinthelocker/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rockerinthelocker/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rockerinthelocker"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@rockerinthelocker This assembly could have never worked well on .NET Core properly. It is referencing types that never existed in .NET Core.",
    "created_at": "2018-08-08T08:29:19Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7326#issuecomment-411329174",
    "id": 411329174,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7326",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMTMyOTE3NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/411329174/reactions"
    },
    "updated_at": "2018-08-08T08:29:19Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/411329174",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6668460?v=4",
      "events_url": "https://api.github.com/users/jkotas/events{/privacy}",
      "followers_url": "https://api.github.com/users/jkotas/followers",
      "following_url": "https://api.github.com/users/jkotas/following{/other_user}",
      "gists_url": "https://api.github.com/users/jkotas/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jkotas",
      "id": 6668460,
      "login": "jkotas",
      "node_id": "MDQ6VXNlcjY2Njg0NjA=",
      "organizations_url": "https://api.github.com/users/jkotas/orgs",
      "received_events_url": "https://api.github.com/users/jkotas/received_events",
      "repos_url": "https://api.github.com/users/jkotas/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jkotas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jkotas/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jkotas"
    }
  },
  {
    "author_association": "NONE",
    "body": "@jkotas , Not sure what assembly you're referring to, but the MaxMind GeoIP assemblies work just fine with PowerShell v6.1.0-preview.2 and previous PowerShell Core versions. Apparently, some breaking change was made in PowerShell v6.1.0-preview.3 or .NET Core 2.1; and it would be great if you guys figure out so existing PowerShell scripts continue to work as expected before PowerShell Core 6.1 gets released.",
    "created_at": "2018-08-08T18:04:21Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7326#issuecomment-411498581",
    "id": 411498581,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7326",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMTQ5ODU4MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/411498581/reactions"
    },
    "updated_at": "2018-08-08T18:04:21Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/411498581",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/30327597?v=4",
      "events_url": "https://api.github.com/users/rockerinthelocker/events{/privacy}",
      "followers_url": "https://api.github.com/users/rockerinthelocker/followers",
      "following_url": "https://api.github.com/users/rockerinthelocker/following{/other_user}",
      "gists_url": "https://api.github.com/users/rockerinthelocker/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rockerinthelocker",
      "id": 30327597,
      "login": "rockerinthelocker",
      "node_id": "MDQ6VXNlcjMwMzI3NTk3",
      "organizations_url": "https://api.github.com/users/rockerinthelocker/orgs",
      "received_events_url": "https://api.github.com/users/rockerinthelocker/received_events",
      "repos_url": "https://api.github.com/users/rockerinthelocker/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rockerinthelocker/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rockerinthelocker/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rockerinthelocker"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@rockerinthelocker I have tried the steps in https://github.com/PowerShell/PowerShell/issues/7326#issuecomment-406883555 to reproduce this. It works fine for me (w/ LoadFile replace with LoadFrom):\r\n\r\n![image](https://user-images.githubusercontent.com/6668460/43857116-3e547d34-9aff-11e8-8931-94447df24d43.png)\r\n",
    "created_at": "2018-08-08T18:38:19Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7326#issuecomment-411509122",
    "id": 411509122,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7326",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMTUwOTEyMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/411509122/reactions"
    },
    "updated_at": "2018-08-08T18:38:19Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/411509122",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6668460?v=4",
      "events_url": "https://api.github.com/users/jkotas/events{/privacy}",
      "followers_url": "https://api.github.com/users/jkotas/followers",
      "following_url": "https://api.github.com/users/jkotas/following{/other_user}",
      "gists_url": "https://api.github.com/users/jkotas/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jkotas",
      "id": 6668460,
      "login": "jkotas",
      "node_id": "MDQ6VXNlcjY2Njg0NjA=",
      "organizations_url": "https://api.github.com/users/jkotas/orgs",
      "received_events_url": "https://api.github.com/users/jkotas/received_events",
      "repos_url": "https://api.github.com/users/jkotas/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jkotas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jkotas/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jkotas"
    }
  },
  {
    "author_association": "NONE",
    "body": "@jkotas , Thank you for taking the time! It's indeed strange, because the above throws here (see https://github.com/dotnet/coreclr/issues/19292#issuecomment-411633010). Thank you!",
    "created_at": "2018-08-09T04:31:07Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7326#issuecomment-411633217",
    "id": 411633217,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7326",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMTYzMzIxNw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/411633217/reactions"
    },
    "updated_at": "2018-08-09T04:32:58Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/411633217",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/30327597?v=4",
      "events_url": "https://api.github.com/users/rockerinthelocker/events{/privacy}",
      "followers_url": "https://api.github.com/users/rockerinthelocker/followers",
      "following_url": "https://api.github.com/users/rockerinthelocker/following{/other_user}",
      "gists_url": "https://api.github.com/users/rockerinthelocker/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rockerinthelocker",
      "id": 30327597,
      "login": "rockerinthelocker",
      "node_id": "MDQ6VXNlcjMwMzI3NTk3",
      "organizations_url": "https://api.github.com/users/rockerinthelocker/orgs",
      "received_events_url": "https://api.github.com/users/rockerinthelocker/received_events",
      "repos_url": "https://api.github.com/users/rockerinthelocker/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rockerinthelocker/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rockerinthelocker/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rockerinthelocker"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "> For testing purposes, the .NET flavor (net45, netstandard 2.0, etc.) of the DLLs included in the packages does not matter so simply grab\r\n\r\nIt does matter, I think. When I grab net45 flavor, I can see the exception about MemoryMappedFileSecurity. The net45 flavor is apparently not compatible with .NET Core.",
    "created_at": "2018-08-09T06:19:25Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7326#issuecomment-411649478",
    "id": 411649478,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7326",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMTY0OTQ3OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/411649478/reactions"
    },
    "updated_at": "2018-08-09T06:19:25Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/411649478",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6668460?v=4",
      "events_url": "https://api.github.com/users/jkotas/events{/privacy}",
      "followers_url": "https://api.github.com/users/jkotas/followers",
      "following_url": "https://api.github.com/users/jkotas/following{/other_user}",
      "gists_url": "https://api.github.com/users/jkotas/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jkotas",
      "id": 6668460,
      "login": "jkotas",
      "node_id": "MDQ6VXNlcjY2Njg0NjA=",
      "organizations_url": "https://api.github.com/users/jkotas/orgs",
      "received_events_url": "https://api.github.com/users/jkotas/received_events",
      "repos_url": "https://api.github.com/users/jkotas/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jkotas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jkotas/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jkotas"
    }
  },
  {
    "author_association": "NONE",
    "body": "@jkotas , Back to the topic. All PowerShell versions, except 6.1.0 previews 3 and 4, have no issues with LoadFile. PowerShell 6.1.0 preview 3 and 4 (targeting .NET Core 2.1 instead of .NET 2.0), however, ignore the path specified and just search for the assemblies in the GAC.",
    "created_at": "2018-08-09T21:00:29Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7326#issuecomment-411895441",
    "id": 411895441,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7326",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMTg5NTQ0MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/411895441/reactions"
    },
    "updated_at": "2018-08-09T21:00:29Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/411895441",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/30327597?v=4",
      "events_url": "https://api.github.com/users/rockerinthelocker/events{/privacy}",
      "followers_url": "https://api.github.com/users/rockerinthelocker/followers",
      "following_url": "https://api.github.com/users/rockerinthelocker/following{/other_user}",
      "gists_url": "https://api.github.com/users/rockerinthelocker/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rockerinthelocker",
      "id": 30327597,
      "login": "rockerinthelocker",
      "node_id": "MDQ6VXNlcjMwMzI3NTk3",
      "organizations_url": "https://api.github.com/users/rockerinthelocker/orgs",
      "received_events_url": "https://api.github.com/users/rockerinthelocker/received_events",
      "repos_url": "https://api.github.com/users/rockerinthelocker/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rockerinthelocker/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rockerinthelocker/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rockerinthelocker"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "> All PowerShell versions, except 6.1.0 previews 3 and 4, have no issues with LoadFile\r\n\r\nNot what I see. I have tried steps from https://github.com/PowerShell/PowerShell/issues/7326#issuecomment-406883555 on PowerShell-6.0.3-win-x64 .  It is the stable version from https://github.com/PowerShell/PowerShell#get-powershell . It fails the same way as PowerShell 6.1.0 preview 4.\r\n\r\n![image](https://user-images.githubusercontent.com/6668460/43926737-1d8d4978-9be0-11e8-9649-4339f538afa8.png)\r\n",
    "created_at": "2018-08-09T21:25:52Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7326#issuecomment-411902664",
    "id": 411902664,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7326",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMTkwMjY2NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/411902664/reactions"
    },
    "updated_at": "2018-08-09T21:25:52Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/411902664",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6668460?v=4",
      "events_url": "https://api.github.com/users/jkotas/events{/privacy}",
      "followers_url": "https://api.github.com/users/jkotas/followers",
      "following_url": "https://api.github.com/users/jkotas/following{/other_user}",
      "gists_url": "https://api.github.com/users/jkotas/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jkotas",
      "id": 6668460,
      "login": "jkotas",
      "node_id": "MDQ6VXNlcjY2Njg0NjA=",
      "organizations_url": "https://api.github.com/users/jkotas/orgs",
      "received_events_url": "https://api.github.com/users/jkotas/received_events",
      "repos_url": "https://api.github.com/users/jkotas/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jkotas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jkotas/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jkotas"
    }
  },
  {
    "author_association": "NONE",
    "body": "@jkotas , Maybe that version includes the bug as well. Anyway, this thread is about PowerShell 6.1.0.",
    "created_at": "2018-08-10T03:32:19Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7326#issuecomment-411965239",
    "id": 411965239,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7326",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMTk2NTIzOQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/411965239/reactions"
    },
    "updated_at": "2018-08-10T03:32:19Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/411965239",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/30327597?v=4",
      "events_url": "https://api.github.com/users/rockerinthelocker/events{/privacy}",
      "followers_url": "https://api.github.com/users/rockerinthelocker/followers",
      "following_url": "https://api.github.com/users/rockerinthelocker/following{/other_user}",
      "gists_url": "https://api.github.com/users/rockerinthelocker/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rockerinthelocker",
      "id": 30327597,
      "login": "rockerinthelocker",
      "node_id": "MDQ6VXNlcjMwMzI3NTk3",
      "organizations_url": "https://api.github.com/users/rockerinthelocker/orgs",
      "received_events_url": "https://api.github.com/users/rockerinthelocker/received_events",
      "repos_url": "https://api.github.com/users/rockerinthelocker/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rockerinthelocker/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rockerinthelocker/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rockerinthelocker"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "The exception is expected. LoadFile is working as speced and documented. It worked this way for last 15+ years since .NET Framework 1.0. There is no bug as far as .NET Core runtime is concerned.\r\n\r\nIf it somehow worked differently for you in a particular version of powershell, please point us to the exact version and repro steps. We will be happy to take a look.",
    "created_at": "2018-08-10T04:03:01Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7326#issuecomment-411968925",
    "id": 411968925,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7326",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMTk2ODkyNQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/411968925/reactions"
    },
    "updated_at": "2018-08-10T04:03:01Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/411968925",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6668460?v=4",
      "events_url": "https://api.github.com/users/jkotas/events{/privacy}",
      "followers_url": "https://api.github.com/users/jkotas/followers",
      "following_url": "https://api.github.com/users/jkotas/following{/other_user}",
      "gists_url": "https://api.github.com/users/jkotas/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jkotas",
      "id": 6668460,
      "login": "jkotas",
      "node_id": "MDQ6VXNlcjY2Njg0NjA=",
      "organizations_url": "https://api.github.com/users/jkotas/orgs",
      "received_events_url": "https://api.github.com/users/jkotas/received_events",
      "repos_url": "https://api.github.com/users/jkotas/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jkotas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jkotas/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jkotas"
    }
  },
  {
    "author_association": "NONE",
    "body": "The version details are available in the other thread (https://github.com/dotnet/coreclr/issues/19292#issuecomment-411633010). Since LoadFile works without issues with native PowerShell, all is good.",
    "created_at": "2018-08-10T05:19:48Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7326#issuecomment-411978087",
    "id": 411978087,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7326",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMTk3ODA4Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/411978087/reactions"
    },
    "updated_at": "2018-08-10T05:19:48Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/411978087",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/30327597?v=4",
      "events_url": "https://api.github.com/users/rockerinthelocker/events{/privacy}",
      "followers_url": "https://api.github.com/users/rockerinthelocker/followers",
      "following_url": "https://api.github.com/users/rockerinthelocker/following{/other_user}",
      "gists_url": "https://api.github.com/users/rockerinthelocker/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rockerinthelocker",
      "id": 30327597,
      "login": "rockerinthelocker",
      "node_id": "MDQ6VXNlcjMwMzI3NTk3",
      "organizations_url": "https://api.github.com/users/rockerinthelocker/orgs",
      "received_events_url": "https://api.github.com/users/rockerinthelocker/received_events",
      "repos_url": "https://api.github.com/users/rockerinthelocker/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rockerinthelocker/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rockerinthelocker/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rockerinthelocker"
    }
  }
]

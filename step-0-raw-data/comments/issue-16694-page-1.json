[
  {
    "author_association": "NONE",
    "body": "Lets assume I get that worked out and the weird `MSFT_NetTCPConnection (InstanceID = \"::??49670??::??0\")` can be transformed to actual useful information, the next step is to copy the binary to another computer (10.0.19043).\r\n\r\nExecuting it there, I get:\r\n```\r\nErr:    at System.Management.Automation.Runspaces.InitialSessionState.CreateDefault()\r\n   at System.Management.Automation.Runspaces.RunspaceFactory.CreateRunspace(PSHost host)\r\n   at System.Management.Automation.Runspaces.RunspaceFactory.CreateRunspace()\r\n   at System.Management.Automation.PowerShell.Worker.CreateRunspaceIfNeededAndDoWork(Runspace rsToUse, Boolean isSync)\r\n   at System.Management.Automation.PowerShell.CoreInvokeHelper[TInput,TOutput](PSDataCollection`1 input, PSDataCollection`1 output, PSInvocationSettings settings)\r\n   at System.Management.Automation.PowerShell.CoreInvoke[TInput,TOutput](PSDataCollection`1 input, PSDataCollection`1 output, PSInvocationSettings settings)\r\n   at System.Management.Automation.PowerShell.CoreInvoke[TOutput](IEnumerable input, PSDataCollection`1 output, PSInvocationSettings settings)\r\n   at System.Management.Automation.PowerShell.Invoke(IEnumerable input, PSInvocationSettings settings)\r\n   at System.Management.Automation.PowerShell.Invoke()\r\n   at TestCore.Program.Main(String[] args)\r\n```\r\n\r\nThat is acutally the initial reason why I wanted to report a bug, but my MWE above didn't yield the same results as my actual project, so I'm asking for help twice.",
    "created_at": "2022-01-04T10:09:57Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16694#issuecomment-1004677897",
    "id": 1004677897,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16694",
    "node_id": "IC_kwDOAvT7bc474isJ",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1004677897/reactions"
    },
    "updated_at": "2022-01-04T10:11:23Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1004677897",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/70915964?v=4",
      "events_url": "https://api.github.com/users/T35R6braPwgDJKq/events{/privacy}",
      "followers_url": "https://api.github.com/users/T35R6braPwgDJKq/followers",
      "following_url": "https://api.github.com/users/T35R6braPwgDJKq/following{/other_user}",
      "gists_url": "https://api.github.com/users/T35R6braPwgDJKq/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/T35R6braPwgDJKq",
      "id": 70915964,
      "login": "T35R6braPwgDJKq",
      "node_id": "MDQ6VXNlcjcwOTE1OTY0",
      "organizations_url": "https://api.github.com/users/T35R6braPwgDJKq/orgs",
      "received_events_url": "https://api.github.com/users/T35R6braPwgDJKq/received_events",
      "repos_url": "https://api.github.com/users/T35R6braPwgDJKq/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/T35R6braPwgDJKq/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/T35R6braPwgDJKq/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/T35R6braPwgDJKq"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "I wonder why do you create and build your project in so weird way? Why don't you read and follow docs?",
    "created_at": "2022-01-04T18:50:13Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16694#issuecomment-1005081557",
    "id": 1005081557,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16694",
    "node_id": "IC_kwDOAvT7bc476FPV",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1005081557/reactions"
    },
    "updated_at": "2022-01-04T18:50:13Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1005081557",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@T35R6braPwgDJKq Please directly use `Microsoft.PowerShell.SDK` with the `PackageReference` tag in your project file.\r\nAlso, running `Get-NetTCPConnection` in your application means you rely on the module to be present in the module path on the machine the application is running.",
    "created_at": "2022-01-04T19:10:58Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16694#issuecomment-1005096268",
    "id": 1005096268,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16694",
    "node_id": "IC_kwDOAvT7bc476I1M",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1005096268/reactions"
    },
    "updated_at": "2022-01-04T19:12:18Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1005096268",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "> /p:PublishSingleFile=true\r\n\r\nThis is not supported too.",
    "created_at": "2022-01-04T19:17:02Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16694#issuecomment-1005100410",
    "id": 1005100410,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16694",
    "node_id": "IC_kwDOAvT7bc476J16",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1005100410/reactions"
    },
    "updated_at": "2022-01-04T19:17:02Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1005100410",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "> I wonder why do you create and build your project in so weird way? Why don't you read and follow docs?\r\n\r\nwhat do you mean exactly? The project is an update to an existing project (which was built against ~netcore 2 or so)\r\nAlso, i'm using VS2019 which does not support .net6; i also guess that this does not really relate to the problem\r\nEdit: not just an update of an existing but also a change from powershell to pwsh of a third project...\r\nThe mwe is just as approximate as possible I guess\r\n\r\n> `/p:PublishSingleFile=true` is not supported too.\r\n\r\nMay be, but that does not seem the problem here either\r\n\r\n@daxian-dbw uhm, I installed the nuget package and set the reference - Do we expect another/more detailed error message here? If so, its not the case.\r\n",
    "created_at": "2022-01-04T22:52:28Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16694#issuecomment-1005230416",
    "id": 1005230416,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16694",
    "node_id": "IC_kwDOAvT7bc476plQ",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1005230416/reactions"
    },
    "updated_at": "2022-01-05T07:56:56Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1005230416",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/70915964?v=4",
      "events_url": "https://api.github.com/users/T35R6braPwgDJKq/events{/privacy}",
      "followers_url": "https://api.github.com/users/T35R6braPwgDJKq/followers",
      "following_url": "https://api.github.com/users/T35R6braPwgDJKq/following{/other_user}",
      "gists_url": "https://api.github.com/users/T35R6braPwgDJKq/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/T35R6braPwgDJKq",
      "id": 70915964,
      "login": "T35R6braPwgDJKq",
      "node_id": "MDQ6VXNlcjcwOTE1OTY0",
      "organizations_url": "https://api.github.com/users/T35R6braPwgDJKq/orgs",
      "received_events_url": "https://api.github.com/users/T35R6braPwgDJKq/received_events",
      "repos_url": "https://api.github.com/users/T35R6braPwgDJKq/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/T35R6braPwgDJKq/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/T35R6braPwgDJKq/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/T35R6braPwgDJKq"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@T35R6braPwgDJKq I gave it a try with `<PackageReference Include=\"Microsoft.PowerShell.SDK\" Version=\"7.2.1\" />` to reference the PowerShell SDK package and it works fine. Here are the details:\r\n\r\n```c#\r\nusing System;\r\nusing System.Management.Automation;\r\n\r\nnamespace TestCore\r\n{\r\n    class Program\r\n    {\r\n        static void Main(string[] args)\r\n        {\r\n            using (PowerShell ps = PowerShell.Create())\r\n            {\r\n                ps.AddCommand(\"Set-ExecutionPolicy\")\r\n                    .AddParameter(\"ExecutionPolicy\", \"RemoteSigned\")\r\n                    .AddParameter(\"Scope\", \"Process\")\r\n                    .Invoke();\r\n\r\n                var results = ps.AddScript(\"Get-NetTCPConnection\").Invoke();\r\n                Console.WriteLine(results[0].ToString());\r\n                ps.Commands.Clear();\r\n            }\r\n        }\r\n    }\r\n}\r\n```\r\n```xml\r\n<Project Sdk=\"Microsoft.NET.Sdk\">\r\n\r\n  <PropertyGroup>\r\n    <OutputType>Exe</OutputType>\r\n    <TargetFramework>net6.0</TargetFramework>\r\n  </PropertyGroup>\r\n\r\n  <ItemGroup>\r\n    <PackageReference Include=\"Microsoft.PowerShell.SDK\" Version=\"7.2.1\" />\r\n  </ItemGroup>\r\n\r\n</Project>\r\n```\r\n![image](https://user-images.githubusercontent.com/127450/148620299-14e443f2-c05f-4601-bbd3-fe7be5124bcf.png)\r\n\r\n------------\r\n\r\n`results[0].ToString()` won't get you the formatting output like in PowerShell because doing that in C# application doesn't go through the PowerShell formatting system. But you will get back the object and thus you can access its properties/fields as you need.",
    "created_at": "2022-01-07T23:37:06Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16694#issuecomment-1007820892",
    "id": 1007820892,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16694",
    "node_id": "IC_kwDOAvT7bc48EiBc",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1007820892/reactions"
    },
    "updated_at": "2022-01-07T23:37:06Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1007820892",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "NONE",
    "body": "This issue has been marked as answered and has not had any activity for **1 day**. It has been closed for housekeeping purposes.",
    "created_at": "2022-01-09T00:00:51Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16694#issuecomment-1008187905",
    "id": 1008187905,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16694",
    "node_id": "IC_kwDOAvT7bc48F7oB",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1008187905/reactions"
    },
    "updated_at": "2022-01-09T00:00:51Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1008187905",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  },
  {
    "author_association": "NONE",
    "body": "But how would I reference my `..\\..\\PowerShell\\src\\powershell-win-core\\bin\\Release\\net6.0\\win7-x64\\publish\\System.Management.Automation.dll`? \r\nIf I use the nuget package, the reference to my version is completely lost, isnt it?\r\n\r\n\r\n1 day is a very short period for closing issues.",
    "created_at": "2022-01-12T11:57:49Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16694#issuecomment-1010971185",
    "id": 1010971185,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16694",
    "node_id": "IC_kwDOAvT7bc48QjIx",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010971185/reactions"
    },
    "updated_at": "2022-01-12T11:58:39Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1010971185",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/70915964?v=4",
      "events_url": "https://api.github.com/users/T35R6braPwgDJKq/events{/privacy}",
      "followers_url": "https://api.github.com/users/T35R6braPwgDJKq/followers",
      "following_url": "https://api.github.com/users/T35R6braPwgDJKq/following{/other_user}",
      "gists_url": "https://api.github.com/users/T35R6braPwgDJKq/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/T35R6braPwgDJKq",
      "id": 70915964,
      "login": "T35R6braPwgDJKq",
      "node_id": "MDQ6VXNlcjcwOTE1OTY0",
      "organizations_url": "https://api.github.com/users/T35R6braPwgDJKq/orgs",
      "received_events_url": "https://api.github.com/users/T35R6braPwgDJKq/received_events",
      "repos_url": "https://api.github.com/users/T35R6braPwgDJKq/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/T35R6braPwgDJKq/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/T35R6braPwgDJKq/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/T35R6braPwgDJKq"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "Referencing local files in your .csproj for hosting PowerShell is not supported scenario. You can pick the nuget package with the same version as the powershell you installed, and that will make sure they are in sync.",
    "created_at": "2022-01-12T17:47:56Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16694#issuecomment-1011300702",
    "id": 1011300702,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16694",
    "node_id": "IC_kwDOAvT7bc48Rzle",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1011300702/reactions"
    },
    "updated_at": "2022-01-12T17:47:56Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1011300702",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "NONE",
    "body": "Well, I made changes to the pwsh code so it is required that my version is taken into consideration. I dont see neither why it should not work?\r\nIs there a way to build the Microsoft.PowerShell.SDK based on my pwsh?",
    "created_at": "2022-01-15T11:54:52Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16694#issuecomment-1013669183",
    "id": 1013669183,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16694",
    "node_id": "IC_kwDOAvT7bc48a10_",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1013669183/reactions"
    },
    "updated_at": "2022-01-15T11:54:52Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1013669183",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/70915964?v=4",
      "events_url": "https://api.github.com/users/T35R6braPwgDJKq/events{/privacy}",
      "followers_url": "https://api.github.com/users/T35R6braPwgDJKq/followers",
      "following_url": "https://api.github.com/users/T35R6braPwgDJKq/following{/other_user}",
      "gists_url": "https://api.github.com/users/T35R6braPwgDJKq/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/T35R6braPwgDJKq",
      "id": 70915964,
      "login": "T35R6braPwgDJKq",
      "node_id": "MDQ6VXNlcjcwOTE1OTY0",
      "organizations_url": "https://api.github.com/users/T35R6braPwgDJKq/orgs",
      "received_events_url": "https://api.github.com/users/T35R6braPwgDJKq/received_events",
      "repos_url": "https://api.github.com/users/T35R6braPwgDJKq/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/T35R6braPwgDJKq/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/T35R6braPwgDJKq/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/T35R6braPwgDJKq"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "To build nuget packages, use `New-ILNugetPackage` from the `tools/packaging` module. Example:\r\n```\r\nNew-ILNugetPackage -PackagePath <path-to-save-nuget-packages> -PackageVersion <version, ex: 7.2.0-preview.1> -WinFxdBinPath <path-to-publish-folder-of-the-fxdep-build-for-windows> -LinuxFxdBinPath <path-to-publish-folder-of-the-fxdep-build-for-Linux> -GenAPIToolPath <path-to-genapi>\r\n```\r\n1. This command needs to run on Windows. But you need to first build pwsh with `-Runtime fxdependent`.\r\n1. You can get `genAPI` from https://www.nuget.org/packages/Microsoft.DotNet.BuildTools.GenAPI/1.0.0-beta-00081. You will need to unzip the package and copy the `genAPI.exe` and related dlls to `<path-to-genapi>`.\r\n1. Your `PATH` env variable need to contain path to `nuget.exe`.\n\n<blockquote><img src=\"https://api.nuget.org/v3-flatcontainer/microsoft.dotnet.buildtools.genapi/1.0.0-beta-00081/icon\" width=\"48\" align=\"right\"><div><strong><a href=\"https://www.nuget.org/packages/Microsoft.DotNet.BuildTools.GenAPI/\">Microsoft.DotNet.BuildTools.GenAPI 1.0.0-beta-00081</a></strong></div><div>This package provides build-time support generating reference assembly source.  Referencing this package will cause the build to produce a CS file in the output directory that represents the public surface area of the project.  This package requires .NET Framework 4.6 or later to be installed on your build machine.</div></blockquote>",
    "created_at": "2022-01-18T19:42:13Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16694#issuecomment-1015773428",
    "id": 1015773428,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16694",
    "node_id": "IC_kwDOAvT7bc48i3j0",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1015773428/reactions"
    },
    "updated_at": "2022-01-18T19:42:15Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1015773428",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "NONE",
    "body": "I will give that a try, but I do not understand why it isnt enough to reference the generated pwsh libs\r\nWhen I use the systems System.Management.Automation.dll it works flawlessly",
    "created_at": "2022-01-19T10:42:11Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16694#issuecomment-1016306994",
    "id": 1016306994,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16694",
    "node_id": "IC_kwDOAvT7bc48k50y",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1016306994/reactions"
    },
    "updated_at": "2022-01-19T10:42:11Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1016306994",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/70915964?v=4",
      "events_url": "https://api.github.com/users/T35R6braPwgDJKq/events{/privacy}",
      "followers_url": "https://api.github.com/users/T35R6braPwgDJKq/followers",
      "following_url": "https://api.github.com/users/T35R6braPwgDJKq/following{/other_user}",
      "gists_url": "https://api.github.com/users/T35R6braPwgDJKq/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/T35R6braPwgDJKq",
      "id": 70915964,
      "login": "T35R6braPwgDJKq",
      "node_id": "MDQ6VXNlcjcwOTE1OTY0",
      "organizations_url": "https://api.github.com/users/T35R6braPwgDJKq/orgs",
      "received_events_url": "https://api.github.com/users/T35R6braPwgDJKq/received_events",
      "repos_url": "https://api.github.com/users/T35R6braPwgDJKq/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/T35R6braPwgDJKq/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/T35R6braPwgDJKq/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/T35R6braPwgDJKq"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "I'm not sure why that's not working, but it's not a supported scenario, so we will not investigate into it.",
    "created_at": "2022-01-19T17:34:53Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16694#issuecomment-1016703256",
    "id": 1016703256,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16694",
    "node_id": "IC_kwDOAvT7bc48makY",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1016703256/reactions"
    },
    "updated_at": "2022-01-19T17:34:53Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1016703256",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "At least pwsh SMA has additional dependencies vs WinPS SMA.",
    "created_at": "2022-01-19T17:40:57Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16694#issuecomment-1016708245",
    "id": 1016708245,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16694",
    "node_id": "IC_kwDOAvT7bc48mbyV",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1016708245/reactions"
    },
    "updated_at": "2022-01-19T17:40:57Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1016708245",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  }
]

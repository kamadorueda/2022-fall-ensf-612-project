[
  {
    "author_association": "COLLABORATOR",
    "body": "How about:\r\n\r\n```csharp\r\nusing (var pwsh = PowerShell.Create())\r\n{\r\n    pwsh.AddScript(\"Write-Error 'Bad'\").Invoke();\r\n\r\n    PSDataCollection<ErrorRecord> errors = pwsh.Streams.Error;\r\n}\r\n```",
    "created_at": "2021-08-24T16:23:25Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15984#issuecomment-904789004",
    "id": 904789004,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15984",
    "node_id": "IC_kwDOAvT7bc417fwM",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/904789004/reactions"
    },
    "updated_at": "2021-08-24T16:23:35Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/904789004",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/7009879?v=4",
      "events_url": "https://api.github.com/users/rjmholt/events{/privacy}",
      "followers_url": "https://api.github.com/users/rjmholt/followers",
      "following_url": "https://api.github.com/users/rjmholt/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjmholt/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rjmholt",
      "id": 7009879,
      "login": "rjmholt",
      "node_id": "MDQ6VXNlcjcwMDk4Nzk=",
      "organizations_url": "https://api.github.com/users/rjmholt/orgs",
      "received_events_url": "https://api.github.com/users/rjmholt/received_events",
      "repos_url": "https://api.github.com/users/rjmholt/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rjmholt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjmholt/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rjmholt"
    }
  },
  {
    "author_association": "NONE",
    "body": "> How about:\n> \n> ```csharp\n> using (var pwsh = PowerShell.Create())\n> {\n>     pwsh.AddScript(\"Write-Error 'Bad'\").Invoke();\n> \n>     PSDataCollection<ErrorRecord> errors = pwsh.Streams.Error;\n> }\n> ```\n\nThank you for your help. I'm not very familiar with the methods in Powershell. Is it possible to transmit error information to an object?\nJust like:\n```\nusing (var pwsh = PowerShell.Create())\n{\n    pwsh.AddScript(\"Write-Error 'Bad'\").Invoke();\n\n    PSDataCollection<ErrorRecord> errors = pwsh.Streams.Error;\n    test=pwsh.AddScript(\"Write-Error 'Bad'\").Invoke().xx(errors);\n    //or like this\n    //test=pwsh.AddScript(\"Write-Error 'Bad'\").Invoke().xx(out errors);\n}\n```",
    "created_at": "2021-08-24T17:43:09Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15984#issuecomment-904846251",
    "id": 904846251,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15984",
    "node_id": "IC_kwDOAvT7bc417tur",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/904846251/reactions"
    },
    "updated_at": "2021-08-24T17:45:45Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/904846251",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/49888091?v=4",
      "events_url": "https://api.github.com/users/henry-us/events{/privacy}",
      "followers_url": "https://api.github.com/users/henry-us/followers",
      "following_url": "https://api.github.com/users/henry-us/following{/other_user}",
      "gists_url": "https://api.github.com/users/henry-us/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/henry-us",
      "id": 49888091,
      "login": "henry-us",
      "node_id": "MDQ6VXNlcjQ5ODg4MDkx",
      "organizations_url": "https://api.github.com/users/henry-us/orgs",
      "received_events_url": "https://api.github.com/users/henry-us/received_events",
      "repos_url": "https://api.github.com/users/henry-us/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/henry-us/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/henry-us/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/henry-us"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Invoke will return the output stream, you need to access `Streams.Error` after you run the invoke to get the error stream (and other streams). See https://docs.microsoft.com/en-us/dotnet/api/system.management.automation.powershell.invoke?view=powershellsdk-7.0.0#System_Management_Automation_PowerShell_Invoke for details on `Invoke()` and https://docs.microsoft.com/en-us/dotnet/api/system.management.automation.powershell.streams?view=powershellsdk-7.0.0 for details of the `Streams` property.",
    "created_at": "2021-08-24T18:44:35Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15984#issuecomment-904885901",
    "id": 904885901,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15984",
    "node_id": "IC_kwDOAvT7bc4173aN",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/904885901/reactions"
    },
    "updated_at": "2021-08-24T18:45:19Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/904885901",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8462645?v=4",
      "events_url": "https://api.github.com/users/jborean93/events{/privacy}",
      "followers_url": "https://api.github.com/users/jborean93/followers",
      "following_url": "https://api.github.com/users/jborean93/following{/other_user}",
      "gists_url": "https://api.github.com/users/jborean93/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jborean93",
      "id": 8462645,
      "login": "jborean93",
      "node_id": "MDQ6VXNlcjg0NjI2NDU=",
      "organizations_url": "https://api.github.com/users/jborean93/orgs",
      "received_events_url": "https://api.github.com/users/jborean93/received_events",
      "repos_url": "https://api.github.com/users/jborean93/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jborean93/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jborean93/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jborean93"
    }
  },
  {
    "author_association": "NONE",
    "body": "> Invoke will return the output stream, you need to access `Streams.Error` after you run the invoke to get the error stream (and other streams). See https://docs.microsoft.com/en-us/dotnet/api/system.management.automation.powershell.invoke?view=powershellsdk-7.0.0#System_Management_Automation_PowerShell_Invoke for details on `Invoke()` and https://docs.microsoft.com/en-us/dotnet/api/system.management.automation.powershell.streams?view=powershellsdk-7.0.0 for details of the `Streams` property.\n\nOkay thanks Jordan, l've solved it now.\n\n<blockquote><img src=\"https://docs.microsoft.com/en-us/media/logos/logo-ms-social.png\" width=\"48\" align=\"right\"><div><strong><a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.management.automation.powershell.invoke\">PowerShell.Invoke Method (System.Management.Automation)</a></strong></div><div>Invoke the Command synchronously and return the output PSObject collection. </div></blockquote>\n<blockquote><img src=\"https://docs.microsoft.com/en-us/media/logos/logo-ms-social.png\" width=\"48\" align=\"right\"><div><strong><a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.management.automation.powershell.streams\">PowerShell.Streams Property (System.Management.Automation)</a></strong></div><div>Streams generated by PowerShell invocations </div></blockquote>",
    "created_at": "2021-08-25T08:45:24Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15984#issuecomment-905305973",
    "id": 905305973,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15984",
    "node_id": "IC_kwDOAvT7bc419d91",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/905305973/reactions"
    },
    "updated_at": "2021-08-25T08:45:26Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/905305973",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/49888091?v=4",
      "events_url": "https://api.github.com/users/henry-us/events{/privacy}",
      "followers_url": "https://api.github.com/users/henry-us/followers",
      "following_url": "https://api.github.com/users/henry-us/following{/other_user}",
      "gists_url": "https://api.github.com/users/henry-us/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/henry-us",
      "id": 49888091,
      "login": "henry-us",
      "node_id": "MDQ6VXNlcjQ5ODg4MDkx",
      "organizations_url": "https://api.github.com/users/henry-us/orgs",
      "received_events_url": "https://api.github.com/users/henry-us/received_events",
      "repos_url": "https://api.github.com/users/henry-us/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/henry-us/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/henry-us/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/henry-us"
    }
  }
]

[
  {
    "author_association": "MEMBER",
    "body": "This is probably a `Documentation-Needed` situation.  Currently, you'll probably have to look at the [code](https://github.com/PowerShell/PowerShell/blob/8aec1585195e6d4871538aaa2ad2b112cf5fbfee/src/System.Management.Automation/engine/Modules/ModuleIntrinsics.cs)",
    "created_at": "2018-06-15T18:39:07Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7082#issuecomment-397708497",
    "id": 397708497,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7082",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NzcwODQ5Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/397708497/reactions"
    },
    "updated_at": "2018-06-15T18:39:07Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/397708497",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "It would also be nice to have it as an API endpoint perhaps (like a variable, static property, etc) -- like `[ModuleIntrinsics]::GetModulePath()` except without requiring arguments. Curious if anyone else has felt a need for that?",
    "created_at": "2018-06-15T18:48:25Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7082#issuecomment-397710807",
    "id": 397710807,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7082",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NzcxMDgwNw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/397710807/reactions"
    },
    "updated_at": "2018-06-15T18:48:25Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/397710807",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/7009879?v=4",
      "events_url": "https://api.github.com/users/rjmholt/events{/privacy}",
      "followers_url": "https://api.github.com/users/rjmholt/followers",
      "following_url": "https://api.github.com/users/rjmholt/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjmholt/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rjmholt",
      "id": 7009879,
      "login": "rjmholt",
      "node_id": "MDQ6VXNlcjcwMDk4Nzk=",
      "organizations_url": "https://api.github.com/users/rjmholt/orgs",
      "received_events_url": "https://api.github.com/users/rjmholt/received_events",
      "repos_url": "https://api.github.com/users/rjmholt/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rjmholt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjmholt/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rjmholt"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "I think PSModulePath being an env var means you should get and set it like an env var",
    "created_at": "2018-06-15T18:52:15Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7082#issuecomment-397711784",
    "id": 397711784,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7082",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NzcxMTc4NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/397711784/reactions"
    },
    "updated_at": "2018-06-15T18:52:15Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/397711784",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "What I feel is absent is not necessarily the built-in default value, but a way to access the various well-known module locations by _scope_.\r\n\r\nBy analogy, let's take the example of `$PROFILE`, which contains the well-known profile locations as named-for-the-scope `NoteProperty` members:\r\n\r\n```powershell\r\n# Sample output when run on macOS\r\nPS> $PROFILE | Get-Member -type noteproperty | Select Name, Definition\r\n\r\nName                   Definition\r\n----                   ----------\r\nAllUsersAllHosts       string AllUsersAllHosts=/usr/local/microsoft/powershell/6-preview/profile.ps1\r\nAllUsersCurrentHost    string AllUsersCurrentHost=/usr/local/microsoft/powershell/6-preview/Microsoft.PowerShell_profile.ps1\r\nCurrentUserAllHosts    string CurrentUserAllHosts=/Users/jdoe/.config/powershell/profile.ps1\r\nCurrentUserCurrentHost string CurrentUserCurrentHost=/Users/jdoe/.config/powershell/Microsoft.PowerShell_profile.ps1\r\n```\r\n\r\nI think we should provide something similar for module locations, using scopes such as `AllUsers`,     `CurrentUser`, `System`, and `Custom` (the latter comprising all `$env:PSModulePath` entries in addition to the well-known locations).\r\n\r\nI'm unclear on how best to surface this functionality, however. \r\n\r\nIn theory, we could use the same approach as with `$PROFILE`: decorate the `$env:PSModulePath` `[string]` value with `NoteProperty` members, but that is somewhat obscure.\r\n\r\nThen again, if properly documented, perhaps that's the way to go.\r\n\r\n\r\n\r\n\r\n",
    "created_at": "2018-06-17T01:36:29Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7082#issuecomment-397848685",
    "id": 397848685,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7082",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5Nzg0ODY4NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 4,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 4,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/397848685/reactions"
    },
    "updated_at": "2019-11-28T02:37:11Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/397848685",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@BrucePay you should take @mklement0's suggestion as part of your `PSModulePath6` RFC",
    "created_at": "2018-06-18T15:35:04Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7082#issuecomment-398096690",
    "id": 398096690,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7082",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5ODA5NjY5MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/398096690/reactions"
    },
    "updated_at": "2018-06-18T15:35:04Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/398096690",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "NONE",
    "body": "I have submitted https://github.com/PowerShell/PowerShell-Docs/pull/3214 to add the *nix locations to the existing about_Modules and about_Environment_Variables docs. I grant that this is only a partial solution.",
    "created_at": "2018-10-31T22:30:14Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7082#issuecomment-434869882",
    "id": 434869882,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7082",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNDg2OTg4Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/434869882/reactions"
    },
    "updated_at": "2018-10-31T22:31:01Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/434869882",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/3678789?v=4",
      "events_url": "https://api.github.com/users/fsackur/events{/privacy}",
      "followers_url": "https://api.github.com/users/fsackur/followers",
      "following_url": "https://api.github.com/users/fsackur/following{/other_user}",
      "gists_url": "https://api.github.com/users/fsackur/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/fsackur",
      "id": 3678789,
      "login": "fsackur",
      "node_id": "MDQ6VXNlcjM2Nzg3ODk=",
      "organizations_url": "https://api.github.com/users/fsackur/orgs",
      "received_events_url": "https://api.github.com/users/fsackur/received_events",
      "repos_url": "https://api.github.com/users/fsackur/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/fsackur/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fsackur/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/fsackur"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Want to add that this may be of use in hosted PowerShell contexts where the hosting implementation might have reasons for using different paths for each module scope. (I would say \"or possibly define its own\", but I think we're coupled to the existing scopes now.)\r\n\r\nIt might merit being able to set the scoped module paths in the `powershell.config.json` and exposing their location through some PowerShell API. (Like @mklement0, I'm not sure what shape that API should be -- but I'd opt for either a variable or a method call, with the latter being a more direct fit to the current implementation).",
    "created_at": "2018-11-07T05:46:35Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7082#issuecomment-436512067",
    "id": 436512067,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7082",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNjUxMjA2Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/436512067/reactions"
    },
    "updated_at": "2018-11-07T05:52:47Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/436512067",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/7009879?v=4",
      "events_url": "https://api.github.com/users/rjmholt/events{/privacy}",
      "followers_url": "https://api.github.com/users/rjmholt/followers",
      "following_url": "https://api.github.com/users/rjmholt/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjmholt/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rjmholt",
      "id": 7009879,
      "login": "rjmholt",
      "node_id": "MDQ6VXNlcjcwMDk4Nzk=",
      "organizations_url": "https://api.github.com/users/rjmholt/orgs",
      "received_events_url": "https://api.github.com/users/rjmholt/received_events",
      "repos_url": "https://api.github.com/users/rjmholt/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rjmholt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjmholt/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rjmholt"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "In case anyone wants this btw, here's a quick function to get the defaults:\r\n\r\n```powershell\r\nfunction Get-DefaultModulePath\r\n{\r\n    param(\r\n        [Parameter()]\r\n        [ValidateSet('AllUsers', 'CurrentUser', 'System', 'WindowsPSSystem')]\r\n        [string[]]\r\n        $Scope\r\n    )\r\n\r\n    if ($Scope -eq 'WindowsPSSystem')\r\n    {\r\n        if ($IsLinux -or $IsMacOs)\r\n        {\r\n            throw \"The scope '$Scope' does not exist on non-Windows platforms\"\r\n        }\r\n\r\n        if ($PSVersionTable.PSVersion -le '6.0')\r\n        {\r\n            throw \"The scope '$Scope' is only valid in PowerShell versions 6.1 and above\"\r\n        }\r\n    }\r\n\r\n    if (-not $Scope)\r\n    {\r\n        $Scope = 'AllUsers','CurrentUser','System'\r\n        if (-not ($IsLinux -or $IsMacOS))\r\n        {\r\n            $Scope += 'WindowsPSSystem'\r\n        }\r\n    }\r\n\r\n    $invokeModuleMethod = {\r\n        $bindingFlags = [System.Reflection.BindingFlags]'static,nonpublic'\r\n        $m = [System.Management.Automation.ModuleIntrinsics].GetMethod($args[0], $bindingFlags)\r\n        $m.Invoke($null, @())\r\n    }\r\n\r\n    $paths = @{}\r\n    switch ($Scope)\r\n    {\r\n        'CurrentUser'\r\n        {\r\n            $p = & $invokeModuleMethod 'GetPersonalModulePath'\r\n            $paths.CurrentUser = $p\r\n        }\r\n\r\n        'AllUsers'\r\n        {\r\n            $p = & $invokeModuleMethod 'GetSharedModulePath'\r\n            $paths.AllUsers = $p\r\n        }\r\n\r\n        'System'\r\n        {\r\n            $p = & $invokeModuleMethod 'GetPSHomeModulePath'\r\n            $paths.System = $p\r\n        }\r\n\r\n        'WindowsPSSystem'\r\n        {\r\n            $p = & $invokeModuleMethod 'GetWindowsPowerShellPSHomeModulePath'\r\n            $paths.WindowsPSSystem = $p\r\n        }\r\n    }\r\n\r\n    return $paths\r\n}\r\n```",
    "created_at": "2018-11-07T06:25:56Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7082#issuecomment-436517843",
    "id": 436517843,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7082",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNjUxNzg0Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 1,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/436517843/reactions"
    },
    "updated_at": "2018-11-14T00:33:42Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/436517843",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/7009879?v=4",
      "events_url": "https://api.github.com/users/rjmholt/events{/privacy}",
      "followers_url": "https://api.github.com/users/rjmholt/followers",
      "following_url": "https://api.github.com/users/rjmholt/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjmholt/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rjmholt",
      "id": 7009879,
      "login": "rjmholt",
      "node_id": "MDQ6VXNlcjcwMDk4Nzk=",
      "organizations_url": "https://api.github.com/users/rjmholt/orgs",
      "received_events_url": "https://api.github.com/users/rjmholt/received_events",
      "repos_url": "https://api.github.com/users/rjmholt/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rjmholt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjmholt/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rjmholt"
    }
  },
  {
    "author_association": "NONE",
    "body": "@rjmholt thanks very much for this, I'm using it in a module and, if I can get it working nicely, I'll publish it as a standalone script.\r\n\r\nI note that on 5.1 and 6.0.1 on WIndows, and 6.1 on Linux, there is no `GetWindowsPowerShellPSHomeModulePath` method; it is only available on 6.1 on WIndows, AFAICS.",
    "created_at": "2018-11-13T10:24:46Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7082#issuecomment-438214398",
    "id": 438214398,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7082",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzODIxNDM5OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/438214398/reactions"
    },
    "updated_at": "2018-11-13T11:22:03Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/438214398",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/3678789?v=4",
      "events_url": "https://api.github.com/users/fsackur/events{/privacy}",
      "followers_url": "https://api.github.com/users/fsackur/followers",
      "following_url": "https://api.github.com/users/fsackur/following{/other_user}",
      "gists_url": "https://api.github.com/users/fsackur/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/fsackur",
      "id": 3678789,
      "login": "fsackur",
      "node_id": "MDQ6VXNlcjM2Nzg3ODk=",
      "organizations_url": "https://api.github.com/users/fsackur/orgs",
      "received_events_url": "https://api.github.com/users/fsackur/received_events",
      "repos_url": "https://api.github.com/users/fsackur/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/fsackur/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fsackur/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/fsackur"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Oh good point. Yes, I wrote that method for 6.1. Windows PowerShell should have some method like that in it, but I don’t know what it is. The method I wrote is equivalent to just `”${env:windir}\\System32\\WindowsPowerShell\\v1.0\\Modules”`",
    "created_at": "2018-11-13T13:56:05Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7082#issuecomment-438274073",
    "id": 438274073,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7082",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzODI3NDA3Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/438274073/reactions"
    },
    "updated_at": "2018-11-13T13:56:05Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/438274073",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/7009879?v=4",
      "events_url": "https://api.github.com/users/rjmholt/events{/privacy}",
      "followers_url": "https://api.github.com/users/rjmholt/followers",
      "following_url": "https://api.github.com/users/rjmholt/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjmholt/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rjmholt",
      "id": 7009879,
      "login": "rjmholt",
      "node_id": "MDQ6VXNlcjcwMDk4Nzk=",
      "organizations_url": "https://api.github.com/users/rjmholt/orgs",
      "received_events_url": "https://api.github.com/users/rjmholt/received_events",
      "repos_url": "https://api.github.com/users/rjmholt/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rjmholt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjmholt/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rjmholt"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for the handy function, @rjmholt (also interesting to see the use of reflection to call the non-public methods - I hope we won't need that in the long run).\r\n\r\nIt seems that in Windows PowerShell only the method that returns the `CurrentUser` scope exists, so I've amended your function to add fallback values for Windows PowerShell.\r\n(I've also changed the name to `Get-StandardModulePath`, shortened `WindowsPSSystem` to `WinPSSystem` and I'm using an _ordered_ hashtable for the result, which makes the function v3+; btw, you forgot to rename a couple of instances of `WindowsSystem` to `WindowsPSSystem` in your recent edit).\r\n\r\n```powershell\r\n#requires -version 3\r\nfunction Get-StandardModulePath {\r\n  param(\r\n    [Parameter()]\r\n    [ValidateSet('AllUsers', 'CurrentUser', 'System', 'WinPSSystem')]\r\n    [string[]]\r\n    $Scope\r\n  )\r\n\r\n  if ($Scope -eq 'WinPSSystem' -and ($IsLinux -or $IsMacOs)) {\r\n    throw \"The scope '$Scope' does not exist on non-Windows platforms.\"\r\n  }\r\n\r\n  if (-not $Scope) {\r\n    $Scope = 'CurrentUser', 'AllUsers', 'System'\r\n    if (-not ($IsLinux -or $IsMacOS)) {\r\n      $Scope += 'WinPSSystem'\r\n    }\r\n  }\r\n\r\n  $invokeModuleMethod = {\r\n    $bindingFlags = [System.Reflection.BindingFlags]'static,nonpublic'\r\n    $m = [System.Management.Automation.ModuleIntrinsics].GetMethod($args[0], $bindingFlags)\r\n    $m.Invoke($null, @())\r\n  }\r\n\r\n  $paths = [ordered] @{}\r\n  switch ($Scope) {\r\n    'CurrentUser' {\r\n      $paths.CurrentUser = try {\r\n        & $invokeModuleMethod 'GetPersonalModulePath'\r\n      }\r\n      catch {\r\n        # WinPS fallback.\r\n        \"$(Split-Path $PROFILE)\\Modules\"\r\n      }\r\n    }\r\n\r\n    'AllUsers' {\r\n      $paths.AllUsers = try {\r\n        & $invokeModuleMethod 'GetSharedModulePath'\r\n      }\r\n      catch {\r\n        # WinPS fallback.\r\n        \"$env:ProgramFiles\\WindowsPowerShell\\Modules\"\r\n      }\r\n    }\r\n          \r\n    'System' {\r\n      $paths.System = try {\r\n        & $invokeModuleMethod 'GetPSHomeModulePath'\r\n      }\r\n      catch {\r\n        # WinPS fallback.\r\n        \"$PSHOME\\Modules\"\r\n      }\r\n    }\r\n\r\n    'WinPSSystem' {\r\n      $paths.WinPSSystem = try {\r\n        & $invokeModuleMethod 'GetWindowsPowerShellPSHomeModulePath'\r\n      }\r\n      catch {\r\n        # WinPS fallback.\r\n        \"$PSHOME\\Modules\"\r\n      }\r\n    }\r\n  }\r\n\r\n  return $paths\r\n}\r\n```",
    "created_at": "2018-11-13T22:31:22Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7082#issuecomment-438463574",
    "id": 438463574,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7082",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzODQ2MzU3NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/438463574/reactions"
    },
    "updated_at": "2018-11-13T22:31:22Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/438463574",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@mklement0 Yeah I opened this issue because I think those methods (or something like them) should really be a public API, since they are a contract with PSGet",
    "created_at": "2018-11-14T00:35:55Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7082#issuecomment-438492824",
    "id": 438492824,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7082",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzODQ5MjgyNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/438492824/reactions"
    },
    "updated_at": "2018-11-14T00:35:55Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/438492824",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/7009879?v=4",
      "events_url": "https://api.github.com/users/rjmholt/events{/privacy}",
      "followers_url": "https://api.github.com/users/rjmholt/followers",
      "following_url": "https://api.github.com/users/rjmholt/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjmholt/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rjmholt",
      "id": 7009879,
      "login": "rjmholt",
      "node_id": "MDQ6VXNlcjcwMDk4Nzk=",
      "organizations_url": "https://api.github.com/users/rjmholt/orgs",
      "received_events_url": "https://api.github.com/users/rjmholt/received_events",
      "repos_url": "https://api.github.com/users/rjmholt/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rjmholt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjmholt/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rjmholt"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Ah, of course, @rjmholt; so another thank you for opening this issue.",
    "created_at": "2018-11-14T02:41:40Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7082#issuecomment-438517039",
    "id": 438517039,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7082",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzODUxNzAzOQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/438517039/reactions"
    },
    "updated_at": "2018-11-14T02:41:40Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/438517039",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "NONE",
    "body": ":tada:This issue was addressed in #11057, which has now been successfully released as `v7.0.0-preview.6`.:tada:\n\nHandy links:\n* [Release Notes](https://github.com/PowerShell/PowerShell/releases/tag/v7.0.0-preview.6)\n",
    "created_at": "2019-11-21T22:36:05Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7082#issuecomment-557303778",
    "id": 557303778,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7082",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzMwMzc3OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/557303778/reactions"
    },
    "updated_at": "2019-11-21T22:36:05Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/557303778",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@SteveL-MSFT is there a reason #11057 is marked as closing this issue? I couldn't find any new mechanism to solve feature request in that PR",
    "created_at": "2019-11-28T01:25:39Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7082#issuecomment-559304751",
    "id": 559304751,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7082",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTMwNDc1MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/559304751/reactions"
    },
    "updated_at": "2019-11-28T01:25:39Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/559304751",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/7009879?v=4",
      "events_url": "https://api.github.com/users/rjmholt/events{/privacy}",
      "followers_url": "https://api.github.com/users/rjmholt/followers",
      "following_url": "https://api.github.com/users/rjmholt/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjmholt/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rjmholt",
      "id": 7009879,
      "login": "rjmholt",
      "node_id": "MDQ6VXNlcjcwMDk4Nzk=",
      "organizations_url": "https://api.github.com/users/rjmholt/orgs",
      "received_events_url": "https://api.github.com/users/rjmholt/received_events",
      "repos_url": "https://api.github.com/users/rjmholt/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rjmholt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjmholt/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rjmholt"
    }
  }
]

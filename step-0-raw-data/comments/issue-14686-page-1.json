[
  {
    "author_association": "NONE",
    "body": "So I tested using different colors for the colored characters:\r\n![image](https://user-images.githubusercontent.com/17579247/106561560-e00c4400-6563-11eb-8d84-6193a4dbf53c.png)",
    "created_at": "2021-02-02T06:35:29Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14686#issuecomment-771402348",
    "id": 771402348,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14686",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3MTQwMjM0OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/771402348/reactions"
    },
    "updated_at": "2021-02-02T06:35:29Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/771402348",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/17579247?v=4",
      "events_url": "https://api.github.com/users/Neur1n/events{/privacy}",
      "followers_url": "https://api.github.com/users/Neur1n/followers",
      "following_url": "https://api.github.com/users/Neur1n/following{/other_user}",
      "gists_url": "https://api.github.com/users/Neur1n/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Neur1n",
      "id": 17579247,
      "login": "Neur1n",
      "node_id": "MDQ6VXNlcjE3NTc5MjQ3",
      "organizations_url": "https://api.github.com/users/Neur1n/orgs",
      "received_events_url": "https://api.github.com/users/Neur1n/received_events",
      "repos_url": "https://api.github.com/users/Neur1n/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Neur1n/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Neur1n/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Neur1n"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@Neur1n The repro steps you provided don't work. `Invoke-Module` and `Write-Prompt` are both not defined. Please update your repro steps.",
    "created_at": "2021-02-02T17:49:17Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14686#issuecomment-771836103",
    "id": 771836103,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14686",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3MTgzNjEwMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/771836103/reactions"
    },
    "updated_at": "2021-02-02T17:49:17Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/771836103",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "NONE",
    "body": "Sorry, here is the minimal configuration:\r\n\r\n```powershell\r\nif ($IsWindows -and (Get-ExecutionPolicy) -ne 'RemoteSigned') {\r\n  Set-ExecutionPolicy RemoteSigned -Scope CurrentUser -Confirm\r\n}\r\n\r\nfunction Invoke-Module ($name) {\r\n  if (Get-Module -ListAvailable -Name $name) {\r\n    Import-Module $name\r\n  } else {\r\n    Write-Host 'Installing missinged module ' $name '...'\r\n    Install-Module $name -Scope CurrentUser -AllowPrerelease -Force\r\n  }\r\n}\r\n\r\nInvoke-Module 'posh-git'\r\nInvoke-Module 'PSReadLine'\r\n\r\n$script:indicator = 'î‚°'  # u+e0b0\r\n$script:vimode = '[I]'\r\n$script:vicolor = [ConsoleColor]::Green\r\n\r\nfunction OnViModeChange {\r\n  if ($args[0] -eq 'Command') {\r\n    $script:vimode = '[N]'\r\n    $script:vicolor = [ConsoleColor]::Red\r\n  } else {\r\n    $script:vimode = '[I]'\r\n    $script:vicolor = [ConsoleColor]::Green\r\n  }\r\n\r\n  [Microsoft.PowerShell.PSConsoleReadLine]::InvokePrompt()\r\n}\r\n\r\nSet-PSReadLineOption -EditMode Vi\r\nSet-PSReadLineOption -ExtraPromptLineCount 2\r\nSet-PSReadLineOption -HistorySearchCursorMovesToEnd\r\nSet-PSReadLineOption -ViModeIndicator Script -ViModeChangeHandler $Function:OnViModeChange\r\n\r\nfunction Prompt {\r\n  $Prompt = Write-Prompt \"`n\"\r\n  $Prompt += & $GitPromptScriptBlock\r\n  $Prompt += Write-Prompt \"`n $script:vimode\" -BackgroundColor $script:vicolor\r\n  $Prompt += Write-Prompt \"$script:indicator\" -ForegroundColor $script:vicolor\r\n  if ($Prompt) { \"$Prompt \" } else { \" \" }\r\n}\r\n```",
    "created_at": "2021-02-03T01:30:59Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14686#issuecomment-772138905",
    "id": 772138905,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14686",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3MjEzODkwNQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/772138905/reactions"
    },
    "updated_at": "2021-02-03T01:33:43Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/772138905",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/17579247?v=4",
      "events_url": "https://api.github.com/users/Neur1n/events{/privacy}",
      "followers_url": "https://api.github.com/users/Neur1n/followers",
      "following_url": "https://api.github.com/users/Neur1n/following{/other_user}",
      "gists_url": "https://api.github.com/users/Neur1n/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Neur1n",
      "id": 17579247,
      "login": "Neur1n",
      "node_id": "MDQ6VXNlcjE3NTc5MjQ3",
      "organizations_url": "https://api.github.com/users/Neur1n/orgs",
      "received_events_url": "https://api.github.com/users/Neur1n/received_events",
      "repos_url": "https://api.github.com/users/Neur1n/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Neur1n/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Neur1n/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Neur1n"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Having only glanced at this, I wonder if it is a duplicate of #14506",
    "created_at": "2021-02-03T04:19:51Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14686#issuecomment-772213785",
    "id": 772213785,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14686",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3MjIxMzc4NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/772213785/reactions"
    },
    "updated_at": "2021-02-03T14:05:09Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/772213785",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "NONE",
    "body": "I tried running `Write-Warning foo; 'bar'` as mentioned in #14506, but it did not reproduce my issue. Thanks though.",
    "created_at": "2021-02-03T07:57:31Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14686#issuecomment-772312326",
    "id": 772312326,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14686",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3MjMxMjMyNg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/772312326/reactions"
    },
    "updated_at": "2021-02-03T07:57:31Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/772312326",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/17579247?v=4",
      "events_url": "https://api.github.com/users/Neur1n/events{/privacy}",
      "followers_url": "https://api.github.com/users/Neur1n/followers",
      "following_url": "https://api.github.com/users/Neur1n/following{/other_user}",
      "gists_url": "https://api.github.com/users/Neur1n/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Neur1n",
      "id": 17579247,
      "login": "Neur1n",
      "node_id": "MDQ6VXNlcjE3NTc5MjQ3",
      "organizations_url": "https://api.github.com/users/Neur1n/orgs",
      "received_events_url": "https://api.github.com/users/Neur1n/received_events",
      "repos_url": "https://api.github.com/users/Neur1n/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Neur1n/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Neur1n/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Neur1n"
    }
  },
  {
    "author_association": "NONE",
    "body": "Not sure if related but I get the same kind of behavior with C# code ran in a PowerShell (Core & Legacy) console. \r\n\r\n```csharp\r\nConsole.BackgroundColor = ConsoleColor.Red;\r\nConsole.ForegroundColor = ConsoleColor.Black;\r\nConsole.Write(\"Hello World!\");\r\nConsole.ResetColor();\r\nConsole.WriteLine();\r\n```\r\n\r\nExecuting `dotnet run` in PowerShell gives the expected behavior:\r\n\r\n![image](https://user-images.githubusercontent.com/2334569/117548784-7ce8ec80-b03f-11eb-8970-0bacdff8b107.png)\r\n\r\nAfter resizing the shell window I get a full red line:\r\n\r\n![image](https://user-images.githubusercontent.com/2334569/117548805-a3a72300-b03f-11eb-8f3c-3d16862dc9ec.png)\r\n",
    "created_at": "2021-05-08T18:00:42Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14686#issuecomment-835450613",
    "id": 835450613,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14686",
    "node_id": "MDEyOklzc3VlQ29tbWVudDgzNTQ1MDYxMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/835450613/reactions"
    },
    "updated_at": "2021-05-08T18:00:42Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/835450613",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/2334569?v=4",
      "events_url": "https://api.github.com/users/stanciuadrian/events{/privacy}",
      "followers_url": "https://api.github.com/users/stanciuadrian/followers",
      "following_url": "https://api.github.com/users/stanciuadrian/following{/other_user}",
      "gists_url": "https://api.github.com/users/stanciuadrian/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/stanciuadrian",
      "id": 2334569,
      "login": "stanciuadrian",
      "node_id": "MDQ6VXNlcjIzMzQ1Njk=",
      "organizations_url": "https://api.github.com/users/stanciuadrian/orgs",
      "received_events_url": "https://api.github.com/users/stanciuadrian/received_events",
      "repos_url": "https://api.github.com/users/stanciuadrian/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/stanciuadrian/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stanciuadrian/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/stanciuadrian"
    }
  }
]

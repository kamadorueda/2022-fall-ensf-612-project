[
  {
    "author_association": "CONTRIBUTOR",
    "body": "I don't quite get this. If you have 10 jobs taking 1 second each and `-ThrottleLimit` 4, so that each thread takes 2.5s on average, which do you want to limit? Single job or single thread?",
    "created_at": "2022-09-04T17:33:35Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/18027#issuecomment-1236385000",
    "id": 1236385000,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/18027",
    "node_id": "IC_kwDOAvT7bc5Jsbzo",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1236385000/reactions"
    },
    "updated_at": "2022-09-04T17:33:35Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1236385000",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/26599495?v=4",
      "events_url": "https://api.github.com/users/dkaszews/events{/privacy}",
      "followers_url": "https://api.github.com/users/dkaszews/followers",
      "following_url": "https://api.github.com/users/dkaszews/following{/other_user}",
      "gists_url": "https://api.github.com/users/dkaszews/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/dkaszews",
      "id": 26599495,
      "login": "dkaszews",
      "node_id": "MDQ6VXNlcjI2NTk5NDk1",
      "organizations_url": "https://api.github.com/users/dkaszews/orgs",
      "received_events_url": "https://api.github.com/users/dkaszews/received_events",
      "repos_url": "https://api.github.com/users/dkaszews/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/dkaszews/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dkaszews/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/dkaszews"
    }
  },
  {
    "author_association": "NONE",
    "body": "I don't know if there is a one-to-one correspondence between each pipe and thread, so the name \"thread\" is not used here.\r\n\r\nRegarding how \"threads\" are used inside pipes:\r\nIf there is no \"-ThrottleLimit\" limit, does 100 pipes use 100 threads?\r\nFrom a reasonable point of view:\r\n100 pipes should not be started with 100 threads.\r\nIf it is cpu-intensive, threads with the number of cpu cores (or vcores) should be started.\r\nIf according to the io-intensive, it should start roughly 10 times as many threads as the cpu core.\r\n\r\n----\r\n\r\nForEach-Object-Parallel usage scenarios:\r\n1Invoke-WebRequest You can't expect every pipe site to have the same return time.\r\n\r\nWhen the number of pipes is large,\r\n1 “total time” is not as easy to use as “average time”.\r\n2 When a pipe hangs in front of the pipes, or the time is crowded for a long time, the subsequent pipes have not started, and “the total time” is up.\r\n\r\nby the way:\r\nIf you use the parameter asjob + PSBeginTime property to calculate the lifetime of each pipe yourself, you will lose the ability to output the write-* command in the foreground.",
    "created_at": "2022-09-05T03:36:36Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/18027#issuecomment-1236510557",
    "id": 1236510557,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/18027",
    "node_id": "IC_kwDOAvT7bc5Js6dd",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1236510557/reactions"
    },
    "updated_at": "2022-09-05T04:12:45Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1236510557",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/65390418?v=4",
      "events_url": "https://api.github.com/users/kasini3000/events{/privacy}",
      "followers_url": "https://api.github.com/users/kasini3000/followers",
      "following_url": "https://api.github.com/users/kasini3000/following{/other_user}",
      "gists_url": "https://api.github.com/users/kasini3000/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/kasini3000",
      "id": 65390418,
      "login": "kasini3000",
      "node_id": "MDQ6VXNlcjY1MzkwNDE4",
      "organizations_url": "https://api.github.com/users/kasini3000/orgs",
      "received_events_url": "https://api.github.com/users/kasini3000/received_events",
      "repos_url": "https://api.github.com/users/kasini3000/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/kasini3000/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kasini3000/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/kasini3000"
    }
  },
  {
    "author_association": "NONE",
    "body": "@dkaszews  I can see a wish for both. \r\n100 items to process, average time 1 second, 10 threads. > 10 cores to run them on. Whole process should run in 10 seconds. \r\nWe might want to stop a single item that is still running after 10 seconds.\r\nOr we might also want to stop the whole set if has not completed within 2 minutes \r\n\r\nThe second seems like a terminating error \"We stopped without processing everything\". \r\nThe first would be a way to fail _sooner_ but re-using the thread to process another item (maybe with a warning) strikes me as wrong - my instinct says something should process everything or throw an error, it should not silently drop items. But  I can see  someone saying \"My output tells me what has been processed, the commands I'm running in parallel can't change their timeouts so let me set one in the 'command-runner'\" ",
    "created_at": "2022-09-06T16:12:24Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/18027#issuecomment-1238361933",
    "id": 1238361933,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/18027",
    "node_id": "IC_kwDOAvT7bc5Jz-dN",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1238361933/reactions"
    },
    "updated_at": "2022-09-06T16:12:24Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1238361933",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/16209593?v=4",
      "events_url": "https://api.github.com/users/jhoneill/events{/privacy}",
      "followers_url": "https://api.github.com/users/jhoneill/followers",
      "following_url": "https://api.github.com/users/jhoneill/following{/other_user}",
      "gists_url": "https://api.github.com/users/jhoneill/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jhoneill",
      "id": 16209593,
      "login": "jhoneill",
      "node_id": "MDQ6VXNlcjE2MjA5NTkz",
      "organizations_url": "https://api.github.com/users/jhoneill/orgs",
      "received_events_url": "https://api.github.com/users/jhoneill/received_events",
      "repos_url": "https://api.github.com/users/jhoneill/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jhoneill/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jhoneill/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jhoneill"
    }
  },
  {
    "author_association": "NONE",
    "body": "think:\r\nThe farmer has 10 sheep (pipes) and a trough (ThrottleLimit).\r\nThe farmer wants to average the sheep's food, not that the first sheep eat too much and the remaining 9 sheep starve to death.",
    "created_at": "2022-09-07T02:47:31Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/18027#issuecomment-1238846082",
    "id": 1238846082,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/18027",
    "node_id": "IC_kwDOAvT7bc5J10qC",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1238846082/reactions"
    },
    "updated_at": "2022-09-07T02:47:31Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1238846082",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/65390418?v=4",
      "events_url": "https://api.github.com/users/kasini3000/events{/privacy}",
      "followers_url": "https://api.github.com/users/kasini3000/followers",
      "following_url": "https://api.github.com/users/kasini3000/following{/other_user}",
      "gists_url": "https://api.github.com/users/kasini3000/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/kasini3000",
      "id": 65390418,
      "login": "kasini3000",
      "node_id": "MDQ6VXNlcjY1MzkwNDE4",
      "organizations_url": "https://api.github.com/users/kasini3000/orgs",
      "received_events_url": "https://api.github.com/users/kasini3000/received_events",
      "repos_url": "https://api.github.com/users/kasini3000/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/kasini3000/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kasini3000/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/kasini3000"
    }
  },
  {
    "author_association": "NONE",
    "body": "> think: The farmer has 10 sheep (pipes) and a trough (ThrottleLimit). The farmer wants to average the sheep's food, not that the first sheep eat too much and the remaining 9 sheep starve to death.\r\n\r\nThe job is successfully done when no sheep are hungry. If the first sheep is removed from the trough while still hungry, do we say the job has failed ?\r\n\r\n**Ideally** the scriptblock run for each item should limit how long it can run, and raise the right exception. \r\n\r\n**However** Testing this I've found that `throw` (or  `break`  or `exit`) will not stop later items from running,  So removing the \"hungry sheep\" is no worse than what happens already. \r\nFor reasons I don't understand `foreach-object` doesn't allow `-parallel` and `ErrorAction/WarningAction/InformationAction` or `pipelinevariable`   -  but  setting `$ErrorActionPreference`  will cause it to stop for either  `throw` and `Write-Error`  - writing an error for \"hungry sheep\" would allow the other \"sheep\" to get their turns, but could also be transformed into a stop \r\n\r\n\r\n\r\n",
    "created_at": "2022-09-07T09:44:29Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/18027#issuecomment-1239159653",
    "id": 1239159653,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/18027",
    "node_id": "IC_kwDOAvT7bc5J3BNl",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1239159653/reactions"
    },
    "updated_at": "2022-09-07T09:44:29Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1239159653",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/16209593?v=4",
      "events_url": "https://api.github.com/users/jhoneill/events{/privacy}",
      "followers_url": "https://api.github.com/users/jhoneill/followers",
      "following_url": "https://api.github.com/users/jhoneill/following{/other_user}",
      "gists_url": "https://api.github.com/users/jhoneill/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jhoneill",
      "id": 16209593,
      "login": "jhoneill",
      "node_id": "MDQ6VXNlcjE2MjA5NTkz",
      "organizations_url": "https://api.github.com/users/jhoneill/orgs",
      "received_events_url": "https://api.github.com/users/jhoneill/received_events",
      "repos_url": "https://api.github.com/users/jhoneill/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jhoneill/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jhoneill/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jhoneill"
    }
  },
  {
    "author_association": "NONE",
    "body": "The farmer said: \"Don't worry about the sheep, the sick sheep will write-host or log themselves\"   ;)",
    "created_at": "2022-09-10T03:35:59Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/18027#issuecomment-1242608737",
    "id": 1242608737,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/18027",
    "node_id": "IC_kwDOAvT7bc5KELRh",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1242608737/reactions"
    },
    "updated_at": "2022-09-10T03:35:59Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1242608737",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/65390418?v=4",
      "events_url": "https://api.github.com/users/kasini3000/events{/privacy}",
      "followers_url": "https://api.github.com/users/kasini3000/followers",
      "following_url": "https://api.github.com/users/kasini3000/following{/other_user}",
      "gists_url": "https://api.github.com/users/kasini3000/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/kasini3000",
      "id": 65390418,
      "login": "kasini3000",
      "node_id": "MDQ6VXNlcjY1MzkwNDE4",
      "organizations_url": "https://api.github.com/users/kasini3000/orgs",
      "received_events_url": "https://api.github.com/users/kasini3000/received_events",
      "repos_url": "https://api.github.com/users/kasini3000/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/kasini3000/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kasini3000/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/kasini3000"
    }
  }
]

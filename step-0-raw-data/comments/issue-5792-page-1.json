[
  {
    "author_association": "COLLABORATOR",
    "body": "It works. But I caught another problem: I install current build PowerShell-6.1.0-preview.7428-win-x64.msi over previous PowerShell-6.1.0-preview.7420-win-x64.msi and lost the local Explorer menu for PowerShell ðŸ˜• \r\n  ",
    "created_at": "2018-01-05T18:41:32Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/5792#issuecomment-355632210",
    "id": 355632210,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/5792",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NTYzMjIxMA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/355632210/reactions"
    },
    "updated_at": "2018-01-05T18:42:14Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/355632210",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@iSazonov : I cannot repro your problem. I installed `6.1.0-preview.7420-win-x64` first and then `6.1.0-preview.7436-win-x64` over it and the context menu is still there. Are you sure you did not forget to tick the checkbox again when installing it the 2nd time? Maybe it is missleading that the checkbox says `Add context menu` and the word `Add` should maybe be replaced with something like `Configure`. I might be able to change the behaviour but I would like to get clarification first what the expected behaviour should be when not checking the checkbox the 2nd time. I think what happens behind the scenes is that the upgrade uninstalls some things first (leading to the removal of registry entries) and then does the upgrade installation (one could almost say, it is a feature not a bug :stuck_out_tongue_winking_eye:).\r\nOne could argue for and against either case, e.g.:\r\n- Person A wants to upgrade PowerShell but this time decided (s)he does not want the context menu any more, so he/she does not tick the checkbox to get rid of it. In this case the current behaviour would be nice because otherwise the person has to uninstall and re-install just to get rid of the context menu.\r\n- Person B wants to only upgrade PowerShell but keep the current configuration without having to remember the configuration. In this case the current behaviour is not good.\r\n\r\nThe only way to fulfill both cases would be to detect that it is an upgrade install and set the defaults to the current configuration. This might be quite difficult and error prone to implement.\r\n  ",
    "created_at": "2018-01-05T22:19:45Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/5792#issuecomment-355681185",
    "id": 355681185,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/5792",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NTY4MTE4NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/355681185/reactions"
    },
    "updated_at": "2018-01-05T22:24:16Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/355681185",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/9250262?v=4",
      "events_url": "https://api.github.com/users/bergmeister/events{/privacy}",
      "followers_url": "https://api.github.com/users/bergmeister/followers",
      "following_url": "https://api.github.com/users/bergmeister/following{/other_user}",
      "gists_url": "https://api.github.com/users/bergmeister/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/bergmeister",
      "id": 9250262,
      "login": "bergmeister",
      "node_id": "MDQ6VXNlcjkyNTAyNjI=",
      "organizations_url": "https://api.github.com/users/bergmeister/orgs",
      "received_events_url": "https://api.github.com/users/bergmeister/received_events",
      "repos_url": "https://api.github.com/users/bergmeister/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/bergmeister/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bergmeister/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/bergmeister"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@bergmeister I would defer worrying about those cases until there is sufficient feedback we need to support it (whichever case)",
    "created_at": "2018-01-06T01:05:18Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/5792#issuecomment-355709921",
    "id": 355709921,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/5792",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NTcwOTkyMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/355709921/reactions"
    },
    "updated_at": "2018-01-06T01:05:18Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/355709921",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@bergmeister Never mind, I used non-rebased branch.",
    "created_at": "2018-01-06T07:54:46Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/5792#issuecomment-355730726",
    "id": 355730726,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/5792",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NTczMDcyNg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/355730726/reactions"
    },
    "updated_at": "2018-01-06T07:54:46Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/355730726",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  }
]

[
  {
    "author_association": "COLLABORATOR",
    "body": "@SteveL-MSFT I think we should simply revert a change in line 557\r\nfrom\r\n`_isRunningInBackground = IsWindowsApplication;`\r\nto\r\n`_isRunningInBackground = IsWindowsApplication(_nativeProcess.StartInfo.FileName);`\r\n\r\nAs for test, you could see last test in Invoke-Item.Tests,ps1 file:\r\n`Describe \"Invoke-Item tests on Windows\" -Tags \"CI\",\"RequireAdminOnWindows\" {`\r\n",
    "created_at": "2020-10-06T03:49:14Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/13750#issuecomment-704010950",
    "id": 704010950,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13750",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwNDAxMDk1MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/704010950/reactions"
    },
    "updated_at": "2020-10-06T03:49:14Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/704010950",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@iSazonov the problem is if anyone updates the code and uses `CheckIfConsoleApplication()` it will have a similar problem as `IsWindowsApplication` doesn't get updated if we just do the change you are suggesting.\r\n\r\nAs for the test, it appears the hang only occurs if the associated process explicitly supports elevation like mmc.exe.  I can add a test that runs if `diskmgmt.msc` and `mmc.exe` are on the system, otherwise it'll be skipped.  At least it can work locally.",
    "created_at": "2020-10-06T13:18:15Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/13750#issuecomment-704262614",
    "id": 704262614,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13750",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwNDI2MjYxNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/704262614/reactions"
    },
    "updated_at": "2020-10-06T13:18:15Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/704262614",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": ">  the problem is if anyone updates the code and uses CheckIfConsoleApplication() it will have a similar problem as IsWindowsApplication doesn't get updated if we just do the change you are suggesting.\r\n\r\nMy thoughts is that switching to mmc.exe is temporary and we should follow diskmgmt.msc. Otherwise it will very tricky code - input is diskmgmt.msc but result is for mmc.exe.\r\nAnd I'd remove IsWindowsApplication and IsConsoleApplication because they is used once.",
    "created_at": "2020-10-06T13:34:48Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/13750#issuecomment-704272872",
    "id": 704272872,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13750",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwNDI3Mjg3Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/704272872/reactions"
    },
    "updated_at": "2020-10-06T13:34:48Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/704272872",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@iSazonov but `diskmgmt.msc` is not the process so following it doesn't make sense unless I'm misunderstanding.  Removing `IsWindowsApplication` and `IsConsoleApplication` makes sense.",
    "created_at": "2020-10-06T13:40:46Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/13750#issuecomment-704276539",
    "id": 704276539,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13750",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwNDI3NjUzOQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/704276539/reactions"
    },
    "updated_at": "2020-10-06T13:40:46Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/704276539",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "If we remove IsWindowsApplication we remove _isWindowsApplication and this resolves our discussion (til we will want to make IsWindowsApplication public :-) )",
    "created_at": "2020-10-06T14:10:09Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/13750#issuecomment-704295457",
    "id": 704295457,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13750",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwNDI5NTQ1Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/704295457/reactions"
    },
    "updated_at": "2020-10-06T14:10:09Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/704295457",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "As unrelated notice. The code fallback to default shell (cmd.exe/bash) to invoke an item. But what if we assign PowerShell as default shell? Infinite cycle? \r\nIt seems we need to review all places where we fallback to default shell to understand the consequences.\r\n",
    "created_at": "2020-10-06T14:52:20Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/13750#issuecomment-704323976",
    "id": 704323976,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13750",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwNDMyMzk3Ng==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/704323976/reactions"
    },
    "updated_at": "2020-10-06T14:52:20Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/704323976",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@iSazonov can you point me to what code you are referring to?",
    "created_at": "2020-10-06T15:20:45Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/13750#issuecomment-704345895",
    "id": 704345895,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13750",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwNDM0NTg5NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/704345895/reactions"
    },
    "updated_at": "2020-10-06T15:20:45Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/704345895",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "In the context - line 488. If UseShellExecute is true we call PowerShell again?",
    "created_at": "2020-10-06T15:36:28Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/13750#issuecomment-704357053",
    "id": 704357053,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13750",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwNDM1NzA1Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/704357053/reactions"
    },
    "updated_at": "2020-10-06T15:36:28Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/704357053",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@iSazonov that line with UseShellExecute only starts a new process if the previous attempt fails because it's not an executable and isn't associated with an executable so it tries to let the Shell try to start it.  I don't see the problem.",
    "created_at": "2020-10-06T15:45:45Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/13750#issuecomment-704364922",
    "id": 704364922,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13750",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwNDM2NDkyMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/704364922/reactions"
    },
    "updated_at": "2020-10-06T15:45:45Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/704364922",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "I mean the code\r\nhttps://github.com/PowerShell/PowerShell/blob/f2a37164bfb321f5218cea25ed1d1cf8b284961c/src/System.Management.Automation/engine/NativeCommandProcessor.cs#L478-L490\r\n\r\nIf PowerShell is default shell the code will run PowerShell again and again.",
    "created_at": "2020-10-06T15:58:13Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/13750#issuecomment-704379433",
    "id": 704379433,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13750",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwNDM3OTQzMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/704379433/reactions"
    },
    "updated_at": "2020-10-06T16:00:23Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/704379433",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@iSazonov ok, now I see what you mean.  However, on my macBook I can see that Process.Start() doesn't start a new shell to run the exe.",
    "created_at": "2020-10-06T16:04:15Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/13750#issuecomment-704383231",
    "id": 704383231,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13750",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwNDM4MzIzMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/704383231/reactions"
    },
    "updated_at": "2020-10-06T16:04:15Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/704383231",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "I'd expect the cycle with:\r\n1. Set PowerShell as default shell\r\n2. Run PowerShell unelevated\r\n3. Run diskmgmt.msc\r\n\r\nIn line 534 we will have UseShellExecute = true and run PowerShell again.",
    "created_at": "2020-10-06T18:06:22Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/13750#issuecomment-704452444",
    "id": 704452444,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13750",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwNDQ1MjQ0NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/704452444/reactions"
    },
    "updated_at": "2020-10-06T18:06:22Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/704452444",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@iSazonov perhaps you can open a new issue to discuss that specific concern, I don't see additional pwsh processes, however",
    "created_at": "2020-10-06T20:23:11Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/13750#issuecomment-704531904",
    "id": 704531904,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13750",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwNDUzMTkwNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/704531904/reactions"
    },
    "updated_at": "2020-10-06T20:23:11Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/704531904",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@SteveL-MSFT I looked at the UseShellExecute implementation. It does not use a call to default shell. On Windows it uses ShellExecuteEx P/Invoke, on Unix it uses x-bit. So the cycle would be only if PowerShell associated with the extension or file.\r\nOn Windows this is an incredible scenario. On Unix the code path is blocked in line 494.\r\nOn Unix I still had a concern because in line 488 UseShellExecute is false and Process.Start will just fork and execute - if the file has `#!pwsh` in header the pwsh would run again but I tried on WSL without problems. So the question is closed.\r\n\r\n",
    "created_at": "2020-10-07T07:57:33Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/13750#issuecomment-704764499",
    "id": 704764499,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13750",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwNDc2NDQ5OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/704764499/reactions"
    },
    "updated_at": "2020-10-07T07:57:33Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/704764499",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": ":tada:`v7.1.0-rc.2` has been released which incorporates this pull request.:tada:\n\nHandy links:\n* [Release Notes](https://github.com/PowerShell/PowerShell/releases/tag/v7.1.0-rc.2)\n",
    "created_at": "2020-10-21T19:08:29Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/13750#issuecomment-713814365",
    "id": 713814365,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13750",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxMzgxNDM2NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/713814365/reactions"
    },
    "updated_at": "2020-10-21T19:08:29Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/713814365",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  },
  {
    "author_association": "NONE",
    "body": ":tada:`v7.2.0-preview.1` has been released which incorporates this pull request.:tada:\n\nHandy links:\n* [Release Notes](https://github.com/PowerShell/PowerShell/releases/tag/v7.2.0-preview.1)\n",
    "created_at": "2020-11-17T23:02:06Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/13750#issuecomment-729266073",
    "id": 729266073,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13750",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyOTI2NjA3Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/729266073/reactions"
    },
    "updated_at": "2020-11-17T23:02:06Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/729266073",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  },
  {
    "author_association": "NONE",
    "body": "Is this in 7.1 stable? I don't see a revert to this commit in the diff log between 7.1 and 7.1-rc2, but it's re-incorporated in 7.2 preview 1.",
    "created_at": "2020-12-12T05:18:57Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/13750#issuecomment-743705461",
    "id": 743705461,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13750",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0MzcwNTQ2MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/743705461/reactions"
    },
    "updated_at": "2020-12-12T05:18:57Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/743705461",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/53661808?v=4",
      "events_url": "https://api.github.com/users/ImportTaste/events{/privacy}",
      "followers_url": "https://api.github.com/users/ImportTaste/followers",
      "following_url": "https://api.github.com/users/ImportTaste/following{/other_user}",
      "gists_url": "https://api.github.com/users/ImportTaste/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ImportTaste",
      "id": 53661808,
      "login": "ImportTaste",
      "node_id": "MDQ6VXNlcjUzNjYxODA4",
      "organizations_url": "https://api.github.com/users/ImportTaste/orgs",
      "received_events_url": "https://api.github.com/users/ImportTaste/received_events",
      "repos_url": "https://api.github.com/users/ImportTaste/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ImportTaste/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ImportTaste/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ImportTaste"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "It was included in v7.2.0-preview.1. You can check that 7.1 works well in the scenario.",
    "created_at": "2020-12-12T06:39:02Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/13750#issuecomment-743713201",
    "id": 743713201,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13750",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0MzcxMzIwMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/743713201/reactions"
    },
    "updated_at": "2020-12-12T06:39:02Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/743713201",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "> It was included in v7.2.0-preview.1. You can check that 7.1 works well in the scenario.\r\n\r\nSo... both versions have it?",
    "created_at": "2020-12-12T07:35:36Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/13750#issuecomment-743718500",
    "id": 743718500,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13750",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0MzcxODUwMA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/743718500/reactions"
    },
    "updated_at": "2020-12-12T07:35:36Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/743718500",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/53661808?v=4",
      "events_url": "https://api.github.com/users/ImportTaste/events{/privacy}",
      "followers_url": "https://api.github.com/users/ImportTaste/followers",
      "following_url": "https://api.github.com/users/ImportTaste/following{/other_user}",
      "gists_url": "https://api.github.com/users/ImportTaste/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ImportTaste",
      "id": 53661808,
      "login": "ImportTaste",
      "node_id": "MDQ6VXNlcjUzNjYxODA4",
      "organizations_url": "https://api.github.com/users/ImportTaste/orgs",
      "received_events_url": "https://api.github.com/users/ImportTaste/received_events",
      "repos_url": "https://api.github.com/users/ImportTaste/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ImportTaste/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ImportTaste/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ImportTaste"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Yes, both.",
    "created_at": "2020-12-12T08:02:11Z",
    "html_url": "https://github.com/PowerShell/PowerShell/pull/13750#issuecomment-743721022",
    "id": 743721022,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13750",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0MzcyMTAyMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/743721022/reactions"
    },
    "updated_at": "2020-12-12T08:02:11Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/743721022",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  }
]

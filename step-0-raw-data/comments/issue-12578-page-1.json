[
  {
    "author_association": "NONE",
    "body": "If you execute this command on PowerShell 7 x86, it works : \r\n```\r\n$Method = @{\r\n    ClassName = \"MSFT_OdbcDsnTask\"\r\n    Namespace = \"ROOT\\Microsoft\\Windows\\Wdac\"\r\n    MethodName = \"Add\" \r\n}\r\nInvoke-CimMethod @Method -Arguments @{\r\n    Name       = \"test_{0}\" -f [guid]::NewGuid().Guid.Split('-')[0]\r\n    DsnType    = \"User\"\r\n    Platform   = \"32-bit\"\r\n    DriverName = \"Microsoft Access Driver (*.mdb)\"\r\n}\r\n```\r\n\r\n\r\n",
    "created_at": "2020-05-05T17:02:59Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12578#issuecomment-624180640",
    "id": 624180640,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12578",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNDE4MDY0MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 1,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624180640/reactions"
    },
    "updated_at": "2020-05-05T17:02:59Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624180640",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6187529?v=4",
      "events_url": "https://api.github.com/users/fMichaleczek/events{/privacy}",
      "followers_url": "https://api.github.com/users/fMichaleczek/followers",
      "following_url": "https://api.github.com/users/fMichaleczek/following{/other_user}",
      "gists_url": "https://api.github.com/users/fMichaleczek/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/fMichaleczek",
      "id": 6187529,
      "login": "fMichaleczek",
      "node_id": "MDQ6VXNlcjYxODc1Mjk=",
      "organizations_url": "https://api.github.com/users/fMichaleczek/orgs",
      "received_events_url": "https://api.github.com/users/fMichaleczek/received_events",
      "repos_url": "https://api.github.com/users/fMichaleczek/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/fMichaleczek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fMichaleczek/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/fMichaleczek"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": " I guess arguments is not right. You could try wmic utility.",
    "created_at": "2020-05-05T17:29:55Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12578#issuecomment-624198009",
    "id": 624198009,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12578",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNDE5ODAwOQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624198009/reactions"
    },
    "updated_at": "2020-05-05T17:29:55Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624198009",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "This works on PowerShell 7 x86 and x64 : \r\n`Import-Module C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\Modules\\Wdac\\Wdac.psd1`\r\n\r\n<del>but only PowerShell 7 x86 is able to modify 32-bit platform and only PowerShell 7 x64 for 64-bit platform. On PowerShell 5.1 x64 , i am able to do both. </del>",
    "created_at": "2020-05-05T17:30:59Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12578#issuecomment-624198633",
    "id": 624198633,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12578",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNDE5ODYzMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 1,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624198633/reactions"
    },
    "updated_at": "2020-05-05T17:58:40Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624198633",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6187529?v=4",
      "events_url": "https://api.github.com/users/fMichaleczek/events{/privacy}",
      "followers_url": "https://api.github.com/users/fMichaleczek/followers",
      "following_url": "https://api.github.com/users/fMichaleczek/following{/other_user}",
      "gists_url": "https://api.github.com/users/fMichaleczek/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/fMichaleczek",
      "id": 6187529,
      "login": "fMichaleczek",
      "node_id": "MDQ6VXNlcjYxODc1Mjk=",
      "organizations_url": "https://api.github.com/users/fMichaleczek/orgs",
      "received_events_url": "https://api.github.com/users/fMichaleczek/received_events",
      "repos_url": "https://api.github.com/users/fMichaleczek/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/fMichaleczek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fMichaleczek/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/fMichaleczek"
    }
  },
  {
    "author_association": "NONE",
    "body": "|                    | 32bits driver via Invoke-CimMethod                           | 64bits driver via Invoke-CimMethod                           | 32bits driver via cdxml | 64bits driver via cdxml |\r\n| ------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ----------------------- | ----------------------- |\r\n| PowerShell 5.1 x86 | OK                                                           | Failed (Invoke-CimMethod : The requested object could not be found) | OK                      | OK                      |\r\n| PowerShell 5.1 x64 | Failed (Invoke-CimMethod : The requested object could not be found) | OK                                                           | OK                      | OK                      |\r\n| PowerShell 7.1 x86 | OK                                                           | Failed (Invoke-CimMethod : The requested object could not be found) | OK                      | OK                      |\r\n| PowerShell 7.1 x64 | Failed (Invoke-CimMethod : The requested object could not be found) | OK                                                           | OK                      | OK                      |\r\n\r\n\r\n**Driver x64 : Microsoft Access Driver (\\*.mdb, \\*.accdb)**\r\n\r\n```\r\n$Method = @{\r\n    ClassName = \"MSFT_OdbcDsnTask\"\r\n    Namespace = \"ROOT\\Microsoft\\Windows\\Wdac\"\r\n    MethodName = \"Add\" \r\n}\r\nInvoke-CimMethod @Method -Arguments @{\r\n    Name       = \"test_{0}\" -f [guid]::NewGuid().Guid.Split('-')[0]\r\n    DsnType    = \"User\"\r\n    Platform   = \"64-bit\"\r\n    DriverName = \"Microsoft Access Driver (*.mdb, *.accdb)\"\r\n}\r\n```\r\n\r\n```\r\nImport-Module C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\Modules\\Wdac\\Wdac.psd1\r\n\r\nAdd-OdbcDsn -Name (\"test_{0}\" -f [guid]::NewGuid().Guid.Split('-')[0]) -Platform 64-bit -DsnType User -DriverName \"Microsoft Access Driver (*.mdb, *.accdb)\"\r\n```\r\n\r\n**Drive x86 : Microsoft Access Driver (*.mdb)**\r\n\r\n```\r\n$Method = @{\r\n    ClassName = \"MSFT_OdbcDsnTask\"\r\n    Namespace = \"ROOT\\Microsoft\\Windows\\Wdac\"\r\n    MethodName = \"Add\" \r\n}\r\nInvoke-CimMethod @Method -Arguments @{\r\n    Name       = \"test_{0}\" -f [guid]::NewGuid().Guid.Split('-')[0]\r\n    DsnType    = \"User\"\r\n    Platform   = \"32-bit\"\r\n    DriverName = \"Microsoft Access Driver (*.mdb)\"\r\n}\r\n```\r\n\r\n```\r\nImport-Module C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\Modules\\Wdac\\Wdac.psd1\r\nAdd-OdbcDsn -Name (\"test_{0}\" -f [guid]::NewGuid().Guid.Split('-')[0]) -Platform 32-bit -DsnType User -DriverName \"Microsoft Access Driver (*.mdb)\"\r\n```",
    "created_at": "2020-05-05T18:00:56Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12578#issuecomment-624214200",
    "id": 624214200,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12578",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNDIxNDIwMA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624214200/reactions"
    },
    "updated_at": "2020-05-05T18:00:56Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624214200",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6187529?v=4",
      "events_url": "https://api.github.com/users/fMichaleczek/events{/privacy}",
      "followers_url": "https://api.github.com/users/fMichaleczek/followers",
      "following_url": "https://api.github.com/users/fMichaleczek/following{/other_user}",
      "gists_url": "https://api.github.com/users/fMichaleczek/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/fMichaleczek",
      "id": 6187529,
      "login": "fMichaleczek",
      "node_id": "MDQ6VXNlcjYxODc1Mjk=",
      "organizations_url": "https://api.github.com/users/fMichaleczek/orgs",
      "received_events_url": "https://api.github.com/users/fMichaleczek/received_events",
      "repos_url": "https://api.github.com/users/fMichaleczek/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/fMichaleczek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fMichaleczek/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/fMichaleczek"
    }
  },
  {
    "author_association": "NONE",
    "body": "@alx9r if you import directly the module, everything is working :) ",
    "created_at": "2020-05-05T18:02:06Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12578#issuecomment-624214845",
    "id": 624214845,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12578",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNDIxNDg0NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624214845/reactions"
    },
    "updated_at": "2020-05-05T18:02:06Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624214845",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6187529?v=4",
      "events_url": "https://api.github.com/users/fMichaleczek/events{/privacy}",
      "followers_url": "https://api.github.com/users/fMichaleczek/followers",
      "following_url": "https://api.github.com/users/fMichaleczek/following{/other_user}",
      "gists_url": "https://api.github.com/users/fMichaleczek/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/fMichaleczek",
      "id": 6187529,
      "login": "fMichaleczek",
      "node_id": "MDQ6VXNlcjYxODc1Mjk=",
      "organizations_url": "https://api.github.com/users/fMichaleczek/orgs",
      "received_events_url": "https://api.github.com/users/fMichaleczek/received_events",
      "repos_url": "https://api.github.com/users/fMichaleczek/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/fMichaleczek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fMichaleczek/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/fMichaleczek"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "For Microsoft Excel Driver (*.xls) too?",
    "created_at": "2020-05-05T18:07:41Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12578#issuecomment-624217867",
    "id": 624217867,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12578",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNDIxNzg2Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624217867/reactions"
    },
    "updated_at": "2020-05-05T18:07:41Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624217867",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "@iSazonov Yes. ",
    "created_at": "2020-05-05T18:15:18Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12578#issuecomment-624221883",
    "id": 624221883,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12578",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNDIyMTg4Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624221883/reactions"
    },
    "updated_at": "2020-05-05T18:15:18Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624221883",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6187529?v=4",
      "events_url": "https://api.github.com/users/fMichaleczek/events{/privacy}",
      "followers_url": "https://api.github.com/users/fMichaleczek/followers",
      "following_url": "https://api.github.com/users/fMichaleczek/following{/other_user}",
      "gists_url": "https://api.github.com/users/fMichaleczek/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/fMichaleczek",
      "id": 6187529,
      "login": "fMichaleczek",
      "node_id": "MDQ6VXNlcjYxODc1Mjk=",
      "organizations_url": "https://api.github.com/users/fMichaleczek/orgs",
      "received_events_url": "https://api.github.com/users/fMichaleczek/received_events",
      "repos_url": "https://api.github.com/users/fMichaleczek/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/fMichaleczek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fMichaleczek/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/fMichaleczek"
    }
  },
  {
    "author_association": "NONE",
    "body": "@fMichaleczek \r\n\r\nInvoking `pwsh { Import-Module C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\Modules\\Wdac\\Wdac.psd1 }` on this computer results in the following error using both 7.0.0 and 7.1.0:\r\n\r\n`Import-Module: Failed to generate proxies for remote module 'Wdac'. Running the Get-FormatData command in a remote session reported the following error: Unable to cast object of type 'Microsoft.PowerShell.Commands.Internal.Format.ControlReference' to type 'Microsoft.PowerShell.Commands.Internal.Format.ComplexControlBody'..`\r\n\r\nThat is the same error as #12427 using `Import-Module -UseWindowsPowerShell`.  \r\n\r\nI wonder what the difference is that it works on your computer but not here.",
    "created_at": "2020-05-05T20:45:38Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12578#issuecomment-624296486",
    "id": 624296486,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12578",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNDI5NjQ4Ng==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624296486/reactions"
    },
    "updated_at": "2020-05-05T20:45:38Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624296486",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11237922?v=4",
      "events_url": "https://api.github.com/users/alx9r/events{/privacy}",
      "followers_url": "https://api.github.com/users/alx9r/followers",
      "following_url": "https://api.github.com/users/alx9r/following{/other_user}",
      "gists_url": "https://api.github.com/users/alx9r/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/alx9r",
      "id": 11237922,
      "login": "alx9r",
      "node_id": "MDQ6VXNlcjExMjM3OTIy",
      "organizations_url": "https://api.github.com/users/alx9r/orgs",
      "received_events_url": "https://api.github.com/users/alx9r/received_events",
      "repos_url": "https://api.github.com/users/alx9r/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/alx9r/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alx9r/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/alx9r"
    }
  },
  {
    "author_association": "NONE",
    "body": "> I wonder what the difference is that it works on your computer but not here.\r\n\r\nMy OS Version : Windows 10 18363\r\n```\r\nPS C:\\Users\\LEXPEC> $PSVersionTable\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.0.0\r\nPSEdition                      Core\r\nGitCommitId                    7.0.0\r\nOS                             Microsoft Windows 10.0.18363\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0…}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n",
    "created_at": "2020-05-06T04:56:03Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12578#issuecomment-624441333",
    "id": 624441333,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12578",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNDQ0MTMzMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624441333/reactions"
    },
    "updated_at": "2020-05-06T04:56:03Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624441333",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6187529?v=4",
      "events_url": "https://api.github.com/users/fMichaleczek/events{/privacy}",
      "followers_url": "https://api.github.com/users/fMichaleczek/followers",
      "following_url": "https://api.github.com/users/fMichaleczek/following{/other_user}",
      "gists_url": "https://api.github.com/users/fMichaleczek/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/fMichaleczek",
      "id": 6187529,
      "login": "fMichaleczek",
      "node_id": "MDQ6VXNlcjYxODc1Mjk=",
      "organizations_url": "https://api.github.com/users/fMichaleczek/orgs",
      "received_events_url": "https://api.github.com/users/fMichaleczek/received_events",
      "repos_url": "https://api.github.com/users/fMichaleczek/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/fMichaleczek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fMichaleczek/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/fMichaleczek"
    }
  },
  {
    "author_association": "NONE",
    "body": "I try on a Windows 2012R2, it works as expected with this command\r\n\r\n```\r\nImport-Module Wdac -SkipEditionCheck\r\n```\r\nI test Add-OdbcDsn/Get-OdbcDns successly. \r\n",
    "created_at": "2020-05-06T05:46:40Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12578#issuecomment-624453737",
    "id": 624453737,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12578",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNDQ1MzczNw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624453737/reactions"
    },
    "updated_at": "2020-05-06T05:46:40Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624453737",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6187529?v=4",
      "events_url": "https://api.github.com/users/fMichaleczek/events{/privacy}",
      "followers_url": "https://api.github.com/users/fMichaleczek/followers",
      "following_url": "https://api.github.com/users/fMichaleczek/following{/other_user}",
      "gists_url": "https://api.github.com/users/fMichaleczek/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/fMichaleczek",
      "id": 6187529,
      "login": "fMichaleczek",
      "node_id": "MDQ6VXNlcjYxODc1Mjk=",
      "organizations_url": "https://api.github.com/users/fMichaleczek/orgs",
      "received_events_url": "https://api.github.com/users/fMichaleczek/received_events",
      "repos_url": "https://api.github.com/users/fMichaleczek/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/fMichaleczek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fMichaleczek/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/fMichaleczek"
    }
  },
  {
    "author_association": "NONE",
    "body": "@iSazonov I see you have added the \"Resolution Answered\".  The original question has not been answered.  All we have is an irreplicable workaround for #12427, which is a different issue.  As far as I can tell this original question remains.",
    "created_at": "2020-05-06T15:22:29Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12578#issuecomment-624714739",
    "id": 624714739,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12578",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNDcxNDczOQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624714739/reactions"
    },
    "updated_at": "2020-05-06T15:26:34Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624714739",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11237922?v=4",
      "events_url": "https://api.github.com/users/alx9r/events{/privacy}",
      "followers_url": "https://api.github.com/users/alx9r/followers",
      "following_url": "https://api.github.com/users/alx9r/following{/other_user}",
      "gists_url": "https://api.github.com/users/alx9r/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/alx9r",
      "id": 11237922,
      "login": "alx9r",
      "node_id": "MDQ6VXNlcjExMjM3OTIy",
      "organizations_url": "https://api.github.com/users/alx9r/orgs",
      "received_events_url": "https://api.github.com/users/alx9r/received_events",
      "repos_url": "https://api.github.com/users/alx9r/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/alx9r/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alx9r/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/alx9r"
    }
  },
  {
    "author_association": "NONE",
    "body": "The behaviour for Invoke-CimMethod and wmic.exe are identical.\r\n\r\n```\r\nC:\\Windows\\system32\\wbem\\wmic.exe /namespace:\\\\ROOT\\Microsoft\\Windows\\Wdac CLASS MSFT_OdbcDsnTask CALL Add DriverName=\"Microsoft Access Driver (*.mdb)\" DsnType=\"User\" Name=\"test123\" Platform=\"32-bit\"\r\n\r\nExecuting (MSFT_OdbcDsnTask)->Add()\r\nERROR:\r\nDescription = Not found\r\n\r\nC:\\Windows\\syswow64\\wbem\\wmic.exe /namespace:\\\\ROOT\\Microsoft\\Windows\\Wdac CLASS MSFT_OdbcDsnTask CALL Add DriverName=\"Microsoft Access Driver (*.mdb)\" DsnType=\"User\" Name=\"test987\" Platform=\"32-bit\"`\r\n\r\nExecuting (MSFT_OdbcDsnTask)->Add()\r\nMethod execution successful.\r\nOut Parameters:[abstract]\r\nclass __PARAMETERS\r\n{\r\n        [out] uint32 ReturnValue = 0;\r\n};\r\n\r\n```",
    "created_at": "2020-05-06T16:40:14Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12578#issuecomment-624758703",
    "id": 624758703,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12578",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNDc1ODcwMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 1,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624758703/reactions"
    },
    "updated_at": "2020-05-06T16:40:14Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624758703",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6187529?v=4",
      "events_url": "https://api.github.com/users/fMichaleczek/events{/privacy}",
      "followers_url": "https://api.github.com/users/fMichaleczek/followers",
      "following_url": "https://api.github.com/users/fMichaleczek/following{/other_user}",
      "gists_url": "https://api.github.com/users/fMichaleczek/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/fMichaleczek",
      "id": 6187529,
      "login": "fMichaleczek",
      "node_id": "MDQ6VXNlcjYxODc1Mjk=",
      "organizations_url": "https://api.github.com/users/fMichaleczek/orgs",
      "received_events_url": "https://api.github.com/users/fMichaleczek/received_events",
      "repos_url": "https://api.github.com/users/fMichaleczek/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/fMichaleczek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fMichaleczek/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/fMichaleczek"
    }
  },
  {
    "author_association": "NONE",
    "body": "@fMichaleczek \r\n\r\n>The behaviour for Invoke-CimMethod and wmic.exe are identical.\r\n\r\nI'm not surprised.  That suggests `Add-OdbcDsn` is doing somewhat more than simply passing the arguments through to the system call.  I've been reading through the files in `C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\Modules\\Wdac` but I haven't puzzled out how PowerShell interprets those files to make the system calls.  Do you have any insight there?",
    "created_at": "2020-05-06T16:48:11Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12578#issuecomment-624763022",
    "id": 624763022,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12578",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNDc2MzAyMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624763022/reactions"
    },
    "updated_at": "2020-05-06T16:48:11Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624763022",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11237922?v=4",
      "events_url": "https://api.github.com/users/alx9r/events{/privacy}",
      "followers_url": "https://api.github.com/users/alx9r/followers",
      "following_url": "https://api.github.com/users/alx9r/following{/other_user}",
      "gists_url": "https://api.github.com/users/alx9r/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/alx9r",
      "id": 11237922,
      "login": "alx9r",
      "node_id": "MDQ6VXNlcjExMjM3OTIy",
      "organizations_url": "https://api.github.com/users/alx9r/orgs",
      "received_events_url": "https://api.github.com/users/alx9r/received_events",
      "repos_url": "https://api.github.com/users/alx9r/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/alx9r/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alx9r/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/alx9r"
    }
  },
  {
    "author_association": "NONE",
    "body": "@alx9r \"Cmdlet definition XML (CDXML) is a way to create a Windows PowerShell module from a WMI class by using the cmdlets-over-objects technology that was introduced in Windows PowerShell 3.0\"\r\nhttps://devblogs.microsoft.com/scripting/registry-cmdlets-first-steps-with-cdxml/\r\n\r\nIt's deep inside the OS, in my opinion, these CIM classes has been made to be consume by CDXML first (see bellow [OUT]cmdletOutput(array of object:MSFT_OdbcDsn) ) . It's why, it will hard to diagnostic more. You can import WDAC module natively (SkipEdition has been added for that), so i don't see what to do more. At the end, you have a solution to move on this problem.  I let you test more, because I only take my free time to give you a way. \r\n\r\n\r\n```\r\nC:\\Windows\\system32\\wbem\\wmic.exe /namespace:\\\\ROOT\\Microsoft\\Windows\\Wdac CLASS MSFT_OdbcDsnTask CALL /?\r\n\r\nThe following verb(s)/method(s) are available:\r\n\r\nCall                    [ In/Out ]Params&type                   Status\r\n====                    =====================                   ======\r\nAdd                     [IN ]DriverName(string)                 Implemented\r\n\r\n                        [IN ]DsnType(string)\r\n\r\n                        [IN ]Name(string)\r\n\r\n                        [IN ]PassThru(boolean)\r\n\r\n                        [IN ]Platform(string)\r\n\r\n                        [IN ]SetPropertyValue(array of string)\r\n\r\n                        [OUT]cmdletOutput(array of object:MSFT_OdbcDsn)\r\n\r\n                        [OUT]ReturnValue(uint32)\r\n```\n\n<blockquote><div><img src=\"https://devblogs.microsoft.com/scripting/wp-content/uploads/sites/29/2018/10/Microsoft-Favicon.png\" height=\"14\"> Scripting Blog</div><div><strong><a href=\"https://devblogs.microsoft.com/scripting/registry-cmdlets-first-steps-with-cdxml/\">Registry Cmdlets: First Steps with CDXML | Scripting Blog</a></strong></div><div>Summary: Richard Siddaway shows how to start creating CDXML cmdlets.\nHonorary Scripting Guy, Richard Siddaway, here today filling in for my good friend, The Scripting Guy. This is the second post in a series. Yesterday, in Registry Cmdlets: Working with the Registry,</div></blockquote>",
    "created_at": "2020-05-06T17:01:10Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12578#issuecomment-624769890",
    "id": 624769890,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12578",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNDc2OTg5MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624769890/reactions"
    },
    "updated_at": "2020-05-06T17:01:15Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624769890",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6187529?v=4",
      "events_url": "https://api.github.com/users/fMichaleczek/events{/privacy}",
      "followers_url": "https://api.github.com/users/fMichaleczek/followers",
      "following_url": "https://api.github.com/users/fMichaleczek/following{/other_user}",
      "gists_url": "https://api.github.com/users/fMichaleczek/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/fMichaleczek",
      "id": 6187529,
      "login": "fMichaleczek",
      "node_id": "MDQ6VXNlcjYxODc1Mjk=",
      "organizations_url": "https://api.github.com/users/fMichaleczek/orgs",
      "received_events_url": "https://api.github.com/users/fMichaleczek/received_events",
      "repos_url": "https://api.github.com/users/fMichaleczek/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/fMichaleczek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fMichaleczek/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/fMichaleczek"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "wmic shows that the error comes from Windows and you should ask Windows team.\r\nOr reverse engineering Add-OdbcDsn.\r\nYou could use WMI tracing https://docs.microsoft.com/en-us/windows/win32/wmisdk/tracing-wmi-activity\n\n<blockquote><div><strong><a href=\"https://docs.microsoft.com/en-us/windows/win32/wmisdk/tracing-wmi-activity\">Tracing WMI Activity - Win32 apps</a></strong></div><div>Starting with Windows Vista, the WMI service does not use the WMI Log Files. Instead, it uses Event Tracing for Windows (ETW) and events are available through Event Viewer or the Wevtutil command-line tool.</div></blockquote>",
    "created_at": "2020-05-06T17:12:33Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12578#issuecomment-624775590",
    "id": 624775590,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12578",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNDc3NTU5MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624775590/reactions"
    },
    "updated_at": "2020-05-06T17:12:35Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624775590",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": ">It's deep inside the OS, in my opinion, these CIM classes has been made to be consume by CDXML first (see bellow [OUT]cmdletOutput(array of object:MSFT_OdbcDsn) ) . It's why, it will hard to diagnostic more. \r\n\r\nI see.\r\n\r\n>You can import WDAC module natively (SkipEdition has been added for that)\r\n\r\nI agree.  Thank you for pointing out that flag.  I have `Import-Module Wdac -SkipEditionCheck` working here and it's looking promising that that will ultimately be the solution.  \r\n\r\nI'm not entirely comfortable that the original question does not have an answer.  It means that we don't have a fallback when transitioning WMI/CIM functionality we have in Windows PowerShell to PowerShell 7.  Being able to trace the WMI/CIM system calls that a module working under Windows PowerShell performs would have meant that the worst-case scenario would be to rewrite something to make those same system calls in PowerShell 7.  But it looks like that capability doesn't exist.  That suggests either a lot of regression of WMI/CIM management ability from Windows PowerShell to PowerShell 7 or indefinite dependence on remoting into Windows PowerShell to get the job done.",
    "created_at": "2020-05-06T17:12:58Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12578#issuecomment-624775833",
    "id": 624775833,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12578",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNDc3NTgzMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624775833/reactions"
    },
    "updated_at": "2020-05-06T17:19:39Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624775833",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11237922?v=4",
      "events_url": "https://api.github.com/users/alx9r/events{/privacy}",
      "followers_url": "https://api.github.com/users/alx9r/followers",
      "following_url": "https://api.github.com/users/alx9r/following{/other_user}",
      "gists_url": "https://api.github.com/users/alx9r/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/alx9r",
      "id": 11237922,
      "login": "alx9r",
      "node_id": "MDQ6VXNlcjExMjM3OTIy",
      "organizations_url": "https://api.github.com/users/alx9r/orgs",
      "received_events_url": "https://api.github.com/users/alx9r/received_events",
      "repos_url": "https://api.github.com/users/alx9r/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/alx9r/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alx9r/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/alx9r"
    }
  },
  {
    "author_association": "NONE",
    "body": ">You could use WMI tracing...\r\n\r\nI can see the log events of the calls in `Microsoft/Windows/Wmi-Activity/Trace` and `/Debug` but none of those events reveal the arguments, at least not to the degree that the difference between `Add-OdbcDsn` and `Invoke-CimMethod` are apparent.",
    "created_at": "2020-05-06T17:17:29Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12578#issuecomment-624778124",
    "id": 624778124,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12578",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNDc3ODEyNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624778124/reactions"
    },
    "updated_at": "2020-05-06T17:17:29Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/624778124",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11237922?v=4",
      "events_url": "https://api.github.com/users/alx9r/events{/privacy}",
      "followers_url": "https://api.github.com/users/alx9r/followers",
      "following_url": "https://api.github.com/users/alx9r/following{/other_user}",
      "gists_url": "https://api.github.com/users/alx9r/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/alx9r",
      "id": 11237922,
      "login": "alx9r",
      "node_id": "MDQ6VXNlcjExMjM3OTIy",
      "organizations_url": "https://api.github.com/users/alx9r/orgs",
      "received_events_url": "https://api.github.com/users/alx9r/received_events",
      "repos_url": "https://api.github.com/users/alx9r/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/alx9r/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alx9r/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/alx9r"
    }
  },
  {
    "author_association": "NONE",
    "body": "> reverse engineering Add-OdbcDsn\r\n\r\nThis is a minimal version of Add-OdbcDsn : \r\n\r\n```\r\nfunction Add-CustomOdbcDsn {\r\n    param(\r\n        [Parameter(Mandatory, Position=0)]\r\n        [ValidateLength(1, 32)]\r\n        [ValidateNotNullOrEmpty()]\r\n        [string]\r\n        $Name,\r\n\r\n        [Parameter(Mandatory)]\r\n        [ValidateNotNullOrEmpty()]\r\n        [string]\r\n        $DriverName,\r\n\r\n        [Parameter(Mandatory)]\r\n        [ValidateNotNullOrEmpty()]\r\n        [ValidateSet('32-bit','64-bit')]\r\n        [string]\r\n        $Platform,\r\n\r\n        [Parameter(Mandatory)]\r\n        [ValidateNotNullOrEmpty()]\r\n        [ValidateSet('User','System')]\r\n        [string]\r\n        $DsnType\r\n    )\r\n    $className = 'Root/Microsoft/Windows/Wdac/MSFT_OdbcDsnTask'\r\n    $methodName = 'Add'\r\n    $methodParameters = [System.Collections.Generic.List[Microsoft.PowerShell.Cmdletization.MethodParameter]]$(\r\n        [Microsoft.PowerShell.Cmdletization.MethodParameter]@{Name = 'Name'; ParameterType = 'System.String'; Bindings = 'In'; Value = $Name; IsValuePresent = $true}\r\n        [Microsoft.PowerShell.Cmdletization.MethodParameter]@{Name = 'DriverName'; ParameterType = 'System.String'; Bindings = 'In'; Value = $DriverName; IsValuePresent = $true}\r\n        [Microsoft.PowerShell.Cmdletization.MethodParameter]@{Name = 'Platform'; ParameterType = 'System.String'; Bindings = 'In'; Value = $Platform; IsValuePresent = $true}\r\n        [Microsoft.PowerShell.Cmdletization.MethodParameter]@{Name = 'DsnType'; ParameterType = 'System.String'; Bindings = 'In'; Value = $DsnType; IsValuePresent = $true}\r\n    )\r\n    $cimAdapter = [Microsoft.PowerShell.Cmdletization.Cim.CimCmdletAdapter]::new()\r\n    $cimAdapter.Initialize($PSCmdlet, $className, '1.0.0', '1.0.0', [System.Collections.Generic.Dictionary[string,string]]::new())\r\n    $cimAdapter.BeginProcessing()\r\n    $cimAdapter.ProcessRecord([Microsoft.PowerShell.Cmdletization.MethodInvocationInfo]::new($methodName, $methodParameters, $null))\r\n    $cimAdapter.EndProcessing()\r\n}\r\n\r\n\r\nAdd-CustomOdbcDsn -Name (\"Test_{0}\" -f [guid]::NewGuid().Guid.Split('-')[0]) -DriverName \"Microsoft Access Driver (*.mdb)\" -Platform \"32-bit\" -DsnType \"User\"\r\n```\r\n",
    "created_at": "2020-05-07T08:13:56Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12578#issuecomment-625102621",
    "id": 625102621,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12578",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNTEwMjYyMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/625102621/reactions"
    },
    "updated_at": "2020-05-07T08:13:56Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/625102621",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6187529?v=4",
      "events_url": "https://api.github.com/users/fMichaleczek/events{/privacy}",
      "followers_url": "https://api.github.com/users/fMichaleczek/followers",
      "following_url": "https://api.github.com/users/fMichaleczek/following{/other_user}",
      "gists_url": "https://api.github.com/users/fMichaleczek/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/fMichaleczek",
      "id": 6187529,
      "login": "fMichaleczek",
      "node_id": "MDQ6VXNlcjYxODc1Mjk=",
      "organizations_url": "https://api.github.com/users/fMichaleczek/orgs",
      "received_events_url": "https://api.github.com/users/fMichaleczek/received_events",
      "repos_url": "https://api.github.com/users/fMichaleczek/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/fMichaleczek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fMichaleczek/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/fMichaleczek"
    }
  },
  {
    "author_association": "NONE",
    "body": "Here, the WMI trace between the 2 commands (https://github.com/luctalpe/WMIMon)\r\n\r\n **Invoke-CimMethod :** (Error : The requested object could not be found.)\r\n```\r\n***** 10:17:15.030 Grp=96149 _ClientProcessId=10364 [pwsh.exe] MYCOMPUTER MYCOMPUTER\\MYUSER\r\n        IWbemServices::Connect\r\n\r\n***** 10:17:15.047 Grp=96152 Op=96153 _ClientProcessId=10364 [pwsh.exe] MYCOMPUTER MYCOMPUTER\\MYUSER\r\n        Start IWbemServices::ExecMethod - Root\\Microsoft\\Windows\\Wdac : MSFT_OdbcDsnTask::Add\r\n\r\n***** 10:17:15.185 Grp=96162 _ClientProcessId=10364 [pwsh.exe] MYCOMPUTER MYCOMPUTER\\MYUSER\r\n        IWbemServices::Connect\r\n\r\n***** 10:17:15.189 Stop Op=96162 0x0\r\n***** 10:17:15.193 Stop Op=96149 0x0\r\n***** 10:17:15.193 Stop Op=96153 0x80041002\r\n```\r\n0x80041002 => WBEM_E_NOT_FOUND\r\n\r\n**Add-CustomOdbcDsn :** (No Error)\r\n```\r\n***** 10:23:02.394 Grp=96239 _ClientProcessId=10364 [pwsh.exe] MYCOMPUTER MYCOMPUTER\\MYUSER\r\n        IWbemServices::Connect\r\n\r\n***** 10:23:02.411 Grp=96240 Op=96241 _ClientProcessId=10364 [pwsh.exe] MYCOMPUTER MYCOMPUTER\\MYUSER\r\n        Start IWbemServices::ExecMethod - Root\\Microsoft\\Windows\\Wdac : MSFT_OdbcDsnTask::Add\r\n\r\n***** 10:23:02.416 Grp=96242 Op=96243 _ClientProcessId=10428 [] MYCOMPUTER MYCOMPUTER\\MYUSER\r\n        Start IWbemServices::ExecMethod - Root\\Microsoft\\Windows\\Wdac : MSFT_OdbcDsnTask::Add\r\n\r\n***** 10:23:02.450 Stop Op=96243 0x0\r\n***** 10:23:02.452 Stop Op=96241 0x0\r\n```\n\n<blockquote><img src=\"https://avatars1.githubusercontent.com/u/12292115?s=400&v=4\" width=\"48\" align=\"right\"><div><img src=\"https://github.githubassets.com/favicons/favicon.svg\" height=\"14\"> GitHub</div><div><strong><a href=\"https://github.com/luctalpe/WMIMon\">luctalpe/WMIMon</a></strong></div><div>Tool to monitor WMI activity on Windows. Contribute to luctalpe/WMIMon development by creating an account on GitHub.</div></blockquote>",
    "created_at": "2020-05-07T08:30:45Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12578#issuecomment-625110945",
    "id": 625110945,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12578",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNTExMDk0NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/625110945/reactions"
    },
    "updated_at": "2020-05-07T08:30:47Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/625110945",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6187529?v=4",
      "events_url": "https://api.github.com/users/fMichaleczek/events{/privacy}",
      "followers_url": "https://api.github.com/users/fMichaleczek/followers",
      "following_url": "https://api.github.com/users/fMichaleczek/following{/other_user}",
      "gists_url": "https://api.github.com/users/fMichaleczek/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/fMichaleczek",
      "id": 6187529,
      "login": "fMichaleczek",
      "node_id": "MDQ6VXNlcjYxODc1Mjk=",
      "organizations_url": "https://api.github.com/users/fMichaleczek/orgs",
      "received_events_url": "https://api.github.com/users/fMichaleczek/received_events",
      "repos_url": "https://api.github.com/users/fMichaleczek/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/fMichaleczek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fMichaleczek/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/fMichaleczek"
    }
  },
  {
    "author_association": "NONE",
    "body": "@fMichaleczek I really appreciate your help.  I think you've got me on the right track.  I still haven't seen arguments, but the WMIMon reveals that Add-OdbcDsn always attempts the WMI call itself, but sometimes that call is followed by the same call by WinPrvSE.exe.  I suspect this is able to overcome the platform mismatch.\r\n\r\nI ran [this script](https://gist.github.com/alx9r/8de9f7887eb328a97301ac78cbd20d0f) and monitored the traffic with WMIMon.  The results are as follows:\r\n\r\n| id | exe Platform | Method            | DSN Platform | Result   | executables |\r\n|--  |--            |--                 |--            |--        |--           |\r\n| 1  | x86          | CimCmdletAdapter  | 32-bit       |  OK      | powershell  |\r\n| 2  | x86          | CimCmdletAdapter  | 64-bit       |           |             |\r\n| 3  | x86          | CimMethod         | 32-bit       |  OK      | powershell  |\r\n| 4  | x86          | CimMethod         | 64-bit       |          |             | \r\n| 5  | x86          | Wdac              | 32-bit       |  OK      | powershell  |\r\n| 6  | x86          | Wdac              | 64-bit       |          |             |\r\n| 7  | x64          | CimCmdletAdapter  | 32-bit       |  OK      | powershell, WinPrvSE |\r\n| 8  | x64          | CimCmdletAdapter  | 64-bit       |          |                      |\r\n| 9  | x64          | CimMethod         | 32-bit       |  The requested object could not be found. | powershell |\r\n| 10 | x64          | CimMethod         | 64-bit       |          |                      |\r\n| 11 | x64          | Wdac              | 32-bit       |  OK      | powershell, WinPrvSE |\r\n| 12 | x64          | Wdac              | 64-bit       |          |                      |\r\n\r\nNote the lines where there is a mismatch between the powershell .exe and DSN driver platforms. Success seems to be achieved by CimMethod, and CimCmdletAdapter by way of WinPrvSE.exe.  On the other hand, CimMethod does not result in traffic from WinPrvSE.exe and fails.\r\n\r\nI have not yet reproduced the corresponding results for 64-bit DSN platform because I do not have the corresponding 64-bit driver available on this system.  \r\n\r\nMy hypothesis is as follows:\r\n\r\n1. For some drivers mismatches between the powershell exe platform and DSN Driver platform result result in failed WMI calls with the error \"The requested object could not be found\".\r\n2. CimCmdletAdapter succeeds where CimMethod does not because it retries failed WMI calls via WinPrvSE.\r\n3. If the missing tests were performed using the 64-bit `Microsoft Access Driver (*.mdb)` driver we would see \"The requested object not found\" for id 4 and WinPrvSE.exe traffic for id 2 and 6.",
    "created_at": "2020-05-07T16:59:55Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12578#issuecomment-625377197",
    "id": 625377197,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12578",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNTM3NzE5Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/625377197/reactions"
    },
    "updated_at": "2020-05-07T17:03:57Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/625377197",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11237922?v=4",
      "events_url": "https://api.github.com/users/alx9r/events{/privacy}",
      "followers_url": "https://api.github.com/users/alx9r/followers",
      "following_url": "https://api.github.com/users/alx9r/following{/other_user}",
      "gists_url": "https://api.github.com/users/alx9r/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/alx9r",
      "id": 11237922,
      "login": "alx9r",
      "node_id": "MDQ6VXNlcjExMjM3OTIy",
      "organizations_url": "https://api.github.com/users/alx9r/orgs",
      "received_events_url": "https://api.github.com/users/alx9r/received_events",
      "repos_url": "https://api.github.com/users/alx9r/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/alx9r/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alx9r/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/alx9r"
    }
  },
  {
    "author_association": "NONE",
    "body": "When we try to invoke the static method *Add*, on the class *Root\\Microsoft\\Windows\\Wdac:MSFT_OdbcDsnTask* we see 2 different results between the Cmdlet *Invoke-CimMethod* and the Cmdlet *Add-OdbcDsn* from the CDXML module *WDAC*.\r\n\r\nThere is 2 API in PowerShell which use Wmi v2 aka [Microsoft.Management.Infrastructure](https://github.com/PowerShell/MMI) :\r\n\r\n- [Microsoft.Management.Infrastructure.CimCmdlets](https://github.com/PowerShell/PowerShell/tree/master/src/Microsoft.Management.Infrastructure.CimCmdlets) (Cmdlets `*`-Cim`*`)\r\n- [Microsoft.PowerShell.Cmdletization.Cim](https://github.com/PowerShell/PowerShell/tree/master/src/Microsoft.PowerShell.Commands.Management/cimSupport/cmdletization/cim) ( CDXML module)\r\n\r\nAfter a lot of reverse-engineering and debug, I found a difference between the 2 API in the use of [Microsoft.Management.Infrastructure.Options.CimOperationOptions](https://github.com/PowerShell/MMI/blob/master/src/Microsoft.Management.Infrastructure/Options/Internal/CimOperationOptions.cs) :\r\n\r\n- Microsoft.Management.Infrastructure.CimCmdlets set [WriteErrorMode](https://docs.microsoft.com/en-us/dotnet/api/microsoft.management.infrastructure.options.cimoperationoptions.writeerrormode) to CimCallbackMode.Inquire\r\n\r\n  https://github.com/PowerShell/PowerShell/blob/f4382202ae4622bf26795e29a7b39b9d7cdfb3fb/src/Microsoft.Management.Infrastructure.CimCmdlets/CimSessionProxy.cs#L623-L630\r\n\r\n  \r\n\r\n- Microsoft.PowerShell.Cmdletization.Cim set by default [WriteErrorMode](https://docs.microsoft.com/en-us/dotnet/api/microsoft.management.infrastructure.options.cimoperationoptions.writeerrormode) to CimCallbackMode.Report and use the method [SetPromptUserRegularMode](https://docs.microsoft.com/en-us/dotnet/api/microsoft.management.infrastructure.options.cimoperationoptions.setpromptuserregularmode) with parameters CimCallbackMode.Ignore and automaticConfirmation to true\r\n\r\n  https://github.com/PowerShell/PowerShell/blob/f4382202ae4622bf26795e29a7b39b9d7cdfb3fb/src/Microsoft.PowerShell.Commands.Management/cimSupport/cmdletization/cim/cimChildJobBase.cs#L473-L486 \r\n\r\n  https://github.com/PowerShell/PowerShell/blob/f4382202ae4622bf26795e29a7b39b9d7cdfb3fb/src/Microsoft.PowerShell.Commands.Management/cimSupport/cmdletization/cim/cimChildJobBase.cs#L453-L471\r\n\r\nThe API *Microsoft.Management.Infrastructure* hasn't a lot of documentation because it's a wrapper for libMI, but there is more in this documentation **[MS-WSMV]: Web Services Management Protocol Extensions for Windows Vista** :\r\n\r\n- [Interactive Prompt Requested by Robust Operation](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-wsmv/2a385add-7eb8-4432-ae80-ce0f10a38bdc)\r\n- [Options for CIM/WMI Operations with PowerShell Semantics](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-wsmv/1bcf0ed8-3511-4ea9-9c55-bdfcf4e3f4bd)\r\n\r\nIf I understand the problem correctly, \"Invoke-Method\" doesn't handle interactive prompt while the Cmdletization.Cim API handle a little bit better (depending of ErrorActionPreference value) and at least configure prompt to response automatically by default.\r\n\r\nCurrently, I don't have enough perspective to know if it impacts more than the Wdac namespace, but at least, we have an explanation on the differences in behavior. Changing default behaviour of Invoke-CimMethod would be a breaking change, since it's identical to Invoke-WmiMethod. \r\n\r\nYou will find below the different API behaviors, this can also be useful if someone has other problems around WMI / CMI static method and want a starter pack to debug.\r\n\r\n```powershell\r\n# On a computer with Office 32-bit from a PowerShell x64\r\n\r\n$namespace  = \"Root/Microsoft/Windows/Wdac\"\r\n$className  = \"MSFT_OdbcDsnTask\"\r\n$methodName = \"Add\"\r\n$arguments  = @{\r\n    Name       = \"ExcelTest\"\r\n    DriverName = \"Microsoft Excel Driver (*.xls)\"\r\n    PassThru   = $true\r\n    Platform   = \"32-bit\"\r\n    DsnType    = \"User\"\r\n}\r\n\r\n# Wmi v1 - WMIC\r\n$arguments.Name = \"ExcelTest_{0}\" -f [guid]::NewGuid().Guid.Split('-')[0]\r\n& \"$env:windir\\system32\\wbem\\wmic.exe\" @(\r\n    '/namespace:\\\\{0}' -f $namespace.Replace('/', '\\')\r\n    'CLASS'\r\n    $className\r\n    'CALL'\r\n    'Add'\r\n    'Name=\"{0}\"' -f $arguments.Name\r\n    'DriverName=\"{0}\"' -f $arguments.DriverName \r\n    'PassThru=\"{0}\"' -f $arguments.PassThru\r\n    'Platform=\"{0}\"' -f $arguments.Platform\r\n    'DsnType=\"{0}\"' -f $arguments.DsnType\r\n)\r\n# Executing (MSFT_OdbcDsnTask)->Add()\r\n# ERROR:\r\n# Description = Not found\r\n\r\n\r\n# Wmi v1 - System.Management\r\n$arguments.Name = \"ExcelTest_{0}\" -f [guid]::NewGuid().Guid.Split('-')[0]\r\n([wmiclass]\"${namespace}:${className}\").$methodName(\r\n    $arguments.Name,\r\n    $arguments.DriverName,\r\n    $null,\r\n    $arguments.PassThru,\r\n    $arguments.Platform,\r\n    $arguments.DsnType\r\n)\r\n# MethodInvocationException: Exception calling \"Add\" : \"Not found \"\r\n\r\n\r\n# Wmi v2 - Microsoft.Management.Infrastructure.CimCmdlets\r\n$arguments.Name = \"ExcelTest_{0}\" -f [guid]::NewGuid().Guid.Split('-')[0]\r\nInvoke-CimMethod -Namespace $namespace -ClassName $className -MethodName $methodName -Arguments $arguments\r\n# Invoke-CimMethod: The requested object could not be found.\r\n\r\n\r\n# Wmi v2 - CDXML Module WDAC\r\n$arguments.Name = \"ExcelTest_{0}\" -f [guid]::NewGuid().Guid.Split('-')[0]\r\nAdd-OdbcDsn @arguments\r\n# Name       : ExcelTest_a6b6e56a\r\n# DsnType    : User\r\n# Platform   : 32-bit\r\n# DriverName : Microsoft Excel Driver (*.xls)\r\n# Attribute  : {SafeTransactions, UserCommitSync, FirstRowHasNames, Threads…}\r\n\r\n\r\n# Wmi v2 - Microsoft.PowerShell.Cmdletization.Cim\r\nfunction Invoke-CmdletizationCimMethod {\r\n    param(\r\n        [Parameter(Mandatory)] [ValidateNotNullOrEmpty()] [string] $Namespace,\r\n        [Parameter(Mandatory)] [ValidateNotNullOrEmpty()] [string] $ClassName,\r\n        [Parameter(Mandatory)] [ValidateNotNullOrEmpty()] [string] $MethodName,\r\n        [Parameter(Mandatory)] [ValidateNotNullOrEmpty()] [hashtable] $Arguments\r\n    )\r\n    $methodParameters = [System.Collections.Generic.List[Microsoft.PowerShell.Cmdletization.MethodParameter]]::new()\r\n    $Arguments.GetEnumerator().Foreach{\r\n        if ( $null -ne $_.Value) {\r\n            $methodParameters.Add([Microsoft.PowerShell.Cmdletization.MethodParameter]@{\r\n                Name = $_.Name\r\n                ParameterType = $_.Value.GetType().FullName\r\n                Bindings = 'In'\r\n                Value = $_.Value\r\n                IsValuePresent = $true\r\n            })\r\n        }\r\n    }\r\n    $methodParameters.Add([Microsoft.PowerShell.Cmdletization.MethodParameter]@{ \r\n        Name = 'CmdletOutput'\r\n        ParameterType = 'Microsoft.Management.Infrastructure.CimInstance[]'\r\n        ParameterTypeName = 'Microsoft.Management.Infrastructure.CimInstance#{0}' -f $ClassName\r\n        Bindings = 'Out'\r\n        Value = $null \r\n        IsValuePresent = $true\r\n    })\r\n    $returnValue = [Microsoft.PowerShell.Cmdletization.MethodParameter]@{ \r\n        Name = 'ReturnValue'\r\n        ParameterType = 'System.Int32'\r\n        Bindings = 'Error'\r\n        Value = $null\r\n        IsValuePresent = $false \r\n    }\r\n    $cimAdapter = [Microsoft.PowerShell.Cmdletization.Cim.CimCmdletAdapter]::new()\r\n    $cimAdapter.Initialize($PSCmdlet, \"$Namespace/$ClassName\", '1.0.0', '1.0.0', [System.Collections.Generic.Dictionary[string,string]]::new())\r\n    $cimAdapter.BeginProcessing()\r\n    $cimAdapter.ProcessRecord([Microsoft.PowerShell.Cmdletization.MethodInvocationInfo]::new($MethodName, $methodParameters, $returnValue))\r\n    $cimAdapter.EndProcessing()\r\n}\r\n$arguments.Name = \"ExcelTest_{0}\" -f [guid]::NewGuid().Guid.Split('-')[0]\r\nInvoke-CmdletizationCimMethod -Namespace $namespace -ClassName $className -MethodName $methodName -Arguments $arguments\r\n# Name       : ExcelTest_f5141a52\r\n# DsnType    : User\r\n# Platform   : 32-bit\r\n# DriverName : Microsoft Excel Driver (*.xls)\r\n# Attribute  : {SafeTransactions, UserCommitSync, FirstRowHasNames, Threads…}\r\n\r\n\r\n# Wmi v2 - Microsoft.Management.Infrastructure\r\nfunction Invoke-InfrastructureCimMethod {\r\n    param(\r\n        [Parameter(Mandatory)] [ValidateNotNullOrEmpty()] [string] $Namespace,\r\n        [Parameter(Mandatory)] [ValidateNotNullOrEmpty()] [string] $ClassName,\r\n        [Parameter(Mandatory)] [ValidateNotNullOrEmpty()] [string] $MethodName,\r\n        [Parameter(Mandatory)] [ValidateNotNullOrEmpty()] [hashtable] $Arguments,\r\n        [switch] $SetPromptUserRegularMode\r\n    )\r\n    $methodParameters = [Microsoft.Management.Infrastructure.CimMethodParametersCollection]::new()\r\n    $Arguments.GetEnumerator().Foreach{\r\n        if ( $null -ne $_.Value) {\r\n            $methodParameters.Add([Microsoft.Management.Infrastructure.CimMethodParameter]::Create(\r\n                $_.Name,\r\n                $_.Value,\r\n                [Microsoft.Management.Infrastructure.CimFlags]::None\r\n            ))\r\n        }\r\n    }\r\n    \r\n    $operationOptions = [Microsoft.Management.Infrastructure.Options.CimOperationOptions]::new()\r\n    if ($SetPromptUserRegularMode) { \r\n    \t$operationOptions.SetPromptUserRegularMode([Microsoft.Management.Infrastructure.Options.CimCallbackMode]::Ignore, $true)\r\n    \t$operationOptions.WriteErrorMode = [Microsoft.Management.Infrastructure.Options.CimCallbackMode]::Report\r\n    }\r\n    else {\r\n    \t$operationOptions.WriteErrorMode = [Microsoft.Management.Infrastructure.Options.CimCallbackMode]::Inquire\r\n    }\r\n    $cimSession = [CimSession]::Create(\".\")\r\n    $result = $cimSession.InvokeMethod($Namespace, $ClassName, $MethodName, $methodParameters, $operationOptions)\r\n    $cimSession.Dispose()\r\n    \r\n    if ($result.OutParameters) {\r\n    \t$result.OutParameters[\"cmdletOutput\"].Value\r\n    }\r\n}\r\n\r\n# Without SetPromptUserRegularMode\r\n$arguments.Name = \"ExcelTest_{0}\" -f [guid]::NewGuid().Guid.Split('-')[0]\r\nInvoke-InfrastructureCimMethod -Namespace $namespace -ClassName $className -MethodName $methodName -Arguments $arguments\r\n# Exception calling \"InvokeMethod\" with \"5\" argument(s): \"The requested object could not be found.\"\r\n\r\n\r\n# With SetPromptUserRegularMode\r\n$arguments.Name = \"ExcelTest_{0}\" -f [guid]::NewGuid().Guid.Split('-')[0]\r\nInvoke-InfrastructureCimMethod -Namespace $namespace -ClassName $className -MethodName $methodName -Arguments $arguments -SetPromptUserRegularMode\r\n# Name       : ExcelTest_d115cdfa\r\n# DsnType    : User\r\n# Platform   : 32-bit\r\n# DriverName : Microsoft Excel Driver (*.xls)\r\n# Attribute  : {SafeTransactions, UserCommitSync, FirstRowHasNames, Threads…}\r\n\r\n```\r\n",
    "created_at": "2020-05-09T17:21:18Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12578#issuecomment-626208647",
    "id": 626208647,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12578",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNjIwODY0Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/626208647/reactions"
    },
    "updated_at": "2020-05-09T18:27:24Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/626208647",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6187529?v=4",
      "events_url": "https://api.github.com/users/fMichaleczek/events{/privacy}",
      "followers_url": "https://api.github.com/users/fMichaleczek/followers",
      "following_url": "https://api.github.com/users/fMichaleczek/following{/other_user}",
      "gists_url": "https://api.github.com/users/fMichaleczek/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/fMichaleczek",
      "id": 6187529,
      "login": "fMichaleczek",
      "node_id": "MDQ6VXNlcjYxODc1Mjk=",
      "organizations_url": "https://api.github.com/users/fMichaleczek/orgs",
      "received_events_url": "https://api.github.com/users/fMichaleczek/received_events",
      "repos_url": "https://api.github.com/users/fMichaleczek/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/fMichaleczek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fMichaleczek/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/fMichaleczek"
    }
  },
  {
    "author_association": "NONE",
    "body": "@iSazonov The error doesn't come from Windows but from Invoke-CimMethod which doesn't handle the interactive prompt or automatic response. ",
    "created_at": "2020-05-09T17:35:25Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12578#issuecomment-626210502",
    "id": 626210502,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12578",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNjIxMDUwMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/626210502/reactions"
    },
    "updated_at": "2020-05-09T17:35:25Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/626210502",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6187529?v=4",
      "events_url": "https://api.github.com/users/fMichaleczek/events{/privacy}",
      "followers_url": "https://api.github.com/users/fMichaleczek/followers",
      "following_url": "https://api.github.com/users/fMichaleczek/following{/other_user}",
      "gists_url": "https://api.github.com/users/fMichaleczek/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/fMichaleczek",
      "id": 6187529,
      "login": "fMichaleczek",
      "node_id": "MDQ6VXNlcjYxODc1Mjk=",
      "organizations_url": "https://api.github.com/users/fMichaleczek/orgs",
      "received_events_url": "https://api.github.com/users/fMichaleczek/received_events",
      "repos_url": "https://api.github.com/users/fMichaleczek/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/fMichaleczek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fMichaleczek/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/fMichaleczek"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "> Changing default behaviour of Invoke-CimMethod would be a breaking change, since it's identical to Invoke-WmiMethod.\r\n\r\nI believe we could accept this, maybe for ErrorAction Continue or SilentlyContinue.",
    "created_at": "2020-05-11T07:26:07Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/12578#issuecomment-626521885",
    "id": 626521885,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/12578",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNjUyMTg4NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/626521885/reactions"
    },
    "updated_at": "2020-05-11T07:26:07Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/626521885",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  }
]

[
  {
    "author_association": "COLLABORATOR",
    "body": "Thanks for reporting the issue!\r\nCould you publish results of `error[0..1] | fl -force` ?",
    "created_at": "2017-02-14T17:47:46Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3143#issuecomment-279781407",
    "id": 279781407,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3143",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3OTc4MTQwNw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/279781407/reactions"
    },
    "updated_at": "2017-02-14T17:47:46Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/279781407",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "I tried that yesterday and I was able to copy some files into the session. However, today again.. errors with copying. So this are the errors:\r\n\r\n```\r\n[30]: $error[0] | fl -force\r\n\r\n\r\nwriteErrorStream      : True\r\nException             : System.InvalidOperationException: Cannot validate remote path 'c:\\temp\\'.\r\nTargetObject          : c:\\temp\\\r\nCategoryInfo          : InvalidOperation: (c:\\temp\\:String) [Copy-Item], InvalidOperationException\r\nFullyQualifiedErrorId : FailedToValidateRemotePath,Microsoft.PowerShell.Commands.CopyItemCommand\r\nErrorDetails          :\r\nInvocationInfo        : System.Management.Automation.InvocationInfo\r\nScriptStackTrace      : at <ScriptBlock>, <No file>: line 2\r\n                        at <ScriptBlock>, <No file>: line 1\r\nPipelineIterationInfo : {0, 1}\r\nPSMessageDetails      :\r\n\r\n\r\n[31]: $error[1] | fl -force\r\n\r\n\r\nwriteErrorStream      : True\r\nException             : System.Management.Automation.PSInvalidCastException: Cannot convert the \"System.Xml.XmlDocume\r\n                        nt\" value of type \"System.Xml.XmlDocument\" to type \"System.Collections.Hashtable\".\r\n                           at System.Management.Automation.Runspaces.AsyncResult.EndInvoke()\r\n                           at System.Management.Automation.PowerShell.CoreInvokeRemoteHelper[TInput,TOutput](PSDataCo\r\n                        llection`1 input, PSDataCollection`1 output, PSInvocationSettings settings)\r\n                           at System.Management.Automation.PowerShell.CoreInvoke[TInput,TOutput](PSDataCollection`1 i\r\n                        nput, PSDataCollection`1 output, PSInvocationSettings settings)\r\n                           at System.Management.Automation.PowerShell.Invoke[T]()\r\n                           at Microsoft.PowerShell.Commands.SafeInvokeCommand.Invoke(PowerShell ps, FileSystemProvide\r\n                        r fileSystemContext, CmdletProviderContext cmdletContext, Boolean shouldHaveOutput)\r\nTargetObject          : System.Management.Automation.PowerShell\r\nCategoryInfo          : InvalidOperation: (System.Management.Automation.PowerShell:PowerShell) [Copy-Item], PSInvalid\r\n                        CastException\r\nFullyQualifiedErrorId : CopyFileRemoteExecutionError,Microsoft.PowerShell.Commands.CopyItemCommand\r\nErrorDetails          :\r\nInvocationInfo        : System.Management.Automation.InvocationInfo\r\nScriptStackTrace      : at <ScriptBlock>, <No file>: line 2\r\n                        at <ScriptBlock>, <No file>: line 1\r\nPipelineIterationInfo : {0, 1}\r\nPSMessageDetails      :\r\n```\r\n\r\nWhen using the old `Resolve-Error` cmdlet:\r\n\r\n```\r\n[32]: Resolve-Error\r\n\r\n\r\nwriteErrorStream      : True\r\nPSMessageDetails      :\r\nException             : System.InvalidOperationException: Cannot validate remote path 'c:\\temp\\'.\r\nTargetObject          : c:\\temp\\\r\nCategoryInfo          : InvalidOperation: (c:\\temp\\:String) [Copy-Item], InvalidOperationException\r\nFullyQualifiedErrorId : FailedToValidateRemotePath,Microsoft.PowerShell.Commands.CopyItemCommand\r\nErrorDetails          :\r\nInvocationInfo        : System.Management.Automation.InvocationInfo\r\nScriptStackTrace      : at <ScriptBlock>, <No file>: line 2\r\n                        at <ScriptBlock>, <No file>: line 1\r\nPipelineIterationInfo : {0, 1}\r\n\r\n\r\n\r\n\r\nMyCommand             : Copy-Item\r\nBoundParameters       : {}\r\nUnboundArguments      : {}\r\nScriptLineNumber      : 2\r\nOffsetInLine          : 3\r\nHistoryId             : 28\r\nScriptName            :\r\nLine                  :   Copy-Item $deploymentsDir\\tools-common.zip -dest c:\\temp\\ -tosession $_ -verbose }\r\nPositionMessage       : At line:2 char:3\r\n                        +   Copy-Item $deploymentsDir\\tools-common.zip -dest c:\\temp\\ -tosessio ...\r\n                        +   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\nPSScriptRoot          :\r\nPSCommandPath         :\r\nInvocationName        : Copy-Item\r\nPipelineLength        : 0\r\nPipelinePosition      : 0\r\nExpectingInput        : False\r\nCommandOrigin         : Internal\r\nDisplayScriptPosition :\r\n\r\n\r\n\r\n00000000000000000000000000000000000000000000000000000000000000000000000000000000\r\n\r\n\r\nMessage        : Cannot validate remote path 'c:\\temp\\'.\r\nData           : {}\r\nInnerException :\r\nTargetSite     :\r\nStackTrace     :\r\nHelpLink       :\r\nSource         :\r\nHResult        : -2146233079\r\n\r\n\r\n\r\n[33]: Resolve-Error -ErrorRecord $Error[1]\r\n\r\n\r\nwriteErrorStream      : True\r\nPSMessageDetails      :\r\nException             : System.Management.Automation.PSInvalidCastException: Cannot convert the \"System.Xml.XmlDocume\r\n                        nt\" value of type \"System.Xml.XmlDocument\" to type \"System.Collections.Hashtable\".\r\n                           at System.Management.Automation.Runspaces.AsyncResult.EndInvoke()\r\n                           at System.Management.Automation.PowerShell.CoreInvokeRemoteHelper[TInput,TOutput](PSDataCo\r\n                        llection`1 input, PSDataCollection`1 output, PSInvocationSettings settings)\r\n                           at System.Management.Automation.PowerShell.CoreInvoke[TInput,TOutput](PSDataCollection`1 i\r\n                        nput, PSDataCollection`1 output, PSInvocationSettings settings)\r\n                           at System.Management.Automation.PowerShell.Invoke[T]()\r\n                           at Microsoft.PowerShell.Commands.SafeInvokeCommand.Invoke(PowerShell ps, FileSystemProvide\r\n                        r fileSystemContext, CmdletProviderContext cmdletContext, Boolean shouldHaveOutput)\r\nTargetObject          : System.Management.Automation.PowerShell\r\nCategoryInfo          : InvalidOperation: (System.Management.Automation.PowerShell:PowerShell) [Copy-Item], PSInvalid\r\n                        CastException\r\nFullyQualifiedErrorId : CopyFileRemoteExecutionError,Microsoft.PowerShell.Commands.CopyItemCommand\r\nErrorDetails          :\r\nInvocationInfo        : System.Management.Automation.InvocationInfo\r\nScriptStackTrace      : at <ScriptBlock>, <No file>: line 2\r\n                        at <ScriptBlock>, <No file>: line 1\r\nPipelineIterationInfo : {0, 1}\r\n\r\n\r\n\r\n\r\nMyCommand             : Copy-Item\r\nBoundParameters       : {}\r\nUnboundArguments      : {}\r\nScriptLineNumber      : 2\r\nOffsetInLine          : 3\r\nHistoryId             : 28\r\nScriptName            :\r\nLine                  :   Copy-Item $deploymentsDir\\tools-common.zip -dest c:\\temp\\ -tosession $_ -verbose }\r\nPositionMessage       : At line:2 char:3\r\n                        +   Copy-Item $deploymentsDir\\tools-common.zip -dest c:\\temp\\ -tosessio ...\r\n                        +   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\nPSScriptRoot          :\r\nPSCommandPath         :\r\nInvocationName        : Copy-Item\r\nPipelineLength        : 0\r\nPipelinePosition      : 0\r\nExpectingInput        : False\r\nCommandOrigin         : Internal\r\nDisplayScriptPosition :\r\n\r\n\r\n\r\n00000000000000000000000000000000000000000000000000000000000000000000000000000000\r\n\r\n\r\nErrorRecord    : Cannot convert the \"System.Xml.XmlDocument\" value of type \"System.Xml.XmlDocument\" to type \"System.C\r\n                 ollections.Hashtable\".\r\nMessage        : Cannot convert the \"System.Xml.XmlDocument\" value of type \"System.Xml.XmlDocument\" to type \"System.C\r\n                 ollections.Hashtable\".\r\nData           : {}\r\nInnerException :\r\nTargetSite     : Void EndInvoke()\r\nStackTrace     :    at System.Management.Automation.Runspaces.AsyncResult.EndInvoke()\r\n                    at System.Management.Automation.PowerShell.CoreInvokeRemoteHelper[TInput,TOutput](PSDataCollectio\r\n                 n`1 input, PSDataCollection`1 output, PSInvocationSettings settings)\r\n                    at System.Management.Automation.PowerShell.CoreInvoke[TInput,TOutput](PSDataCollection`1 input, P\r\n                 SDataCollection`1 output, PSInvocationSettings settings)\r\n                    at System.Management.Automation.PowerShell.Invoke[T]()\r\n                    at Microsoft.PowerShell.Commands.SafeInvokeCommand.Invoke(PowerShell ps, FileSystemProvider fileS\r\n                 ystemContext, CmdletProviderContext cmdletContext, Boolean shouldHaveOutput)\r\nHelpLink       :\r\nSource         : System.Management.Automation\r\nHResult        : -2147467262\r\n```",
    "created_at": "2017-02-15T14:43:26Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3143#issuecomment-280028762",
    "id": 280028762,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3143",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MDAyODc2Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/280028762/reactions"
    },
    "updated_at": "2017-02-15T14:43:26Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/280028762",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/253560?v=4",
      "events_url": "https://api.github.com/users/stej/events{/privacy}",
      "followers_url": "https://api.github.com/users/stej/followers",
      "following_url": "https://api.github.com/users/stej/following{/other_user}",
      "gists_url": "https://api.github.com/users/stej/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/stej",
      "id": 253560,
      "login": "stej",
      "node_id": "MDQ6VXNlcjI1MzU2MA==",
      "organizations_url": "https://api.github.com/users/stej/orgs",
      "received_events_url": "https://api.github.com/users/stej/received_events",
      "repos_url": "https://api.github.com/users/stej/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/stej/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stej/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/stej"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Oh, sorry. It would be interesting to see a call stack:\r\n$error[0..1].Exception | fl -Force",
    "created_at": "2017-02-15T15:26:49Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3143#issuecomment-280041280",
    "id": 280041280,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3143",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MDA0MTI4MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/280041280/reactions"
    },
    "updated_at": "2017-02-15T15:26:49Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/280041280",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "Content of `Resolve-Error` is this\r\n\r\n```\r\n[1]: gc Function:\\Resolve-Error\r\nparam($ErrorRecord=$Error[0])\r\n\r\n   $ErrorRecord | Format-List * -Force\r\n   $ErrorRecord.InvocationInfo |Format-List *\r\n   $Exception = $ErrorRecord.Exception\r\n   for ($i = 0; $Exception; $i++, ($Exception = $Exception.InnerException))\r\n   {   \"$i\" * 80\r\n       $Exception |Format-List * -Force\r\n   }\r\n``` \r\nso the Exception is in fact in my previous response.",
    "created_at": "2017-02-16T12:37:37Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3143#issuecomment-280319520",
    "id": 280319520,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3143",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MDMxOTUyMA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/280319520/reactions"
    },
    "updated_at": "2017-02-16T12:37:37Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/280319520",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/253560?v=4",
      "events_url": "https://api.github.com/users/stej/events{/privacy}",
      "followers_url": "https://api.github.com/users/stej/followers",
      "following_url": "https://api.github.com/users/stej/following{/other_user}",
      "gists_url": "https://api.github.com/users/stej/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/stej",
      "id": 253560,
      "login": "stej",
      "node_id": "MDQ6VXNlcjI1MzU2MA==",
      "organizations_url": "https://api.github.com/users/stej/orgs",
      "received_events_url": "https://api.github.com/users/stej/received_events",
      "repos_url": "https://api.github.com/users/stej/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/stej/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stej/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/stej"
    }
  },
  {
    "author_association": "NONE",
    "body": "It's here again\r\n\r\n```\r\n[9]: $error[0..1].Exception | fl -Force\r\n\r\n\r\nMessage        : Cannot validate remote path 'c:\\temp\\'.\r\nData           : {}\r\nInnerException :\r\nTargetSite     :\r\nStackTrace     :\r\nHelpLink       :\r\nSource         :\r\nHResult        : -2146233079\r\n\r\nErrorRecord    : Cannot convert the \"System.Xml.XmlDocument\" value of type \"System.Xml.XmlDocument\" to type \"System.C\r\n                 ollections.Hashtable\".\r\nMessage        : Cannot convert the \"System.Xml.XmlDocument\" value of type \"System.Xml.XmlDocument\" to type \"System.C\r\n                 ollections.Hashtable\".\r\nData           : {}\r\nInnerException :\r\nTargetSite     : Void EndInvoke()\r\nStackTrace     :    at System.Management.Automation.Runspaces.AsyncResult.EndInvoke()\r\n                    at System.Management.Automation.PowerShell.CoreInvokeRemoteHelper[TInput,TOutput](PSDataCollectio\r\n                 n`1 input, PSDataCollection`1 output, PSInvocationSettings settings)\r\n                    at System.Management.Automation.PowerShell.CoreInvoke[TInput,TOutput](PSDataCollection`1 input, P\r\n                 SDataCollection`1 output, PSInvocationSettings settings)\r\n                    at System.Management.Automation.PowerShell.Invoke[T]()\r\n                    at Microsoft.PowerShell.Commands.SafeInvokeCommand.Invoke(PowerShell ps, FileSystemProvider fileS\r\n                 ystemContext, CmdletProviderContext cmdletContext, Boolean shouldHaveOutput)\r\nHelpLink       :\r\nSource         : System.Management.Automation\r\nHResult        : -2147467262\r\n```\r\n\r\nAnd it happened again after I created new VMs in Azure, setup windows remoting, opened session and ran the command (see the first post in this issue).",
    "created_at": "2017-02-21T19:58:57Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3143#issuecomment-281462093",
    "id": 281462093,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3143",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MTQ2MjA5Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/281462093/reactions"
    },
    "updated_at": "2017-02-21T19:58:57Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/281462093",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/253560?v=4",
      "events_url": "https://api.github.com/users/stej/events{/privacy}",
      "followers_url": "https://api.github.com/users/stej/followers",
      "following_url": "https://api.github.com/users/stej/following{/other_user}",
      "gists_url": "https://api.github.com/users/stej/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/stej",
      "id": 253560,
      "login": "stej",
      "node_id": "MDQ6VXNlcjI1MzU2MA==",
      "organizations_url": "https://api.github.com/users/stej/orgs",
      "received_events_url": "https://api.github.com/users/stej/received_events",
      "repos_url": "https://api.github.com/users/stej/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/stej/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stej/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/stej"
    }
  },
  {
    "author_association": "NONE",
    "body": "Tried `procdump -e 1 -ma <procid>`\r\nThen `!clrstack` in windbg:\r\n\r\n```\r\n0:017> !clrstack\r\nOS Thread Id: 0x2a00 (17)\r\n        Child SP               IP Call Site\r\n0000002bdef8e4a8 00007fff38036154 [HelperMethodFrame: 0000002bdef8e4a8] \r\n0000002bdef8e590 00007ffeed2c827c System.Management.Automation.LanguagePrimitives.ThrowInvalidCastException(System.Object, System.Type)\r\n0000002bdef8e5d0 00007ffeed2c729b System.Management.Automation.LanguagePrimitives.ConvertNoConversion(System.Object, System.Type, Boolean, System.Management.Automation.PSObject, System.IFormatProvider, System.Management.Automation.Runspaces.TypeTable)\r\n0000002bdef8e610 00007ffeec886005 System.Management.Automation.LanguagePrimitives+ConversionData`1[[System.__Canon, mscorlib]].Invoke(System.Object, System.Type, Boolean, System.Management.Automation.PSObject, System.IFormatProvider, System.Management.Automation.Runspaces.TypeTable)\r\n0000002bdef8e650 00007ffeec8854c1 System.Management.Automation.LanguagePrimitives.ConvertTo(System.Object, System.Type, Boolean, System.IFormatProvider, System.Management.Automation.Runspaces.TypeTable)\r\n0000002bdef8e6f0 00007ffeec91441b System.Management.Automation.Internal.PSDataCollectionStream`1[[System.__Canon, mscorlib]].Write(System.Object, Boolean)\r\n0000002bdef8e790 00007ffeed4011e5 System.Management.Automation.Runspaces.Internal.ClientRemotePowerShell.HandleOutputReceived(System.Object, System.Management.Automation.RemoteDataEventArgs`1)\r\n0000002bdef8e7f0 00007ffeec919cdf System.Management.Automation.ExtensionMethods.SafeInvoke[[System.__Canon, mscorlib]](System.EventHandler`1, System.Object, System.__Canon)\r\n0000002bdef8e820 00007ffeec858c69 System.Management.Automation.Internal.ClientPowerShellDataStructureHandler.ProcessReceivedData(System.Management.Automation.Remoting.RemoteDataObject`1)\r\n0000002bdef8e8c0 00007ffeec858a3c System.Management.Automation.Internal.ClientRunspacePoolDataStructureHandler.DispatchMessageToPowerShell(System.Management.Automation.Remoting.RemoteDataObject`1)\r\n0000002bdef8e910 00007ffeec93ec50 System.Management.Automation.Remoting.ClientRemoteSessionDSHandlerImpl.ProcessNonSessionMessages(System.Management.Automation.Remoting.RemoteDataObject`1)\r\n0000002bdef8e970 00007ffeec919cdf System.Management.Automation.ExtensionMethods.SafeInvoke[[System.__Canon, mscorlib]](System.EventHandler`1, System.Object, System.__Canon)\r\n0000002bdef8e9a0 00007ffeec93d4fe System.Management.Automation.Remoting.BaseTransportManager.OnDataAvailableCallback(System.Management.Automation.Remoting.RemoteDataObject`1)\r\n0000002bdef8ea20 00007ffeec93d100 System.Management.Automation.Remoting.Client.BaseClientTransportManager.ServicePendingCallbacks(System.Object)\r\n0000002bdef8ead0 00007ffeed2b5c96 System.Management.Automation.Utils.WorkItemCallback(System.Object)\r\n0000002bdef8eb40 00007fff18e7674e System.Threading.ExecutionContext.RunInternal(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object, Boolean)\r\n0000002bdef8ec10 00007fff18e765e7 System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object, Boolean)\r\n0000002bdef8ec40 00007fff18e804a0 System.Threading.QueueUserWorkItemCallback.System.Threading.IThreadPoolWorkItem.ExecuteWorkItem()\r\n0000002bdef8ec80 00007fff18e7fa10 System.Threading.ThreadPoolWorkQueue.Dispatch()\r\n0000002bdef8f118 00007fff1a736a53 [DebuggerU2MCatchHandlerFrame: 0000002bdef8f118]\r\n```\r\n\r\nAs PowerShell is compiled in release mode, there is no useful info when trying `!Clrstack -a` :/",
    "created_at": "2017-02-21T20:05:51Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3143#issuecomment-281464012",
    "id": 281464012,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3143",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MTQ2NDAxMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/281464012/reactions"
    },
    "updated_at": "2017-02-21T20:07:49Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/281464012",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/253560?v=4",
      "events_url": "https://api.github.com/users/stej/events{/privacy}",
      "followers_url": "https://api.github.com/users/stej/followers",
      "following_url": "https://api.github.com/users/stej/following{/other_user}",
      "gists_url": "https://api.github.com/users/stej/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/stej",
      "id": 253560,
      "login": "stej",
      "node_id": "MDQ6VXNlcjI1MzU2MA==",
      "organizations_url": "https://api.github.com/users/stej/orgs",
      "received_events_url": "https://api.github.com/users/stej/received_events",
      "repos_url": "https://api.github.com/users/stej/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/stej/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stej/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/stej"
    }
  },
  {
    "author_association": "NONE",
    "body": "Workaround: close sessions and open new sessions.\r\nBut this is really ugly to have such a workaround in deployment scripts..",
    "created_at": "2017-02-21T20:21:26Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3143#issuecomment-281468247",
    "id": 281468247,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3143",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MTQ2ODI0Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/281468247/reactions"
    },
    "updated_at": "2017-02-21T20:21:26Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/281468247",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/253560?v=4",
      "events_url": "https://api.github.com/users/stej/events{/privacy}",
      "followers_url": "https://api.github.com/users/stej/followers",
      "following_url": "https://api.github.com/users/stej/following{/other_user}",
      "gists_url": "https://api.github.com/users/stej/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/stej",
      "id": 253560,
      "login": "stej",
      "node_id": "MDQ6VXNlcjI1MzU2MA==",
      "organizations_url": "https://api.github.com/users/stej/orgs",
      "received_events_url": "https://api.github.com/users/stej/received_events",
      "repos_url": "https://api.github.com/users/stej/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/stej/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stej/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/stej"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@stej Thanks for the additional information!\r\nPlease clarify - is the problem only with connection to a remote Azure VM? Did you try to connect to non-Azure?",
    "created_at": "2017-02-22T04:43:47Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3143#issuecomment-281567739",
    "id": 281567739,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3143",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MTU2NzczOQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/281567739/reactions"
    },
    "updated_at": "2017-02-22T04:43:47Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/281567739",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "Haven't tried so far.. I don't have any suitable & available VM here right now.. ",
    "created_at": "2017-02-22T15:46:48Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3143#issuecomment-281707978",
    "id": 281707978,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3143",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MTcwNzk3OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/281707978/reactions"
    },
    "updated_at": "2017-02-22T15:46:48Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/281707978",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/253560?v=4",
      "events_url": "https://api.github.com/users/stej/events{/privacy}",
      "followers_url": "https://api.github.com/users/stej/followers",
      "following_url": "https://api.github.com/users/stej/following{/other_user}",
      "gists_url": "https://api.github.com/users/stej/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/stej",
      "id": 253560,
      "login": "stej",
      "node_id": "MDQ6VXNlcjI1MzU2MA==",
      "organizations_url": "https://api.github.com/users/stej/orgs",
      "received_events_url": "https://api.github.com/users/stej/received_events",
      "repos_url": "https://api.github.com/users/stej/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/stej/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stej/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/stej"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "We need to check with latest builds.",
    "created_at": "2018-10-31T14:34:36Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3143#issuecomment-434710468",
    "id": 434710468,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3143",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNDcxMDQ2OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/434710468/reactions"
    },
    "updated_at": "2018-10-31T14:34:36Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/434710468",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "I just stumbled upon this error myself.\r\nI narrowed it down to that I get a casting error if I have a variable called $result in the remote session that I'm trying to copy from.\r\n\r\nThis piece of code was run in the remote session before I called copy-item\r\n```\r\n[string[]]$Result = @()\r\n```\r\nIf I rename the variable to anything else, it works.",
    "created_at": "2018-11-29T20:12:58Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3143#issuecomment-442977012",
    "id": 442977012,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3143",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0Mjk3NzAxMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/442977012/reactions"
    },
    "updated_at": "2018-11-29T20:12:58Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/442977012",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/23032645?v=4",
      "events_url": "https://api.github.com/users/jwikman/events{/privacy}",
      "followers_url": "https://api.github.com/users/jwikman/followers",
      "following_url": "https://api.github.com/users/jwikman/following{/other_user}",
      "gists_url": "https://api.github.com/users/jwikman/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jwikman",
      "id": 23032645,
      "login": "jwikman",
      "node_id": "MDQ6VXNlcjIzMDMyNjQ1",
      "organizations_url": "https://api.github.com/users/jwikman/orgs",
      "received_events_url": "https://api.github.com/users/jwikman/received_events",
      "repos_url": "https://api.github.com/users/jwikman/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jwikman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jwikman/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jwikman"
    }
  },
  {
    "author_association": "NONE",
    "body": "This is old now, but I just encountered it. In the same session I ran some chocolatey installs, which I guess defined the $result variable.\r\n\r\nA workaround that is a bit simpler that restarting the session:\r\nRun `Remove-Variable result` on the VM\r\n\r\nPSVersion locally:  \r\n```\r\nName                           Value                                                                                                                                                          \r\n----                           -----                                                                                                                                                          \r\nPSVersion                      5.1.18362.752                                                                                                                                                  \r\nPSEdition                      Desktop                                                                                                                                                        \r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}                                                                                                                                        \r\nBuildVersion                   10.0.18362.752                                                                                                                                                 \r\nCLRVersion                     4.0.30319.42000                                                                                                                                                \r\nWSManStackVersion              3.0                                                                                                                                                            \r\nPSRemotingProtocolVersion      2.3                                                                                                                                                            \r\nSerializationVersion           1.1.0.1\r\n```\r\n\r\nPSVersion on VM:\r\n```\r\nName                           Value                                                                                        \r\n----                           -----                                                                                        \r\nPSVersion                      5.1.17763.1007                                                                               \r\nPSEdition                      Desktop                                                                                      \r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}                                                                      \r\nBuildVersion                   10.0.17763.1007                                                                              \r\nCLRVersion                     4.0.30319.42000                                                                              \r\nWSManStackVersion              3.0                                                                                          \r\nPSRemotingProtocolVersion      2.3                                                                                          \r\nSerializationVersion           1.1.0.1   \r\n```\r\n",
    "created_at": "2020-09-04T13:33:36Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3143#issuecomment-687148453",
    "id": 687148453,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3143",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4NzE0ODQ1Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/687148453/reactions"
    },
    "updated_at": "2020-09-04T13:33:36Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/687148453",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/1889082?v=4",
      "events_url": "https://api.github.com/users/yacuzo/events{/privacy}",
      "followers_url": "https://api.github.com/users/yacuzo/followers",
      "following_url": "https://api.github.com/users/yacuzo/following{/other_user}",
      "gists_url": "https://api.github.com/users/yacuzo/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/yacuzo",
      "id": 1889082,
      "login": "yacuzo",
      "node_id": "MDQ6VXNlcjE4ODkwODI=",
      "organizations_url": "https://api.github.com/users/yacuzo/orgs",
      "received_events_url": "https://api.github.com/users/yacuzo/received_events",
      "repos_url": "https://api.github.com/users/yacuzo/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/yacuzo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yacuzo/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/yacuzo"
    }
  }
]

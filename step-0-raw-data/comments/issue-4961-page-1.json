[
  {
    "author_association": "CONTRIBUTOR",
    "body": "This behavior is highly dependent on the method which which you are creating the file. Can you provide both the `$PSVersionTable` output and some PowerShell code to reproduce the issue? In some cases, this behavior is \"by design\"  in others there are known issues (or ongoing debates), or this could be completely new. One cannot tell which is the case without relevant PowerShell code.",
    "created_at": "2017-09-30T10:28:49Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/4961#issuecomment-333299562",
    "id": 333299562,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/4961",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMzI5OTU2Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/333299562/reactions"
    },
    "updated_at": "2017-09-30T10:29:29Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/333299562",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6509955?v=4",
      "events_url": "https://api.github.com/users/markekraus/events{/privacy}",
      "followers_url": "https://api.github.com/users/markekraus/followers",
      "following_url": "https://api.github.com/users/markekraus/following{/other_user}",
      "gists_url": "https://api.github.com/users/markekraus/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/markekraus",
      "id": 6509955,
      "login": "markekraus",
      "node_id": "MDQ6VXNlcjY1MDk5NTU=",
      "organizations_url": "https://api.github.com/users/markekraus/orgs",
      "received_events_url": "https://api.github.com/users/markekraus/received_events",
      "repos_url": "https://api.github.com/users/markekraus/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/markekraus/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/markekraus/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/markekraus"
    }
  },
  {
    "author_association": "NONE",
    "body": "Open `cmd.exe` and do the following:\r\n```\r\nD:\\>mkdir repro\r\n\r\nD:\\>cd repro\r\n\r\nD:\\repro>dotnet new console\r\nThe template \"Console Application\" was created successfully.\r\n\r\nProcessing post-creation actions...\r\nRunning 'dotnet restore' on D:\\repro\\repro.csproj...\r\n  Restoring packages for D:\\repro\\repro.csproj...\r\n  Generating MSBuild file D:\\repro\\obj\\repro.csproj.nuget.g.props.\r\n  Generating MSBuild file D:\\repro\\obj\\repro.csproj.nuget.g.targets.\r\n  Restore completed in 219.23 ms for D:\\repro\\repro.csproj.\r\n\r\n\r\nRestore succeeded.\r\n\r\n\r\nD:\\repro>notepad Program.cs\r\n\r\nD:\\repro>\r\n```\r\n\r\nSet the contents of Program.cs to:\r\n```\r\nusing System;\r\n\r\nclass Program\r\n{\r\n    static void Main(string[] args)\r\n    {\r\n        Console.Write('P');\r\n        Console.Write('4');\r\n        Console.Write('\\n');\r\n        Console.Write('2');\r\n        Console.Write('0');\r\n        Console.Write('0');\r\n        Console.Write(' ');\r\n        Console.Write('2');\r\n        Console.Write('0');\r\n        Console.Write('0');\r\n        Console.Write('\\n');\r\n\r\n        Console.Out.Write('P');\r\n        Console.Out.Write('4');\r\n        Console.Out.Write('\\n');\r\n        Console.Out.Write('2');\r\n        Console.Out.Write('0');\r\n        Console.Out.Write('0');\r\n        Console.Out.Write(' ');\r\n        Console.Out.Write('2');\r\n        Console.Out.Write('0');\r\n        Console.Out.Write('0');\r\n        Console.Out.Write('\\n');\r\n\r\n        Console.OpenStandardOutput().WriteByte((byte)('P'));\r\n        Console.OpenStandardOutput().WriteByte((byte)('4'));\r\n        Console.OpenStandardOutput().WriteByte((byte)('\\n'));\r\n        Console.OpenStandardOutput().WriteByte((byte)('2'));\r\n        Console.OpenStandardOutput().WriteByte((byte)('0'));\r\n        Console.OpenStandardOutput().WriteByte((byte)('0'));\r\n        Console.OpenStandardOutput().WriteByte((byte)(' '));\r\n        Console.OpenStandardOutput().WriteByte((byte)('2'));\r\n        Console.OpenStandardOutput().WriteByte((byte)('0'));\r\n        Console.OpenStandardOutput().WriteByte((byte)('0'));\r\n        Console.OpenStandardOutput().WriteByte((byte)('\\n'));\r\n    }\r\n}\r\n```\r\n\r\nNext, continue on the command line with:\r\n```\r\nD:\\repro\r\nD:\\repro>dotnet run > CMD.txt\r\n\r\nD:\\repro>D:\\PowerShell-6.0.0-beta.7-win-x64\\powershell.exe\r\nPowerShell v6.0.0-beta.7\r\nCopyright (C) Microsoft Corporation. All rights reserved.\r\n\r\nPS D:\\repro> $PSVersionTable\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      6.0.0-beta\r\nPSEdition                      Core\r\nGitCommitId                    v6.0.0-beta.7\r\nOS                             Microsoft Windows 10.0.16299\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n\r\n\r\nPS D:\\repro> dotnet run > PS-1.txt\r\nPS D:\\repro> C:\\Windows\\System32\\fc.exe /B .\\CMD.txt .\\PS-1.txt\r\nComparing files .\\CMD.txt and .\\PS-1.TXT\r\n00000000: 50 FF\r\n00000001: 34 FE\r\n00000002: 0A 50\r\n00000003: 32 00\r\n00000004: 30 34\r\n00000005: 30 00\r\n00000006: 20 0D\r\n00000007: 32 00\r\n00000008: 30 0A\r\n00000009: 30 00\r\n0000000A: 0A 32\r\n0000000B: 50 00\r\n0000000C: 34 30\r\n0000000D: 0A 00\r\n0000000E: 32 30\r\n0000000F: 30 00\r\n00000010: 30 20\r\n00000011: 20 00\r\n00000013: 30 00\r\n00000015: 0A 00\r\n00000016: 50 30\r\n00000017: 34 00\r\n00000018: 0A 0D\r\n00000019: 32 00\r\n0000001A: 30 0A\r\n0000001B: 30 00\r\n0000001C: 20 50\r\n0000001D: 32 00\r\n0000001E: 30 34\r\n0000001F: 30 00\r\n00000020: 0A 0D\r\nFC: .\\PS-1.TXT longer than .\\CMD.txt\r\n\r\n\r\nPS D:\\repro> dotnet run | Out-File -filePath PS-2.txt\r\nPS D:\\repro> C:\\Windows\\System32\\fc.exe /B .\\CMD.txt .\\PS-2.txt\r\nComparing files .\\CMD.txt and .\\PS-2.TXT\r\n00000000: 50 FF\r\n00000001: 34 FE\r\n00000002: 0A 50\r\n00000003: 32 00\r\n00000004: 30 34\r\n00000005: 30 00\r\n00000006: 20 0D\r\n00000007: 32 00\r\n00000008: 30 0A\r\n00000009: 30 00\r\n0000000A: 0A 32\r\n0000000B: 50 00\r\n0000000C: 34 30\r\n0000000D: 0A 00\r\n0000000E: 32 30\r\n0000000F: 30 00\r\n00000010: 30 20\r\n00000011: 20 00\r\n00000013: 30 00\r\n00000015: 0A 00\r\n00000016: 50 30\r\n00000017: 34 00\r\n00000018: 0A 0D\r\n00000019: 32 00\r\n0000001A: 30 0A\r\n0000001B: 30 00\r\n0000001C: 20 50\r\n0000001D: 32 00\r\n0000001E: 30 34\r\n0000001F: 30 00\r\n00000020: 0A 0D\r\nFC: .\\PS-2.TXT longer than .\\CMD.txt\r\n\r\nPS D:\\repro>\r\n```\r\n\r\nYou can repeat for `dotnet run | Out-File -filePath <fileName> -encoding {encoding}` and see similar results. Below is the hex dump for each:\r\n```\r\nCMD.txt\r\n    50 34 0A\r\n    32 30 30 20 32 30 30 0A\r\n    50 34 0A\r\n    32 30 30 20 32 30 30 0A\r\n    50 34 0A\r\n    32 30 30 20 32 30 30 0A\r\nPS-1.txt, PS-2.txt, PS-Unknown.txt, PS-String.txt, PS-Unicode.txt\r\n    FF FE\r\n    50 00 34 00 0D 00 0A 00\r\n    32 00 30 00 30 00 20 00 32 00 30 00 30 00 0D 00 0A 00\r\n    50 00 34 00 0D 00 0A 00\r\n    32 00 30 00 30 00 20 00 32 00 30 00 30 00 0D 00 0A 00\r\n    50 00 34 00 0D 00 0A 00\r\n    32 00 30 00 30 00 20 00 32 00 30 00 30 00 0D 00 0A 00\r\nPS-BigEndianUnicode.txt\r\n    FE FF\r\n    00 50 00 34 00 0D 00 0A\r\n    00 32 00 30 00 30 00 20 00 32 00 30 00 30 00 0D 00 0A\r\n    00 50 00 34 00 0D 00 0A\r\n    00 32 00 30 00 30 00 20 00 32 00 30 00 30 00 0D 00 0A\r\n    00 50 00 34 00 0D 00 0A\r\n    00 32 00 30 00 30 00 20 00 32 00 30 00 30 00 0D 00 0A\r\nPS-UTF8.txt\r\n    EF BB BF\r\n    50 34 0D 0A\r\n    32 30 30 20 32 30 30 0D 0A\r\n    50 34 0D 0A\r\n    32 30 30 20 32 30 30 0D 0A\r\n    50 34 0D 0A 32 30 30 20 32 30 30 0D 0A\r\nPS-UTF7.txt\r\n    50 34 0D 0A\r\n    32 30 30 20 32 30 30 0D 0A\r\n    50 34 0D 0A\r\n    32 30 30 20 32 30 30 0D 0A\r\n    50 34 0D 0A\r\n    32 30 30 20 32 30 30 0D 0A\r\nPS-UTF32.txt (UTF32)\r\n    FF FE 00 00\r\n    50 00 00 00 34 00 00 00 0D 00 00 00 0A 00 00 00\r\n    32 00 00 00 30 00 00 00 30 00 00 00 20 00 00 00 32 00 00 00 30 00 00 00 30 00 00 00 0D 00 00 00 0A 00 00 00\r\n    50 00 00 00 34 00 00 00 0D 00 00 00 0A 00 00 00\r\n    32 00 00 00 30 00 00 00 30 00 00 00 20 00 00 00 32 00 00 00 30 00 00 00 30 00 00 00 0D 00 00 00 0A 00 00 00\r\n    50 00 00 00 34 00 00 00 0D 00 00 00 0A 00 00 00\r\n    32 00 00 00 30 00 00 00 30 00 00 00 20 00 00 00 32 00 00 00 30 00 00 00 30 00 00 00 0D 00 00 00 0A 00 00 00\r\nPS-ASCII.txt, PS-Default.txt, PS-OEM.txt\r\n    50 34 0D 0A\r\n    32 30 30 20 32 30 30 0D 0A\r\n    50 34 0D 0A\r\n    32 30 30 20 32 30 30 0D 0A\r\n    50 34 0D 0A\r\n    32 30 30 20 32 30 30 0D 0A\r\n```\r\n\r\nFrom this, I can see the following problems:\r\n* None of the encodings give the exact output desired (due to forced translation of '\\n' to '\\r\\n')\r\n  * This means there is no \"workaround\" (I would expect, at the very least, there to be a `-encoding Byte` option, as some other commands have)\r\n* UTF-8 enforces addition of the BOM (may be undesirable in some scenarios)\r\n* When no encoding is specified, it transforms the bytes to be Unicode\r\n  * This means my output is \"broken\" and \"twice as big\", by default\r\n* The default is not `-encoding Default`, it is `-encoding Unicode`\r\n",
    "created_at": "2017-09-30T15:46:41Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/4961#issuecomment-333316941",
    "id": 333316941,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/4961",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMzMxNjk0MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/333316941/reactions"
    },
    "updated_at": "2017-09-30T15:46:41Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/333316941",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/10487869?v=4",
      "events_url": "https://api.github.com/users/tannergooding/events{/privacy}",
      "followers_url": "https://api.github.com/users/tannergooding/followers",
      "following_url": "https://api.github.com/users/tannergooding/following{/other_user}",
      "gists_url": "https://api.github.com/users/tannergooding/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/tannergooding",
      "id": 10487869,
      "login": "tannergooding",
      "node_id": "MDQ6VXNlcjEwNDg3ODY5",
      "organizations_url": "https://api.github.com/users/tannergooding/orgs",
      "received_events_url": "https://api.github.com/users/tannergooding/received_events",
      "repos_url": "https://api.github.com/users/tannergooding/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/tannergooding/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tannergooding/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/tannergooding"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@tannergooding thanks for the thorough investigation.  The encoding issue should be addressed by https://github.com/PowerShell/PowerShell/issues/4878, the EOL issue is probably https://github.com/PowerShell/PowerShell/issues/2145",
    "created_at": "2017-09-30T16:05:57Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/4961#issuecomment-333318207",
    "id": 333318207,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/4961",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMzMxODIwNw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/333318207/reactions"
    },
    "updated_at": "2017-09-30T16:05:57Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/333318207",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "I believe it is dup with great repo.",
    "created_at": "2017-09-30T19:19:08Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/4961#issuecomment-333330035",
    "id": 333330035,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/4961",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMzMzMDAzNQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/333330035/reactions"
    },
    "updated_at": "2017-09-30T19:19:08Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/333330035",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "Agree that the other two issues have this covered, @tannergooding let me know if you don't agree.",
    "created_at": "2017-09-30T19:56:44Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/4961#issuecomment-333332233",
    "id": 333332233,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/4961",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMzMzMjIzMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/333332233/reactions"
    },
    "updated_at": "2017-09-30T19:56:44Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/333332233",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  }
]

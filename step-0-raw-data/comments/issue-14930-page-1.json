[
  {
    "author_association": "CONTRIBUTOR",
    "body": "Note that  the SDK's  `.AddCommand()` method already accepts a file path _string_ directly:\r\n\r\n```powershell\r\n'\"hi from test.ps1: $foo\"' > test.ps1\r\n\r\n$foo = 'value from this runspace'\r\n\r\n$ps = [powershell]::Create('CurrentRunSpace')\r\n\r\n$ps.AddCommand((Convert-Path test.ps1)).Invoke()\r\n```\r\n\r\nThe name `.AddCommand()` doesn't make that capability obvious, however, and the `.AddScript()` method, which accepts a script _block_'s _text_, i.e. a source-code _string_ rather than a file path, adds to the confusion.\r\n\r\n",
    "created_at": "2021-03-03T01:32:34Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14930#issuecomment-789356352",
    "id": 789356352,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14930",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4OTM1NjM1Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 3,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 3,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/789356352/reactions"
    },
    "updated_at": "2021-03-03T01:32:54Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/789356352",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "> The name `.AddCommand()` doesn't make that capability obvious, however, and the `.AddScript()` method, which accepts a script _block_'s _text_, i.e. a source-code _string_ rather than a file path, adds to the confusion.\r\n\r\nYeah... the name makes sense in the context of implementation detail, but boy is it hard to explain outside of it.\r\n\r\nThe tl;dr of it is: if you can run `Get-Command X` and get a result, `X` probably works in `AddCommand`.  If you can't, then it probably needs to be parsed and compiled/interpreted.",
    "created_at": "2021-03-03T17:03:46Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14930#issuecomment-789886343",
    "id": 789886343,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14930",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4OTg4NjM0Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/789886343/reactions"
    },
    "updated_at": "2021-03-03T17:03:46Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/789886343",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Oh also if this is about PSES, I'm pretty sure the only reason it doesn't use `AddCommand` for that is command history. But `AddCommand` does have an overload for `createLocalScope`, at least on `PSCommand`.",
    "created_at": "2021-03-03T17:06:55Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14930#issuecomment-789893391",
    "id": 789893391,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14930",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4OTg5MzM5MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/789893391/reactions"
    },
    "updated_at": "2021-03-03T17:06:55Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/789893391",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "> Yeah... the name makes sense in the context of implementation detail, but boy is it hard to explain outside of it.\r\n\r\nGood point.\r\n\r\nWhat would at least help is if the SDK documentation covered this better. It is generally very terse, but in this particular case [the parameter name itself - `cmdlet`](https://docs.microsoft.com/en-US/dotnet/api/system.management.automation.powershell.addcommand?view=powershellsdk-7.0.0#System_Management_Automation_PowerShell_AddCommand_System_String_)  - actively suggests much more restrictive behavior than what is actually supported:\r\n\r\n```csharp\r\npublic System.Management.Automation.PowerShell AddCommand (string cmdlet);\r\n```\r\n\r\nIt is accompanied by the following (non-)explanation: \"A string representing cmdlet.\"\r\n\r\n",
    "created_at": "2021-03-03T17:26:19Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14930#issuecomment-789907963",
    "id": 789907963,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14930",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4OTkwNzk2Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/789907963/reactions"
    },
    "updated_at": "2021-03-03T17:26:19Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/789907963",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "The term cmdlet never really had consistent usage. Recently (well sometime in the last two years, I have no concept of time anymore) the PowerShell team officially redefined it to mean more or less the same \"command\".  So coincidentally, it works now kind of.",
    "created_at": "2021-03-03T17:32:48Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14930#issuecomment-789913244",
    "id": 789913244,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14930",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4OTkxMzI0NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/789913244/reactions"
    },
    "updated_at": "2021-03-03T17:34:03Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/789913244",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "I think this terminology unification only applies to _binary_ vs. _written-in-PowerShell_ cmdlets (cmdlet-like scripts and functions, formerly called \"scriptlets\", then \"advanced functions\"), and doesn't include the following, all of which `.AddCommand()` supports:\r\n\r\n* simple functions and scripts (without `[CmdletBinding()]`, including `filter` functions)\r\n* aliases\r\n* external executables\r\n\r\n\"Command\" actually _is_ the proper umbrella term for all these, but that would require proper documentation and parameter names to that effect.\r\n\r\n",
    "created_at": "2021-03-03T17:39:45Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14930#issuecomment-789923024",
    "id": 789923024,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14930",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4OTkyMzAyNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/789923024/reactions"
    },
    "updated_at": "2021-03-03T17:41:48Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/789923024",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@rjmholt A script on disk is just a type of command and so can be executed by doing:\r\n```powershell\r\n[PowerShell]::Create(\"CurrentRunspace\").AddCommand(\"c:\\foo\\bar\\baz.ps1\").Invoke()\r\n```\r\n",
    "created_at": "2021-03-15T02:07:52Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14930#issuecomment-799041682",
    "id": 799041682,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14930",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5OTA0MTY4Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/799041682/reactions"
    },
    "updated_at": "2021-03-15T02:07:52Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/799041682",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/50499275?v=4",
      "events_url": "https://api.github.com/users/bpayette/events{/privacy}",
      "followers_url": "https://api.github.com/users/bpayette/followers",
      "following_url": "https://api.github.com/users/bpayette/following{/other_user}",
      "gists_url": "https://api.github.com/users/bpayette/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/bpayette",
      "id": 50499275,
      "login": "bpayette",
      "node_id": "MDQ6VXNlcjUwNDk5Mjc1",
      "organizations_url": "https://api.github.com/users/bpayette/orgs",
      "received_events_url": "https://api.github.com/users/bpayette/received_events",
      "repos_url": "https://api.github.com/users/bpayette/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/bpayette/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bpayette/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/bpayette"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "Closing as it seems it is answered. Please re-open if you think there is information still missing.",
    "created_at": "2021-05-19T21:56:57Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14930#issuecomment-844502572",
    "id": 844502572,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14930",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0NDUwMjU3Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/844502572/reactions"
    },
    "updated_at": "2021-05-19T21:56:57Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/844502572",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12820925?v=4",
      "events_url": "https://api.github.com/users/adityapatwardhan/events{/privacy}",
      "followers_url": "https://api.github.com/users/adityapatwardhan/followers",
      "following_url": "https://api.github.com/users/adityapatwardhan/following{/other_user}",
      "gists_url": "https://api.github.com/users/adityapatwardhan/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/adityapatwardhan",
      "id": 12820925,
      "login": "adityapatwardhan",
      "node_id": "MDQ6VXNlcjEyODIwOTI1",
      "organizations_url": "https://api.github.com/users/adityapatwardhan/orgs",
      "received_events_url": "https://api.github.com/users/adityapatwardhan/received_events",
      "repos_url": "https://api.github.com/users/adityapatwardhan/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/adityapatwardhan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/adityapatwardhan/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/adityapatwardhan"
    }
  }
]

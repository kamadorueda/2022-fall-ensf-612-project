[
  {
    "author_association": "MEMBER",
    "body": "It's a .NET change that makes the callback runs on thread pool thread now. Here are some duplicates issues: https://github.com/PowerShell/PowerShell/issues/15688, https://github.com/PowerShell/PowerShell/issues/13597",
    "created_at": "2022-05-16T17:59:30Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17340#issuecomment-1127970976",
    "id": 1127970976,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17340",
    "node_id": "IC_kwDOAvT7bc5DO3ig",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1127970976/reactions"
    },
    "updated_at": "2022-05-16T17:59:30Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1127970976",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "There are 3 main ways you can bypass this. The simplest is to just use [Invoke-WebRequest](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/invoke-webrequest?view=powershell-7.2) with the `-SkipCertificateCheck`. There are many more options on that cmdlet and it is quite advanced since it was rewritten in the pwsh v6/7 days. It also uses the [HttpClient](https://docs.microsoft.com/en-us/dotnet/api/system.net.http.httpclient?view=net-6.0) class internally which is recommended today over the `HttpWebRequest` class.\r\n\r\nThe 2nd options is to use `Add-Type` to compile the C# code containing your delegate:\r\n\r\n```powershell\r\nAdd-Type -TypeDefinition @'\r\nusing System;\r\nusing System.Net.Security;\r\nusing System.Security.Cryptography.X509Certificates;\r\n\r\nnamespace HTTP\r\n{\r\n    public class Validator\r\n    {\r\n        public static bool MyTlsValidator(object sender, X509Certificate certificate, X509Chain chain, SslPolicyErrors sslPolicyErrors)\r\n        {\r\n            return true;\r\n        }\r\n    }\r\n}\r\n'@\r\n\r\n$req = [System.Net.HttpWebRequest]::Create('https://' + $Domain)\r\n$req.AllowAutoRedirect = $true\r\n$req.ServerCertificateValidationCallback = $certDelegate\r\n$resp = $req.GetResponse()\r\n```\r\n\r\nThe benefit of this approach is you can store the responses on the class for later retrieval or easily change it up and add conditional validation logic.\r\n\r\nThe 3rd option is to use a Linq Expression to build the delegate yourself. It's a bit more involved but saves you having to compile the code inline and this expression is quite simple\r\n\r\n```powershell\r\n$certDelegate = [System.Linq.Expressions.Expression]::Lambda(\r\n    [System.Net.Security.RemoteCertificateValidationCallback],\r\n    [System.Linq.Expressions.Expression]::Block(\r\n        [System.Linq.Expressions.Expression]::Constant($true)\r\n    ),\r\n    [System.Linq.Expressions.ParameterExpression[]](\r\n        [System.Linq.Expressions.Expression]::Variable([object]),\r\n        [System.Linq.Expressions.Expression]::Variable([System.Security.Cryptography.X509Certificates.X509Certificate]),\r\n        [System.Linq.Expressions.Expression]::Variable([System.Security.Cryptography.X509Certificates.X509Chain]),\r\n        [System.Linq.Expressions.Expression]::Variable([System.Net.Security.SslPolicyErrors])\r\n    )\r\n).Compile()\r\n\r\n$req = [System.Net.HttpWebRequest]::Create('https://' + $Domain)\r\n$req.AllowAutoRedirect = $true\r\n$req.ServerCertificateValidationCallback = $certDelegate\r\n$resp = $req.GetResponse()\r\n```\r\n\r\nUltimately unless `Invoke-WebRequest` or `Invoke-RestMethod` didn't have a feature you needed you should really stick with the cmdlets as they do all this for you.",
    "created_at": "2022-05-16T19:10:54Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17340#issuecomment-1128036940",
    "id": 1128036940,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17340",
    "node_id": "IC_kwDOAvT7bc5DPHpM",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1128036940/reactions"
    },
    "updated_at": "2022-05-16T19:10:54Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1128036940",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8462645?v=4",
      "events_url": "https://api.github.com/users/jborean93/events{/privacy}",
      "followers_url": "https://api.github.com/users/jborean93/followers",
      "following_url": "https://api.github.com/users/jborean93/following{/other_user}",
      "gists_url": "https://api.github.com/users/jborean93/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jborean93",
      "id": 8462645,
      "login": "jborean93",
      "node_id": "MDQ6VXNlcjg0NjI2NDU=",
      "organizations_url": "https://api.github.com/users/jborean93/orgs",
      "received_events_url": "https://api.github.com/users/jborean93/received_events",
      "repos_url": "https://api.github.com/users/jborean93/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jborean93/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jborean93/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jborean93"
    }
  },
  {
    "author_association": "NONE",
    "body": "This issue has been marked as external and has not had any activity for **1 day**. It has been be closed for housekeeping purposes.",
    "created_at": "2022-05-17T22:00:43Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17340#issuecomment-1129357943",
    "id": 1129357943,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17340",
    "node_id": "IC_kwDOAvT7bc5DUKJ3",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1129357943/reactions"
    },
    "updated_at": "2022-05-17T22:00:43Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1129357943",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  },
  {
    "author_association": "NONE",
    "body": "Invoke-Webrequest is not really working either: see issue #17333\r\nBut it would be much better if it did :)",
    "created_at": "2022-05-20T07:24:55Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17340#issuecomment-1132570198",
    "id": 1132570198,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17340",
    "node_id": "IC_kwDOAvT7bc5DgaZW",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1132570198/reactions"
    },
    "updated_at": "2022-05-20T07:24:55Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1132570198",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/14040034?v=4",
      "events_url": "https://api.github.com/users/Hamsterman/events{/privacy}",
      "followers_url": "https://api.github.com/users/Hamsterman/followers",
      "following_url": "https://api.github.com/users/Hamsterman/following{/other_user}",
      "gists_url": "https://api.github.com/users/Hamsterman/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Hamsterman",
      "id": 14040034,
      "login": "Hamsterman",
      "node_id": "MDQ6VXNlcjE0MDQwMDM0",
      "organizations_url": "https://api.github.com/users/Hamsterman/orgs",
      "received_events_url": "https://api.github.com/users/Hamsterman/received_events",
      "repos_url": "https://api.github.com/users/Hamsterman/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Hamsterman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Hamsterman/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Hamsterman"
    }
  }
]

[
  {
    "author_association": "COLLABORATOR",
    "body": "It seems we can not detect interactive input.",
    "created_at": "2019-03-09T04:51:45Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9089#issuecomment-471145622",
    "id": 471145622,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9089",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MTE0NTYyMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/471145622/reactions"
    },
    "updated_at": "2019-03-09T04:51:45Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/471145622",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@iSazonov : well... what if any time `$PSScriptRoot` is going to return `null`, then just return `$PWD` instead?",
    "created_at": "2019-03-09T05:09:05Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9089#issuecomment-471146550",
    "id": 471146550,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9089",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MTE0NjU1MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/471146550/reactions"
    },
    "updated_at": "2019-03-09T05:09:05Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/471146550",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/771085?v=4",
      "events_url": "https://api.github.com/users/jazzdelightsme/events{/privacy}",
      "followers_url": "https://api.github.com/users/jazzdelightsme/followers",
      "following_url": "https://api.github.com/users/jazzdelightsme/following{/other_user}",
      "gists_url": "https://api.github.com/users/jazzdelightsme/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jazzdelightsme",
      "id": 771085,
      "login": "jazzdelightsme",
      "node_id": "MDQ6VXNlcjc3MTA4NQ==",
      "organizations_url": "https://api.github.com/users/jazzdelightsme/orgs",
      "received_events_url": "https://api.github.com/users/jazzdelightsme/received_events",
      "repos_url": "https://api.github.com/users/jazzdelightsme/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jazzdelightsme/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jazzdelightsme/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jazzdelightsme"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Making it work interactively will make the name of this variable meaningless.",
    "created_at": "2019-03-09T14:20:16Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9089#issuecomment-471181793",
    "id": 471181793,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9089",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MTE4MTc5Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/471181793/reactions"
    },
    "updated_at": "2019-03-09T14:20:16Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/471181793",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12897753?v=4",
      "events_url": "https://api.github.com/users/kvprasoon/events{/privacy}",
      "followers_url": "https://api.github.com/users/kvprasoon/followers",
      "following_url": "https://api.github.com/users/kvprasoon/following{/other_user}",
      "gists_url": "https://api.github.com/users/kvprasoon/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/kvprasoon",
      "id": 12897753,
      "login": "kvprasoon",
      "node_id": "MDQ6VXNlcjEyODk3NzUz",
      "organizations_url": "https://api.github.com/users/kvprasoon/orgs",
      "received_events_url": "https://api.github.com/users/kvprasoon/received_events",
      "repos_url": "https://api.github.com/users/kvprasoon/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/kvprasoon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kvprasoon/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/kvprasoon"
    }
  },
  {
    "author_association": "NONE",
    "body": "FWIW, `$PSScriptRoot` is the empty string, not `$null`, when used interactively. I don't know if in any possible future we would be working on a platform where the empty string is a valid absolute path.\r\n\r\nBTW, don't join paths yourself. Use `[System.IO.Path]::Combine` instead.",
    "created_at": "2019-03-10T14:45:15Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9089#issuecomment-471312502",
    "id": 471312502,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9089",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MTMxMjUwMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/471312502/reactions"
    },
    "updated_at": "2019-03-10T14:45:15Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/471312502",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/4462444?v=4",
      "events_url": "https://api.github.com/users/GeeLaw/events{/privacy}",
      "followers_url": "https://api.github.com/users/GeeLaw/followers",
      "following_url": "https://api.github.com/users/GeeLaw/following{/other_user}",
      "gists_url": "https://api.github.com/users/GeeLaw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/GeeLaw",
      "id": 4462444,
      "login": "GeeLaw",
      "node_id": "MDQ6VXNlcjQ0NjI0NDQ=",
      "organizations_url": "https://api.github.com/users/GeeLaw/orgs",
      "received_events_url": "https://api.github.com/users/GeeLaw/received_events",
      "repos_url": "https://api.github.com/users/GeeLaw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/GeeLaw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/GeeLaw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/GeeLaw"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "This is an interesting idea, it's definitely tripped me up before.\r\n\r\nI do think it's a risky change though - there are too many scenarios where `$PSScriptRoot` might not have a useful value, and I think it's likely real scripts might use that detail in some meaningful way.\r\n\r\nMaybe what you really want is to replace `$PSScriptRoot` with `$PWD` when pasting? It seems simple to do as a custom PSReadLine key binding.",
    "created_at": "2019-03-10T17:40:12Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9089#issuecomment-471327115",
    "id": 471327115,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9089",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MTMyNzExNQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/471327115/reactions"
    },
    "updated_at": "2019-03-10T17:40:12Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/471327115",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/2148248?v=4",
      "events_url": "https://api.github.com/users/lzybkr/events{/privacy}",
      "followers_url": "https://api.github.com/users/lzybkr/followers",
      "following_url": "https://api.github.com/users/lzybkr/following{/other_user}",
      "gists_url": "https://api.github.com/users/lzybkr/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/lzybkr",
      "id": 2148248,
      "login": "lzybkr",
      "node_id": "MDQ6VXNlcjIxNDgyNDg=",
      "organizations_url": "https://api.github.com/users/lzybkr/orgs",
      "received_events_url": "https://api.github.com/users/lzybkr/received_events",
      "repos_url": "https://api.github.com/users/lzybkr/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/lzybkr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lzybkr/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/lzybkr"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "We've also seen people have issues with this in VSCode with the PowerShell extension.  This crops up when you select script that refers to $PSScriptRoot and press <kbd>F8</kbd> to run the selected script in the console. In this case, the extensions \"knows\" the path for the script.  If we could just **set** the $PSScriptRoot variable in the global session, then <kbd>F8</kbd> would work better for folks.  ",
    "created_at": "2019-03-10T17:49:56Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9089#issuecomment-471327888",
    "id": 471327888,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9089",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MTMyNzg4OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 5,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 2,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 7,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/471327888/reactions"
    },
    "updated_at": "2019-03-10T17:50:55Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/471327888",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/5177512?v=4",
      "events_url": "https://api.github.com/users/rkeithhill/events{/privacy}",
      "followers_url": "https://api.github.com/users/rkeithhill/followers",
      "following_url": "https://api.github.com/users/rkeithhill/following{/other_user}",
      "gists_url": "https://api.github.com/users/rkeithhill/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rkeithhill",
      "id": 5177512,
      "login": "rkeithhill",
      "node_id": "MDQ6VXNlcjUxNzc1MTI=",
      "organizations_url": "https://api.github.com/users/rkeithhill/orgs",
      "received_events_url": "https://api.github.com/users/rkeithhill/received_events",
      "repos_url": "https://api.github.com/users/rkeithhill/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rkeithhill/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rkeithhill/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rkeithhill"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "For PSRL you can override `PSConsoleHostReadLine` like this\r\n\r\n```powershell\r\nfunction PSConsoleHostReadLineProxy {\r\n    Microsoft.PowerShell.Core\\Set-StrictMode -Off\r\n    $command = [Microsoft.PowerShell.PSConsoleReadLine]::ReadLine($host.Runspace, $ExecutionContext)\r\n    $ast = [System.Management.Automation.Language.Parser]::ParseInput(\r\n        $command,\r\n        [ref] $null,\r\n        [ref] $null)\r\n\r\n    $findVariablesDelegate = {\r\n        param($a)\r\n        end {\r\n            $a -is [System.Management.Automation.Language.VariableExpressionAst] -and\r\n            $a.VariablePath.UserPath -eq 'PSScriptRoot'\r\n        }\r\n    }\r\n\r\n    $variables = $ast.FindAll($findVariablesDelegate, $true) |\r\n        Microsoft.PowerShell.Utility\\Sort-Object { $PSItem.Extent.StartOffset } -Descending\r\n\r\n    $newPrompt = [System.Text.StringBuilder]::new($command)\r\n    foreach ($variable in $variables) {\r\n        $extent = $variable.Extent\r\n        $null = $newPrompt.\r\n            Remove($extent.StartOffset, $extent.EndOffset - $extent.StartOffset).\r\n            Insert($extent.StartOffset, '$($PWD.ProviderPath)')\r\n    }\r\n\r\n    return $newPrompt.ToString()\r\n}\r\n\r\nMicrosoft.PowerShell.Utility\\New-Alias PSConsoleHostReadLine PSConsoleHostReadLineProxy -Force\r\n```\r\n\r\nWorth noting though that this won't work in the VSCode preview extension because it doesn't actually call `PSConsoleHostReadLine`.  Maybe that should be revisited though.",
    "created_at": "2019-03-11T12:51:57Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9089#issuecomment-471526194",
    "id": 471526194,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9089",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MTUyNjE5NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 2,
      "heart": 1,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 3,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/471526194/reactions"
    },
    "updated_at": "2019-03-11T12:51:57Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/471526194",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  },
  {
    "author_association": "NONE",
    "body": "Writing code with `$PSScriptRoot` is a best practice to avoid opaque dependencies on shell location.  However, this makes testing snippets very frustrating, as they must be rewritten.  This feature would be immensely valuable on a daily basis.",
    "created_at": "2019-10-10T18:27:30Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/9089#issuecomment-540713212",
    "id": 540713212,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/9089",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0MDcxMzIxMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/540713212/reactions"
    },
    "updated_at": "2019-10-10T18:27:30Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/540713212",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/3680671?v=4",
      "events_url": "https://api.github.com/users/chriskuech/events{/privacy}",
      "followers_url": "https://api.github.com/users/chriskuech/followers",
      "following_url": "https://api.github.com/users/chriskuech/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriskuech/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/chriskuech",
      "id": 3680671,
      "login": "chriskuech",
      "node_id": "MDQ6VXNlcjM2ODA2NzE=",
      "organizations_url": "https://api.github.com/users/chriskuech/orgs",
      "received_events_url": "https://api.github.com/users/chriskuech/received_events",
      "repos_url": "https://api.github.com/users/chriskuech/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/chriskuech/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriskuech/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/chriskuech"
    }
  }
]

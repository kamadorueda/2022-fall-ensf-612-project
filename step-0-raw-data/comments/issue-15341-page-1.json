[
  {
    "author_association": "MEMBER",
    "body": "The `_eventLogBuffer` is actually used only if [NeedToLog()](https://github.com/PowerShell/PowerShell/blob/a95b2cb17fecc8640533420b3baa9aec0f3749cb/src/System.Management.Automation/engine/pipeline.cs#L231) returns true, which _may_ return true only if the `EnableModuleLogging` group policy setting is enabled. So, in most of cases, logging strings are collected into this list, but is never actually used.\r\n\r\nWe should not collect the logging strings when we are not going to log them. I will submit a PR for this.",
    "created_at": "2021-05-03T19:14:53Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15341#issuecomment-831473602",
    "id": 831473602,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15341",
    "node_id": "MDEyOklzc3VlQ29tbWVudDgzMTQ3MzYwMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/831473602/reactions"
    },
    "updated_at": "2021-05-03T19:14:53Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/831473602",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "The buffer should still be flushed periodically to avoid OOM conditions like I was effectively hitting.",
    "created_at": "2021-05-03T19:51:55Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15341#issuecomment-831493644",
    "id": 831493644,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15341",
    "node_id": "MDEyOklzc3VlQ29tbWVudDgzMTQ5MzY0NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/831493644/reactions"
    },
    "updated_at": "2021-05-03T19:51:55Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/831493644",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/2148248?v=4",
      "events_url": "https://api.github.com/users/lzybkr/events{/privacy}",
      "followers_url": "https://api.github.com/users/lzybkr/followers",
      "following_url": "https://api.github.com/users/lzybkr/following{/other_user}",
      "gists_url": "https://api.github.com/users/lzybkr/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/lzybkr",
      "id": 2148248,
      "login": "lzybkr",
      "node_id": "MDQ6VXNlcjIxNDgyNDg=",
      "organizations_url": "https://api.github.com/users/lzybkr/orgs",
      "received_events_url": "https://api.github.com/users/lzybkr/received_events",
      "repos_url": "https://api.github.com/users/lzybkr/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/lzybkr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lzybkr/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/lzybkr"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "Yeah, but that's a little tricky as the [LogToEventLog()](https://github.com/PowerShell/PowerShell/blob/a95b2cb17fecc8640533420b3baa9aec0f3749cb/src/System.Management.Automation/engine/pipeline.cs#L229) (_write a pipeline execution detail event_) is not called until a pipeline processor is done executing and being teared down.\r\n\r\nActually, this design has a fundamental flaw when __eventLogBuffer_ holds a large number of logging messages -- the event may be lost when the payload is too large (the size limit for an ETW event is 64K). In your case, the length of the string array is 134217728. That's a lot strings, and the event payload will exceed the limit for sure. It should be fixed to write out the detail event in parts, when it's getting close to the event size limit, and of course those partial events need to be correlated.",
    "created_at": "2021-05-03T21:32:45Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15341#issuecomment-831549326",
    "id": 831549326,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15341",
    "node_id": "MDEyOklzc3VlQ29tbWVudDgzMTU0OTMyNg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/831549326/reactions"
    },
    "updated_at": "2021-05-03T21:32:45Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/831549326",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  }
]

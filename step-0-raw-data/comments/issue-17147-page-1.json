[
  {
    "author_association": "NONE",
    "body": "Any update please? E.g. you can reproduce it like me on more, different systems?\r\nThank you",
    "created_at": "2022-04-22T13:24:25Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17147#issuecomment-1106513115",
    "id": 1106513115,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17147",
    "node_id": "IC_kwDOAvT7bc5B9Azb",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1106513115/reactions"
    },
    "updated_at": "2022-04-22T13:24:25Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1106513115",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/1260408?v=4",
      "events_url": "https://api.github.com/users/ExSport/events{/privacy}",
      "followers_url": "https://api.github.com/users/ExSport/followers",
      "following_url": "https://api.github.com/users/ExSport/following{/other_user}",
      "gists_url": "https://api.github.com/users/ExSport/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ExSport",
      "id": 1260408,
      "login": "ExSport",
      "node_id": "MDQ6VXNlcjEyNjA0MDg=",
      "organizations_url": "https://api.github.com/users/ExSport/orgs",
      "received_events_url": "https://api.github.com/users/ExSport/received_events",
      "repos_url": "https://api.github.com/users/ExSport/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ExSport/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ExSport/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ExSport"
    }
  },
  {
    "author_association": "NONE",
    "body": "Seems no interest to this issue from MS side? Thanks for some update.",
    "created_at": "2022-05-18T07:59:28Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17147#issuecomment-1129694218",
    "id": 1129694218,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17147",
    "node_id": "IC_kwDOAvT7bc5DVcQK",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1129694218/reactions"
    },
    "updated_at": "2022-05-18T07:59:28Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1129694218",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/1260408?v=4",
      "events_url": "https://api.github.com/users/ExSport/events{/privacy}",
      "followers_url": "https://api.github.com/users/ExSport/followers",
      "following_url": "https://api.github.com/users/ExSport/following{/other_user}",
      "gists_url": "https://api.github.com/users/ExSport/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ExSport",
      "id": 1260408,
      "login": "ExSport",
      "node_id": "MDQ6VXNlcjEyNjA0MDg=",
      "organizations_url": "https://api.github.com/users/ExSport/orgs",
      "received_events_url": "https://api.github.com/users/ExSport/received_events",
      "repos_url": "https://api.github.com/users/ExSport/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ExSport/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ExSport/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ExSport"
    }
  },
  {
    "author_association": "NONE",
    "body": "Another source of the same issue when called via C#:\r\nhttps://stackoverflow.com/questions/66333570/performancecounter-user-input-delay-per-session-disappears\n\n<blockquote><img src=\"https://cdn.sstatic.net/Sites/stackoverflow/Img/apple-touch-icon@2.png?v=73d79a89bded\" width=\"48\" align=\"right\"><div>Stack Overflow</div><div><strong><a href=\"https://stackoverflow.com/questions/66333570/performancecounter-user-input-delay-per-session-disappears\">PerformanceCounter \"User Input Delay per Session\" disappears</a></strong></div><div>Win2019 Server offers new performance counters that can help with performance issues on hosts with RDS (=Remote Desktop Services).\n\nThey have to be activated with a registry key before usage:\nhttps://</div></blockquote>",
    "created_at": "2022-06-01T09:17:44Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17147#issuecomment-1143346988",
    "id": 1143346988,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17147",
    "node_id": "IC_kwDOAvT7bc5EJhcs",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1143346988/reactions"
    },
    "updated_at": "2022-06-01T09:17:46Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1143346988",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/1260408?v=4",
      "events_url": "https://api.github.com/users/ExSport/events{/privacy}",
      "followers_url": "https://api.github.com/users/ExSport/followers",
      "following_url": "https://api.github.com/users/ExSport/following{/other_user}",
      "gists_url": "https://api.github.com/users/ExSport/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ExSport",
      "id": 1260408,
      "login": "ExSport",
      "node_id": "MDQ6VXNlcjEyNjA0MDg=",
      "organizations_url": "https://api.github.com/users/ExSport/orgs",
      "received_events_url": "https://api.github.com/users/ExSport/received_events",
      "repos_url": "https://api.github.com/users/ExSport/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ExSport/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ExSport/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ExSport"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "I'm not able to repro this with 7.3, there was a [change to how the cmdlet interops with the perf API](https://github.com/PowerShell/PowerShell/pull/17779), can you see if this repros for you with 7.3?",
    "created_at": "2022-10-04T17:11:20Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17147#issuecomment-1267309241",
    "id": 1267309241,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17147",
    "node_id": "IC_kwDOAvT7bc5LiZq5",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1267309241/reactions"
    },
    "updated_at": "2022-10-04T17:11:20Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1267309241",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "NONE",
    "body": "@SteveL-MSFT Hello Steve\r\nUnfortunately not fixed (OS Win 2019, Posh 7.3.0-preview8):\r\n![image](https://user-images.githubusercontent.com/1260408/194847671-545e4bf2-2bbb-41f9-a178-b2f6701e5ced.png)\r\n",
    "created_at": "2022-10-10T10:39:18Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17147#issuecomment-1273118642",
    "id": 1273118642,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17147",
    "node_id": "IC_kwDOAvT7bc5L4j-y",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1273118642/reactions"
    },
    "updated_at": "2022-10-10T10:39:18Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1273118642",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/1260408?v=4",
      "events_url": "https://api.github.com/users/ExSport/events{/privacy}",
      "followers_url": "https://api.github.com/users/ExSport/followers",
      "following_url": "https://api.github.com/users/ExSport/following{/other_user}",
      "gists_url": "https://api.github.com/users/ExSport/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ExSport",
      "id": 1260408,
      "login": "ExSport",
      "node_id": "MDQ6VXNlcjEyNjA0MDg=",
      "organizations_url": "https://api.github.com/users/ExSport/orgs",
      "received_events_url": "https://api.github.com/users/ExSport/received_events",
      "repos_url": "https://api.github.com/users/ExSport/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ExSport/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ExSport/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ExSport"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@ExSport Please share `Get-Error` output.",
    "created_at": "2022-10-10T11:49:39Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17147#issuecomment-1273197550",
    "id": 1273197550,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17147",
    "node_id": "IC_kwDOAvT7bc5L43Pu",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1273197550/reactions"
    },
    "updated_at": "2022-10-10T11:49:39Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1273197550",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "Get-Error output:\r\n```\r\nException             :\r\n    Type    : System.Exception\r\n    Message : The data in one of the performance counter samples is not valid. View the Status property for each\r\nPerformanceCounterSample object to make sure it contains valid data.\r\n    HResult : -2146233088\r\nCategoryInfo          : InvalidResult: (:) [Get-Counter], Exception\r\nFullyQualifiedErrorId : CounterApiError,Microsoft.PowerShell.Commands.GetCounterCommand\r\nInvocationInfo        :\r\n    MyCommand        : Get-Counter\r\n    ScriptLineNumber : 1\r\n    OffsetInLine     : 2\r\n    HistoryId        : 4\r\n    Line             : (Get-Counter -Counter @('\\smb server\\receive bytes/sec','\\memory\\page faults/sec','\\user input\r\ndelay per session(max)\\max input delay') -SampleInterval 1 -MaxSamples 1).CounterSamples|Select\r\nInstanceName,Path,CookedValue,Status\r\n    PositionMessage  : At line:1 char:2\r\n                       + (Get-Counter -Counter @('\\smb server\\receive bytes/sec','\\memory\\page â€¦\r\n                       +  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    InvocationName   : Get-Counter\r\n    CommandOrigin    : Internal\r\nScriptStackTrace      : at <ScriptBlock>, <No file>: line 1\r\nPipelineIterationInfo :\r\n```",
    "created_at": "2022-10-10T12:03:08Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17147#issuecomment-1273211182",
    "id": 1273211182,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17147",
    "node_id": "IC_kwDOAvT7bc5L46ku",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1273211182/reactions"
    },
    "updated_at": "2022-10-10T12:03:08Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1273211182",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/1260408?v=4",
      "events_url": "https://api.github.com/users/ExSport/events{/privacy}",
      "followers_url": "https://api.github.com/users/ExSport/followers",
      "following_url": "https://api.github.com/users/ExSport/following{/other_user}",
      "gists_url": "https://api.github.com/users/ExSport/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ExSport",
      "id": 1260408,
      "login": "ExSport",
      "node_id": "MDQ6VXNlcjEyNjA0MDg=",
      "organizations_url": "https://api.github.com/users/ExSport/orgs",
      "received_events_url": "https://api.github.com/users/ExSport/received_events",
      "repos_url": "https://api.github.com/users/ExSport/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ExSport/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ExSport/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ExSport"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "I spent some time debugging this.  The actual error being returned as part of the PDH sample is PDH_CSTATUS_NO_OBJECT.  I can easily repro this with:\r\n\r\n```powershell\r\n(Get-Counter -Counter @('\\memory\\page faults/sec', '\\user input delay per session(max)\\max input delay') -SampleInterval 1 -MaxSamples 1).CounterSamples\r\n```\r\n\r\nSame with PS7 and 5.1.  So this is not a regression.  The interesting thing is if I use perfmon with the same two counters, I see the same problem.  No data is returned for `page faults/sec`.  However, if I ONLY have that counter (either the cmdlet or in perfmon), it shows data.  But in perfmon if I add back the second counter, it then doesn't show any data for the first one.  Based on the results of perfmon (and the cmdlet is consistent here), it seems that the problem is with the counter being used with another counter.",
    "created_at": "2022-10-10T23:56:20Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17147#issuecomment-1273921775",
    "id": 1273921775,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17147",
    "node_id": "IC_kwDOAvT7bc5L7oDv",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1273921775/reactions"
    },
    "updated_at": "2022-10-10T23:56:20Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1273921775",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "NONE",
    "body": "@SteveL-MSFT You can combine more counters without issues but when multiple ones are used, you can't use \"new\" [user input delay] one which will affect other ones in most cases (as described in the first post):\r\nhttps://learn.microsoft.com/en-us/windows-server/remote/remote-desktop-services/rds-rdsh-performance-counters\r\nWithout this one, you are able to read more counters at once or your are able to read this one alone or with e.g. SMB counters but not with other ones like memory ones, etc.\r\nIt is possible to read them \"together\" in separate threads via RunSpace/PSJobs so you can read them almost at once, without any crashes but they can't be queried in one request.\r\nIt is not a flaw in PowerShell cmdlet only (all versions) but in perfmon API or the way how PowerShell/.net/C#/... queries these counters.\n\n<blockquote><img src=\"https://learn.microsoft.com/en-us/media/logos/logo-ms-social.png\" width=\"48\" align=\"right\"><div><strong><a href=\"https://learn.microsoft.com/en-us/windows-server/remote/remote-desktop-services/rds-rdsh-performance-counters\">Use performance counters to diagnose application responsiveness problems on Remote Desktop Session Hosts</a></strong></div><div>Is your app running slow on RDS? Learn about performance counters you can use to diagnose app performance problems on RDSH</div></blockquote>",
    "created_at": "2022-10-11T06:34:40Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17147#issuecomment-1274153269",
    "id": 1274153269,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17147",
    "node_id": "IC_kwDOAvT7bc5L8gk1",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1274153269/reactions"
    },
    "updated_at": "2022-10-11T06:34:43Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1274153269",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/1260408?v=4",
      "events_url": "https://api.github.com/users/ExSport/events{/privacy}",
      "followers_url": "https://api.github.com/users/ExSport/followers",
      "following_url": "https://api.github.com/users/ExSport/following{/other_user}",
      "gists_url": "https://api.github.com/users/ExSport/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ExSport",
      "id": 1260408,
      "login": "ExSport",
      "node_id": "MDQ6VXNlcjEyNjA0MDg=",
      "organizations_url": "https://api.github.com/users/ExSport/orgs",
      "received_events_url": "https://api.github.com/users/ExSport/received_events",
      "repos_url": "https://api.github.com/users/ExSport/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ExSport/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ExSport/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ExSport"
    }
  }
]

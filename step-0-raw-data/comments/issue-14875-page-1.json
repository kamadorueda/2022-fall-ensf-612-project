[
  {
    "author_association": "MEMBER",
    "body": "Could you also show the csproj? Also which version of powershell are you using? ",
    "created_at": "2021-02-22T16:34:34Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14875#issuecomment-783502714",
    "id": 783502714,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14875",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4MzUwMjcxNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/783502714/reactions"
    },
    "updated_at": "2021-02-22T16:39:04Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/783502714",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12820925?v=4",
      "events_url": "https://api.github.com/users/adityapatwardhan/events{/privacy}",
      "followers_url": "https://api.github.com/users/adityapatwardhan/followers",
      "following_url": "https://api.github.com/users/adityapatwardhan/following{/other_user}",
      "gists_url": "https://api.github.com/users/adityapatwardhan/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/adityapatwardhan",
      "id": 12820925,
      "login": "adityapatwardhan",
      "node_id": "MDQ6VXNlcjEyODIwOTI1",
      "organizations_url": "https://api.github.com/users/adityapatwardhan/orgs",
      "received_events_url": "https://api.github.com/users/adityapatwardhan/received_events",
      "repos_url": "https://api.github.com/users/adityapatwardhan/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/adityapatwardhan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/adityapatwardhan/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/adityapatwardhan"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@ankku, I've posted an answer to your Stack Overflow question (which has the same content as this issue): https://stackoverflow.com/a/66322165/45375\r\n\r\n* It points out the one obvious problem with your code - lack of `.AddStatement()` between `.AddScript()` and `.AddCommand()`\r\n\r\n* It demonstrates that there's nothing wrong with your approach per se, using test projects.\r\n\r\nIf the test projects don't work for you, please use them as a basis for providing a self-contained, reproducible example that highlights the problem.\r\n\r\n\r\n\r\n\r\n\n\n<blockquote><img src=\"https://cdn.sstatic.net/Sites/stackoverflow/Img/apple-touch-icon@2.png?v=73d79a89bded\" width=\"48\" align=\"right\"><div>Stack Overflow</div><div><strong><a href=\"https://stackoverflow.com/questions/66313904/whats-the-correct-way-to-get-output-for-this-powershell-in-c-sharp\">Whats the correct way to get output for this Powershell in C#</a></strong></div><div>I am not getting any error below but I am also not getting the output. Below is the Powershell cmd and the C# method which is calling it. I would like to know if it is written correctly and how can...</div></blockquote>",
    "created_at": "2021-02-22T19:43:31Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14875#issuecomment-783625978",
    "id": 783625978,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14875",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4MzYyNTk3OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/783625978/reactions"
    },
    "updated_at": "2021-02-22T19:43:33Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/783625978",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "so the proper approach here is to inspect the PowerShell object for clues to what is going wrong. It contains the errors that will help you debug what is going on. Here's transcript (from powershell, rather than C#, but it's a reasonable approximation):\r\n```powershell\r\nPS> $ps = [powershell]::Create()\r\nPS> $task = $ps.addcommand(\"Get-Date\").AddCommand(\"get-location\").BeginInvoke()\r\nPS> $task\r\n\r\nCompletedSynchronously IsCompleted AsyncState AsyncWaitHandle\r\n---------------------- ----------- ---------- ---------------\r\n                 False        True            System.Threading.ManualResetEvent\r\n\r\nPS> $ps\r\n\r\nCommands            : System.Management.Automation.PSCommand\r\nStreams             : System.Management.Automation.PSDataStreams\r\nInstanceId          : a41197ec-d3f7-449b-91c7-92c14475c43d\r\nInvocationStateInfo : System.Management.Automation.PSInvocationStateInfo\r\nIsNested            : False\r\nHadErrors           : True\r\nRunspace            : System.Management.Automation.Runspaces.LocalRunspace\r\nRunspacePool        : \r\nIsRunspaceOwner     : True\r\nHistoryString       : \r\n\r\n\r\nPS> $ps.streams\r\n\r\nError       : {The input object cannot be bound to any parameters for the command either because the command does not take pipeline input or the \r\n              input and its properties do not match any of the parameters that take pipeline input.}\r\nProgress    : {}\r\nVerbose     : {}\r\nDebug       : {}\r\nWarning     : {}\r\nInformation : {}\r\n```\r\nin your example, you attempted this _pipeline_ `Import-module | get-rowandpartitionkey` which is the problem. The missing `AddStatement` turns your pipeline into 2 discrete commands.",
    "created_at": "2021-02-25T01:30:21Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14875#issuecomment-785509243",
    "id": 785509243,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14875",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4NTUwOTI0Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/785509243/reactions"
    },
    "updated_at": "2021-02-25T01:30:21Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/785509243",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/10214008?v=4",
      "events_url": "https://api.github.com/users/JamesWTruher/events{/privacy}",
      "followers_url": "https://api.github.com/users/JamesWTruher/followers",
      "following_url": "https://api.github.com/users/JamesWTruher/following{/other_user}",
      "gists_url": "https://api.github.com/users/JamesWTruher/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/JamesWTruher",
      "id": 10214008,
      "login": "JamesWTruher",
      "node_id": "MDQ6VXNlcjEwMjE0MDA4",
      "organizations_url": "https://api.github.com/users/JamesWTruher/orgs",
      "received_events_url": "https://api.github.com/users/JamesWTruher/received_events",
      "repos_url": "https://api.github.com/users/JamesWTruher/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/JamesWTruher/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JamesWTruher/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/JamesWTruher"
    }
  }
]

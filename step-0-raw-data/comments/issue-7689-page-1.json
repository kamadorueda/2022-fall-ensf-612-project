[
  {
    "author_association": "COLLABORATOR",
    "body": "Hi @felixfbecker PSObject has implemented `IDynamicMetaObjectProvider` since PowerShell Version 3 when it was rehosted on the DLR. See:\r\n\r\nsrc\\System.Management.Automation\\engine\\MshObject.cs:47:    public class PSObject : IFormattable, IComparable, ISerializable, IDynamicMetaObjectProvider\r\n\r\nYou should be able to use `dynamic` instead of `PSObject` in most places in your code.\r\n",
    "created_at": "2018-09-02T18:37:07Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7689#issuecomment-417950630",
    "id": 417950630,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7689",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNzk1MDYzMA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/417950630/reactions"
    },
    "updated_at": "2018-09-02T18:37:07Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/417950630",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6876108?v=4",
      "events_url": "https://api.github.com/users/BrucePay/events{/privacy}",
      "followers_url": "https://api.github.com/users/BrucePay/followers",
      "following_url": "https://api.github.com/users/BrucePay/following{/other_user}",
      "gists_url": "https://api.github.com/users/BrucePay/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/BrucePay",
      "id": 6876108,
      "login": "BrucePay",
      "node_id": "MDQ6VXNlcjY4NzYxMDg=",
      "organizations_url": "https://api.github.com/users/BrucePay/orgs",
      "received_events_url": "https://api.github.com/users/BrucePay/received_events",
      "repos_url": "https://api.github.com/users/BrucePay/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/BrucePay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BrucePay/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/BrucePay"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Indeed. I have been able to use the `dynamic` keyword with `PSObjects` in C# code.  ",
    "created_at": "2018-09-02T18:51:50Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7689#issuecomment-417951875",
    "id": 417951875,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7689",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNzk1MTg3NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/417951875/reactions"
    },
    "updated_at": "2018-09-02T18:51:50Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/417951875",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/5177512?v=4",
      "events_url": "https://api.github.com/users/rkeithhill/events{/privacy}",
      "followers_url": "https://api.github.com/users/rkeithhill/followers",
      "following_url": "https://api.github.com/users/rkeithhill/following{/other_user}",
      "gists_url": "https://api.github.com/users/rkeithhill/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rkeithhill",
      "id": 5177512,
      "login": "rkeithhill",
      "node_id": "MDQ6VXNlcjUxNzc1MTI=",
      "organizations_url": "https://api.github.com/users/rkeithhill/orgs",
      "received_events_url": "https://api.github.com/users/rkeithhill/received_events",
      "repos_url": "https://api.github.com/users/rkeithhill/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rkeithhill/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rkeithhill/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rkeithhill"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "You're right, I was just struggling with reflection on it. Works as expected!",
    "created_at": "2018-09-02T21:12:02Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7689#issuecomment-417960219",
    "id": 417960219,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7689",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNzk2MDIxOQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/417960219/reactions"
    },
    "updated_at": "2018-09-02T21:12:02Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/417960219",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/10532611?v=4",
      "events_url": "https://api.github.com/users/felixfbecker/events{/privacy}",
      "followers_url": "https://api.github.com/users/felixfbecker/followers",
      "following_url": "https://api.github.com/users/felixfbecker/following{/other_user}",
      "gists_url": "https://api.github.com/users/felixfbecker/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/felixfbecker",
      "id": 10532611,
      "login": "felixfbecker",
      "node_id": "MDQ6VXNlcjEwNTMyNjEx",
      "organizations_url": "https://api.github.com/users/felixfbecker/orgs",
      "received_events_url": "https://api.github.com/users/felixfbecker/received_events",
      "repos_url": "https://api.github.com/users/felixfbecker/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/felixfbecker/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/felixfbecker/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/felixfbecker"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Actually, I think I spoke too soon. It seems to be possible to _read_ properties from it as a dynamic object, but not possible to set _new_ properties on it as you can with `ExpandoObject` for example. I would expect to be able to set a new property on PSObjects, which would create a new NoteProperty if the property does not exist:\r\n```csharp\r\ndynamic obj = new PSObject(); // could be pipeline input etc\r\nobj.Annotations = 123;\r\n```\r\nInstead, it errors:\r\n```\r\nSystem.Management.Automation.SetValueInvocationException: Exception setting \"Annotations\": \"The property 'Annotations' cannot be found on this object. Verify that the property exists and can be set.\" ---> System.Management.Automation.RuntimeException: The property 'Annotations' cannot be found on this object. Verify that the property exists and can be set.\r\n   at System.Management.Automation.Language.PSSetMemberBinder.SetAdaptedValue(Object obj, String member, Object value)\r\n   --- End of inner exception stack trace ---\r\n   at System.Management.Automation.ExceptionHandlingOps.ConvertToMethodInvocationException(Exception exception, Type typeToThrow, String methodName, Int32 numArgs, MemberInfo memberInfo)\r\n   at System.Management.Automation.Language.PSSetMemberBinder.SetAdaptedValue(Object obj, String member, Object value)\r\n   at System.Dynamic.UpdateDelegates.UpdateAndExecute2[T0,T1,TRet](CallSite site, T0 arg0, T1 arg1)\r\n```",
    "created_at": "2018-09-04T00:05:45Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7689#issuecomment-418207753",
    "id": 418207753,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7689",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxODIwNzc1Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/418207753/reactions"
    },
    "updated_at": "2018-09-04T01:03:43Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/418207753",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/10532611?v=4",
      "events_url": "https://api.github.com/users/felixfbecker/events{/privacy}",
      "followers_url": "https://api.github.com/users/felixfbecker/followers",
      "following_url": "https://api.github.com/users/felixfbecker/following{/other_user}",
      "gists_url": "https://api.github.com/users/felixfbecker/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/felixfbecker",
      "id": 10532611,
      "login": "felixfbecker",
      "node_id": "MDQ6VXNlcjEwNTMyNjEx",
      "organizations_url": "https://api.github.com/users/felixfbecker/orgs",
      "received_events_url": "https://api.github.com/users/felixfbecker/received_events",
      "repos_url": "https://api.github.com/users/felixfbecker/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/felixfbecker/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/felixfbecker/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/felixfbecker"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@felixfbecker - there is no simple syntax for adding properties to `PSObject` - not in C# nor in PowerShell.  This is intentional and it helps avoid errors.\r\n\r\nIf you really do want `ExpandoObject` semantics, then just use `ExpandoObject`. I'm pretty sure you can even wrap an `ExpandoObject` in a `PSObject` and it will work as you'd expect.",
    "created_at": "2018-09-05T00:04:18Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7689#issuecomment-418556113",
    "id": 418556113,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7689",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxODU1NjExMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/418556113/reactions"
    },
    "updated_at": "2018-09-05T00:04:18Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/418556113",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/2148248?v=4",
      "events_url": "https://api.github.com/users/lzybkr/events{/privacy}",
      "followers_url": "https://api.github.com/users/lzybkr/followers",
      "following_url": "https://api.github.com/users/lzybkr/following{/other_user}",
      "gists_url": "https://api.github.com/users/lzybkr/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/lzybkr",
      "id": 2148248,
      "login": "lzybkr",
      "node_id": "MDQ6VXNlcjIxNDgyNDg=",
      "organizations_url": "https://api.github.com/users/lzybkr/orgs",
      "received_events_url": "https://api.github.com/users/lzybkr/received_events",
      "repos_url": "https://api.github.com/users/lzybkr/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/lzybkr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lzybkr/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/lzybkr"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Oh interesting, I wasn't aware of that. I always thought objects in PowerShell were like in JavaScript.\r\n\r\nThe use case I was dealing here with was I accepted `PSObject` _or_ strong .NET objects, and allowed the `PSObject` to be partial (missing properties that would just use the default value). I then had to set a nested properties on an input object, which could be either a `PSObject` or a .NET object. The .NET input would already have the property defined of course (even if not set), but a custom PSObject may have it not set. Maybe I felt the pain in C# more because in PowerShell, you can always use `Add-Member` to add a property to _any_ object, while in C#, I need to use assignment for .NET types, but `PSObject.Properties.Add()` for `PSObject`.\r\n\r\nI solved this at the moment with an extension method on `object` `SetDynamicPropertyValue()` that does this type switch and will add a `NoteProperty` if needed, which works fine, it's just a bit cumbersome. I think I just got overly excited that I can replace these extension methods with `dynamic` everywhere, but turns out I still need them for some aspects (adding properties).",
    "created_at": "2018-09-05T08:15:28Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/7689#issuecomment-418640970",
    "id": 418640970,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/7689",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxODY0MDk3MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/418640970/reactions"
    },
    "updated_at": "2018-09-05T08:15:28Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/418640970",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/10532611?v=4",
      "events_url": "https://api.github.com/users/felixfbecker/events{/privacy}",
      "followers_url": "https://api.github.com/users/felixfbecker/followers",
      "following_url": "https://api.github.com/users/felixfbecker/following{/other_user}",
      "gists_url": "https://api.github.com/users/felixfbecker/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/felixfbecker",
      "id": 10532611,
      "login": "felixfbecker",
      "node_id": "MDQ6VXNlcjEwNTMyNjEx",
      "organizations_url": "https://api.github.com/users/felixfbecker/orgs",
      "received_events_url": "https://api.github.com/users/felixfbecker/received_events",
      "repos_url": "https://api.github.com/users/felixfbecker/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/felixfbecker/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/felixfbecker/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/felixfbecker"
    }
  }
]

[
  {
    "author_association": "MEMBER",
    "body": "@anmenaga and @rjmholt Any idea on what might cause this issue?",
    "created_at": "2021-05-03T17:35:10Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15339#issuecomment-831414967",
    "id": 831414967,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15339",
    "node_id": "MDEyOklzc3VlQ29tbWVudDgzMTQxNDk2Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/831414967/reactions"
    },
    "updated_at": "2021-05-03T17:35:10Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/831414967",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "I can replicate this myself and thought I would share more information. One thing to note that was briefly mentioned at the end is the file is created it just has no content.\r\n\r\nWhat I've found is a few problems that cause other problems so I'll try and break it down.\r\n\r\n## Issue 1 - Out-File fails (this issue)\r\n\r\n`Out-File` fails, the file is created but is 0 length (no content).\r\n\r\n```powershell\r\nPS /home/jborean/dev> \"foo\" | Out-File /mnt/test_smb/folder/foo.txt\r\nOut-File: Access to the path '/mnt/test_smb/folder/foo.txt' is denied.\r\n\r\nPS /home/jborean/dev> $Error[0] | Select *\r\n\r\nPSMessageDetails      :\r\nException             : System.UnauthorizedAccessException: Access to the path '/mnt/test_smb/folder/foo.txt' is denied.\r\n                         ---> System.IO.IOException: Permission denied\r\n                           --- End of inner exception stack trace ---\r\n                           at System.IO.FileStream.WriteNative(ReadOnlySpan`1 source)\r\n                           at System.IO.FileStream.FlushWriteBuffer()\r\n                           at System.IO.FileStream.FlushInternalBuffer()\r\n                           at System.IO.FileStream.Flush(Boolean flushToDisk)\r\n                           at System.IO.FileStream.Flush()\r\n                           at System.IO.StreamWriter.Flush(Boolean flushStream, Boolean flushEncoder)\r\n                           at System.IO.StreamWriter.Flush()\r\n                           at Microsoft.PowerShell.Commands.OutFileCommand.ProcessRecord() in\r\n                        /PowerShell/src/Microsoft.PowerShell.Commands.Utility/commands/utility/FormatAndOutput/out-file/Out-File.cs:line 252\r\n                           at System.Management.Automation.Cmdlet.DoProcessRecord() in /PowerShell/src/System.Management.Automation/engine/cmdlet.cs:line 173\r\n                           at System.Management.Automation.CommandProcessor.ProcessRecord() in /PowerShell/src/System.Management.Automation/engine/CommandProcessor.cs:line 388\r\nTargetObject          :\r\nCategoryInfo          : NotSpecified: (:) [Out-File], UnauthorizedAccessException\r\nFullyQualifiedErrorId : System.UnauthorizedAccessException,Microsoft.PowerShell.Commands.OutFileCommand\r\nErrorDetails          :\r\nInvocationInfo        : System.Management.Automation.InvocationInfo\r\nScriptStackTrace      : at <ScriptBlock>, <No file>: line 1\r\nPipelineIterationInfo : {}\r\n\r\nPS /home/jborean/dev> ls -al /mnt/test_smb/folder/\r\ntotal 8\r\ndrwxr-xr-x. 2 jborean jborean    0 May  4 06:29 .\r\ndrwxr-xr-x. 2 jborean jborean 8192 May  4 06:26 ..\r\n-rwxr-xr-x. 1 jborean jborean    0 May  4 06:29 foo.txt\r\n```\r\n\r\nI'm looking at the commands mentioned in the stack trace and it seems like `Out-File` essentially does the following in .NET which also fails\r\n\r\n```powershell\r\n$fs = [IO.File]::Open(\"/mnt/test_smb/folder/foo.txt\", \"Create\",  \"Write\", \"Read\")\r\n$sw = [IO.StreamWriter]::new($fs)\r\n$sw.WriteLine(\"foo\")\r\n$sw.Dispose()\r\n\r\n# Fails with\r\nMethodInvocationException: Exception calling \"Dispose\" with \"0\" argument(s): \"Access to the path '/mnt/test_smb/folder/foo.txt' is denied.\"\r\nPS /home/jborean/dev> $Error[0] | Select *\r\n\r\nPSMessageDetails      :\r\nException             : System.Management.Automation.MethodInvocationException: Exception calling \"Dispose\" with \"0\" argument(s): \"Access to the path '/mnt/test_smb/folder/foo.txt'\r\n                        is denied.\"\r\n                         ---> System.UnauthorizedAccessException: Access to the path '/mnt/test_smb/folder/foo.txt' is denied.\r\n                         ---> System.IO.IOException: Permission denied\r\n                           --- End of inner exception stack trace ---\r\n                           at System.IO.FileStream.WriteNative(ReadOnlySpan`1 source)\r\n                           at System.IO.FileStream.FlushWriteBuffer()\r\n                           at System.IO.FileStream.Dispose(Boolean disposing)\r\n                           at System.IO.Stream.Close()\r\n                           at System.IO.StreamWriter.CloseStreamFromDispose(Boolean disposing)\r\n                           at System.IO.StreamWriter.Dispose(Boolean disposing)\r\n                           at CallSite.Target(Closure , CallSite , Object )\r\n                           --- End of inner exception stack trace ---\r\n                           at System.Management.Automation.ExceptionHandlingOps.ConvertToMethodInvocationException(Exception exception, Type typeToThrow, String methodName, Int32\r\n                        numArgs, MemberInfo memberInfo) in /PowerShell/src/System.Management.Automation/engine/runtime/Operations/MiscOps.cs:line 2068\r\n                           at CallSite.Target(Closure , CallSite , Object )\r\n                           at System.Dynamic.UpdateDelegates.UpdateAndExecute1[T0,TRet](CallSite site, T0 arg0)\r\n                           at System.Management.Automation.Interpreter.DynamicInstruction`2.Run(InterpretedFrame frame) in\r\n                        /PowerShell/src/System.Management.Automation/engine/interpreter/DynamicInstructions.Generated.cs:line 141\r\n                           at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame) in\r\n                        /PowerShell/src/System.Management.Automation/engine/interpreter/ControlFlowInstructions.cs:line 358\r\nTargetObject          :\r\nCategoryInfo          : NotSpecified: (:) [], MethodInvocationException\r\nFullyQualifiedErrorId : UnauthorizedAccessException\r\nErrorDetails          :\r\nInvocationInfo        : System.Management.Automation.InvocationInfo\r\nScriptStackTrace      : at <ScriptBlock>, <No file>: line 1\r\nPipelineIterationInfo : {}\r\n```\r\n\r\nThis is very weird because there isn't any failure in the SMB traffic returned from the server so Samba is doing something to return access denied for some reason. There's no attempt to write to the file, it just opens the handle, sends some set commands to change attributes but no write request. This may be an issue for the .NET team because it's not just PowerShell.\r\n\r\nWhat is even more curious is this issue seems to be related to the `FileShare` value. I can run the same .NET functions from above successfully if I omit the `FileShare` parameter or set it to `None`. Adding even more confusion to the pot is that Samba seems to be setting all of the `FileShare` values on the actual SMB open packet so something might be up with the client side share logic it has. This will require further investigation to figure out how `FileShare` actually operates on Linux and how .NET passes along that information to the native syscalls, i.e. .NET -> Samba.\r\n\r\n\r\n## Issue 2 - Add/Set-Content silently fails\r\n\r\nUsing `Set-Content` instead also has some confusing behaviour, it will not output an error but these cmdlets will create the file if it doesn't exist but will not set the content.\r\n\r\n```powershell\r\nPS /home/jborean/dev> ls -al /mnt/test_smb/folder\r\ntotal 8\r\ndrwxr-xr-x. 2 jborean jborean    0 May  4 06:56 .\r\ndrwxr-xr-x. 2 jborean jborean 8192 May  4 06:26 ..\r\n\r\nPS /home/jborean/dev> Set-Content /mnt/test_smb/folder/foo.txt \"foo\"\r\n\r\nPS /home/jborean/dev> ls -al /mnt/test_smb/folder\r\ntotal 8\r\ndrwxr-xr-x. 2 jborean jborean    0 May  4 06:57 .\r\ndrwxr-xr-x. 2 jborean jborean 8192 May  4 06:26 ..\r\n-rwxr-xr-x. 1 jborean jborean    0 May  4 06:57 foo.txt\r\n```\r\n\r\n```powershell\r\nPS /home/jborean/dev> ls -al /mnt/test_smb/folder\r\ntotal 8\r\ndrwxr-xr-x. 2 jborean jborean    0 May  4 06:58 .\r\ndrwxr-xr-x. 2 jborean jborean 8192 May  4 06:26 ..\r\nPS /home/jborean/dev> Add-Content /mnt/test_smb/folder/foo.txt \"foo\"\r\nPS /home/jborean/dev> ls -al /mnt/test_smb/folder\r\ntotal 8\r\ndrwxr-xr-x. 2 jborean jborean    0 May  4 06:58 .\r\ndrwxr-xr-x. 2 jborean jborean 8192 May  4 06:26 ..\r\n-rwxr-xr-x. 1 jborean jborean    0 May  4 06:58 foo.txt\r\n```\r\n\r\nSo things seem to be ok but in reality the commands didn't work.\r\n\r\n## Issue 3 - Add/Set-Content does not close the file handle\r\n\r\nAt least with the example above, the SMB open is not closed when the commands are finished. This leaves a handle still opened on the SMB server causing issues when subsequent requests go to open the file with exclusive access or the file is deleted. Using the delete example we can see that the file isn't actually deleted until all the handles are closed (pwsh is closed/GC is collected)\r\n\r\n```powershell\r\nPS /home/jborean/dev> Set-Content /mnt/test_smb/folder/foo.txt \"value\"\r\n\r\nPS /home/jborean/dev> ls -al /mnt/test_smb/folder/\r\ntotal 8\r\ndrwxr-xr-x. 2 jborean jborean    0 May  4 07:04 .\r\ndrwxr-xr-x. 2 jborean jborean 8192 May  4 06:26 ..\r\n-rwxr-xr-x. 1 jborean jborean    0 May  4 07:04 foo.txt\r\n\r\nPS /home/jborean/dev> Remove-Item /mnt/test_smb/folder/foo.txt\r\n\r\nPS /home/jborean/dev> ls -al /mnt/test_smb/folder/\r\ntotal 8\r\ndrwxr-xr-x. 2 jborean jborean    0 May  4 07:04 .\r\ndrwxr-xr-x. 2 jborean jborean 8192 May  4 06:26 ..\r\n-rwxr-xr-x. 0 jborean jborean    0 May  4 07:04 foo.txt\r\n\r\nPS /home/jborean/dev> [GC]::Collect(); [GC]::WaitForPendingFinalizers()\r\n\r\nPS /home/jborean/dev> ls -al /mnt/test_smb/folder/\r\ntotal 8\r\ndrwxr-xr-x. 2 jborean jborean    0 May  4 07:05 .\r\ndrwxr-xr-x. 2 jborean jborean 8192 May  4 06:26 ..\r\n```\r\n\r\nYou can see that the file is still present after the `Remove-Item` because the handle opened by `Set-Content` wasn't closed and it's only until the garbage collector has collected those handles that the file is actually deleted. Because this is dependent on when the GC runs you might get lucky and have it dispose of the handles relatively quickly but you cannot guarantee it will always run without explicitly calling it.\r\n\r\nThis can cause confusing errors if you try to then write to the file again that's still pending a delete\r\n\r\n```powershell\r\nPS /home/jborean/dev> Set-Content /mnt/test_smb/folder/foo.txt \"value\"\r\n\r\nPS /home/jborean/dev> Remove-Item /mnt/test_smb/folder/foo.txt\r\n\r\nPS /home/jborean/dev> Set-Content /mnt/test_smb/folder/foo.txt \"value\"\r\nSet-Content: Could not find file '/mnt/test_smb/folder/foo.txt'.\r\n```\r\n\r\nIt states it couldn't find the file even though you want to create it with `Set-Content`. This is because the SMB response to opening that file returns `STATUS_DELETE_PENDING` because the original file still has a handle open to it (from the first `Set-Content` command).\r\n\r\nIt seems like there might be a stray handle in the code that `Add/Set-Content` calls that should be explicitly scoped with a `using (...)` where it is called.",
    "created_at": "2021-05-03T21:14:52Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15339#issuecomment-831538310",
    "id": 831538310,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15339",
    "node_id": "MDEyOklzc3VlQ29tbWVudDgzMTUzODMxMA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 3,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 3,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/831538310/reactions"
    },
    "updated_at": "2021-05-03T21:14:52Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/831538310",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8462645?v=4",
      "events_url": "https://api.github.com/users/jborean93/events{/privacy}",
      "followers_url": "https://api.github.com/users/jborean93/followers",
      "following_url": "https://api.github.com/users/jborean93/following{/other_user}",
      "gists_url": "https://api.github.com/users/jborean93/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jborean93",
      "id": 8462645,
      "login": "jborean93",
      "node_id": "MDQ6VXNlcjg0NjI2NDU=",
      "organizations_url": "https://api.github.com/users/jborean93/orgs",
      "received_events_url": "https://api.github.com/users/jborean93/received_events",
      "repos_url": "https://api.github.com/users/jborean93/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jborean93/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jborean93/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jborean93"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "Good findings @jborean93, thanks! It's really strange that Add/Set-Content fails silently.",
    "created_at": "2021-05-04T00:03:06Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15339#issuecomment-831608497",
    "id": 831608497,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15339",
    "node_id": "MDEyOklzc3VlQ29tbWVudDgzMTYwODQ5Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/831608497/reactions"
    },
    "updated_at": "2021-05-04T00:03:06Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/831608497",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Thanks @jborean93  for the detailed analysis.\r\n\r\nLooks like a .NET issue to me, who's supposed to file it there?",
    "created_at": "2021-05-07T17:58:57Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15339#issuecomment-834658248",
    "id": 834658248,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15339",
    "node_id": "MDEyOklzc3VlQ29tbWVudDgzNDY1ODI0OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/834658248/reactions"
    },
    "updated_at": "2021-05-07T17:58:57Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/834658248",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12860484?v=4",
      "events_url": "https://api.github.com/users/sba923/events{/privacy}",
      "followers_url": "https://api.github.com/users/sba923/followers",
      "following_url": "https://api.github.com/users/sba923/following{/other_user}",
      "gists_url": "https://api.github.com/users/sba923/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/sba923",
      "id": 12860484,
      "login": "sba923",
      "node_id": "MDQ6VXNlcjEyODYwNDg0",
      "organizations_url": "https://api.github.com/users/sba923/orgs",
      "received_events_url": "https://api.github.com/users/sba923/received_events",
      "repos_url": "https://api.github.com/users/sba923/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/sba923/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sba923/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/sba923"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "This even breaks `Move-Item`: the file is copied, then an `Move-Item: Access to the path is denied.` error is reported, and the source file is not deleted.\r\n",
    "created_at": "2021-05-08T11:10:58Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15339#issuecomment-835300903",
    "id": 835300903,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15339",
    "node_id": "MDEyOklzc3VlQ29tbWVudDgzNTMwMDkwMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/835300903/reactions"
    },
    "updated_at": "2021-05-08T11:10:58Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/835300903",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12860484?v=4",
      "events_url": "https://api.github.com/users/sba923/events{/privacy}",
      "followers_url": "https://api.github.com/users/sba923/followers",
      "following_url": "https://api.github.com/users/sba923/following{/other_user}",
      "gists_url": "https://api.github.com/users/sba923/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/sba923",
      "id": 12860484,
      "login": "sba923",
      "node_id": "MDQ6VXNlcjEyODYwNDg0",
      "organizations_url": "https://api.github.com/users/sba923/orgs",
      "received_events_url": "https://api.github.com/users/sba923/received_events",
      "repos_url": "https://api.github.com/users/sba923/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/sba923/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sba923/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/sba923"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "`Copy-Item` also reports \"Access denied\", _even with `-ErrorAction SilentlyContinue`_",
    "created_at": "2021-05-08T13:21:03Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15339#issuecomment-835361477",
    "id": 835361477,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15339",
    "node_id": "MDEyOklzc3VlQ29tbWVudDgzNTM2MTQ3Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/835361477/reactions"
    },
    "updated_at": "2021-05-08T13:21:03Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/835361477",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12860484?v=4",
      "events_url": "https://api.github.com/users/sba923/events{/privacy}",
      "followers_url": "https://api.github.com/users/sba923/followers",
      "following_url": "https://api.github.com/users/sba923/following{/other_user}",
      "gists_url": "https://api.github.com/users/sba923/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/sba923",
      "id": 12860484,
      "login": "sba923",
      "node_id": "MDQ6VXNlcjEyODYwNDg0",
      "organizations_url": "https://api.github.com/users/sba923/orgs",
      "received_events_url": "https://api.github.com/users/sba923/received_events",
      "repos_url": "https://api.github.com/users/sba923/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/sba923/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sba923/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/sba923"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@sba923 Since you have the repro environment, can you please file an issue in [dotnet/runtime](https://github.com/dotnet/runtime)?\r\n\r\n@jborean93 shared the C# repro code (written in ps script) in his post:\r\n>```\r\n>$fs = [IO.File]::Open(\"/mnt/test_smb/folder/foo.txt\", \"Create\",  \"Write\", \"Read\")\r\n>$sw = [IO.StreamWriter]::new($fs)\r\n>$sw.WriteLine(\"foo\")\r\n>$sw.Dispose()\r\n>```",
    "created_at": "2021-05-08T18:47:35Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15339#issuecomment-835468512",
    "id": 835468512,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15339",
    "node_id": "MDEyOklzc3VlQ29tbWVudDgzNTQ2ODUxMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/835468512/reactions"
    },
    "updated_at": "2021-05-08T18:47:35Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/835468512",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "> @sba923 Since you have the repro environment, can you please file an issue in [dotnet/runtime](https://github.com/dotnet/runtime)?\r\n> \r\n> @jborean93 shared the C# repro code (written in ps script) in his post:\r\n> \r\n> > ```\r\n> > $fs = [IO.File]::Open(\"/mnt/test_smb/folder/foo.txt\", \"Create\",  \"Write\", \"Read\")\r\n> > $sw = [IO.StreamWriter]::new($fs)\r\n> > $sw.WriteLine(\"foo\")\r\n> > $sw.Dispose()\r\n> > ```\r\n\r\nOpened https://github.com/dotnet/runtime/issues/53182",
    "created_at": "2021-05-24T16:26:50Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15339#issuecomment-847162915",
    "id": 847162915,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15339",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0NzE2MjkxNQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/847162915/reactions"
    },
    "updated_at": "2021-05-24T16:26:50Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/847162915",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12860484?v=4",
      "events_url": "https://api.github.com/users/sba923/events{/privacy}",
      "followers_url": "https://api.github.com/users/sba923/followers",
      "following_url": "https://api.github.com/users/sba923/following{/other_user}",
      "gists_url": "https://api.github.com/users/sba923/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/sba923",
      "id": 12860484,
      "login": "sba923",
      "node_id": "MDQ6VXNlcjEyODYwNDg0",
      "organizations_url": "https://api.github.com/users/sba923/orgs",
      "received_events_url": "https://api.github.com/users/sba923/received_events",
      "repos_url": "https://api.github.com/users/sba923/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/sba923/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sba923/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/sba923"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "https://github.com/dotnet/runtime/issues/53182 is now resolved. How is this going to ripple into PowerShell?",
    "created_at": "2021-07-09T16:34:40Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15339#issuecomment-877311208",
    "id": 877311208,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15339",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3NzMxMTIwOA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/877311208/reactions"
    },
    "updated_at": "2021-07-09T16:34:51Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/877311208",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12860484?v=4",
      "events_url": "https://api.github.com/users/sba923/events{/privacy}",
      "followers_url": "https://api.github.com/users/sba923/followers",
      "following_url": "https://api.github.com/users/sba923/following{/other_user}",
      "gists_url": "https://api.github.com/users/sba923/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/sba923",
      "id": 12860484,
      "login": "sba923",
      "node_id": "MDQ6VXNlcjEyODYwNDg0",
      "organizations_url": "https://api.github.com/users/sba923/orgs",
      "received_events_url": "https://api.github.com/users/sba923/received_events",
      "repos_url": "https://api.github.com/users/sba923/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/sba923/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sba923/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/sba923"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "I guess we get this in .Net Runtime 6.0 Preview7.",
    "created_at": "2021-07-12T09:13:52Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15339#issuecomment-878111629",
    "id": 878111629,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15339",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3ODExMTYyOQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/878111629/reactions"
    },
    "updated_at": "2021-07-12T09:13:52Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/878111629",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "So could make it in 7.2.0-preview.9?",
    "created_at": "2021-08-16T13:24:32Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15339#issuecomment-899508149",
    "id": 899508149,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15339",
    "node_id": "IC_kwDOAvT7bc41nWe1",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/899508149/reactions"
    },
    "updated_at": "2021-08-16T13:24:32Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/899508149",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12860484?v=4",
      "events_url": "https://api.github.com/users/sba923/events{/privacy}",
      "followers_url": "https://api.github.com/users/sba923/followers",
      "following_url": "https://api.github.com/users/sba923/following{/other_user}",
      "gists_url": "https://api.github.com/users/sba923/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/sba923",
      "id": 12860484,
      "login": "sba923",
      "node_id": "MDQ6VXNlcjEyODYwNDg0",
      "organizations_url": "https://api.github.com/users/sba923/orgs",
      "received_events_url": "https://api.github.com/users/sba923/received_events",
      "repos_url": "https://api.github.com/users/sba923/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/sba923/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sba923/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/sba923"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "MSFT team works on moving to  .Net Runtime 6.0 Preview7.",
    "created_at": "2021-08-16T14:07:34Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15339#issuecomment-899540512",
    "id": 899540512,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15339",
    "node_id": "IC_kwDOAvT7bc41neYg",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/899540512/reactions"
    },
    "updated_at": "2021-08-16T14:07:34Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/899540512",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Issue is still present in PowerShell 7.3.0-preview.1",
    "created_at": "2021-12-21T12:31:30Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15339#issuecomment-998741085",
    "id": 998741085,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15339",
    "node_id": "IC_kwDOAvT7bc47h5Rd",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/998741085/reactions"
    },
    "updated_at": "2021-12-21T12:31:30Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/998741085",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12860484?v=4",
      "events_url": "https://api.github.com/users/sba923/events{/privacy}",
      "followers_url": "https://api.github.com/users/sba923/followers",
      "following_url": "https://api.github.com/users/sba923/following{/other_user}",
      "gists_url": "https://api.github.com/users/sba923/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/sba923",
      "id": 12860484,
      "login": "sba923",
      "node_id": "MDQ6VXNlcjEyODYwNDg0",
      "organizations_url": "https://api.github.com/users/sba923/orgs",
      "received_events_url": "https://api.github.com/users/sba923/received_events",
      "repos_url": "https://api.github.com/users/sba923/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/sba923/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sba923/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/sba923"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Doesn't the example work too?\r\n```powershell\r\n$fs = [IO.File]::Open(\"/mnt/test_smb/folder/foo.txt\", \"Create\",  \"Write\", \"Read\")\r\n$sw = [IO.StreamWriter]::new($fs)\r\n$sw.WriteLine(\"foo\")\r\n$sw.Dispose()\r\n```",
    "created_at": "2021-12-21T13:05:43Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15339#issuecomment-998762817",
    "id": 998762817,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15339",
    "node_id": "IC_kwDOAvT7bc47h-lB",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/998762817/reactions"
    },
    "updated_at": "2021-12-21T13:05:43Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/998762817",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "I see you continue investigations with .Net team.",
    "created_at": "2021-12-21T13:08:18Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15339#issuecomment-998764740",
    "id": 998764740,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15339",
    "node_id": "IC_kwDOAvT7bc47h_DE",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/998764740/reactions"
    },
    "updated_at": "2021-12-21T13:08:18Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/998764740",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "> Doesn't the example work too?\r\n> \r\n> ```powershell\r\n> $fs = [IO.File]::Open(\"/mnt/test_smb/folder/foo.txt\", \"Create\",  \"Write\", \"Read\")\r\n> $sw = [IO.StreamWriter]::new($fs)\r\n> $sw.WriteLine(\"foo\")\r\n> $sw.Dispose()\r\n> ```\r\n\r\nThis fails too:\r\n\r\n![image](https://user-images.githubusercontent.com/12860484/146935430-ab886884-f912-4957-9391-88c4daf8896e.png)\r\n",
    "created_at": "2021-12-21T13:09:59Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15339#issuecomment-998766026",
    "id": 998766026,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15339",
    "node_id": "IC_kwDOAvT7bc47h_XK",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/998766026/reactions"
    },
    "updated_at": "2021-12-21T13:09:59Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/998766026",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12860484?v=4",
      "events_url": "https://api.github.com/users/sba923/events{/privacy}",
      "followers_url": "https://api.github.com/users/sba923/followers",
      "following_url": "https://api.github.com/users/sba923/following{/other_user}",
      "gists_url": "https://api.github.com/users/sba923/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/sba923",
      "id": 12860484,
      "login": "sba923",
      "node_id": "MDQ6VXNlcjEyODYwNDg0",
      "organizations_url": "https://api.github.com/users/sba923/orgs",
      "received_events_url": "https://api.github.com/users/sba923/received_events",
      "repos_url": "https://api.github.com/users/sba923/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/sba923/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sba923/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/sba923"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "> I see you continue investigations with .Net team.\r\n\r\nThis sure is my plan, but I see no response there since .NET 6 shipped...",
    "created_at": "2021-12-21T13:10:50Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15339#issuecomment-998766642",
    "id": 998766642,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15339",
    "node_id": "IC_kwDOAvT7bc47h_gy",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/998766642/reactions"
    },
    "updated_at": "2021-12-21T13:10:50Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/998766642",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12860484?v=4",
      "events_url": "https://api.github.com/users/sba923/events{/privacy}",
      "followers_url": "https://api.github.com/users/sba923/followers",
      "following_url": "https://api.github.com/users/sba923/following{/other_user}",
      "gists_url": "https://api.github.com/users/sba923/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/sba923",
      "id": 12860484,
      "login": "sba923",
      "node_id": "MDQ6VXNlcjEyODYwNDg0",
      "organizations_url": "https://api.github.com/users/sba923/orgs",
      "received_events_url": "https://api.github.com/users/sba923/received_events",
      "repos_url": "https://api.github.com/users/sba923/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/sba923/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sba923/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/sba923"
    }
  },
  {
    "author_association": "NONE",
    "body": "Having the same issue. PS version info below.\r\n```\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.2.1\r\nPSEdition                      Core\r\nGitCommitId                    7.2.1\r\nOS                             Linux 5.10.63-v7+ #1459 SMP Wed Oct 6 16:41:10 …\r\nPlatform                       Unix\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0…}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n\r\nI have tried all the above examples and all have failed. Any word on if the MS team has plans to address this issue soon?",
    "created_at": "2022-03-10T03:33:54Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15339#issuecomment-1063617409",
    "id": 1063617409,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15339",
    "node_id": "IC_kwDOAvT7bc4_ZYOB",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1063617409/reactions"
    },
    "updated_at": "2022-03-10T03:33:54Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1063617409",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/73497858?v=4",
      "events_url": "https://api.github.com/users/amorenojr/events{/privacy}",
      "followers_url": "https://api.github.com/users/amorenojr/followers",
      "following_url": "https://api.github.com/users/amorenojr/following{/other_user}",
      "gists_url": "https://api.github.com/users/amorenojr/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/amorenojr",
      "id": 73497858,
      "login": "amorenojr",
      "node_id": "MDQ6VXNlcjczNDk3ODU4",
      "organizations_url": "https://api.github.com/users/amorenojr/orgs",
      "received_events_url": "https://api.github.com/users/amorenojr/received_events",
      "repos_url": "https://api.github.com/users/amorenojr/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/amorenojr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/amorenojr/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/amorenojr"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "The core issue has been fixed by https://github.com/dotnet/runtime/issues/61175, now we have to wait until this ripples up to PowerShell 7.2 (via a backport of the fix to .NET 6) and PowerShell 7.3.\r\n",
    "created_at": "2022-06-03T04:51:37Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15339#issuecomment-1145582318",
    "id": 1145582318,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15339",
    "node_id": "IC_kwDOAvT7bc5ESDLu",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1145582318/reactions"
    },
    "updated_at": "2022-06-03T04:51:37Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1145582318",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12860484?v=4",
      "events_url": "https://api.github.com/users/sba923/events{/privacy}",
      "followers_url": "https://api.github.com/users/sba923/followers",
      "following_url": "https://api.github.com/users/sba923/following{/other_user}",
      "gists_url": "https://api.github.com/users/sba923/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/sba923",
      "id": 12860484,
      "login": "sba923",
      "node_id": "MDQ6VXNlcjEyODYwNDg0",
      "organizations_url": "https://api.github.com/users/sba923/orgs",
      "received_events_url": "https://api.github.com/users/sba923/received_events",
      "repos_url": "https://api.github.com/users/sba923/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/sba923/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sba923/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/sba923"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "FWIW, problem is (expectedly) still present in 7.3.0-preview.5",
    "created_at": "2022-06-24T09:13:17Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15339#issuecomment-1165373473",
    "id": 1165373473,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15339",
    "node_id": "IC_kwDOAvT7bc5FdjAh",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1165373473/reactions"
    },
    "updated_at": "2022-06-24T09:13:17Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1165373473",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12860484?v=4",
      "events_url": "https://api.github.com/users/sba923/events{/privacy}",
      "followers_url": "https://api.github.com/users/sba923/followers",
      "following_url": "https://api.github.com/users/sba923/following{/other_user}",
      "gists_url": "https://api.github.com/users/sba923/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/sba923",
      "id": 12860484,
      "login": "sba923",
      "node_id": "MDQ6VXNlcjEyODYwNDg0",
      "organizations_url": "https://api.github.com/users/sba923/orgs",
      "received_events_url": "https://api.github.com/users/sba923/received_events",
      "repos_url": "https://api.github.com/users/sba923/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/sba923/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sba923/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/sba923"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Based on @adamsitnik's comment in https://github.com/dotnet/runtime/issues/61175, the next steps are:\r\n\r\n1. check if issue is fixed in 7.3.0-preview.6 when available\r\n2. backport of the fix for https://github.com/dotnet/runtime/issues/61175 in .NET 7 to .NET 6\r\n3. release of some 7.2.x LTS version incorporating said backport",
    "created_at": "2022-07-18T15:03:27Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15339#issuecomment-1187612622",
    "id": 1187612622,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15339",
    "node_id": "IC_kwDOAvT7bc5GyYfO",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1187612622/reactions"
    },
    "updated_at": "2022-07-18T15:03:27Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1187612622",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12860484?v=4",
      "events_url": "https://api.github.com/users/sba923/events{/privacy}",
      "followers_url": "https://api.github.com/users/sba923/followers",
      "following_url": "https://api.github.com/users/sba923/following{/other_user}",
      "gists_url": "https://api.github.com/users/sba923/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/sba923",
      "id": 12860484,
      "login": "sba923",
      "node_id": "MDQ6VXNlcjEyODYwNDg0",
      "organizations_url": "https://api.github.com/users/sba923/orgs",
      "received_events_url": "https://api.github.com/users/sba923/received_events",
      "repos_url": "https://api.github.com/users/sba923/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/sba923/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sba923/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/sba923"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@adamsitnik I confirm the problem's no longer present in 7.3.0-preview.6:\r\n\r\n![image](https://user-images.githubusercontent.com/12860484/179666302-e68e163b-c6f7-4835-985f-a6d3a8d63a48.png)\r\n\r\n![image](https://user-images.githubusercontent.com/12860484/179666402-c320d539-50c8-4929-9c67-2e4ad3c8cffb.png)\r\n",
    "created_at": "2022-07-19T04:43:52Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15339#issuecomment-1188592904",
    "id": 1188592904,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15339",
    "node_id": "IC_kwDOAvT7bc5G2H0I",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1188592904/reactions"
    },
    "updated_at": "2022-07-19T04:43:52Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1188592904",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12860484?v=4",
      "events_url": "https://api.github.com/users/sba923/events{/privacy}",
      "followers_url": "https://api.github.com/users/sba923/followers",
      "following_url": "https://api.github.com/users/sba923/following{/other_user}",
      "gists_url": "https://api.github.com/users/sba923/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/sba923",
      "id": 12860484,
      "login": "sba923",
      "node_id": "MDQ6VXNlcjEyODYwNDg0",
      "organizations_url": "https://api.github.com/users/sba923/orgs",
      "received_events_url": "https://api.github.com/users/sba923/received_events",
      "repos_url": "https://api.github.com/users/sba923/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/sba923/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sba923/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/sba923"
    }
  },
  {
    "author_association": "NONE",
    "body": "This issue has been marked as external and has not had any activity for **1 day**. It has been be closed for housekeeping purposes.",
    "created_at": "2022-07-20T07:01:13Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15339#issuecomment-1189904361",
    "id": 1189904361,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15339",
    "node_id": "IC_kwDOAvT7bc5G7H_p",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1189904361/reactions"
    },
    "updated_at": "2022-07-20T07:01:13Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1189904361",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "The issue was closed by the bot, but there's still no official (non-preview) release of PowerShell that includes the fix.\r\n\r\n@SteveL-MSFT what's the standard w.r.t. keeping issues open in such a context?",
    "created_at": "2022-07-20T13:01:14Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15339#issuecomment-1190258709",
    "id": 1190258709,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15339",
    "node_id": "IC_kwDOAvT7bc5G8egV",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1190258709/reactions"
    },
    "updated_at": "2022-07-20T13:01:14Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1190258709",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12860484?v=4",
      "events_url": "https://api.github.com/users/sba923/events{/privacy}",
      "followers_url": "https://api.github.com/users/sba923/followers",
      "following_url": "https://api.github.com/users/sba923/following{/other_user}",
      "gists_url": "https://api.github.com/users/sba923/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/sba923",
      "id": 12860484,
      "login": "sba923",
      "node_id": "MDQ6VXNlcjEyODYwNDg0",
      "organizations_url": "https://api.github.com/users/sba923/orgs",
      "received_events_url": "https://api.github.com/users/sba923/received_events",
      "repos_url": "https://api.github.com/users/sba923/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/sba923/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sba923/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/sba923"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "An issue will be closed when it's confirmed fixed. The preview PowerShell will eventually move to GA release.",
    "created_at": "2022-07-20T16:16:00Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15339#issuecomment-1190483700",
    "id": 1190483700,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15339",
    "node_id": "IC_kwDOAvT7bc5G9Vb0",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1190483700/reactions"
    },
    "updated_at": "2022-07-20T16:16:00Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1190483700",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "> An issue will be closed when it's confirmed fixed. The preview PowerShell will eventually move to GA release.\r\n\r\nThanks for the clarification.\r\n\r\nThis does make sense but just doesn't align with what I used to live with during my 25 R&D years where, considering the possibility of a regression between a test version and GA, customer-reported issues were closed only after having been tested as fixed on the next GA release.",
    "created_at": "2022-07-20T18:06:28Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15339#issuecomment-1190593536",
    "id": 1190593536,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15339",
    "node_id": "IC_kwDOAvT7bc5G9wQA",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1190593536/reactions"
    },
    "updated_at": "2022-07-20T18:06:28Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1190593536",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/12860484?v=4",
      "events_url": "https://api.github.com/users/sba923/events{/privacy}",
      "followers_url": "https://api.github.com/users/sba923/followers",
      "following_url": "https://api.github.com/users/sba923/following{/other_user}",
      "gists_url": "https://api.github.com/users/sba923/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/sba923",
      "id": 12860484,
      "login": "sba923",
      "node_id": "MDQ6VXNlcjEyODYwNDg0",
      "organizations_url": "https://api.github.com/users/sba923/orgs",
      "received_events_url": "https://api.github.com/users/sba923/received_events",
      "repos_url": "https://api.github.com/users/sba923/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/sba923/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sba923/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/sba923"
    }
  }
]

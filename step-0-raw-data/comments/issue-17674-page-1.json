[
  {
    "author_association": "COLLABORATOR",
    "body": "Hm, what version of PowerShellGet do you have installed with PS7? The command 'get-Module PowerShellGet -ListAvailable' gets that for you.  cc @SydneyhSmith and @alerickson ",
    "created_at": "2022-07-18T20:00:33Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17674#issuecomment-1188243331",
    "id": 1188243331,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17674",
    "node_id": "IC_kwDOAvT7bc5G0yeD",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1188243331/reactions"
    },
    "updated_at": "2022-07-18T20:00:33Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1188243331",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/20605456?v=4",
      "events_url": "https://api.github.com/users/StevenBucher98/events{/privacy}",
      "followers_url": "https://api.github.com/users/StevenBucher98/followers",
      "following_url": "https://api.github.com/users/StevenBucher98/following{/other_user}",
      "gists_url": "https://api.github.com/users/StevenBucher98/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/StevenBucher98",
      "id": 20605456,
      "login": "StevenBucher98",
      "node_id": "MDQ6VXNlcjIwNjA1NDU2",
      "organizations_url": "https://api.github.com/users/StevenBucher98/orgs",
      "received_events_url": "https://api.github.com/users/StevenBucher98/received_events",
      "repos_url": "https://api.github.com/users/StevenBucher98/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/StevenBucher98/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/StevenBucher98/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/StevenBucher98"
    }
  },
  {
    "author_association": "NONE",
    "body": "```\r\nPS D:\\repos\\1JS\\ooui\\apps\\wac-wordeditor> get-Module PowerShellGet -ListAvailable\r\n\r\n    Directory: C:\\users\\aolanrewaju\\.dotnet\\tools\\.store\\powershell\\7.2.4\\powershell\\7.2.4\\tools\\net6.0\\any\\win\\Modules\r\n\r\nModuleType Version    PreRelease Name                                PSEdition ExportedCommands\r\n---------- -------    ---------- ----                                --------- ----------------\r\nScript     2.2.5                 PowerShellGet                       Desk      {Find-Command, Find-DSCResource, Find-Module, Find-RoleCapability…}\r\n\r\n    Directory: C:\\Program Files\\WindowsPowerShell\\Modules\r\n\r\nModuleType Version    PreRelease Name                                PSEdition ExportedCommands\r\n---------- -------    ---------- ----                                --------- ----------------\r\nScript     2.2.5                 PowerShellGet                       Desk      {Find-Command, Find-DSCResource, Find-Module, Find-RoleCapability…}\r\nScript     1.0.0.1               PowerShellGet                       Desk      {Install-Module, Find-Module, Save-Module, Update-Module…}\r\n\r\nPS D:\\repos\\1JS\\ooui\\apps\\wac-wordeditor> $psversiontable\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.2.4\r\nPSEdition                      Core\r\nGitCommitId                    7.2.4\r\nOS                             Microsoft Windows 10.0.19044\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0…}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n\r\nI noticed that when I change `$Env:PSModulePath` for the current process to just use the paths defined for powershell 5.1 modules as described [here](https://docs.microsoft.com/en-us/powershell/scripting/whats-new/migrating-from-windows-powershell-51-to-powershell-7?view=powershell-7.2#separate-psmodulepath) The problem gets fixed. Is there a better way to fix this? Why is this happening? Here is what the original `$Env:PSModulePath` looks like before I update it\r\n\r\n```PS C:\\Users\\aolanrewaju> $Env:PSModulePath -split (';')\r\nC:\\Users\\aolanrewaju\\Documents\\PowerShell\\Modules\r\nC:\\Program Files\\PowerShell\\Modules\r\nc:\\users\\aolanrewaju\\.dotnet\\tools\\.store\\powershell\\7.2.4\\powershell\\7.2.4\\tools\\net6.0\\any\\win\\Modules\r\nC:\\Users\\aolanrewaju\\Documents\\WindowsPowerShell\\Modules\r\nC:\\Program Files\\WindowsPowerShell\\Modules\r\nC:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\r\nC:\\Program Files (x86)\\Microsoft Azure Information Protection\\Powershell\r\nPS C:\\Users\\aolanrewaju>\r\n```",
    "created_at": "2022-07-18T20:11:44Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17674#issuecomment-1188254057",
    "id": 1188254057,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17674",
    "node_id": "IC_kwDOAvT7bc5G01Fp",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1188254057/reactions"
    },
    "updated_at": "2022-07-18T20:11:44Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1188254057",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/105387865?v=4",
      "events_url": "https://api.github.com/users/aolanrewaju/events{/privacy}",
      "followers_url": "https://api.github.com/users/aolanrewaju/followers",
      "following_url": "https://api.github.com/users/aolanrewaju/following{/other_user}",
      "gists_url": "https://api.github.com/users/aolanrewaju/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/aolanrewaju",
      "id": 105387865,
      "login": "aolanrewaju",
      "node_id": "U_kgDOBkgXWQ",
      "organizations_url": "https://api.github.com/users/aolanrewaju/orgs",
      "received_events_url": "https://api.github.com/users/aolanrewaju/received_events",
      "repos_url": "https://api.github.com/users/aolanrewaju/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/aolanrewaju/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aolanrewaju/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/aolanrewaju"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@aolanrewaju How did you install PowerShell 7? ",
    "created_at": "2022-07-18T20:26:36Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17674#issuecomment-1188271573",
    "id": 1188271573,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17674",
    "node_id": "IC_kwDOAvT7bc5G05XV",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1188271573/reactions"
    },
    "updated_at": "2022-07-18T20:26:36Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1188271573",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/20605456?v=4",
      "events_url": "https://api.github.com/users/StevenBucher98/events{/privacy}",
      "followers_url": "https://api.github.com/users/StevenBucher98/followers",
      "following_url": "https://api.github.com/users/StevenBucher98/following{/other_user}",
      "gists_url": "https://api.github.com/users/StevenBucher98/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/StevenBucher98",
      "id": 20605456,
      "login": "StevenBucher98",
      "node_id": "MDQ6VXNlcjIwNjA1NDU2",
      "organizations_url": "https://api.github.com/users/StevenBucher98/orgs",
      "received_events_url": "https://api.github.com/users/StevenBucher98/received_events",
      "repos_url": "https://api.github.com/users/StevenBucher98/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/StevenBucher98/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/StevenBucher98/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/StevenBucher98"
    }
  },
  {
    "author_association": "NONE",
    "body": "I don't remember exactly. Powershell 7 is not the default on my machine, 5.1 is. To run with 7 I just run pwsh. Multiple people running powershell 7 have experienced this same issue though. Should I try to reinstall?",
    "created_at": "2022-07-18T20:29:58Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17674#issuecomment-1188274373",
    "id": 1188274373,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17674",
    "node_id": "IC_kwDOAvT7bc5G06DF",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1188274373/reactions"
    },
    "updated_at": "2022-07-18T20:29:58Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1188274373",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/105387865?v=4",
      "events_url": "https://api.github.com/users/aolanrewaju/events{/privacy}",
      "followers_url": "https://api.github.com/users/aolanrewaju/followers",
      "following_url": "https://api.github.com/users/aolanrewaju/following{/other_user}",
      "gists_url": "https://api.github.com/users/aolanrewaju/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/aolanrewaju",
      "id": 105387865,
      "login": "aolanrewaju",
      "node_id": "U_kgDOBkgXWQ",
      "organizations_url": "https://api.github.com/users/aolanrewaju/orgs",
      "received_events_url": "https://api.github.com/users/aolanrewaju/received_events",
      "repos_url": "https://api.github.com/users/aolanrewaju/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/aolanrewaju/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aolanrewaju/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/aolanrewaju"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "In this scenario, it looks like `execSync()` is a node API to run a command line.  So presumably the users are running this node script from within either powershell.exe or pwsh.exe and having issues.  Between the two environments, the `$env:PSModulePath` is different as 5.1 and 7 run side-by-side although 7 does peek into 5.1 paths but 5.1 does not peek into 7 paths.  However, a install or reinstall shouldn't have any effect.\r\n\r\nPowerShellGet is distributed separately with both Windows PowerShell and PowerShell 7, but the versions may be different if they are not upgraded to latest version.  So what it looks like to me is that for PowerShell 7 users, the powershell.exe that is created would inherit `$env:PSModulePath` from PowerShell 7 and having a problem importing PowerShellGet.  If you have a repro, you can try within `execSync()` do a `import powershellget -verbose` and tell us what is returned.\r\n\r\nAs a workaround, you could detect if the host environment is `powershell.exe` or `pwsh.exe` and use the appropriate one.",
    "created_at": "2022-07-18T21:14:04Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17674#issuecomment-1188317398",
    "id": 1188317398,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17674",
    "node_id": "IC_kwDOAvT7bc5G1EjW",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1188317398/reactions"
    },
    "updated_at": "2022-07-18T21:14:04Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1188317398",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "NONE",
    "body": "This issue has been marked as answered and has not had any activity for **1 day**. It has been closed for housekeeping purposes.",
    "created_at": "2022-07-23T00:01:11Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17674#issuecomment-1193012771",
    "id": 1193012771,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17674",
    "node_id": "IC_kwDOAvT7bc5HG-4j",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1193012771/reactions"
    },
    "updated_at": "2022-07-23T00:01:11Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1193012771",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  }
]

[
  {
    "author_association": "COLLABORATOR",
    "body": "Simplified repo\r\n\r\n## Steps to Reproduce\r\n\r\n```powershell\r\n$withoutTrailingCommands = @'\r\nfunction New-Function {\r\n    [CmdletBinding()]\r\n    param(\r\n        [ValidateSet('New', 'Old', 'Other')]\r\n        [string[]] $Test\r\n    )\r\n}\r\n\r\nNew-Function -Test New, Old,\r\n'@\r\n\r\n$withTrailingCommands = @'\r\nfunction New-Function {\r\n    [CmdletBinding()]\r\n    param(\r\n        [ValidateSet('New', 'Old', 'Other')]\r\n        [string[]] $Test\r\n    )\r\n}\r\nNew-Function -Test New, Old,\r\nanythinghere\r\n'@\r\n\r\n$cursor = $withoutTrailingCommands.Length\r\n\r\n(TabExpansion2 -inputScript $withoutTrailingCommands -cursorColumn $cursor).CompletionMatches\r\n'----'\r\n(TabExpansion2 -inputScript $withTrailingCommands -cursorColumn $cursor).CompletionMatches\r\n```\r\n\r\n## Expected behavior\r\n\r\nBoth return the same results\r\n\r\n```powershell\r\nCompletionText ListItemText     ResultType ToolTip\r\n-------------- ------------     ---------- -------\r\nNew            New          ParameterValue New\r\nOld            Old          ParameterValue Old\r\nOther          Other        ParameterValue Other\r\n----\r\nNew            New          ParameterValue New\r\nOld            Old          ParameterValue Old\r\nOther          Other        ParameterValue Other\r\n```\r\n\r\n## Actual behavior\r\n\r\nOnly the first tabexpansion call actually worked. Validate set string array argument completion works only when there are no following statements. Or following parameters it seems.\r\n\r\n```powershell\r\nCompletionText ListItemText     ResultType ToolTip\r\n-------------- ------------     ---------- -------\r\nNew            New          ParameterValue New\r\nOld            Old          ParameterValue Old\r\nOther          Other        ParameterValue Other\r\n----\r\n.\\Documents    Documents    ProviderContainer etc\r\n.\\Downloads    Downloads    ProviderContainer etc\r\n...etc\r\n```",
    "created_at": "2020-10-07T20:04:18Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13757#issuecomment-705164135",
    "id": 705164135,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13757",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwNTE2NDEzNQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 2,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/705164135/reactions"
    },
    "updated_at": "2020-10-07T20:06:14Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/705164135",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  },
  {
    "author_association": "NONE",
    "body": "It's even worse than I thought it is. Thank you",
    "created_at": "2020-10-07T20:09:23Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13757#issuecomment-705166514",
    "id": 705166514,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13757",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwNTE2NjUxNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/705166514/reactions"
    },
    "updated_at": "2020-10-07T20:09:23Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/705166514",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/15063294?v=4",
      "events_url": "https://api.github.com/users/PrzemyslawKlys/events{/privacy}",
      "followers_url": "https://api.github.com/users/PrzemyslawKlys/followers",
      "following_url": "https://api.github.com/users/PrzemyslawKlys/following{/other_user}",
      "gists_url": "https://api.github.com/users/PrzemyslawKlys/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/PrzemyslawKlys",
      "id": 15063294,
      "login": "PrzemyslawKlys",
      "node_id": "MDQ6VXNlcjE1MDYzMjk0",
      "organizations_url": "https://api.github.com/users/PrzemyslawKlys/orgs",
      "received_events_url": "https://api.github.com/users/PrzemyslawKlys/received_events",
      "repos_url": "https://api.github.com/users/PrzemyslawKlys/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/PrzemyslawKlys/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PrzemyslawKlys/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/PrzemyslawKlys"
    }
  },
  {
    "author_association": "NONE",
    "body": "I just wanted to add I often have issue with autocomplete for 1st element as well\r\n\r\n![image](https://user-images.githubusercontent.com/15063294/95663779-39c6a980-0b42-11eb-849c-473c51111587.png)\r\n\r\nEspecially when using `Register-ArgumentCompleter`\r\n\r\n```powershell\r\n\r\n        [parameter(ParameterSetName = \"FontAwesomeBrands\")]\r\n        [parameter(ParameterSetName = \"FontAwesomeRegular\")]\r\n        [parameter(ParameterSetName = \"FontAwesomeSolid\")][string] $IconColor,\r\n\r\n....\r\n\r\n\r\nRegister-ArgumentCompleter -CommandName New-HTMLTab -ParameterName IconColor -ScriptBlock $Script:ScriptBlockColors\r\n```\r\n\r\nI wasn't able to reproduce it easily so there must be something in play that impacts how things are autocomplete when used the way I use it.",
    "created_at": "2020-10-10T19:51:09Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13757#issuecomment-706602375",
    "id": 706602375,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13757",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwNjYwMjM3NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/706602375/reactions"
    },
    "updated_at": "2020-10-10T19:51:09Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/706602375",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/15063294?v=4",
      "events_url": "https://api.github.com/users/PrzemyslawKlys/events{/privacy}",
      "followers_url": "https://api.github.com/users/PrzemyslawKlys/followers",
      "following_url": "https://api.github.com/users/PrzemyslawKlys/following{/other_user}",
      "gists_url": "https://api.github.com/users/PrzemyslawKlys/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/PrzemyslawKlys",
      "id": 15063294,
      "login": "PrzemyslawKlys",
      "node_id": "MDQ6VXNlcjE1MDYzMjk0",
      "organizations_url": "https://api.github.com/users/PrzemyslawKlys/orgs",
      "received_events_url": "https://api.github.com/users/PrzemyslawKlys/received_events",
      "repos_url": "https://api.github.com/users/PrzemyslawKlys/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/PrzemyslawKlys/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PrzemyslawKlys/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/PrzemyslawKlys"
    }
  },
  {
    "author_association": "NONE",
    "body": "It would seem for PowerShell 5.1 this fails very often\r\n\r\n```powershell\r\nfunction Test-Me1 {\r\n    [cmdletBinding()]\r\n    param(\r\n        [string[]] $IconColor,\r\n        [string[]] $TextColor\r\n    )\r\n}\r\n\r\nfunction Test-Me2 {\r\n    [cmdletBinding()]\r\n    param(\r\n        [string[]] $IconColor\r\n    )\r\n}\r\n\r\n\r\n$ScriptBlock = {\r\n    param($commandName, $parameterName, $wordToComplete, $commandAst, $fakeBoundParameters)\r\n    'One', 'Two', 'Three' | Where-Object { $_ -like \"*$wordToComplete*\" }\r\n}\r\n\r\nRegister-ArgumentCompleter -CommandName Test-Me1 -ParameterName IconColor -ScriptBlock $ScriptBlock\r\nRegister-ArgumentCompleter -CommandName Test-Me1 -ParameterName TextColor -ScriptBlock $ScriptBlock\r\n\r\n\r\nRegister-ArgumentCompleter -CommandName Test-Me2 -ParameterName IconColor -ScriptBlock $ScriptBlock\r\n\r\nTest-Me1 -IconColor One -TextColor One\r\n\r\nTest-Me2 -IconColor One\r\n```\r\n\r\nIn PowerShell 7 it seems to work (for 1st entry only, not for 2nd. So I guess somewhere along the road it was fixed partially. ",
    "created_at": "2020-10-10T20:05:42Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13757#issuecomment-706604272",
    "id": 706604272,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13757",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwNjYwNDI3Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/706604272/reactions"
    },
    "updated_at": "2020-10-10T20:05:42Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/706604272",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/15063294?v=4",
      "events_url": "https://api.github.com/users/PrzemyslawKlys/events{/privacy}",
      "followers_url": "https://api.github.com/users/PrzemyslawKlys/followers",
      "following_url": "https://api.github.com/users/PrzemyslawKlys/following{/other_user}",
      "gists_url": "https://api.github.com/users/PrzemyslawKlys/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/PrzemyslawKlys",
      "id": 15063294,
      "login": "PrzemyslawKlys",
      "node_id": "MDQ6VXNlcjE1MDYzMjk0",
      "organizations_url": "https://api.github.com/users/PrzemyslawKlys/orgs",
      "received_events_url": "https://api.github.com/users/PrzemyslawKlys/received_events",
      "repos_url": "https://api.github.com/users/PrzemyslawKlys/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/PrzemyslawKlys/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PrzemyslawKlys/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/PrzemyslawKlys"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "I think this was fixed in https://github.com/PowerShell/PowerShell/pull/17078",
    "created_at": "2022-07-14T23:00:48Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13757#issuecomment-1184971568",
    "id": 1184971568,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13757",
    "node_id": "IC_kwDOAvT7bc5GoTsw",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1184971568/reactions"
    },
    "updated_at": "2022-07-14T23:00:48Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1184971568",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/42123497?v=4",
      "events_url": "https://api.github.com/users/MartinGC94/events{/privacy}",
      "followers_url": "https://api.github.com/users/MartinGC94/followers",
      "following_url": "https://api.github.com/users/MartinGC94/following{/other_user}",
      "gists_url": "https://api.github.com/users/MartinGC94/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/MartinGC94",
      "id": 42123497,
      "login": "MartinGC94",
      "node_id": "MDQ6VXNlcjQyMTIzNDk3",
      "organizations_url": "https://api.github.com/users/MartinGC94/orgs",
      "received_events_url": "https://api.github.com/users/MartinGC94/received_events",
      "repos_url": "https://api.github.com/users/MartinGC94/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/MartinGC94/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MartinGC94/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/MartinGC94"
    }
  }
]

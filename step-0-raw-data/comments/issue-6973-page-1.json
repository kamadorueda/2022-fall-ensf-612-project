[
  {
    "author_association": "COLLABORATOR",
    "body": "The `Create()` method on `InitialSessionState` creates the configuration for a minimal, restricted runspace. From the docs\r\n> The variants of this method can create an InitialSessionState object that is empty, ...\r\n\r\nIf you inspect the object that's created, you can see that it's in [`NoLanguage` mode](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_language_modes?view=powershell-6) and has no commands:\r\n```powershell\r\nPSCore (1:321) >  $initialSessionState = [initialsessionstate]::Create()\r\nPSCore (1:322) >  $initialSessionState\r\n\r\nLanguageMode                  : NoLanguage\r\nTranscriptDirectory           :\r\nExecutionPolicy               : Restricted\r\nUseFullLanguageModeInDebugger : False\r\nThreadOptions                 : Default\r\nThrowOnRunspaceOpenError      : False\r\nAuthorizationManager          : Microsoft.PowerShell.PSAuthorizationManager\r\nModules                       : {}\r\nAssemblies                    : {}\r\nTypes                         : {}\r\nFormats                       : {}\r\nDisableFormatUpdates          : False\r\nProviders                     : {}\r\nCommands                      : {}\r\nVariables                     : {}\r\nEnvironmentVariables          : {}\r\nStartupScripts                : {}\r\n```\r\nIf you want a \"normal\" or default runspace, you should use the `CreateDefault()` method instead because it\r\n> Creates the default PowerShell one with default cmdlets, provider etc.\r\n\r\nLooking at what this method produces, you can see that the `LanguageMode` is `FullLanguage`:\r\n```powershell\r\nPSCore (1:323) >  $initialSessionState = [initialsessionstate]::CreateDefault()\r\nPSCore (1:324) >  $initialSessionState\r\n\r\nLanguageMode                  : FullLanguage\r\nTranscriptDirectory           :\r\nExecutionPolicy               : Restricted\r\nUseFullLanguageModeInDebugger : False\r\nThreadOptions                 : Default\r\nThrowOnRunspaceOpenError      : False\r\nAuthorizationManager          : Microsoft.PowerShell.PSAuthorizationManager\r\nModules                       : {}\r\nAssemblies                    : {Microsoft.PowerShell.Commands.Diagnostics, Version=6.1.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, ProcessorArchitecture=MSIL,\r\n                                Microsoft.PowerShell.ConsoleHost, Version=6.1.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, ProcessorArchitecture=MSIL,\r\n                                System.Management.Automation, Version=6.1.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, ProcessorArchitecture=MSIL,\r\n                                Microsoft.PowerShell.Security...}\r\nTypes                         : {C:\\Program Files\\PowerShell\\6-preview\\GetEvent.types.ps1xml, C:\\Program Files\\PowerShell\\6-preview\\types.ps1xml, C:\\Program\r\n                                Files\\PowerShell\\6-preview\\typesv3.ps1xml}\r\nFormats                       : {*, *, *, *...}\r\nDisableFormatUpdates          : False\r\nProviders                     : {Registry, Alias, Environment, FileSystem...}\r\nCommands                      : {*, *, prompt, TabExpansion2...}\r\nVariables                     : {$, ^, StackTrace, OutputEncoding...}\r\nEnvironmentVariables          : {}\r\nStartupScripts                : {}\r\n```\r\n",
    "created_at": "2018-06-02T04:34:25Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6973#issuecomment-394057594",
    "id": 394057594,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6973",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NDA1NzU5NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/394057594/reactions"
    },
    "updated_at": "2018-06-02T04:34:25Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/394057594",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6876108?v=4",
      "events_url": "https://api.github.com/users/BrucePay/events{/privacy}",
      "followers_url": "https://api.github.com/users/BrucePay/followers",
      "following_url": "https://api.github.com/users/BrucePay/following{/other_user}",
      "gists_url": "https://api.github.com/users/BrucePay/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/BrucePay",
      "id": 6876108,
      "login": "BrucePay",
      "node_id": "MDQ6VXNlcjY4NzYxMDg=",
      "organizations_url": "https://api.github.com/users/BrucePay/orgs",
      "received_events_url": "https://api.github.com/users/BrucePay/received_events",
      "repos_url": "https://api.github.com/users/BrucePay/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/BrucePay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BrucePay/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/BrucePay"
    }
  },
  {
    "author_association": "NONE",
    "body": "Thank you @BrucePay.  This is much clearer now.  \r\n\r\nIt looks like the statement\r\n\r\n> The variants of this method can create an InitialSessionState object that is empty, ...\r\n\r\nis present in [the msdn doc](https://msdn.microsoft.com/en-us/library/system.management.automation.runspaces.initialsessionstate_members(v=vs.85).aspx), but not the [docs doc](https://docs.microsoft.com/en-us/dotnet/api/system.management.automation.runspaces.initialsessionstate.create?view=pscore-6.0.0).",
    "created_at": "2018-06-05T21:24:20Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6973#issuecomment-394865273",
    "id": 394865273,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6973",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NDg2NTI3Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/394865273/reactions"
    },
    "updated_at": "2018-06-05T21:24:20Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/394865273",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11237922?v=4",
      "events_url": "https://api.github.com/users/alx9r/events{/privacy}",
      "followers_url": "https://api.github.com/users/alx9r/followers",
      "following_url": "https://api.github.com/users/alx9r/following{/other_user}",
      "gists_url": "https://api.github.com/users/alx9r/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/alx9r",
      "id": 11237922,
      "login": "alx9r",
      "node_id": "MDQ6VXNlcjExMjM3OTIy",
      "organizations_url": "https://api.github.com/users/alx9r/orgs",
      "received_events_url": "https://api.github.com/users/alx9r/received_events",
      "repos_url": "https://api.github.com/users/alx9r/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/alx9r/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alx9r/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/alx9r"
    }
  }
]

[
  {
    "author_association": "CONTRIBUTOR",
    "body": "Again I cannot reproduce this on W10:\r\n\r\nIf I put the following at the very top of my Core `$PROFILE`:\r\n\r\n```powershell\r\n$host.Version.Major\r\n$PSEdition\r\n($host.Version.Major -gt 2) -and ($PSEdition -ne 'Core')\r\n```\r\n\r\nI get:\r\n\r\n```none\r\n6\r\nCore\r\nFalse\r\n```\r\n\r\nsuggesting that the conditional in your original post should never be entered - which indeed doesn't happen for me when I use your code verbatim in the same place.\r\n\r\nAs an aside, consider using `$PSVersionTable.PSVersion.Major` (and  perhaps `$PSVersionTable.PSEdition`) instead.\r\n\r\n---\r\n\r\n> Are there other techniques for discovering whether a specific key is pressed which also works on PowerShell Core?\r\n\r\nThe only thing I'm personally aware of is `[console]::KeyAvailable` and `[console]::ReadKey()`, but, unfortunately, they don't work with modifier keys in isolation - so a `Ctrl` keypress _by itself_ cannot be detected that way.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
    "created_at": "2017-08-27T21:10:30Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/4685#issuecomment-325225001",
    "id": 325225001,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/4685",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNTIyNTAwMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/325225001/reactions"
    },
    "updated_at": "2017-08-28T03:52:03Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/325225001",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "NONE",
    "body": "I see, thanks for the input regarding key presses.\r\n\r\nHere is a better example of the issue I am seeing:\r\n```powershell\r\nif ($false) {\r\n\r\n\tif([System.Windows.Input.Keyboard]::IsKeyDown(\"Ctrl\")) { return }\r\n\r\n}\r\n```\r\n\r\nPut this in the profile and open PowerShell Core.",
    "created_at": "2017-08-28T04:42:14Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/4685#issuecomment-325258744",
    "id": 325258744,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/4685",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNTI1ODc0NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/325258744/reactions"
    },
    "updated_at": "2017-08-28T04:42:35Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/325258744",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/2039662?v=4",
      "events_url": "https://api.github.com/users/janegilring/events{/privacy}",
      "followers_url": "https://api.github.com/users/janegilring/followers",
      "following_url": "https://api.github.com/users/janegilring/following{/other_user}",
      "gists_url": "https://api.github.com/users/janegilring/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/janegilring",
      "id": 2039662,
      "login": "janegilring",
      "node_id": "MDQ6VXNlcjIwMzk2NjI=",
      "organizations_url": "https://api.github.com/users/janegilring/orgs",
      "received_events_url": "https://api.github.com/users/janegilring/received_events",
      "repos_url": "https://api.github.com/users/janegilring/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/janegilring/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/janegilring/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/janegilring"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "You can try `$host.UI.RawUI.ReadKey()` and analyze `KeyInfo`.",
    "created_at": "2017-08-28T04:57:43Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/4685#issuecomment-325260106",
    "id": 325260106,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/4685",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNTI2MDEwNg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/325260106/reactions"
    },
    "updated_at": "2017-08-28T04:57:43Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/325260106",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@janegilring: My `$PSVersionTable` shows the same output as yours, and I cannot recreate your problem (I've verified that the profile indeed loads).",
    "created_at": "2017-08-28T12:31:30Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/4685#issuecomment-325340506",
    "id": 325340506,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/4685",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNTM0MDUwNg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/325340506/reactions"
    },
    "updated_at": "2017-08-28T12:31:30Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/325340506",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@iSazonov: What @janegilring is looking for is to asynchronously check whether a given _modifier key by itself_ happens to be held down.\r\n\r\n`[console]::KeyAvailable` / `$host.UI.RawUI.ReadKey()` / `[console]::ReadKey()` only check for \r\n / read keypresses that involve at least one non-modifier key.\r\n\r\nI'm not really familiar with CoreFX, but a quick documentation search tells me that you may be out of luck:\r\n\r\nhttps://docs.microsoft.com/en-us/dotnet/api/?term=keydown&view=netcore-2.0\r\n",
    "created_at": "2017-08-28T12:45:38Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/4685#issuecomment-325343460",
    "id": 325343460,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/4685",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNTM0MzQ2MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/325343460/reactions"
    },
    "updated_at": "2017-08-28T12:45:38Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/325343460",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@janegilring also not able to repro this, if you can provide something that can be repro'd we can look into it",
    "created_at": "2017-08-28T16:42:32Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/4685#issuecomment-325407123",
    "id": 325407123,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/4685",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNTQwNzEyMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/325407123/reactions"
    },
    "updated_at": "2017-08-28T16:42:32Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/325407123",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "NONE",
    "body": "Sorry, this was a user error from my side.\r\nIt turns out the problematic code was present in 2 different profile files - Microsoft.PowerShell_profile.ps1 and profile.ps1.\r\n\r\nAnyway, thanks for the tip regarding keypresses.",
    "created_at": "2017-08-28T19:50:38Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/4685#issuecomment-325460113",
    "id": 325460113,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/4685",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNTQ2MDExMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/325460113/reactions"
    },
    "updated_at": "2017-08-28T19:50:38Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/325460113",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/2039662?v=4",
      "events_url": "https://api.github.com/users/janegilring/events{/privacy}",
      "followers_url": "https://api.github.com/users/janegilring/followers",
      "following_url": "https://api.github.com/users/janegilring/following{/other_user}",
      "gists_url": "https://api.github.com/users/janegilring/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/janegilring",
      "id": 2039662,
      "login": "janegilring",
      "node_id": "MDQ6VXNlcjIwMzk2NjI=",
      "organizations_url": "https://api.github.com/users/janegilring/orgs",
      "received_events_url": "https://api.github.com/users/janegilring/received_events",
      "repos_url": "https://api.github.com/users/janegilring/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/janegilring/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/janegilring/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/janegilring"
    }
  }
]

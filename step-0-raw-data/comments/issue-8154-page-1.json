[
  {
    "author_association": "MEMBER",
    "body": "`[Environment]::UserInteractive` is a bit misleading.  It checks if the process is running in a winstation (has a desktop).  Windows services don't have a winstation, otherwise it is considered \"UserInteractive\".  The `-noninteractive` switch for pwsh controls whether the console host prompts (basically if `ReadLine()` is needed).  It has no control over native commands that prompt (or cmdlets/scripts that call `[Console]::ReadLine()` directly.  `New-PSSession` uses `ssh.exe` under the covers which is what is providing that prompt.  Not sure if the cmdlet can detect if `pwsh` was run with `-noninteractive` and even then what it can do about the `ssh.exe` prompt.",
    "created_at": "2018-10-31T14:50:11Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8154#issuecomment-434716600",
    "id": 434716600,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8154",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNDcxNjYwMA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/434716600/reactions"
    },
    "updated_at": "2018-10-31T14:50:11Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/434716600",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "NONE",
    "body": "@SteveL-MSFT \r\nI understand that `-Noninteractive` and `[Environment]::UserInteractive` are not linked at all.\r\n\r\nDon't you think it's strange that `[Environment]::UserInteractive` returns different value for PowerShell and PowerShell Core?\r\n\r\n> even then what it can do about the ssh.exe prompt\r\n\r\nI assume that `pwsh` redirects standard input. It reads a response from user and sends it to `ssh.exe`. I think `pwsh` may disable `stdin` if there is no \"winstation\" and input stream is not redirected.",
    "created_at": "2018-10-31T15:21:28Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8154#issuecomment-434729004",
    "id": 434729004,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8154",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNDcyOTAwNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/434729004/reactions"
    },
    "updated_at": "2018-10-31T15:21:28Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/434729004",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/4054844?v=4",
      "events_url": "https://api.github.com/users/dermeister0/events{/privacy}",
      "followers_url": "https://api.github.com/users/dermeister0/followers",
      "following_url": "https://api.github.com/users/dermeister0/following{/other_user}",
      "gists_url": "https://api.github.com/users/dermeister0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/dermeister0",
      "id": 4054844,
      "login": "dermeister0",
      "node_id": "MDQ6VXNlcjQwNTQ4NDQ=",
      "organizations_url": "https://api.github.com/users/dermeister0/orgs",
      "received_events_url": "https://api.github.com/users/dermeister0/received_events",
      "repos_url": "https://api.github.com/users/dermeister0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/dermeister0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dermeister0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/dermeister0"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@dermeister0 so you are saying Windows PowerShell returns `false`?",
    "created_at": "2018-10-31T16:28:41Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8154#issuecomment-434755095",
    "id": 434755095,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8154",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNDc1NTA5NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/434755095/reactions"
    },
    "updated_at": "2018-10-31T16:28:41Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/434755095",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": ".NET Core is the culprit: `[Environment]::UserInteractive` currently _always_ returns `$True` (hard-coded):\r\n\r\nhttps://github.com/dotnet/corefx/blob/a10890f4ffe0fadf090c922578ba0e606ebdd16c/src/System.Runtime.Extensions/src/System/Environment.cs#L152\r\n\r\n(The platform-specific class files do not override this behavior.)\r\n\r\n",
    "created_at": "2018-10-31T19:14:52Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8154#issuecomment-434813052",
    "id": 434813052,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8154",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNDgxMzA1Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 4,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 4,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/434813052/reactions"
    },
    "updated_at": "2018-10-31T19:17:32Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/434813052",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@dermeister0: If you're willing to define _user-interactive_ as _runs in a console/terminal window visible to the current user_, see [this answer on StackOverflow.com](https://stackoverflow.com/a/53716169/45375) for a workaround.",
    "created_at": "2018-12-17T03:29:14Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8154#issuecomment-447712107",
    "id": 447712107,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8154",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0NzcxMjEwNw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/447712107/reactions"
    },
    "updated_at": "2018-12-17T03:29:14Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/447712107",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "NONE",
    "body": "Migrating from 5.1 to 7 Preview and encountered this problem.\r\nI used `[Environment]::UserInteractive` in 5.1 to know if the script is running from Scheduled Task or not.\r\nThe .Net issue is tracked here https://github.com/dotnet/coreclr/issues/25595\r\nThe workaround suggested there is to use this instead:\r\n```powershel\r\nAdd-Type -AssemblyName System.Windows.Forms\r\n[System.Windows.Forms.SystemInformation]::UserInteractive\r\n```\r\nWould be nice if `[Environment]::UserInteractive` will work like it did in 5.1",
    "created_at": "2019-11-20T12:12:52Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8154#issuecomment-555978062",
    "id": 555978062,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8154",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NTk3ODA2Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/555978062/reactions"
    },
    "updated_at": "2019-11-20T12:12:52Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/555978062",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6960531?v=4",
      "events_url": "https://api.github.com/users/ili101/events{/privacy}",
      "followers_url": "https://api.github.com/users/ili101/followers",
      "following_url": "https://api.github.com/users/ili101/following{/other_user}",
      "gists_url": "https://api.github.com/users/ili101/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ili101",
      "id": 6960531,
      "login": "ili101",
      "node_id": "MDQ6VXNlcjY5NjA1MzE=",
      "organizations_url": "https://api.github.com/users/ili101/orgs",
      "received_events_url": "https://api.github.com/users/ili101/received_events",
      "repos_url": "https://api.github.com/users/ili101/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ili101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ili101/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ili101"
    }
  },
  {
    "author_association": "NONE",
    "body": "This issue has been marked as external and has not had any activity for **1 day**. It has been be closed for housekeeping purposes.",
    "created_at": "2019-11-21T18:00:19Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8154#issuecomment-557202560",
    "id": 557202560,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8154",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzIwMjU2MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/557202560/reactions"
    },
    "updated_at": "2019-11-21T18:00:19Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/557202560",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  }
]

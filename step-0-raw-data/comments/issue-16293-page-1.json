[
  {
    "author_association": "COLLABORATOR",
    "body": "@jeanga ~~Please open new issue in .Net Runtime repository and link that issue.~~\r\n\r\nUnbelievable, I just prepared a performance fix for this code which just gets rid of this `ResolveLinkTarget` and fixes this problem in PowerShell :-)",
    "created_at": "2021-10-22T17:40:06Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16293#issuecomment-949837249",
    "id": 949837249,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16293",
    "node_id": "IC_kwDOAvT7bc44nV3B",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/949837249/reactions"
    },
    "updated_at": "2021-10-23T14:28:44Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/949837249",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "After further study, I think this is purely a PowerShell problem, since it is correct that System.IO.File.ResolveLinkTarget() causes an IO exception for file systems (ISO, FAT, ...) that _does not support reparse points_.",
    "created_at": "2021-10-23T14:31:37Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16293#issuecomment-950161239",
    "id": 950161239,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16293",
    "node_id": "IC_kwDOAvT7bc44ok9X",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/950161239/reactions"
    },
    "updated_at": "2021-10-23T14:32:08Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/950161239",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Heh I thought we fixed this as per https://github.com/PowerShell/PowerShell/issues/13605 but looks like it regressed again. Seems like https://github.com/PowerShell/PowerShell/pull/16295 (or some other PR) should include some tests for this specific scenario to stop it from happening once again.",
    "created_at": "2021-10-23T21:47:32Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16293#issuecomment-950220245",
    "id": 950220245,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16293",
    "node_id": "IC_kwDOAvT7bc44ozXV",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/950220245/reactions"
    },
    "updated_at": "2021-10-23T21:47:32Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/950220245",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8462645?v=4",
      "events_url": "https://api.github.com/users/jborean93/events{/privacy}",
      "followers_url": "https://api.github.com/users/jborean93/followers",
      "following_url": "https://api.github.com/users/jborean93/following{/other_user}",
      "gists_url": "https://api.github.com/users/jborean93/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jborean93",
      "id": 8462645,
      "login": "jborean93",
      "node_id": "MDQ6VXNlcjg0NjI2NDU=",
      "organizations_url": "https://api.github.com/users/jborean93/orgs",
      "received_events_url": "https://api.github.com/users/jborean93/received_events",
      "repos_url": "https://api.github.com/users/jborean93/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jborean93/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jborean93/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jborean93"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "To add a test we need to create an ISO file with exe file on the fly.",
    "created_at": "2021-10-25T02:57:47Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16293#issuecomment-950481404",
    "id": 950481404,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16293",
    "node_id": "IC_kwDOAvT7bc44pzH8",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/950481404/reactions"
    },
    "updated_at": "2021-10-25T02:57:47Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/950481404",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Not necessarily, you just need a file system that doesn't support reparse points. I see 2 easy-ish ways to do this\r\n\r\n* Create a VHDX and format it as FAT32 (or even just FAT)\r\n* Create an ISO\r\n  * While possible through COM it's quite verbose, here is an example where I recreated an ISO for unattended Hyper-V installs https://gist.github.com/jborean93/b16f34069a614a2206093137e7da7b01\r\n\r\nYou can the use `Mount-DiskImage` to mount either the ISO or VHDX for the test and try and run the executable placed in that volume.\r\n\r\nThe VHDX scenario is simple to replicate\r\n\r\n```powershell\r\n$vhdx = 'C:\\temp\\vhdx\\my.vhdx'\r\nif (Test-Path -Path $vhdx) {\r\n    Remove-item -Path $vhdx -Force\r\n}\r\n\r\nSet-Content create_vhdx.txt @\"\r\ncreate vdisk file=\"$vhdx\" maximum=20 type=fixed\r\nselect vdisk file=\"$vhdx\"\r\nattach vdisk\r\nconvert mbr\r\ncreate partition primary\r\nformat fs=fat\r\nassign letter=\"T\"\r\ndetach vdisk\r\n\"@\r\n\r\ndiskpart.exe /s (Get-Item .\\create_vhdx.txt).FullName\r\nMount-DiskImage -ImagePath $vhdx | Out-Null\r\n\r\n# Copy binary to T:\\ and do test\r\nCopy-Item C:\\Windows\\System32\\whoami.exe T:\\whoami.exe\r\nT:\\whoami.exe\r\n\r\nDismount-DiskImage -ImagePath $vhdx\r\n```\r\n\r\nTo avoid diskpart you could use PInvoke to call [CreateVirtualDisk](https://docs.microsoft.com/en-us/windows/win32/api/virtdisk/nf-virtdisk-createvirtualdisk), creating the partition and formatting should also be doable using various PowerShell cmdlets as well if you wanted to avoid `diskpart.exe` altogether\r\n\r\nI have verified the VHDX example also excises this problematic code as the FAT format doesn't support reparse points.",
    "created_at": "2021-10-25T04:09:15Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16293#issuecomment-950508619",
    "id": 950508619,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16293",
    "node_id": "IC_kwDOAvT7bc44p5xL",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/950508619/reactions"
    },
    "updated_at": "2021-10-25T04:11:34Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/950508619",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8462645?v=4",
      "events_url": "https://api.github.com/users/jborean93/events{/privacy}",
      "followers_url": "https://api.github.com/users/jborean93/followers",
      "following_url": "https://api.github.com/users/jborean93/following{/other_user}",
      "gists_url": "https://api.github.com/users/jborean93/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jborean93",
      "id": 8462645,
      "login": "jborean93",
      "node_id": "MDQ6VXNlcjg0NjI2NDU=",
      "organizations_url": "https://api.github.com/users/jborean93/orgs",
      "received_events_url": "https://api.github.com/users/jborean93/received_events",
      "repos_url": "https://api.github.com/users/jborean93/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jborean93/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jborean93/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jborean93"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@jborean93 Thanks! I added the test.",
    "created_at": "2021-10-25T09:08:42Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16293#issuecomment-950698365",
    "id": 950698365,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16293",
    "node_id": "IC_kwDOAvT7bc44qoF9",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/950698365/reactions"
    },
    "updated_at": "2021-10-25T09:08:42Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/950698365",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Thanks @iSazonov appreciate adding the test, should hopefully stop this from recurring in the future!",
    "created_at": "2021-10-26T03:04:36Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16293#issuecomment-951514965",
    "id": 951514965,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16293",
    "node_id": "IC_kwDOAvT7bc44tvdV",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/951514965/reactions"
    },
    "updated_at": "2021-10-26T03:04:36Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/951514965",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8462645?v=4",
      "events_url": "https://api.github.com/users/jborean93/events{/privacy}",
      "followers_url": "https://api.github.com/users/jborean93/followers",
      "following_url": "https://api.github.com/users/jborean93/following{/other_user}",
      "gists_url": "https://api.github.com/users/jborean93/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jborean93",
      "id": 8462645,
      "login": "jborean93",
      "node_id": "MDQ6VXNlcjg0NjI2NDU=",
      "organizations_url": "https://api.github.com/users/jborean93/orgs",
      "received_events_url": "https://api.github.com/users/jborean93/received_events",
      "repos_url": "https://api.github.com/users/jborean93/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jborean93/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jborean93/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jborean93"
    }
  },
  {
    "author_association": "NONE",
    "body": ":tada:This issue was addressed in #16310, which has now been successfully released as `v7.2.0`.:tada:\n\nHandy links:\n* [Release Notes](https://github.com/PowerShell/PowerShell/releases/tag/v7.2.0)\n",
    "created_at": "2021-11-08T16:11:19Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16293#issuecomment-963312679",
    "id": 963312679,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16293",
    "node_id": "IC_kwDOAvT7bc45avwn",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/963312679/reactions"
    },
    "updated_at": "2021-11-08T16:11:19Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/963312679",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  },
  {
    "author_association": "NONE",
    "body": "Verified fixed! Thanks!",
    "created_at": "2021-11-08T20:54:10Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16293#issuecomment-963563819",
    "id": 963563819,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16293",
    "node_id": "IC_kwDOAvT7bc45btEr",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/963563819/reactions"
    },
    "updated_at": "2021-11-08T20:54:10Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/963563819",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/7120091?v=4",
      "events_url": "https://api.github.com/users/jeanga/events{/privacy}",
      "followers_url": "https://api.github.com/users/jeanga/followers",
      "following_url": "https://api.github.com/users/jeanga/following{/other_user}",
      "gists_url": "https://api.github.com/users/jeanga/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jeanga",
      "id": 7120091,
      "login": "jeanga",
      "node_id": "MDQ6VXNlcjcxMjAwOTE=",
      "organizations_url": "https://api.github.com/users/jeanga/orgs",
      "received_events_url": "https://api.github.com/users/jeanga/received_events",
      "repos_url": "https://api.github.com/users/jeanga/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jeanga/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jeanga/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jeanga"
    }
  },
  {
    "author_association": "NONE",
    "body": ":tada:This issue was addressed in #16310, which has now been successfully released as `v7.3.0-preview.1`.:tada:\n\nHandy links:\n* [Release Notes](https://github.com/PowerShell/PowerShell/releases/tag/v7.3.0-preview.1)\n",
    "created_at": "2021-12-16T19:59:30Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16293#issuecomment-996152036",
    "id": 996152036,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16293",
    "node_id": "IC_kwDOAvT7bc47YBLk",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/996152036/reactions"
    },
    "updated_at": "2021-12-16T19:59:30Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/996152036",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  }
]

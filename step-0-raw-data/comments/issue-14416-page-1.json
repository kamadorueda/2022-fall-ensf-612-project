[
  {
    "author_association": "COLLABORATOR",
    "body": "@mklement0 Can you catch errors in `ForEach-Object -Parallel` scriptblock? Maybe add Get-Error?",
    "created_at": "2020-12-15T13:00:14Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14416#issuecomment-745272144",
    "id": 745272144,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14416",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0NTI3MjE0NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/745272144/reactions"
    },
    "updated_at": "2020-12-15T13:00:14Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/745272144",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@iSazonov, I've added an `-ErrorAction Stop` and a check for `$?` being `$false` for reporting any error as a warning, but no error occurs - neither terminating nor non-terminating.\r\n\r\nIt's not in the tests above, but you can also get the quiet failure to occur in the main thread, if you write to the same file concurrently from a thread job (`Start-ThreadJob`).",
    "created_at": "2020-12-15T13:35:44Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14416#issuecomment-745290485",
    "id": 745290485,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14416",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0NTI5MDQ4NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/745290485/reactions"
    },
    "updated_at": "2020-12-15T13:35:44Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/745290485",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "I think really Get-Content does not fail. It write all values in the file but we have a race condition sometimes - some values are overwritten by subsequent ones.",
    "created_at": "2020-12-15T16:42:28Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14416#issuecomment-745414409",
    "id": 745414409,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14416",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0NTQxNDQwOQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/745414409/reactions"
    },
    "updated_at": "2020-12-15T16:42:28Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/745414409",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "It's definitely a race condition.\r\n\r\n_Some_ failure of `Add-Content` is involved and two possible reasons come to mind:\r\n\r\n* The write operation fails, but the failure isn't reported.\r\n* File content is _cached_ (which seems unlikely) and on writing there's a failure to recognize that the file has been modified by another thread.\r\n\r\nEither way, a fix is required.",
    "created_at": "2020-12-15T16:46:29Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14416#issuecomment-745417295",
    "id": 745417295,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14416",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0NTQxNzI5NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/745417295/reactions"
    },
    "updated_at": "2020-12-15T16:46:29Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/745417295",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Also note that the problem may not be cmdlet-specific, because `Out-File -Append` is affected too.",
    "created_at": "2020-12-15T16:53:13Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14416#issuecomment-745421911",
    "id": 745421911,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14416",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0NTQyMTkxMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/745421911/reactions"
    },
    "updated_at": "2020-12-15T16:53:13Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/745421911",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "I doubt we can fix this since too many things in PowerShell are not thread-safe. (What is you will write to a web service?)\r\nPerhaps the best option is to write this in the documentation if it is not already there.\r\n\r\n@PaulHigin Could you please share your thoughts?",
    "created_at": "2020-12-15T17:10:57Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14416#issuecomment-745433182",
    "id": 745433182,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14416",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0NTQzMzE4Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/745433182/reactions"
    },
    "updated_at": "2020-12-15T17:11:46Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/745433182",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Yes, PowerShell cmdlets are not and were never intended to be multi-threaded safe.  Users must beware of using cmdlets in multiple threads, whether via foreach -parallel or PowerShell API.  Same as with any non-multi-threaded-safe .NET object.  ",
    "created_at": "2020-12-15T17:32:27Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14416#issuecomment-745445944",
    "id": 745445944,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14416",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0NTQ0NTk0NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/745445944/reactions"
    },
    "updated_at": "2020-12-15T17:32:27Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/745445944",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/14019529?v=4",
      "events_url": "https://api.github.com/users/PaulHigin/events{/privacy}",
      "followers_url": "https://api.github.com/users/PaulHigin/followers",
      "following_url": "https://api.github.com/users/PaulHigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulHigin/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/PaulHigin",
      "id": 14019529,
      "login": "PaulHigin",
      "node_id": "MDQ6VXNlcjE0MDE5NTI5",
      "organizations_url": "https://api.github.com/users/PaulHigin/orgs",
      "received_events_url": "https://api.github.com/users/PaulHigin/received_events",
      "repos_url": "https://api.github.com/users/PaulHigin/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/PaulHigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulHigin/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/PaulHigin"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Agreed in general, @PaulHigin, but while race conditions on _in-memory_ data (e.g., a non-concurrent collection) cannot be prevented, we are talking about concurrent _file access_ here.\r\n\r\nAnd it seems to me that failure to update a file being written to by someone else should be _reported as such_ - the currently quiet failure is insidious. (Note that this is different from expecting the concurrency to be _managed_ automatically - that is indeed not the goal here.)\r\n\r\n",
    "created_at": "2020-12-15T17:41:59Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14416#issuecomment-745452067",
    "id": 745452067,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14416",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0NTQ1MjA2Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/745452067/reactions"
    },
    "updated_at": "2020-12-15T17:58:39Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/745452067",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Are you sure it's actually failing to write? It could be successfully writing input of similar length to the same offset in the file.",
    "created_at": "2020-12-15T17:50:50Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14416#issuecomment-745457651",
    "id": 745457651,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14416",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0NTQ1NzY1MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/745457651/reactions"
    },
    "updated_at": "2020-12-15T17:50:50Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/745457651",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Safe solution was to mark cmdlets which is a thread-safe and allow in `ForEach-Object -Parallel` only such cmdlets. But in any case we can not make the `ForEach-Object -Parallel` fully thread-safe.\r\n\r\nAs for Add-Cmdlet, it has thick wrapper code and I guess it's not so easy to do it thread-safe.",
    "created_at": "2020-12-15T17:52:04Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14416#issuecomment-745458347",
    "id": 745458347,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14416",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0NTQ1ODM0Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/745458347/reactions"
    },
    "updated_at": "2020-12-15T17:52:04Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/745458347",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "That's possible, @SeeminglyScience, but that is still a failure to synchronize access to a file for writing, which is something that should be addressed in general, irrespective of cross-_thread_ use, as it also applies cross-_process_.\r\n\r\nTherefore, @iSazonov, this isn't about _thread safety_ per se. It's about not allowing any other entity - whether thread or process - write access to a file while it is being written to (although it's possible that the specifics of the file-writing code underlying cmdlets such as `Add-Content` make the problem only surface in a cross-_thread_ context - haven't looked at the source code). \r\n\r\n\r\n",
    "created_at": "2020-12-15T17:56:59Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14416#issuecomment-745461136",
    "id": 745461136,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14416",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0NTQ2MTEzNg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/745461136/reactions"
    },
    "updated_at": "2020-12-15T18:01:43Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/745461136",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "NONE",
    "body": "*Not sure if I should create a separate issue for this--seemed similar enough to the main issue.*\r\n\r\n# Redirection/Writing to file fails in `ForEach` block within function\r\n\r\n_I'm a relative beginner, so might be a basic error--that said, **this same function worked earlier, and worked on**_ **`WindowsPowerShell`** (5.1)\r\n\r\n```powershell\r\nfunction makeDirective([string]$directiveFile, $files) {\r\n\r\n        if (Test-Path $directiveFile) {\r\n            throw \"File $directiveFile Exists\"\r\n        }\r\n        ForEach ($file in $files) {\r\n            \"file $($file.Name)\" >> $directiveFile\r\n        }\r\n}\r\n\r\n# Files is obviously not empty\r\n$files = Get-ChildItem <file_pattern>\r\n\r\nmakeDirective 'manifest.txt' $files\r\n```\r\n\r\nNo errors, no warnings--but no file is outputted.\r\nThe same redirection line in the function works when I type it into a shell, or as a line in a script.\r\n\r\nI'm using Version 7.1.4",
    "created_at": "2021-09-23T17:11:00Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14416#issuecomment-926001069",
    "id": 926001069,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14416",
    "node_id": "IC_kwDOAvT7bc43Maet",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/926001069/reactions"
    },
    "updated_at": "2021-09-23T17:12:24Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/926001069",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/71850263?v=4",
      "events_url": "https://api.github.com/users/ShivnarenSrinivasan/events{/privacy}",
      "followers_url": "https://api.github.com/users/ShivnarenSrinivasan/followers",
      "following_url": "https://api.github.com/users/ShivnarenSrinivasan/following{/other_user}",
      "gists_url": "https://api.github.com/users/ShivnarenSrinivasan/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ShivnarenSrinivasan",
      "id": 71850263,
      "login": "ShivnarenSrinivasan",
      "node_id": "MDQ6VXNlcjcxODUwMjYz",
      "organizations_url": "https://api.github.com/users/ShivnarenSrinivasan/orgs",
      "received_events_url": "https://api.github.com/users/ShivnarenSrinivasan/received_events",
      "repos_url": "https://api.github.com/users/ShivnarenSrinivasan/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ShivnarenSrinivasan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ShivnarenSrinivasan/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ShivnarenSrinivasan"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "That would likely be a completely separate issue. FWIW I tried your function on 7.2.0-preview9 and it works as expected. I would guess something else is going on in your case, though I don't know what exactly.",
    "created_at": "2021-09-23T19:52:53Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14416#issuecomment-926108091",
    "id": 926108091,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14416",
    "node_id": "IC_kwDOAvT7bc43M0m7",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/926108091/reactions"
    },
    "updated_at": "2021-09-23T19:52:53Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/926108091",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/32407840?v=4",
      "events_url": "https://api.github.com/users/vexx32/events{/privacy}",
      "followers_url": "https://api.github.com/users/vexx32/followers",
      "following_url": "https://api.github.com/users/vexx32/following{/other_user}",
      "gists_url": "https://api.github.com/users/vexx32/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vexx32",
      "id": 32407840,
      "login": "vexx32",
      "node_id": "MDQ6VXNlcjMyNDA3ODQw",
      "organizations_url": "https://api.github.com/users/vexx32/orgs",
      "received_events_url": "https://api.github.com/users/vexx32/received_events",
      "repos_url": "https://api.github.com/users/vexx32/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vexx32/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vexx32/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vexx32"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Now .Net 6.0 has get new thread-safe file IO API.\r\nhttps://devblogs.microsoft.com/dotnet/file-io-improvements-in-dotnet-6/#thread-safe-file-io\r\n\r\nbut I doubt that we will be able to use this.\n\n<blockquote><img src=\"https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2021/08/top_allocations.png\" width=\"48\" align=\"right\"><div><img src=\"https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2018/10/Microsoft-Favicon.png\" height=\"14\"> .NET Blog</div><div><strong><a href=\"https://devblogs.microsoft.com/dotnet/file-io-improvements-in-dotnet-6/\">File IO improvements in .NET 6</a></strong></div><div>Learn about high-performance file IO features in NET 6, like concurrent reads and writes, scatter/gather IO and many more.</div></blockquote>",
    "created_at": "2021-09-24T03:40:39Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14416#issuecomment-926318474",
    "id": 926318474,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14416",
    "node_id": "IC_kwDOAvT7bc43Nn-K",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/926318474/reactions"
    },
    "updated_at": "2021-09-24T03:40:41Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/926318474",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  }
]

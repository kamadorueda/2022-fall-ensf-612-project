[
  {
    "author_association": "MEMBER",
    "body": "Arguments from `$PSDefaultParameters` get bound before pipeline parameter binding, and unlike the default argument that you specify within a function declaration, they are real parameter bindings essentially similar to a named parameter (e.g. `-Path mypath`). Therefore, after an entry from `$PSDefaultParameters` gets bound, the particular parameter is taken can cannot be bound anymore. \r\n\r\nGiven that, I think the reported behavior is by design. @JamesWTruher @rjmholt, any different thoughts?",
    "created_at": "2021-02-03T18:57:57Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14701#issuecomment-772741536",
    "id": 772741536,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14701",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3Mjc0MTUzNg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/772741536/reactions"
    },
    "updated_at": "2021-02-03T18:57:57Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/772741536",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "NONE",
    "body": "So it sounds like in Powershell today the order of priority is:\r\n`Named Parameters` -> `$PSDefaultParameters` -> `ValueFromPipelineByPropertyName` -> `Function's parameter's default value`\r\n\r\nHowever, I would expect it to be:\r\n`Named Parameters` ->  `ValueFromPipelineByPropertyName` -> `$PSDefaultParameters` -> `Function's parameter's default value`\r\nbased on [reading the `$PSDefaultParameterValues` docs](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_parameters_default_values) \r\n>The $PSDefaultParameterValues preference variable lets you specify **custom default values** for any cmdlet or advanced function. Cmdlets and advanced functions use the custom default value unless you specify another value in the command.\r\n>\r\n>The authors of cmdlets and advanced functions set standard **default values** for their parameters. Typically, the standard default values are useful, but they might not be appropriate for all environments.\r\n\r\nAnd from [the docs on `ValueFromPipelineByPropertyName` ](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_functions_advanced_parameters?view=powershell-7.1#valuefrompipelinebypropertyname-argument)\r\n>The ValueFromPipelineByPropertyName argument indicates that the parameter accepts input from a property of a pipeline object. The object property must have the same name or alias as the parameter.\r\n\r\nSo my interpretation is that are two fundamental ways of setting values for parameters:  \r\n`Inputs` and `Defaults`, where:\r\n- `Inputs` clearly override `Defaults`. \r\n- For `Inputs`: `Named Parameters` override `ValueFromPipelineByPropertyName`\r\n- For `Defaults`: `$PSDefaultParameters` override the `Function's parameter's default value`\r\n\r\nA \"Default\" overriding an input feels very surprising, though it is likely a breaking change to do anything about this now.",
    "created_at": "2021-02-04T13:22:35Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14701#issuecomment-773299630",
    "id": 773299630,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14701",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3MzI5OTYzMA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/773299630/reactions"
    },
    "updated_at": "2021-02-04T13:25:25Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/773299630",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/1075793?v=4",
      "events_url": "https://api.github.com/users/seansaleh/events{/privacy}",
      "followers_url": "https://api.github.com/users/seansaleh/followers",
      "following_url": "https://api.github.com/users/seansaleh/following{/other_user}",
      "gists_url": "https://api.github.com/users/seansaleh/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/seansaleh",
      "id": 1075793,
      "login": "seansaleh",
      "node_id": "MDQ6VXNlcjEwNzU3OTM=",
      "organizations_url": "https://api.github.com/users/seansaleh/orgs",
      "received_events_url": "https://api.github.com/users/seansaleh/received_events",
      "repos_url": "https://api.github.com/users/seansaleh/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/seansaleh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/seansaleh/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/seansaleh"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "> So it sounds like in Powershell today the order of priority is:\r\nNamed Parameters -> $PSDefaultParameters -> ValueFromPipelineByPropertyName -> Function's parameter's default value\r\n\r\nThe parameter binding is more of in the following order:\r\n\r\n`Named Parameters` -> `Positional Parameters` -> `1st attempt of $PSDefaultParameters` -> `Dynamic Parameters` -> `2nd attempt of $PSDefaultParameters (dynamic parameter binding may reveal new parameters)` -> `Pipeline Parameters` -> `Default Arguments specified in function`\r\n",
    "created_at": "2021-02-04T17:26:01Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14701#issuecomment-773476552",
    "id": 773476552,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14701",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3MzQ3NjU1Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/773476552/reactions"
    },
    "updated_at": "2021-02-04T17:27:50Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/773476552",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "NONE",
    "body": "Thanks for that detail @daxian-dbw! It is very helpful.\r\n\r\nOverall it still feels like something is wrong here, and there are a few ways to address it:\r\n\r\n1. Is this by intentional design? Or is this accidental behaviour?\r\nDid the designers of Powershell truly intend for defaults set via `$PSDefaultParameters` to block `Pipeline Parameters`?\r\n\r\n2. Is this documented anywhere? If not can we document it?\r\n\r\n3. Can the error message be made better? \r\nEven in the situation where you do `$myObject | Get-DebugInputParams -MyParam SomeValue` without `$PSDefaultParameters` the error message of `The input object cannot be bound to any parameters for the command either because the command does not take pipeline input or the input and its properties do not match any of the parameters that take pipeline input.` does not make sense. It would make more sense if it were to say `The input object cannot be bound to any parameters for the command either because the input and its properties do not match any of the parameters that take pipeline input or any matching parameter's values are already set`\r\n",
    "created_at": "2021-02-05T09:57:34Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14701#issuecomment-773927339",
    "id": 773927339,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14701",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3MzkyNzMzOQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/773927339/reactions"
    },
    "updated_at": "2021-02-05T09:57:34Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/773927339",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/1075793?v=4",
      "events_url": "https://api.github.com/users/seansaleh/events{/privacy}",
      "followers_url": "https://api.github.com/users/seansaleh/followers",
      "following_url": "https://api.github.com/users/seansaleh/following{/other_user}",
      "gists_url": "https://api.github.com/users/seansaleh/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/seansaleh",
      "id": 1075793,
      "login": "seansaleh",
      "node_id": "MDQ6VXNlcjEwNzU3OTM=",
      "organizations_url": "https://api.github.com/users/seansaleh/orgs",
      "received_events_url": "https://api.github.com/users/seansaleh/received_events",
      "repos_url": "https://api.github.com/users/seansaleh/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/seansaleh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/seansaleh/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/seansaleh"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "I believe it was by design. Having `$PSDefaultParameters` kick in before `Pipeline Parameter binding` means that `$PSDefaultParameters` will influence the pipeline parameter binding -- different parameter set may be chosen depending on what's defined in `$PSDefaultParameters` and hence different parameters may be bound for objects coming from pipeline. It's not supposed to work like the `Default Arguments` that are specified in a function declaration.\r\n\r\nThe [the docs on `ValueFromPipelineByPropertyName` ](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_functions_advanced_parameters?view=powershell-7.1#valuefrompipelinebypropertyname-argument) mentions the following, but I agree it's a bit vague and can be improved. \r\nPlease feel free to open an issue in https://github.com/MicrosoftDocs/PowerShell-Docs.\r\n> Cmdlets and advanced functions use the custom default value unless you specify another value in the command.\r\n\r\nAs for the error message, I agree it can be improved to be more clear. /cc @rjmholt @JamesWTruher any thoughts?",
    "created_at": "2021-02-05T19:30:02Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14701#issuecomment-774241805",
    "id": 774241805,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14701",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3NDI0MTgwNQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/774241805/reactions"
    },
    "updated_at": "2021-02-05T19:30:25Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/774241805",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Good discussion and good info, @daxian-dbw, but from what I can tell binding of `Default Arguments specified in function` (e.g., `[string] $Foo = 'bar'` inside the `param()` block) happens _before_  `Pipeline Parameters`.\r\n\r\nAlso, while values supplied as arguments / via default values / via `$PSDefaultParameterValues` bind only _once_, on cmdlet startup, pipeline parameter binding:\r\n\r\n* doesn't happen until after `BeginProcessing()` / the `begin` script block executes \r\n* and - of necessity - happens _once for each input object_ , which means that - at least hypothetically - each input object can activate a _different_ parameter set.\r\n\r\n```powershell\r\nfunction Foo {\r\n  [CmdletBinding(DefaultParameterSetName='default')]\r\n  param(\r\n    [string] $bar = $('!'; write-host 'binding -bar with default value')\r\n    ,\r\n    [parameter(ParameterSetName='baz', ValueFromPipelineByPropertyName)]\r\n    [string] $baz\r\n    ,\r\n    [parameter(ParameterSetName='qux', ValueFromPipelineByPropertyName)]\r\n    [string] $qux\r\n  )\r\n  \r\n  begin {\r\n    Write-Host 'in begin block'\r\n  }\r\n  \r\n  process {\r\n    [pscustomobject] @{\r\n      ParameterSet = $PSCmdlet.ParameterSetName\r\n      baz = $baz\r\n      qux = $qux\r\n    }\r\n  }  \r\n}\r\n\r\n# Provide two input objects that activate different parameter sets.\r\n[pscustomobject] @{ baz = 'baz1' }, [pscustomobject] @{ qux = 'qux1' } | Foo\r\n```\r\n\r\nThe above yields:\r\n\r\n```none\r\nbinding -bar with default value\r\nin begin block\r\n\r\nParameterSet baz  qux\r\n------------ ---  ---\r\nbaz          baz1\r\nqux               qux1\r\n```",
    "created_at": "2021-02-05T22:57:05Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14701#issuecomment-774332772",
    "id": 774332772,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14701",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3NDMzMjc3Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/774332772/reactions"
    },
    "updated_at": "2021-02-05T22:57:05Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/774332772",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  }
]

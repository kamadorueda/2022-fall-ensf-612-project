[
  {
    "author_association": "NONE",
    "body": "It has never been supposed to work that way. See <a href=\"https://msdn.microsoft.com/en-us/library/system.management.automation.psreference(v=vs.85).aspx\" target=\"_blank\">documentation</a> (Remarks, there's no saying about using it with a class member, whether it's a field, property or anything else). Moreover, reading the code of `PSReference` reveals the reason -- it is supposed to support variables and values only.\n\nMoreover, PowerShell does need marshalling when you call CLR methods with `ref` -- the value is not directly stored into the variable as the method executes, instead, it is stored after the call completes (this is different from CLR method call). For example:\n\n``` PowerShell\nAdd-Type -TypeDefinition 'public class Foo\n{\n    public string ClassField;\n    public static void EditStringAndThrow(ref string str) { str = \"Edited\"; ((object)null).ToString(); }\n    public void EditStringAndThrow() { EditStringAndThrow(ref ClassField); }\n}';\n$str = 'Initial';\n[Foo]::EditStringAndThrow($str);\n$str; <# Gives Initial. #>\n$foo = [Foo]::new(); $foo.ClassField = 'Initial';\n$foo.EditStringAndThrow();\n$foo.ClassField; <# Gives Edited. #>\n```\n\nTo explain why parentheses fail the `ref`, just note that with a pair of parentheses, the expression is no longer a variable, it's a compound expression therefore the constructor `PSReference(object value)` is used -- the `ref` has nothing to do with that variable, it's a value reference. This is a feature so that you don't really have to receive the value produced by a cmdlet/function if you don't want it.\n",
    "created_at": "2016-08-31T15:22:35Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2137#issuecomment-243799807",
    "id": 243799807,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2137",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0Mzc5OTgwNw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/243799807/reactions"
    },
    "updated_at": "2016-08-31T15:22:35Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/243799807",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/4462444?v=4",
      "events_url": "https://api.github.com/users/GeeLaw/events{/privacy}",
      "followers_url": "https://api.github.com/users/GeeLaw/followers",
      "following_url": "https://api.github.com/users/GeeLaw/following{/other_user}",
      "gists_url": "https://api.github.com/users/GeeLaw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/GeeLaw",
      "id": 4462444,
      "login": "GeeLaw",
      "node_id": "MDQ6VXNlcjQ0NjI0NDQ=",
      "organizations_url": "https://api.github.com/users/GeeLaw/orgs",
      "received_events_url": "https://api.github.com/users/GeeLaw/received_events",
      "repos_url": "https://api.github.com/users/GeeLaw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/GeeLaw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/GeeLaw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/GeeLaw"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "Perhaps this is just a doc issue\n",
    "created_at": "2016-08-31T16:11:05Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2137#issuecomment-243815515",
    "id": 243815515,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2137",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0MzgxNTUxNQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/243815515/reactions"
    },
    "updated_at": "2016-08-31T16:11:05Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/243815515",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "We should do something - ideally support the feature or report a parse error.\n",
    "created_at": "2016-08-31T16:22:15Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2137#issuecomment-243818950",
    "id": 243818950,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2137",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0MzgxODk1MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/243818950/reactions"
    },
    "updated_at": "2016-08-31T16:22:15Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/243818950",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/2148248?v=4",
      "events_url": "https://api.github.com/users/lzybkr/events{/privacy}",
      "followers_url": "https://api.github.com/users/lzybkr/followers",
      "following_url": "https://api.github.com/users/lzybkr/following{/other_user}",
      "gists_url": "https://api.github.com/users/lzybkr/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/lzybkr",
      "id": 2148248,
      "login": "lzybkr",
      "node_id": "MDQ6VXNlcjIxNDgyNDg=",
      "organizations_url": "https://api.github.com/users/lzybkr/orgs",
      "received_events_url": "https://api.github.com/users/lzybkr/received_events",
      "repos_url": "https://api.github.com/users/lzybkr/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/lzybkr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lzybkr/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/lzybkr"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "[ref] really only exists for COM. With COM, there are cases where you need to pass a value _in_ by reference so the example with the object property is not an error. It's by design.\n",
    "created_at": "2016-08-31T19:05:15Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2137#issuecomment-243867469",
    "id": 243867469,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2137",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0Mzg2NzQ2OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/243867469/reactions"
    },
    "updated_at": "2016-08-31T19:05:15Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/243867469",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6876108?v=4",
      "events_url": "https://api.github.com/users/BrucePay/events{/privacy}",
      "followers_url": "https://api.github.com/users/BrucePay/followers",
      "following_url": "https://api.github.com/users/BrucePay/following{/other_user}",
      "gists_url": "https://api.github.com/users/BrucePay/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/BrucePay",
      "id": 6876108,
      "login": "BrucePay",
      "node_id": "MDQ6VXNlcjY4NzYxMDg=",
      "organizations_url": "https://api.github.com/users/BrucePay/orgs",
      "received_events_url": "https://api.github.com/users/BrucePay/received_events",
      "repos_url": "https://api.github.com/users/BrucePay/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/BrucePay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BrucePay/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/BrucePay"
    }
  },
  {
    "author_association": "NONE",
    "body": "@lzybkr unluckily that'll be a breaking change. For those examples here that doesn't do the \"ref a variable\" thing, they create a **value ref** instead, and is a feature, by design.\n\nImagine a function:\n\n``` PowerShell\nFunction Use-Ref\n{\nParam ([ref]$OutputRef)\nWrite-Output $OutputRef.Value;\n$OutputRef.Value = 42;\n}\n```\n\nThe following things are pretty equivalent in terms of calling `Use-Ref`:\n\n``` PowerShell\nUse-Ref ([ref]1)\n# create a ref from value 1\n# the ref is not used after the call\n```\n\n``` PowerShell\n$a = 1\nUse-Ref ([ref]($a))\n# use the value of $a as the parameter's\n# initial value but do not store the notified value back.\n```\n\n``` PowerShell\n$a = New-Object PSObject -Property @{ Prop = 1 }\nUse-Ref ([ref] $a.Prop)\n# evaluate the expression $a.Prop\n# and create a value ref.\n```\n\nIt is crucial to understand that `([ref]$a)` is special -- the only syntax to create a **variable** ref, which means PowerShell engine will write the value back to that variable after the cmdlet/function finishes.\n",
    "created_at": "2016-08-31T19:06:08Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2137#issuecomment-243867711",
    "id": 243867711,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2137",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0Mzg2NzcxMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/243867711/reactions"
    },
    "updated_at": "2016-08-31T19:06:08Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/243867711",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/4462444?v=4",
      "events_url": "https://api.github.com/users/GeeLaw/events{/privacy}",
      "followers_url": "https://api.github.com/users/GeeLaw/followers",
      "following_url": "https://api.github.com/users/GeeLaw/following{/other_user}",
      "gists_url": "https://api.github.com/users/GeeLaw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/GeeLaw",
      "id": 4462444,
      "login": "GeeLaw",
      "node_id": "MDQ6VXNlcjQ0NjI0NDQ=",
      "organizations_url": "https://api.github.com/users/GeeLaw/orgs",
      "received_events_url": "https://api.github.com/users/GeeLaw/received_events",
      "repos_url": "https://api.github.com/users/GeeLaw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/GeeLaw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/GeeLaw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/GeeLaw"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "GeeLaw's assessment is pretty accurate. [ref] is \"special\" with only limited scenarios being covered. If it wasn't for COM, [ref] wouldn't exist. So If you're using [ref] and not doing COM you're probably doing it wrong.\n",
    "created_at": "2016-08-31T19:24:24Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2137#issuecomment-243872752",
    "id": 243872752,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2137",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0Mzg3Mjc1Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/243872752/reactions"
    },
    "updated_at": "2016-08-31T19:24:24Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/243872752",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6876108?v=4",
      "events_url": "https://api.github.com/users/BrucePay/events{/privacy}",
      "followers_url": "https://api.github.com/users/BrucePay/followers",
      "following_url": "https://api.github.com/users/BrucePay/following{/other_user}",
      "gists_url": "https://api.github.com/users/BrucePay/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/BrucePay",
      "id": 6876108,
      "login": "BrucePay",
      "node_id": "MDQ6VXNlcjY4NzYxMDg=",
      "organizations_url": "https://api.github.com/users/BrucePay/orgs",
      "received_events_url": "https://api.github.com/users/BrucePay/received_events",
      "repos_url": "https://api.github.com/users/BrucePay/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/BrucePay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BrucePay/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/BrucePay"
    }
  },
  {
    "author_association": "NONE",
    "body": "@BrucePay weirdly, I dont really see any common cmdlets using `ref`. I encounter most of my `ref`s in a method call.\n",
    "created_at": "2016-08-31T19:28:26Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2137#issuecomment-243873912",
    "id": 243873912,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2137",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0Mzg3MzkxMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/243873912/reactions"
    },
    "updated_at": "2016-08-31T19:28:26Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/243873912",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/4462444?v=4",
      "events_url": "https://api.github.com/users/GeeLaw/events{/privacy}",
      "followers_url": "https://api.github.com/users/GeeLaw/followers",
      "following_url": "https://api.github.com/users/GeeLaw/following{/other_user}",
      "gists_url": "https://api.github.com/users/GeeLaw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/GeeLaw",
      "id": 4462444,
      "login": "GeeLaw",
      "node_id": "MDQ6VXNlcjQ0NjI0NDQ=",
      "organizations_url": "https://api.github.com/users/GeeLaw/orgs",
      "received_events_url": "https://api.github.com/users/GeeLaw/received_events",
      "repos_url": "https://api.github.com/users/GeeLaw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/GeeLaw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/GeeLaw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/GeeLaw"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "I suggest we document that [ref] is intended for COM interop and the need for in/out params are handled by different means\n",
    "created_at": "2016-08-31T19:35:56Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2137#issuecomment-243875913",
    "id": 243875913,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2137",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0Mzg3NTkxMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/243875913/reactions"
    },
    "updated_at": "2016-08-31T19:35:56Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/243875913",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "NONE",
    "body": "Is this User Voice the same issue ?\n\nBUG : [Class] Can't override a C# method with an argument of type out\nhttps://windowsserver.uservoice.com/forums/301869-powershell/suggestions/13191009-bug-class-can-t-override-a-c-method-with-an-a\n",
    "created_at": "2016-10-21T15:27:53Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2137#issuecomment-255408142",
    "id": 255408142,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2137",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1NTQwODE0Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/255408142/reactions"
    },
    "updated_at": "2016-10-21T15:27:53Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/255408142",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6187529?v=4",
      "events_url": "https://api.github.com/users/fMichaleczek/events{/privacy}",
      "followers_url": "https://api.github.com/users/fMichaleczek/followers",
      "following_url": "https://api.github.com/users/fMichaleczek/following{/other_user}",
      "gists_url": "https://api.github.com/users/fMichaleczek/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/fMichaleczek",
      "id": 6187529,
      "login": "fMichaleczek",
      "node_id": "MDQ6VXNlcjYxODc1Mjk=",
      "organizations_url": "https://api.github.com/users/fMichaleczek/orgs",
      "received_events_url": "https://api.github.com/users/fMichaleczek/received_events",
      "repos_url": "https://api.github.com/users/fMichaleczek/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/fMichaleczek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fMichaleczek/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/fMichaleczek"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@fmichaleczek different, but related. Thank you for adding it to the discussion!\n",
    "created_at": "2016-10-21T15:54:16Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2137#issuecomment-255415066",
    "id": 255415066,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2137",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1NTQxNTA2Ng==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/255415066/reactions"
    },
    "updated_at": "2016-10-21T15:54:16Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/255415066",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/816680?v=4",
      "events_url": "https://api.github.com/users/vors/events{/privacy}",
      "followers_url": "https://api.github.com/users/vors/followers",
      "following_url": "https://api.github.com/users/vors/following{/other_user}",
      "gists_url": "https://api.github.com/users/vors/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vors",
      "id": 816680,
      "login": "vors",
      "node_id": "MDQ6VXNlcjgxNjY4MA==",
      "organizations_url": "https://api.github.com/users/vors/orgs",
      "received_events_url": "https://api.github.com/users/vors/received_events",
      "repos_url": "https://api.github.com/users/vors/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vors/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vors"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@SteveL-MSFT Going back to your original issue, you should be aware that `[ref]` can be applied to values as well as variables:\r\n```\r\nPS[1] (70) > [ref] 1\r\nValue\r\n-----\r\n    1\r\n```\r\nThis is what's happening in your example. When you do `[ref] ($foo.classvar)` you are actually creating a reference to the **value** returned by `classvar`:\r\n```\r\nPS[1] (71) > class Foo {\r\n>>     [string] $classVar\r\n>> }\r\nPS[1] (72) > $x = [foo]::new()\r\nPS[1] (73) > $x.classVar -eq $null\r\nTrue\r\nPS[1] (74) > $r = [ref] ($x.classVar)\r\nPS[1] (75) > $r.Value -eq $null\r\nTrue\r\n```\r\nSo `[ref]` is working as intended.\r\n",
    "created_at": "2018-03-13T18:14:17Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2137#issuecomment-372765937",
    "id": 372765937,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2137",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3Mjc2NTkzNw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/372765937/reactions"
    },
    "updated_at": "2018-03-13T18:14:17Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/372765937",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6876108?v=4",
      "events_url": "https://api.github.com/users/BrucePay/events{/privacy}",
      "followers_url": "https://api.github.com/users/BrucePay/followers",
      "following_url": "https://api.github.com/users/BrucePay/following{/other_user}",
      "gists_url": "https://api.github.com/users/BrucePay/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/BrucePay",
      "id": 6876108,
      "login": "BrucePay",
      "node_id": "MDQ6VXNlcjY4NzYxMDg=",
      "organizations_url": "https://api.github.com/users/BrucePay/orgs",
      "received_events_url": "https://api.github.com/users/BrucePay/received_events",
      "repos_url": "https://api.github.com/users/BrucePay/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/BrucePay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BrucePay/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/BrucePay"
    }
  },
  {
    "author_association": "NONE",
    "body": "I have needed to use `[ref]` when working with a few different soap based web services via `New-WebServiceProxy` that required `[ref]` variables for things like error strings.\r\n\r\nThe functions would error without being called with a `[ref]` variable passed in for that parameter making `[ref]` required as far as I could figure out to use the web service.",
    "created_at": "2018-12-04T15:06:10Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2137#issuecomment-444132305",
    "id": 444132305,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2137",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0NDEzMjMwNQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/444132305/reactions"
    },
    "updated_at": "2018-12-04T15:06:10Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/444132305",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/2277702?v=4",
      "events_url": "https://api.github.com/users/ChrisMagnuson/events{/privacy}",
      "followers_url": "https://api.github.com/users/ChrisMagnuson/followers",
      "following_url": "https://api.github.com/users/ChrisMagnuson/following{/other_user}",
      "gists_url": "https://api.github.com/users/ChrisMagnuson/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ChrisMagnuson",
      "id": 2277702,
      "login": "ChrisMagnuson",
      "node_id": "MDQ6VXNlcjIyNzc3MDI=",
      "organizations_url": "https://api.github.com/users/ChrisMagnuson/orgs",
      "received_events_url": "https://api.github.com/users/ChrisMagnuson/received_events",
      "repos_url": "https://api.github.com/users/ChrisMagnuson/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ChrisMagnuson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ChrisMagnuson/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ChrisMagnuson"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "Closing this since we have a doc issue opened",
    "created_at": "2018-12-20T19:14:32Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2137#issuecomment-449105730",
    "id": 449105730,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2137",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0OTEwNTczMA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/449105730/reactions"
    },
    "updated_at": "2018-12-20T19:14:32Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/449105730",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "I tripped over this today, docs issue is still open :-(",
    "created_at": "2020-01-02T14:08:03Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2137#issuecomment-570217297",
    "id": 570217297,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2137",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MDIxNzI5Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/570217297/reactions"
    },
    "updated_at": "2020-01-02T14:08:03Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/570217297",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/9250262?v=4",
      "events_url": "https://api.github.com/users/bergmeister/events{/privacy}",
      "followers_url": "https://api.github.com/users/bergmeister/followers",
      "following_url": "https://api.github.com/users/bergmeister/following{/other_user}",
      "gists_url": "https://api.github.com/users/bergmeister/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/bergmeister",
      "id": 9250262,
      "login": "bergmeister",
      "node_id": "MDQ6VXNlcjkyNTAyNjI=",
      "organizations_url": "https://api.github.com/users/bergmeister/orgs",
      "received_events_url": "https://api.github.com/users/bergmeister/received_events",
      "repos_url": "https://api.github.com/users/bergmeister/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/bergmeister/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bergmeister/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/bergmeister"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "We also don't have a proper way to handle in/out variables, judging from the discussion above and the lack of anything other than `[ref]` being available. 😕 ",
    "created_at": "2020-01-02T15:52:16Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2137#issuecomment-570248919",
    "id": 570248919,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2137",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MDI0ODkxOQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/570248919/reactions"
    },
    "updated_at": "2020-01-02T15:52:16Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/570248919",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/32407840?v=4",
      "events_url": "https://api.github.com/users/vexx32/events{/privacy}",
      "followers_url": "https://api.github.com/users/vexx32/followers",
      "following_url": "https://api.github.com/users/vexx32/following{/other_user}",
      "gists_url": "https://api.github.com/users/vexx32/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vexx32",
      "id": 32407840,
      "login": "vexx32",
      "node_id": "MDQ6VXNlcjMyNDA3ODQw",
      "organizations_url": "https://api.github.com/users/vexx32/orgs",
      "received_events_url": "https://api.github.com/users/vexx32/received_events",
      "repos_url": "https://api.github.com/users/vexx32/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vexx32/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vexx32/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vexx32"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Yes, I think we should definitely open a feature request issue for this and other things.\r\nToday I wrote a local `Update-ConnectionString` helper function and instead of calling it as `$configObject.connectionstrings[$index] = Update-ConnectionString $configObject.connectionstrings[$index] -otherparams $foo`, it would've been much more elegant to call it as `Update-ConnectionString ([ref]$configObject.connectionstrings[$index]) -otherparams $foo`",
    "created_at": "2020-01-02T15:58:29Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2137#issuecomment-570250898",
    "id": 570250898,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2137",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MDI1MDg5OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/570250898/reactions"
    },
    "updated_at": "2020-01-02T15:58:48Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/570250898",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/9250262?v=4",
      "events_url": "https://api.github.com/users/bergmeister/events{/privacy}",
      "followers_url": "https://api.github.com/users/bergmeister/followers",
      "following_url": "https://api.github.com/users/bergmeister/following{/other_user}",
      "gists_url": "https://api.github.com/users/bergmeister/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/bergmeister",
      "id": 9250262,
      "login": "bergmeister",
      "node_id": "MDQ6VXNlcjkyNTAyNjI=",
      "organizations_url": "https://api.github.com/users/bergmeister/orgs",
      "received_events_url": "https://api.github.com/users/bergmeister/received_events",
      "repos_url": "https://api.github.com/users/bergmeister/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/bergmeister/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bergmeister/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/bergmeister"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "> it would've been much more elegant to call it as `Update-ConnectionString ([ref]$configObject.connectionstrings[$index]) -otherparams $foo`\r\n\r\nI'd love that so much, but I'm not really sure how that would be doable.  You can't safely store a managed pointer on the heap, so a general purpose `[ref]` that works in all places where `ref/in/out` work doesn't seem possible.  Maybe the compiler could have special handling and create a `PSReference` with an instance/array and a field name/index?  Not sure if enough people would use it unfortunately :/",
    "created_at": "2020-01-07T14:16:14Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/2137#issuecomment-571604069",
    "id": 571604069,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/2137",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MTYwNDA2OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/571604069/reactions"
    },
    "updated_at": "2020-01-07T18:36:38Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/571604069",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  }
]

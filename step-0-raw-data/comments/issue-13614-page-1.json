[
  {
    "author_association": "COLLABORATOR",
    "body": "@SteveL-MSFT looks like an issue with ConciseView?\r\n\r\n@Herrmel not with `Write-Error` as far as I'm aware. If you're in a function or script with `[CmdletBinding()]` applied, though, you can use `$PSCmdlet.WriteError($errorRecord)`",
    "created_at": "2020-09-10T13:07:45Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13614#issuecomment-690274807",
    "id": 690274807,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13614",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5MDI3NDgwNw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/690274807/reactions"
    },
    "updated_at": "2020-09-10T13:07:45Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/690274807",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/32407840?v=4",
      "events_url": "https://api.github.com/users/vexx32/events{/privacy}",
      "followers_url": "https://api.github.com/users/vexx32/followers",
      "following_url": "https://api.github.com/users/vexx32/following{/other_user}",
      "gists_url": "https://api.github.com/users/vexx32/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vexx32",
      "id": 32407840,
      "login": "vexx32",
      "node_id": "MDQ6VXNlcjMyNDA3ODQw",
      "organizations_url": "https://api.github.com/users/vexx32/orgs",
      "received_events_url": "https://api.github.com/users/vexx32/received_events",
      "repos_url": "https://api.github.com/users/vexx32/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vexx32/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vexx32/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vexx32"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@Herrmel I've fixed a similar issue in 7.1, can you try your host with 7.1 SDK and see if it repros?",
    "created_at": "2020-09-23T21:55:39Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13614#issuecomment-697993261",
    "id": 697993261,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13614",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5Nzk5MzI2MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/697993261/reactions"
    },
    "updated_at": "2020-09-23T21:55:39Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/697993261",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "NONE",
    "body": "Same result in v7.1 Preview 7",
    "created_at": "2020-09-24T09:38:33Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13614#issuecomment-698235011",
    "id": 698235011,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13614",
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5ODIzNTAxMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/698235011/reactions"
    },
    "updated_at": "2020-09-24T09:38:33Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/698235011",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/36636591?v=4",
      "events_url": "https://api.github.com/users/Herrmel/events{/privacy}",
      "followers_url": "https://api.github.com/users/Herrmel/followers",
      "following_url": "https://api.github.com/users/Herrmel/following{/other_user}",
      "gists_url": "https://api.github.com/users/Herrmel/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Herrmel",
      "id": 36636591,
      "login": "Herrmel",
      "node_id": "MDQ6VXNlcjM2NjM2NTkx",
      "organizations_url": "https://api.github.com/users/Herrmel/orgs",
      "received_events_url": "https://api.github.com/users/Herrmel/received_events",
      "repos_url": "https://api.github.com/users/Herrmel/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Herrmel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Herrmel/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Herrmel"
    }
  },
  {
    "author_association": "NONE",
    "body": "I had this same problem. Adding this made it trigger:\r\n```\r\npowershell.AddScript(script);\r\nforeach (var command in powershell.Commands.Commands)\r\n{\r\n\t// This is what made it trigger\r\n        command.MergeMyResults(PipelineResultTypes.Error, PipelineResultTypes.Output);\r\n\t// Has no effect on whether or not WriteWarning gets called in custom PS host. Always gets called.\r\n\tcommand.MergeMyResults(PipelineResultTypes.Warning, PipelineResultTypes.Output);\r\n}\r\n```",
    "created_at": "2020-10-14T12:03:29Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13614#issuecomment-708356000",
    "id": 708356000,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13614",
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwODM1NjAwMA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/708356000/reactions"
    },
    "updated_at": "2020-10-14T12:03:29Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/708356000",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/1424395?v=4",
      "events_url": "https://api.github.com/users/dkattan/events{/privacy}",
      "followers_url": "https://api.github.com/users/dkattan/followers",
      "following_url": "https://api.github.com/users/dkattan/following{/other_user}",
      "gists_url": "https://api.github.com/users/dkattan/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/dkattan",
      "id": 1424395,
      "login": "dkattan",
      "node_id": "MDQ6VXNlcjE0MjQzOTU=",
      "organizations_url": "https://api.github.com/users/dkattan/orgs",
      "received_events_url": "https://api.github.com/users/dkattan/received_events",
      "repos_url": "https://api.github.com/users/dkattan/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/dkattan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dkattan/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/dkattan"
    }
  },
  {
    "author_association": "NONE",
    "body": "@iSazonov I dont think the answer from @dkattan was a resolution, but a more precise description. I still have the same problem in the newest previewversion (7.2 preview 2). I dont see any reason why ErrorRecords in Write-Error are not Merged to Output but Exceptions do when using `MergeMyResults(PipelineResultTypes.Error, PipelineResultTypes.Output)`? Even the`WriteErrorLine`-Method from the host gets called, but with an empty-string. I really do not think this is working as intended!",
    "created_at": "2021-02-11T08:35:01Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13614#issuecomment-777278522",
    "id": 777278522,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13614",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3NzI3ODUyMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/777278522/reactions"
    },
    "updated_at": "2021-02-11T08:35:01Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/777278522",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/36636591?v=4",
      "events_url": "https://api.github.com/users/Herrmel/events{/privacy}",
      "followers_url": "https://api.github.com/users/Herrmel/followers",
      "following_url": "https://api.github.com/users/Herrmel/following{/other_user}",
      "gists_url": "https://api.github.com/users/Herrmel/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Herrmel",
      "id": 36636591,
      "login": "Herrmel",
      "node_id": "MDQ6VXNlcjM2NjM2NTkx",
      "organizations_url": "https://api.github.com/users/Herrmel/orgs",
      "received_events_url": "https://api.github.com/users/Herrmel/received_events",
      "repos_url": "https://api.github.com/users/Herrmel/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Herrmel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Herrmel/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Herrmel"
    }
  },
  {
    "author_association": "NONE",
    "body": "I have a custom host implementation that I am migrating from v5 to v7.1.3. This is very frustrating and had me stumped for hours... I was trying to execute a script. All code snippets worked. However when I tried to runs a PS1 file nothing would happen. Turns out PSHostUserInterface.WriteErrorLine is sending an empty string. So when I tried to Execute a script when the ExecutionPolicy is set for \"Undefined\" I was just getting an empty line.\r\n\r\nI expected to see an error but nothing was outputting and I just could not figure out why. Finally noticed this. \r\n\r\n![image](https://user-images.githubusercontent.com/840590/118303550-9365cc80-b4b3-11eb-992f-69a1b48b29cd.png)\r\n\r\nI've very sure this is not expected. I'm thinking the exception value (Message) should be passed to WriteErrorLine, correct?\r\n",
    "created_at": "2021-05-14T16:55:23Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13614#issuecomment-841371811",
    "id": 841371811,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13614",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MTM3MTgxMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/841371811/reactions"
    },
    "updated_at": "2021-05-14T16:57:16Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/841371811",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/840590?v=4",
      "events_url": "https://api.github.com/users/BobbyCannon/events{/privacy}",
      "followers_url": "https://api.github.com/users/BobbyCannon/followers",
      "following_url": "https://api.github.com/users/BobbyCannon/following{/other_user}",
      "gists_url": "https://api.github.com/users/BobbyCannon/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/BobbyCannon",
      "id": 840590,
      "login": "BobbyCannon",
      "node_id": "MDQ6VXNlcjg0MDU5MA==",
      "organizations_url": "https://api.github.com/users/BobbyCannon/orgs",
      "received_events_url": "https://api.github.com/users/BobbyCannon/received_events",
      "repos_url": "https://api.github.com/users/BobbyCannon/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/BobbyCannon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BobbyCannon/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/BobbyCannon"
    }
  },
  {
    "author_association": "NONE",
    "body": "![image](https://user-images.githubusercontent.com/840590/118304311-81d0f480-b4b4-11eb-8ce7-02a9fb25a347.png)\r\n\r\nDecided to just test a \"Write-Error\" and boom it's empty. \r\n\r\n![image](https://user-images.githubusercontent.com/840590/118304528-c5c3f980-b4b4-11eb-9177-201f023611dd.png)\r\n\r\nWhere exactly is the 'Error' parameter data going? If this behavior is intended then how do we get to the error content?\r\n",
    "created_at": "2021-05-14T17:04:27Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13614#issuecomment-841376854",
    "id": 841376854,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13614",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MTM3Njg1NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/841376854/reactions"
    },
    "updated_at": "2021-05-14T17:04:27Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/841376854",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/840590?v=4",
      "events_url": "https://api.github.com/users/BobbyCannon/events{/privacy}",
      "followers_url": "https://api.github.com/users/BobbyCannon/followers",
      "following_url": "https://api.github.com/users/BobbyCannon/following{/other_user}",
      "gists_url": "https://api.github.com/users/BobbyCannon/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/BobbyCannon",
      "id": 840590,
      "login": "BobbyCannon",
      "node_id": "MDQ6VXNlcjg0MDU5MA==",
      "organizations_url": "https://api.github.com/users/BobbyCannon/orgs",
      "received_events_url": "https://api.github.com/users/BobbyCannon/received_events",
      "repos_url": "https://api.github.com/users/BobbyCannon/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/BobbyCannon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BobbyCannon/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/BobbyCannon"
    }
  },
  {
    "author_association": "NONE",
    "body": "Maybe add a few unit test that validate the output is working as expected.\r\n\r\n* EnsureWriteErrorWorks: **Fails**\r\n* EnsureWriteWarningWorks: Passes\r\n\r\n```csharp\r\n[TestMethod]\r\npublic void EnsureWriteErrorWorks()\r\n{\r\n\tvar options = GetOptions();\r\n\tvar channel = new MemoryChannel();\r\n\tusing var host = new PowerShellConsole(channel, options.ToJson());\r\n\tAssert.AreEqual(true, host.IsInitialized);\r\n\tchannel.Messages.ForEach(x => Console.WriteLine(x));\r\n\tchannel.Messages.Clear();\r\n\r\n\thost.Execute(\"Write-Error 'error'\", true, true);\r\n\tchannel.Messages.ForEach(x => Console.WriteLine(x));\r\n\tAssert.IsTrue(channel.Messages.Any(x => x == \"Write Line: error\"));\r\n}\r\n\r\n[TestMethod]\r\npublic void EnsureWriteWarningWorks()\r\n{\r\n\tvar options = GetOptions();\r\n\tvar channel = new MemoryChannel();\r\n\tusing var host = new PowerShellConsole(channel, options.ToJson());\r\n\tAssert.AreEqual(true, host.IsInitialized);\r\n\tchannel.Messages.ForEach(x => Console.WriteLine(x));\r\n\tchannel.Messages.Clear();\r\n\r\n\thost.Execute(\"Write-Warning 'warning'\", true, true);\r\n\tchannel.Messages.ForEach(x => Console.WriteLine(x));\r\n\tAssert.IsTrue(channel.Messages.Any(x => x == \"Write Line: warning\"));\r\n}\r\n```",
    "created_at": "2021-05-14T17:47:34Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13614#issuecomment-841403424",
    "id": 841403424,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13614",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MTQwMzQyNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/841403424/reactions"
    },
    "updated_at": "2021-05-14T17:47:34Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/841403424",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/840590?v=4",
      "events_url": "https://api.github.com/users/BobbyCannon/events{/privacy}",
      "followers_url": "https://api.github.com/users/BobbyCannon/followers",
      "following_url": "https://api.github.com/users/BobbyCannon/following{/other_user}",
      "gists_url": "https://api.github.com/users/BobbyCannon/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/BobbyCannon",
      "id": 840590,
      "login": "BobbyCannon",
      "node_id": "MDQ6VXNlcjg0MDU5MA==",
      "organizations_url": "https://api.github.com/users/BobbyCannon/orgs",
      "received_events_url": "https://api.github.com/users/BobbyCannon/received_events",
      "repos_url": "https://api.github.com/users/BobbyCannon/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/BobbyCannon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BobbyCannon/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/BobbyCannon"
    }
  },
  {
    "author_association": "NONE",
    "body": "@vexx32  @SteveL-MSFT  I agree, it for sure has something to do with $ErrorView\r\n\r\nConciseView gives **no response** (well, an empty string)\r\nCategoryView and NormalView give proper responses\r\n\r\n![image](https://user-images.githubusercontent.com/840590/118319614-ff066480-b4c8-11eb-89a2-b8370b91f293.png)\r\n",
    "created_at": "2021-05-14T19:29:11Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/13614#issuecomment-841456985",
    "id": 841456985,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/13614",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MTQ1Njk4NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/841456985/reactions"
    },
    "updated_at": "2021-05-14T19:41:08Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/841456985",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/840590?v=4",
      "events_url": "https://api.github.com/users/BobbyCannon/events{/privacy}",
      "followers_url": "https://api.github.com/users/BobbyCannon/followers",
      "following_url": "https://api.github.com/users/BobbyCannon/following{/other_user}",
      "gists_url": "https://api.github.com/users/BobbyCannon/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/BobbyCannon",
      "id": 840590,
      "login": "BobbyCannon",
      "node_id": "MDQ6VXNlcjg0MDU5MA==",
      "organizations_url": "https://api.github.com/users/BobbyCannon/orgs",
      "received_events_url": "https://api.github.com/users/BobbyCannon/received_events",
      "repos_url": "https://api.github.com/users/BobbyCannon/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/BobbyCannon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BobbyCannon/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/BobbyCannon"
    }
  }
]

[
  {
    "author_association": "CONTRIBUTOR",
    "body": "PowerShell seems to infer the existence of the specified path _as is_  from whether the [GetFileAttributes()](https://msdn.microsoft.com/en-us/library/windows/desktop/aa364944%28v=vs.85%29.aspx) native Windows API function finds the file (by successfully returning its attributes). \r\n\r\nIt is `GetFileAttributes()` that inexplicably accepts the trailing `...` appended to an existing file's path and still returns the file's attributes, _except_ when support for long paths is turned on by prepending `\\\\?\\`, as the following C# snippet demonstrates:\r\n\r\n```c#\r\npublic static class GetFileAttributesTest\r\n{\r\n\r\n\t[DllImport(\"kernel32.dll\", CharSet = CharSet.Auto, SetLastError = true)]\r\n\tstatic extern uint GetFileAttributes(string lpFileName);\r\n\r\n\tconst uint INVALID_FILE_ATTRIBUTES = 0xffffffff;\r\n\r\n\tpublic static void Main()\r\n\t{\r\n\t\tstring path = @\"c:\\windows\\system32\\cmd.exe...\";\r\n                // !! SUCCEEDS, despite trailing '...'\r\n\t\tvar attrShortPath = GetFileAttributes(path);\r\n                // FAILS, as expected.\r\n\t\tvar attrLongPath = GetFileAttributes($@\"\\\\?\\{path}\");\r\n\t\tvar foundShortPath = attrShortPath != INVALID_FILE_ATTRIBUTES;\r\n\t\tvar foundLongPath= attrLongPath != INVALID_FILE_ATTRIBUTES;\r\n\t}\r\n\r\n}\r\n```\r\n\r\n",
    "created_at": "2017-02-24T14:19:38Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3197#issuecomment-282301993",
    "id": 282301993,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3197",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MjMwMTk5Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/282301993/reactions"
    },
    "updated_at": "2017-02-24T14:19:38Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/282301993",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "This originally surfaced from looking at `Get-ChildItem -Filter`, and how the Filter wildcards are handled by the filesystem provider. There, it is expected that a dot `.` wildcard will match at the end of a filename, e.g.\r\n   - in a command prompt `dir c:\\windows\\system32\\cmd.exe.......`  will find the file, but it will have the correct name.\r\n   - This replicates in PowerShell using the -Filter parameter, e.g.\r\n   - `gci -LiteralPath c:\\windows\\system32\\ -Filter 'cmd.exe.'` will find it, with the correct name (no dot)\r\n\r\nSo the buggy bit (to me) is that the PowerShell wildcarding, without using Filter, does match the file but pulls it back with the wrong name.\r\n\r\n - This behavior happens back to PS 2.0 on Server 2003 SP2 (so I imagine it's known about / documented somewhere previously).\r\n- (edit: removed BaseName comments, it's ca calculated property, they weren't relevant)\r\n- As well as `Get-Item`, this affects `Get-ChildItem`:\r\n   - `Get-ChildItem -LiteralPath c:\\windows\\system32\\cmd.exe.` returns a file with an incorrect name.",
    "created_at": "2017-02-24T19:46:02Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3197#issuecomment-282386592",
    "id": 282386592,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3197",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MjM4NjU5Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/282386592/reactions"
    },
    "updated_at": "2017-02-24T22:10:20Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/282386592",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/187787?v=4",
      "events_url": "https://api.github.com/users/HumanEquivalentUnit/events{/privacy}",
      "followers_url": "https://api.github.com/users/HumanEquivalentUnit/followers",
      "following_url": "https://api.github.com/users/HumanEquivalentUnit/following{/other_user}",
      "gists_url": "https://api.github.com/users/HumanEquivalentUnit/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/HumanEquivalentUnit",
      "id": 187787,
      "login": "HumanEquivalentUnit",
      "node_id": "MDQ6VXNlcjE4Nzc4Nw==",
      "organizations_url": "https://api.github.com/users/HumanEquivalentUnit/orgs",
      "received_events_url": "https://api.github.com/users/HumanEquivalentUnit/received_events",
      "repos_url": "https://api.github.com/users/HumanEquivalentUnit/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/HumanEquivalentUnit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/HumanEquivalentUnit/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/HumanEquivalentUnit"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@HumanEquivalentUnit: Thanks for the additional information.\r\n\r\n* Given that the problem surfaces with `-LiteralPath` (too), it is not about _wildcarding_; I think that passing the path as a _literal_ to `GetFileAttributes`, and inferring from its ability to successfully return  attributes for it that the path is valid _as-is_ is the problem.\r\n\r\n* `.BaseName` being incorrect is just a follow-on effect of `.Name` being incorrect: `.BaseName` is a script property that chops off the extension from the `.Name` property by string length, and since `.Extension` has the correct value (`.exe`, in this case), whereas `.Name` has the extraneous trailing `.` chars.,  a part of the extension unexpectedly surfaces in `.BaseName`.",
    "created_at": "2017-02-24T20:51:35Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3197#issuecomment-282401221",
    "id": 282401221,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3197",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MjQwMTIyMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/282401221/reactions"
    },
    "updated_at": "2017-02-24T20:51:35Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/282401221",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "I believe this is how Win32 (not PowerShell, not .Net, but Win32) path processing works - removing trailing dots is, well, expected.\r\n\r\nHere is a rather definitive reference, based on reverse engineering:\r\n\r\nhttps://googleprojectzero.blogspot.cz/2016/02/the-definitive-guide-on-win32-to-nt.html",
    "created_at": "2017-02-27T05:33:48Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3197#issuecomment-282632072",
    "id": 282632072,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3197",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MjYzMjA3Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/282632072/reactions"
    },
    "updated_at": "2017-02-27T05:33:48Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/282632072",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/2148248?v=4",
      "events_url": "https://api.github.com/users/lzybkr/events{/privacy}",
      "followers_url": "https://api.github.com/users/lzybkr/followers",
      "following_url": "https://api.github.com/users/lzybkr/following{/other_user}",
      "gists_url": "https://api.github.com/users/lzybkr/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/lzybkr",
      "id": 2148248,
      "login": "lzybkr",
      "node_id": "MDQ6VXNlcjIxNDgyNDg=",
      "organizations_url": "https://api.github.com/users/lzybkr/orgs",
      "received_events_url": "https://api.github.com/users/lzybkr/received_events",
      "repos_url": "https://api.github.com/users/lzybkr/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/lzybkr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lzybkr/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/lzybkr"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@lzybkr: Thanks for that link - interesting (and frightening) read. The relevant passage (emphasis added) tells us that trailing _spaces_ are ignored as well:\r\n\r\n> \t**Remove any trailing spaces or dots for the last path element**, assuming that it isn’t a single or double dot name.\r\n> \t \r\n> That last rule seems odd, but as we’ll see it really does do this for normal paths.\r\n\r\n",
    "created_at": "2017-02-27T17:45:53Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3197#issuecomment-282794426",
    "id": 282794426,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3197",
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4Mjc5NDQyNg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/282794426/reactions"
    },
    "updated_at": "2017-02-27T17:45:53Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/282794426",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  }
]

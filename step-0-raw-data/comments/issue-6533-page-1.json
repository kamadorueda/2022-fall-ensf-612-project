[
  {
    "author_association": "NONE",
    "body": "Just ran across this myself. Was going to file a separate issue, but will throw my comments in here instead. I'm not sure if this is specific to compiled modules or not, but that's how I came across mine.\r\n\r\n# Steps to reproduce\r\n\r\n1. Create a cmdlet in C# targetting .NET Standard (I used 2.0, not sure the version matters) and compile it via `dotnet publish --self-contained`.\r\n2. Create a `.psd1` manifest for that module\r\n3. Specify the output assembly file in `NestedModules` in the `.psd1`\r\n4. Specify a `ProcessorArchitecture` of `Amd64` in the `.psd1`\r\n5. Attempt to import the module\r\n\r\n# Expected behavior\r\n* The module is imported properly on non-Windows systems\r\n\r\n# Actual behavior\r\n* On Windows systems, the module imports properly.\r\n* On non-Windows systems, the module import will fail with the following error:\r\n```\r\nipmo : Unable to load shared library 'api-ms-win-core-sysinfo-l1-1-0.dll' or one of its dependencies. In order to help diagnose loading problems, consider setting the LD_DEBUG environment variable: libapi-ms-win-core-sysinfo-l1-1-0.dll: cannot open shared object file: No such file or directory\r\nAt line:1 char:16\r\n+ cd /powerkube; ipmo ./output/PowerKube.psd1\r\n+                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+ CategoryInfo          : NotSpecified: (:) [Import-Module], DllNotFoundException\r\n+ FullyQualifiedErrorId : System.DllNotFoundException,Microsoft.PowerShell.Commands.ImportModuleCommand\r\n```\r\n\r\n# Environment data\r\n\r\n## Linux\r\n\r\n```none\r\nName                           Value\r\n----                           -----\r\nPSVersion                      6.1.1\r\nPSEdition                      Core\r\nGitCommitId                    6.1.1\r\nOS                             Linux 4.9.125-linuxkit #1 SMP Fri Sep 7 08:20:28 UTC 2018\r\nPlatform                       Unix\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n\r\n## Windows\r\n```none\r\nName                           Value\r\n----                           -----\r\nPSVersion                      6.1.1\r\nPSEdition                      Core\r\nGitCommitId                    6.1.1\r\nOS                             Microsoft Windows 10.0.17134\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n\r\n## Stack Trace\r\n```none\r\nat System.Management.Automation.PsUtils.NativeMethods.GetSystemInfo(SYSTEM_INFO& lpSystemInfo)\r\n   at System.Management.Automation.PsUtils.GetProcessorArchitecture(Boolean& isRunningOnArm)\r\n   at Microsoft.PowerShell.Commands.ModuleCmdletBase.LoadModuleManifest(String moduleManifestPath, ExternalScriptInfo manifestScriptInfo, Hashtable data, Hashtable localizedData, ManifestProcessingFlags manifestProcessingFlags, Version minimumVersion, Version maximumVersion, Version requiredVersion, Nullable`1 requiredModuleGuid, ImportModuleOptions& options, Boolean& containedErrors)\r\n   at Microsoft.PowerShell.Commands.ModuleCmdletBase.LoadModuleManifest(ExternalScriptInfo scriptInfo, ManifestProcessingFlags manifestProcessingFlags, Version minimumVersion, Version maximumVersion, Version requiredVersion, Nullable`1 requiredModuleGuid, ImportModuleOptions& options)\r\n   at Microsoft.PowerShell.Commands.ModuleCmdletBase.LoadModule(PSModuleInfo parentModule, String fileName, String moduleBase, String prefix, SessionState ss, Object privateData, ImportModuleOptions& options, ManifestProcessingFlags manifestProcessingFlags, Boolean& found, Boolean& moduleFileFound)\r\n   at Microsoft.PowerShell.Commands.ModuleCmdletBase.LoadModule(String fileName, String moduleBase, String prefix, SessionState ss, ImportModuleOptions& options, ManifestProcessingFlags manifestProcessingFlags, Boolean& found)\r\n   at Microsoft.PowerShell.Commands.ImportModuleCommand.ImportModule_LocallyViaName(ImportModuleOptions importModuleOptions, String name)\r\n   at Microsoft.PowerShell.Commands.ImportModuleCommand.ProcessRecord()\r\n   at System.Management.Automation.Cmdlet.DoProcessRecord()\r\n   at System.Management.Automation.CommandProcessor.ProcessRecord()\r\n```",
    "created_at": "2018-12-12T21:51:18Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6533#issuecomment-446757587",
    "id": 446757587,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6533",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0Njc1NzU4Nw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/446757587/reactions"
    },
    "updated_at": "2018-12-12T21:51:18Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/446757587",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11413?v=4",
      "events_url": "https://api.github.com/users/DWSR/events{/privacy}",
      "followers_url": "https://api.github.com/users/DWSR/followers",
      "following_url": "https://api.github.com/users/DWSR/following{/other_user}",
      "gists_url": "https://api.github.com/users/DWSR/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/DWSR",
      "id": 11413,
      "login": "DWSR",
      "node_id": "MDQ6VXNlcjExNDEz",
      "organizations_url": "https://api.github.com/users/DWSR/orgs",
      "received_events_url": "https://api.github.com/users/DWSR/received_events",
      "repos_url": "https://api.github.com/users/DWSR/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/DWSR/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DWSR/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/DWSR"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "I looked at this per @DWSR request.\r\n\r\nUpon importing a module GetProcessorArchitechture() is called here\r\n\r\nhttps://github.com/PowerShell/PowerShell/blob/2b4199a78a1b91f2ea53732597f1467788d1bbb2/src/System.Management.Automation/engine/Modules/ModuleCmdletBase.cs#L1852\r\n\r\nwhich is defined here\r\n\r\nhttps://github.com/PowerShell/PowerShell/blob/2b4199a78a1b91f2ea53732597f1467788d1bbb2/src/System.Management.Automation/utils/PsUtils.cs#L141\r\n\r\nWhich then calls GetStsyemInfo which is defined here\r\n\r\nhttps://github.com/PowerShell/PowerShell/blob/2b4199a78a1b91f2ea53732597f1467788d1bbb2/src/System.Management.Automation/utils/PsUtils.cs#L265-L266\r\n\r\nwhich is PINvoking the `api-ms-win-core-sysinfo-l1-1-0.dll` as defined here:\r\n\r\nhttps://github.com/PowerShell/PowerShell/blob/2b4199a78a1b91f2ea53732597f1467788d1bbb2/src/System.Management.Automation/utils/PInvokeDllNames.cs#L58\r\n\r\nThis is why on non-windows ` Unable to load shared library 'api-ms-win-core-sysinfo-l1-1-0.dll'` happens",
    "created_at": "2018-12-16T18:58:35Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6533#issuecomment-447667080",
    "id": 447667080,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6533",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0NzY2NzA4MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/447667080/reactions"
    },
    "updated_at": "2018-12-16T18:58:35Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/447667080",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6509955?v=4",
      "events_url": "https://api.github.com/users/markekraus/events{/privacy}",
      "followers_url": "https://api.github.com/users/markekraus/followers",
      "following_url": "https://api.github.com/users/markekraus/following{/other_user}",
      "gists_url": "https://api.github.com/users/markekraus/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/markekraus",
      "id": 6509955,
      "login": "markekraus",
      "node_id": "MDQ6VXNlcjY1MDk5NTU=",
      "organizations_url": "https://api.github.com/users/markekraus/orgs",
      "received_events_url": "https://api.github.com/users/markekraus/received_events",
      "repos_url": "https://api.github.com/users/markekraus/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/markekraus/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/markekraus/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/markekraus"
    }
  },
  {
    "author_association": "NONE",
    "body": "Will this be addressed for the final release of Powershell Core 7?\r\nIt is still an issue in Preview 4.",
    "created_at": "2019-10-22T10:34:12Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6533#issuecomment-544900421",
    "id": 544900421,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6533",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NDkwMDQyMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/544900421/reactions"
    },
    "updated_at": "2019-10-22T10:34:12Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/544900421",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/7192499?v=4",
      "events_url": "https://api.github.com/users/ZonderP/events{/privacy}",
      "followers_url": "https://api.github.com/users/ZonderP/followers",
      "following_url": "https://api.github.com/users/ZonderP/following{/other_user}",
      "gists_url": "https://api.github.com/users/ZonderP/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ZonderP",
      "id": 7192499,
      "login": "ZonderP",
      "node_id": "MDQ6VXNlcjcxOTI0OTk=",
      "organizations_url": "https://api.github.com/users/ZonderP/orgs",
      "received_events_url": "https://api.github.com/users/ZonderP/received_events",
      "repos_url": "https://api.github.com/users/ZonderP/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ZonderP/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ZonderP/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ZonderP"
    }
  },
  {
    "author_association": "NONE",
    "body": "Again:\r\nWill this be addressed for the final release of Powershell Core 7?\r\nIt is still an issue in RC1.",
    "created_at": "2020-01-09T16:02:14Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6533#issuecomment-572627348",
    "id": 572627348,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6533",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MjYyNzM0OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/572627348/reactions"
    },
    "updated_at": "2020-01-09T16:02:14Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/572627348",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/7192499?v=4",
      "events_url": "https://api.github.com/users/ZonderP/events{/privacy}",
      "followers_url": "https://api.github.com/users/ZonderP/followers",
      "following_url": "https://api.github.com/users/ZonderP/following{/other_user}",
      "gists_url": "https://api.github.com/users/ZonderP/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ZonderP",
      "id": 7192499,
      "login": "ZonderP",
      "node_id": "MDQ6VXNlcjcxOTI0OTk=",
      "organizations_url": "https://api.github.com/users/ZonderP/orgs",
      "received_events_url": "https://api.github.com/users/ZonderP/received_events",
      "repos_url": "https://api.github.com/users/ZonderP/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ZonderP/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ZonderP/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ZonderP"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "I believe https://github.com/PowerShell/PowerShell/pull/11046 will resolve this",
    "created_at": "2020-01-09T17:45:02Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6533#issuecomment-572673753",
    "id": 572673753,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6533",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MjY3Mzc1Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/572673753/reactions"
    },
    "updated_at": "2020-01-09T17:45:02Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/572673753",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "I hope it was fixed in #11046 but we need to do manual check.",
    "created_at": "2020-01-14T03:47:50Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6533#issuecomment-573986707",
    "id": 573986707,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6533",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3Mzk4NjcwNw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/573986707/reactions"
    },
    "updated_at": "2020-01-14T03:47:50Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/573986707",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": ":tada:This issue was addressed in #11046, which has now been successfully released as `v7.0.0-rc.2`.:tada:\n\nHandy links:\n* [Release Notes](https://github.com/PowerShell/PowerShell/releases/tag/v7.0.0-rc.2)\n",
    "created_at": "2020-01-16T23:37:04Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6533#issuecomment-575397380",
    "id": 575397380,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6533",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3NTM5NzM4MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/575397380/reactions"
    },
    "updated_at": "2020-01-16T23:37:04Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/575397380",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  },
  {
    "author_association": "NONE",
    "body": "Thanks! Works now in Powershell 7 RC2!",
    "created_at": "2020-01-17T16:16:36Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6533#issuecomment-575692291",
    "id": 575692291,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6533",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3NTY5MjI5MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/575692291/reactions"
    },
    "updated_at": "2020-01-17T16:16:36Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/575692291",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/7192499?v=4",
      "events_url": "https://api.github.com/users/ZonderP/events{/privacy}",
      "followers_url": "https://api.github.com/users/ZonderP/followers",
      "following_url": "https://api.github.com/users/ZonderP/following{/other_user}",
      "gists_url": "https://api.github.com/users/ZonderP/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ZonderP",
      "id": 7192499,
      "login": "ZonderP",
      "node_id": "MDQ6VXNlcjcxOTI0OTk=",
      "organizations_url": "https://api.github.com/users/ZonderP/orgs",
      "received_events_url": "https://api.github.com/users/ZonderP/received_events",
      "repos_url": "https://api.github.com/users/ZonderP/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ZonderP/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ZonderP/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ZonderP"
    }
  }
]

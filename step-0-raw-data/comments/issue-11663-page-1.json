[
  {
    "author_association": "NONE",
    "body": "To check how this works run `Measure-Command {}` 8 or 10 times with no command in the brackets to be measured. It measures its self.",
    "created_at": "2020-01-22T23:06:35Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11663#issuecomment-577428500",
    "id": 577428500,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11663",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3NzQyODUwMA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/577428500/reactions"
    },
    "updated_at": "2020-01-22T23:07:01Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/577428500",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/5000697?v=4",
      "events_url": "https://api.github.com/users/whitequill/events{/privacy}",
      "followers_url": "https://api.github.com/users/whitequill/followers",
      "following_url": "https://api.github.com/users/whitequill/following{/other_user}",
      "gists_url": "https://api.github.com/users/whitequill/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/whitequill",
      "id": 5000697,
      "login": "whitequill",
      "node_id": "MDQ6VXNlcjUwMDA2OTc=",
      "organizations_url": "https://api.github.com/users/whitequill/orgs",
      "received_events_url": "https://api.github.com/users/whitequill/received_events",
      "repos_url": "https://api.github.com/users/whitequill/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/whitequill/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/whitequill/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/whitequill"
    }
  },
  {
    "author_association": "NONE",
    "body": "No. I've not checked if this is how the Measure-Command works Powershell 7.\r\nI've only checked in Powershell 6.",
    "created_at": "2020-01-22T23:30:44Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11663#issuecomment-577435369",
    "id": 577435369,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11663",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3NzQzNTM2OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/577435369/reactions"
    },
    "updated_at": "2020-01-22T23:31:21Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/577435369",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/5000697?v=4",
      "events_url": "https://api.github.com/users/whitequill/events{/privacy}",
      "followers_url": "https://api.github.com/users/whitequill/followers",
      "following_url": "https://api.github.com/users/whitequill/following{/other_user}",
      "gists_url": "https://api.github.com/users/whitequill/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/whitequill",
      "id": 5000697,
      "login": "whitequill",
      "node_id": "MDQ6VXNlcjUwMDA2OTc=",
      "organizations_url": "https://api.github.com/users/whitequill/orgs",
      "received_events_url": "https://api.github.com/users/whitequill/received_events",
      "repos_url": "https://api.github.com/users/whitequill/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/whitequill/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/whitequill/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/whitequill"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "See the cmdlet implementation:\r\nhttps://github.com/PowerShell/PowerShell/blob/12425f24c0c896661a715445647e26e74050d01d/src/Microsoft.PowerShell.Commands.Utility/commands/utility/TimeExpressionCommand.cs#L61-L71\r\n\r\nAs you see the cmdlet doesn't measure itself.",
    "created_at": "2020-01-23T06:26:13Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11663#issuecomment-577524791",
    "id": 577524791,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11663",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3NzUyNDc5MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/577524791/reactions"
    },
    "updated_at": "2020-01-23T06:26:13Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/577524791",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@whitequill, in PowerShell there is inherent, non-trivial overhead in invoking even just `{}` (an empty script block), and that's what you see.\r\n\r\nGenerally, `Measure-Command` measures _wall-clock_ time of executions, which means that it is susceptible to how busy your system is overall.\r\nIt is _not_ a high-resolution profiling tool that measures just the given code's CPU time.\r\n\r\nPragmatically speaking, it makes sense to ensure that your system is not too busy with other tasks and to [average _multiple_ runs](https://gist.github.com/mklement0/9e1f13978620b09ab2d15da5535d1b27) of your code to get a more realistic sense of execution time, but note that caching and JIT compilation can then distort the results.\r\n\r\nIn short (but perhaps people better versed in performance measurement and with a deeper knowledge of PowerShell can chime in; @SeeminglyScience?): \r\n\r\nDon't look to a scripting language for consistent, predictable performance; in the context of PowerShell, `Measure-Command`'s current behavior seems adequate.\r\n\r\nHowever, there is one notable pitfall that predictably makes `Measure-Command` report _longer_ execution times:\r\n\r\n* It executes the given script block in the _caller's_ scope rather than in a _child_ scope, which slows down execution - see #8911; you can work around this by using a nested script-block call with `& { ... }` [update: it takes many local-variable accesses for this to make a difference, though - see next comment]\r\n",
    "created_at": "2020-01-23T17:48:17Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11663#issuecomment-577793000",
    "id": 577793000,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11663",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3Nzc5MzAwMA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/577793000/reactions"
    },
    "updated_at": "2020-01-23T20:48:23Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/577793000",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "> Don't look to a scripting language for consistent, predictable performance; in the context of PowerShell, `Measure-Command`'s current behavior seems adequate.\r\n\r\nMore specifically a lot of PowerShell is dynamically resolved (commands, methods, types, basically everything) so the engine has a *ton* of different caches for these results.  Often the first run of anything will be slower than subsequent runs.  On top of that, in most cases every script block is interpreted for a certain number of runs before it's compiled into CIL byte code.  That portion of code will be slower until it is finally compiled.  I don't know off the top of my head if the new tiered JIT compilation applies to dynamic methods, but if it does that's *another* layer of eventual optimization.\r\n\r\n`Measure-Command` can give you a very rough idea but that's about it.  It's not impossible for the engine to support more reliable performance profiling, but even then it won't be as simple as `Measure-Command`.  Understanding a snippets *real* performance at various points in it's lifetime will likely be a rather involved task, even more so then something like `BenchmarkDotNet`.\r\n\r\n> However, there is one notable pitfall that predictably makes `Measure-Command` report _longer_ execution times:\r\n> \r\n> * It executes the given script block in the _caller's_ scope rather than in a _child_ scope, which slows down execution - see #8911; you can work around this by using a nested script-block call with `& { ... }`\r\n\r\nYeah.  Though it's worth mentioning that it's unlikely to manifest in OP's example.  Typically the difference is around local variable access. Even then it needs quite a few accesses (like 10k+) to even be measurable iirc.  It *mostly* affects folks trying to measure micro benchmarks with an artificially inflated scale.  It's real easy to accidentally leave in some locals in one test that completely throw off the results.",
    "created_at": "2020-01-23T18:04:47Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11663#issuecomment-577799560",
    "id": 577799560,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11663",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3Nzc5OTU2MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/577799560/reactions"
    },
    "updated_at": "2020-01-23T18:11:13Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/577799560",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  },
  {
    "author_association": "NONE",
    "body": "This issue has been marked as answered and has not had any activity for **1 day**. It has been closed for housekeeping purposes.",
    "created_at": "2020-02-03T00:00:17Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11663#issuecomment-581192443",
    "id": 581192443,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11663",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4MTE5MjQ0Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/581192443/reactions"
    },
    "updated_at": "2020-02-03T00:00:17Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/581192443",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  }
]

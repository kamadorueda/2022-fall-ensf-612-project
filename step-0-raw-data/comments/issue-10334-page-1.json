[
  {
    "author_association": "COLLABORATOR",
    "body": "@KirkMunro Why not just use a separate runspace.",
    "created_at": "2019-08-10T01:51:09Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/10334#issuecomment-520108423",
    "id": 520108423,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/10334",
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyMDEwODQyMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 1,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/520108423/reactions"
    },
    "updated_at": "2019-08-10T01:51:09Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/520108423",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6876108?v=4",
      "events_url": "https://api.github.com/users/BrucePay/events{/privacy}",
      "followers_url": "https://api.github.com/users/BrucePay/followers",
      "following_url": "https://api.github.com/users/BrucePay/following{/other_user}",
      "gists_url": "https://api.github.com/users/BrucePay/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/BrucePay",
      "id": 6876108,
      "login": "BrucePay",
      "node_id": "MDQ6VXNlcjY4NzYxMDg=",
      "organizations_url": "https://api.github.com/users/BrucePay/orgs",
      "received_events_url": "https://api.github.com/users/BrucePay/received_events",
      "repos_url": "https://api.github.com/users/BrucePay/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/BrucePay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BrucePay/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/BrucePay"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@BrucePay That's a great question, and I'm going to think about that for a bit.\r\n\r\nNow you've got me wondering if this is as simple as something that just isn't obvious because it's not a documented best practice to use for things like this, but maybe it should be.\r\n\r\nAs someone who has worked on PowerShell tools for many years, where this problem has shown up here and there, I wonder why I never thought of doing that. I'm not the only one, though, because this showed up in PowerGUI, it was an issue in PowerWF/PowerSE, and now it shows up in VSCode-PowerShell, and nobody involved other than you, just now, suggested using a separate runspace, so it's not an obvious design approach that just jumps out at you. At least, not until you hear it from @BrucePay.",
    "created_at": "2019-08-10T02:25:33Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/10334#issuecomment-520110482",
    "id": 520110482,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/10334",
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyMDExMDQ4Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/520110482/reactions"
    },
    "updated_at": "2019-08-10T02:25:33Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/520110482",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/3515485?v=4",
      "events_url": "https://api.github.com/users/KirkMunro/events{/privacy}",
      "followers_url": "https://api.github.com/users/KirkMunro/followers",
      "following_url": "https://api.github.com/users/KirkMunro/following{/other_user}",
      "gists_url": "https://api.github.com/users/KirkMunro/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/KirkMunro",
      "id": 3515485,
      "login": "KirkMunro",
      "node_id": "MDQ6VXNlcjM1MTU0ODU=",
      "organizations_url": "https://api.github.com/users/KirkMunro/orgs",
      "received_events_url": "https://api.github.com/users/KirkMunro/received_events",
      "repos_url": "https://api.github.com/users/KirkMunro/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/KirkMunro/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/KirkMunro/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/KirkMunro"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@BrucePay After thinking on this some more, doubting that it's really that simple, and seeing [@SeeminglyScience confirm that it's not that simple](https://github.com/PowerShell/vscode-powershell/issues/2121#issuecomment-520545909), I'm back to my original thought: it's not that simple, and the SDK should support working with PowerShell in a runspace without taking user preferences into account.\r\n\r\nTools that don't care about state could use their own runspace, but tools that are built on top of PowerShell, offering an IDE, or debugging, etc. need state information from the user's runspace to ensure that they are working with the same information that is available to the user, and they wouldn't have access to that information if they used a separate runspace.",
    "created_at": "2019-08-12T18:51:29Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/10334#issuecomment-520549821",
    "id": 520549821,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/10334",
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyMDU0OTgyMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/520549821/reactions"
    },
    "updated_at": "2019-08-12T18:51:54Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/520549821",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/3515485?v=4",
      "events_url": "https://api.github.com/users/KirkMunro/events{/privacy}",
      "followers_url": "https://api.github.com/users/KirkMunro/followers",
      "following_url": "https://api.github.com/users/KirkMunro/following{/other_user}",
      "gists_url": "https://api.github.com/users/KirkMunro/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/KirkMunro",
      "id": 3515485,
      "login": "KirkMunro",
      "node_id": "MDQ6VXNlcjM1MTU0ODU=",
      "organizations_url": "https://api.github.com/users/KirkMunro/orgs",
      "received_events_url": "https://api.github.com/users/KirkMunro/received_events",
      "repos_url": "https://api.github.com/users/KirkMunro/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/KirkMunro/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/KirkMunro/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/KirkMunro"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@KirkMunro  \r\n> need state information from the user's runspace \r\n\r\nConveniently available through the SessionStateProxy APIs on the runspace :-)\r\n\r\n> need state information from the user's runspace \r\n\r\nISE seemed to do OK. It managed, manipulated state and debugged multiple runspaces both local and remote.\r\n\r\nAnyway, this _might_ help (assuming it's still there). As you know, a runspace is all about state, specifically session state. There is one global session state object per runspace and then one each for  each module loaded. The module session state objects are linked to the global session state object so they all share the global namespace. The global session state object is linked to null. However, we designed things so that it's possible for a non-global session state object to be created that isn't linked to anything. We figured that there might be scenarios where you wanted an isolated session state even though we didn't know of any such scenarios. So you might be able to create an isolated \"tools\" environment using this mechanism (assuming it still exists and is public - I haven't looked.) But note - this is an empty session state - no commands, no variables, nothing. You'd have to manually populate it to have any commands available to you. ",
    "created_at": "2019-08-13T21:38:46Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/10334#issuecomment-521019422",
    "id": 521019422,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/10334",
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyMTAxOTQyMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/521019422/reactions"
    },
    "updated_at": "2019-08-13T21:38:46Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/521019422",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6876108?v=4",
      "events_url": "https://api.github.com/users/BrucePay/events{/privacy}",
      "followers_url": "https://api.github.com/users/BrucePay/followers",
      "following_url": "https://api.github.com/users/BrucePay/following{/other_user}",
      "gists_url": "https://api.github.com/users/BrucePay/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/BrucePay",
      "id": 6876108,
      "login": "BrucePay",
      "node_id": "MDQ6VXNlcjY4NzYxMDg=",
      "organizations_url": "https://api.github.com/users/BrucePay/orgs",
      "received_events_url": "https://api.github.com/users/BrucePay/received_events",
      "repos_url": "https://api.github.com/users/BrucePay/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/BrucePay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BrucePay/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/BrucePay"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Is that the right way to go for this though?\r\n\r\nCreating/managing a session state for this seems more complicated than what I was thinking.\r\n\r\nI was leaning more towards adding properties to `S.M.A.PSInvocationSettings`, such as `DebuggerHidden`, which would ensure the commands were hidden from the debugger, and `IgnorePreferenceVariables`, which would ignore `$PSDefaultParameterValues` and `$*Preference` variables. Then programmers using the SDK could pass their `PSInvocationSettings` instance into `S.M.A.PowerShell.Invoke`, and as long as the new settings were properly plumbed through the runtime, they wouldn't have to worry about user preferences impacting internal APIs.",
    "created_at": "2019-08-18T19:40:41Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/10334#issuecomment-522349331",
    "id": 522349331,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/10334",
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyMjM0OTMzMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/522349331/reactions"
    },
    "updated_at": "2019-08-20T13:33:52Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/522349331",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/3515485?v=4",
      "events_url": "https://api.github.com/users/KirkMunro/events{/privacy}",
      "followers_url": "https://api.github.com/users/KirkMunro/followers",
      "following_url": "https://api.github.com/users/KirkMunro/following{/other_user}",
      "gists_url": "https://api.github.com/users/KirkMunro/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/KirkMunro",
      "id": 3515485,
      "login": "KirkMunro",
      "node_id": "MDQ6VXNlcjM1MTU0ODU=",
      "organizations_url": "https://api.github.com/users/KirkMunro/orgs",
      "received_events_url": "https://api.github.com/users/KirkMunro/received_events",
      "repos_url": "https://api.github.com/users/KirkMunro/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/KirkMunro/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/KirkMunro/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/KirkMunro"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "> ISE seemed to do OK. It managed, manipulated state and debugged multiple runspaces both local and remote.\r\n\r\nISE isn't that advanced as far as IDEs go, and it is still susceptible to internal behavior that can be unintentionally manipulated by use of `$PSDefaultParameterValues`, breakpoints, and `$*Preference` variables. PowerShell itself suffers the same problem. It just doesn't show up that often, but regardless of the frequency, SDK users should be able to use the runtime in a way that internals are kept internal.",
    "created_at": "2019-08-18T19:47:48Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/10334#issuecomment-522349793",
    "id": 522349793,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/10334",
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyMjM0OTc5Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/522349793/reactions"
    },
    "updated_at": "2019-08-18T19:47:48Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/522349793",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/3515485?v=4",
      "events_url": "https://api.github.com/users/KirkMunro/events{/privacy}",
      "followers_url": "https://api.github.com/users/KirkMunro/followers",
      "following_url": "https://api.github.com/users/KirkMunro/following{/other_user}",
      "gists_url": "https://api.github.com/users/KirkMunro/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/KirkMunro",
      "id": 3515485,
      "login": "KirkMunro",
      "node_id": "MDQ6VXNlcjM1MTU0ODU=",
      "organizations_url": "https://api.github.com/users/KirkMunro/orgs",
      "received_events_url": "https://api.github.com/users/KirkMunro/received_events",
      "repos_url": "https://api.github.com/users/KirkMunro/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/KirkMunro/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/KirkMunro/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/KirkMunro"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "> > ISE seemed to do OK. It managed, manipulated state and debugged multiple runspaces both local and remote.\r\n> \r\n> ISE isn't that advanced as far as IDEs go\r\n\r\nYeah the ISE could get away with a bit more because it doesn't try to do a whole lot.  It also had the benefit of `InternalsVisibleTo`.  I can't look at the code to check obviously, but in the few places that it does go the extra mile, I'm guessing it leans on internals heavily.",
    "created_at": "2019-08-20T13:26:02Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/10334#issuecomment-523013743",
    "id": 523013743,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/10334",
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyMzAxMzc0Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/523013743/reactions"
    },
    "updated_at": "2019-08-20T13:26:02Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/523013743",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  }
]

[
  {
    "author_association": "COLLABORATOR",
    "body": "If refreshenv is a batch file it’s going to spawn a new cmd process and refresh the env vars in that process. This works for cmd as it runs it in process and thus updates the env vars for cmd. This is not the same for powershell or pwsh as it’s run in a separate process. You would need a powershell script that replicates refreshenv but in powershell itself.",
    "created_at": "2021-11-26T11:32:45Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16521#issuecomment-979907619",
    "id": 979907619,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16521",
    "node_id": "IC_kwDOAvT7bc46aDQj",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/979907619/reactions"
    },
    "updated_at": "2021-11-26T11:32:45Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/979907619",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8462645?v=4",
      "events_url": "https://api.github.com/users/jborean93/events{/privacy}",
      "followers_url": "https://api.github.com/users/jborean93/followers",
      "following_url": "https://api.github.com/users/jborean93/following{/other_user}",
      "gists_url": "https://api.github.com/users/jborean93/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jborean93",
      "id": 8462645,
      "login": "jborean93",
      "node_id": "MDQ6VXNlcjg0NjI2NDU=",
      "organizations_url": "https://api.github.com/users/jborean93/orgs",
      "received_events_url": "https://api.github.com/users/jborean93/received_events",
      "repos_url": "https://api.github.com/users/jborean93/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jborean93/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jborean93/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jborean93"
    }
  },
  {
    "author_association": "NONE",
    "body": "Thanks for the fast response @jborean93 \r\n\r\nLooking into it `refreshenv` is a script that is installed with [Choco](https://chocolatey.org/). Your explanation sounds fine for the `refreshenv` script, but if I quit Terminal / Powershell, shouldn't it then be loading up the new Env anyway?",
    "created_at": "2021-11-26T11:37:01Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16521#issuecomment-979911844",
    "id": 979911844,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16521",
    "node_id": "IC_kwDOAvT7bc46aESk",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/979911844/reactions"
    },
    "updated_at": "2021-11-26T11:37:14Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/979911844",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/694964?v=4",
      "events_url": "https://api.github.com/users/AaronLayton/events{/privacy}",
      "followers_url": "https://api.github.com/users/AaronLayton/followers",
      "following_url": "https://api.github.com/users/AaronLayton/following{/other_user}",
      "gists_url": "https://api.github.com/users/AaronLayton/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/AaronLayton",
      "id": 694964,
      "login": "AaronLayton",
      "node_id": "MDQ6VXNlcjY5NDk2NA==",
      "organizations_url": "https://api.github.com/users/AaronLayton/orgs",
      "received_events_url": "https://api.github.com/users/AaronLayton/received_events",
      "repos_url": "https://api.github.com/users/AaronLayton/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/AaronLayton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AaronLayton/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/AaronLayton"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "You could open GUI for editing of environment variables and check if they was updated.",
    "created_at": "2021-11-26T16:50:01Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16521#issuecomment-980132553",
    "id": 980132553,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16521",
    "node_id": "IC_kwDOAvT7bc46a6LJ",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/980132553/reactions"
    },
    "updated_at": "2021-11-26T16:50:01Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/980132553",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "NONE",
    "body": "@iSazonov yup I can open the Windows GUI and check they have definitely updated.\r\n\r\nI have been playing around with this and I am loading up Powershell through Windows Terminal and I don't think that program is closing fully. If I manually end the Windows Terminal tasks and then re-open then I get the updated env variables.\r\n\r\nI am going to link the Windows Terminal Issue I created and update this description here to ask \"Is there a way to refresh the env variables in the current session\" and if not can we add one?\r\n\r\nhttps://github.com/microsoft/terminal/issues/11829",
    "created_at": "2021-11-26T19:15:33Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16521#issuecomment-980323610",
    "id": 980323610,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16521",
    "node_id": "IC_kwDOAvT7bc46bo0a",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/980323610/reactions"
    },
    "updated_at": "2021-11-26T19:15:33Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/980323610",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/694964?v=4",
      "events_url": "https://api.github.com/users/AaronLayton/events{/privacy}",
      "followers_url": "https://api.github.com/users/AaronLayton/followers",
      "following_url": "https://api.github.com/users/AaronLayton/following{/other_user}",
      "gists_url": "https://api.github.com/users/AaronLayton/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/AaronLayton",
      "id": 694964,
      "login": "AaronLayton",
      "node_id": "MDQ6VXNlcjY5NDk2NA==",
      "organizations_url": "https://api.github.com/users/AaronLayton/orgs",
      "received_events_url": "https://api.github.com/users/AaronLayton/received_events",
      "repos_url": "https://api.github.com/users/AaronLayton/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/AaronLayton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AaronLayton/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/AaronLayton"
    }
  },
  {
    "author_association": "NONE",
    "body": "This issue has been marked as external and has not had any activity for **1 day**. It has been be closed for housekeeping purposes.",
    "created_at": "2021-11-28T19:00:37Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16521#issuecomment-981134501",
    "id": 981134501,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16521",
    "node_id": "IC_kwDOAvT7bc46euyl",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/981134501/reactions"
    },
    "updated_at": "2021-11-28T19:00:37Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/981134501",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "> \"Is there a way to refresh the env variables in the current session\" and if not can we add one?\r\n\r\nYes you can enumerate the registry keys that store the env vars and use `Set-Item \"env:\\$name\" $value` to set those updated env vars in the powershell process. Considering `refreshenv` isn't a builtin Windows thing I would doubt it would be something implemented by PowerShell itself but it can definitely be made by anyone and distributed through the PowerShell gallery.",
    "created_at": "2021-11-28T19:04:19Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16521#issuecomment-981135044",
    "id": 981135044,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16521",
    "node_id": "IC_kwDOAvT7bc46eu7E",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/981135044/reactions"
    },
    "updated_at": "2021-11-28T19:04:19Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/981135044",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8462645?v=4",
      "events_url": "https://api.github.com/users/jborean93/events{/privacy}",
      "followers_url": "https://api.github.com/users/jborean93/followers",
      "following_url": "https://api.github.com/users/jborean93/following{/other_user}",
      "gists_url": "https://api.github.com/users/jborean93/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jborean93",
      "id": 8462645,
      "login": "jborean93",
      "node_id": "MDQ6VXNlcjg0NjI2NDU=",
      "organizations_url": "https://api.github.com/users/jborean93/orgs",
      "received_events_url": "https://api.github.com/users/jborean93/received_events",
      "repos_url": "https://api.github.com/users/jborean93/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jborean93/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jborean93/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jborean93"
    }
  }
]

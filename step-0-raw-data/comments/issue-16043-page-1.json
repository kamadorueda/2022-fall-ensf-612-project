[
  {
    "author_association": "NONE",
    "body": "[WindowsUpdate.log](https://github.com/PowerShell/PowerShell/files/7101452/WindowsUpdate.log)\r\n",
    "created_at": "2021-09-02T20:00:27Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16043#issuecomment-912011698",
    "id": 912011698,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16043",
    "node_id": "IC_kwDOAvT7bc42XDGy",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/912011698/reactions"
    },
    "updated_at": "2021-09-02T20:00:27Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/912011698",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/72052?v=4",
      "events_url": "https://api.github.com/users/halfninja/events{/privacy}",
      "followers_url": "https://api.github.com/users/halfninja/followers",
      "following_url": "https://api.github.com/users/halfninja/following{/other_user}",
      "gists_url": "https://api.github.com/users/halfninja/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/halfninja",
      "id": 72052,
      "login": "halfninja",
      "node_id": "MDQ6VXNlcjcyMDUy",
      "organizations_url": "https://api.github.com/users/halfninja/orgs",
      "received_events_url": "https://api.github.com/users/halfninja/received_events",
      "repos_url": "https://api.github.com/users/halfninja/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/halfninja/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/halfninja/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/halfninja"
    }
  },
  {
    "author_association": "NONE",
    "body": "Update... the install also fails with winget\r\n\r\n```powershell\r\nPS C:\\WINDOWS\\system32> winget install microsoft.powershell.preview\r\nFound PowerShell Preview [Microsoft.PowerShell.Preview]\r\nThis application is licensed to you by its owner.\r\nMicrosoft is not responsible for, nor does it grant any licences to, third-party packages.\r\nDownloading https://github.com/PowerShell/PowerShell/releases/download/v7.2.0-preview.9/PowerShell-7.2.0-preview.9-win-x64.msi\r\n██████████████████████████████  97.9 MB / 97.9 MB\r\nSuccessfully verified installer hash  \r\nStarting package install...\r\nInstaller failed with exit code: 1618\r\nInstaller log is available at: C:\\Users\\Nick\\AppData\\Local\\Packages\\Microsoft.DesktopAppInstaller_8wekyb3d8bbwe\\LocalState\\DiagOutputDir\\WinGet-Microsoft.PowerShell.Preview.7.2.0.9-2021-09-04-20-30-56.296.log\r\n```\r\n\r\nThe above log file is empty.",
    "created_at": "2021-09-04T19:36:36Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16043#issuecomment-913028638",
    "id": 913028638,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16043",
    "node_id": "IC_kwDOAvT7bc42a7Ye",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/913028638/reactions"
    },
    "updated_at": "2021-09-04T19:36:36Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/913028638",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/72052?v=4",
      "events_url": "https://api.github.com/users/halfninja/events{/privacy}",
      "followers_url": "https://api.github.com/users/halfninja/followers",
      "following_url": "https://api.github.com/users/halfninja/following{/other_user}",
      "gists_url": "https://api.github.com/users/halfninja/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/halfninja",
      "id": 72052,
      "login": "halfninja",
      "node_id": "MDQ6VXNlcjcyMDUy",
      "organizations_url": "https://api.github.com/users/halfninja/orgs",
      "received_events_url": "https://api.github.com/users/halfninja/received_events",
      "repos_url": "https://api.github.com/users/halfninja/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/halfninja/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/halfninja/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/halfninja"
    }
  },
  {
    "author_association": "NONE",
    "body": "The above might be related to running as admin. Running as user fails slightly differently. Running the .msi by hand complains that it can't find the preview.1 msi to uninstall old versions. Possibly this is what Windows Update didn't like in the background? In any case, I downloaded a copy of that to give it and it's now been upgraded manually.",
    "created_at": "2021-09-04T19:48:40Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16043#issuecomment-913030480",
    "id": 913030480,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16043",
    "node_id": "IC_kwDOAvT7bc42a71Q",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/913030480/reactions"
    },
    "updated_at": "2021-09-04T19:48:40Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/913030480",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/72052?v=4",
      "events_url": "https://api.github.com/users/halfninja/events{/privacy}",
      "followers_url": "https://api.github.com/users/halfninja/followers",
      "following_url": "https://api.github.com/users/halfninja/following{/other_user}",
      "gists_url": "https://api.github.com/users/halfninja/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/halfninja",
      "id": 72052,
      "login": "halfninja",
      "node_id": "MDQ6VXNlcjcyMDUy",
      "organizations_url": "https://api.github.com/users/halfninja/orgs",
      "received_events_url": "https://api.github.com/users/halfninja/received_events",
      "repos_url": "https://api.github.com/users/halfninja/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/halfninja/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/halfninja/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/halfninja"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "1618 is another installation is in progress.\r\n\r\nThe relevant section from windowsupdate.log is \r\n```\r\n2021-09-02 20:56:37.3260259 26408 27196 DownloadManager *FAILED* [80070050] ExtractUpdateFiles\r\n2021-09-02 20:56:37.3260385 26408 27196 DownloadManager *FAILED* [80070050] Method failed [CAgentDownloadManager::OpenUpdateInstallDirectory:18169]\r\n2021-09-02 20:56:37.3261144 26408 27196 WIL             *FAILED* [80070050] file = onecore\\enduser\\windowsupdate\\client\\engine\\agent\\wuupdatedeploymentdataimpl.cpp, line = 156\r\n2021-09-02 20:56:37.3261173 26408 27196 WIL             *FAILED* [80070050] file = onecore\\enduser\\windowsupdate\\client\\engine\\agent\\clientcallrecorder.cpp, line = 8482\r\n2021-09-02 20:56:37.3262013 3304  12640 ComApi          *FAILED* [80070050] ISusInternal:: OpenUpdateDeploymentDirectory\r\n2021-09-02 20:56:37.3263218 3304  12640 WIL             *FAILED* [80070050] file = onecore\\enduser\\windowsupdate\\client\\comapi\\deploymentjobhost.cpp, line = 889\r\n2021-09-02 20:56:37.3263351 3304  12640 WIL             *FAILED* [80070050] file = onecore\\enduser\\windowsupdate\\client\\engine\\updatedeploymentprovider\\lib\\updatedeploymentjob.cpp, line = 1820\r\n2021-09-02 20:56:37.3263441 3304  12640 UDP             Deployment job Id 8935463F-3D2E-449B-BC4E-74352D09562D : Update DC4ECB0B-1B16-4559-93A0-47B3480DD1B1.200 failure delegate invoked.\r\n2021-09-02 20:56:37.3263635 3304  12640 UDP             *FAILED* [80070050] Deployment job Id 8935463F-3D2E-449B-BC4E-74352D09562D : Installing for Top level update id DC4ECB0B-1B16-4559-93A0-47B3480DD1B1.200, bundled update id 23D41CF9-2450-44C0-97FA-4A7679CE0055.200 [CUpdateDeploymentJob::DeploySingleUpdateInternal:2817]\r\n2021-09-02 20:56:37.3263656 3304  12640 WIL             *FAILED* [80070050] file = onecore\\enduser\\windowsupdate\\client\\engine\\updatedeploymentprovider\\lib\\updatedeploymentjob.cpp, line = 2819\r\n```\r\n`0x80070050` = `ERROR_FILE_EXISTS`. This would be an error in WUA.  It's not giving a lot of details on what the problem is.   I could give you a brute force method to resolve this.  \r\n1. Stop `wuauserv`\r\n2. rename `C:\\windows\\softwaredistribution`\r\n3. restart `wuauserv`\r\n\r\nThis should clear the files out of the download sandbox, but you would need to open a windows support case to get more details.\r\n\r\nWith regards to needing the MSI, this file is normally kept in the MSI cache.  The only time I know that you would need to provide it is if you clean the cache using something like the disk cleanup tool or disk corruption.\r\n",
    "created_at": "2021-09-10T22:06:57Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16043#issuecomment-917241635",
    "id": 917241635,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16043",
    "node_id": "IC_kwDOAvT7bc42q_8j",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/917241635/reactions"
    },
    "updated_at": "2021-09-10T22:06:57Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/917241635",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/10873629?v=4",
      "events_url": "https://api.github.com/users/TravisEz13/events{/privacy}",
      "followers_url": "https://api.github.com/users/TravisEz13/followers",
      "following_url": "https://api.github.com/users/TravisEz13/following{/other_user}",
      "gists_url": "https://api.github.com/users/TravisEz13/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/TravisEz13",
      "id": 10873629,
      "login": "TravisEz13",
      "node_id": "MDQ6VXNlcjEwODczNjI5",
      "organizations_url": "https://api.github.com/users/TravisEz13/orgs",
      "received_events_url": "https://api.github.com/users/TravisEz13/received_events",
      "repos_url": "https://api.github.com/users/TravisEz13/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/TravisEz13/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TravisEz13/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/TravisEz13"
    }
  },
  {
    "author_association": "NONE",
    "body": "This issue has been marked as answered and has not had any activity for **1 day**. It has been closed for housekeeping purposes.",
    "created_at": "2021-09-12T00:00:39Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/16043#issuecomment-917506020",
    "id": 917506020,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/16043",
    "node_id": "IC_kwDOAvT7bc42sAfk",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/917506020/reactions"
    },
    "updated_at": "2021-09-12T00:00:39Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/917506020",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  }
]

[
  {
    "author_association": "CONTRIBUTOR",
    "body": "At least at first glance the current behavior makes more sense, given that `[System.Data.DataTable]` does not implement the `[System.Collections.IEnumerable]` interface and PowerShell therefore doesn't consider it a collection.\r\n\r\nThat the behavior changed is definitely disconcerting, however, and I hope someone else can shed light on this.\r\n\r\nUsing `WriteObject(dt.Rows, enumerateCollection: true)` instead fixes the problem (because the  type of `.Rows` is `[System.Data.DataRowCollection]`, which _does_ implement `[IEnumerable]`) ",
    "created_at": "2018-03-21T20:40:02Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6453#issuecomment-375088003",
    "id": 375088003,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6453",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NTA4ODAwMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/375088003/reactions"
    },
    "updated_at": "2018-03-21T20:41:39Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/375088003",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "The issue is here in the code:\r\nhttps://github.com/PowerShell/PowerShell/blob/41b316183015ccc2e7b301a3969ea7228684b4ab/src/System.Management.Automation/engine/LanguagePrimitives.cs#L479\r\nEnumerating DataTables is explicitly disabled .\r\n```\r\n#if !CORECLR\r\n            if (typeof(DataTable).IsAssignableFrom(objectType))\r\n            {\r\n                return LanguagePrimitives.DataTableEnumerable;\r\n            }\r\n#endif\r\n```\r\nI don't know why this was done or if there is any reason not to turn it back on (other than it's a breaking change from 6.0). I've marked it for review by the committee.\r\n",
    "created_at": "2018-03-21T21:05:45Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6453#issuecomment-375095427",
    "id": 375095427,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6453",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NTA5NTQyNw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/375095427/reactions"
    },
    "updated_at": "2018-03-21T21:06:58Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/375095427",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6876108?v=4",
      "events_url": "https://api.github.com/users/BrucePay/events{/privacy}",
      "followers_url": "https://api.github.com/users/BrucePay/followers",
      "following_url": "https://api.github.com/users/BrucePay/following{/other_user}",
      "gists_url": "https://api.github.com/users/BrucePay/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/BrucePay",
      "id": 6876108,
      "login": "BrucePay",
      "node_id": "MDQ6VXNlcjY4NzYxMDg=",
      "organizations_url": "https://api.github.com/users/BrucePay/orgs",
      "received_events_url": "https://api.github.com/users/BrucePay/received_events",
      "repos_url": "https://api.github.com/users/BrucePay/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/BrucePay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BrucePay/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/BrucePay"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "I think the code was if/def'ed out originally when `DataTable` is not available in .NET Core.",
    "created_at": "2018-03-21T21:53:09Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6453#issuecomment-375108401",
    "id": 375108401,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6453",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NTEwODQwMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/375108401/reactions"
    },
    "updated_at": "2018-03-21T21:53:09Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/375108401",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@PowerShell/powershell-committee reviewed this and it makes sense to have it consistent in that datarows are enumerated",
    "created_at": "2018-03-28T22:11:24Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6453#issuecomment-377054827",
    "id": 377054827,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6453",
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NzA1NDgyNw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/377054827/reactions"
    },
    "updated_at": "2018-03-28T22:11:24Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/377054827",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "NONE",
    "body": "FWIW, there is a typo in @abhisheksinha89's repro:\r\n\r\n```csharp\r\n    // ...\r\n    DataRow dr2 = dt.NewRow(); dr2[\"Name\"] = \"Susan\"; dr2[\"Age\"] = \"25\";   // dr2, instead of dr!\r\n    // ...\r\n```\r\nwhich would make it look like this was not fixed :-)",
    "created_at": "2022-10-31T06:59:38Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/6453#issuecomment-1296644429",
    "id": 1296644429,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/6453",
    "node_id": "IC_kwDOAvT7bc5NSTlN",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1296644429/reactions"
    },
    "updated_at": "2022-10-31T07:00:30Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1296644429",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/19174408?v=4",
      "events_url": "https://api.github.com/users/Matteo-T/events{/privacy}",
      "followers_url": "https://api.github.com/users/Matteo-T/followers",
      "following_url": "https://api.github.com/users/Matteo-T/following{/other_user}",
      "gists_url": "https://api.github.com/users/Matteo-T/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/Matteo-T",
      "id": 19174408,
      "login": "Matteo-T",
      "node_id": "MDQ6VXNlcjE5MTc0NDA4",
      "organizations_url": "https://api.github.com/users/Matteo-T/orgs",
      "received_events_url": "https://api.github.com/users/Matteo-T/received_events",
      "repos_url": "https://api.github.com/users/Matteo-T/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/Matteo-T/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Matteo-T/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/Matteo-T"
    }
  }
]

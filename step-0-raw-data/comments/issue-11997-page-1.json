[
  {
    "author_association": "COLLABORATOR",
    "body": "/cc @anmenaga for information.",
    "created_at": "2020-03-04T17:14:14Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11997#issuecomment-594672519",
    "id": 594672519,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11997",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5NDY3MjUxOQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/594672519/reactions"
    },
    "updated_at": "2020-03-04T17:14:14Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/594672519",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "This is a hosted scenario with impersonation. Even without WinCompat in the picture I can see problems with normal module operations under impersonation.",
    "created_at": "2020-03-04T18:44:51Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11997#issuecomment-594742731",
    "id": 594742731,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11997",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5NDc0MjczMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/594742731/reactions"
    },
    "updated_at": "2020-03-04T18:44:51Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/594742731",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11860095?v=4",
      "events_url": "https://api.github.com/users/anmenaga/events{/privacy}",
      "followers_url": "https://api.github.com/users/anmenaga/followers",
      "following_url": "https://api.github.com/users/anmenaga/following{/other_user}",
      "gists_url": "https://api.github.com/users/anmenaga/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/anmenaga",
      "id": 11860095,
      "login": "anmenaga",
      "node_id": "MDQ6VXNlcjExODYwMDk1",
      "organizations_url": "https://api.github.com/users/anmenaga/orgs",
      "received_events_url": "https://api.github.com/users/anmenaga/received_events",
      "repos_url": "https://api.github.com/users/anmenaga/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/anmenaga/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/anmenaga/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/anmenaga"
    }
  },
  {
    "author_association": "NONE",
    "body": "@anmenaga If I understand you correctly, you discourage this approach? We're using it with PowerShell 5.1 in production and there it works as it should.\r\n\r\nI've investigated the use of an out of process runspace, but we're exchanging several variables (nested hashtables) between our C# code and powershell session using the session state proxy, and when running out of process, we need to manually unwrap them from their PSObject wrappers.",
    "created_at": "2020-03-05T07:19:19Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11997#issuecomment-595066984",
    "id": 595066984,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11997",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5NTA2Njk4NA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/595066984/reactions"
    },
    "updated_at": "2020-03-05T07:19:19Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/595066984",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/3049216?v=4",
      "events_url": "https://api.github.com/users/leonardder/events{/privacy}",
      "followers_url": "https://api.github.com/users/leonardder/followers",
      "following_url": "https://api.github.com/users/leonardder/following{/other_user}",
      "gists_url": "https://api.github.com/users/leonardder/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/leonardder",
      "id": 3049216,
      "login": "leonardder",
      "node_id": "MDQ6VXNlcjMwNDkyMTY=",
      "organizations_url": "https://api.github.com/users/leonardder/orgs",
      "received_events_url": "https://api.github.com/users/leonardder/received_events",
      "repos_url": "https://api.github.com/users/leonardder/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/leonardder/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/leonardder/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/leonardder"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "`a hosted scenario with impersonation` is a relatively rare scenario; and rare scenarios tend to have more bugs that are fixed slower than those on heavily used code paths. To get things working in your situation it might be useful to think about alternative ways to achieve the desired result.\r\n> I've investigated the use of an out of process runspace\r\n> ...\r\n> and when running out of process, we need to manually unwrap them from their PSObject wrappers\r\n\r\nCan you please tell more about this? I didn't quite get the problem with unwraping...",
    "created_at": "2020-03-05T22:41:09Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11997#issuecomment-595483499",
    "id": 595483499,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11997",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5NTQ4MzQ5OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/595483499/reactions"
    },
    "updated_at": "2020-03-05T22:41:09Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/595483499",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11860095?v=4",
      "events_url": "https://api.github.com/users/anmenaga/events{/privacy}",
      "followers_url": "https://api.github.com/users/anmenaga/followers",
      "following_url": "https://api.github.com/users/anmenaga/following{/other_user}",
      "gists_url": "https://api.github.com/users/anmenaga/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/anmenaga",
      "id": 11860095,
      "login": "anmenaga",
      "node_id": "MDQ6VXNlcjExODYwMDk1",
      "organizations_url": "https://api.github.com/users/anmenaga/orgs",
      "received_events_url": "https://api.github.com/users/anmenaga/received_events",
      "repos_url": "https://api.github.com/users/anmenaga/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/anmenaga/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/anmenaga/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/anmenaga"
    }
  },
  {
    "author_association": "NONE",
    "body": "> Can you please tell more about this? I didn't quite get the problem with unwraping...\r\n\r\nHere is an example code snippet, not checked, but you'll get the point:\r\n\r\n```\r\nHastable myTable = new Hashtable{ Data = new Hashtable()};\r\nrunspace.SessionStateProxy.SetVariable(\"myTable\", myTable);\r\n```\r\n\r\nIn powershell\r\n\r\n```\r\n$myTable.Data.Test = 42\r\n```\r\n\r\nIn c# again:\r\n\r\n```\r\nHashtable newTable = runspace.SessionStateProxy.GetVariable(\"myTable\") as Hashtable;\r\nvar test1 = myTable[\"Data\"][\"Test\"];\r\nvar test2 = newTable[\"Data\"][\"Test\"];\r\n```\r\n\r\nBoth test1 and test2 should contain 42 as I\"m correct, as the inner hash-table was passed by reference.\r\n\r\nNow, if I run out of process, I need to recursively check my hashtable for PSObject instances when getting myTable from the session state proxy.",
    "created_at": "2020-03-06T07:23:12Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11997#issuecomment-595636198",
    "id": 595636198,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11997",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5NTYzNjE5OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/595636198/reactions"
    },
    "updated_at": "2020-03-06T07:23:12Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/595636198",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/3049216?v=4",
      "events_url": "https://api.github.com/users/leonardder/events{/privacy}",
      "followers_url": "https://api.github.com/users/leonardder/followers",
      "following_url": "https://api.github.com/users/leonardder/following{/other_user}",
      "gists_url": "https://api.github.com/users/leonardder/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/leonardder",
      "id": 3049216,
      "login": "leonardder",
      "node_id": "MDQ6VXNlcjMwNDkyMTY=",
      "organizations_url": "https://api.github.com/users/leonardder/orgs",
      "received_events_url": "https://api.github.com/users/leonardder/received_events",
      "repos_url": "https://api.github.com/users/leonardder/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/leonardder/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/leonardder/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/leonardder"
    }
  },
  {
    "author_association": "NONE",
    "body": "In the end, we decided to go out of process. This is still an issue in PowerShell 7.0.1 though.",
    "created_at": "2020-05-18T06:25:16Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11997#issuecomment-629972246",
    "id": 629972246,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11997",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyOTk3MjI0Ng==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/629972246/reactions"
    },
    "updated_at": "2020-05-18T06:25:16Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/629972246",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/3049216?v=4",
      "events_url": "https://api.github.com/users/leonardder/events{/privacy}",
      "followers_url": "https://api.github.com/users/leonardder/followers",
      "following_url": "https://api.github.com/users/leonardder/following{/other_user}",
      "gists_url": "https://api.github.com/users/leonardder/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/leonardder",
      "id": 3049216,
      "login": "leonardder",
      "node_id": "MDQ6VXNlcjMwNDkyMTY=",
      "organizations_url": "https://api.github.com/users/leonardder/orgs",
      "received_events_url": "https://api.github.com/users/leonardder/received_events",
      "repos_url": "https://api.github.com/users/leonardder/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/leonardder/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/leonardder/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/leonardder"
    }
  },
  {
    "author_association": "NONE",
    "body": "This issue is stale and as the process is discouraged, closing this.",
    "created_at": "2022-07-14T13:25:42Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11997#issuecomment-1184447065",
    "id": 1184447065,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11997",
    "node_id": "IC_kwDOAvT7bc5GmTpZ",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1184447065/reactions"
    },
    "updated_at": "2022-07-14T13:25:42Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1184447065",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/3049216?v=4",
      "events_url": "https://api.github.com/users/leonardder/events{/privacy}",
      "followers_url": "https://api.github.com/users/leonardder/followers",
      "following_url": "https://api.github.com/users/leonardder/following{/other_user}",
      "gists_url": "https://api.github.com/users/leonardder/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/leonardder",
      "id": 3049216,
      "login": "leonardder",
      "node_id": "MDQ6VXNlcjMwNDkyMTY=",
      "organizations_url": "https://api.github.com/users/leonardder/orgs",
      "received_events_url": "https://api.github.com/users/leonardder/received_events",
      "repos_url": "https://api.github.com/users/leonardder/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/leonardder/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/leonardder/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/leonardder"
    }
  }
]

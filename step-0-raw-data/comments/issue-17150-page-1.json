[
  {
    "author_association": "NONE",
    "body": "I believe this is a repeat of this issue: https://github.com/PowerShell/PowerShell/issues/16461 ",
    "created_at": "2022-04-13T19:18:00Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17150#issuecomment-1098397053",
    "id": 1098397053,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17150",
    "node_id": "IC_kwDOAvT7bc5BeDV9",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1098397053/reactions"
    },
    "updated_at": "2022-04-13T19:18:00Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1098397053",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/842644?v=4",
      "events_url": "https://api.github.com/users/andyrobbins/events{/privacy}",
      "followers_url": "https://api.github.com/users/andyrobbins/followers",
      "following_url": "https://api.github.com/users/andyrobbins/following{/other_user}",
      "gists_url": "https://api.github.com/users/andyrobbins/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/andyrobbins",
      "id": 842644,
      "login": "andyrobbins",
      "node_id": "MDQ6VXNlcjg0MjY0NA==",
      "organizations_url": "https://api.github.com/users/andyrobbins/orgs",
      "received_events_url": "https://api.github.com/users/andyrobbins/received_events",
      "repos_url": "https://api.github.com/users/andyrobbins/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/andyrobbins/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/andyrobbins/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/andyrobbins"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Yeah this should throw since you're attempting to bring over a `ScriptBlock` as is.\r\n\r\nThe code that does this check currently may need to be updated to unwrap `PSObject`s. /cc @PaulHigin ",
    "created_at": "2022-04-13T19:30:17Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17150#issuecomment-1098406436",
    "id": 1098406436,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17150",
    "node_id": "IC_kwDOAvT7bc5BeFok",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1098406436/reactions"
    },
    "updated_at": "2022-04-13T19:30:17Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1098406436",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  },
  {
    "author_association": "NONE",
    "body": "Thank you @SeeminglyScience.\r\n\r\nI found that the workaround posted [here](https://github.com/PowerShell/PowerShell/issues/16461#issuecomment-967759037) by @daxian-dbw appears to fix the issue:\r\n\r\n<img width=\"1407\" alt=\"Screen Shot 2022-04-13 at 12 58 46 PM\" src=\"https://user-images.githubusercontent.com/842644/163260324-22a0c515-693b-4933-96ba-c7bd89304f2b.png\">\r\n\r\nI collapsed the example multi-line script shared by @daxian-dbw into one line only to be able to fit more examples into the same screen space.",
    "created_at": "2022-04-13T20:00:26Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17150#issuecomment-1098432003",
    "id": 1098432003,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17150",
    "node_id": "IC_kwDOAvT7bc5BeL4D",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1098432003/reactions"
    },
    "updated_at": "2022-04-13T20:00:26Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1098432003",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/842644?v=4",
      "events_url": "https://api.github.com/users/andyrobbins/events{/privacy}",
      "followers_url": "https://api.github.com/users/andyrobbins/followers",
      "following_url": "https://api.github.com/users/andyrobbins/following{/other_user}",
      "gists_url": "https://api.github.com/users/andyrobbins/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/andyrobbins",
      "id": 842644,
      "login": "andyrobbins",
      "node_id": "MDQ6VXNlcjg0MjY0NA==",
      "organizations_url": "https://api.github.com/users/andyrobbins/orgs",
      "received_events_url": "https://api.github.com/users/andyrobbins/received_events",
      "repos_url": "https://api.github.com/users/andyrobbins/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/andyrobbins/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/andyrobbins/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/andyrobbins"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "This illustrates the dangers of simply copying state (such as variables) from one runspace to another.  Some objects are not safe because they have runspace affinity or are just not thread safe dotNet types.  I recommend using PowerShell modules instead of functions and ensuring those modules are imported (either by explicitly importing or having them in the $env:PSModulePath paths).\r\n\r\nThis work item (#12240) is to add an option to copy state for `ForEach-Object -Parallel`.  But it is difficult to know what state is safe to copy.  Plus it degrades performance if much of the current state is not needed, and performance is usually a high priority when `ForEach-Object -Parallel` is used.",
    "created_at": "2022-04-13T20:18:27Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17150#issuecomment-1098447801",
    "id": 1098447801,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17150",
    "node_id": "IC_kwDOAvT7bc5BePu5",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 3,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 3,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1098447801/reactions"
    },
    "updated_at": "2022-04-13T20:18:27Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1098447801",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/14019529?v=4",
      "events_url": "https://api.github.com/users/PaulHigin/events{/privacy}",
      "followers_url": "https://api.github.com/users/PaulHigin/followers",
      "following_url": "https://api.github.com/users/PaulHigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulHigin/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/PaulHigin",
      "id": 14019529,
      "login": "PaulHigin",
      "node_id": "MDQ6VXNlcjE0MDE5NTI5",
      "organizations_url": "https://api.github.com/users/PaulHigin/orgs",
      "received_events_url": "https://api.github.com/users/PaulHigin/received_events",
      "repos_url": "https://api.github.com/users/PaulHigin/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/PaulHigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulHigin/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/PaulHigin"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Just to clarify, there is something potentially actionable here since it's evading the scriptblock check. This if:\r\n\r\nhttps://github.com/PowerShell/PowerShell/blob/7cc9c874730e87b06dbe54d50e77c1c472996c54/src/System.Management.Automation/engine/InternalCommands.cs#L422-L431\r\n\r\nMight need to be:\r\n\r\n```csharp\r\nif (item is ScriptBlock or PSObject { BaseObject: ScriptBlock })\r\n{\r\n    // etc\r\n}\r\n```",
    "created_at": "2022-04-14T02:03:53Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17150#issuecomment-1098636907",
    "id": 1098636907,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17150",
    "node_id": "IC_kwDOAvT7bc5Be95r",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1098636907/reactions"
    },
    "updated_at": "2022-04-14T02:03:53Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1098636907",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "@SeeminglyScience  Yes, but the point of this Issue is that the author expects ForEach-Object -Parallel to duplicate the original session into all parallel sessions, and this just isn't possible.  Adding a check for PSObject scriptblocks needs to be created in a separate issue.",
    "created_at": "2022-04-14T16:06:13Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17150#issuecomment-1099345797",
    "id": 1099345797,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17150",
    "node_id": "IC_kwDOAvT7bc5Bhq-F",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1099345797/reactions"
    },
    "updated_at": "2022-04-14T16:06:13Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1099345797",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/14019529?v=4",
      "events_url": "https://api.github.com/users/PaulHigin/events{/privacy}",
      "followers_url": "https://api.github.com/users/PaulHigin/followers",
      "following_url": "https://api.github.com/users/PaulHigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulHigin/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/PaulHigin",
      "id": 14019529,
      "login": "PaulHigin",
      "node_id": "MDQ6VXNlcjE0MDE5NTI5",
      "organizations_url": "https://api.github.com/users/PaulHigin/orgs",
      "received_events_url": "https://api.github.com/users/PaulHigin/received_events",
      "repos_url": "https://api.github.com/users/PaulHigin/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/PaulHigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulHigin/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/PaulHigin"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Ah good point Paul, I've opened #17152 to track. Thanks!",
    "created_at": "2022-04-14T17:04:44Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17150#issuecomment-1099415622",
    "id": 1099415622,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17150",
    "node_id": "IC_kwDOAvT7bc5Bh8BG",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1099415622/reactions"
    },
    "updated_at": "2022-04-14T17:04:44Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1099415622",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/24977523?v=4",
      "events_url": "https://api.github.com/users/SeeminglyScience/events{/privacy}",
      "followers_url": "https://api.github.com/users/SeeminglyScience/followers",
      "following_url": "https://api.github.com/users/SeeminglyScience/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeeminglyScience/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SeeminglyScience",
      "id": 24977523,
      "login": "SeeminglyScience",
      "node_id": "MDQ6VXNlcjI0OTc3NTIz",
      "organizations_url": "https://api.github.com/users/SeeminglyScience/orgs",
      "received_events_url": "https://api.github.com/users/SeeminglyScience/received_events",
      "repos_url": "https://api.github.com/users/SeeminglyScience/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SeeminglyScience/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeeminglyScience/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SeeminglyScience"
    }
  },
  {
    "author_association": "NONE",
    "body": "This issue has been marked as duplicate and has not had any activity for **1 day**. It has been closed for housekeeping purposes.",
    "created_at": "2022-04-15T20:00:40Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17150#issuecomment-1100348975",
    "id": 1100348975,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17150",
    "node_id": "IC_kwDOAvT7bc5Blf4v",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1100348975/reactions"
    },
    "updated_at": "2022-04-15T20:00:40Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1100348975",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  }
]

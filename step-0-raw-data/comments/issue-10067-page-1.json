[
  {
    "author_association": "COLLABORATOR",
    "body": "I looked at history of the source code and I don't see any changes. I guess root of the issue in another place. New-Service disposes the object before write to pipeline. Perhaps GC was updated in Preview6.",
    "created_at": "2019-07-06T19:25:03Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/10067#issuecomment-508948459",
    "id": 508948459,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/10067",
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwODk0ODQ1OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/508948459/reactions"
    },
    "updated_at": "2019-07-06T19:25:03Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/508948459",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "For the first failure, it's caused by [this line](https://github.com/dotnet/corefx/blame/master/src/System.ServiceProcess.ServiceController/src/System/ServiceProcess/ServiceController.cs#L482), which was added by https://github.com/dotnet/corefx/pull/32072 in .NET Core 3.0.\r\nSimply put it, before .NET Core 3, `ServiceController.ServiceName` returns a string even if the object has been disposed. In .NET Core 3, the call to `GetDataBaseHandleWithConnectAccess` causes it to throw `ObjectDisposedException` when the object has been disposed.\r\nThis looks like a change by design, and we just need to update our test.\r\n\r\nFor the second failure, it's more problematic. The new NuGet package [System.Diagnostics.EventLog](https://www.nuget.org/packages/System.Diagnostics.EventLog/4.6.0-preview7.19362.9) includes a few more namespaces than the `4.5.0` version, including `System.Diagnostics.Eventing.Reader`, which has `EventLogRecord` type. However, our `Microsoft.PowerShell.CoreCLR.Eventing.dll`, which contains the ported .NET code for `EventProvider` also contains that type. So there is a conflict now.",
    "created_at": "2019-08-02T00:12:05Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/10067#issuecomment-517500613",
    "id": 517500613,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/10067",
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxNzUwMDYxMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/517500613/reactions"
    },
    "updated_at": "2019-08-05T17:05:17Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/517500613",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "> This looks like a change by design, and we just need to update our test.\r\n\r\nWhy do we dispose only in one cmdlet (New-Service)?\r\nhttps://github.com/PowerShell/PowerShell/blob/17fb524adb85566aa5cb6041db279905c2700e6d/src/Microsoft.PowerShell.Commands.Management/commands/management/Service.cs#L2276-L2281",
    "created_at": "2019-08-02T03:18:15Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/10067#issuecomment-517532122",
    "id": 517532122,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/10067",
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxNzUzMjEyMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/517532122/reactions"
    },
    "updated_at": "2019-08-02T03:18:51Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/517532122",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "> our Microsoft.PowerShell.CoreCLR.Eventing.dll, which contains the ported .NET code for EventProvider also contains that type. So there is a conflict now.\r\n\r\nFor reference https://github.com/Microsoft/referencesource/blob/master/System.Core/System/Diagnostics/Eventing/Reader/EventLogRecord.cs - at first look it is the same code as in PowerShell repo.\r\n\n\n<blockquote><img src=\"https://avatars2.githubusercontent.com/u/6154722?s=400&v=4\" width=\"48\" align=\"right\"><div><img src=\"https://github.githubassets.com/favicon.ico\" height=\"14\"> GitHub</div><div><strong><a href=\"https://github.com/microsoft/referencesource\">microsoft/referencesource</a></strong></div><div>Source from the Microsoft .NET Reference Source that represent a subset of the .NET Framework - microsoft/referencesource</div></blockquote>",
    "created_at": "2019-08-02T03:42:41Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/10067#issuecomment-517536162",
    "id": 517536162,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/10067",
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxNzUzNjE2Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/517536162/reactions"
    },
    "updated_at": "2019-08-02T03:42:42Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/517536162",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "> Why do we dispose only in one cmdlet (New-Service)?\r\n\r\nGood question. No idea why doing that. Seems wrong to me.",
    "created_at": "2019-08-05T17:20:56Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/10067#issuecomment-518322450",
    "id": 518322450,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/10067",
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxODMyMjQ1MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/518322450/reactions"
    },
    "updated_at": "2019-08-05T17:20:56Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/518322450",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "> Good question. No idea why doing that. Seems wrong to me.\r\n\r\nWrong that we dispose in New-Service?",
    "created_at": "2019-08-08T12:46:44Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/10067#issuecomment-519503121",
    "id": 519503121,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/10067",
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxOTUwMzEyMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/519503121/reactions"
    },
    "updated_at": "2019-08-08T12:46:44Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/519503121",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "Yes, it seems wrong to me that we dispose the `ServiceController` object in `New-Service`. I'm not sure if that's on purpose though ... See this is why we need good comment in code :)",
    "created_at": "2019-08-08T17:00:46Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/10067#issuecomment-519603759",
    "id": 519603759,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/10067",
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxOTYwMzc1OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 1,
      "hooray": 0,
      "laugh": 0,
      "rocket": 1,
      "total_count": 4,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/519603759/reactions"
    },
    "updated_at": "2019-08-08T17:01:05Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/519603759",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/127450?v=4",
      "events_url": "https://api.github.com/users/daxian-dbw/events{/privacy}",
      "followers_url": "https://api.github.com/users/daxian-dbw/followers",
      "following_url": "https://api.github.com/users/daxian-dbw/following{/other_user}",
      "gists_url": "https://api.github.com/users/daxian-dbw/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/daxian-dbw",
      "id": 127450,
      "login": "daxian-dbw",
      "node_id": "MDQ6VXNlcjEyNzQ1MA==",
      "organizations_url": "https://api.github.com/users/daxian-dbw/orgs",
      "received_events_url": "https://api.github.com/users/daxian-dbw/received_events",
      "repos_url": "https://api.github.com/users/daxian-dbw/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/daxian-dbw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daxian-dbw/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/daxian-dbw"
    }
  },
  {
    "author_association": "NONE",
    "body": ":tada:This issue was addressed in #10305, which has now been successfully released as `v7.0.0-preview.3`.:tada:\n\nHandy links:\n* [Release Notes](https://github.com/PowerShell/PowerShell/releases/tag/v7.0.0-preview.3)\n",
    "created_at": "2019-08-20T22:36:22Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/10067#issuecomment-523221701",
    "id": 523221701,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/10067",
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyMzIyMTcwMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/523221701/reactions"
    },
    "updated_at": "2019-08-20T22:36:22Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/523221701",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  }
]

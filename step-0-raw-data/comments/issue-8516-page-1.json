[
  {
    "author_association": "NONE",
    "body": "Apparently adding `ValueFromPipelineByPropertyName` to `$AutoFilter` workaround this problem (I have no idea why though, It doesn't make sense)\r\n``` PowerShell\r\n[Parameter(Mandatory = $true, ParameterSetName = 'AutoFilter', ValueFromPipelineByPropertyName)]\r\n[Parameter(Mandatory = $true, ParameterSetName = 'PackageAutoFilter', ValueFromPipelineByPropertyName)]\r\n$AutoFilter,\r\n```",
    "created_at": "2018-12-22T23:11:03Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8516#issuecomment-449603236",
    "id": 449603236,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8516",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0OTYwMzIzNg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/449603236/reactions"
    },
    "updated_at": "2018-12-22T23:11:03Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/449603236",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6960531?v=4",
      "events_url": "https://api.github.com/users/ili101/events{/privacy}",
      "followers_url": "https://api.github.com/users/ili101/followers",
      "following_url": "https://api.github.com/users/ili101/following{/other_user}",
      "gists_url": "https://api.github.com/users/ili101/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ili101",
      "id": 6960531,
      "login": "ili101",
      "node_id": "MDQ6VXNlcjY5NjA1MzE=",
      "organizations_url": "https://api.github.com/users/ili101/orgs",
      "received_events_url": "https://api.github.com/users/ili101/received_events",
      "repos_url": "https://api.github.com/users/ili101/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ili101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ili101/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ili101"
    }
  },
  {
    "author_association": "NONE",
    "body": "Any update on this problem?\r\nAlso the `ValueFromPipelineByPropertyName` workaround I described above is problematic as it preventing the `$PSCmdlet.ParameterSetName` from being set in the `begin{}` part:\r\n\r\n``` PowerShell\r\nfunction Export-Excel\r\n{\r\n    [CmdletBinding(DefaultParameterSetName = 'Default')]\r\n    Param(\r\n        [Parameter(ParameterSetName = \"Default\")]\r\n        [Parameter(ParameterSetName = \"AutoFilter\")]\r\n        [String]$Path,\r\n\r\n        [Parameter(Mandatory = $true, ParameterSetName = \"PackageDefault\")]\r\n        [Parameter(Mandatory = $true, ParameterSetName = \"PackageAutoFilter\")]\r\n        $ExcelPackage,\r\n\r\n        [Parameter(ValueFromPipeline = $true)]\r\n        $TargetData,\r\n\r\n        [Parameter(Mandatory = $true, ParameterSetName = 'AutoFilter', ValueFromPipelineByPropertyName)]\r\n        [Parameter(Mandatory = $true, ParameterSetName = 'PackageAutoFilter', ValueFromPipelineByPropertyName)]\r\n        $AutoFilter,\r\n\r\n        [Parameter(ParameterSetName = 'Default')]#, ValueFromPipelineByPropertyName)]\r\n        [Parameter(ParameterSetName = 'PackageDefault')]#, ValueFromPipelineByPropertyName)]\r\n        [String]$TableName,\r\n        [Parameter(ParameterSetName = 'Default')]\r\n        [Parameter(ParameterSetName = 'PackageDefault')]\r\n        [Switch]$Table,\r\n        [Parameter(ParameterSetName = 'Default')]\r\n        [Parameter(ParameterSetName = 'PackageDefault')]\r\n        $TableStyle = 'Medium6'\r\n    )\r\n    begin {\"ParameterSet begin: \" + $PSCmdlet.ParameterSetName}\r\n    process {\"ParameterSet process: \" + $PSCmdlet.ParameterSetName}\r\n    end {\"ParameterSet end: \" + $PSCmdlet.ParameterSetName}\r\n}\r\n# Works\r\nExport-Excel -ExcelPackage 5 -TargetData 5\r\nExport-Excel -ExcelPackage 5\r\n# With ValueFromPipelineByPropertyName workaround no ParameterSetName in begin:\r\n5 | Export-Excel -ExcelPackage 5\r\n```\r\nOutput:\r\n```\r\nParameterSet begin: PackageDefault\r\nParameterSet process: PackageDefault\r\nParameterSet end: PackageDefault\r\nParameterSet begin: PackageDefault\r\nParameterSet process: PackageDefault\r\nParameterSet end: PackageDefault\r\nParameterSet begin:\r\nParameterSet process: PackageDefault\r\nParameterSet end: PackageDefault\r\n```",
    "created_at": "2019-04-11T20:10:08Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8516#issuecomment-482292860",
    "id": 482292860,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8516",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MjI5Mjg2MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/482292860/reactions"
    },
    "updated_at": "2019-04-11T20:10:08Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/482292860",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6960531?v=4",
      "events_url": "https://api.github.com/users/ili101/events{/privacy}",
      "followers_url": "https://api.github.com/users/ili101/followers",
      "following_url": "https://api.github.com/users/ili101/following{/other_user}",
      "gists_url": "https://api.github.com/users/ili101/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ili101",
      "id": 6960531,
      "login": "ili101",
      "node_id": "MDQ6VXNlcjY5NjA1MzE=",
      "organizations_url": "https://api.github.com/users/ili101/orgs",
      "received_events_url": "https://api.github.com/users/ili101/received_events",
      "repos_url": "https://api.github.com/users/ili101/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ili101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ili101/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ili101"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "I've created a new issue focused on the core symptom of your code, which I think is a bug: #11235\r\n\r\nThe workaround with `ValueFromPipelineByPropertyName` can have unexpected side effects (pipeline input may suddenly start binding to your `$AutoFilter` parameter, which is undesired).\r\n\r\n> as it is preventing the `$PSCmdlet.ParameterSetName` from being set in the `begin{}` part:\r\n\r\nWhile I have no explanation for why `$PSCmdlet.ParameterSetName` is the _empty string_ in the `begin` block with your workaround (smells like another bug), it is worth noting that in functions that have  pipeline-binding parameters, `$PSCmdlet.ParameterSetName` generally only has a meaningful value in the `process` block, because it is possible for _each input object_ to select a _different_ parameter set and the value in `begin` seems to only (unhelpfully) reflect the set that _would have been chosen had there been no pipeline input_.\r\n\r\nIn short: To be safe, check `$PSCmdlet.ParameterSetName`  only in the `process` block.\r\n\r\n\r\n\r\n",
    "created_at": "2019-12-02T18:40:08Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8516#issuecomment-560525271",
    "id": 560525271,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8516",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MDUyNTI3MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/560525271/reactions"
    },
    "updated_at": "2019-12-02T22:57:20Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/560525271",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Additionally, #11237 proposes fundamental - but breaking - improvements to how parameter sets are handled.\r\n\r\nIf you agree that #11235 and #11237 cover all aspects of this issue, I encourage you to close this issue.",
    "created_at": "2019-12-02T22:56:52Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/8516#issuecomment-560823041",
    "id": 560823041,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/8516",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MDgyMzA0MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/560823041/reactions"
    },
    "updated_at": "2019-12-02T22:56:52Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/560823041",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  }
]

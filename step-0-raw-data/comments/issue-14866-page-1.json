[
  {
    "author_association": "COLLABORATOR",
    "body": "Are you running as administrator beforehand? I know 2 or so years ago Microsoft stopped this from working with normal accounts due to a CVE that allows a limited access token to elevate to the admin token. I don’t fully agree with the CVE as UAC is not meant to be a security boundary but I doubt this will go back to the way it was before. More details are in https://devblogs.microsoft.com/powershell/windows-security-change-affecting-powershell/.\n\n<blockquote><img src=\"https://devblogs.microsoft.com/powershell/wp-content/uploads/sites/30/2018/09/Powershell_256.png\" width=\"48\" align=\"right\"><div><img src=\"https://devblogs.microsoft.com/powershell/wp-content/uploads/sites/30/2019/02/Powershell_2561.png\" height=\"14\"> PowerShell Team</div><div><strong><a href=\"https://devblogs.microsoft.com/powershell/windows-security-change-affecting-powershell/\">Windows Security change affecting PowerShell | PowerShell Team</a></strong></div><div>Windows Security change affecting PowerShell January 9, 2019 The recent (1/8/2019) Windows security patch CVE-2019-0543, has introduced a breaking change for a PowerShell remoting scenario. It is a narrowly scoped scenario that should have low impact for most users. The breaking change only affects local loopback remoting,</div></blockquote>",
    "created_at": "2021-02-20T21:07:26Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14866#issuecomment-782749578",
    "id": 782749578,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14866",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4Mjc0OTU3OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/782749578/reactions"
    },
    "updated_at": "2021-02-20T21:07:28Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/782749578",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8462645?v=4",
      "events_url": "https://api.github.com/users/jborean93/events{/privacy}",
      "followers_url": "https://api.github.com/users/jborean93/followers",
      "following_url": "https://api.github.com/users/jborean93/following{/other_user}",
      "gists_url": "https://api.github.com/users/jborean93/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jborean93",
      "id": 8462645,
      "login": "jborean93",
      "node_id": "MDQ6VXNlcjg0NjI2NDU=",
      "organizations_url": "https://api.github.com/users/jborean93/orgs",
      "received_events_url": "https://api.github.com/users/jborean93/received_events",
      "repos_url": "https://api.github.com/users/jborean93/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jborean93/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jborean93/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jborean93"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Yep - different error messages. This is a difference between Microsoft Accounts and local accounts.",
    "created_at": "2021-02-20T22:13:42Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14866#issuecomment-782757410",
    "id": 782757410,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14866",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4Mjc1NzQxMA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/782757410/reactions"
    },
    "updated_at": "2021-02-20T22:13:42Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/782757410",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11475352?v=4",
      "events_url": "https://api.github.com/users/LeeHolmes/events{/privacy}",
      "followers_url": "https://api.github.com/users/LeeHolmes/followers",
      "following_url": "https://api.github.com/users/LeeHolmes/following{/other_user}",
      "gists_url": "https://api.github.com/users/LeeHolmes/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/LeeHolmes",
      "id": 11475352,
      "login": "LeeHolmes",
      "node_id": "MDQ6VXNlcjExNDc1MzUy",
      "organizations_url": "https://api.github.com/users/LeeHolmes/orgs",
      "received_events_url": "https://api.github.com/users/LeeHolmes/received_events",
      "repos_url": "https://api.github.com/users/LeeHolmes/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/LeeHolmes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/LeeHolmes/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/LeeHolmes"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Ah my apologies, I wonder if it also affects a\r\nnon-loop back scenario, I.e from another windows host with the Microsoft account credentials. I know that NTLM has special behaviour when it comes to authenticating the implicit credentials over localhost so knowing whether it’s just the loop back scenario would help track that down.\r\n\r\nUltimately I don’t think the issue is with PowerShell itself as the logon process is all handled by the WinRM service and that’s where the error message is coming from. PowerShell could try and bypass it by automatically adding the `-EnableNetworkAccess` in this situation.",
    "created_at": "2021-02-21T01:20:53Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14866#issuecomment-782776804",
    "id": 782776804,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14866",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4Mjc3NjgwNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/782776804/reactions"
    },
    "updated_at": "2021-02-21T01:20:53Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/782776804",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8462645?v=4",
      "events_url": "https://api.github.com/users/jborean93/events{/privacy}",
      "followers_url": "https://api.github.com/users/jborean93/followers",
      "following_url": "https://api.github.com/users/jborean93/following{/other_user}",
      "gists_url": "https://api.github.com/users/jborean93/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jborean93",
      "id": 8462645,
      "login": "jborean93",
      "node_id": "MDQ6VXNlcjg0NjI2NDU=",
      "organizations_url": "https://api.github.com/users/jborean93/orgs",
      "received_events_url": "https://api.github.com/users/jborean93/received_events",
      "repos_url": "https://api.github.com/users/jborean93/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jborean93/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jborean93/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jborean93"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "The authentication and logon is handled by WinRM and not directly by PowerShell.  This would have to be taken up by the owners of WinRM.",
    "created_at": "2021-03-04T01:16:49Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14866#issuecomment-790206119",
    "id": 790206119,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14866",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5MDIwNjExOQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/790206119/reactions"
    },
    "updated_at": "2021-03-04T01:16:49Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/790206119",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  }
]

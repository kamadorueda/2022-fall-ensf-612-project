[
  {
    "author_association": "NONE",
    "body": "+1. I'm running into this issue as well\r\n\r\n```$PSVersionTable\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.2.2\r\nPSEdition                      Core\r\nGitCommitId                    7.2.2\r\nOS                             Microsoft Windows 10.0.18363\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0…}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0```",
    "created_at": "2022-04-01T03:54:09Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/10996#issuecomment-1085388808",
    "id": 1085388808,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/10996",
    "node_id": "IC_kwDOAvT7bc5AsbgI",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1085388808/reactions"
    },
    "updated_at": "2022-04-01T03:59:18Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1085388808",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/39381608?v=4",
      "events_url": "https://api.github.com/users/StewartRyanSony/events{/privacy}",
      "followers_url": "https://api.github.com/users/StewartRyanSony/followers",
      "following_url": "https://api.github.com/users/StewartRyanSony/following{/other_user}",
      "gists_url": "https://api.github.com/users/StewartRyanSony/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/StewartRyanSony",
      "id": 39381608,
      "login": "StewartRyanSony",
      "node_id": "MDQ6VXNlcjM5MzgxNjA4",
      "organizations_url": "https://api.github.com/users/StewartRyanSony/orgs",
      "received_events_url": "https://api.github.com/users/StewartRyanSony/received_events",
      "repos_url": "https://api.github.com/users/StewartRyanSony/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/StewartRyanSony/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/StewartRyanSony/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/StewartRyanSony"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "This came up in the Discord and it looks like pwsh is expected [Process.Start](https://docs.microsoft.com/en-us/dotnet/api/system.diagnostics.process.start?view=net-6.0) to return the Process object that was started but .NET is not doing so. This result bubbles up the stack to this message as there is no process object to passthru or wait on.\r\n\r\nYou can verify this behaviour with:\r\n\r\n```powershell\r\n$psi = [System.Diagnostics.ProcessStartInfo]@{\r\n    FileName = '...'\r\n    UseShellExecute = $true\r\n}\r\n$proc = [System.Diagnostics.Process]::Start($psi)\r\n$null -eq $proc  # $true\r\n```\r\n\r\nIn my example `FileName` was a jpeg that was associated with a UWP.\r\n\r\nIt seems like the problem exists in .NET and needs to be fixed there. I haven't dug into that layer to figure out why it's not returning the process object as it's definitely starting it. Most likely it's the changing executable name.",
    "created_at": "2022-05-20T00:25:00Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/10996#issuecomment-1132322017",
    "id": 1132322017,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/10996",
    "node_id": "IC_kwDOAvT7bc5Dfdzh",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 2,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1132322017/reactions"
    },
    "updated_at": "2022-05-20T00:25:55Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1132322017",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8462645?v=4",
      "events_url": "https://api.github.com/users/jborean93/events{/privacy}",
      "followers_url": "https://api.github.com/users/jborean93/followers",
      "following_url": "https://api.github.com/users/jborean93/following{/other_user}",
      "gists_url": "https://api.github.com/users/jborean93/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jborean93",
      "id": 8462645,
      "login": "jborean93",
      "node_id": "MDQ6VXNlcjg0NjI2NDU=",
      "organizations_url": "https://api.github.com/users/jborean93/orgs",
      "received_events_url": "https://api.github.com/users/jborean93/received_events",
      "repos_url": "https://api.github.com/users/jborean93/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jborean93/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jborean93/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jborean93"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Just a further note, it looks like .NET tries its best to get the process handle https://github.com/dotnet/corefx/blob/b8b81a66738bb10ef0790023598396861d92b2c4/src/System.Diagnostics.Process/src/System/Diagnostics/Process.Win32.cs#L90-L116.\r\n\r\nIn some cases `ShellExecuteEx` might have it set to `NULL` and I think this is one of them. Unless there's a better API or mechanism in Windows/explorer to use it might just be a limitation of these types of apps and PowerShell should just generate a better error message on return if `-PassThru` or `-Wait` is being used.\n\n<blockquote><img src=\"https://opengraph.githubassets.com/c0096852524c3e68a482dd03d7601151934328e75e6f680b7cb8f13519ba65ab/dotnet/corefx\" width=\"48\" align=\"right\"><div><img src=\"https://github.githubassets.com/favicons/favicon.svg\" height=\"14\"> GitHub</div><div><strong><a href=\"https://github.com/dotnet/corefx\">corefx/Process.Win32.cs at b8b81a66738bb10ef0790023598396861d92b2c4 · dotnet/corefx</a></strong></div><div>This repo is used for servicing PR&#39;s for .NET Core 2.1 and 3.1. Please visit us at https://github.com/dotnet/runtime  - corefx/Process.Win32.cs at b8b81a66738bb10ef0790023598396861d92b2c4 · dot...</div></blockquote>",
    "created_at": "2022-05-20T01:31:15Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/10996#issuecomment-1132355574",
    "id": 1132355574,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/10996",
    "node_id": "IC_kwDOAvT7bc5Dfl_2",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1132355574/reactions"
    },
    "updated_at": "2022-05-20T01:31:18Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1132355574",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8462645?v=4",
      "events_url": "https://api.github.com/users/jborean93/events{/privacy}",
      "followers_url": "https://api.github.com/users/jborean93/followers",
      "following_url": "https://api.github.com/users/jborean93/following{/other_user}",
      "gists_url": "https://api.github.com/users/jborean93/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jborean93",
      "id": 8462645,
      "login": "jborean93",
      "node_id": "MDQ6VXNlcjg0NjI2NDU=",
      "organizations_url": "https://api.github.com/users/jborean93/orgs",
      "received_events_url": "https://api.github.com/users/jborean93/received_events",
      "repos_url": "https://api.github.com/users/jborean93/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jborean93/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jborean93/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jborean93"
    }
  }
]

[
  {
    "author_association": "CONTRIBUTOR",
    "body": "PowerShell, as C#, performs by-(variable)-value argument passing; if that value happens to be an object _reference_, (an instance of a _reference-type_), the object can potentially be modified by the callee.\r\n\r\nI didn't run your code as such, but this simplified _PowerShell_ code demonstrates that your cmdlet works as expected:\r\n\r\n```powershell\r\nAdd-Type @'\r\nusing System;\r\nusing System.Collections;\r\nusing System.Management.Automation;\r\n\r\n[Cmdlet(VerbsCommon.Add, \"CollectionItem\")]\r\npublic class AddCollectionItemCmdlet : Cmdlet\r\n{\r\n    [Parameter(Mandatory = true)]\r\n    [AllowEmptyCollection]\r\n    public ArrayList Collection { get; set; }\r\n\r\n    [Parameter(Mandatory = true)]\r\n    public object Item { get; set; }\r\n\r\n    protected override void BeginProcessing()\r\n    {\r\n        Collection.Add(Item);\r\n    }\r\n}\r\n'@ -PassThru | % Assembly | Import-Module\r\n\r\n$al = [System.Collections.ArrayList] @()\r\n\r\nAdd-CollectionItem -Collection $al -Item new\r\n\r\n$al\r\n```\r\n\r\nThis outputs `'new'`, as expected.\r\n\r\n",
    "created_at": "2020-12-10T22:21:01Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14384#issuecomment-742836710",
    "id": 742836710,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14384",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0MjgzNjcxMA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/742836710/reactions"
    },
    "updated_at": "2020-12-10T22:21:01Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/742836710",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "NONE",
    "body": "@mklement0 thanks. This blows my mind actually. What is interesting is that if you change $al = [System.Collections.ArrayList] @() to New-Object System.Collections.ArrayList then it will output nothing. Is this a bug in PowerShell? ",
    "created_at": "2020-12-11T07:31:49Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14384#issuecomment-743027178",
    "id": 743027178,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14384",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0MzAyNzE3OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/743027178/reactions"
    },
    "updated_at": "2020-12-11T07:32:44Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/743027178",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/4992307?v=4",
      "events_url": "https://api.github.com/users/AlexKichkailo/events{/privacy}",
      "followers_url": "https://api.github.com/users/AlexKichkailo/followers",
      "following_url": "https://api.github.com/users/AlexKichkailo/following{/other_user}",
      "gists_url": "https://api.github.com/users/AlexKichkailo/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/AlexKichkailo",
      "id": 4992307,
      "login": "AlexKichkailo",
      "node_id": "MDQ6VXNlcjQ5OTIzMDc=",
      "organizations_url": "https://api.github.com/users/AlexKichkailo/orgs",
      "received_events_url": "https://api.github.com/users/AlexKichkailo/received_events",
      "repos_url": "https://api.github.com/users/AlexKichkailo/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/AlexKichkailo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AlexKichkailo/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/AlexKichkailo"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Good point, @AlexKichkailo - I hadn't considered the `New-Object` angle, and it looks like you've hit a bug:\r\n\r\nI've opened #14394; if you agree that it is a summary of your problem, I suggest closing _this_ issue.\r\n",
    "created_at": "2020-12-11T13:21:50Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14384#issuecomment-743189381",
    "id": 743189381,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14384",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0MzE4OTM4MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/743189381/reactions"
    },
    "updated_at": "2020-12-11T13:21:50Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/743189381",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "NONE",
    "body": "Thank you very much, @mklement0 ! I am closing this issue then.",
    "created_at": "2020-12-11T15:09:06Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14384#issuecomment-743247540",
    "id": 743247540,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14384",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0MzI0NzU0MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/743247540/reactions"
    },
    "updated_at": "2020-12-11T15:09:06Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/743247540",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/4992307?v=4",
      "events_url": "https://api.github.com/users/AlexKichkailo/events{/privacy}",
      "followers_url": "https://api.github.com/users/AlexKichkailo/followers",
      "following_url": "https://api.github.com/users/AlexKichkailo/following{/other_user}",
      "gists_url": "https://api.github.com/users/AlexKichkailo/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/AlexKichkailo",
      "id": 4992307,
      "login": "AlexKichkailo",
      "node_id": "MDQ6VXNlcjQ5OTIzMDc=",
      "organizations_url": "https://api.github.com/users/AlexKichkailo/orgs",
      "received_events_url": "https://api.github.com/users/AlexKichkailo/received_events",
      "repos_url": "https://api.github.com/users/AlexKichkailo/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/AlexKichkailo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AlexKichkailo/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/AlexKichkailo"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "My pleasure, @AlexKichkailo, thanks for finding and reporting the issue. Note that up-votes on issues matter when it comes to deciding what gets implemented / prioritized, so I suggest giving the linked issue a thumbs-up.\r\n\r\n",
    "created_at": "2020-12-11T15:27:59Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/14384#issuecomment-743259786",
    "id": 743259786,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/14384",
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0MzI1OTc4Ng==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/743259786/reactions"
    },
    "updated_at": "2020-12-11T21:09:07Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/743259786",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  }
]

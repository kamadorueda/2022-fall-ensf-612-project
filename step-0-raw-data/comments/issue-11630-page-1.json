[
  {
    "author_association": "COLLABORATOR",
    "body": "@mikeTWC1984 Welcome to contribute! Pull PR and we will discuss in depth.",
    "created_at": "2020-01-20T13:57:18Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11630#issuecomment-576285545",
    "id": 576285545,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11630",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3NjI4NTU0NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/576285545/reactions"
    },
    "updated_at": "2020-01-20T13:57:18Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/576285545",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "OK, here is the PR\r\nhttps://github.com/PowerShell/PowerShell/pull/11643\r\n\r\nThere is another method (bool CertIsGoodForEncryption) in CmsUtils that is using native calls (probably wont work on linux). It basically checks this condition:\r\n```\r\n Encryption certificates must contain the Data Encipherment or Key Encipherment key usage, and include the Document Encryption Enhanced Key Usage (1.3.6.1.4.1.311.80.1)\r\n```\r\n\r\nBut that seem to be overkill, all these key usages can be retrieved from  X509Certificate2  cert instance. More over, this check is not really needed to encrypt/decrypt data (I guess it's just following MSFT standards).  AFAIK any RSA key pair can be used for CMS encryption. For example openssl generated keys can be used for PKI encryption (using openssl cms) without setting any extra options . I guess for non-Windows systems this check can always return true (this would also be the easiest fix), since they mainly generate certs using openssl anyway.",
    "created_at": "2020-01-21T22:15:04Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11630#issuecomment-576909950",
    "id": 576909950,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11630",
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3NjkwOTk1MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/576909950/reactions"
    },
    "updated_at": "2020-01-21T22:15:04Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/576909950",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/31977106?v=4",
      "events_url": "https://api.github.com/users/mikeTWC1984/events{/privacy}",
      "followers_url": "https://api.github.com/users/mikeTWC1984/followers",
      "following_url": "https://api.github.com/users/mikeTWC1984/following{/other_user}",
      "gists_url": "https://api.github.com/users/mikeTWC1984/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mikeTWC1984",
      "id": 31977106,
      "login": "mikeTWC1984",
      "node_id": "MDQ6VXNlcjMxOTc3MTA2",
      "organizations_url": "https://api.github.com/users/mikeTWC1984/orgs",
      "received_events_url": "https://api.github.com/users/mikeTWC1984/received_events",
      "repos_url": "https://api.github.com/users/mikeTWC1984/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mikeTWC1984/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mikeTWC1984/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mikeTWC1984"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "/cc @TravisEz13 @PaulHigin Please share your thoughts about @mikeTWC1984 comment.",
    "created_at": "2020-03-17T14:49:17Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11630#issuecomment-600112733",
    "id": 600112733,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11630",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwMDExMjczMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/600112733/reactions"
    },
    "updated_at": "2020-03-17T14:49:17Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/600112733",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "@mikeTWC1984 This is a security standard.  Using a certificate not marked this way to encrypt or decrypt is a threat.  Key Usage ensures that you only use a properly secured cert (what every that standard is for your org) to do that kind of operation.  Allowing any cert, bypasses that assurance.",
    "created_at": "2020-03-18T21:00:49Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11630#issuecomment-600855995",
    "id": 600855995,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11630",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwMDg1NTk5NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/600855995/reactions"
    },
    "updated_at": "2020-03-18T21:00:49Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/600855995",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/10873629?v=4",
      "events_url": "https://api.github.com/users/TravisEz13/events{/privacy}",
      "followers_url": "https://api.github.com/users/TravisEz13/followers",
      "following_url": "https://api.github.com/users/TravisEz13/following{/other_user}",
      "gists_url": "https://api.github.com/users/TravisEz13/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/TravisEz13",
      "id": 10873629,
      "login": "TravisEz13",
      "node_id": "MDQ6VXNlcjEwODczNjI5",
      "organizations_url": "https://api.github.com/users/TravisEz13/orgs",
      "received_events_url": "https://api.github.com/users/TravisEz13/received_events",
      "repos_url": "https://api.github.com/users/TravisEz13/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/TravisEz13/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TravisEz13/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/TravisEz13"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "This type of attack was used in the Flame virus against Windows Update Agent/WSUS.  The EKUs involved where different, but the concept is the same.",
    "created_at": "2020-03-18T21:02:10Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11630#issuecomment-600856552",
    "id": 600856552,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11630",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwMDg1NjU1Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/600856552/reactions"
    },
    "updated_at": "2020-03-18T21:03:54Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/600856552",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/10873629?v=4",
      "events_url": "https://api.github.com/users/TravisEz13/events{/privacy}",
      "followers_url": "https://api.github.com/users/TravisEz13/followers",
      "following_url": "https://api.github.com/users/TravisEz13/following{/other_user}",
      "gists_url": "https://api.github.com/users/TravisEz13/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/TravisEz13",
      "id": 10873629,
      "login": "TravisEz13",
      "node_id": "MDQ6VXNlcjEwODczNjI5",
      "organizations_url": "https://api.github.com/users/TravisEz13/orgs",
      "received_events_url": "https://api.github.com/users/TravisEz13/received_events",
      "repos_url": "https://api.github.com/users/TravisEz13/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/TravisEz13/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TravisEz13/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/TravisEz13"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@TravisEz13  Make sense. Since you mentioned this is a security concern - EKU check is implemented in the CMDlet itself, the actual .net class (EnvelopedCMS) is not checking it. So even Unprotect-CmsMessage would skip EKU check if cert is in the CurrentUser\\My store. \r\n\r\nI think we can close this, since the PR above  replaced native calls (Windows only)  with pure .net ",
    "created_at": "2020-03-19T16:46:27Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/11630#issuecomment-601287652",
    "id": 601287652,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/11630",
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwMTI4NzY1Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/601287652/reactions"
    },
    "updated_at": "2020-03-19T16:46:27Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/601287652",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/31977106?v=4",
      "events_url": "https://api.github.com/users/mikeTWC1984/events{/privacy}",
      "followers_url": "https://api.github.com/users/mikeTWC1984/followers",
      "following_url": "https://api.github.com/users/mikeTWC1984/following{/other_user}",
      "gists_url": "https://api.github.com/users/mikeTWC1984/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mikeTWC1984",
      "id": 31977106,
      "login": "mikeTWC1984",
      "node_id": "MDQ6VXNlcjMxOTc3MTA2",
      "organizations_url": "https://api.github.com/users/mikeTWC1984/orgs",
      "received_events_url": "https://api.github.com/users/mikeTWC1984/received_events",
      "repos_url": "https://api.github.com/users/mikeTWC1984/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mikeTWC1984/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mikeTWC1984/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mikeTWC1984"
    }
  }
]

[
  {
    "author_association": "MEMBER",
    "body": "To validate this is the `ConvertTo-Json` cmdlet perf issue, can you store the results of `Get-VM | Get-Snapshot` into a variable and then just measure that conversion?\r\n\r\n```powershell\r\n$s = Get-VM | Get-Snapshot\r\nmeasure-command { $s | convertto-json }\r\n```\r\n",
    "created_at": "2017-05-16T17:47:36Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3790#issuecomment-301860649",
    "id": 301860649,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3790",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMTg2MDY0OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/301860649/reactions"
    },
    "updated_at": "2017-05-16T17:47:36Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/301860649",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "NONE",
    "body": "Hi, thanks for taking this issue seriously !\r\nHere are the results from the tests.\r\nThey are substantially the same :\r\n\r\n* Linux Ubuntu 16.04 :\r\n```\r\nPS /home/remi> $s = get-vm | get-snapshot                                                                                                                                                                   \r\nPS /home/remi> Measure-Command { $s | ConvertTo-Json }                                                                                                                                                      \r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 53\r\nMilliseconds      : 843\r\nTicks             : 538433204\r\nTotalDays         : 0.000623186578703704\r\nTotalHours        : 0.0149564778888889\r\nTotalMinutes      : 0.897388673333333\r\nTotalSeconds      : 53.8433204\r\nTotalMilliseconds : 53843.3204\r\n\r\nPS /home/remi> Measure-Command { $s = Get-VM | Get-Snapshot }                                                                                                                                               \r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 5\r\nMilliseconds      : 788\r\nTicks             : 57880380\r\nTotalDays         : 6.69911805555556E-05\r\nTotalHours        : 0.00160778833333333\r\nTotalMinutes      : 0.0964673\r\nTotalSeconds      : 5.788038\r\nTotalMilliseconds : 5788.038\r\n\r\nPS /home/remi> $PSVersionTable                                                                                                                                                                              \r\nName                           Value                                                                                                                                                                       \r\n----                           -----                                                                                                                                                                       \r\nPSVersion                      6.0.0-alpha                                                                                                                                                                 \r\nPSEdition                      Core                                                                                                                                                                        \r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}                                                                                                                                                     \r\nBuildVersion                   3.0.0.0                                                                                                                                                                     \r\nGitCommitId                    v6.0.0-alpha.17                                                                                                                                                             \r\nCLRVersion                                                                                                                                                                                                 \r\nWSManStackVersion              3.0                                                                                                                                                                         \r\nPSRemotingProtocolVersion      2.3                                                                                                                                                                         \r\nSerializationVersion           1.1.0.1      \r\n```\r\n\r\n* Windows Server 2012 Standard\r\n```\r\nPowerCLI C:\\> $s =  get-vm | get-snapshot\r\nPowerCLI C:\\> Measure-Command { $s | ConvertTo-Json }\r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 2\r\nMilliseconds      : 40\r\nTicks             : 20408226\r\nTotalDays         : 2,36206319444444E-05\r\nTotalHours        : 0,000566895166666667\r\nTotalMinutes      : 0,03401371\r\nTotalSeconds      : 2,0408226\r\nTotalMilliseconds : 2040,8226\r\n\r\nPowerCLI C:\\> Measure-Command { $s =  get-vm | get-snapshot }\r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 2\r\nMilliseconds      : 939\r\nTicks             : 29397381\r\nTotalDays         : 3,40247465277778E-05\r\nTotalHours        : 0,000816593916666667\r\nTotalMinutes      : 0,048995635\r\nTotalSeconds      : 2,9397381\r\nTotalMilliseconds : 2939,7381\r\n\r\nPowerCLI C:\\> $PSVersionTable\r\nName                           Value\r\n----                           -----\r\nPSVersion                      4.0\r\nWSManStackVersion              3.0\r\nSerializationVersion           1.1.0.1\r\nCLRVersion                     4.0.30319.36366\r\nBuildVersion                   6.3.9600.16406\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0}\r\nPSRemotingProtocolVersion      2.2\r\n```",
    "created_at": "2017-05-17T09:14:02Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3790#issuecomment-302033091",
    "id": 302033091,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3790",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMjAzMzA5MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/302033091/reactions"
    },
    "updated_at": "2017-05-17T10:25:03Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/302033091",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11832241?v=4",
      "events_url": "https://api.github.com/users/remi13131/events{/privacy}",
      "followers_url": "https://api.github.com/users/remi13131/followers",
      "following_url": "https://api.github.com/users/remi13131/following{/other_user}",
      "gists_url": "https://api.github.com/users/remi13131/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/remi13131",
      "id": 11832241,
      "login": "remi13131",
      "node_id": "MDQ6VXNlcjExODMyMjQx",
      "organizations_url": "https://api.github.com/users/remi13131/orgs",
      "received_events_url": "https://api.github.com/users/remi13131/received_events",
      "repos_url": "https://api.github.com/users/remi13131/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/remi13131/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/remi13131/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/remi13131"
    }
  },
  {
    "author_association": "NONE",
    "body": "Digging a bit out, I noticed that there must be a difference either between how Windows and Linux behave with the ConverTo-Json either between PowershellV4 (that my Windows runs) and V6 (that my Linux runs) : \r\n\r\n* Windows Server 2012 Standard\r\n```\r\nPowerCLI C:\\> $s = get-vm | get-snapshot\r\nPowerCLI C:\\> $s.Count\r\n21\r\nPowerCLI C:\\> $s_json_compact = $s | ConvertTo-Json -Depth 1 -Compress\r\nPowerCLI C:\\> $s_json_compact.length\r\n14627\r\n```\r\n\r\n* Linux Ubuntu 16.04 \r\n```\r\nPS /home/remi> $s = get-vm | get-snapshot                                                                                                                                                                   \r\nPS /home/remi> $s.Count                                                                                                                                                                                     \r\n21\r\nPS /home/remi>  $s_json_compact = $s | ConvertTo-Json -Depth 1 -Compress                                                                                                                                    \r\nPS /home/remi>  $s_json_compact.length                                                                                                                                                                      \r\n14816\r\n```\r\n\r\nNotice the ~200 characters difference\r\n",
    "created_at": "2017-05-17T10:24:31Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3790#issuecomment-302049879",
    "id": 302049879,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3790",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMjA0OTg3OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/302049879/reactions"
    },
    "updated_at": "2017-05-17T10:27:05Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/302049879",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11832241?v=4",
      "events_url": "https://api.github.com/users/remi13131/events{/privacy}",
      "followers_url": "https://api.github.com/users/remi13131/followers",
      "following_url": "https://api.github.com/users/remi13131/following{/other_user}",
      "gists_url": "https://api.github.com/users/remi13131/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/remi13131",
      "id": 11832241,
      "login": "remi13131",
      "node_id": "MDQ6VXNlcjExODMyMjQx",
      "organizations_url": "https://api.github.com/users/remi13131/orgs",
      "received_events_url": "https://api.github.com/users/remi13131/received_events",
      "repos_url": "https://api.github.com/users/remi13131/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/remi13131/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/remi13131/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/remi13131"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "I missed that you were comparing with PSv4.  PSCore6 uses NewtonSoft.Json instead of the .Net json serializer (mainly because CoreFx doesn't have it).  I'm surprised by the perf difference and generally expect NewtonSoft.Json to be faster.  We should investigate to see where the bottleneck is.",
    "created_at": "2017-05-18T22:42:30Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3790#issuecomment-302561393",
    "id": 302561393,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3790",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMjU2MTM5Mw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/302561393/reactions"
    },
    "updated_at": "2017-05-18T22:42:30Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/302561393",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "NONE",
    "body": "My bad I edited the first post afterward when I noticed I forgot the $PSVersionTable dump while writing the last comment. \r\n\r\nIs it only the case in Powershell 6 or Powershell 5 also uses NewtonSoft.Json ? \r\n\r\nThat would be great to investigate since 2sec to 53sec is a huge time gap IMO",
    "created_at": "2017-05-19T09:35:11Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3790#issuecomment-302656630",
    "id": 302656630,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3790",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMjY1NjYzMA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/302656630/reactions"
    },
    "updated_at": "2017-05-19T10:03:34Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/302656630",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11832241?v=4",
      "events_url": "https://api.github.com/users/remi13131/events{/privacy}",
      "followers_url": "https://api.github.com/users/remi13131/followers",
      "following_url": "https://api.github.com/users/remi13131/following{/other_user}",
      "gists_url": "https://api.github.com/users/remi13131/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/remi13131",
      "id": 11832241,
      "login": "remi13131",
      "node_id": "MDQ6VXNlcjExODMyMjQx",
      "organizations_url": "https://api.github.com/users/remi13131/orgs",
      "received_events_url": "https://api.github.com/users/remi13131/received_events",
      "repos_url": "https://api.github.com/users/remi13131/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/remi13131/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/remi13131/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/remi13131"
    }
  },
  {
    "author_association": "NONE",
    "body": "That said I have the same problem with Format-List as stated in the title. I also tried ConvertTo-Csv, ConvertTo-Xml, I stopped there but all of them suffer from high processing time, hence the title with a wildcard. \r\n\r\nHave all of them changed the serializer they use as well ?\r\n\r\n* Windows Server 2008 R2 : \r\n```\r\nPowerCLI C:\\> Measure-Command { get-vm | get-snapshot | Format-List }\r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 3\r\nMilliseconds      : 874\r\nTicks             : 38742039\r\nTotalDays         : 4,48403229166667E-05\r\nTotalHours        : 0,00107616775\r\nTotalMinutes      : 0,064570065\r\nTotalSeconds      : 3,8742039\r\nTotalMilliseconds : 3874,2039\r\n```\r\n\r\n* Ubuntu 16.04 :\r\n```\r\nPS /home/remi> Measure-Command { get-vm | get-snapshot | Format-List }                                                                            \r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 26\r\nMilliseconds      : 341\r\nTicks             : 263413861\r\nTotalDays         : 0.000304877153935185\r\nTotalHours        : 0.00731705169444444\r\nTotalMinutes      : 0.439023101666667\r\nTotalSeconds      : 26.3413861\r\nTotalMilliseconds : 26341.3861\r\n```",
    "created_at": "2017-05-19T12:40:27Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3790#issuecomment-302692021",
    "id": 302692021,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3790",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMjY5MjAyMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/302692021/reactions"
    },
    "updated_at": "2017-05-19T12:44:10Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/302692021",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11832241?v=4",
      "events_url": "https://api.github.com/users/remi13131/events{/privacy}",
      "followers_url": "https://api.github.com/users/remi13131/followers",
      "following_url": "https://api.github.com/users/remi13131/following{/other_user}",
      "gists_url": "https://api.github.com/users/remi13131/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/remi13131",
      "id": 11832241,
      "login": "remi13131",
      "node_id": "MDQ6VXNlcjExODMyMjQx",
      "organizations_url": "https://api.github.com/users/remi13131/orgs",
      "received_events_url": "https://api.github.com/users/remi13131/received_events",
      "repos_url": "https://api.github.com/users/remi13131/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/remi13131/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/remi13131/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/remi13131"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@remi13131 I've tried serializing object arrays similar to those returned by VMware PowerCLI on (PSv6.0.0-alpha.18 on Debian 8 and Ubuntu 14), but I don't see those huge delays (compared to running same stuff on Windows). Additional info will be useful for investigation:\r\n1) do those Linux and Windows machines have relatively the same hardware (specifically: number of CPU cores, CPU speed and memory size) ?\r\n2) is there a chance that another app is running on Linux machines, taking system resources?\r\n3) have you noticed ConvertTo-Json / Format-List delays with data other than what is returned by PowerCLI cmdlets?\r\n4) can you please save following test in a script file and run it on Windows and Linux machines and reply with results; thank you:\r\n\r\n\r\n```\r\nparam($itemCount = 500)\r\nfunction GenerateObjectArray\r\n{\r\n    $code = @\"\r\nusing System; \r\nnamespace TestN\r\n{\r\n    public enum E1 { E11 }\r\n\r\n    public class TypeA\r\n    {\r\n        public string P1 {get;set;}\r\n        public DateTime P2 {get;set;}\r\n        public bool P3 {get;set;}\r\n        public E1 P4 {get;set;}\r\n        public string P5 {get;set;}\r\n        public decimal P6 {get;set;}\r\n        public decimal? P7 {get;set;}\r\n        public bool P8 {get;set;}\r\n        public bool P9 {get;set;}\r\n        public bool P10;\r\n\r\n        public object MetaInfo {get;set;}\r\n        public TypeA Parent {get;set;}\r\n        public TypeA[] Children {get;set;}\r\n        public object CommonObj {get;set;}\r\n        public object AdditionalData {get;set;}\r\n\r\n        public TypeA()\r\n        {\r\n            this.P1 = this.P5 = Guid.NewGuid().ToString();\r\n            this.P2 = DateTime.Now;\r\n            this.P6 = 1235;\r\n            this.P7 = null;\r\n        }\r\n    }\r\n}\r\n\"@\r\n\r\n    Add-Type -TypeDefinition $code\r\n\r\n    $CommonObj = New-object TestN.TypeA\r\n    # some init of properties \r\n    $arr = @()\r\n    $count = $itemCount\r\n    0..($count-1) | %{\r\n        $n = New-object TestN.TypeA\r\n        $n.P1 = \"$_-\"+$n.P1\r\n        $n.CommonObj = $CommonObj\r\n        $n.MetaInfo = $n.GetType()\r\n\r\n        $arr += $n\r\n    }\r\n    # linking objs together\r\n    0..($count-1) | %{\r\n    \r\n        $arr[$_].Children = $arr[$_+1]\r\n        if ($_ -gt 0) { $arr[$_].Parent = $arr[$_-1] }\r\n    }\r\n\r\n    $arr\r\n}\r\n\r\n\"Running for $itemCount objects\"\r\n$PSVersionTable\r\n$objs = GenerateObjectArray\r\nMeasure-Command {$objs | ConvertTo-Json }\r\n```\r\n",
    "created_at": "2017-06-26T20:04:41Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3790#issuecomment-311166652",
    "id": 311166652,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3790",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxMTE2NjY1Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/311166652/reactions"
    },
    "updated_at": "2017-06-26T20:04:41Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/311166652",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11860095?v=4",
      "events_url": "https://api.github.com/users/anmenaga/events{/privacy}",
      "followers_url": "https://api.github.com/users/anmenaga/followers",
      "following_url": "https://api.github.com/users/anmenaga/following{/other_user}",
      "gists_url": "https://api.github.com/users/anmenaga/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/anmenaga",
      "id": 11860095,
      "login": "anmenaga",
      "node_id": "MDQ6VXNlcjExODYwMDk1",
      "organizations_url": "https://api.github.com/users/anmenaga/orgs",
      "received_events_url": "https://api.github.com/users/anmenaga/received_events",
      "repos_url": "https://api.github.com/users/anmenaga/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/anmenaga/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/anmenaga/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/anmenaga"
    }
  },
  {
    "author_association": "NONE",
    "body": "> do those Linux and Windows machines have relatively the same hardware (specifically: number of CPU cores, CPU speed and memory size) ?\r\n\r\nThe Debian 8 and the Windows Server 2008 R2 are virtual machines running in VMWare and have similar hardware configuration, with Windows having 2GB more in memory though. \r\n\r\nActually the other Linux machine, which is my personal dev computer is more powerfull than the Windows and Debian : \r\n\r\n* Ubuntu 16.04 (my machine, so \"real\" hardware) : \r\n\r\nIntel(R) Core(TM) i7-3770 CPU @ 3.40GHz\r\nClockspeed: 3.4 GHz\r\nTurbo Speed: 3.9 GHz\r\nNo of Cores: 4 (2 logical cores per physical)\r\nRam 16GB\r\n\r\n```\r\nremi@remi-adminsys:~$ sudo lshw -short\r\n[sudo] password for remi: \r\nH/W path         Device      Class          Description\r\n=======================================================\r\n                             system         HP Compaq Elite 8300 MT (QV994AV)\r\n/0                           bus            3397\r\n/0/0                         memory         64KiB BIOS\r\n/0/4                         processor      Intel(R) Core(TM) i7-3770 CPU @ 3.40GHz\r\n/0/4/5                       memory         256KiB L1 cache\r\n/0/4/6                       memory         1MiB L2 cache\r\n/0/4/7                       memory         8MiB L3 cache\r\n/0/2b                        memory         16GiB System Memory\r\n/0/2b/0                      memory         4GiB DIMM DDR3 Synchronous 1600 MHz (0,6 ns)\r\n/0/2b/1                      memory         4GiB DIMM DDR3 Synchronous 1600 MHz (0,6 ns)\r\n/0/2b/2                      memory         4GiB DIMM DDR3 Synchronous 1600 MHz (0,6 ns)\r\n/0/2b/3                      memory         4GiB DIMM DDR3 Synchronous 1600 MHz (0,6 ns)\r\n/0/100                       bridge         Xeon E3-1200 v2/3rd Gen Core processor DRAM Controller\r\n/0/100/1                     bridge         Xeon E3-1200 v2/3rd Gen Core processor PCI Express Root Port\r\n/0/100/1/0                   display        GK107 [GeForce GT 630 OEM]\r\n```\r\n\r\n* Debian 8 (virtualized VMWare Hardware) : \r\n\r\n2 VCores\r\n4GB Ram\r\n\r\n![image](https://user-images.githubusercontent.com/11832241/27580084-eb77ece2-5b29-11e7-84ca-bb3371d616bc.png)\r\n\r\n```\r\nremi@cmdb1:~$ sudo lshw -short\r\nChemin matériel   Périphérique  Classe     Description\r\n=========================================================\r\n                                   system     Computer\r\n/0                                 bus        Motherboard\r\n/0/0                               memory     3952MiB Mémoire système\r\n/0/1                               processor  Intel(R) Xeon(R) CPU E5-2670 0 @ 2.60GHz\r\n/0/2                               processor  Intel(R) Xeon(R) CPU E5-2670 0 @ 2.60GHz\r\n/0/100                             bridge     440BX/ZX/DX - 82443BX/ZX/DX Host bridge\r\n/0/100/1                           bridge     440BX/ZX/DX - 82443BX/ZX/DX AGP bridge\r\n/0/100/7                           bridge     82371AB/EB/MB PIIX4 ISA\r\n/0/100/7.1                         storage    82371AB/EB/MB PIIX4 IDE\r\n/0/100/7.3                         bridge     82371AB/EB/MB PIIX4 ACPI\r\n/0/100/7.7                         generic    Virtual Machine Communication Interface\r\n/0/100/f                           display    SVGA II Adapter\r\n/0/100/11                          bridge     PCI bridge\r\n/0/100/15                          bridge     PCI Express Root Port\r\n/0/100/15/0        scsi0           storage    PVSCSI SCSI Controller\r\n/0/100/15/0/0.1.0  /dev/sda        volume     11GiB SCSI Disk\r\n```\r\n\r\n* Windows Server 2008 R2 (virtualized VMWare hardware) :\r\n\r\n2VCores \r\n6GB Ram\r\n\r\n![image](https://user-images.githubusercontent.com/11832241/27580941-8816bcb6-5b2c-11e7-9b2b-cfcab99c1eef.png)\r\n\r\n![infossysteme](https://user-images.githubusercontent.com/11832241/27580584-5de83056-5b2b-11e7-93e8-251208d293a0.png)",
    "created_at": "2017-06-27T10:06:02Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3790#issuecomment-311313630",
    "id": 311313630,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3790",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxMTMxMzYzMA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/311313630/reactions"
    },
    "updated_at": "2017-06-30T09:57:18Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/311313630",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11832241?v=4",
      "events_url": "https://api.github.com/users/remi13131/events{/privacy}",
      "followers_url": "https://api.github.com/users/remi13131/followers",
      "following_url": "https://api.github.com/users/remi13131/following{/other_user}",
      "gists_url": "https://api.github.com/users/remi13131/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/remi13131",
      "id": 11832241,
      "login": "remi13131",
      "node_id": "MDQ6VXNlcjExODMyMjQx",
      "organizations_url": "https://api.github.com/users/remi13131/orgs",
      "received_events_url": "https://api.github.com/users/remi13131/received_events",
      "repos_url": "https://api.github.com/users/remi13131/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/remi13131/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/remi13131/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/remi13131"
    }
  },
  {
    "author_association": "NONE",
    "body": "---------------------------------------------------------------------------------------------------\r\n> is there a chance that another app is running on Linux machines, taking system resources?\r\n\r\nI really don't think so, here is top result right after doing the tests again (for next question) and you can notice that it is really not overloaded. \r\n\r\n* Ubuntu 16.04 :\r\n\r\nremi@remi-adminsys:~$ top\r\n\r\n```\r\ntop - 10:49:16 up 6 days, 23:42,  1 user,  load average: 0,60, 0,55, 0,48\r\nTasks: 290 total,   2 running, 288 sleeping,   0 stopped,   0 zombie\r\n%Cpu(s):  2,6 us,  0,3 sy,  0,0 ni, 97,0 id,  0,0 wa,  0,0 hi,  0,0 si,  0,0 st\r\nKiB Mem : 16372164 total,  5713292 free,  5251448 used,  5407424 buff/cache\r\nKiB Swap: 16718844 total, 16718844 free,        0 used. 10547628 avail Mem \r\n```\r\n\r\n* Debain 8 :\r\n\r\n```\r\nremi@cmdb1:~$ top\r\ntop - 11:00:54 up 17 days, 23:32,  2 users,  load average: 0,11, 0,11, 0,04\r\nTasks: 101 total,   1 running, 100 sleeping,   0 stopped,   0 zombie\r\n%Cpu(s):  0,5 us,  0,3 sy,  0,0 ni, 99,1 id,  0,0 wa,  0,0 hi,  0,0 si,  0,0 st\r\nKiB Mem:   4047208 total,  2184256 used,  1862952 free,   188568 buffers\r\nKiB Swap:  1048572 total,       44 used,  1048528 free.  1366676 cached Mem\r\n\r\n```",
    "created_at": "2017-06-27T10:06:21Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3790#issuecomment-311313715",
    "id": 311313715,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3790",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxMTMxMzcxNQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/311313715/reactions"
    },
    "updated_at": "2017-06-30T09:58:38Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/311313715",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11832241?v=4",
      "events_url": "https://api.github.com/users/remi13131/events{/privacy}",
      "followers_url": "https://api.github.com/users/remi13131/followers",
      "following_url": "https://api.github.com/users/remi13131/following{/other_user}",
      "gists_url": "https://api.github.com/users/remi13131/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/remi13131",
      "id": 11832241,
      "login": "remi13131",
      "node_id": "MDQ6VXNlcjExODMyMjQx",
      "organizations_url": "https://api.github.com/users/remi13131/orgs",
      "received_events_url": "https://api.github.com/users/remi13131/received_events",
      "repos_url": "https://api.github.com/users/remi13131/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/remi13131/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/remi13131/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/remi13131"
    }
  },
  {
    "author_association": "NONE",
    "body": "---------------------------------------------------------------------------------------------------\r\n> have you noticed ConvertTo-Json / Format-List delays with data other than what is returned by PowerCLI cmdlets?\r\n\r\nActually, no. \r\nWhat is weird : if I ConvertTo-Json once, and do it again right after, the second time will be much faster. \r\n\r\n* Debian 8 :\r\n\r\n```\r\nPS /home/remi> $s = get-vm | get-snapshot                                                                                                                                                               \r\nPS /home/remi> Measure-Command { ConvertTo-Json $s }                                                                                                                                                    \r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 39\r\nMilliseconds      : 227\r\nTicks             : 392278929\r\nTotalDays         : 0,000454026538194444\r\nTotalHours        : 0,0108966369166667\r\nTotalMinutes      : 0,653798215\r\nTotalSeconds      : 39,2278929\r\nTotalMilliseconds : 39227,8929\r\n\r\nPS /home/remi> Measure-Command { ConvertTo-Json $s }                                                                                                                                                    \r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 0\r\nMilliseconds      : 43\r\nTicks             : 434385\r\nTotalDays         : 5,02760416666667E-07\r\nTotalHours        : 1,206625E-05\r\nTotalMinutes      : 0,000723975\r\nTotalSeconds      : 0,0434385\r\nTotalMilliseconds : 43,4385\r\n```\r\n\r\n* Ubuntu 16.04 : \r\n\r\n```\r\nPS /home/remi> $s = get-vm | get-snapshot                                                                                                                                                                   \r\nPS /home/remi> Measure-Command { ConvertTo-Json $s }                                                                                                                                                        \r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 32\r\nMilliseconds      : 818\r\nTicks             : 328183949\r\nTotalDays         : 0.000379842533564815\r\nTotalHours        : 0.00911622080555556\r\nTotalMinutes      : 0.546973248333333\r\nTotalSeconds      : 32.8183949\r\nTotalMilliseconds : 32818.3949\r\n\r\nPS /home/remi> Measure-Command { ConvertTo-Json $s }                                                                                                                                                        \r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 0\r\nMilliseconds      : 17\r\nTicks             : 176529\r\nTotalDays         : 2.04315972222222E-07\r\nTotalHours        : 4.90358333333333E-06\r\nTotalMinutes      : 0.000294215\r\nTotalSeconds      : 0.0176529\r\nTotalMilliseconds : 17.6529\r\n```\r\n\r\nOther thing that I find is weird : if I ConvertTo-Json then I ConvertFrom-Json the resulting object then ConvertTo-Json again, no time delay will be noticed for the last ConvertTo-Json as well. \r\n\r\n* Ubuntu 16.04 :\r\n\r\n```\r\nPS /home/remi> $s = get-vm | get-snapshot                                                                                                                                                                   \r\nPS /home/remi> Measure-Command { $s_json = ConvertTo-Json $s }                                                                                                                                              \r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 33\r\nMilliseconds      : 153\r\nTicks             : 331534633\r\nTotalDays         : 0.000383720640046296\r\nTotalHours        : 0.00920929536111111\r\nTotalMinutes      : 0.552557721666667\r\nTotalSeconds      : 33.1534633\r\nTotalMilliseconds : 33153.4633\r\n\r\nPS /home/remi> Measure-Command { $s_object = ConvertFrom-Json $s_json }                                                                                                                                     \r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 0\r\nMilliseconds      : 115\r\nTicks             : 1156017\r\nTotalDays         : 1.33798263888889E-06\r\nTotalHours        : 3.21115833333333E-05\r\nTotalMinutes      : 0.001926695\r\nTotalSeconds      : 0.1156017\r\nTotalMilliseconds : 115.6017\r\n\r\nPS /home/remi> Measure-Command { ConvertTo-Json $s_object }                                                                                                                                                 \r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 0\r\nMilliseconds      : 13\r\nTicks             : 132256\r\nTotalDays         : 1.53074074074074E-07\r\nTotalHours        : 3.67377777777778E-06\r\nTotalMinutes      : 0.000220426666666667\r\nTotalSeconds      : 0.0132256\r\nTotalMilliseconds : 13.2256\r\n```\r\n\r\n* Debian 8 :\r\n\r\n```\r\nPS /home/remi> $s = get-vm | get-snapshot                                                                                                                                                               \r\nPS /home/remi> Measure-Command { $s_json = ConvertTo-Json $s }                                                                                                                                          \r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 39\r\nMilliseconds      : 168\r\nTicks             : 391687906\r\nTotalDays         : 0,000453342483796296\r\nTotalHours        : 0,0108802196111111\r\nTotalMinutes      : 0,652813176666667\r\nTotalSeconds      : 39,1687906\r\nTotalMilliseconds : 39168,7906\r\n\r\nPS /home/remi> Measure-Command { $s_object = ConvertFrom-Json $s_json }                                                                                                                                 \r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 0\r\nMilliseconds      : 228\r\nTicks             : 2286008\r\nTotalDays         : 2,64584259259259E-06\r\nTotalHours        : 6,35002222222222E-05\r\nTotalMinutes      : 0,00381001333333333\r\nTotalSeconds      : 0,2286008\r\nTotalMilliseconds : 228,6008\r\n\r\nPS /home/remi> Measure-Command { ConvertTo-Json $s_object }                                                                                                                                             \r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 0\r\nMilliseconds      : 21\r\nTicks             : 217720\r\nTotalDays         : 2,51990740740741E-07\r\nTotalHours        : 6,04777777777778E-06\r\nTotalMinutes      : 0,000362866666666667\r\nTotalSeconds      : 0,021772\r\nTotalMilliseconds : 21,772\r\n```\r\n\r\n* Windows Server 2008 R2 : \r\n\r\n```\r\nPowerCLI C:\\> $s = get-vm | get-snapshot\r\nPowerCLI C:\\> Measure-Command { $s_json = ConvertTo-Json $s }\r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 1\r\nMilliseconds      : 709\r\nTicks             : 17098683\r\nTotalDays         : 1,97901423611111E-05\r\nTotalHours        : 0,000474963416666667\r\nTotalMinutes      : 0,028497805\r\nTotalSeconds      : 1,7098683\r\nTotalMilliseconds : 1709,8683\r\n\r\nPowerCLI C:\\> Measure-Command { $s_object = ConvertFrom-Json $s_json }\r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 0\r\nMilliseconds      : 9\r\nTicks             : 96520\r\nTotalDays         : 1,11712962962963E-07\r\nTotalHours        : 2,68111111111111E-06\r\nTotalMinutes      : 0,000160866666666667\r\nTotalSeconds      : 0,009652\r\nTotalMilliseconds : 9,652\r\n\r\nPowerCLI C:\\> Measure-Command { ConvertTo-Json $s_object }\r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 0\r\nMilliseconds      : 4\r\nTicks             : 47554\r\nTotalDays         : 5,50393518518518E-08\r\nTotalHours        : 1,32094444444444E-06\r\nTotalMinutes      : 7,92566666666667E-05\r\nTotalSeconds      : 0,0047554\r\nTotalMilliseconds : 4,7554\r\n```\r\n",
    "created_at": "2017-06-27T10:06:45Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3790#issuecomment-311313803",
    "id": 311313803,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3790",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxMTMxMzgwMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/311313803/reactions"
    },
    "updated_at": "2017-06-30T09:57:58Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/311313803",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11832241?v=4",
      "events_url": "https://api.github.com/users/remi13131/events{/privacy}",
      "followers_url": "https://api.github.com/users/remi13131/followers",
      "following_url": "https://api.github.com/users/remi13131/following{/other_user}",
      "gists_url": "https://api.github.com/users/remi13131/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/remi13131",
      "id": 11832241,
      "login": "remi13131",
      "node_id": "MDQ6VXNlcjExODMyMjQx",
      "organizations_url": "https://api.github.com/users/remi13131/orgs",
      "received_events_url": "https://api.github.com/users/remi13131/received_events",
      "repos_url": "https://api.github.com/users/remi13131/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/remi13131/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/remi13131/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/remi13131"
    }
  },
  {
    "author_association": "NONE",
    "body": "---------------------------------------------------------------------------------------------------\r\n> can you please save following test in a script file and run it on Windows and Linux machines and reply with results; thank you:\r\n\r\n* Windows Server 2008 R2 : \r\n\r\n```\r\nPowerCLI C:\\Scripts\\performancePozershellTest> .\\testFromGithub.ps1\r\nRunning for 500 objects\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      4.0\r\nWSManStackVersion              3.0\r\nSerializationVersion           1.1.0.1\r\nCLRVersion                     4.0.30319.42000\r\nBuildVersion                   6.3.9600.16406\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0}\r\nPSRemotingProtocolVersion      2.2\r\n\r\nTicks             : 9595839\r\nDays              : 0\r\nHours             : 0\r\nMilliseconds      : 959\r\nMinutes           : 0\r\nSeconds           : 0\r\nTotalDays         : 1,11062951388889E-05\r\nTotalHours        : 0,000266551083333333\r\nTotalMilliseconds : 959,5839\r\nTotalMinutes      : 0,015993065\r\nTotalSeconds      : 0,9595839\r\n```\r\n\r\n* Ubuntu 16.04 : \r\n\r\n```\r\nPS /home/remi/Documents/other/Slow-Powershell> ./testFromGithub.ps1                                                                                                                                         \r\nRunning for 500 objects\r\n\r\nName                           Value                                                                                                                                                                       \r\n----                           -----                                                                                                                                                                       \r\nPSVersion                      6.0.0-alpha                                                                                                                                                                 \r\nPSEdition                      Core                                                                                                                                                                        \r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}                                                                                                                                                     \r\nBuildVersion                   3.0.0.0                                                                                                                                                                     \r\nGitCommitId                    v6.0.0-alpha.17                                                                                                                                                             \r\nCLRVersion                                                                                                                                                                                                 \r\nWSManStackVersion              3.0                                                                                                                                                                         \r\nPSRemotingProtocolVersion      2.3                                                                                                                                                                         \r\nSerializationVersion           1.1.0.1                                                                                                                                                                     \r\n\r\nTicks             : 12933586\r\nDays              : 0\r\nHours             : 0\r\nMilliseconds      : 293\r\nMinutes           : 0\r\nSeconds           : 1\r\nTotalDays         : 1.49694282407407E-05\r\nTotalHours        : 0.000359266277777778\r\nTotalMilliseconds : 1293.3586\r\nTotalMinutes      : 0.0215559766666667\r\nTotalSeconds      : 1.2933586\r\n```\r\n\r\n* Debian 8 :\r\n\r\n```\r\nPS /home/remi> ./testFromGithub.ps1                                                                                                                                                                     \r\nRunning for 500 objects\r\n\r\nName                           Value                                                                                                                                                                       \r\n----                           -----                                                                                                                                                                       \r\nPSVersion                      6.0.0-alpha                                                                                                                                                                 \r\nPSEdition                      Core                                                                                                                                                                        \r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}                                                                                                                                                     \r\nBuildVersion                   3.0.0.0                                                                                                                                                                     \r\nGitCommitId                    v6.0.0-alpha.18                                                                                                                                                             \r\nCLRVersion                                                                                                                                                                                                 \r\nWSManStackVersion              3.0                                                                                                                                                                         \r\nPSRemotingProtocolVersion      2.3                                                                                                                                                                         \r\nSerializationVersion           1.1.0.1                                                                                                                                                                     \r\n\r\nTicks             : 22453753\r\nDays              : 0\r\nHours             : 0\r\nMilliseconds      : 245\r\nMinutes           : 0\r\nSeconds           : 2\r\nTotalDays         : 2,59881400462963E-05\r\nTotalHours        : 0,000623715361111111\r\nTotalMilliseconds : 2245,3753\r\nTotalMinutes      : 0,0374229216666667\r\nTotalSeconds      : 2,2453753\r\n```",
    "created_at": "2017-06-27T10:07:33Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3790#issuecomment-311313990",
    "id": 311313990,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3790",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxMTMxMzk5MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/311313990/reactions"
    },
    "updated_at": "2017-06-30T09:58:14Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/311313990",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11832241?v=4",
      "events_url": "https://api.github.com/users/remi13131/events{/privacy}",
      "followers_url": "https://api.github.com/users/remi13131/followers",
      "following_url": "https://api.github.com/users/remi13131/following{/other_user}",
      "gists_url": "https://api.github.com/users/remi13131/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/remi13131",
      "id": 11832241,
      "login": "remi13131",
      "node_id": "MDQ6VXNlcjExODMyMjQx",
      "organizations_url": "https://api.github.com/users/remi13131/orgs",
      "received_events_url": "https://api.github.com/users/remi13131/received_events",
      "repos_url": "https://api.github.com/users/remi13131/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/remi13131/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/remi13131/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/remi13131"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "Can you guys make sure you are testing with beta.3?  We added a bunch of additional assemblies that we crossgen to avoid JIT (Just in Time compilation at runtime which explains why the second time it's faster) including Newtonsoft.Json.dll.",
    "created_at": "2017-06-27T16:05:00Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3790#issuecomment-311405502",
    "id": 311405502,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3790",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxMTQwNTUwMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/311405502/reactions"
    },
    "updated_at": "2017-06-27T16:05:00Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/311405502",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "NONE",
    "body": "Unfortunately, PowerCLI isn't runnable with Beta https://labs.vmware.com/flings/powercli-core/bugs/461 so I can't test it with this particular output coming from VMWare's PowerCLI and as I stated I couldn't reproduce this with other objects.\r\n\r\nI hope that they will make PowerCLI compatible soon, or it will be non-usable otherwise. \r\n\r\nMaybe is there a way to store my Object as Binary in a file using Alpha.17 and run tests in Beta.3 importing this object just to check if this issue is resolved after Alpha.18 ?",
    "created_at": "2017-06-28T07:52:19Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3790#issuecomment-311584814",
    "id": 311584814,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3790",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxMTU4NDgxNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/311584814/reactions"
    },
    "updated_at": "2017-06-28T07:55:08Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/311584814",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11832241?v=4",
      "events_url": "https://api.github.com/users/remi13131/events{/privacy}",
      "followers_url": "https://api.github.com/users/remi13131/followers",
      "following_url": "https://api.github.com/users/remi13131/following{/other_user}",
      "gists_url": "https://api.github.com/users/remi13131/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/remi13131",
      "id": 11832241,
      "login": "remi13131",
      "node_id": "MDQ6VXNlcjExODMyMjQx",
      "organizations_url": "https://api.github.com/users/remi13131/orgs",
      "received_events_url": "https://api.github.com/users/remi13131/received_events",
      "repos_url": "https://api.github.com/users/remi13131/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/remi13131/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/remi13131/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/remi13131"
    }
  },
  {
    "author_association": "NONE",
    "body": "So I tried exporting then importing, firstly in the same environment (Alpha.17) and apparently the latency will also occur with Export-CliXml, but somehow it corrects itself when importing and the ConvertTo-Json will not be slow then... \r\n\r\n```\r\nPS /home/remi/Documents/other/Slow-Powershell> $s = get-vm | get-snapshot                                                                                                                                   \r\nPS /home/remi/Documents/other/Slow-Powershell> $s | Export-Clixml s-test.xml                                                                                                                                \r\nPS /home/remi/Documents/other/Slow-Powershell> $sCliXml = Import-CliXml ./s-test.xml                                                                                                                        \r\nPS /home/remi/Documents/other/Slow-Powershell> Measure-Command { ConvertTo-Json $sCliXml }                                                                                                                  \r\n\r\n\r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 0\r\nMilliseconds      : 238\r\nTicks             : 2385046\r\nTotalDays         : 2.76046990740741E-06\r\nTotalHours        : 6.62512777777778E-05\r\nTotalMinutes      : 0.00397507666666667\r\nTotalSeconds      : 0.2385046\r\nTotalMilliseconds : 238.5046\r\n\r\nPS /home/remi/Documents/other/Slow-Powershell> Measure-Command { $s | Export-Clixml s-test.xml }                                                                                                            \r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 0\r\nMilliseconds      : 25\r\nTicks             : 254233\r\nTotalDays         : 2.94251157407407E-07\r\nTotalHours        : 7.06202777777778E-06\r\nTotalMinutes      : 0.000423721666666667\r\nTotalSeconds      : 0.0254233\r\nTotalMilliseconds : 25.4233\r\n\r\nPS /home/remi/Documents/other/Slow-Powershell> $s2 | Export-Clixml s-test.xml                                                                                                                               \r\nPS /home/remi/Documents/other/Slow-Powershell> $s2 = get-vm | get-snapshot                                                                                                                                  \r\nPS /home/remi/Documents/other/Slow-Powershell> Measure-Command { $s2 | Export-Clixml s-test.xml }                                                                                                           \r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 28\r\nMilliseconds      : 831\r\nTicks             : 288313672\r\nTotalDays         : 0.00033369637962963\r\nTotalHours        : 0.00800871311111111\r\nTotalMinutes      : 0.480522786666667\r\nTotalSeconds      : 28.8313672\r\nTotalMilliseconds : 28831.3672\r\n```",
    "created_at": "2017-06-28T08:11:24Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3790#issuecomment-311588811",
    "id": 311588811,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3790",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxMTU4ODgxMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/311588811/reactions"
    },
    "updated_at": "2017-06-28T08:42:34Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/311588811",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11832241?v=4",
      "events_url": "https://api.github.com/users/remi13131/events{/privacy}",
      "followers_url": "https://api.github.com/users/remi13131/followers",
      "following_url": "https://api.github.com/users/remi13131/following{/other_user}",
      "gists_url": "https://api.github.com/users/remi13131/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/remi13131",
      "id": 11832241,
      "login": "remi13131",
      "node_id": "MDQ6VXNlcjExODMyMjQx",
      "organizations_url": "https://api.github.com/users/remi13131/orgs",
      "received_events_url": "https://api.github.com/users/remi13131/received_events",
      "repos_url": "https://api.github.com/users/remi13131/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/remi13131/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/remi13131/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/remi13131"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "@SteveL-MSFT That is good info but I doubt that beta.3 will have different results, because if it was a JIT issue then it would show up on any data, but it seems to be limited to VMWare's PowerCLI. Also I think it is unlikely that on a reasonably good hardware that @remi13131 is using JIT can be responsible for over half-a-minute delays...\r\n\r\n@remi13131 Thank you very much for detailed info! At this point I suspect there is some networking with caching going on (or there is simply a bug) in PowerCLI's property accessors. Let's try removing serialization cmdlets out of the picture and measure simple property access - please run the code below (remember to use fresh/new PS session for each run). If delay reproes, then you can remove Measure-Command wrapping in the last line and it will print property name before accessing it's value, so the last printed property before the delay is the one responsible for it.\r\n```\r\n$snapshotArray = get-vm | get-snapshot\r\n$propNames = ($snapshotArray[0] | Get-Member -Type Property).Name\r\nMeasure-Command { foreach($s in $snapshotArray) { foreach($p in $propNames) {$p; $s.$p }} }\r\n```",
    "created_at": "2017-06-29T22:14:25Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3790#issuecomment-312123288",
    "id": 312123288,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3790",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxMjEyMzI4OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/312123288/reactions"
    },
    "updated_at": "2017-06-29T22:14:25Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/312123288",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11860095?v=4",
      "events_url": "https://api.github.com/users/anmenaga/events{/privacy}",
      "followers_url": "https://api.github.com/users/anmenaga/followers",
      "following_url": "https://api.github.com/users/anmenaga/following{/other_user}",
      "gists_url": "https://api.github.com/users/anmenaga/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/anmenaga",
      "id": 11860095,
      "login": "anmenaga",
      "node_id": "MDQ6VXNlcjExODYwMDk1",
      "organizations_url": "https://api.github.com/users/anmenaga/orgs",
      "received_events_url": "https://api.github.com/users/anmenaga/received_events",
      "repos_url": "https://api.github.com/users/anmenaga/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/anmenaga/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/anmenaga/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/anmenaga"
    }
  },
  {
    "author_association": "NONE",
    "body": "Thank you very much to you both for looking deep in this problem! \r\n\r\nI ran your tests in the different environments. As you can see there is not much data in there (I added counts)... Still experiencing same delays : \r\n\r\n* Debian 8 : \r\n\r\n```\r\nPS /home/remi> $snapshotArray = get-vm | get-snapshot                                                                                                                                                   \r\nPS /home/remi> $propNames = ($snapshotArray[0] | Get-Member -Type Property).Name                                                                                                                        \r\nPS /home/remi> Measure-Command { foreach($s in $snapshotArray) { foreach($p in $propNames) {$p; $s.$p }} }                                                                                              \r\n\r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 10\r\nMilliseconds      : 74\r\nTicks             : 100744426\r\nTotalDays         : 0,000116602344907407\r\nTotalHours        : 0,00279845627777778\r\nTotalMinutes      : 0,167907376666667\r\nTotalSeconds      : 10,0744426\r\nTotalMilliseconds : 10074,4426\r\n\r\nPS /home/remi> $snapshotArray.count                                                                                                                                                                         \r\n9\r\nPS /home/remi> $propNames.count                                                                                                                                                                             \r\n19\r\n```\r\n\r\n* Ubuntu 16.04 : \r\n\r\n```\r\nPS /home/remi> $snapshotArray = get-vm | get-snapshot                                                                                                                                                       \r\nPS /home/remi> $propNames = ($snapshotArray[0] | Get-Member -Type Property).Name                                                                                                                            \r\nPS /home/remi> Measure-Command { foreach($s in $snapshotArray) { foreach($p in $propNames) {$p; $s.$p }} }                                                                                                  \r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 8\r\nMilliseconds      : 784\r\nTicks             : 87848962\r\nTotalDays         : 0.000101677039351852\r\nTotalHours        : 0.00244024894444444\r\nTotalMinutes      : 0.146414936666667\r\nTotalSeconds      : 8.7848962\r\nTotalMilliseconds : 8784.8962\r\n\r\nPS /home/remi> $snapshotArray.count                                                                                                                                                                         \r\n9\r\nPS /home/remi> $propNames.count                                                                                                                                                                             \r\n19\r\n```\r\n\r\n* Windows server 2008 R2 :\r\n\r\n```\r\nPowerCLI C:\\> $snapshotArray = get-vm | get-snapshot\r\nPowerCLI C:\\> $propNames = ($snapshotArray[0] | Get-Member -Type Property).Name\r\nPowerCLI C:\\> Measure-Command { foreach($s in $snapshotArray) { foreach($p in $propNames) {$p; $s.$p }} }\r\n\r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 0\r\nMilliseconds      : 933\r\nTicks             : 9334658\r\nTotalDays         : 1,08040023148148E-05\r\nTotalHours        : 0,000259296055555556\r\nTotalMinutes      : 0,0155577633333333\r\nTotalSeconds      : 0,9334658\r\nTotalMilliseconds : 933,4658\r\n\r\nPowerCLI C:\\> $snapshotArray.count\r\n9\r\nPowerCLI C:\\> $propNames.count\r\n19\r\n```",
    "created_at": "2017-06-30T08:23:19Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3790#issuecomment-312207104",
    "id": 312207104,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3790",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxMjIwNzEwNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/312207104/reactions"
    },
    "updated_at": "2017-06-30T09:58:32Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/312207104",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11832241?v=4",
      "events_url": "https://api.github.com/users/remi13131/events{/privacy}",
      "followers_url": "https://api.github.com/users/remi13131/followers",
      "following_url": "https://api.github.com/users/remi13131/following{/other_user}",
      "gists_url": "https://api.github.com/users/remi13131/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/remi13131",
      "id": 11832241,
      "login": "remi13131",
      "node_id": "MDQ6VXNlcjExODMyMjQx",
      "organizations_url": "https://api.github.com/users/remi13131/orgs",
      "received_events_url": "https://api.github.com/users/remi13131/received_events",
      "repos_url": "https://api.github.com/users/remi13131/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/remi13131/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/remi13131/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/remi13131"
    }
  },
  {
    "author_association": "NONE",
    "body": "I ran ```foreach($s in $snapshotArray) { foreach($p in $propNames) {$p; Measure-Command { $s.$p } }}```\r\n\r\nAnd... That's it ! I was able to narrow down the problem to the VM property, that was taking more than 1 second for each snapshots... Looks like some problems at PowerCLI. I will open a bug at there tracker then !  \r\n\r\nProof : \r\n\r\n* On linux : \r\n\r\n```\r\nPS /home/remi> $snapshotArray = get-vm | get-snapshot                                                                                                                                                   \r\nPS /home/remi> $propNames = ($snapshotArray[0] | Get-Member -Type Property).Name                                                                                                                        \r\nPS /home/remi> Measure-Command { foreach($s in $snapshotArray) { foreach($p in $propNames) { if($p -ne 'VM' ) { $p; $s.$p } } } }                                                                       \r\n\r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 0\r\nMilliseconds      : 714\r\nTicks             : 7147384\r\nTotalDays         : 8,27243518518518E-06\r\nTotalHours        : 0,000198538444444444\r\nTotalMinutes      : 0,0119123066666667\r\nTotalSeconds      : 0,7147384\r\nTotalMilliseconds : 714,7384\r\n\r\nPS /home/remi> Measure-Command { foreach($s in $snapshotArray) { foreach($p in $propNames) { $p; $s.$p } } }                                                                                            \r\n\r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 9\r\nMilliseconds      : 289\r\nTicks             : 92898717\r\nTotalDays         : 0,000107521663194444\r\nTotalHours        : 0,00258051991666667\r\nTotalMinutes      : 0,154831195\r\nTotalSeconds      : 9,2898717\r\nTotalMilliseconds : 9289,8717\r\n```\r\n\r\n* On windows : \r\n\r\n```\r\nPowerCLI C:\\> Measure-Command { foreach($s in $snapshotArray) { foreach($p in $propNames) { $p; $s.$p } } }\r\n\r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 0\r\nMilliseconds      : 253\r\nTicks             : 2533608\r\nTotalDays         : 2,93241666666667E-06\r\nTotalHours        : 7,0378E-05\r\nTotalMinutes      : 0,00422268\r\nTotalSeconds      : 0,2533608\r\nTotalMilliseconds : 253,3608\r\n\r\nPowerCLI C:\\> Measure-Command { foreach($s in $snapshotArray) { foreach($p in $propNames) { if($p -ne 'VM' ) { $p; $s.$p } } } }\r\n\r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 0\r\nMilliseconds      : 4\r\nTicks             : 44530\r\nTotalDays         : 5,15393518518518E-08\r\nTotalHours        : 1,23694444444444E-06\r\nTotalMinutes      : 7,42166666666667E-05\r\nTotalSeconds      : 0,004453\r\nTotalMilliseconds : 4,453\r\n```\r\n\r\nSo Windows is still slightly faster for all the other props, with ~5ms compared to ~715 in Linux, but it is not a huge 9 seconds gap anymore. \r\n\r\nSo really thank you very much for your time, apologies for wasting it because now it is resolved I feel like this question belonged to StackOverflow more than Github... ",
    "created_at": "2017-06-30T09:25:48Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/3790#issuecomment-312220517",
    "id": 312220517,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/3790",
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxMjIyMDUxNw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/312220517/reactions"
    },
    "updated_at": "2017-06-30T09:26:14Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/312220517",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11832241?v=4",
      "events_url": "https://api.github.com/users/remi13131/events{/privacy}",
      "followers_url": "https://api.github.com/users/remi13131/followers",
      "following_url": "https://api.github.com/users/remi13131/following{/other_user}",
      "gists_url": "https://api.github.com/users/remi13131/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/remi13131",
      "id": 11832241,
      "login": "remi13131",
      "node_id": "MDQ6VXNlcjExODMyMjQx",
      "organizations_url": "https://api.github.com/users/remi13131/orgs",
      "received_events_url": "https://api.github.com/users/remi13131/received_events",
      "repos_url": "https://api.github.com/users/remi13131/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/remi13131/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/remi13131/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/remi13131"
    }
  }
]

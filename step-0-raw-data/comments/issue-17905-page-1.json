[
  {
    "author_association": "COLLABORATOR",
    "body": "I think this is an issue that should have been raised on the [Winget Packages repo](https://github.com/microsoft/winget-pkgs) and not here as the PowerShell team do not own the install process via winget & as such I am closing this issue.",
    "created_at": "2022-08-16T02:47:50Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17905#issuecomment-1216082225",
    "id": 1216082225,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17905",
    "node_id": "IC_kwDOAvT7bc5Ie_Ex",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1216082225/reactions"
    },
    "updated_at": "2022-08-16T02:47:50Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1216082225",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/6355225?v=4",
      "events_url": "https://api.github.com/users/kilasuit/events{/privacy}",
      "followers_url": "https://api.github.com/users/kilasuit/followers",
      "following_url": "https://api.github.com/users/kilasuit/following{/other_user}",
      "gists_url": "https://api.github.com/users/kilasuit/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/kilasuit",
      "id": 6355225,
      "login": "kilasuit",
      "node_id": "MDQ6VXNlcjYzNTUyMjU=",
      "organizations_url": "https://api.github.com/users/kilasuit/orgs",
      "received_events_url": "https://api.github.com/users/kilasuit/received_events",
      "repos_url": "https://api.github.com/users/kilasuit/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/kilasuit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kilasuit/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/kilasuit"
    }
  },
  {
    "author_association": "NONE",
    "body": "This does indeed appear to be a Powershell issue according to the logs (which i also just replicated)\r\nPowershell version 7.2.5.0 reports to be installed as a EXE instead of a MSI/MSIX installer\r\n\r\n```\r\n2022-08-16 19:40:00.933 [CLI ] Starting installer selection.\r\n2022-08-16 19:40:00.933 [CLI ] Installer [X64,wix,Machine,] not applicable: Installed package type 'exe' is not compatible with installer type wix\r\n2022-08-16 19:40:00.933 [CLI ] Installer [X86,wix,Machine,] not applicable: Installed package type 'exe' is not compatible with installer type wix\r\n2022-08-16 19:40:00.933 [CLI ] Installer [Arm,msix,Machine,] not applicable: Installed package type 'exe' is not compatible with installer type msix\r\n2022-08-16 19:40:00.933 [CLI ] Installer [Arm,msix,Machine,] not applicable: Machine is not compatible with Arm\r\n2022-08-16 19:40:00.933 [CLI ] Installer [Arm64,msix,Machine,] not applicable: Installed package type 'exe' is not compatible with installer type msix\r\n2022-08-16 19:40:00.933 [CLI ] Installer [Arm64,msix,Machine,] not applicable: Machine is not compatible with Arm64\r\n2022-08-16 19:40:00.933 [CLI ] Installer [X86,msix,Machine,] not applicable: Installed package type 'exe' is not compatible with installer type msix\r\n2022-08-16 19:40:00.933 [CLI ] Installer [X64,msix,Machine,] not applicable: Installed package type 'exe' is not compatible with installer type msix\r\n```\r\n\r\nPlease don't stick your head into the sand before checking the easy to read logs next time :)\r\nIF you are going to say \"We've changed how the installer works\", how would we know?\r\n\r\nEdit: this is the registry key that triggers it\r\n```\r\nWindows Registry Editor Version 5.00\r\n\r\n[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\{9d71ada8-ab44-42bb-bee1-ac136a49f1af}]\r\n\"BundleCachePath\"=\"C:\\\\ProgramData\\\\Package Cache\\\\{9d71ada8-ab44-42bb-bee1-ac136a49f1af}\\\\PowerShell-7.2.5-win-x64.exe\"\r\n\"BundleUpgradeCode\"=hex(7):7b,00,37,00,41,00,38,00,30,00,34,00,43,00,42,00,42,\\\r\n  00,2d,00,36,00,34,00,38,00,45,00,2d,00,34,00,32,00,37,00,36,00,2d,00,39,00,\\\r\n  41,00,35,00,38,00,2d,00,30,00,38,00,31,00,38,00,36,00,32,00,44,00,42,00,31,\\\r\n  00,42,00,39,00,39,00,7d,00,00,00,00,00\r\n\"BundleAddonCode\"=hex(7):\r\n\"BundleDetectCode\"=hex(7):\r\n\"BundlePatchCode\"=hex(7):\r\n\"BundleVersion\"=\"7.2.5.0\"\r\n\"VersionMajor\"=dword:00000007\r\n\"VersionMinor\"=dword:00000002\r\n\"BundleProviderKey\"=\"{9d71ada8-ab44-42bb-bee1-ac136a49f1af}\"\r\n\"BundleTag\"=\"\"\r\n\"EngineVersion\"=\"3.11.2.4516\"\r\n\"DisplayIcon\"=\"C:\\\\ProgramData\\\\Package Cache\\\\{9d71ada8-ab44-42bb-bee1-ac136a49f1af}\\\\PowerShell-7.2.5-win-x64.exe,0\"\r\n\"DisplayName\"=\"PowerShell 7.2.5.0-x64\"\r\n\"DisplayVersion\"=\"7.2.5.0\"\r\n\"Publisher\"=\"Microsoft Corporation\"\r\n\"ModifyPath\"=\"\\\"C:\\\\ProgramData\\\\Package Cache\\\\{9d71ada8-ab44-42bb-bee1-ac136a49f1af}\\\\PowerShell-7.2.5-win-x64.exe\\\" /modify\"\r\n\"NoElevateOnModify\"=dword:00000001\r\n\"QuietUninstallString\"=\"\\\"C:\\\\ProgramData\\\\Package Cache\\\\{9d71ada8-ab44-42bb-bee1-ac136a49f1af}\\\\PowerShell-7.2.5-win-x64.exe\\\" /uninstall /quiet\"\r\n\"UninstallString\"=\"\\\"C:\\\\ProgramData\\\\Package Cache\\\\{9d71ada8-ab44-42bb-bee1-ac136a49f1af}\\\\PowerShell-7.2.5-win-x64.exe\\\"  /uninstall\"\r\n\"EstimatedSize\"=dword:000596f8\r\n\"Resume\"=dword:00000003\r\n\"Installed\"=dword:00000001\r\n```\r\n",
    "created_at": "2022-08-16T17:58:48Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/17905#issuecomment-1216969259",
    "id": 1216969259,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/17905",
    "node_id": "IC_kwDOAvT7bc5IiXor",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1216969259/reactions"
    },
    "updated_at": "2022-08-18T12:59:27Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1216969259",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/15158490?v=4",
      "events_url": "https://api.github.com/users/OfficialEsco/events{/privacy}",
      "followers_url": "https://api.github.com/users/OfficialEsco/followers",
      "following_url": "https://api.github.com/users/OfficialEsco/following{/other_user}",
      "gists_url": "https://api.github.com/users/OfficialEsco/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/OfficialEsco",
      "id": 15158490,
      "login": "OfficialEsco",
      "node_id": "MDQ6VXNlcjE1MTU4NDkw",
      "organizations_url": "https://api.github.com/users/OfficialEsco/orgs",
      "received_events_url": "https://api.github.com/users/OfficialEsco/received_events",
      "repos_url": "https://api.github.com/users/OfficialEsco/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/OfficialEsco/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/OfficialEsco/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/OfficialEsco"
    }
  }
]

[
  {
    "author_association": "NONE",
    "body": "I don't think this is specific to your script.\r\n\r\nDefender has quarantined my `profile.ps1`! \r\n\r\n![image](https://user-images.githubusercontent.com/585482/118169474-d5bcda00-b3dd-11eb-94a0-0cda73de283d.png)\r\n\r\n\r\nThis is insane.",
    "created_at": "2021-05-13T18:24:36Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15396#issuecomment-840745034",
    "id": 840745034,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15396",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MDc0NTAzNA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 2,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/840745034/reactions"
    },
    "updated_at": "2021-05-13T18:24:59Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/840745034",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/585482?v=4",
      "events_url": "https://api.github.com/users/tig/events{/privacy}",
      "followers_url": "https://api.github.com/users/tig/followers",
      "following_url": "https://api.github.com/users/tig/following{/other_user}",
      "gists_url": "https://api.github.com/users/tig/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/tig",
      "id": 585482,
      "login": "tig",
      "node_id": "MDQ6VXNlcjU4NTQ4Mg==",
      "organizations_url": "https://api.github.com/users/tig/orgs",
      "received_events_url": "https://api.github.com/users/tig/received_events",
      "repos_url": "https://api.github.com/users/tig/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/tig/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tig/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/tig"
    }
  },
  {
    "author_association": "NONE",
    "body": "Crushing, @tig! Hopefully this gets fixed soon.\r\n\r\nIt was suggested that I ping @SteveL-MSFT and @PaulHigin to ask if they can get the MS Defender team to scan the GitHub Repos of popular community modules help teach the ML.",
    "created_at": "2021-05-13T19:14:43Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15396#issuecomment-840774602",
    "id": 840774602,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15396",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MDc3NDYwMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/840774602/reactions"
    },
    "updated_at": "2021-05-13T19:15:51Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/840774602",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8278033?v=4",
      "events_url": "https://api.github.com/users/potatoqualitee/events{/privacy}",
      "followers_url": "https://api.github.com/users/potatoqualitee/followers",
      "following_url": "https://api.github.com/users/potatoqualitee/following{/other_user}",
      "gists_url": "https://api.github.com/users/potatoqualitee/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/potatoqualitee",
      "id": 8278033,
      "login": "potatoqualitee",
      "node_id": "MDQ6VXNlcjgyNzgwMzM=",
      "organizations_url": "https://api.github.com/users/potatoqualitee/orgs",
      "received_events_url": "https://api.github.com/users/potatoqualitee/received_events",
      "repos_url": "https://api.github.com/users/potatoqualitee/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/potatoqualitee/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/potatoqualitee/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/potatoqualitee"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "The Defender team continuously refines and update their heuristics to detect potential malicious scripts.  I don't think there's a way to validate one moment in time and ensure it'll always pass detection (as the rules keep changing/improving) with the exception of signing it with the Windows certificate (yeah, that's not going to happen!).\r\n\r\nI'm pretty sure the Defender team already uses GitHub Open Source code as a resource, but I don't think they can just give any projects a free pass as you can't guarantee that a well known and popular piece of code doesn't get attacked and malicious code gets added.  See [this article](https://thenewstack.io/github-open-source-projects-entangled-by-the-octopus-malware-scanner/) as one example.\r\n",
    "created_at": "2021-05-13T22:10:59Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15396#issuecomment-840864633",
    "id": 840864633,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15396",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MDg2NDYzMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/840864633/reactions"
    },
    "updated_at": "2021-05-13T22:11:32Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/840864633",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11859881?v=4",
      "events_url": "https://api.github.com/users/SteveL-MSFT/events{/privacy}",
      "followers_url": "https://api.github.com/users/SteveL-MSFT/followers",
      "following_url": "https://api.github.com/users/SteveL-MSFT/following{/other_user}",
      "gists_url": "https://api.github.com/users/SteveL-MSFT/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/SteveL-MSFT",
      "id": 11859881,
      "login": "SteveL-MSFT",
      "node_id": "MDQ6VXNlcjExODU5ODgx",
      "organizations_url": "https://api.github.com/users/SteveL-MSFT/orgs",
      "received_events_url": "https://api.github.com/users/SteveL-MSFT/received_events",
      "repos_url": "https://api.github.com/users/SteveL-MSFT/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/SteveL-MSFT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SteveL-MSFT/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/SteveL-MSFT"
    }
  },
  {
    "author_association": "NONE",
    "body": "Thank you for the detailed response. Is there any way you can engage the Defender team to get a confirmation either way?",
    "created_at": "2021-05-13T22:31:03Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15396#issuecomment-840872389",
    "id": 840872389,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15396",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MDg3MjM4OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/840872389/reactions"
    },
    "updated_at": "2021-05-13T22:31:03Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/840872389",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8278033?v=4",
      "events_url": "https://api.github.com/users/potatoqualitee/events{/privacy}",
      "followers_url": "https://api.github.com/users/potatoqualitee/followers",
      "following_url": "https://api.github.com/users/potatoqualitee/following{/other_user}",
      "gists_url": "https://api.github.com/users/potatoqualitee/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/potatoqualitee",
      "id": 8278033,
      "login": "potatoqualitee",
      "node_id": "MDQ6VXNlcjgyNzgwMzM=",
      "organizations_url": "https://api.github.com/users/potatoqualitee/orgs",
      "received_events_url": "https://api.github.com/users/potatoqualitee/received_events",
      "repos_url": "https://api.github.com/users/potatoqualitee/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/potatoqualitee/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/potatoqualitee/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/potatoqualitee"
    }
  },
  {
    "author_association": "NONE",
    "body": "> The Defender team continuously refines and update their heuristics to detect potential malicious scripts. I don't think there's a way to validate one moment in time and ensure it'll always pass detection (as the rules keep changing/improving) with the exception of signing it with the Windows certificate (yeah, that's not going to happen!).\r\n> \r\n> I'm pretty sure the Defender team already uses GitHub Open Source code as a resource, but I don't think they can just give any projects a free pass as you can't guarantee that a well known and popular piece of code doesn't get attacked and malicious code gets added. See [this article](https://thenewstack.io/github-open-source-projects-entangled-by-the-octopus-malware-scanner/) as one example.\r\n\r\nBut @SteveL-MSFT, the fact that my PROFILE ps1 gets literally deleted by Defender is way different than Defender flagging ps1s that are actually found in the wild.\r\n\r\nI've had to disable Defender's scanning for this vuln to keep it from deleting my PowerShell profile! \r\n\r\nI can't believe I'm the only person this is happening to!",
    "created_at": "2021-05-13T23:33:06Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15396#issuecomment-840893733",
    "id": 840893733,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15396",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MDg5MzczMw==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/840893733/reactions"
    },
    "updated_at": "2021-05-13T23:33:06Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/840893733",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/585482?v=4",
      "events_url": "https://api.github.com/users/tig/events{/privacy}",
      "followers_url": "https://api.github.com/users/tig/followers",
      "following_url": "https://api.github.com/users/tig/following{/other_user}",
      "gists_url": "https://api.github.com/users/tig/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/tig",
      "id": 585482,
      "login": "tig",
      "node_id": "MDQ6VXNlcjU4NTQ4Mg==",
      "organizations_url": "https://api.github.com/users/tig/orgs",
      "received_events_url": "https://api.github.com/users/tig/received_events",
      "repos_url": "https://api.github.com/users/tig/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/tig/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tig/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/tig"
    }
  },
  {
    "author_association": "NONE",
    "body": "> I can't believe I'm the only person this is happening to!\r\n\r\nYou're not. Our TeamCity builds started failing across the board two days ago after a Windows 10 security update. To get builds running again we had to disable real-time protection. Which was deemed acceptable in the short-term while IT works on bringing on a new AV system that is not Windows Defender.",
    "created_at": "2021-05-13T23:37:20Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15396#issuecomment-840895271",
    "id": 840895271,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15396",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MDg5NTI3MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 2,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 2,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/840895271/reactions"
    },
    "updated_at": "2021-05-13T23:37:20Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/840895271",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/815037?v=4",
      "events_url": "https://api.github.com/users/regner/events{/privacy}",
      "followers_url": "https://api.github.com/users/regner/followers",
      "following_url": "https://api.github.com/users/regner/following{/other_user}",
      "gists_url": "https://api.github.com/users/regner/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/regner",
      "id": 815037,
      "login": "regner",
      "node_id": "MDQ6VXNlcjgxNTAzNw==",
      "organizations_url": "https://api.github.com/users/regner/orgs",
      "received_events_url": "https://api.github.com/users/regner/received_events",
      "repos_url": "https://api.github.com/users/regner/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/regner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/regner/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/regner"
    }
  },
  {
    "author_association": "NONE",
    "body": "I saw this too. any recommended actions ?\r\n![psvirus](https://user-images.githubusercontent.com/52312085/118289904-70c7b980-b49b-11eb-9280-8efd6d2f09b1.jpg)\r\n",
    "created_at": "2021-05-14T15:02:13Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15396#issuecomment-841299212",
    "id": 841299212,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15396",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MTI5OTIxMg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/841299212/reactions"
    },
    "updated_at": "2021-05-14T15:02:13Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/841299212",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/52312085?v=4",
      "events_url": "https://api.github.com/users/gsaluja9/events{/privacy}",
      "followers_url": "https://api.github.com/users/gsaluja9/followers",
      "following_url": "https://api.github.com/users/gsaluja9/following{/other_user}",
      "gists_url": "https://api.github.com/users/gsaluja9/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/gsaluja9",
      "id": 52312085,
      "login": "gsaluja9",
      "node_id": "MDQ6VXNlcjUyMzEyMDg1",
      "organizations_url": "https://api.github.com/users/gsaluja9/orgs",
      "received_events_url": "https://api.github.com/users/gsaluja9/received_events",
      "repos_url": "https://api.github.com/users/gsaluja9/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/gsaluja9/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gsaluja9/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/gsaluja9"
    }
  },
  {
    "author_association": "NONE",
    "body": "For the record, I'm getting this issue as well.",
    "created_at": "2021-05-14T20:15:12Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15396#issuecomment-841478185",
    "id": 841478185,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15396",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MTQ3ODE4NQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/841478185/reactions"
    },
    "updated_at": "2021-05-14T20:15:12Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/841478185",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/34243601?v=4",
      "events_url": "https://api.github.com/users/jt-eic/events{/privacy}",
      "followers_url": "https://api.github.com/users/jt-eic/followers",
      "following_url": "https://api.github.com/users/jt-eic/following{/other_user}",
      "gists_url": "https://api.github.com/users/jt-eic/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jt-eic",
      "id": 34243601,
      "login": "jt-eic",
      "node_id": "MDQ6VXNlcjM0MjQzNjAx",
      "organizations_url": "https://api.github.com/users/jt-eic/orgs",
      "received_events_url": "https://api.github.com/users/jt-eic/received_events",
      "repos_url": "https://api.github.com/users/jt-eic/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jt-eic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jt-eic/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jt-eic"
    }
  },
  {
    "author_association": "NONE",
    "body": "@SteveL-MSFT I was just woken up at 3am this morning by alerting because a script we run on a nightly basis on ~10,000 endpoints Defender decided suddenly was a Trojan. This script hasn’t changed in months. These endpoints are in a PCI compliant segregated environment with no domain. This is a real problem. What’s the point of using a particular AV product if the ratio of false positives to legitimate events is high? At some point, it becomes the boy crying wolf.",
    "created_at": "2021-05-15T09:33:09Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15396#issuecomment-841629961",
    "id": 841629961,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15396",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MTYyOTk2MQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/841629961/reactions"
    },
    "updated_at": "2021-05-15T09:33:09Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/841629961",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/55163811?v=4",
      "events_url": "https://api.github.com/users/mackposh/events{/privacy}",
      "followers_url": "https://api.github.com/users/mackposh/followers",
      "following_url": "https://api.github.com/users/mackposh/following{/other_user}",
      "gists_url": "https://api.github.com/users/mackposh/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mackposh",
      "id": 55163811,
      "login": "mackposh",
      "node_id": "MDQ6VXNlcjU1MTYzODEx",
      "organizations_url": "https://api.github.com/users/mackposh/orgs",
      "received_events_url": "https://api.github.com/users/mackposh/received_events",
      "repos_url": "https://api.github.com/users/mackposh/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mackposh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mackposh/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mackposh"
    }
  },
  {
    "author_association": "NONE",
    "body": "Btw, Steve said this on Twitter \n\n> Some folks are getting false positives from Windows Defender recently with their legitimate PowerShell scripts.  We've contacted someone on the Defender team, so hopefully this gets resolved quickly.",
    "created_at": "2021-05-15T15:47:42Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15396#issuecomment-841682480",
    "id": 841682480,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15396",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MTY4MjQ4MA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/841682480/reactions"
    },
    "updated_at": "2021-05-15T15:47:42Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/841682480",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8278033?v=4",
      "events_url": "https://api.github.com/users/potatoqualitee/events{/privacy}",
      "followers_url": "https://api.github.com/users/potatoqualitee/followers",
      "following_url": "https://api.github.com/users/potatoqualitee/following{/other_user}",
      "gists_url": "https://api.github.com/users/potatoqualitee/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/potatoqualitee",
      "id": 8278033,
      "login": "potatoqualitee",
      "node_id": "MDQ6VXNlcjgyNzgwMzM=",
      "organizations_url": "https://api.github.com/users/potatoqualitee/orgs",
      "received_events_url": "https://api.github.com/users/potatoqualitee/received_events",
      "repos_url": "https://api.github.com/users/potatoqualitee/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/potatoqualitee/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/potatoqualitee/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/potatoqualitee"
    }
  },
  {
    "author_association": "NONE",
    "body": "First, apologies to @SteveL-MSFT if my last comment was a little salty. I realize this isn't Powershell's problem directly. For some additional info, the script in question hasn't been touched in 2 years, and after reviewing it looking for anything we were doing that might have triggered AMSI(like direct .Net calls or inline C# type of things), it's as vanilla Powershell as you can probably get. That said, the irony of it all is that this is the script we use to make sure certain file extensions and directories are in Defender's exclusion lists. We are temporarily disabling certain Defender behaviors like real-time network scanning.\n\nI can see why heuristics may have interpreted that behavior as potentially malicious, but if you can't manage Defender policies with the Defender Powershell module then what's the alternative? Again, for our environment, these endpoints are not in a domain and have no network access except for what we specifically allow, so solutions like Group Policy are not an option.\n\nIt would be preferable if Defender had options to customize actions to take for different events. In this case, warn us, but don't quarantine immediately. Understandably, from a security perspective, that increases the potential risk for us, especially if a specific event is actually legitimately malicious. I'd argue though that that is something that we, as an organization, should have processes and solutions in place to handle such an event. \n\nIn our case, due to the segregated nature of our network environment, potential impact is rather low. We can simply replace the affected endpoint(s) without any worry of the compromise being able to spread to other systems, so for us, such a risk may be acceptable. It wouldn't for everyone though, so this is a tricky problem to solve.\n\nStill, I think the problem is that Defender's heuristics are a wee bit _too sensitive_ and need dialed back a bit.",
    "created_at": "2021-05-15T16:25:37Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15396#issuecomment-841688042",
    "id": 841688042,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15396",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MTY4ODA0Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/841688042/reactions"
    },
    "updated_at": "2021-05-15T16:25:37Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/841688042",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/55163811?v=4",
      "events_url": "https://api.github.com/users/mackposh/events{/privacy}",
      "followers_url": "https://api.github.com/users/mackposh/followers",
      "following_url": "https://api.github.com/users/mackposh/following{/other_user}",
      "gists_url": "https://api.github.com/users/mackposh/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mackposh",
      "id": 55163811,
      "login": "mackposh",
      "node_id": "MDQ6VXNlcjU1MTYzODEx",
      "organizations_url": "https://api.github.com/users/mackposh/orgs",
      "received_events_url": "https://api.github.com/users/mackposh/received_events",
      "repos_url": "https://api.github.com/users/mackposh/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mackposh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mackposh/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mackposh"
    }
  },
  {
    "author_association": "MEMBER",
    "body": "WG-Security\r\n\r\nPowerShell must follow the AMSI result.  If we add ability to alter how we respond, it becomes an attack vector to AMSI plug-ins.  We would need an AMSI feature that tells us that we could, say warn, instead of block. This would probably be by return code from AMSI.\r\n\r\nOtherwise, you need to work through [Microsoft Security Intelligence](https://www.microsoft.com/en-us/wdsi/filesubmission) to get the file cleared as not malware.\r\n\r\nI think we can continue this as a discussion.",
    "created_at": "2021-05-17T20:56:30Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15396#issuecomment-842633221",
    "id": 842633221,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15396",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MjYzMzIyMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/842633221/reactions"
    },
    "updated_at": "2021-05-17T20:56:30Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/842633221",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/10873629?v=4",
      "events_url": "https://api.github.com/users/TravisEz13/events{/privacy}",
      "followers_url": "https://api.github.com/users/TravisEz13/followers",
      "following_url": "https://api.github.com/users/TravisEz13/following{/other_user}",
      "gists_url": "https://api.github.com/users/TravisEz13/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/TravisEz13",
      "id": 10873629,
      "login": "TravisEz13",
      "node_id": "MDQ6VXNlcjEwODczNjI5",
      "organizations_url": "https://api.github.com/users/TravisEz13/orgs",
      "received_events_url": "https://api.github.com/users/TravisEz13/received_events",
      "repos_url": "https://api.github.com/users/TravisEz13/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/TravisEz13/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TravisEz13/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/TravisEz13"
    }
  }
]

[
  {
    "author_association": "NONE",
    "body": "@abhiphirke You need to add `https://www.nuget.org/packages/Microsoft.PowerShell.SDK/` so your project will use NET5-release of System.Management.Automation.PowerShell.",
    "created_at": "2021-04-21T12:32:32Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15288#issuecomment-824023500",
    "id": 824023500,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15288",
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyNDAyMzUwMA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/824023500/reactions"
    },
    "updated_at": "2021-04-21T12:32:41Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/824023500",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/365255?v=4",
      "events_url": "https://api.github.com/users/ALIENQuake/events{/privacy}",
      "followers_url": "https://api.github.com/users/ALIENQuake/followers",
      "following_url": "https://api.github.com/users/ALIENQuake/following{/other_user}",
      "gists_url": "https://api.github.com/users/ALIENQuake/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/ALIENQuake",
      "id": 365255,
      "login": "ALIENQuake",
      "node_id": "MDQ6VXNlcjM2NTI1NQ==",
      "organizations_url": "https://api.github.com/users/ALIENQuake/orgs",
      "received_events_url": "https://api.github.com/users/ALIENQuake/received_events",
      "repos_url": "https://api.github.com/users/ALIENQuake/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/ALIENQuake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ALIENQuake/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/ALIENQuake"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "You could read great post from @rjmholt  https://devblogs.microsoft.com/powershell/depending-on-the-right-powershell-nuget-package-in-your-net-project/\r\n\r\nAs meta note, currently MSFT released preview version of MAUI https://devblogs.microsoft.com/dotnet/announcing-net-multi-platform-app-ui-preview-3/ and if you are starting new project for many years maybe you should look this way, but no one has gone this way yet.\n\n<blockquote><img src=\"https://devblogs.microsoft.com/powershell/wp-content/uploads/sites/30/2018/09/Powershell_256.png\" width=\"48\" align=\"right\"><div><img src=\"https://devblogs.microsoft.com/powershell/wp-content/uploads/sites/30/2019/02/Powershell_2561.png\" height=\"14\"> PowerShell Team</div><div><strong><a href=\"https://devblogs.microsoft.com/powershell/depending-on-the-right-powershell-nuget-package-in-your-net-project/\">Depending on the right PowerShell NuGet package in your .NET project | PowerShell Team</a></strong></div><div>Alongside the pwsh executable packages published with each PowerShell release, the PowerShell team also maintain several NuGet packages that are available on NuGet to allow targeting PowerShell as an API platform in .NET. As a .NET application that both provides APIs and expects to load .NET libraries implementing its own (binary modules),</div></blockquote>\n<blockquote><img src=\"https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2021/04/maui-winui.png\" width=\"48\" align=\"right\"><div><img src=\"https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2018/10/Microsoft-Favicon.png\" height=\"14\"> .NET Blog</div><div><strong><a href=\"https://devblogs.microsoft.com/dotnet/announcing-net-multi-platform-app-ui-preview-3/\">Announcing .NET Multi-platform App UI Preview 3 | .NET Blog</a></strong></div><div>Announcing .NET Multi-platform App UI updates in .NET 6 Preview 3, which includes the latest progress for mobile and desktop development.</div></blockquote>",
    "created_at": "2021-04-22T13:40:24Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15288#issuecomment-824851346",
    "id": 824851346,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15288",
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyNDg1MTM0Ng==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/824851346/reactions"
    },
    "updated_at": "2021-04-22T13:40:26Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/824851346",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/22290914?v=4",
      "events_url": "https://api.github.com/users/iSazonov/events{/privacy}",
      "followers_url": "https://api.github.com/users/iSazonov/followers",
      "following_url": "https://api.github.com/users/iSazonov/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSazonov/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/iSazonov",
      "id": 22290914,
      "login": "iSazonov",
      "node_id": "MDQ6VXNlcjIyMjkwOTE0",
      "organizations_url": "https://api.github.com/users/iSazonov/orgs",
      "received_events_url": "https://api.github.com/users/iSazonov/received_events",
      "repos_url": "https://api.github.com/users/iSazonov/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/iSazonov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSazonov/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/iSazonov"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "Impossible to know for sure from your screenshot (we'd need the full error and stack trace), but I strongly suspect you are compiling for one .NET platform and trying to run on another, which won't work.\r\n\r\nYour starting point has a fundamental issue in it, which is that you have an application (i.e. a standalone executable) that needs to work with two different PowerShells. An application can only target one framework (if you target multiple, you will have multiple executables created in your publish step), but different PowerShells run different .NET frameworks. PowerShell is itself an executable, but that executable just wraps a set of assemblies that you can reuse via something like the SDK or the reference assemblies.\r\n\r\nSo the question essentially is: what are your base requirements? That will determine whether you need to build:\r\n\r\n- Two different applications (the same code with two `TargetFrameworks`), one targeting .NET 4.8 and one targeting .NET Core 3.1, that each load PS 5.1 and PS 7 respectively\r\n- A single application written in whatever you like that uses a serialisation layer to talk to its PowerShell of choice out of process\r\n- A PowerShell module targeting .NET Standard and PowerShell standard that can be loaded by both PS 5.1 and PS 7, and a script that starts the relevant PowerShell, loads your module, and runs your \"application\" from that (this is what PowerShell Editor Services does)",
    "created_at": "2021-04-22T15:58:37Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15288#issuecomment-824968768",
    "id": 824968768,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15288",
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyNDk2ODc2OA==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/824968768/reactions"
    },
    "updated_at": "2021-04-22T15:58:37Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/824968768",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/7009879?v=4",
      "events_url": "https://api.github.com/users/rjmholt/events{/privacy}",
      "followers_url": "https://api.github.com/users/rjmholt/followers",
      "following_url": "https://api.github.com/users/rjmholt/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjmholt/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/rjmholt",
      "id": 7009879,
      "login": "rjmholt",
      "node_id": "MDQ6VXNlcjcwMDk4Nzk=",
      "organizations_url": "https://api.github.com/users/rjmholt/orgs",
      "received_events_url": "https://api.github.com/users/rjmholt/received_events",
      "repos_url": "https://api.github.com/users/rjmholt/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/rjmholt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjmholt/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/rjmholt"
    }
  },
  {
    "author_association": "NONE",
    "body": "This issue has been marked as answered and has not had any activity for **1 day**. It has been closed for housekeeping purposes.",
    "created_at": "2021-05-21T00:00:14Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15288#issuecomment-845558279",
    "id": 845558279,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15288",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0NTU1ODI3OQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/845558279/reactions"
    },
    "updated_at": "2021-05-21T00:00:14Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/845558279",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/in/26612?v=4",
      "events_url": "https://api.github.com/users/msftbot%5Bbot%5D/events{/privacy}",
      "followers_url": "https://api.github.com/users/msftbot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/msftbot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/msftbot%5Bbot%5D/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/apps/msftbot",
      "id": 48340428,
      "login": "msftbot[bot]",
      "node_id": "MDM6Qm90NDgzNDA0Mjg=",
      "organizations_url": "https://api.github.com/users/msftbot%5Bbot%5D/orgs",
      "received_events_url": "https://api.github.com/users/msftbot%5Bbot%5D/received_events",
      "repos_url": "https://api.github.com/users/msftbot%5Bbot%5D/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/msftbot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msftbot%5Bbot%5D/subscriptions",
      "type": "Bot",
      "url": "https://api.github.com/users/msftbot%5Bbot%5D"
    }
  },
  {
    "author_association": "NONE",
    "body": "Thank you for all the help!",
    "created_at": "2021-06-02T09:58:44Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/15288#issuecomment-852891525",
    "id": 852891525,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/15288",
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1Mjg5MTUyNQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/852891525/reactions"
    },
    "updated_at": "2021-06-02T09:58:44Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/852891525",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/8724807?v=4",
      "events_url": "https://api.github.com/users/abhiphirke/events{/privacy}",
      "followers_url": "https://api.github.com/users/abhiphirke/followers",
      "following_url": "https://api.github.com/users/abhiphirke/following{/other_user}",
      "gists_url": "https://api.github.com/users/abhiphirke/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/abhiphirke",
      "id": 8724807,
      "login": "abhiphirke",
      "node_id": "MDQ6VXNlcjg3MjQ4MDc=",
      "organizations_url": "https://api.github.com/users/abhiphirke/orgs",
      "received_events_url": "https://api.github.com/users/abhiphirke/received_events",
      "repos_url": "https://api.github.com/users/abhiphirke/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/abhiphirke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/abhiphirke/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/abhiphirke"
    }
  }
]

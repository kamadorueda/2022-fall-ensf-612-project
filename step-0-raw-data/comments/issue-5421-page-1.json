[
  {
    "author_association": "COLLABORATOR",
    "body": "https://stackoverflow.com/questions/10262231/obtaining-exitcode-using-start-process-and-waitforexit-instead-of-wait\r\n\r\nDug this up... Seems as though it's not so much waiting for it to end as it is *explicitly querying for the process handle* while it's still running is what allows the exit code to be captured. \r\n\r\nIdeally, `Start-Process` could internally query the process handle from the object before passing it to the pipeline in order to ensure the exit code is always captured, regardless of the circumstance.",
    "created_at": "2018-08-27T14:14:57Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/5421#issuecomment-416240931",
    "id": 416240931,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/5421",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNjI0MDkzMQ==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/416240931/reactions"
    },
    "updated_at": "2018-08-27T14:14:57Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/416240931",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/32407840?v=4",
      "events_url": "https://api.github.com/users/vexx32/events{/privacy}",
      "followers_url": "https://api.github.com/users/vexx32/followers",
      "following_url": "https://api.github.com/users/vexx32/following{/other_user}",
      "gists_url": "https://api.github.com/users/vexx32/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vexx32",
      "id": 32407840,
      "login": "vexx32",
      "node_id": "MDQ6VXNlcjMyNDA3ODQw",
      "organizations_url": "https://api.github.com/users/vexx32/orgs",
      "received_events_url": "https://api.github.com/users/vexx32/received_events",
      "repos_url": "https://api.github.com/users/vexx32/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vexx32/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vexx32/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vexx32"
    }
  },
  {
    "author_association": "CONTRIBUTOR",
    "body": "Great find, @vexx32 - that sounds like a great workaround.\r\n\r\nA little more background info to flesh out your statement, from a [linked answer](https://stackoverflow.com/a/23797762/45375):\r\n\r\n> This is a quirk of the implementation of the .NET Process object. The implementation of the ExitCode property first checks if the process has exited. \r\nFor some reason, the code that performs that check not only looks at the HasExited property but also [verifies that the process handle is present in the process object and throws an exception if it is not](https://source.dot.net/#System.Diagnostics.Process/System/Diagnostics/Process.cs,954). PowerShell intercepts that exception and returns null. \r\nAccessing the Handle property causes the process object to retrieve the process handle and store it internally. Once the handle is stored in the process object, the ExitCode property works as expected.\r\n\r\nI wonder if there was ever a good reason for this behavior, or whether we should also file a CoreFx bug report.  ",
    "created_at": "2018-08-27T20:17:23Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/5421#issuecomment-416354272",
    "id": 416354272,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/5421",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNjM1NDI3Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/416354272/reactions"
    },
    "updated_at": "2018-08-27T20:24:23Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/416354272",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/588825?v=4",
      "events_url": "https://api.github.com/users/mklement0/events{/privacy}",
      "followers_url": "https://api.github.com/users/mklement0/followers",
      "following_url": "https://api.github.com/users/mklement0/following{/other_user}",
      "gists_url": "https://api.github.com/users/mklement0/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/mklement0",
      "id": 588825,
      "login": "mklement0",
      "node_id": "MDQ6VXNlcjU4ODgyNQ==",
      "organizations_url": "https://api.github.com/users/mklement0/orgs",
      "received_events_url": "https://api.github.com/users/mklement0/received_events",
      "repos_url": "https://api.github.com/users/mklement0/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/mklement0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mklement0/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/mklement0"
    }
  },
  {
    "author_association": "COLLABORATOR",
    "body": "It probably can't hurt, honestly. But meantime, we can temp-fix this fairly quickly, it would appear. ðŸ˜„ \r\n\r\nI'm not familiar with the internals of that object, but I wouldn't be surprised if there was some weirdness where it accesses the ExitCode via the handle reference somehow, so if it isn't retrieved before the process exits, it can't get at it, or something.\r\n\r\nShould still be fixed either way, heh.",
    "created_at": "2018-08-27T20:22:31Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/5421#issuecomment-416355872",
    "id": 416355872,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/5421",
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNjM1NTg3Mg==",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 1,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 1,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/416355872/reactions"
    },
    "updated_at": "2018-08-27T20:41:10Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/416355872",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/32407840?v=4",
      "events_url": "https://api.github.com/users/vexx32/events{/privacy}",
      "followers_url": "https://api.github.com/users/vexx32/followers",
      "following_url": "https://api.github.com/users/vexx32/following{/other_user}",
      "gists_url": "https://api.github.com/users/vexx32/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/vexx32",
      "id": 32407840,
      "login": "vexx32",
      "node_id": "MDQ6VXNlcjMyNDA3ODQw",
      "organizations_url": "https://api.github.com/users/vexx32/orgs",
      "received_events_url": "https://api.github.com/users/vexx32/received_events",
      "repos_url": "https://api.github.com/users/vexx32/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/vexx32/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vexx32/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/vexx32"
    }
  },
  {
    "author_association": "NONE",
    "body": "Any updates on this? This really should be addressed.",
    "created_at": "2021-07-22T22:27:53Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/5421#issuecomment-885276275",
    "id": 885276275,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/5421",
    "node_id": "IC_kwDOAvT7bc40xD5z",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/885276275/reactions"
    },
    "updated_at": "2021-07-22T22:27:53Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/885276275",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/828153?v=4",
      "events_url": "https://api.github.com/users/jmaxxz/events{/privacy}",
      "followers_url": "https://api.github.com/users/jmaxxz/followers",
      "following_url": "https://api.github.com/users/jmaxxz/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmaxxz/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jmaxxz",
      "id": 828153,
      "login": "jmaxxz",
      "node_id": "MDQ6VXNlcjgyODE1Mw==",
      "organizations_url": "https://api.github.com/users/jmaxxz/orgs",
      "received_events_url": "https://api.github.com/users/jmaxxz/received_events",
      "repos_url": "https://api.github.com/users/jmaxxz/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jmaxxz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmaxxz/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jmaxxz"
    }
  },
  {
    "author_association": "NONE",
    "body": "Any update? This is a rather impactful productivity blocker because you can't tell if process succeeded or failed. Makes start-process pretty much useless.",
    "created_at": "2022-01-14T17:17:51Z",
    "html_url": "https://github.com/PowerShell/PowerShell/issues/5421#issuecomment-1013309615",
    "id": 1013309615,
    "issue_url": "https://api.github.com/repos/PowerShell/PowerShell/issues/5421",
    "node_id": "IC_kwDOAvT7bc48ZeCv",
    "performed_via_github_app": null,
    "reactions": {
      "+1": 0,
      "-1": 0,
      "confused": 0,
      "eyes": 0,
      "heart": 0,
      "hooray": 0,
      "laugh": 0,
      "rocket": 0,
      "total_count": 0,
      "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1013309615/reactions"
    },
    "updated_at": "2022-01-14T17:17:51Z",
    "url": "https://api.github.com/repos/PowerShell/PowerShell/issues/comments/1013309615",
    "user": {
      "avatar_url": "https://avatars.githubusercontent.com/u/11446053?v=4",
      "events_url": "https://api.github.com/users/jordanrh1/events{/privacy}",
      "followers_url": "https://api.github.com/users/jordanrh1/followers",
      "following_url": "https://api.github.com/users/jordanrh1/following{/other_user}",
      "gists_url": "https://api.github.com/users/jordanrh1/gists{/gist_id}",
      "gravatar_id": "",
      "html_url": "https://github.com/jordanrh1",
      "id": 11446053,
      "login": "jordanrh1",
      "node_id": "MDQ6VXNlcjExNDQ2MDUz",
      "organizations_url": "https://api.github.com/users/jordanrh1/orgs",
      "received_events_url": "https://api.github.com/users/jordanrh1/received_events",
      "repos_url": "https://api.github.com/users/jordanrh1/repos",
      "site_admin": false,
      "starred_url": "https://api.github.com/users/jordanrh1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jordanrh1/subscriptions",
      "type": "User",
      "url": "https://api.github.com/users/jordanrh1"
    }
  }
]

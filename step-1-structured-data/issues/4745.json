{
  "_url": "https://github.com/PowerShell/PowerShell/issues/4745",
  "author": "bergmeister",
  "body": "To fix #4665 \r\nThe previous check registry check of `SOFTWARE\\Microsoft\\DevDiv\\VC\\Servicing\\14.0\\RuntimeMinimum` turned out to not work in the scenario whereby the redistributables were installed via Windows update (which does not use MSI) because the registry entry did not get populated in this case.\r\nIn the issue discussion @SteveL-MSFT suggested to have only a simple file based check, therefore this PR simply checks for the existence of `vcruntime140.dll` in the `Windows/System32` folder\r\n\r\nThe 'Pending' attribute was removed from existing tests since the download links are now present again and the tests were improved using Pester TestCases.",
  "closed_at": "2017-09-15T01:42:36Z",
  "comments": [
    {
      "author": "msftclas",
      "author_association": "NONE",
      "body": "\r\n@bergmeister,\nThanks for having already signed the Contribution License Agreement. Your agreement was validated by Microsoft. We will now review your pull request.\n_Thanks,\nMicrosoft Pull Request Bot_",
      "created_at": "2017-09-03T17:55:51Z",
      "updated_at": "2017-09-03T17:55:51Z"
    },
    {
      "author": "bergmeister",
      "author_association": "CONTRIBUTOR",
      "body": "Please do not merge. My last commit, which replaced the Urls had a WiX compilation error (maybe due to the hash in the url). The Appveyor build should be improved to go red if it does not produce an MSI.",
      "created_at": "2017-09-06T11:59:01Z",
      "updated_at": "2017-09-06T11:59:01Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@bergmeister can you open an issue to test the MSI packaging?",
      "created_at": "2017-09-06T15:54:09Z",
      "updated_at": "2017-09-06T15:54:09Z"
    },
    {
      "author": "bergmeister",
      "author_association": "CONTRIBUTOR",
      "body": "@SteveL-MSFT I opened issue #4760 for it and fixed the compilation error (Property Id had to be public due to the DirectorySearch and therefore did not allow lowercase characters). I installed the MSI produced by the build on my machine as a test and it would be ready for merge again.",
      "created_at": "2017-09-06T17:37:26Z",
      "updated_at": "2017-09-06T17:38:16Z"
    },
    {
      "author": "mirichmo",
      "author_association": "MEMBER",
      "body": "I restarted the Travis build to see if it would fix itself.",
      "created_at": "2017-09-09T01:00:27Z",
      "updated_at": "2017-09-09T01:00:27Z"
    }
  ],
  "created_at": "2017-09-03T17:55:45Z",
  "number": 4745,
  "state": "closed",
  "title": "Fix of #4665 to have a simple file based check for the VC++ 2015 redistributables",
  "updated_at": "2017-09-15T01:42:36Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/10409",
  "author": "romero126",
  "body": "I have been using pwsh 7 preview for the past week. \r\nI come back to the working in PWSH 7 after two days of being away and getting crashdump on Telemetry \r\n\r\nI uninstalled and reinstalled PWSH-Preview just incase it was new build invalidation pains. However issue persists. \r\n\r\nI also tried Setting the POWERSHELL_TELEMETRY_OPTOUT variable to both YES and NO and issue Persists.\r\n\r\nError Log follows:\r\n\r\n> .\\pwsh.exe\r\nPowerShell 7.0.0-preview.3\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\n\r\nhttps://aka.ms/powershell\r\nType 'help' to get help.\r\n\r\nProcess terminated. The type initializer for 'Microsoft.PowerShell.Telemetry.ApplicationInsightsTelemetry' threw an exception.\r\n   at System.Environment.FailFast(System.String, System.Exception)\r\n   at Microsoft.PowerShell.UnmanagedPSEntry.Start(System.String, System.String[], Int32)\r\n   at Microsoft.PowerShell.ManagedPSEntry.Main(System.String[])\r\nSystem.TypeInitializationException: The type initializer for 'Microsoft.PowerShell.Telemetry.ApplicationInsightsTelemetry' threw an exception.\r\n ---> System.TypeInitializationException: The type initializer for 'Microsoft.ApplicationInsights.Extensibility.Implementation.Tracing.CoreEventSource' threw an exception.\r\n ---> System.ArgumentException: External component has thrown an exception.\r\n   at System.Globalization.CompareInfo.CompareString(ReadOnlySpan`1 string1, ReadOnlySpan`1 string2, CompareOptions options)\r\n   at System.Globalization.CompareInfo.Compare(String string1, String string2, CompareOptions options)\r\n   at System.Globalization.TextInfo.PopulateIsAsciiCasingSameAsInvariant()\r\n   at System.Globalization.TextInfo.ChangeCaseCommon[TConversion](String source)\r\n   at System.Globalization.TextInfo.ToUpper(String str)\r\n   at System.String.ToUpperInvariant()\r\n   at System.Diagnostics.Tracing.EventSource.GetGuid(Type eventSourceType)\r\n   at System.Diagnostics.Tracing.EventSource..ctor(EventSourceSettings settings, String[] traits)\r\n   at System.Diagnostics.Tracing.EventSource..ctor()\r\n   at Microsoft.ApplicationInsights.Extensibility.Implementation.Tracing.CoreEventSource..cctor()\r\n   --- End of inner exception stack trace ---\r\n   at Microsoft.ApplicationInsights.Extensibility.Implementation.TelemetryConfigurationFactory.InitializeComponent(Object component, TelemetryConfiguration configuration)\r\n   at Microsoft.ApplicationInsights.Extensibility.Implementation.TelemetryConfigurationFactory.InitializeComponents(IEnumerable components, TelemetryConfiguration configuration)\r\n   at Microsoft.ApplicationInsights.Extensibility.Implementation.TelemetryConfigurationFactory.InitializeComponents(TelemetryConfiguration configuration, TelemetryModules modules)\r\n   at Microsoft.ApplicationInsights.Extensibility.Implementation.TelemetryConfigurationFactory.Initialize(TelemetryConfiguration configuration, TelemetryModules modules, String serializedConfiguration)\r\n   at Microsoft.ApplicationInsights.Extensibility.Implementation.TelemetryConfigurationFactory.Initialize(TelemetryConfiguration configuration, TelemetryModules modules)\r\n   at Microsoft.ApplicationInsights.Extensibility.TelemetryConfiguration.get_Active()\r\n   at Microsoft.ApplicationInsights.TelemetryClient..ctor()\r\n   at Microsoft.PowerShell.Telemetry.ApplicationInsightsTelemetry..cctor()\r\n   --- End of inner exception stack trace ---\r\n   at Microsoft.PowerShell.Telemetry.ApplicationInsightsTelemetry.SendPSCoreStartupTelemetry(String mode)\r\n   at Microsoft.PowerShell.ConsoleHost.Start(String bannerText, String helpText, String[] args)\r\n   at Microsoft.PowerShell.ConsoleShell.Start(InitialSessionState initialSessionState, String bannerText, String helpText, String[] args)\r\n   at Microsoft.PowerShell.UnmanagedPSEntry.Start(String consoleFilePath, String[] args, Int32 argc)\r\n0010\u25ba\u25baC\u25ba7-preview\u25ba                                                                               \u25c400:00:01.4999798\u25c407:25:44 PM\r\n>\r\n",
  "closed_at": "2019-08-22T15:46:00Z",
  "comments": [],
  "created_at": "2019-08-22T02:58:39Z",
  "labels": [
    "Issue-Question"
  ],
  "number": 10409,
  "state": "closed",
  "title": "Telemetry Crash on PWSH 7-preview",
  "updated_at": "2019-08-22T15:46:00Z"
}
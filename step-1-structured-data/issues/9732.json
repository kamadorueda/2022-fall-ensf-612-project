{
  "_url": "https://github.com/PowerShell/PowerShell/issues/9732",
  "author": "vexx32",
  "body": "<!-- Anything that looks like this is a comment and can't be seen after the Pull Request is created. -->\r\n\r\n# PR Summary\r\n\r\n- Use newer / more readable code patterns for brevity and clarity.\r\n- Remove unusable setter implementations.\r\n- Simplify logic slightly in sensible places.\r\n- Miscellaneous code cleanups, break up longer lines, etc.\r\n\r\nThis PR contains no functional changes.\r\n\r\n## PR Context\r\n\r\nChill time cleaning up some code. \r\n\r\n## PR Checklist\r\n\r\n- [x] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - Use the present tense and imperative mood when describing your changes\r\n- [x] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] [Make sure all `.h`, `.cpp`, `.cs`, `.ps1` and `.psm1` files have the correct copyright header](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - If the PR is work in progress, please add the prefix `WIP:` or `[ WIP ]` to the beginning of the title (the `WIP` bot will keep its status check at `Pending` while the prefix is present) and remove the prefix when the PR is ready.\r\n- **[Breaking changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)**\r\n    - [x] None\r\n    - **OR**\r\n    - [ ] [Experimental feature(s) needed](https://github.com/MicrosoftDocs/PowerShell-Docs/blob/staging/reference/6/Microsoft.PowerShell.Core/About/about_Experimental_Features.md)\r\n        - [ ] Experimental feature name(s): <!-- Experimental feature name(s) here -->\r\n- **User-facing changes**\r\n    - [x] Not Applicable\r\n    - **OR**\r\n    - [ ] [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n        - [ ] Issue filed: <!-- Number/link of that issue here -->\r\n- **Testing - New and feature**\r\n    - [x] N/A or can only be tested interactively\r\n    - **OR**\r\n    - [ ] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n",
  "closed_at": "2019-05-31T03:15:41Z",
  "comments": [
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "@iSazonov not sure if the broken builds are to do with my changes? There shouldn't be anything functionally different, and the build agents don't seem to be even giving compile errors. Have you seen this before at all?",
      "created_at": "2019-05-26T15:01:47Z",
      "updated_at": "2019-05-26T15:01:47Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@vexx32, your last commit had 12 failures in `PowerShell-CI-macos`\r\n(These are 5 of the failures)\r\n\r\nSend-MailMessage DRT Unit Tests.Can send mail message using named parameters with mandatory parameters\r\n```powershell\r\nExpected exactly 'user01@example.com', but got $null.\r\nat <ScriptBlock>, /Users/vsts/agent/2.150.3/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1: line 136\r\n136:         $mail.FromAddress | Should -BeExactly $InputObject.From\r\n```\r\nSend-MailMessage DRT Unit Tests.Can send mail message using named parameters with ReplyTo\r\n```powershell\r\nExpected exactly 'user01@example.com', but got $null.\r\nat <ScriptBlock>, /Users/vsts/agent/2.150.3/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1: line 136\r\n136:         $mail.FromAddress | Should -BeExactly $InputObject.From\r\n```\r\nSend-MailMessage DRT Unit Tests.Can send mail message using named parameters with multiple To\r\n```powershell\r\nExpected exactly 'user01@example.com', but got $null.\r\nat <ScriptBlock>, /Users/vsts/agent/2.150.3/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1: line 136\r\n136:         $mail.FromAddress | Should -BeExactly $InputObject.From\r\n```\r\nSend-MailMessage DRT Unit Tests.Can send mail message using named parameters with multiple Cc\r\n```powershell\r\nExpected exactly 'user01@example.com', but got $null.\r\nat <ScriptBlock>, /Users/vsts/agent/2.150.3/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1: line 136\r\n136:         $mail.FromAddress | Should -BeExactly $InputObject.From\r\n```\r\nSend-MailMessage DRT Unit Tests.Can send mail message using named parameters with multiple Bcc\r\n```powershell\r\nExpected exactly 'user01@example.com', but got $null.\r\nat <ScriptBlock>, /Users/vsts/agent/2.150.3/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1: line 136\r\n136:         $mail.FromAddress | Should -BeExactly $InputObject.From\r\n```\r\n",
      "created_at": "2019-05-27T16:17:20Z",
      "updated_at": "2019-05-30T20:35:30Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@vexx32, your last commit had 12 failures in `PowerShell-CI-windows`\r\n(These are 5 of the failures)\r\n\r\nSend-MailMessage Feature Tests.Default Port 25.Can send mail with free-form email address\r\n```powershell\r\nExpected exactly 'user01@example.com', but got $null.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Send-MailMessage.Tests.ps1: line 247\r\n247:             $mail.FromAddress | Should -BeExactly \"user01@example.com\"\r\n```\r\nSend-MailMessage Feature Tests.Default Port 25.Can send mail with high priority\r\n```powershell\r\nExpected exactly 'urgent', but got $null.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Send-MailMessage.Tests.ps1: line 257\r\n257:             $mail.Priority | Should -BeExactly \"urgent\"\r\n```\r\nSend-MailMessage Feature Tests.Default Port 25.Can send mail with HTML content as body\r\n```powershell\r\nCannot index into a null array.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Send-MailMessage.Tests.ps1: line 269\r\n269:             $mail.Headers[\"content-type\"] | Should -BeLike \"text/html*\"\r\n\r\n```\r\nSend-MailMessage Feature Tests.Default Port 25.Can send mail with UTF8 encoding\r\n```powershell\r\nExpected exactly 1, but got 0.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Send-MailMessage.Tests.ps1: line 283\r\n283:             $mail.MessageParts.Count | Should -BeExactly 1\r\n```\r\nSend-MailMessage Feature Tests.Default Port 25.Can send mail with attachments\r\n```powershell\r\nExpected exactly 3, but got 0.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Send-MailMessage.Tests.ps1: line 303\r\n303:             $mail.MessageParts.Count | Should -BeExactly 3\r\n```\r\n",
      "created_at": "2019-05-27T16:21:02Z",
      "updated_at": "2019-05-27T16:21:02Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@vexx32, your last commit had 75 failures in `PowerShell-CI-linux`\r\n(These are 5 of the failures)\r\n\r\nError occurred in test script '/home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1'\r\n```powershell\r\nCannot retrieve the dynamic parameters for the cmdlet. An exception was thrown by a TaskScheduler.\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1: line 11\r\n```\r\nError occurred in test script '/home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Set-Date.Tests.ps1'\r\n```powershell\r\nToo many open files\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Set-Date.Tests.ps1: line 4\r\n```\r\nError occurred in test script '/home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1'\r\n```powershell\r\nCannot retrieve the dynamic parameters for the cmdlet. An exception was thrown by a TaskScheduler.\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1: line 11\r\n```\r\nError occurred in test script '/home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Set-Date.Tests.ps1'\r\n```powershell\r\nToo many open files\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Set-Date.Tests.ps1: line 4\r\n```\r\nInvoke-WebRequest tests.Error occurred in Describe block\r\n```powershell\r\nThe 'Start-WebListener' command was found in the module 'WebListener', but the module could not be loaded. For more information, run 'Import-Module WebListener'.\r\nAt /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/WebCmdlets.Tests.ps1:372 char:24\r\n```\r\n",
      "created_at": "2019-05-27T16:24:43Z",
      "updated_at": "2019-05-27T16:24:43Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "\ud83d\udc40 I don't... think that should be related to this at all? Did something change with the mail things?",
      "created_at": "2019-05-27T16:53:51Z",
      "updated_at": "2019-05-27T16:53:51Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@vexx32, your last commit had 12 failures in `PowerShell-CI-windows`\r\n(These are 5 of the failures)\r\n\r\nSend-MailMessage Feature Tests.Default Port 25.Can send mail with free-form email address\r\n```powershell\r\nExpected exactly 'user01@example.com', but got $null.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Send-MailMessage.Tests.ps1: line 247\r\n247:             $mail.FromAddress | Should -BeExactly \"user01@example.com\"\r\n```\r\nSend-MailMessage Feature Tests.Default Port 25.Can send mail with high priority\r\n```powershell\r\nExpected exactly 'urgent', but got $null.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Send-MailMessage.Tests.ps1: line 257\r\n257:             $mail.Priority | Should -BeExactly \"urgent\"\r\n```\r\nSend-MailMessage Feature Tests.Default Port 25.Can send mail with HTML content as body\r\n```powershell\r\nCannot index into a null array.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Send-MailMessage.Tests.ps1: line 269\r\n269:             $mail.Headers[\"content-type\"] | Should -BeLike \"text/html*\"\r\n\r\n```\r\nSend-MailMessage Feature Tests.Default Port 25.Can send mail with UTF8 encoding\r\n```powershell\r\nExpected exactly 1, but got 0.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Send-MailMessage.Tests.ps1: line 283\r\n283:             $mail.MessageParts.Count | Should -BeExactly 1\r\n```\r\nSend-MailMessage Feature Tests.Default Port 25.Can send mail with attachments\r\n```powershell\r\nExpected exactly 3, but got 0.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Send-MailMessage.Tests.ps1: line 303\r\n303:             $mail.MessageParts.Count | Should -BeExactly 3\r\n```\r\n",
      "created_at": "2019-05-28T03:57:19Z",
      "updated_at": "2019-05-28T03:57:19Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "We need try without last commit. Perhaps we again catch a tricky change. :-)",
      "created_at": "2019-05-28T04:16:22Z",
      "updated_at": "2019-05-28T04:16:22Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "Heh, yeah. Something went screwy, for sure. I'll review the diffs again tomorrow and if I don't see anything I'll roll back that commit and see what happens. Appreciate your help thus far! \ud83d\udc96 ",
      "created_at": "2019-05-28T04:19:52Z",
      "updated_at": "2019-05-28T04:19:52Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@vexx32, your last commit had 12 failures in `PowerShell-CI-macos`\r\n(These are 5 of the failures)\r\n\r\nSend-MailMessage DRT Unit Tests.Can send mail message using named parameters with mandatory parameters\r\n```powershell\r\nExpected exactly 'user01@example.com', but got $null.\r\nat <ScriptBlock>, /Users/vsts/agent/2.150.3/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1: line 136\r\n136:         $mail.FromAddress | Should -BeExactly $InputObject.From\r\n```\r\nSend-MailMessage DRT Unit Tests.Can send mail message using named parameters with ReplyTo\r\n```powershell\r\nExpected exactly 'user01@example.com', but got $null.\r\nat <ScriptBlock>, /Users/vsts/agent/2.150.3/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1: line 136\r\n136:         $mail.FromAddress | Should -BeExactly $InputObject.From\r\n```\r\nSend-MailMessage DRT Unit Tests.Can send mail message using named parameters with multiple To\r\n```powershell\r\nExpected exactly 'user01@example.com', but got $null.\r\nat <ScriptBlock>, /Users/vsts/agent/2.150.3/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1: line 136\r\n136:         $mail.FromAddress | Should -BeExactly $InputObject.From\r\n```\r\nSend-MailMessage DRT Unit Tests.Can send mail message using named parameters with multiple Cc\r\n```powershell\r\nExpected exactly 'user01@example.com', but got $null.\r\nat <ScriptBlock>, /Users/vsts/agent/2.150.3/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1: line 136\r\n136:         $mail.FromAddress | Should -BeExactly $InputObject.From\r\n```\r\nSend-MailMessage DRT Unit Tests.Can send mail message using named parameters with multiple Bcc\r\n```powershell\r\nExpected exactly 'user01@example.com', but got $null.\r\nat <ScriptBlock>, /Users/vsts/agent/2.150.3/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1: line 136\r\n136:         $mail.FromAddress | Should -BeExactly $InputObject.From\r\n```\r\n",
      "created_at": "2019-05-28T16:59:42Z",
      "updated_at": "2019-05-28T16:59:42Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "@iSazonov that doesn't look good. I'm pretty sure this isn't to do with the changes (for real this time \ud83d\ude09 )",
      "created_at": "2019-05-28T17:03:02Z",
      "updated_at": "2019-05-28T17:03:02Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@vexx32, your last commit had 12 failures in `PowerShell-CI-windows`\r\n(These are 5 of the failures)\r\n\r\nSend-MailMessage Feature Tests.Default Port 25.Can send mail with free-form email address\r\n```powershell\r\nExpected exactly 'user01@example.com', but got $null.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Send-MailMessage.Tests.ps1: line 247\r\n247:             $mail.FromAddress | Should -BeExactly \"user01@example.com\"\r\n```\r\nSend-MailMessage Feature Tests.Default Port 25.Can send mail with high priority\r\n```powershell\r\nExpected exactly 'urgent', but got $null.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Send-MailMessage.Tests.ps1: line 257\r\n257:             $mail.Priority | Should -BeExactly \"urgent\"\r\n```\r\nSend-MailMessage Feature Tests.Default Port 25.Can send mail with HTML content as body\r\n```powershell\r\nCannot index into a null array.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Send-MailMessage.Tests.ps1: line 269\r\n269:             $mail.Headers[\"content-type\"] | Should -BeLike \"text/html*\"\r\n\r\n```\r\nSend-MailMessage Feature Tests.Default Port 25.Can send mail with UTF8 encoding\r\n```powershell\r\nExpected exactly 1, but got 0.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Send-MailMessage.Tests.ps1: line 283\r\n283:             $mail.MessageParts.Count | Should -BeExactly 1\r\n```\r\nSend-MailMessage Feature Tests.Default Port 25.Can send mail with attachments\r\n```powershell\r\nExpected exactly 3, but got 0.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Send-MailMessage.Tests.ps1: line 303\r\n303:             $mail.MessageParts.Count | Should -BeExactly 3\r\n```\r\n",
      "created_at": "2019-05-28T17:04:27Z",
      "updated_at": "2019-05-28T17:04:27Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@vexx32, your last commit had 14 failures in `PowerShell-CI-linux`\r\n(These are 5 of the failures)\r\n\r\nError occurred in test script '/home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1'\r\n```powershell\r\nCannot retrieve the dynamic parameters for the cmdlet. An exception was thrown by a TaskScheduler.\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1: line 11\r\n```\r\nError occurred in test script '/home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Set-Date.Tests.ps1'\r\n```powershell\r\nToo many open files\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Set-Date.Tests.ps1: line 4\r\n```\r\nError occurred in test script '/home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1'\r\n```powershell\r\nCannot retrieve the dynamic parameters for the cmdlet. An exception was thrown by a TaskScheduler.\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1: line 11\r\n```\r\nError occurred in test script '/home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Set-Date.Tests.ps1'\r\n```powershell\r\nToo many open files\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Set-Date.Tests.ps1: line 4\r\n```\r\nInvoke-WebRequest tests.Error occurred in Describe block\r\n```powershell\r\nThe 'Start-WebListener' command was found in the module 'WebListener', but the module could not be loaded. For more information, run 'Import-Module WebListener'.\r\nAt /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/WebCmdlets.Tests.ps1:372 char:24\r\n```\r\n",
      "created_at": "2019-05-28T17:08:16Z",
      "updated_at": "2019-05-28T17:08:16Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "Looks like something's up with the Azure image, perhaps? `Error thrown by a task scheduler` sure doesn't sound like it's on our end... :/ and it was working in this exact way just yesterday morning",
      "created_at": "2019-05-28T17:19:04Z",
      "updated_at": "2019-05-28T17:19:04Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "@TravisEz13 has something changed with the build agents since Saturday/Sunday? \r\n\r\n#9743 is failing with the same errors.",
      "created_at": "2019-05-28T17:57:14Z",
      "updated_at": "2019-05-28T17:58:00Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "@vexx32 \tNo code change.  An agent change seems likely.",
      "created_at": "2019-05-28T19:37:50Z",
      "updated_at": "2019-05-28T19:37:50Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "@PoshChan Please retry linux tests",
      "created_at": "2019-05-28T19:51:23Z",
      "updated_at": "2019-05-28T19:51:57Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@TravisEz13, I do not understand the build target(s) `linux tests`; I only allow `static`, `windows`, `macos`, `linux`, `all`",
      "created_at": "2019-05-28T19:51:26Z",
      "updated_at": "2019-05-28T19:51:52Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "@PoshChan Please retry linux\r\n",
      "created_at": "2019-05-28T19:51:45Z",
      "updated_at": "2019-05-28T19:51:45Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@TravisEz13, successfully started retry of `PowerShell-CI-Linux`",
      "created_at": "2019-05-28T19:52:19Z",
      "updated_at": "2019-05-28T19:52:19Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@vexx32, your last commit had 14 failures in `PowerShell-CI-linux`\r\n(These are 5 of the failures)\r\n\r\nError occurred in test script '/home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1'\r\n```powershell\r\nCannot retrieve the dynamic parameters for the cmdlet. An exception was thrown by a TaskScheduler.\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1: line 11\r\n```\r\nError occurred in test script '/home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Set-Date.Tests.ps1'\r\n```powershell\r\nToo many open files\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Set-Date.Tests.ps1: line 4\r\n```\r\nError occurred in test script '/home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1'\r\n```powershell\r\nCannot retrieve the dynamic parameters for the cmdlet. An exception was thrown by a TaskScheduler.\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1: line 11\r\n```\r\nError occurred in test script '/home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Set-Date.Tests.ps1'\r\n```powershell\r\nToo many open files\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Set-Date.Tests.ps1: line 4\r\n```\r\nInvoke-WebRequest tests.Error occurred in Describe block\r\n```powershell\r\nThe 'Start-WebListener' command was found in the module 'WebListener', but the module could not be loaded. For more information, run 'Import-Module WebListener'.\r\nAt /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/WebCmdlets.Tests.ps1:372 char:24\r\n```\r\n",
      "created_at": "2019-05-28T20:27:33Z",
      "updated_at": "2019-05-28T21:41:01Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@vexx32, your last commit had 12 failures in `PowerShell-CI-macos`\r\n(These are 5 of the failures)\r\n\r\nSend-MailMessage DRT Unit Tests.Can send mail message using named parameters with mandatory parameters\r\n```powershell\r\nExpected exactly 'user01@example.com', but got $null.\r\nat <ScriptBlock>, /Users/vsts/agent/2.150.3/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1: line 136\r\n136:         $mail.FromAddress | Should -BeExactly $InputObject.From\r\n```\r\nSend-MailMessage DRT Unit Tests.Can send mail message using named parameters with ReplyTo\r\n```powershell\r\nExpected exactly 'user01@example.com', but got $null.\r\nat <ScriptBlock>, /Users/vsts/agent/2.150.3/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1: line 136\r\n136:         $mail.FromAddress | Should -BeExactly $InputObject.From\r\n```\r\nSend-MailMessage DRT Unit Tests.Can send mail message using named parameters with multiple To\r\n```powershell\r\nExpected exactly 'user01@example.com', but got $null.\r\nat <ScriptBlock>, /Users/vsts/agent/2.150.3/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1: line 136\r\n136:         $mail.FromAddress | Should -BeExactly $InputObject.From\r\n```\r\nSend-MailMessage DRT Unit Tests.Can send mail message using named parameters with multiple Cc\r\n```powershell\r\nExpected exactly 'user01@example.com', but got $null.\r\nat <ScriptBlock>, /Users/vsts/agent/2.150.3/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1: line 136\r\n136:         $mail.FromAddress | Should -BeExactly $InputObject.From\r\n```\r\nSend-MailMessage DRT Unit Tests.Can send mail message using named parameters with multiple Bcc\r\n```powershell\r\nExpected exactly 'user01@example.com', but got $null.\r\nat <ScriptBlock>, /Users/vsts/agent/2.150.3/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1: line 136\r\n136:         $mail.FromAddress | Should -BeExactly $InputObject.From\r\n```\r\n",
      "created_at": "2019-05-28T21:27:10Z",
      "updated_at": "2019-05-28T21:40:53Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@vexx32, your last commit had 12 failures in `PowerShell-CI-windows`\r\n(These are 5 of the failures)\r\n\r\nSend-MailMessage Feature Tests.Default Port 25.Can send mail with free-form email address\r\n```powershell\r\nExpected exactly 'user01@example.com', but got $null.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Send-MailMessage.Tests.ps1: line 247\r\n247:             $mail.FromAddress | Should -BeExactly \"user01@example.com\"\r\n```\r\nSend-MailMessage Feature Tests.Default Port 25.Can send mail with high priority\r\n```powershell\r\nExpected exactly 'urgent', but got $null.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Send-MailMessage.Tests.ps1: line 257\r\n257:             $mail.Priority | Should -BeExactly \"urgent\"\r\n```\r\nSend-MailMessage Feature Tests.Default Port 25.Can send mail with HTML content as body\r\n```powershell\r\nCannot index into a null array.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Send-MailMessage.Tests.ps1: line 269\r\n269:             $mail.Headers[\"content-type\"] | Should -BeLike \"text/html*\"\r\n\r\n```\r\nSend-MailMessage Feature Tests.Default Port 25.Can send mail with UTF8 encoding\r\n```powershell\r\nExpected exactly 1, but got 0.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Send-MailMessage.Tests.ps1: line 283\r\n283:             $mail.MessageParts.Count | Should -BeExactly 1\r\n```\r\nSend-MailMessage Feature Tests.Default Port 25.Can send mail with attachments\r\n```powershell\r\nExpected exactly 3, but got 0.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Send-MailMessage.Tests.ps1: line 303\r\n303:             $mail.MessageParts.Count | Should -BeExactly 3\r\n```\r\n",
      "created_at": "2019-05-28T21:33:43Z",
      "updated_at": "2019-05-28T21:40:47Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "We think this might be the issue:  https://github.com/PowerShell/PowerShell/pull/9748",
      "created_at": "2019-05-28T21:34:43Z",
      "updated_at": "2019-05-28T21:34:43Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@vexx32, your last commit had 84 failures in `PowerShell-CI-linux`\r\n(These are 5 of the failures)\r\n\r\nError occurred in test script '/home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1'\r\n```powershell\r\nCannot retrieve the dynamic parameters for the cmdlet. An exception was thrown by a TaskScheduler.\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1: line 11\r\n```\r\nError occurred in test script '/home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Set-Date.Tests.ps1'\r\n```powershell\r\nToo many open files\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Set-Date.Tests.ps1: line 4\r\n```\r\nError occurred in test script '/home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1'\r\n```powershell\r\nCannot retrieve the dynamic parameters for the cmdlet. An exception was thrown by a TaskScheduler.\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Send-MailMessage.Tests.ps1: line 11\r\n```\r\nError occurred in test script '/home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Set-Date.Tests.ps1'\r\n```powershell\r\nToo many open files\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/Set-Date.Tests.ps1: line 4\r\n```\r\nInvoke-WebRequest tests.Error occurred in Describe block\r\n```powershell\r\nThe 'Start-WebListener' command was found in the module 'WebListener', but the module could not be loaded. For more information, run 'Import-Module WebListener'.\r\nAt /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Utility/WebCmdlets.Tests.ps1:372 char:24\r\n```\r\n",
      "created_at": "2019-05-28T21:35:54Z",
      "updated_at": "2019-05-28T21:40:41Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "@PoshChan Please retry all",
      "created_at": "2019-05-28T21:41:25Z",
      "updated_at": "2019-05-28T21:41:25Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@TravisEz13, successfully started retry of `PowerShell-CI-static-analysis, PowerShell-CI-Windows, PowerShell-CI-macOS, PowerShell-CI-Linux`",
      "created_at": "2019-05-28T21:41:44Z",
      "updated_at": "2019-05-28T21:41:44Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "@iSazonov \tThis is assigned to you.  Do you want me to take this over?",
      "created_at": "2019-05-30T20:35:16Z",
      "updated_at": "2019-05-30T20:35:16Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "I thought we were waiting 7.0 Preview1 because no activity is from MSFT team.",
      "created_at": "2019-05-31T03:14:40Z",
      "updated_at": "2019-05-31T03:15:12Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@vexx32 Thanks for making our code clean!",
      "created_at": "2019-05-31T03:16:18Z",
      "updated_at": "2019-05-31T03:16:18Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "I have trouble working in messy files \ud83d\ude05 \r\n\r\nToo tempting to clean it as I work... better to clean it in advance. \ud83d\ude09 ",
      "created_at": "2019-05-31T03:35:59Z",
      "updated_at": "2019-05-31T03:35:59Z"
    },
    {
      "author": "msftbot[bot]",
      "author_association": "NONE",
      "body": ":tada:`v7.0.0-preview.2` has been released which incorporates this pull request.:tada:\n\nHandy links:\n* [Release Notes](https://github.com/PowerShell/PowerShell/releases/tag/v7.0.0-preview.2)\n",
      "created_at": "2019-07-17T20:55:11Z",
      "updated_at": "2019-07-17T20:55:11Z"
    }
  ],
  "created_at": "2019-05-26T05:56:49Z",
  "number": 9732,
  "state": "closed",
  "title": "Code Cleanup: Tidy up scriptblock.cs",
  "updated_at": "2019-07-17T20:55:11Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/623",
  "author": "andschwa",
  "body": "With the `Microsoft.PowerShell.Platform` module, I was able to massively improve the Pester tests cross-platform compatibility, such that tests that don't certain operating systems are skipped instead of silently passed (thanks @vors for the tip).\n\nSince this module is not (yet) a \"system\" module, the default profile imports it, and the CI systems import it manually (since they run with `--noprofile`).\n\nWhile I was at it, I also cleaned up all the Pester tests formatting; converted them to ASCII; removed hacky attempts to determine the OS and temporary folder; deprecated the repeated import of `Test-Common` (and removed it); and replaced a convoluted setting of `$here` with `$PSScriptRoot`.\n\nThe `PSVersionTable` tests were updated for the new `PSEdition` key/value pair. The `New-TimeSpan` test had its tolerance increased so it doesn't randomly fail. The `Get-Location` tests were corrected. The `Add-Type` test was re-enabled on Windows as the updated monad codebase fixed its failure.\n\nI think we should not import the module in the default profile, as it produces an error message when starting Core PowerShell on Windows because the default `PSModulePath` does not include `bin/Modules`. The `Platform` module should be added to the default set of modules so it is always loaded. The `PSModulePath` for Core PowerShell ought to always contain only `bin/Modules`. However, I'd like to do this in a separate work-item after discussion with the PowerShell teams.\n",
  "closed_at": "2016-03-05T00:43:30Z",
  "comments": [
    {
      "author": "andschwa",
      "author_association": "MEMBER",
      "body": "Note, for the best reviewing experience, use `git log -p` locally and ignore de6a452f63c03568f06411ec1e8313c5d664610c, 0aaf74bdcc2ef8ffda53d66feacc34e12c090568, and 0c6b14adab44f38e389ded923f90ab5c77aa643b.\n",
      "created_at": "2016-03-05T00:16:31Z",
      "updated_at": "2016-03-05T00:16:31Z"
    },
    {
      "author": "paulcallen",
      "author_association": "MEMBER",
      "body": "looks good\n",
      "created_at": "2016-03-05T00:42:31Z",
      "updated_at": "2016-03-05T00:42:31Z"
    },
    {
      "author": "andschwa",
      "author_association": "MEMBER",
      "body": "@paulcallen Thanks.\n",
      "created_at": "2016-03-05T00:43:27Z",
      "updated_at": "2016-03-05T00:43:27Z"
    }
  ],
  "created_at": "2016-03-05T00:05:15Z",
  "number": 623,
  "state": "closed",
  "title": "Add Microsoft.PowerShell.Platform module",
  "updated_at": "2016-03-05T00:43:36Z"
}
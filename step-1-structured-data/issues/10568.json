{
  "_url": "https://github.com/PowerShell/PowerShell/issues/10568",
  "author": "HR42",
  "body": "I want to start a PS shell from the explorer context menu on different folders.\r\nAt PS startup a tool should be configured with the actual folder path.\r\nI have tried a init / profile script for this purpose, but the pwd of the script is not the folder path: I get C:\\WINDOWS\\System32.\r\nI have also checked variables but non of the available values is set to the (future) folder path.\r\nHow can I get the folder path in this case?\r\nAfter the shell is started the correct folder path is available with pwd but this is to late for my purpose.",
  "closed_at": null,
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "I can not repo with latest PowerShell Core 7.0 build.\r\n\r\n@HR42 Please add more info about version and repo steps.\r\n\r\n![image](https://user-images.githubusercontent.com/22290914/65143604-d47fb200-da2e-11e9-9c9c-e1664fec9548.png)\r\n![image](https://user-images.githubusercontent.com/22290914/65143620-de091a00-da2e-11e9-8438-c01d5a6ab383.png)\r\n",
      "created_at": "2019-09-18T11:09:32Z",
      "updated_at": "2019-09-18T11:12:40Z"
    },
    {
      "author": "HR42",
      "author_association": "NONE",
      "body": "My version info:\r\n $PSVersionTable\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      5.1.17134.858\r\nPSEdition                      Desktop\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\r\nBuildVersion                   10.0.17134.858\r\nCLRVersion                     4.0.30319.42000\r\nWSManStackVersion              3.0\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\n\r\nPleas note that I start the PS from the context menu of the file explorer with the \"Open PowerShell window here\"! There I am trying to get the pwd of the new shell with a init / profile script. \r\n\r\nIf I do it with a PS shortcut (as your screen shot implies) the pwd of the profile script is as expected and match the \"Start in\" of the shortcut.",
      "created_at": "2019-09-18T12:06:04Z",
      "updated_at": "2019-09-18T12:09:17Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@HR42 The repo is only for PowerShell Core. Can you check with latest PowerShell Core build your scenario?\r\n\r\nPlease use UserVoice site to report Windows PowerShell issues and use forums to get support.",
      "created_at": "2019-09-18T12:51:14Z",
      "updated_at": "2019-09-18T12:51:14Z"
    },
    {
      "author": "HR42",
      "author_association": "NONE",
      "body": "Thank you for the pointer to UserVoice. I have submit the same question there:\r\nhttps://windowsserver.uservoice.com/forums/301869-powershell/suggestions/38626102-how-to-get-the-future-pwd-from-a-profile-script\r\n\r\nAnd of course I would also very appreciate any hint of the local experts ;-)\n\n<blockquote><img src=\"https://s3.amazonaws.com/uploads.uservoice.com/logo/design_setting/268950/original/WinServer_122x21_logoOnly.png?1430517494\" width=\"48\" align=\"right\"><div>Windows Server</div><div><strong><a href=\"https://windowsserver.uservoice.com/forums/301869-powershell/suggestions/38626102-how-to-get-the-future-pwd-from-a-profile-script\">How to get the future pwd from a profile script?</a></strong></div><div>I was pointed to this forum due to \r\nhttps://github.com/PowerShell/PowerShell/issues/10568\r\n\r\nI want to start a PS shell from the explorer context menu on different folders.\r\nAt PS startup a tool should be configured with the actual folder path.\r\nI have tried a init / profile script for this purpose, but the pwd of the script is not the folder path: I get C:\\WINDOWS\\System32.\r\nI have also checked variables but non of the available values is set to the (future) folder path.\r\nHow can I get the folder path in this case?\r\nAfter the shell is started the correct folder path is available with pwd but this is to late for my purpose.</div></blockquote>",
      "created_at": "2019-09-18T15:03:07Z",
      "updated_at": "2019-09-18T15:03:09Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@HR42 Add more info about your scenario so that we can repo.",
      "created_at": "2019-09-18T15:09:42Z",
      "updated_at": "2019-09-18T15:09:42Z"
    }
  ],
  "created_at": "2019-09-18T06:57:31Z",
  "number": 10568,
  "state": "open",
  "title": "How to get the future pwd from a profile script?",
  "updated_at": "2020-05-07T14:52:06Z"
}
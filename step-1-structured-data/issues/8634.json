{
  "_url": "https://github.com/PowerShell/PowerShell/issues/8634",
  "author": "daxian-dbw",
  "body": "<!-- Anything that looks like this is a comment and can't be seen after the Pull Request is created. -->  \r\n\r\n## PR Summary\r\n\r\nChanges are as follows:\r\n- Fix `FixupFileName` to not load an assembly in module analysis if the assembly path has been resolved. This way, the module analysis via `Get-Module -ListAvailable` wouldn't load the module assemblies unexpectedly.\r\n- Update the `RequiredAssemblies` processing to not add the same assembly to the `ToProcess` list twice, so that we can avoid loading the same assembly twice.\r\n- Remove unneeded `#if !CoreCLR` section about CLR version and .NET framework version.\r\n\r\n## PR Context  \r\n\r\n<!-- Provide a little reasoning as to why this Pull Request helps and why you have opened it. -->\r\n\r\n## PR Checklist\r\n\r\n- [x] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - Use the present tense and imperative mood when describing your changes\r\n- [x] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [ ] [Change is not breaking](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)\r\n- [ ] [Make sure all `.h`, `.cpp`, `.cs`, `.ps1` and `.psm1` files have the correct copyright header](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - If the PR is work in progress, please add the prefix `WIP:` or `[ WIP ]` to the beginning of the title (the `WIP` bot will keep its status check at `Pending` while the prefix is present) and remove the prefix when the PR is ready.  \r\n- **User-facing changes**\r\n    - [ ] Not Applicable\r\n    - **OR**  \r\n    - [ ] [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n        - [ ] Issue filed: <!-- Number/link of that issue here -->\r\n- **Testing - New and feature**\r\n    - [ ] N/A or can only be tested interactively\r\n    - **OR**\r\n    - [x] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n        - [x] [Add `[feature]` to your commit messages if the change is significant or affects feature tests](https://github.com/PowerShell/PowerShell/blob/master/docs/testing-guidelines/testing-guidelines.md#requesting-additional-tests-for-a-pr)\r\n",
  "closed_at": "2019-01-16T00:22:25Z",
  "comments": [
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@SteveL-MSFT The `-UseFuzzyMatch` test failed again because `ping.exe` cannot be found. It failed in the daily build too. Can you please take a look?",
      "created_at": "2019-01-14T17:41:11Z",
      "updated_at": "2019-01-14T17:41:11Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@adityapatwardhan Good point. I will add the feature tag.",
      "created_at": "2019-01-15T01:25:08Z",
      "updated_at": "2019-01-15T01:25:08Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "I expect that the PR increase performance but we haven't `CL-Performance` label.",
      "created_at": "2019-01-15T04:27:22Z",
      "updated_at": "2019-01-15T04:27:22Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@iSazonov Changes in this PR could improve the module analysis perf for binary modules in general, because we now avoid the loading. But for the warm startup where the analysis cache has already been created, there's likely no difference.\r\n\r\nThe change to `RequiredAssemblies` avoid a redundant call to `ExecutionContext.LoadAssembly`. It should improve the perf in general, but again won't be much because it was loading an already loaded assembly.\r\n\r\nThis PR is mainly to fix the wrong behavior and also make `FixupFileName` easier to understand, and thus I think it's more of a CL-general.",
      "created_at": "2019-01-15T08:10:47Z",
      "updated_at": "2019-01-15T18:00:09Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@daxian-dbw Great! \ud83d\udc4d ",
      "created_at": "2019-01-16T03:24:58Z",
      "updated_at": "2019-01-16T03:24:58Z"
    }
  ],
  "created_at": "2019-01-12T19:44:57Z",
  "number": 8634,
  "state": "closed",
  "title": "Fix 'FixupFileName' to not load resolved assembly during module discovery",
  "updated_at": "2019-01-16T03:24:59Z"
}
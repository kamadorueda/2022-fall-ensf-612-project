{
  "_url": "https://github.com/PowerShell/PowerShell/issues/8297",
  "author": "romero126",
  "body": "## PR Summary\r\n\r\n#### The Goal:\r\n    The Proposed change Allows for the capability to specify a specific SessionStateScope to Variable commandlets.\r\n    \r\n#### Example of new functionality:\r\n\r\n```\r\n    $Module = New-Module -Name \"TestVariables\" {\r\n        $script:TestGetVariable = \"True\"\r\n        $script:TestSetVariable = \"Set\"\r\n        $script:TestClearVariable = \"ShouldBeBlank\"\r\n        $Script:TestRemoveVariable = \"Should Not Exist\"\r\n        write-host \"Finished Loading Module\"\r\n    }\r\n    $Module = Import-Module $Module -PassThru\r\n    New-Variable -Scope $Module -Name \"TestNewVariable\" -Value \"True\"\r\n    Set-Variable -Scope $Module -Name \"TestSetVariable\" -Value \"True\"\r\n    Clear-Variable -Scope $Module -Name \"TestClearVariable\"\r\n    Remove-Variable -Scope $Module -Name \"TestRemoveVariable\"\r\n    Get-Variable -Scope $Module -Name \"Test*\"\r\n\r\n```\r\n\r\n#### Versus\r\n\r\n```\r\n    & (Get-Module ModuleName) { Get-Variable }\r\n\r\n```\r\n\r\n### Current issues this attempts to address:\r\nhttps://github.com/PowerShell/PowerShell/issues/8106 - \"-Scope Parameter on several Cmdlets not validated. Is this intentional? #8106\"\r\n- [X] Addresses the issue of parameters not Tab Completing correctly.\r\nhttps://github.com/PowerShell/PowerShell/pull/7941 - \"WIP: VariableFunctions outside of SessionState Capability #7941\"\r\n- [X] Addresses the underlying project issues\r\n     \r\n### Whats Changed:\r\n- [X] Extended Scope Parameter to handle multiple ScopeCapable object types (PSModuleInfo, SessionState, SessionStateScope)\r\n- [X] Added a Security so specified scopes outside of the core scope layers will throw an exception.\r\n- [X] Created Tests for *-Variable to handle the new influx of changes.\r\n- [X] Added the an AttributeCompletions() to Scope Attribute so it will assist with Tab Completion.\r\n- [] Add Get-CurrentScope cmdlet so users can Specify specific scopes to work out of.\r\n\r\n## PR Checklist\r\n\r\n- [X] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - Use the present tense and imperative mood when describing your changes\r\n- [X] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [X] [Change is not breaking](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)\r\n- [X] [Make sure all `.h`, `.cpp`, `.cs`, `.ps1` and `.psm1` files have the correct copyright header](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [ ] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - If the PR is work in progress, please add the prefix `WIP:` to the beginning of the title and remove the prefix when the PR is ready.\r\n- **User-facing changes**\r\n    - [ ] Not Applicable\r\n    - **OR**\r\n    - [X] User-facing [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n        - [ ] Issue filed - Issue link:\r\n- **Testing - New and feature**\r\n    - [ ] Not Applicable or can only be tested interactively\r\n    - **OR**\r\n    - [X] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n        - [ ] [Add `[feature]` if the change is significant or affects feature tests](https://github.com/PowerShell/PowerShell/blob/master/docs/testing-guidelines/testing-guidelines.md#requesting-additional-tests-for-a-pr)\r\n",
  "closed_at": "2018-12-05T23:45:20Z",
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@romero126 Thanks for your contribution!\r\n\r\nCould you please split the PR on some small PRs? It makes code reviews more simple and fast. Also for #8106 we have to wait PowerShell Committee conclusion.",
      "created_at": "2018-11-16T19:57:27Z",
      "updated_at": "2018-11-16T19:57:27Z"
    },
    {
      "author": "romero126",
      "author_association": "CONTRIBUTOR",
      "body": "@iSazonov I can always pull out #8106, however. \r\nPulling more out of the codebase would prevent it either 1 from working, or not satisfy all the requirements requested from prior conversations in #7941.\r\n\r\nThis is basically a resubmit since originally I branched off of my master. Which ended up making it harder to refactor code when new changes came in. Because the code base was vastly different and more simplified, putting it into a new submission would make more sense.",
      "created_at": "2018-11-16T23:24:44Z",
      "updated_at": "2018-11-16T23:24:44Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "cc @SteveL-MSFT Need PowerShell Committee conclusion here or in original issue.",
      "created_at": "2018-11-17T08:49:30Z",
      "updated_at": "2018-11-17T08:49:30Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@romero126 , thanks for your contribution and thinking about this problem!\r\n\r\n@PowerShell/powershell-committee reviewed this, working within module scope outside of the module scope isn't something we want to promote as a module is supposed to be self-contained.   Since this is an advanced use scenarios for developers, we believe the current syntax is sufficient.",
      "created_at": "2018-12-05T23:44:09Z",
      "updated_at": "2018-12-05T23:45:17Z"
    }
  ],
  "created_at": "2018-11-16T19:25:34Z",
  "number": 8297,
  "state": "closed",
  "title": "Allow capability to specify specific SessionStateScope for Variable cmdlets",
  "updated_at": "2019-01-17T04:26:57Z"
}
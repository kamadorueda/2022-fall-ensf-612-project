{
  "_url": "https://github.com/PowerShell/PowerShell/issues/4387",
  "author": "SteveL-MSFT",
  "body": "Affects NanoServer Insider build where WinRM is not available.  Currently if user tries `invoke-command`, powershell crashes.\r\n\r\nValidated using:\r\n```powershell\r\nPS> docker run -it -v C:\\users\\slee\\repos\\PowerShell\\src\\powershell-wincore\\bin\\Debug\\netcoreapp2.0\\win10-x64\\publish:c:\\powershell microsoft/nanoserver-insider-powershell\r\nPS> c:\\powershell\\powershell\r\nPS> invoke-command -computer . -command { \"hello\" }\r\n\r\ninvoke-command : WSMan client library is not installed\r\nAt line:1 char:1\r\n+ invoke-command -ComputerName . -Command { \"hello\" }\r\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    + CategoryInfo          : ResourceUnavailable: (:) [Invoke-Command], PSRemotingTransportException\r\n    + FullyQualifiedErrorId : System.Management.Automation.Remoting.PSRemotingDataStructureException,Microsoft.PowerSh\r\n   ell.Commands.InvokeCommandCommand\r\n```\r\n\r\nFix https://github.com/PowerShell/PowerShell/issues/4383",
  "closed_at": "2017-07-31T23:26:24Z",
  "comments": [],
  "created_at": "2017-07-28T23:12:36Z",
  "number": 4387,
  "state": "closed",
  "title": "Give error instead of crashing if WSMan client lib not available",
  "updated_at": "2017-08-01T00:07:30Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/13093",
  "author": "GrandArth",
  "body": "## Steps to reproduce\r\n1. Install Mediainfo\r\n2. Find any track with Japanese Tag\r\n```\r\nMediainfo 1-01.m4a\r\n```\r\n3.\r\n```\r\n$text=Mediainfo 1-01.m4a\r\n$text\r\n```\r\n\r\n## Expected behavior\r\nThis is the output that directly showed in the native terminal for PS7 with `Mediainfo 1-01.m4a`\r\n```\r\nGeneral\r\nComplete name                            : 1-01.m4a\r\nFormat                                   : MPEG-4\r\nFormat profile                           : Apple audio with iTunes info\r\nCodec ID                                 : M4A  (M4A /isom/iso2)\r\nFile size                                : 14.5 MiB\r\nDuration                                 : 1 min 55 s\r\nOverall bit rate mode                    : Variable\r\nOverall bit rate                         : 1 053 kb/s\r\nAlbum                                    : \u300c\u304a\u306d\u304c\u3044\u2606\u30c4\u30a4\u30f3\u30ba\u300d\u30b3\u30f3\u30d7\u30ea\u30fc\u30c8\u30b5\u30a6\u30f3\u30c9\u30c8\u30e9\u30c3\u30af\u300cPhotograph\u300d\r\nAlbum/Sorted by                          : \u300c\u30aa\u30cd\u30ac\u30a4\u2606\u30c4\u30a4\u30f3\u30ba\u300d\u30b3\u30f3\u30d7\u30ea\u30fc\u30c8\u30b5\u30a6\u30f3\u30c9\u30c8\u30e9\u30c3\u30af\u300cPhotograph\u300d\r\nAlbum/Performer                          : I've\r\nAlbum/Performer/Sort                     : Ive\r\nPart/Position                            : 1\r\nPart/Total                               : 2\r\nTrack name                               : Second Flight\uff08TV Size\uff09\r\nTrack name/Position                      : 1\r\nTrack name/Total                         : 32\r\nPerformer                                : KOTOKO / \u4f50\u85e4\u88d5\u7f8e\r\nPerformer/Sorted by                      : KOTOKO & \u30b5\u30c8\u30a6\u30d2\u30ed\u30df\r\nGenre                                    : \u30b2\u30fc\u30e0\u97f3\u697d\r\nRecorded date                            : 2005\r\nWriting application                      : Lavf58.42.102\r\nCover                                    : Yes\r\nTitle/Sort                               : \uff33\uff45\uff43\uff4f\uff4e\uff44\u3000\uff26 \uff4c\uff49\uff47\uff48\uff54\uff08\uff34\uff36\u3000\uff33\uff49\uff5a\uff45\uff09\r\n\r\nAudio\r\nID                                       : 1\r\nFormat                                   : ALAC\r\nCodec ID                                 : alac\r\nCodec ID/Info                            : Apple Lossless Audio Codec\r\nDuration                                 : 1 min 55 s\r\nDuration_LastFrame                       : -62 ms\r\nBit rate mode                            : Variable\r\nBit rate                                 : 1 050 kb/s\r\nNominal bit rate                         : 1 411 kb/s\r\nChannel(s)                               : 2 channels\r\nSampling rate                            : 44.1 kHz\r\nBit depth                                : 16 bits\r\nStream size                              : 14.5 MiB (100%)\r\nDefault                                  : Yes\r\nAlternate group                          : 1\r\n```\r\n\r\n## Actual behavior\r\nThis is what i got after storing the output into a variable (or redirect it to a file)\r\n```none\r\nGeneral\r\nComplete name                            : 1-01.m4a\r\nFormat                                   : MPEG-4\r\nFormat profile                           : Apple audio with iTunes info\r\nCodec ID                                 : M4A  (M4A /isom/iso2)\r\nFile size                                : 14.5 MiB\r\nDuration                                 : 1 min 55 s\r\nOverall bit rate mode                    : Variable\r\nOverall bit rate                         : 1 053 kb/s\r\nAlbum                                    : \u9286\u5c7b\u4eb0\u9287\ue15c\u4eb4\u9287\u52e8 \u69c5\u9289\u52e9\u5046\u9289\u70bd\u5064\u9286\u5d83\u505d\u9289\u70bd\u5123\u9289\ue042\u5157\u9289\u581b\u505f\u9288\ufe3a\u5142\u9289\u5908\u5113\u9289\u253f\u510d\u9288\ue218\u20ac\u5b6dhotograph\u9286?\r\nAlbum/Sorted by                          : \u9286\u5c7b\u5051\u9289\u5d83\u5053\u9288\u3082 \u69c5\u9289\u52e9\u5046\u9289\u70bd\u5064\u9286\u5d83\u505d\u9289\u70bd\u5123\u9289\ue042\u5157\u9289\u581b\u505f\u9288\ufe3a\u5142\u9289\u5908\u5113\u9289\u253f\u510d\u9288\ue218\u20ac\u5b6dhotograph\u9286?\r\nAlbum/Performer                          : I've\r\nAlbum/Performer/Sort                     : Ive\r\nPart/Position                            : 1\r\nPart/Total                               : 2\r\nTrack name                               : Second Flight\u951b\u5731V Size\u951b?\r\nTrack name/Position                      : 1\r\nTrack name/Total                         : 32\r\nPerformer                                : KOTOKO / \u6d63\u612f\u68e8\u7441\u66e0\u7de8\r\nPerformer/Sorted by                      : KOTOKO & \u9288\u70b9\u5113\u9288\ufe3a\u511d\u9289\ue15c\u512b\r\nGenre                                    : \u9288\u5c42\u5157\u9289\u72bb\u7176\u59a4?\r\nRecorded date                            : 2005\r\nWriting application                      : Lavf58.42.102\r\nCover                                    : Yes\r\nTitle/Sort                               : \u951b\u7b79\u7d7d\u951d\u51bf\u7d87\u951d\u5eaf \u7d7c\u9286\u20ac\u951b\ufe3c\u7d84\u951d\u591b\u7d7f\u951d\u582c\u7d8c\u951b\u582c\u5373\u951b\u8eb2\u20ac\u20ac\u951b\u7b79\u7d81\u951d\u6c3e\u7d7d\u951b?\r\n\r\nAudio\r\nID                                       : 1\r\nFormat                                   : ALAC\r\nCodec ID                                 : alac\r\nCodec ID/Info                            : Apple Lossless Audio Codec\r\nDuration                                 : 1 min 55 s\r\nDuration_LastFrame                       : -62 ms\r\nBit rate mode                            : Variable\r\nBit rate                                 : 1 050 kb/s\r\nNominal bit rate                         : 1 411 kb/s\r\nChannel(s)                               : 2 channels\r\nSampling rate                            : 44.1 kHz\r\nBit depth                                : 16 bits\r\nStream size                              : 14.5 MiB (100%)\r\nDefault                                  : Yes\r\nAlternate group                          : 1\r\n\r\n```\r\n\r\n## Environment data\r\n\r\n<!-- provide the output of $PSVersionTable -->\r\n\r\n```none\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.0.2\r\nPSEdition                      Core\r\nGitCommitId                    7.0.2\r\nOS                             Microsoft Windows 10.0.18363\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n",
  "closed_at": "2020-07-05T03:18:41Z",
  "comments": [
    {
      "author": "mklement0",
      "author_association": "CONTRIBUTOR",
      "body": "If the character encoding used by an external program doesn't match the encoding stored in `[console]::OutputEncoding`, PowerShell will misinterpret the program's output, _if captured or redirected_.\r\n\r\nAssuming that `MediaInfo` outputs UTF-16LE-encoded text, run the following beforehand (and restore the original encoding afterwards, if needed):\r\n\r\n```powershell\r\n[console]::OutputEncoding = [System.Text.UnicodeEncoding]::new()\r\n```\r\n\r\nGenerally, `[console]::OutputEncoding` still defaults to the active OEM code page on Windows, unfortunately - see #7233; on Unix-like platforms, it is sensibly UTF-8.\r\n",
      "created_at": "2020-07-04T16:21:46Z",
      "updated_at": "2020-07-05T03:20:10Z"
    },
    {
      "author": "GrandArth",
      "author_association": "NONE",
      "body": "Thx this sloves the problem for me.",
      "created_at": "2020-07-05T03:18:41Z",
      "updated_at": "2020-07-05T03:18:41Z"
    }
  ],
  "created_at": "2020-07-04T00:49:02Z",
  "labels": [
    "Issue-Question"
  ],
  "number": 13093,
  "state": "closed",
  "title": "Japanese String Incorrectly Encoded",
  "updated_at": "2020-07-05T03:20:10Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/2987",
  "author": "lzybkr",
  "body": "It's not clear why we were using a local cache for nuget packages, but the implementation used an environment variable which would affect other builds.\r\n\r\nIf there is a good reason to have a local cache, the environment variable should only be set while restoring packages for this project, basically save and restore the previous value around our restore.",
  "closed_at": "2017-01-17T21:00:53Z",
  "comments": [
    {
      "author": "vors",
      "author_association": "COLLABORATOR",
      "body": "@andschwa was it added to make caching on AppVeyor easier?\r\n@lzybkr Notice that cross-gen call need to be updated in this case.",
      "created_at": "2017-01-10T04:09:23Z",
      "updated_at": "2017-01-10T04:09:23Z"
    },
    {
      "author": "andschwa",
      "author_association": "MEMBER",
      "body": "@vors, @dantraMSFT added the custom NuGet package path in 2ae8f5c3a029f8407a5b8c7998a5e4f5b372e9bd.",
      "created_at": "2017-01-10T18:45:51Z",
      "updated_at": "2017-01-10T18:45:51Z"
    },
    {
      "author": "lzybkr",
      "author_association": "MEMBER",
      "body": "We're not caching in AppVeyor - we should add that (but these changes don't prevent I think).\r\n\r\nIt looks like the actual commit was 585eefc -  @dantraMSFT - the commit message and comment say what but not why - can you explain?",
      "created_at": "2017-01-10T21:58:56Z",
      "updated_at": "2017-01-10T21:58:56Z"
    },
    {
      "author": "lzybkr",
      "author_association": "MEMBER",
      "body": "I spoke with @dantraMSFT - he says the change was introduced to avoid build errors and help ensure reproducible builds.\r\n\r\nWe don't see issues on non-Windows systems, so maybe the problems have gone away. I think it's fine to merge, and if the problems come back, we can fix this the other way I proposed, by save/set/restore the environment variable.",
      "created_at": "2017-01-13T21:50:20Z",
      "updated_at": "2017-01-13T21:50:20Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@lzybkr After merge the commit to my local repo I can not build on Windows because of multiple errors\r\n> PowerShell\\src\\powershell-win-core\\project.json(87,47): error NU1001: The dependency System.Xml.XPath.XmlDocument >= 4.3.0 could not be resolved.\r\n\r\n`Start-PSBuild -Clean`  don't help. ",
      "created_at": "2017-01-18T08:44:31Z",
      "updated_at": "2017-01-18T10:00:27Z"
    },
    {
      "author": "lzybkr",
      "author_association": "MEMBER",
      "body": "Did you try -Restore?",
      "created_at": "2017-01-18T15:43:46Z",
      "updated_at": "2017-01-18T15:43:46Z"
    },
    {
      "author": "andschwa",
      "author_association": "MEMBER",
      "body": "Yeah this change is going to require people to `dotnet restore` again.",
      "created_at": "2017-01-18T21:28:57Z",
      "updated_at": "2017-01-18T21:28:57Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Thanks! `Start-PSBuild -Restore` resolve the problem.",
      "created_at": "2017-01-19T03:30:42Z",
      "updated_at": "2017-01-19T03:30:42Z"
    }
  ],
  "created_at": "2017-01-10T03:17:20Z",
  "number": 2987,
  "state": "closed",
  "title": "use global nuget package cache",
  "updated_at": "2017-01-19T03:30:42Z"
}
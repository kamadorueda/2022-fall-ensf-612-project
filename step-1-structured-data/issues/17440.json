{
  "_url": "https://github.com/PowerShell/PowerShell/issues/17440",
  "author": "heapifyman",
  "body": "### Prerequisites\n\n- [X] Write a descriptive title.\n- [X] Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\n- [X] Search the existing issues.\n- [X] Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\n- [X] Refer to [Differences between Windows PowerShell 5.1 and PowerShell](https://docs.microsoft.com/powershell/scripting/whats-new/differences-from-windows-powershell).\n\n### Steps to reproduce\n\n1. `dotnet tool install --global powershell`\r\n2. `pwsh`\n\n### Expected behavior\n\n```console\npowershell should start.\n```\n\n\n### Actual behavior\n\n```console\npowershell fails to start.\n```\n\n\n### Error details\n\n```console\nOne or more errors occurred. (The type initializer for 'System.Management.Automation.TypeAccelerators' threw an exception.)\r\nOne or more errors occurred. (The type initializer for 'System.Management.Automation.TypeAccelerators' threw an exception.)\r\nCannot load PSReadline module.  Console is running without PSReadline.\r\nProcess terminated. The type initializer for 'System.Management.Automation.PSObject' threw an exception.\r\n   at System.Environment.FailFast(System.String, System.Exception)\r\n   at Microsoft.PowerShell.UnmanagedPSEntry.Start(System.String[], Int32)\r\n   at Microsoft.PowerShell.ManagedPSEntry.Main(System.String[])\r\nSystem.TypeInitializationException: The type initializer for 'System.Management.Automation.PSObject' threw an exception.\r\n ---> System.IO.FileNotFoundException: Could not load file or assembly 'Microsoft.Management.Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'. The system cannot find the file specified.\r\n\r\nFile name: 'Microsoft.Management.Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'\r\n   --- End of inner exception stack trace ---\r\n   at System.Management.Automation.PSObject.get_Properties()\r\n   at System.Management.Automation.HostUtilities.GetDollarProfile(String allUsersAllHosts, String allUsersCurrentHost, String currentUserAllHosts, String currentUserCurrentHost)\r\n   at Microsoft.PowerShell.ConsoleHost.DoRunspaceInitialization(Boolean skipProfiles, String initialCommand, String configurationName, Collection`1 initialCommandArgs)\r\n   at Microsoft.PowerShell.ConsoleHost.DoCreateRunspace(String initialCommand, Boolean skipProfiles, Boolean staMode, String configurationName, Collection`1 initialCommandArgs)\r\n   at Microsoft.PowerShell.ConsoleHost.CreateRunspace(Object runspaceCreationArgs)\r\n   at Microsoft.PowerShell.ConsoleHost.DoRunspaceLoop(String initialCommand, Boolean skipProfiles, Collection`1 initialCommandArgs, Boolean staMode, String configurationName)\r\n   at Microsoft.PowerShell.ConsoleHost.Run(CommandLineParameterParser cpp, Boolean isPrestartWarned)\r\n   at Microsoft.PowerShell.ConsoleHost.Start(String bannerText, String helpText)\r\n   at Microsoft.PowerShell.UnmanagedPSEntry.Start(String[] args, Int32 argc)\r\n```\n```\n\n\n### Environment data\n\n```powershell\ndotnet --info                                                                                                                    \ue0b2 1 \u2718 \r\n.NET SDK (reflecting any global.json):\r\n Version:   6.0.102\r\n Commit:    49861cb924\r\n\r\nRuntime Environment:\r\n OS Name:     manjaro\r\n OS Version:  \r\n OS Platform: Linux\r\n RID:         arch-x64\r\n Base Path:   /usr/share/dotnet/sdk/6.0.102/\r\n\r\nHost (useful for support):\r\n  Version: 6.0.2\r\n  Commit:  839cdfb0ec\r\n\r\n.NET SDKs installed:\r\n  6.0.102 [/usr/share/dotnet/sdk]\r\n\r\n.NET runtimes installed:\r\n  Microsoft.AspNetCore.App 6.0.2 [/usr/share/dotnet/shared/Microsoft.AspNetCore.App]\r\n  Microsoft.NETCore.App 6.0.2 [/usr/share/dotnet/shared/Microsoft.NETCore.App]\r\n\r\nTo install additional .NET runtimes or SDKs:\r\n  https://aka.ms/dotnet-download\r\n```\n```\n\n\n### Visuals\n\n_No response_",
  "closed_at": null,
  "comments": [
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@adityapatwardhan Can you please take a look and comment?",
      "created_at": "2022-05-25T22:24:03Z",
      "updated_at": "2022-05-25T22:24:03Z"
    }
  ],
  "created_at": "2022-05-25T17:51:51Z",
  "number": 17440,
  "state": "open",
  "title": "PowerShell installed as global tool with .NET 6 fails to run on Manjaro",
  "updated_at": "2022-06-03T17:28:21Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/3997",
  "author": "geekosupremo",
  "body": "<!--\r\n\r\nIf it is a bug report:\r\n- make sure you are able to repro it on the latest released version. \r\nYou can install the latest version from https://github.com/PowerShell/PowerShell/releases\r\n- Search the existing issues.\r\n- Refer to the [FAQ](../docs/FAQ.md).\r\n- Refer to the [known issues](../docs/KNOWNISSUES.md).\r\n- Fill out the following repro template\r\n\r\nIf it's not a bug, please remove the template and elaborate the issue in your own words.\r\n-->\r\n\r\nSteps to reproduce\r\n------------------\r\n\r\n```bash\r\nsudo -i\r\ninput password\r\n```\r\n\r\n```powershell\r\nRemove-Item *.lnk\r\n```\r\n\r\nExpected behavior\r\n-----------------\r\n\r\n```none\r\ndelete the requested file(s)\r\n```\r\n\r\nActual behavior\r\n---------------\r\n\r\n```none\r\nRemove-Item : You do not have sufficient access rights to perform this operation.\r\nAt line:1 char:1\r\n+ Remove-Item *.lnk\r\n+ ~~~~~~~~~~~~~~~~~\r\n    + CategoryInfo          : PermissionDenied: (/mnt/FTVs/cpp-s... - Shortcut.lnk:FileInfo) [Remove-Item], IOExc\r\n   eption\r\n    + FullyQualifiedErrorId : RemoveFileSystemItemUnAuthorizedAccess,Microsoft.PowerShell.Commands.RemoveItemComm\r\n   and\r\n\r\n```\r\n\r\nEnvironment data\r\n----------------\r\n\r\n<!-- provide the output of $PSVersionTable -->\r\n\r\n```powershell\r\n> $PSVersionTable\r\nName                           Value\r\n----                           -----\r\nPSVersion                      6.0.0-beta\r\nPSEdition                      Core\r\nBuildVersion                   3.0.0.0\r\nCLRVersion\r\nGitCommitId                    v6.0.0-beta.2\r\nOS                             Linux 4.4.0-79-generic #100-Ubuntu SMP Wed May 17 19:58:14 UTC 2017\r\nPlatform                       Unix\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n\r\n\r\n```\r\nI'm confused. Does PowerShell not use the permission level of the user?",
  "closed_at": "2017-06-14T01:03:00Z",
  "comments": [
    {
      "author": "MaximoTrinidad",
      "author_association": "NONE",
      "body": "@geekosupremo,\r\n\r\nI'm getting a different behavior.  \r\n\r\n1. Regular User, in PowerShell (**Windows 10 Build 16215 Bash Console**) executing command:\r\nsudo -i -> takes me to the super-user root prompt\r\n\r\n2. Then, I run again PowerShell which it loads as admin privileges.\r\n\r\n3. I can execute:\r\nremove-item '/mnt/c/Users/mtrinidad/Desktop/myapp.exe - Shortcut.lnk'\r\n\r\n4. Type 'exit' twice to get back to the User PowerShell prompt and keep working.\r\n\r\nWhich Linux OS distribution you're on?\r\n\r\nI'm using PowerShell Beta version:\r\n```\r\nPS /home/maxt/Documents> $PSVersionTable\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      6.0.0-beta\r\nPSEdition                      Core\r\nBuildVersion                   3.0.0.0\r\nCLRVersion\r\nGitCommitId                    v6.0.0-beta.2\r\nOS                             Linux 4.4.0-43-Microsoft #1-Microsoft Wed Dec 31 14:42:53 PST 2014\r\nPlatform                       Unix\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```",
      "created_at": "2017-06-13T16:18:36Z",
      "updated_at": "2017-06-13T16:18:36Z"
    },
    {
      "author": "geekosupremo",
      "author_association": "NONE",
      "body": "@MaximoTrinidad \r\n\r\nI'm using Ubuntu Server 16.04.02 LTS",
      "created_at": "2017-06-13T16:24:41Z",
      "updated_at": "2017-06-13T16:24:41Z"
    },
    {
      "author": "geekosupremo",
      "author_association": "NONE",
      "body": "New twist/wrinkle:\r\n\r\nI hopped back into PowerShell from the SuperUser account and tried \r\n```powershell\r\nRemove-Item *perp*\r\n```\r\nAnd it worked just fine. So it must be something todo with the _.lnk_ files",
      "created_at": "2017-06-13T16:56:35Z",
      "updated_at": "2017-06-13T16:56:35Z"
    },
    {
      "author": "MaximoTrinidad",
      "author_association": "NONE",
      "body": "@geekosupremo,\r\n\r\nGreat!! You just show me a nice command 'sudo -i'.  Good stuff!\r\n:)\r\n",
      "created_at": "2017-06-13T17:02:25Z",
      "updated_at": "2017-06-13T17:02:25Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "Need more specific repro steps both for creating the .lnk shortcut as well as when you start powershell",
      "created_at": "2017-06-13T17:20:48Z",
      "updated_at": "2017-06-13T17:20:48Z"
    },
    {
      "author": "geekosupremo",
      "author_association": "NONE",
      "body": "@SteveL-MSFT \r\n\r\nThe *.lnk* files were generated by users, created outside of my control. Most likely by 'drag n drop' on the Windows 7/8.1 workstations, and probably by accident, since they're not always the most savvy users.\r\n\r\nI instigate PowerShell on the Ubuntu server usually at the end of day. This time I'm doing it early to do a little 'active' maintenance.\r\n\r\nOh! one thing I forgot to add, most of these files come from a backedup archive of the shared folder. I moved them from the archive using rsync. Specifically, \r\n```bash\r\nrsync -atP [source archive]/ /[destinataion]\r\n```\r\n\r\nDoes that clarify things @SteveL-MSFT ?\r\n\r\n",
      "created_at": "2017-06-13T17:29:24Z",
      "updated_at": "2017-06-13T17:30:47Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@geekosupremo unfortunately I'm not able to repro the issue.  It would be ideal if you can produce a simple manual repro.  Thanks!",
      "created_at": "2017-06-13T19:40:19Z",
      "updated_at": "2017-06-13T19:40:19Z"
    },
    {
      "author": "geekosupremo",
      "author_association": "NONE",
      "body": "@SteveL-MSFT \r\n\r\nI have gotten the \"insufficient permissions\" to pop up again.\r\n\r\nI'm still in `sudo -i`\r\n\r\n```powershell\r\nPS /mnt/FTVs> whoami\r\n\r\nPS /mnt/FTVs> whoami\r\nroot\r\nPS /mnt/FTVs> gci TES*\r\n\r\n\r\n    Directory: /mnt/FTVs\r\n\r\n\r\nMode                LastWriteTime         Length Name\r\n----                -------------         ------ ----\r\n--r---          1/25/17  12:25 PM        1224715 TESTFAXJM.pdf\r\n--r---          7/14/16   1:39 PM        1237811 TESTFAXKIM.pdf\r\n--r---           4/5/16   7:35 AM        1237919 TESTTTTTFAXXXX.pdf\r\n\r\n\r\nPS /mnt/FTVs> gci TES* | Remove-Item\r\nRemove-Item : You do not have sufficient access rights to perform this operation.\r\nAt line:1 char:12\r\n+ gci TES* | Remove-Item\r\n+            ~~~~~~~~~~~\r\n    + CategoryInfo          : PermissionDenied: (/mnt/FTVs/TESTFAXJM.pdf:FileInfo) [Remove-Item], IOException\r\n    + FullyQualifiedErrorId : RemoveFileSystemItemUnAuthorizedAccess,Microsoft.PowerShell.Commands.RemoveItemComm\r\n   and\r\n\r\nRemove-Item : You do not have sufficient access rights to perform this operation.\r\nAt line:1 char:12\r\n+ gci TES* | Remove-Item\r\n+            ~~~~~~~~~~~\r\n    + CategoryInfo          : PermissionDenied: (/mnt/FTVs/TESTFAXKIM.pdf:FileInfo) [Remove-Item], IOException\r\n    + FullyQualifiedErrorId : RemoveFileSystemItemUnAuthorizedAccess,Microsoft.PowerShell.Commands.RemoveItemComm\r\n   and\r\n\r\nRemove-Item : You do not have sufficient access rights to perform this operation.\r\nAt line:1 char:12\r\n+ gci TES* | Remove-Item\r\n+            ~~~~~~~~~~~\r\n    + CategoryInfo          : PermissionDenied: (/mnt/FTVs/TESTTTTTFAXXXX.pdf:FileInfo) [Remove-Item], IOExceptio\r\n   n\r\n    + FullyQualifiedErrorId : RemoveFileSystemItemUnAuthorizedAccess,Microsoft.PowerShell.Commands.RemoveItemComm\r\n   and\r\n\r\n```\r\noutput of `ls` for background\r\n```bash\r\nroot@cppshare01:~# ls -lah /mnt/FTVs | egrep TES*\r\n-rwxr--r-- 1 1001 1001  1.2M Apr  8  2016 495216TESTFAX.pdf\r\n-rwxr--r-- 1 1001 1001  1.2M May  2  2016 509629 TEST FAX.pdf\r\n-rwxr--r-- 1 1001 1001  1.2M May  2  2016 509629TESTFAX.pdf\r\n-rwxr--r-- 1 1001 1001  1.2M May 28  2016 521522TEST.pdf\r\n-rwxr--r-- 1 1001 1001  1.2M Nov 21  2016 590714 TEDDYA.pdf\r\n-rwxr--r-- 1 1001 1001  1.2M Nov 17  2016 590714 TEDDY.pdf\r\n-rwxr--r-- 1 1001 1001   242 Dec  8  2016 EMAIL TEM.txt\r\n-rwxr--r-- 1 1001 1001   282 Dec 27 10:14 JESSICATEMP.txt\r\n-rwxr--r-- 1 1001 1001  261K Jan 14  2016 JESSICA TEST FAX 0114.pdf\r\n-rwxr--r-- 1 1001 1001   195 Jan  6 06:39 JGNOTE.txt\r\n-rwxr--r-- 1 1001 1001   529 Feb  8 09:00 LACTATED RINGER SOULTION TEMP..txt\r\n-rwxrwxrwx 1 root root  261K Apr 23  2015 MILLY TEST FAX.pdf\r\n-rwxrwxrwx 1 root root  1.8K Sep 12  2016 MO TEMPLET.txt\r\n-rwxr--r-- 1 1001 1001   174 Nov  4  2016 NOTES.txt\r\n-rwxr--r-- 1 1001 1001  1.2M Sep  7  2016 STEPHEN KELLY.pdf\r\n-rwxr--r-- 1 1001 1001  1.2M Jan 25 12:25 TESTFAXJM.pdf\r\n-rwxr--r-- 1 1001 1001  1.2M Jul 14  2016 TESTFAXKIM.pdf\r\n-rwxr--r-- 1 1001 1001  1.2M Apr  5  2016 TESTTTTTFAXXXX.pdf\r\n```\r\nHmmm ...\r\n\r\nOk so I found this other issue thread [https://github.com/PowerShell/PowerShell/issues/3232](https://github.com/PowerShell/PowerShell/issues/3232)\r\nAnd the 'fix' for it was to use `-Force`\r\n\r\nAnd this does work for me too. So am I just not understanding how `Remove-Item` works on linux?",
      "created_at": "2017-06-14T00:02:10Z",
      "updated_at": "2017-06-14T00:09:44Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "It looks like you are using WSL (Bash on Windows) which may have this behavior as `root` in Bash may not necessarily be the same as `admin` on Windows and those files are owned by other Windows users.",
      "created_at": "2017-06-14T01:03:00Z",
      "updated_at": "2017-06-14T01:03:00Z"
    },
    {
      "author": "geekosupremo",
      "author_association": "NONE",
      "body": "@SteveL-MSFT \r\nNot quite. While I am getting to the server from a Windows 7 box, it is via Putty & SSH.\r\n\r\nYou do probably have the right of it when it comes to file ownership. I'll look into that tomorrow when I'm back at work.",
      "created_at": "2017-06-14T02:18:43Z",
      "updated_at": "2017-06-14T02:18:43Z"
    }
  ],
  "created_at": "2017-06-13T15:40:44Z",
  "number": 3997,
  "state": "closed",
  "title": "While logged in as root get a permission error",
  "updated_at": "2017-06-14T02:18:43Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/5891",
  "author": "Stanzilla",
  "body": "## PR Summary\r\n\r\nChanges the Windows start menu folder name from `ProductSemanticVersionWithName` to `ProductSemanticVersionWithNameAndOptionalArchitecture` as discussed in https://github.com/PowerShell/PowerShell/issues/5884.\r\n\r\nFix #5884 \r\n\r\nBefore:\r\n![explorer_2018-01-13_00-55-39](https://user-images.githubusercontent.com/75278/34899978-8f04021e-f7fc-11e7-8d8a-7596b2f427b6.png)\r\n\r\nAfter: \r\n![explorer_2018-01-13_00-58-43](https://user-images.githubusercontent.com/75278/34900027-f197210e-f7fc-11e7-9faf-9ac4f8e097c1.png)\r\n\r\n\r\n## PR Checklist\r\n\r\nNote: Please mark anything not applicable to this PR `NA`.\r\n\r\n- [x] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] Use the present tense and imperative mood when describing your changes\r\n- [x] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [ ] User facing [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - [x] Issue filed - Issue link: https://github.com/PowerShell/PowerShell/issues/5884\r\n- [x] [Change is not breaking](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)\r\n- [ ] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n    - [ ] [Add `[feature]` if the change is significant or affects feature tests](https://github.com/PowerShell/PowerShell/blob/master/docs/testing-guidelines/testing-guidelines.md#requesting-additional-tests-for-a-pr)\r\n- [x] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - If the PR is work in progress, please add the prefix `WIP:` to the beginning of the title and remove the prefix when the PR is ready.\r\n",
  "closed_at": "2018-01-26T04:14:55Z",
  "comments": [
    {
      "author": "bergmeister",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks and welcome to the PowerShell Open Source community. Very minor but if you add e.g. the word 'fix' before the issue number in the summary, your issue will get closed automatically upon completion of this PR (I learnt this myself only recently from others, see [here](https://help.github.com/articles/closing-issues-using-keywords/))",
      "created_at": "2018-01-12T23:52:21Z",
      "updated_at": "2018-01-12T23:53:06Z"
    },
    {
      "author": "bergmeister",
      "author_association": "CONTRIBUTOR",
      "body": "OK. I have downloaded and installed it and it looks now like that as expected (i.e. to hypen in the folder name):\r\n![image](https://user-images.githubusercontent.com/9250262/34900001-5a07c9ae-f7f4-11e7-8ca2-cf7be8956d3b.png)\r\nYou can do this also yourself if you want to: Just click on 'Details' besides the appveyor check, then click on 'Artifacts' and here you can download the msi from your PR.",
      "created_at": "2018-01-12T23:59:27Z",
      "updated_at": "2018-01-12T23:59:27Z"
    },
    {
      "author": "Stanzilla",
      "author_association": "CONTRIBUTOR",
      "body": "Hrm, wouldn't it be better if the folder itself was just called `PowerShell` and all side by side installs just add a shortcut that has their version number to that folder?\r\n\r\nas in\r\n\r\n>PowerShell\r\n>> PowerShell 6.0.lnk\r\n>> PowerShell 6.0.1-preview.7591.lnk\r\n\r\nand thanks for the warm welcome :)",
      "created_at": "2018-01-12T23:59:49Z",
      "updated_at": "2018-01-13T00:01:23Z"
    },
    {
      "author": "bergmeister",
      "author_association": "CONTRIBUTOR",
      "body": "Given that 6.0 has already shipped, maintainers might disagree with the common root folder approach but your suggestion is certainly worth (another) discussion. Therefore I approve this change but let's discuss the other option in a separate issue.",
      "created_at": "2018-01-13T00:06:15Z",
      "updated_at": "2018-01-13T00:06:31Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "I am fine to rename the start folder name to `PowerShell` without version. I think we don't confuse users and don't break anything.\r\n@SteveL-MSFT Thoughts?",
      "created_at": "2018-01-13T07:39:34Z",
      "updated_at": "2018-01-13T07:39:34Z"
    },
    {
      "author": "Stanzilla",
      "author_association": "CONTRIBUTOR",
      "body": "@bergmeister @iSazonov I replaced `ProductSemanticVersionWithNameAndOptionalArchitecture` with just `$(var.ProductName)` which should be the correct thing to make it just `PowerShell`, I think!\r\n\r\nYup, here we go: ![](https://i.imgur.com/sg0fUYF.png)\r\n\r\n",
      "created_at": "2018-01-13T14:46:56Z",
      "updated_at": "2018-01-19T23:35:22Z"
    },
    {
      "author": "Stanzilla",
      "author_association": "CONTRIBUTOR",
      "body": "@bergmeister are you ok with this after my changes?",
      "created_at": "2018-01-19T18:04:10Z",
      "updated_at": "2018-01-19T18:04:10Z"
    },
    {
      "author": "bergmeister",
      "author_association": "CONTRIBUTOR",
      "body": "@Stanzilla I as a community contributor cannot merge a PR or make the final decision on it. I myself only happen to be a very active community member and I happen to have made a lot of installer features, improvements and fixes recently. Therefore I can only say it is OK from a code perspective but it needs product management approval from the MS side.  Personally, I think it is a change for the better moving forward but there is this downside that when 6.0 and 6.1 are installed that it will look a bit odd...\r\nThe guys at MS were quite busy releasing the 6.0.1 patch this week therefore if you don't get an answer by the end of next week, then let's ping Steve and he usually gets stuff sorted quite quickly. In the meantime enjoy using your custom version of PowerShell :-)",
      "created_at": "2018-01-19T18:45:04Z",
      "updated_at": "2018-01-19T18:45:04Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@bergmeister If you are ok with the PR please change status to approve.",
      "created_at": "2018-01-19T18:53:51Z",
      "updated_at": "2018-01-19T18:53:51Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT Could you please review?",
      "created_at": "2018-01-19T19:22:37Z",
      "updated_at": "2018-01-19T19:22:37Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "I'm ok with the proposed changes.  However, I would like @joeyaiello as the PM to make the call here.",
      "created_at": "2018-01-19T23:36:38Z",
      "updated_at": "2018-01-19T23:36:38Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT @joeyaiello What is your conclusion?",
      "created_at": "2018-01-24T07:50:50Z",
      "updated_at": "2018-01-24T07:50:50Z"
    },
    {
      "author": "joeyaiello",
      "author_association": "CONTRIBUTOR",
      "body": "I love the shared folder approach, looks great. \ud83d\udc4d \r\n\r\nThanks for the contribution, @Stanzilla! ",
      "created_at": "2018-01-25T20:23:22Z",
      "updated_at": "2018-01-25T20:23:22Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Please clarify - I see \r\n![ps-menu](https://user-images.githubusercontent.com/22290914/35424863-7cdbb2ce-024e-11e8-9569-7c94ec34a166.png)\r\n\r\nIs that what we want in explorer.exe? Should we fix this too?",
      "created_at": "2018-01-26T04:08:48Z",
      "updated_at": "2018-01-26T04:12:04Z"
    },
    {
      "author": "Stanzilla",
      "author_association": "CONTRIBUTOR",
      "body": "@iSazonov I was actually already thinking about mentioning that but I could not come up with a better solution yet. Are side-by-side installations actually possible? So far the installer always overwrote my current installation. One solution here would be to do:\r\n\r\nPowerShell >\r\n\tOpen here (6.1.0-preview.7604)\r\n\tOpen here as Administrator (6.1.0-preview.7604)\r\n\tOpen here (6.1.0)\r\n\tOpen here as Administrator (6.1.0)\r\n\r\n\r\nBut that gets really long...",
      "created_at": "2018-01-26T11:57:10Z",
      "updated_at": "2018-01-26T11:57:10Z"
    },
    {
      "author": "bergmeister",
      "author_association": "CONTRIBUTOR",
      "body": "@stanzilla: that is because you need to also change the minor version to have side by side. I can do some mockups but at the moment I am concerned that there might not be enough space in the submenu for preview versions.\r\nThe bigger concern is that it could make the root registry not unique any more in case someone has already defined a context menu named \"PowerShell\" (e.g. for Windows PowerShell)",
      "created_at": "2018-01-26T12:34:50Z",
      "updated_at": "2018-01-26T12:34:50Z"
    },
    {
      "author": "bergmeister",
      "author_association": "CONTRIBUTOR",
      "body": "I was also thinking about rather using 'PowerShell Core' for the top sub menu (in the start menu and explorer context menu) to avoid ambiguity but that might bite us in later version when PowerShell Core will replace Windows PowerShell (in the far future)",
      "created_at": "2018-01-26T12:36:47Z",
      "updated_at": "2018-01-26T12:36:47Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": ">But that gets really long...\r\n\r\nWe should consider only release versions - they have short names.\r\n\r\n>The bigger concern is that it could make the root registry not unique any more in case someone has already defined a context menu named \"PowerShell\" (e.g. for Windows PowerShell)\r\n\r\nThe same is true for Start menu but we don't concern about it (this already was approved).\r\n\r\nI see other products (7zip, WinRar) use unified name in folder menu.",
      "created_at": "2018-01-26T15:56:19Z",
      "updated_at": "2018-01-26T15:56:19Z"
    },
    {
      "author": "bergmeister",
      "author_association": "CONTRIBUTOR",
      "body": "@iSazonov Fair points, but:\r\n> The same is true for Start menu but we don't concern about it (this already was approved).\r\n\r\nThe difference is that the start menu is represented by a directory where we would just create a shortcut in an already existing directory if there was already a start menu entry called 'PowerShell', so no problem. The explorer context menu is however represented by a registry entry where we could clash and override the existing entry.",
      "created_at": "2018-01-26T17:58:14Z",
      "updated_at": "2018-01-26T17:58:43Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@bergmeister Do you know the examples for \"PowerShell\"?",
      "created_at": "2018-01-26T18:06:17Z",
      "updated_at": "2018-01-26T18:06:17Z"
    },
    {
      "author": "bergmeister",
      "author_association": "CONTRIBUTOR",
      "body": "@iSazonov See [here](https://www.google.co.uk/amp/s/www.howtogeek.com/165268/how-to-add-open-powershell-here-to-the-context-menu-in-windows/amp/) for an example but it seems that Windows PowerShell has already taken the entry 'PowerShell'.",
      "created_at": "2018-01-26T18:24:32Z",
      "updated_at": "2018-01-26T18:24:32Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "It is HowTo. I meant popular projects with which there might be a conflict.",
      "created_at": "2018-01-26T18:37:19Z",
      "updated_at": "2018-01-26T18:37:19Z"
    }
  ],
  "created_at": "2018-01-12T23:39:48Z",
  "number": 5891,
  "state": "closed",
  "title": "[Windows] Rework start menu folder name",
  "updated_at": "2018-01-26T18:37:19Z"
}
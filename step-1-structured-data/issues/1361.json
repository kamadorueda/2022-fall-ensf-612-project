{
  "_url": "https://github.com/PowerShell/PowerShell/issues/1361",
  "author": "daxian-dbw",
  "body": "## Regression Note\n\nThe same repo works on Nano powershell. So it's a regression in PowerShell Core.\n## Steps to reproduce\n\n$code = @'\n[System.Management.Automation.Cmdlet(\"Get\", \"Thing\", ConfirmImpact = System.Management.Automation.ConfirmImpact.High, SupportsPaging = true)]\npublic class Test {}\n'@\nAdd-Type -TypeDefinition $code\n## Expected behavior\n\nAdd-Type works, and [Test] will return the added type\n## Actual behavior\n\nAdd-Type throws a bunch errors\n\n```\nPS C:\\> Add-Type -TypeDefinition $code\nAdd-Type : (1) : Cannot apply attribute class 'Cmdlet' because it is abstract\n(1) : >>> [System.Management.Automation.Cmdlet(\"Get\", \"Thing\", ConfirmImpact =\nSystem.Management.Automation.ConfirmImpact.High, SupportsPaging = true)]\n(2) : public class Test {}\nAt line:1 char:1\n+ Add-Type -TypeDefinition $code\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : InvalidData: (Microsoft.Power...peCompilerError:AddTypeCompilerError) [Add-Type], Except\n   ion\n    + FullyQualifiedErrorId : SOURCE_CODE_ERROR,Microsoft.PowerShell.Commands.AddTypeCommand\n\nAdd-Type : (1) : The type 'Object' is defined in an assembly that is not referenced. You must add a reference to\nassembly 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'.\n(1) : >>> [System.Management.Automation.Cmdlet(\"Get\", \"Thing\", ConfirmImpact =\nSystem.Management.Automation.ConfirmImpact.High, SupportsPaging = true)]\n(2) : public class Test {}\nAt line:1 char:1\n+ Add-Type -TypeDefinition $code\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : InvalidData: (Microsoft.Power...peCompilerError:AddTypeCompilerError) [Add-Type], Except\n   ion\n    + FullyQualifiedErrorId : SOURCE_CODE_ERROR,Microsoft.PowerShell.Commands.AddTypeCommand\n\nAdd-Type : (1) : The type or namespace name 'ConfirmImpact' could not be found (are you missing a using directive or\nan assembly reference?)\n(1) : >>> [System.Management.Automation.Cmdlet(\"Get\", \"Thing\", ConfirmImpact =\nSystem.Management.Automation.ConfirmImpact.High, SupportsPaging = true)]\n(2) : public class Test {}\nAt line:1 char:1\n+ Add-Type -TypeDefinition $code\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : InvalidData: (Microsoft.Power...peCompilerError:AddTypeCompilerError) [Add-Type], Except\n   ion\n    + FullyQualifiedErrorId : SOURCE_CODE_ERROR,Microsoft.PowerShell.Commands.AddTypeCommand\n\nAdd-Type : (1) : The type 'Enum' is defined in an assembly that is not referenced. You must add a reference to\nassembly 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'.\n(1) : >>> [System.Management.Automation.Cmdlet(\"Get\", \"Thing\", ConfirmImpact =\nSystem.Management.Automation.ConfirmImpact.High, SupportsPaging = true)]\n(2) : public class Test {}\nAt line:1 char:1\n+ Add-Type -TypeDefinition $code\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : InvalidData: (Microsoft.Power...peCompilerError:AddTypeCompilerError) [Add-Type], Except\n   ion\n    + FullyQualifiedErrorId : SOURCE_CODE_ERROR,Microsoft.PowerShell.Commands.AddTypeCommand\n\nAdd-Type : (1) : The type 'Object' is defined in an assembly that is not referenced. You must add a reference to\nassembly 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'.\n(1) : >>> [System.Management.Automation.Cmdlet(\"Get\", \"Thing\", ConfirmImpact =\nSystem.Management.Automation.ConfirmImpact.High, SupportsPaging = true)]\n(2) : public class Test {}\nAt line:1 char:1\n+ Add-Type -TypeDefinition $code\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : InvalidData: (Microsoft.Power...peCompilerError:AddTypeCompilerError) [Add-Type], Except\n   ion\n    + FullyQualifiedErrorId : SOURCE_CODE_ERROR,Microsoft.PowerShell.Commands.AddTypeCommand\n\nAdd-Type : (1) : The type or namespace name 'SupportsPaging' could not be found (are you missing a using directive or\nan assembly reference?)\n(1) : >>> [System.Management.Automation.Cmdlet(\"Get\", \"Thing\", ConfirmImpact =\nSystem.Management.Automation.ConfirmImpact.High, SupportsPaging = true)]\n(2) : public class Test {}\nAt line:1 char:1\n+ Add-Type -TypeDefinition $code\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : InvalidData: (Microsoft.Power...peCompilerError:AddTypeCompilerError) [Add-Type], Except\n   ion\n    + FullyQualifiedErrorId : SOURCE_CODE_ERROR,Microsoft.PowerShell.Commands.AddTypeCommand\n\nAdd-Type : Cannot add type. Compilation errors occurred.\nAt line:1 char:1\n+ Add-Type -TypeDefinition $code\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : InvalidData: (:) [Add-Type], InvalidOperationException\n    + FullyQualifiedErrorId : COMPILER_ERRORS,Microsoft.PowerShell.Commands.AddTypeCommand\n```\n## Environment data\n\n``` powershell\n> $PSVersionTable\nName                           Value\n----                           -----\nGitCommitId                    v0.6.0-38-gfa80214f22559e365f17dc759b00627bce086eca-dirty\nCLRVersion\nPSEdition                      Core\nWSManStackVersion              3.0\nPSRemotingProtocolVersion      2.3\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\nBuildVersion                   3.0.0.0\nPSVersion                      5.1.10032.0\nSerializationVersion           1.1.0.1\n```\n",
  "closed_at": "2016-07-27T01:37:29Z",
  "comments": [
    {
      "author": "vors",
      "author_association": "COLLABORATOR",
      "body": "I suspect it's due to the difference in the layout for `dotnet build` vs `dotnet publish`.\nWe need to try it on the released version (it's flatter).\n",
      "created_at": "2016-07-13T21:46:03Z",
      "updated_at": "2016-07-13T21:46:03Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "The issue repros in the publish folder, and also repros in powershell-release-0.6.0.\n",
      "created_at": "2016-07-13T21:49:27Z",
      "updated_at": "2016-07-13T21:49:27Z"
    }
  ],
  "created_at": "2016-07-13T21:43:18Z",
  "number": 1361,
  "state": "closed",
  "title": "Add-Type doesn't work in PowerShell Core on Windows",
  "updated_at": "2016-08-17T07:44:56Z"
}
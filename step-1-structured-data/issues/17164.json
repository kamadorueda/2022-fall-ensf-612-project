{
  "_url": "https://github.com/PowerShell/PowerShell/issues/17164",
  "author": "DG-Riester",
  "body": "### Prerequisites\r\n\r\n- [X] Write a descriptive title.\r\n- [X] Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\r\n- [X] Search the existing issues.\r\n- [X] Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\r\n- [X] Refer to [Differences between Windows PowerShell 5.1 and PowerShell](https://docs.microsoft.com/powershell/scripting/whats-new/differences-from-windows-powershell).\r\n\r\n### Steps to reproduce\r\n```console\r\nAdd-Type -AssemblyName Microsoft.VisualBasic\r\n\r\n$DCs = @()\r\n$DCs += \"DC-01\"\r\n$DCs += \"DC-02\"\r\n$DCs += \"DC-03\"\r\n\r\n$msg_StartTime = 'Enter Start Date with following format:\r\n'YYYY-mm-DDTHH:MM:SS --> \r\ne.g. 2022-04-19T13:10:32'\r\n$title_StartTime = 'Start Time'\r\n$StartTime = [Microsoft.VisualBasic.Interaction]::InputBox($msg_StartTime, $title_StartTime)\r\n\r\n$msg_EndTime = 'Enter End Date with following format:\r\n'YYYY-mm-DDTHH:MM:SS --> \r\ne.g. 2022-04-19T13:10:32'\r\n$title_EndTime = 'End Time'\r\n$EndTime = [Microsoft.VisualBasic.Interaction]::InputBox($msg_EndTime, $title_EndTime)\r\n\r\n$StartDate = Get-Date -Date $StartTime\r\n\r\nif($EndTime -eq ''){\r\n    $EndDate = Get-Date -ErrorAction Stop\r\n    Foreach($DC in $DCs){\r\n            Get-WinEvent -ComputerName $DC -ErrorAction Stop -FilterHashtable @{logname='security'; ID='4776';StartTime=$StartDate;EndTime=$EndDate} | Out-GridView -Title $DC      \r\n    }\r\n}else{\r\n    $EndDate = Get-Date -Date $EndTime -ErrorAction Stop\r\n    Foreach($DC in $DCs){\r\n        Get-WinEvent -ComputerName $DC -ErrorAction Stop -FilterHashtable @{logname='security'; ID='4776';StartTime=$StartDate;EndTime=$EndDate} | Out-GridView -Title $DC\r\n    }\r\n}\r\n```\r\n\r\n### Expected behavior\r\n\r\n```console\r\nShow GridView for all WinSecurity Events in given timeframe. Terminate as soon as no more Events are retrieved .\r\n\r\n   ProviderName: Microsoft-Windows-Security-Auditing\r\n\r\nTimeCreated                     Id LevelDisplayName Message                                                                                                                                                \r\n-----------                     -- ---------------- -------                                                                                                                                                \r\n20.04.2022 10:12:13           4776 Information      The computer attempted to validate the credentials for an account....                                                                                  \r\n20.04.2022 10:12:13           4776 Information      The computer attempted to validate the credentials for an account....                                                                                  \r\n20.04.2022 10:12:13           4776 Information      The computer attempted to validate the credentials for an account....                                                                                  \r\n20.04.2022 10:12:13           4776 Information      The computer attempted to validate the credentials for an account....                                                                                  \r\n20.04.2022 10:12:13           4776 Information      The computer attempted to validate the credentials for an account....                                                                                  \r\n20.04.2022 10:12:13           4776 Information      The computer attempted to validate the credentials for an account....                                                                                  \r\n20.04.2022 10:12:13           4776 Information      The computer attempted to validate the credentials for an account....                                                                                  \r\n20.04.2022 10:12:12           4776 Information      The computer attempted to validate the credentials for an account....                                                                                  \r\n20.04.2022 10:12:12           4776 Information      The computer attempted to validate the credentials for an account....                                                                                  \r\n20.04.2022 10:12:12           4776 Information      The computer attempted to validate the credentials for an account....                                                                                  \r\n20.04.2022 10:12:11           4776 Information      The computer attempted to validate the credentials for an account....                                                                                  \r\n20.04.2022 10:12:11           4776 Information      The computer attempted to validate the credentials for an account....                                                                                  \r\n20.04.2022 10:12:11           4776 Information      The computer attempted to validate the credentials for an account....                                                                                  \r\n20.04.2022 10:12:11           4776 Information      The computer attempted to validate the credentials for an account....                                                                                  \r\n20.04.2022 10:12:10           4776 Information      The computer attempted to validate the credentials for an account....                                                                                  \r\n20.04.2022 10:12:10           4776 Information      The computer attempted to validate the credentials for an account....                                                                                  \r\n20.04.2022 10:12:10           4776 Information      The computer attempted to validate the credentials for an account....                                                                                  \r\n20.04.2022 10:12:10           4776 Information      The computer attempted to validate the credentials for an account....                                                                                  \r\n20.04.2022 10:12:10           4776 Information      The computer attempted to validate the credentials for an account....                                                                                  \r\n20.04.2022 10:12:10           4776 Information      The computer attempted to validate the credentials for an account....                                                                                  \r\n20.04.2022 10:12:10           4776 Information      The computer attempted to validate the credentials for an account....                                                                                  \r\n20.04.2022 10:12:10           4776 Information      The computer attempted to validate the credentials for an account....                                                                                  \r\n20.04.2022 10:12:10           4776 Information      The computer attempted to validate the credentials for an account....\r\n```\r\n\r\n\r\n### Actual behavior\r\n\r\n```console\r\nCommand is not terminating. Termination can be forced with -MaxEvents after a certain amount of Events is displayed but has the downside that the desired event might not be shown\r\n```\r\n\r\n\r\n### Error details\r\n\r\n```console\r\nNo Error details\r\n```\r\n\r\n\r\n### Environment data\r\n\r\n```powershell\r\nName                           Value                                                                                                                                                                       \r\n----                           -----                                                                                                                                                                       \r\nPSVersion                      5.1.17763.1490                                                                                                                                                              \r\nPSEdition                      Desktop                                                                                                                                                                     \r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}                                                                                                                                                     \r\nBuildVersion                   10.0.17763.1490                                                                                                                                                             \r\nCLRVersion                     4.0.30319.42000                                                                                                                                                             \r\nWSManStackVersion              3.0                                                                                                                                                                         \r\nPSRemotingProtocolVersion      2.3                                                                                                                                                                         \r\nSerializationVersion           1.1.0.1\r\n```\r\n\r\n\r\n### Visuals\r\n\r\n![2022-04-20 10_23_51-Window](https://user-images.githubusercontent.com/104059296/164185107-ac7cb5ff-c014-432b-a980-418eac142186.png)\r\n",
  "closed_at": null,
  "comments": [
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "It would be helpful if you can narrow down the issue:\r\n1. does the issue happen if you don't pipe to `Out-GridView`?\r\n2. does the issue happen if you run `Get-WinEvent` targeting the local machine (not using `-Computer`)?\r\n3. if it happens only if `-Computer` is used, does it happen when running against all your remote machines, or only a specific one?",
      "created_at": "2022-04-21T22:30:10Z",
      "updated_at": "2022-04-21T22:30:10Z"
    },
    {
      "author": "DG-Riester",
      "author_association": "NONE",
      "body": "Hi Daxian,\r\n\r\n- It happens if I don't pipe it to Out-GridView\r\n- It also happens if I target local machine as well as remote machines",
      "created_at": "2022-04-22T06:46:29Z",
      "updated_at": "2022-04-22T06:46:29Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "I didn't try targeting remote machine, but I could not reproduce the issue when targeting the local machine.\r\nCan you try PowerShell Core instead of Windows PowerShell?\r\nThis repo is for PowerShell core only, for Windows PowerShell, issues need to be reported through the [Feedback Hub app](https://support.microsoft.com/windows/send-feedback-to-microsoft-with-the-feedback-hub-app-f59187f8-8739-22d6-ba93-f66612949332), see https://github.com/PowerShell/PowerShell#windows-powershell-vs-powershell-core for details.\n\n<blockquote><img src=\"https://repository-images.githubusercontent.com/49609581/aad0ad80-cdec-11ea-8248-a37bc0571bfd\" width=\"48\" align=\"right\"><div><img src=\"https://github.githubassets.com/favicons/favicon.svg\" height=\"14\"> GitHub</div><div><strong><a href=\"https://github.com/PowerShell/PowerShell\">GitHub - PowerShell/PowerShell: PowerShell for every system!</a></strong></div><div>PowerShell for every system! Contribute to PowerShell/PowerShell development by creating an account on GitHub.</div></blockquote>",
      "created_at": "2022-04-22T18:53:30Z",
      "updated_at": "2022-04-22T18:53:32Z"
    }
  ],
  "created_at": "2022-04-20T08:27:12Z",
  "labels": [
    "WG-Cmdlets",
    "Needs-Triage"
  ],
  "number": 17164,
  "state": "open",
  "title": "Get-WinEvent doesn't terminate",
  "updated_at": "2022-04-22T18:53:32Z"
}
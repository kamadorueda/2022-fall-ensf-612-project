{
  "_url": "https://github.com/PowerShell/PowerShell/issues/4844",
  "author": "joandrsn",
  "body": "Added functionality to set credientials on `Set-Service` command.\r\nUsing this you can now specifiy the `-Credential` parameter which makes the service you have specfied change the log-on account.\r\n\r\nIssue #4843 \r\n",
  "closed_at": "2017-09-18T10:23:18Z",
  "comments": [
    {
      "author": "msftclas",
      "author_association": "NONE",
      "body": "\r\n@__joandrsn__,\nThanks for your contribution.\nTo ensure that the project team has proper rights to use your work, please complete the Contribution License Agreement at https://cla.microsoft.com.\n\nIt will cover your contributions to all Microsoft-managed open source projects.\n_Thanks,\nMicrosoft Pull Request Bot_",
      "created_at": "2017-09-15T07:33:12Z",
      "updated_at": "2017-09-15T07:33:12Z"
    },
    {
      "author": "msftclas",
      "author_association": "NONE",
      "body": "__@joandrsn__, thanks for signing the contribution license agreement. We will now validate the agreement and then the pull request.\r\n<br />_Thanks, Microsoft Pull Request Bot_",
      "created_at": "2017-09-15T07:36:58Z",
      "updated_at": "2017-09-15T07:36:58Z"
    },
    {
      "author": "joandrsn",
      "author_association": "CONTRIBUTOR",
      "body": "@iSazonov thank you for the feedback. I have updated my pull request. But I still need to create tests for the code I have written.\r\nUnfortunatly I don't know the credentials of the computer that the tests will be running on, so I'm not sure how to write the testcase.\r\nDo you have any documentation on what I can and can't write in the tests?",
      "created_at": "2017-09-15T10:04:55Z",
      "updated_at": "2017-09-15T10:04:55Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@joandrsn Please see [tests for New-Service](https://github.com/PowerShell/PowerShell/blob/master/test/powershell/Modules/Microsoft.PowerShell.Management/Set-Service.Tests.ps1#L104)\r\nI think you should (1) create new test service (2) check that you can change its properties. (3) remove the test service.\r\n\r\nAlso you should add \"[Feature]\" in header first position of last commit that CI start the _feature_ tests.",
      "created_at": "2017-09-15T10:21:47Z",
      "updated_at": "2017-09-15T10:22:15Z"
    },
    {
      "author": "joandrsn",
      "author_association": "CONTRIBUTOR",
      "body": "@iSazonov I have now added the test, but when executing the test with what it is written within the test, you will receive an error `The account name is invalid or does not exist, or the password is invalid for the account name specified` since the users `username` and `username2` does not exist.\r\n\r\nI have tested with my own 2 users and it seems to work, but is this okay? ",
      "created_at": "2017-09-15T11:58:21Z",
      "updated_at": "2017-09-15T11:58:21Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@joandrsn I think we should try to create a real user account for the test with \"Log on as a service\" privilege.",
      "created_at": "2017-09-15T12:56:51Z",
      "updated_at": "2017-09-15T12:56:51Z"
    },
    {
      "author": "joandrsn",
      "author_association": "CONTRIBUTOR",
      "body": "@iSazonov \r\nI figured out that I could use some built in users from Windows.\r\nCurrently I'm using `.\\Guest` when creating the service and `.\\Administrator` when changing the credentials. Would you rather have it create a user and delete the user again? ",
      "created_at": "2017-09-15T13:01:18Z",
      "updated_at": "2017-09-15T13:01:18Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Guest and Administrator accounts haven't \"Log on as a service\" privilege and we don't know password. So we should create test users.",
      "created_at": "2017-09-15T13:46:38Z",
      "updated_at": "2017-09-15T13:46:38Z"
    },
    {
      "author": "joandrsn",
      "author_association": "CONTRIBUTOR",
      "body": "They don't have the access, but the test passes. I guess that might not be a good way to test (using invalid credentials to validate a test).\r\n\r\nDo you have suggestion on how you would add the user? `Add-LocalUser` has been disabled since #4272. I can't find any other test modules in the repository which creates and deletes a user.",
      "created_at": "2017-09-15T14:22:05Z",
      "updated_at": "2017-09-15T14:22:05Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@joandrsn thanks for the contribution!  Look at what I've done [here](https://github.com/PowerShell/PowerShell/pull/4756/files#diff-c2f140f155813763bf7a3492a6a03196) to create my own user and removing at end of test",
      "created_at": "2017-09-15T14:25:23Z",
      "updated_at": "2017-09-15T14:25:23Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "For PowerShell team: We haven't tests to really create new service and change its properties. So we should refactor all tests after the PR will be merged. Maybe create tracking Issue?",
      "created_at": "2017-09-15T15:19:55Z",
      "updated_at": "2017-09-15T15:19:55Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@iSazonov it seems the test case added by @joandrsn does a `new` and then `set`, were you thinking of something different?  ",
      "created_at": "2017-09-15T16:55:37Z",
      "updated_at": "2017-09-15T16:55:37Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": ">it seems the test case added by @joandrsn does a  new  and then  set , were you thinking of something different?\r\n@SteveL-MSFT I've analyzed these tests more closely.\r\nI don't understand why we need test \"SetServiceCommand can be used as API for '<parameter>' with '<value>'\". It seems we should do the checks on real service by invoke.\r\nIt seems we don't check that New- and Set-Service ignore System and Boot in StartupType.",
      "created_at": "2017-09-16T19:20:34Z",
      "updated_at": "2017-09-16T19:20:34Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@iSazonov The \"use as API\" tests are specifically for covering the getter/setters for the parameters which is only used when called as an API and not when used as cmdlet parameter.  If we're missing some variations, we should add those, but perhaps as a different PR.",
      "created_at": "2017-09-16T19:41:23Z",
      "updated_at": "2017-09-16T19:41:23Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@joandrsn Many thanks for your contribution!",
      "created_at": "2017-09-18T10:23:54Z",
      "updated_at": "2017-09-18T10:23:54Z"
    }
  ],
  "created_at": "2017-09-15T07:33:07Z",
  "number": 4844,
  "state": "closed",
  "title": "Added functionality to set credientials on Set-Service command",
  "updated_at": "2017-09-18T10:23:54Z"
}
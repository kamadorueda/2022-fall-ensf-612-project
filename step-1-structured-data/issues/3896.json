{
  "_url": "https://github.com/PowerShell/PowerShell/issues/3896",
  "author": "chunqingchen",
  "body": "Fix issue #2334\r\n\r\nSummary of the issue:\r\n\r\nIf user create any runspace within transcription and later close the runspace within the transcription, transcription get closed\r\n\r\nRoot cause of the issue:\r\n\r\nWhen any runspace get closed, StopAllTranscribing() get called and the transcription get closed\r\nFix:\r\n\r\nCheck and make sure the we are closing the last runspace to stop transcription. otherwise user still need to explicitly call stop-transcript to close the transcription.",
  "closed_at": "2017-06-13T22:44:06Z",
  "comments": [
    {
      "author": "chunqingchen",
      "author_association": "CONTRIBUTOR",
      "body": "@SteveL-MSFT your comment is resolved.",
      "created_at": "2017-05-31T19:48:59Z",
      "updated_at": "2017-05-31T19:48:59Z"
    },
    {
      "author": "adityapatwardhan",
      "author_association": "MEMBER",
      "body": "I tried fixing this in Windows Powershell 5.1, but it broke with the following repro. Powershell crashes. Try running the following with a debugger attached.\r\n\r\n```Powershell\r\npowershell.exe -c \"start-transcript\"\r\n```",
      "created_at": "2017-05-31T21:31:26Z",
      "updated_at": "2017-05-31T21:31:26Z"
    },
    {
      "author": "chunqingchen",
      "author_association": "CONTRIBUTOR",
      "body": "@adityapatwardhan I tried your repro and powershell isn't crashing.",
      "created_at": "2017-06-06T23:43:17Z",
      "updated_at": "2017-06-06T23:43:17Z"
    },
    {
      "author": "chunqingchen",
      "author_association": "CONTRIBUTOR",
      "body": "@PaulHigin @SteveL-MSFT your comments are resolved.",
      "created_at": "2017-06-07T07:37:49Z",
      "updated_at": "2017-06-07T07:37:49Z"
    },
    {
      "author": "chunqingchen",
      "author_association": "CONTRIBUTOR",
      "body": "@PaulHigin @SteveL-MSFT @adityapatwardhan your comments are resolved.",
      "created_at": "2017-06-08T00:41:23Z",
      "updated_at": "2017-06-08T00:41:23Z"
    },
    {
      "author": "chunqingchen",
      "author_association": "CONTRIBUTOR",
      "body": "@TravisEz13 Hi Travis, please merge the pr",
      "created_at": "2017-06-13T17:34:59Z",
      "updated_at": "2017-06-13T17:34:59Z"
    }
  ],
  "created_at": "2017-05-31T17:15:48Z",
  "number": 3896,
  "state": "closed",
  "title": "Only stop transcription when all runspaces are closed",
  "updated_at": "2017-06-13T22:44:06Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/18410",
  "author": "kfsone",
  "body": "### Prerequisites\n\n- [X] Write a descriptive title.\n- [X] Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\n- [X] Search the existing issues.\n- [X] Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\n- [X] Refer to [Differences between Windows PowerShell 5.1 and PowerShell](https://docs.microsoft.com/powershell/scripting/whats-new/differences-from-windows-powershell).\n\n### Steps to reproduce\n\nAccording to the Powershell DSC documentation for 1.1, 2.0 and 3.0 preview\r\nhttps://learn.microsoft.com/en-us/powershell/dsc/concepts/configurations?view=dsc-3.0\r\n\r\nthe following should be a valid configuration:\r\n\r\n```\r\nConfiguration MyTest {\r\n  Import-DscResource -ModuleName 'PSDscResources'  # With or without this line\r\n  File TestDir {\r\n    Type = 'Directory'; DestinationPath = 'C:\\MyTest'; Ensure = 'Present'\r\n  }\r\n}\r\n```\r\n\r\nBoth with and without the import-dsc resource, the configuration is accepted, but cannot be compiled with an error that suggests a fundamentally backwards incompatible change to how Powershell Core's DSC expects a configuration to work.\r\n\n\n### Expected behavior\n\n```console\nPS> Configuration MyTest { File TestDir { Type='Directory'; DestinationPath='C:\\MyTest'; Ensure='Present' } }\r\nPS> Configuration\r\n    Directory: C:\\PS\\MyTest\r\n\r\n\r\nMode                 LastWriteTime         Length Name\r\n----                 -------------         ------ ----\r\n-a----        10/28/2022  11:59 AM           1934 localhost.mof\r\nWARNING: The configuration 'MyTest' is loading one or more built-in resources without explicitly importing associated modules. Add Import-DscResource \u2013ModuleName 'PSDesiredStateConfiguration' to your configuration to avoid this message.\n```\n\n\n### Actual behavior\n\n```console\nPS> Configuration MyTest { File TestDir { Type='Directory'; DestinationPath='C:\\MyTest'; Ensure='Present' } }\r\nPS> Configuration\r\nWARNING: Module PSDesiredStateConfiguration is loaded in Windows PowerShell using WinPSCompatSession remoting session; please note that all input and output of commands from this module will be deserialized objects. If you want to load this module into PowerShell please use 'Import-Module -SkipEditionCheck' syntax.\r\nConfiguration: Cannot process argument transformation on parameter 'ResourceModuleTuplesToImport'. Cannot convert the \"System.Collections.ArrayList\" value of type \"System.Collections.ArrayList\" to type \"System.Tuple`3[System.String[],Microsoft.PowerShell.Commands.ModuleSpecification[],System.Version]\".\n```\n\n\n### Error details\n\n```console\nOriginInfo            : localhost\r\nException             : \r\n    Type                           : System.Management.Automation.RemoteException\r\n    SerializedRemoteException      : System.Management.Automation.ParameterBindingArgumentTransformationException: Cannot process argument transformation on parameter 'ResourceModuleTuplesToImport'. Cannot convert the \"System.Collections.ArrayList\" value of type \"System.Collections.ArrayList\" to   \r\ntype \"System.Tuple`3[System.String[],Microsoft.PowerShell.Commands.ModuleSpecification[],System.Version]\". ---> System.Management.Automation.ArgumentTransformationMetadataException: Cannot convert the \"System.Collections.ArrayList\" value of type \"System.Collections.ArrayList\" to type\r\n\"System.Tuple`3[System.String[],Microsoft.PowerShell.Commands.ModuleSpecification[],System.Version]\". ---> System.Management.Automation.PSInvalidCastException: Cannot convert the \"System.Collections.ArrayList\" value of type \"System.Collections.ArrayList\" to type\r\n\"System.Tuple`3[System.String[],Microsoft.PowerShell.Commands.ModuleSpecification[],System.Version]\".\r\n                                     at System.Management.Automation.LanguagePrimitives.ThrowInvalidCastException(Object valueToConvert, Type resultType)\r\n                                     at System.Management.Automation.LanguagePrimitives.ConvertNoConversion(Object valueToConvert, Type resultType, Boolean recurse, PSObject originalValueToConvert, IFormatProvider formatProvider, TypeTable backupTable)\r\n                                     at System.Management.Automation.LanguagePrimitives.ConversionData`1.Invoke(Object valueToConvert, Type resultType, Boolean recurse, PSObject originalValueToConvert, IFormatProvider formatProvider, TypeTable backupTable)\r\n                                     at System.Management.Automation.LanguagePrimitives.ConvertTo(Object valueToConvert, Type resultType, Boolean recursion, IFormatProvider formatProvider, TypeTable backupTypeTable)\r\n                                     at System.Management.Automation.LanguagePrimitives.ConvertViaIEnumerableConstructor.Convert(Object valueToConvert, Type resultType, Boolean recursion, PSObject originalValueToConvert, IFormatProvider formatProvider, TypeTable backupTable)\r\n                                     at System.Management.Automation.LanguagePrimitives.ConversionData`1.Invoke(Object valueToConvert, Type resultType, Boolean recurse, PSObject originalValueToConvert, IFormatProvider formatProvider, TypeTable backupTable)\r\n                                     at System.Management.Automation.LanguagePrimitives.ConvertTo(Object valueToConvert, Type resultType, Boolean recursion, IFormatProvider formatProvider, TypeTable backupTypeTable)\r\n                                     at System.Management.Automation.ArgumentTypeConverterAttribute.Transform(EngineIntrinsics engineIntrinsics, Object inputData, Boolean bindingParameters, Boolean bindingScriptCmdlet)\r\n                                     --- End of inner exception stack trace ---\r\n                                     at System.Management.Automation.ArgumentTypeConverterAttribute.Transform(EngineIntrinsics engineIntrinsics, Object inputData, Boolean bindingParameters, Boolean bindingScriptCmdlet)\r\n                                     at System.Management.Automation.ParameterBinderBase.BindParameter(CommandParameterInternal parameter, CompiledCommandParameter parameterMetadata, ParameterBindingFlags flags)\r\n                                     --- End of inner exception stack trace ---\r\n                                     at System.Management.Automation.ParameterBinderBase.BindParameter(CommandParameterInternal parameter, CompiledCommandParameter parameterMetadata, ParameterBindingFlags flags)\r\n                                     at System.Management.Automation.CmdletParameterBinderController.BindParameter(CommandParameterInternal argument, MergedCompiledCommandParameter parameter, ParameterBindingFlags flags)\r\n                                     at System.Management.Automation.CmdletParameterBinderController.BindParameter(UInt32 parameterSets, CommandParameterInternal argument, MergedCompiledCommandParameter parameter, ParameterBindingFlags flags)\r\n                                     at System.Management.Automation.CmdletParameterBinderController.BindParameters(UInt32 parameterSets, Collection`1 arguments)\r\n                                     at System.Management.Automation.CmdletParameterBinderController.BindCommandLineParametersNoValidation(Collection`1 arguments)\r\n                                     at System.Management.Automation.CmdletParameterBinderController.BindCommandLineParameters(Collection`1 arguments)\r\n                                     at System.Management.Automation.CommandProcessor.BindCommandLineParameters()\r\n                                     at System.Management.Automation.CommandProcessor.Prepare(IDictionary psDefaultParameterValues)\r\n                                     at System.Management.Automation.CommandProcessorBase.DoPrepare(IDictionary psDefaultParameterValues)\r\n                                     at System.Management.Automation.Internal.PipelineProcessor.Start(Boolean incomingStream)\r\n                                     at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)\r\n                                     --- End of stack trace from previous location where exception was thrown ---\r\n                                     at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n                                     at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)\r\n                                     at System.Management.Automation.Runspaces.LocalPipeline.InvokeHelper()\r\n                                     at System.Management.Automation.Runspaces.LocalPipeline.InvokeThreadProc()\r\n    SerializedRemoteInvocationInfo : System.Management.Automation.InvocationInfo\r\n    ErrorRecord                    : \r\n        Exception             : \r\n            Type                           : System.Management.Automation.RemoteException\r\n            SerializedRemoteException      : System.Management.Automation.ParameterBindingArgumentTransformationException: Cannot process argument transformation on parameter 'ResourceModuleTuplesToImport'. Cannot convert the \"System.Collections.ArrayList\" value of type\r\n\"System.Collections.ArrayList\" to type \"System.Tuple`3[System.String[],Microsoft.PowerShell.Commands.ModuleSpecification[],System.Version]\". ---> System.Management.Automation.ArgumentTransformationMetadataException: Cannot convert the \"System.Collections.ArrayList\" value of type\r\n\"System.Collections.ArrayList\" to type \"System.Tuple`3[System.String[],Microsoft.PowerShell.Commands.ModuleSpecification[],System.Version]\". ---> System.Management.Automation.PSInvalidCastException: Cannot convert the \"System.Collections.ArrayList\" value of type \"System.Collections.ArrayList\" to   \r\ntype \"System.Tuple`3[System.String[],Microsoft.PowerShell.Commands.ModuleSpecification[],System.Version]\".\r\n                                             at System.Management.Automation.LanguagePrimitives.ThrowInvalidCastException(Object valueToConvert, Type resultType)\r\n                                             at System.Management.Automation.LanguagePrimitives.ConvertNoConversion(Object valueToConvert, Type resultType, Boolean recurse, PSObject originalValueToConvert, IFormatProvider formatProvider, TypeTable backupTable)\r\n                                             at System.Management.Automation.LanguagePrimitives.ConversionData`1.Invoke(Object valueToConvert, Type resultType, Boolean recurse, PSObject originalValueToConvert, IFormatProvider formatProvider, TypeTable backupTable)\r\n                                             at System.Management.Automation.LanguagePrimitives.ConvertTo(Object valueToConvert, Type resultType, Boolean recursion, IFormatProvider formatProvider, TypeTable backupTypeTable)\r\n                                             at System.Management.Automation.LanguagePrimitives.ConvertViaIEnumerableConstructor.Convert(Object valueToConvert, Type resultType, Boolean recursion, PSObject originalValueToConvert, IFormatProvider formatProvider, TypeTable backupTable)\r\n                                             at System.Management.Automation.LanguagePrimitives.ConversionData`1.Invoke(Object valueToConvert, Type resultType, Boolean recurse, PSObject originalValueToConvert, IFormatProvider formatProvider, TypeTable backupTable)\r\n                                             at System.Management.Automation.LanguagePrimitives.ConvertTo(Object valueToConvert, Type resultType, Boolean recursion, IFormatProvider formatProvider, TypeTable backupTypeTable)\r\n                                             at System.Management.Automation.ArgumentTypeConverterAttribute.Transform(EngineIntrinsics engineIntrinsics, Object inputData, Boolean bindingParameters, Boolean bindingScriptCmdlet)\r\n                                             --- End of inner exception stack trace ---\r\n                                             at System.Management.Automation.ArgumentTypeConverterAttribute.Transform(EngineIntrinsics engineIntrinsics, Object inputData, Boolean bindingParameters, Boolean bindingScriptCmdlet)\r\n                                             at System.Management.Automation.ParameterBinderBase.BindParameter(CommandParameterInternal parameter, CompiledCommandParameter parameterMetadata, ParameterBindingFlags flags)\r\n                                             --- End of inner exception stack trace ---\r\n                                             at System.Management.Automation.ParameterBinderBase.BindParameter(CommandParameterInternal parameter, CompiledCommandParameter parameterMetadata, ParameterBindingFlags flags)\r\n                                             at System.Management.Automation.CmdletParameterBinderController.BindParameter(CommandParameterInternal argument, MergedCompiledCommandParameter parameter, ParameterBindingFlags flags)\r\n                                             at System.Management.Automation.CmdletParameterBinderController.BindParameter(UInt32 parameterSets, CommandParameterInternal argument, MergedCompiledCommandParameter parameter, ParameterBindingFlags flags)\r\n                                             at System.Management.Automation.CmdletParameterBinderController.BindParameters(UInt32 parameterSets, Collection`1 arguments)\r\n                                             at System.Management.Automation.CmdletParameterBinderController.BindCommandLineParametersNoValidation(Collection`1 arguments)\r\n                                             at System.Management.Automation.CmdletParameterBinderController.BindCommandLineParameters(Collection`1 arguments)\r\n                                             at System.Management.Automation.CommandProcessor.BindCommandLineParameters()\r\n                                             at System.Management.Automation.CommandProcessor.Prepare(IDictionary psDefaultParameterValues)\r\n                                             at System.Management.Automation.CommandProcessorBase.DoPrepare(IDictionary psDefaultParameterValues)\r\n                                             at System.Management.Automation.Internal.PipelineProcessor.Start(Boolean incomingStream)\r\n                                             at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)\r\n                                             --- End of stack trace from previous location where exception was thrown ---\r\n                                             at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n                                             at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)\r\n                                             at System.Management.Automation.Runspaces.LocalPipeline.InvokeHelper()\r\n                                             at System.Management.Automation.Runspaces.LocalPipeline.InvokeThreadProc()\r\n            SerializedRemoteInvocationInfo : System.Management.Automation.InvocationInfo\r\n            ErrorRecord                    : \r\n                Exception             : \r\n                    Type                           : System.Management.Automation.RemoteException\r\n                    SerializedRemoteException      : System.Management.Automation.ParameterBindingArgumentTransformationException: Cannot process argument transformation on parameter 'ResourceModuleTuplesToImport'. Cannot convert the \"System.Collections.ArrayList\" value of type\r\n\"System.Collections.ArrayList\" to type \"System.Tuple`3[System.String[],Microsoft.PowerShell.Commands.ModuleSpecification[],System.Version]\". ---> System.Management.Automation.ArgumentTransformationMetadataException: Cannot convert the \"System.Collections.ArrayList\" value of type\r\n\"System.Collections.ArrayList\" to type \"System.Tuple`3[System.String[],Microsoft.PowerShell.Commands.ModuleSpecification[],System.Version]\". ---> System.Management.Automation.PSInvalidCastException: Cannot convert the \"System.Collections.ArrayList\" value of type \"System.Collections.ArrayList\" to   \r\ntype \"System.Tuple`3[System.String[],Microsoft.PowerShell.Commands.ModuleSpecification[],System.Version]\".\r\n                                                     at System.Management.Automation.LanguagePrimitives.ThrowInvalidCastException(Object valueToConvert, Type resultType)\r\n                                                     at System.Management.Automation.LanguagePrimitives.ConvertNoConversion(Object valueToConvert, Type resultType, Boolean recurse, PSObject originalValueToConvert, IFormatProvider formatProvider, TypeTable backupTable)\r\n                                                     at System.Management.Automation.LanguagePrimitives.ConversionData`1.Invoke(Object valueToConvert, Type resultType, Boolean recurse, PSObject originalValueToConvert, IFormatProvider formatProvider, TypeTable backupTable)\r\n                                                     at System.Management.Automation.LanguagePrimitives.ConvertTo(Object valueToConvert, Type resultType, Boolean recursion, IFormatProvider formatProvider, TypeTable backupTypeTable)\r\n                                                     at System.Management.Automation.LanguagePrimitives.ConvertViaIEnumerableConstructor.Convert(Object valueToConvert, Type resultType, Boolean recursion, PSObject originalValueToConvert, IFormatProvider formatProvider, TypeTable backupTable)        \r\n                                                     at System.Management.Automation.LanguagePrimitives.ConversionData`1.Invoke(Object valueToConvert, Type resultType, Boolean recurse, PSObject originalValueToConvert, IFormatProvider formatProvider, TypeTable backupTable)\r\n                                                     at System.Management.Automation.LanguagePrimitives.ConvertTo(Object valueToConvert, Type resultType, Boolean recursion, IFormatProvider formatProvider, TypeTable backupTypeTable)\r\n                                                     at System.Management.Automation.ArgumentTypeConverterAttribute.Transform(EngineIntrinsics engineIntrinsics, Object inputData, Boolean bindingParameters, Boolean bindingScriptCmdlet)\r\n                                                     --- End of inner exception stack trace ---\r\n                                                     at System.Management.Automation.ArgumentTypeConverterAttribute.Transform(EngineIntrinsics engineIntrinsics, Object inputData, Boolean bindingParameters, Boolean bindingScriptCmdlet)\r\n                                                     at System.Management.Automation.ParameterBinderBase.BindParameter(CommandParameterInternal parameter, CompiledCommandParameter parameterMetadata, ParameterBindingFlags flags)\r\n                                                     --- End of inner exception stack trace ---\r\n                                                     at System.Management.Automation.ParameterBinderBase.BindParameter(CommandParameterInternal parameter, CompiledCommandParameter parameterMetadata, ParameterBindingFlags flags)\r\n                                                     at System.Management.Automation.CmdletParameterBinderController.BindParameter(CommandParameterInternal argument, MergedCompiledCommandParameter parameter, ParameterBindingFlags flags)\r\n                                                     at System.Management.Automation.CmdletParameterBinderController.BindParameter(UInt32 parameterSets, CommandParameterInternal argument, MergedCompiledCommandParameter parameter, ParameterBindingFlags flags)\r\n                                                     at System.Management.Automation.CmdletParameterBinderController.BindParameters(UInt32 parameterSets, Collection`1 arguments)\r\n                                                     at System.Management.Automation.CmdletParameterBinderController.BindCommandLineParametersNoValidation(Collection`1 arguments)\r\n                                                     at System.Management.Automation.CmdletParameterBinderController.BindCommandLineParameters(Collection`1 arguments)\r\n                                                     at System.Management.Automation.CommandProcessor.BindCommandLineParameters()\r\n                                                     at System.Management.Automation.CommandProcessor.Prepare(IDictionary psDefaultParameterValues)\r\n                                                     at System.Management.Automation.CommandProcessorBase.DoPrepare(IDictionary psDefaultParameterValues)\r\n                                                     at System.Management.Automation.Internal.PipelineProcessor.Start(Boolean incomingStream)\r\n                                                     at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)\r\n                                                     --- End of stack trace from previous location where exception was thrown ---\r\n                                                     at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n                                                     at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)\r\n                                                     at System.Management.Automation.Runspaces.LocalPipeline.InvokeHelper()\r\n                                                     at System.Management.Automation.Runspaces.LocalPipeline.InvokeThreadProc()\r\n                    SerializedRemoteInvocationInfo : System.Management.Automation.InvocationInfo\r\n                    ErrorRecord                    : \r\n                        Exception             : \r\n                            Type                           : System.Management.Automation.RemoteException\r\n                            SerializedRemoteException      : System.Management.Automation.ParameterBindingArgumentTransformationException: Cannot process argument transformation on parameter 'ResourceModuleTuplesToImport'. Cannot convert the \"System.Collections.ArrayList\" value of type\r\n\"System.Collections.ArrayList\" to type \"System.Tuple`3[System.String[],Microsoft.PowerShell.Commands.ModuleSpecification[],System.Version]\". ---> System.Management.Automation.ArgumentTransformationMetadataException: Cannot convert the \"System.Collections.ArrayList\" value of type \r\n\"System.Collections.ArrayList\" to type \"System.Tuple`3[System.String[],Microsoft.PowerShell.Commands.ModuleSpecification[],System.Version]\". ---> System.Management.Automation.PSInvalidCastException: Cannot convert the \"System.Collections.ArrayList\" value of type \"System.Collections.ArrayList\" to   \r\ntype \"System.Tuple`3[System.String[],Microsoft.PowerShell.Commands.ModuleSpecification[],System.Version]\".\r\n                                                             at System.Management.Automation.LanguagePrimitives.ThrowInvalidCastException(Object valueToConvert, Type resultType)\r\n                                                             at System.Management.Automation.LanguagePrimitives.ConvertNoConversion(Object valueToConvert, Type resultType, Boolean recurse, PSObject originalValueToConvert, IFormatProvider formatProvider, TypeTable backupTable)\r\n                                                             at System.Management.Automation.LanguagePrimitives.ConversionData`1.Invoke(Object valueToConvert, Type resultType, Boolean recurse, PSObject originalValueToConvert, IFormatProvider formatProvider, TypeTable backupTable)\r\n                                                             at System.Management.Automation.LanguagePrimitives.ConvertTo(Object valueToConvert, Type resultType, Boolean recursion, IFormatProvider formatProvider, TypeTable backupTypeTable)\r\n                                                             at System.Management.Automation.LanguagePrimitives.ConvertViaIEnumerableConstructor.Convert(Object valueToConvert, Type resultType, Boolean recursion, PSObject originalValueToConvert, IFormatProvider formatProvider, TypeTable\r\nbackupTable)\r\n                                                             at System.Management.Automation.LanguagePrimitives.ConversionData`1.Invoke(Object valueToConvert, Type resultType, Boolean recurse, PSObject originalValueToConvert, IFormatProvider formatProvider, TypeTable backupTable)\r\n                                                             at System.Management.Automation.LanguagePrimitives.ConvertTo(Object valueToConvert, Type resultType, Boolean recursion, IFormatProvider formatProvider, TypeTable backupTypeTable)\r\n                                                             at System.Management.Automation.ArgumentTypeConverterAttribute.Transform(EngineIntrinsics engineIntrinsics, Object inputData, Boolean bindingParameters, Boolean bindingScriptCmdlet)\r\n                                                             --- End of inner exception stack trace ---\r\n                                                             at System.Management.Automation.ArgumentTypeConverterAttribute.Transform(EngineIntrinsics engineIntrinsics, Object inputData, Boolean bindingParameters, Boolean bindingScriptCmdlet)\r\n                                                             at System.Management.Automation.ParameterBinderBase.BindParameter(CommandParameterInternal parameter, CompiledCommandParameter parameterMetadata, ParameterBindingFlags flags)\r\n                                                             --- End of inner exception stack trace ---\r\n                                                             at System.Management.Automation.ParameterBinderBase.BindParameter(CommandParameterInternal parameter, CompiledCommandParameter parameterMetadata, ParameterBindingFlags flags)\r\n                                                             at System.Management.Automation.CmdletParameterBinderController.BindParameter(CommandParameterInternal argument, MergedCompiledCommandParameter parameter, ParameterBindingFlags flags)\r\n                                                             at System.Management.Automation.CmdletParameterBinderController.BindParameter(UInt32 parameterSets, CommandParameterInternal argument, MergedCompiledCommandParameter parameter, ParameterBindingFlags flags)\r\n                                                             at System.Management.Automation.CmdletParameterBinderController.BindParameters(UInt32 parameterSets, Collection`1 arguments)\r\n                                                             at System.Management.Automation.CmdletParameterBinderController.BindCommandLineParametersNoValidation(Collection`1 arguments)\r\n                                                             at System.Management.Automation.CmdletParameterBinderController.BindCommandLineParameters(Collection`1 arguments)\r\n                                                             at System.Management.Automation.CommandProcessor.BindCommandLineParameters()\r\n                                                             at System.Management.Automation.CommandProcessor.Prepare(IDictionary psDefaultParameterValues)\r\n                                                             at System.Management.Automation.CommandProcessorBase.DoPrepare(IDictionary psDefaultParameterValues)\r\n                                                             at System.Management.Automation.Internal.PipelineProcessor.Start(Boolean incomingStream)\r\n                                                             at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)\r\n                                                             --- End of stack trace from previous location where exception was thrown ---\r\n                                                             at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n                                                             at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)\r\n                                                             at System.Management.Automation.Runspaces.LocalPipeline.InvokeHelper()\r\n                                                             at System.Management.Automation.Runspaces.LocalPipeline.InvokeThreadProc()\r\n                            SerializedRemoteInvocationInfo : System.Management.Automation.InvocationInfo\r\n                            ErrorRecord                    : \r\n                                Exception             : \r\n                                    Type                           : System.Management.Automation.RemoteException\r\n                                    SerializedRemoteException      : System.Management.Automation.ParameterBindingArgumentTransformationException: Cannot process argument transformation on parameter 'ResourceModuleTuplesToImport'. Cannot convert the \"System.Collections.ArrayList\" value of type     \r\n\"System.Collections.ArrayList\" to type \"System.Tuple`3[System.String[],Microsoft.PowerShell.Commands.ModuleSpecification[],System.Version]\". ---> System.Management.Automation.ArgumentTransformationMetadataException: Cannot convert the \"System.Collections.ArrayList\" value of type\r\n\"System.Collections.ArrayList\" to type \"System.Tuple`3[System.String[],Microsoft.PowerShell.Commands.ModuleSpecification[],System.Version]\". ---> System.Management.Automation.PSInvalidCastException: Cannot convert the \"System.Collections.ArrayList\" value of type \"System.Collections.ArrayList\" to   \r\ntype \"System.Tuple`3[System.String[],Microsoft.PowerShell.Commands.ModuleSpecification[],System.Version]\".\r\n                                                                     at System.Management.Automation.LanguagePrimitives.ThrowInvalidCastException(Object valueToConvert, Type resultType)\r\n                                                                     at System.Management.Automation.LanguagePrimitives.ConvertNoConversion(Object valueToConvert, Type resultType, Boolean recurse, PSObject originalValueToConvert, IFormatProvider formatProvider, TypeTable backupTable)\r\n                                                                     at System.Management.Automation.LanguagePrimitives.ConversionData`1.Invoke(Object valueToConvert, Type resultType, Boolean recurse, PSObject originalValueToConvert, IFormatProvider formatProvider, TypeTable backupTable)\r\n                                                                     at System.Management.Automation.LanguagePrimitives.ConvertTo(Object valueToConvert, Type resultType, Boolean recursion, IFormatProvider formatProvider, TypeTable backupTypeTable)\r\n                                                                     at System.Management.Automation.LanguagePrimitives.ConvertViaIEnumerableConstructor.Convert(Object valueToConvert, Type resultType, Boolean recursion, PSObject originalValueToConvert, IFormatProvider formatProvider, TypeTable     \r\nbackupTable)\r\n                                                                     at System.Management.Automation.LanguagePrimitives.ConversionData`1.Invoke(Object valueToConvert, Type resultType, Boolean recurse, PSObject originalValueToConvert, IFormatProvider formatProvider, TypeTable backupTable)\r\n                                                                     at System.Management.Automation.LanguagePrimitives.ConvertTo(Object valueToConvert, Type resultType, Boolean recursion, IFormatProvider formatProvider, TypeTable backupTypeTable)\r\n                                                                     at System.Management.Automation.ArgumentTypeConverterAttribute.Transform(EngineIntrinsics engineIntrinsics, Object inputData, Boolean bindingParameters, Boolean bindingScriptCmdlet)\r\n                                                                     --- End of inner exception stack trace ---\r\n                                                                     at System.Management.Automation.ArgumentTypeConverterAttribute.Transform(EngineIntrinsics engineIntrinsics, Object inputData, Boolean bindingParameters, Boolean bindingScriptCmdlet)\r\n                                                                     at System.Management.Automation.ParameterBinderBase.BindParameter(CommandParameterInternal parameter, CompiledCommandParameter parameterMetadata, ParameterBindingFlags flags)\r\n                                                                     --- End of inner exception stack trace ---\r\n                                                                     at System.Management.Automation.ParameterBinderBase.BindParameter(CommandParameterInternal parameter, CompiledCommandParameter parameterMetadata, ParameterBindingFlags flags)\r\n                                                                     at System.Management.Automation.CmdletParameterBinderController.BindParameter(CommandParameterInternal argument, MergedCompiledCommandParameter parameter, ParameterBindingFlags flags)\r\n                                                                     at System.Management.Automation.CmdletParameterBinderController.BindParameter(UInt32 parameterSets, CommandParameterInternal argument, MergedCompiledCommandParameter parameter, ParameterBindingFlags flags)\r\n                                                                     at System.Management.Automation.CmdletParameterBinderController.BindParameters(UInt32 parameterSets, Collection`1 arguments)\r\n                                                                     at System.Management.Automation.CmdletParameterBinderController.BindCommandLineParametersNoValidation(Collection`1 arguments)\r\n                                                                     at System.Management.Automation.CmdletParameterBinderController.BindCommandLineParameters(Collection`1 arguments)\r\n                                                                     at System.Management.Automation.CommandProcessor.BindCommandLineParameters()\r\n                                                                     at System.Management.Automation.CommandProcessor.Prepare(IDictionary psDefaultParameterValues)\r\n                                                                     at System.Management.Automation.CommandProcessorBase.DoPrepare(IDictionary psDefaultParameterValues)\r\n                                                                     at System.Management.Automation.Internal.PipelineProcessor.Start(Boolean incomingStream)\r\n                                                                     at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)\r\n                                                                     --- End of stack trace from previous location where exception was thrown ---\r\n                                                                     at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n                                                                     at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)\r\n                                                                     at System.Management.Automation.Runspaces.LocalPipeline.InvokeHelper()\r\n                                                                     at System.Management.Automation.Runspaces.LocalPipeline.InvokeThreadProc()\r\n                                    SerializedRemoteInvocationInfo : System.Management.Automation.InvocationInfo\r\n                                    ErrorRecord                    : \u2026\r\n                                    Message                        : Cannot process argument transformation on parameter 'ResourceModuleTuplesToImport'. Cannot convert the \"System.Collections.ArrayList\" value of type \"System.Collections.ArrayList\" to type \r\n\"System.Tuple`3[System.String[],Microsoft.PowerShell.Commands.ModuleSpecification[],System.Version]\".\r\n                                    HResult                        : -2146233087\r\n                                CategoryInfo          : InvalidData: (:) [Configuration], ParameterBindingArg\u2026sformationException\r\n                                FullyQualifiedErrorId : ParameterArgumentTransformationError,Configuration\r\n                            Message                        : Cannot process argument transformation on parameter 'ResourceModuleTuplesToImport'. Cannot convert the \"System.Collections.ArrayList\" value of type \"System.Collections.ArrayList\" to type \r\n\"System.Tuple`3[System.String[],Microsoft.PowerShell.Commands.ModuleSpecification[],System.Version]\".\r\n                            HResult                        : -2146233087\r\n                        CategoryInfo          : InvalidData: (:) [Configuration], ParameterBindingArg\u2026sformationException\r\n                        FullyQualifiedErrorId : ParameterArgumentTransformationError,Configuration\r\n                    Message                        : Cannot process argument transformation on parameter 'ResourceModuleTuplesToImport'. Cannot convert the \"System.Collections.ArrayList\" value of type \"System.Collections.ArrayList\" to type \r\n\"System.Tuple`3[System.String[],Microsoft.PowerShell.Commands.ModuleSpecification[],System.Version]\".\r\n                    HResult                        : -2146233087\r\n                CategoryInfo          : InvalidData: (:) [Configuration], ParameterBindingArg\u2026sformationException\r\n                FullyQualifiedErrorId : ParameterArgumentTransformationError,Configuration\r\n            Message                        : Cannot process argument transformation on parameter 'ResourceModuleTuplesToImport'. Cannot convert the \"System.Collections.ArrayList\" value of type \"System.Collections.ArrayList\" to type \r\n\"System.Tuple`3[System.String[],Microsoft.PowerShell.Commands.ModuleSpecification[],System.Version]\".\r\n            HResult                        : -2146233087\r\n        CategoryInfo          : InvalidData: (:) [Configuration], ParameterBindingArg\u2026sformationException\r\n        FullyQualifiedErrorId : ParameterArgumentTransformationError,Configuration\r\n    Message                        : Cannot process argument transformation on parameter 'ResourceModuleTuplesToImport'. Cannot convert the \"System.Collections.ArrayList\" value of type \"System.Collections.ArrayList\" to type \r\n\"System.Tuple`3[System.String[],Microsoft.PowerShell.Commands.ModuleSpecification[],System.Version]\".\r\n    HResult                        : -2146233087\r\nCategoryInfo          : InvalidData: (:) [Configuration], ParameterBindingArg\u2026sformationException\r\nFullyQualifiedErrorId : ParameterArgumentTransformationError,Configuration\n```\n\n\n### Environment data\n\n```powershell\nName                           Value\r\n----                           -----\r\nPSVersion                      7.2.6\r\nPSEdition                      Core\r\nGitCommitId                    7.2.6\r\nOS                             Microsoft Windows 10.0.19044\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\n```\n\n\n### Visuals\n\n_No response_",
  "closed_at": null,
  "comments": [
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "DSC is moving away from MOF and the `configuration` keyword expects to output MOF, so currently this is no longer supported until we have a JSON format defined.  If you need the old `configuration` support, you should stick with Windows PowerShell.\r\n\r\nHowever, we should update the WinPSCompat layer to now load WinPS for this and fail gracefully with an informative error message.\r\n\r\ncc @theJasonHelmick ",
      "created_at": "2022-10-31T22:56:15Z",
      "updated_at": "2022-10-31T22:57:29Z"
    },
    {
      "author": "kfsone",
      "author_association": "NONE",
      "body": "Truly appreciative that it's ongoing work.\r\n\r\nFor additional clarity: I'm in the process of learning/introducing DSC as part of the transition over to mainly remote workers, and also as in-house powershell-adoption ambassador (for CI, etc... my script runs on all 3 plats? *tears of joy*)\r\n\r\nDuring the process, powershell core gets installed, and suddenly the windows powershell dsc config stops working correctly.\r\n\r\nMy initial mistake was thinking that it had started running under PS Core. In actuality, the main issue appeared to be PackageManager related.\r\n\r\nHowever, the MS Learn/MSDN pages/blogs did nothing to dissuade me from that line of investigation.\r\n(https://learn.microsoft.com/en-us/powershell/dsc/getting-started/wingettingstarted?view=dsc-1.1&viewFallbackFrom=dsc-3.0 etc)\r\n\r\nFWIW: Installing ps core, or something accompanying it, results in two versions of PackageManager 1.0.0.1 and 1.4.8.1. This further made it seem like DSC/Configuration was good-to-go for PS Core.\r\n\r\nI have to file a separate issue for that, it feels wrong that it complains you have two versions when they are both for different editions, and adding a -ModuleVersion feels like a hack. -ModuleVersion has to be a constant so you can't do your own 'select the right one' :(",
      "created_at": "2022-11-01T00:43:28Z",
      "updated_at": "2022-11-01T00:43:28Z"
    }
  ],
  "created_at": "2022-10-28T19:01:44Z",
  "labels": [
    "Area-DSC",
    "Needs-Triage"
  ],
  "number": 18410,
  "state": "open",
  "title": "PS 7.2",
  "updated_at": "2022-11-01T00:43:28Z"
}
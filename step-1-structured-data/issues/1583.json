{
  "_url": "https://github.com/PowerShell/PowerShell/issues/1583",
  "author": "vors",
  "body": "<!--\n\nIf it is a bug report:\n- make sure you are able to repro it on the latest released version. \nYou can install the latest version from https://github.com/PowerShell/PowerShell/releases\n- Search the existing issues.\n- Refer to the [FAQ](../docs/FAQ.md).\n- Refer to the [known issues](../docs/KNOWNISSUES.md).\n- Fill out the following repro template\n\nIf it's not a bug, please remove the template and elaborate the issue in your own words.\n-->\n## Steps to reproduce\n\n``` powershell\npowershell -Noprofile -Command '\"[Console]::Error.Write(\"\"\"\"foo\"\"\"\")\"'\n```\n## Expected behavior\n\nThis is inbox windows v5.1 behavior\n\n```\nPS C:\\> $powershell = Join-Path -Path $PsHome -ChildPath \"powershell\"\nPS C:\\> & $powershell -Noprofile -Command '\"[Console]::Error.Write(\"\"\"\"foo\"\"\"\")\"'\nfooPS C:\\>\n```\n## Actual behavior\n\n\"where are quotes around `foo`\"?\n\n```\nPS /Users/vors/dev/PowerShell> $powershell = Join-Path -Path $PsHome -ChildPath \"powershell\"                                                 \nPS /Users/vors/dev/PowerShell> & $powershell -Noprofile -Command '\"[Console]::Error.Write(\"\"\"\"foo\"\"\"\")\"'                                     \nAt line:1 char:24                                                                                                                            \n+ [Console]::Error.Write(foo)                                                                                                                \n+                        ~                                                                                                                   Missing ')' in method call.                                                                                                                 \n At line:1 char:24                                                                                                                            + [Console]::Error.Write(foo)                                                                                                                \n+                        ~~~\nUnexpected token 'foo' in expression or statement.\nAt line:1 char:27\n+ [Console]::Error.Write(foo)\n+                           ~\nUnexpected token ')' in expression or statement.\n    + CategoryInfo          : ParserError: (:) [], ParentContainsErrorRecordException\n    + FullyQualifiedErrorId : MissingEndParenthesisInMethodCall\n\n```\n## Environment data\n\n<!-- provide the output of $PSVersionTable -->\n\n``` powershell\n> $PSVersionTable\nName                           Value                                                                                                        \n----                           -----                                                                                                        \nPSVersion                      5.1.10032.0                                                                                                  \nPSEdition                      PowerShellCore                                                                                               \nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}                                                                                      \nBuildVersion                   3.0.0.0                                                                                                      \nGitCommitId                    v6.0.0-alpha.7                                                                                               \nCLRVersion                                                                                                                                  \nWSManStackVersion              3.0                                                                                                          \nPSRemotingProtocolVersion      2.3                                                                                                          \nSerializationVersion           1.1.0.1\n```\n",
  "closed_at": null,
  "comments": [
    {
      "author": "TSlivede",
      "author_association": "NONE",
      "body": "Well I think, this is just a consequence of https://github.com/PowerShell/PowerShell/issues/1995 \r\n\r\nIf you launch powershell from bash (on linux):\r\n`powershell -Noprofile -Command '[Console]::Error.Write(\"foo\")'`\r\npowershell gets `[Console]::Error.Write(\"foo\")` as argv[3] and it works.\r\n\r\nIf you launch powershell from cmd:\r\n`powershell -Noprofile -Command \"[Console]::Error.Write(\\\"foo\\\")\"`\r\npowershell gets `[Console]::Error.Write(\"foo\")` as argv[3] *\\* and it works.\r\n\r\nWhen https://github.com/PowerShell/PowerShell/issues/1995 is fixed for window and linux\r\n`powershell -Noprofile -Command '[Console]::Error.Write(\"foo\")'`\r\nwill work on window and linux from within powershell.\r\n\r\nTherefore I think this bug can be closed, as powershell already handles arguments the same on windows and linux: It takes all arguments from `argv` that follow after `-Command`, puts spaces in between and executes the command.\r\n\r\n*\\* (after commandline is splitted via `CommandLineToArgvW` or `[System.Environment]::GetCommandLineArgs()` or whatever powershell uses...)\r\n",
      "created_at": "2016-10-19T17:51:04Z",
      "updated_at": "2017-03-08T18:15:02Z"
    },
    {
      "author": "joeyaiello",
      "author_association": "CONTRIBUTOR",
      "body": "This is my current repro (still different from 5.1, but at least with the quotes still there):\r\n\r\n```\r\nC:\\temp> $powershell = Join-Path -Path $PsHome -ChildPath \"powershell\"\r\nC:\\temp> & $powershell -Noprofile -Command '\"[Console]::Error.Write(\"\"\"\"foo\"\"\"\")\"'\r\nAt line:1 char:26\r\n+ [Console]::Error.Write(\"\"foo\"\")\r\n+                          ~\r\nMissing ')' in method call.\r\nAt line:1 char:26\r\n+ [Console]::Error.Write(\"\"foo\"\")\r\n+                          ~~~~~\r\nUnexpected token 'foo\"\"' in expression or statement.\r\nAt line:1 char:31\r\n+ [Console]::Error.Write(\"\"foo\"\")\r\n+                               ~\r\nUnexpected token ')' in expression or statement.\r\n    + CategoryInfo          : ParserError: (:) [], ParentContainsErrorRecordException\r\n    + FullyQualifiedErrorId : MissingEndParenthesisInMethodCall\r\n```",
      "created_at": "2017-05-23T19:45:22Z",
      "updated_at": "2017-05-23T19:45:22Z"
    },
    {
      "author": "TSlivede",
      "author_association": "NONE",
      "body": "I hope that this will soon be simplified, but the correct usage is currently:\r\n```\r\n& $powershell -Noprofile -Command '[Console]::Error.Write(\\\"foo\\\")'\r\n```\r\n(If the RFC gets accepted, the backslashes are no longer necessary and must be removed.)\r\n\r\nIf you want to be safe, you could use `--%`\r\n```\r\n& $powershell --% -Noprofile -Command \"[Console]::Error.Write(\\\"foo\\\")\"\r\n```",
      "created_at": "2017-05-23T19:59:22Z",
      "updated_at": "2017-05-23T20:16:13Z"
    }
  ],
  "created_at": "2016-07-31T19:43:07Z",
  "number": 1583,
  "state": "open",
  "title": "powershell.exe -Command parameter should handle quotes consistently across hosts and platforms",
  "updated_at": "2018-07-22T00:46:21Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/15780",
  "author": "SteveL-MSFT",
  "body": "### Prerequisites\n\n- [X] Write a descriptive title.\n- [X] Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\n- [X] Search the existing issues.\n- [X] Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\n- [X] Refer to [Differences between Windows PowerShell 5.1 and PowerShell](https://docs.microsoft.com/powershell/scripting/whats-new/differences-from-windows-powershell).\n\n### Steps to reproduce\n\nUse master branch (or 7.2 preview 8 or newer where https://github.com/PowerShell/PowerShell/pull/14513 is available.\r\n\r\n```powershell\r\nget-process | format-table -view <tab>\r\n```\r\n\r\nNot sure where it's picking up System.Diagnostics.FileVersionInfo as an option.  If you choose it, you'll get an error:\r\n\r\n```console\r\nFormat-Table: The view name System.Diagnostics.FileVersionInfo cannot be found. Specify one of the following Table views and try again: process, Priority, StartTime.\r\n```\r\n\n\n### Expected behavior\n\n```console\nprocess                             StartTime\r\nProcessModule                       Priority                            ProcessWithUserName\n```\n\n\n### Actual behavior\n\n```console\nSystem.Diagnostics.FileVersionInfo  process                             StartTime\r\nProcessModule                       Priority                            ProcessWithUserName\n```\n\n\n### Error details\n\n```console\nException             :\r\n    Type        : System.Management.Automation.PipelineStoppedException\r\n    ErrorRecord :\r\n        Exception             :\r\n            Type    : System.Management.Automation.ParentContainsErrorRecordException\r\n            Message : The pipeline has been stopped.\r\n            HResult : -2146233087\r\n        CategoryInfo          : OperationStopped: (:) [], ParentContainsErrorRecordException\r\n        FullyQualifiedErrorId : PipelineStopped\r\n    TargetSite  :\r\n        Name          : ThrowTerminatingError\r\n        DeclaringType : System.Management.Automation.MshCommandRuntime, System.Management.Automation, Version=7.2.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\r\n        MemberType    : Method\r\n        Module        : System.Management.Automation.dll\r\n    StackTrace  :\r\n   at System.Management.Automation.MshCommandRuntime.ThrowTerminatingError(ErrorRecord errorRecord) in\r\n/Users/steve/repos/PowerShell/src/System.Management.Automation/engine/MshCommandRuntime.cs:line 2086\r\n    Message     : The pipeline has been stopped.\r\n    Source      : System.Management.Automation\r\n    HResult     : -2146233087\r\nTargetObject          : System.Diagnostics.FileVersionInfo\r\nCategoryInfo          : ObjectNotFound: (System.Diagnostics.FileVersionInfo:String) [Format-Table], PipelineStoppedException\r\nFullyQualifiedErrorId : FormatViewNotFound,Microsoft.PowerShell.Commands.FormatTableCommand\r\nErrorDetails          : The view name System.Diagnostics.FileVersionInfo cannot be found. Specify one of the following Table views and try again: process, Priority, StartTime.\r\nInvocationInfo        :\r\n    MyCommand        : Format-Table\r\n    ScriptLineNumber : 1\r\n    OffsetInLine     : 15\r\n    HistoryId        : 11\r\n    Line             : get-process | format-table -View 'System.Diagnostics.FileVersionInfo'\r\n    PositionMessage  : At line:1 char:15\r\n                       + get-process | format-table -View 'System.Diagnostics.FileVersionInfo'\r\n                       +               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    InvocationName   : format-table\r\n    CommandOrigin    : Internal\r\nScriptStackTrace      : at <ScriptBlock>, <No file>: line 1\n```\n\n\n### Environment data\n\n```powershell\nName                           Value\r\n----                           -----\r\nPSVersion                      7.2.0-preview.7\r\nPSEdition                      Core\r\nGitCommitId                    7.2.0-preview.7-41-gb7d6ef2e506fb76e3c94abac2c59a17e48e17084\r\nOS                             Darwin 20.5.0 Darwin Kernel Version 20.5.0: Sat May  8 05:10:31 PDT 2021; root:xnu-7195.121.3~9/RELEASE_ARM64_T8101\r\nPlatform                       Unix\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\n```\n\n\n### Visuals\n\n_No response_",
  "closed_at": "2021-07-15T01:03:51Z",
  "comments": [
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "So the reason `FileVersionInfo` shows up is that `Get-Process` can return those types when `-FileVersionInfo` is used, so this feature is working as expected, but there's an unfortunate side-effect of providing a view that may not be valid.  I don't think there's anything we can do here.",
      "created_at": "2021-07-15T01:03:51Z",
      "updated_at": "2021-07-15T01:03:51Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Yes, it is a limitation. This works if we use a variable:\r\n```powershell\r\n$p = Get-Process\r\n$p | Format-Table -View <Tab>\r\n```\r\nsince we can do _exact_ type inference.\r\n\r\n> I don't think there's anything we can do here.\r\n\r\nWe could enhance OutputType attribute to reflect parameter sets. Today we only add the metadata as a list:\r\n```powershell\r\n[OutputType(typeof(ProcessModule), typeof(FileVersionInfo), typeof(Process))]\r\n```\r\nProposal could be:\r\n```powershell\r\n[OutputType(ParameterSetName = NameParameterSet, typeof(FileVersionInfo))]\r\n```",
      "created_at": "2021-07-15T03:31:05Z",
      "updated_at": "2021-07-15T03:31:05Z"
    }
  ],
  "created_at": "2021-07-15T00:14:20Z",
  "number": 15780,
  "state": "closed",
  "title": "System.Diagnostics.Process shows a `FileVersionInfo` view that doesn't exist",
  "updated_at": "2021-07-15T03:31:05Z"
}
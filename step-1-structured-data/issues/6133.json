{
  "_url": "https://github.com/PowerShell/PowerShell/issues/6133",
  "author": "PaulHigin",
  "body": "## PR Summary\r\n\r\nThese changes port Windows PowerShell support for Applocker and DeviceGuard User Mode Code Integrity (UMCI) to PSCore6.  Windows PowerShell uses public APIs to determine if a system is in locked down mode via AppLocker or DeviceGuard, and automatically runs in constrained language mode.  For more information about PowerShell constrained language, see: https://blogs.msdn.microsoft.com/powershell/2017/11/02/powershell-constrained-language-mode/\r\n\r\nThis support for application white listing has mostly existed in PSCore6, but the primary APIs were stubbed out in CorePSStub.cs because they relied on Windows only DeviceGuard (wldp.dll) and AppLocker (Safer APIs) public APIs.  These changes re-implement PowerShell lock down APIs on PSCore6 for Windows platforms only.  The AppLocker and DeviceGuard public APIs are currently only implemented in Windows OSes and are not supported on Linux or MacOS platforms.\r\n\r\nTests have also been ported to PSCore6 and run only for Windows platforms.\r\n\r\n## PR Checklist\r\n\r\nNote: Please mark anything not applicable to this PR `NA`.\r\n\r\n- [x] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - [x] Use the present tense and imperative mood when describing your changes\r\n- [x] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [`NA`] User facing [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - [ ] Issue filed - Issue link:\r\n- [x] [Change is not breaking](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)\r\n- [x] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n    - [x] [Add `[feature]` if the change is significant or affects feature tests](https://github.com/PowerShell/PowerShell/blob/master/docs/testing-guidelines/testing-guidelines.md#requesting-additional-tests-for-a-pr)\r\n- [x] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - If the PR is work in progress, please add the prefix `WIP:` to the beginning of the title and remove the prefix when the PR is ready.\r\n",
  "closed_at": "2018-04-17T20:09:17Z",
  "comments": [
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "`[feature]` goes in the commit description not the PR title.",
      "created_at": "2018-02-08T20:24:44Z",
      "updated_at": "2018-02-08T20:24:44Z"
    },
    {
      "author": "PaulHigin",
      "author_association": "COLLABORATOR",
      "body": "Thanks, I forgot that.  Will submit another commit soon.",
      "created_at": "2018-02-08T21:06:31Z",
      "updated_at": "2018-02-08T21:06:31Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "Please fix the merge conflicts",
      "created_at": "2018-02-14T00:55:54Z",
      "updated_at": "2018-02-14T00:55:54Z"
    },
    {
      "author": "stale[bot]",
      "author_association": "NONE",
      "body": "This PR has been automatically marked as stale because it has not had activity in the last 30 days. It will be closed if no further activity occurs within 10 days. Thank you for your contributions.\n",
      "created_at": "2018-03-22T23:49:30Z",
      "updated_at": "2018-03-22T23:49:30Z"
    },
    {
      "author": "PaulHigin",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT  Why is this PR being abandoned?",
      "created_at": "2018-03-23T16:13:19Z",
      "updated_at": "2018-03-23T16:13:19Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@PaulHigin it's not abandoned (yet).  We enabled a new bot to automatically flag stale PRs.  For this PR, I think you just need to resolve the merge conflicts and we can proceed.",
      "created_at": "2018-03-23T21:13:26Z",
      "updated_at": "2018-03-23T21:13:26Z"
    },
    {
      "author": "PaulHigin",
      "author_association": "COLLABORATOR",
      "body": "Oh, I didn't see that.  Will do.",
      "created_at": "2018-03-23T21:23:09Z",
      "updated_at": "2018-03-23T21:23:09Z"
    },
    {
      "author": "PaulHigin",
      "author_association": "COLLABORATOR",
      "body": "@TravisEz13  I just noticed that this PR is still active.  Is there any reason why it has not been merged?",
      "created_at": "2018-04-11T20:11:49Z",
      "updated_at": "2018-04-11T20:11:49Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "@PaulHigin  Please address my comment: https://github.com/PowerShell/PowerShell/pull/6133#pullrequestreview-96678613",
      "created_at": "2018-04-11T22:57:10Z",
      "updated_at": "2018-04-11T22:57:10Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "restarting windows tests due to the following failure\r\n```\r\nDescribing Implicit remoting on restricted ISS\r\nVERBOSE: Using Global AppVeyor Credential\r\npwsh.exe : New-PSSession : [localhost] Connecting to remote server localhost failed with the following error message : Access is denied. For more information, see the about_Remote_Troubleshooting Help topic.\r\nAt C:\\projects\\powershell\\build.psm1:1224 char:48\r\n+ ... art-NativeExecution -sb {& $powershell -noprofile -c $command} | ForE ...\r\n+                              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    + CategoryInfo          : NotSpecified: (New-PSSession :...ing Help topic.:String) [], RemoteException\r\n    + FullyQualifiedErrorId : NativeCommandError\r\n \r\nAt C:\\projects\\powershell\\test\\tools\\Modules\\HelpersRemoting\\HelpersRemoting.psm1:96 char:20\r\n+         $session = New-PSSession @parameters\r\n+                    ~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+ CategoryInfo          : OpenError: (System.Manageme....RemoteRunspace:RemoteRunspace) [New-PSSession], PSRemotingTransportException\r\n+ FullyQualifiedErrorId : AccessDenied,PSSessionOpenFailed\r\n    [-] Error occurred in Describe block 19.89s\r\n      Expected a value, but got $null or empty.\r\n      1500:             $session | Should -Not -BeNullOrEmpty\r\n      at <ScriptBlock>, C:\\projects\\powershell\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Implicit.Remoting.Tests.ps1: line 1500\r\n      at Invoke-Blocks, C:\\projects\\powershell\\src\\powershell-win-core\\bin\\Release\\netcoreapp2.0\\win7-x64\\publish\\Modules\\Pester\\4.3.1\\Functions\\SetupTeardown.ps1: line 140\r\n      at Invoke-TestGroupSetupBlocks, C:\\projects\\powershell\\src\\powershell-win-core\\bin\\Release\\netcoreapp2.0\\win7-x64\\publish\\Modules\\Pester\\4.3.1\\Functions\\SetupTeardown.ps1: line 125\r\n      at DescribeImpl, C:\\projects\\powershell\\src\\powershell-win-core\\bin\\Release\\netcoreapp2.0\\win7-x64\\publish\\Modules\\Pester\\4.3.1\\Functions\\Describe.ps1: line 157\r\n  Describing Implicit remoting tests\r\nVERBOSE: Using Global AppVeyor Credential\r\n    Context Get-Command <Imported-Module> and <Imported-Module.Name> work (Windows 7: #334112)\r\n```",
      "created_at": "2018-04-13T17:26:44Z",
      "updated_at": "2018-04-13T17:26:44Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "@PaulHigin It failed again with the same error.",
      "created_at": "2018-04-16T21:29:19Z",
      "updated_at": "2018-04-16T21:29:19Z"
    },
    {
      "author": "PaulHigin",
      "author_association": "COLLABORATOR",
      "body": "Hmm, these were passing.  I'll take a look.",
      "created_at": "2018-04-16T22:03:15Z",
      "updated_at": "2018-04-16T22:03:15Z"
    },
    {
      "author": "PaulHigin",
      "author_association": "COLLABORATOR",
      "body": "@TravisEz13  These are remoting tests that have nothing to do with these changes.  The fact that they are failing should not affect this PR.",
      "created_at": "2018-04-17T17:26:16Z",
      "updated_at": "2018-04-17T17:26:16Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "We don't merge with CI tests failing, except if the PR is required to unblock. I've restarted the AppVeyor tests.",
      "created_at": "2018-04-17T18:31:33Z",
      "updated_at": "2018-04-17T18:31:33Z"
    }
  ],
  "created_at": "2018-02-07T23:49:07Z",
  "number": 6133,
  "state": "closed",
  "title": "Port Windows PowerShell AppLocker and DeviceGuard UMCI application white listing support",
  "updated_at": "2018-06-11T20:56:47Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/3870",
  "author": "iSazonov",
  "body": "Related #3400\r\n(Also it is one step to unblock #3690)\r\n\r\nNow Microsoft.PowerShell.SDK.csproj:\r\n1. Generate Reference Assembly List (\"RefAssemblyList.inc\" file) in project local sub directory \"gen\" (Target Name=\"TypeCatalogGen\"):\r\n - Check if Reference Assembly List is updated and only then overwrite RefAssemblyList.inc\r\n - If RefAssemblyList.inc is updated then generate new CorePsTypeCatalog.cs \r\n2. Support Clean target to remove RefAssemblyList.inc (for rebuild)\r\n\r\n\r\n\r\n<!--\r\n\r\nIf you are a PowerShell Team member, please make sure you choose the Reviewer(s) and Assignee for your PR.\r\nIf you are not from the PowerShell Team, you can leave the fields blank and the Maintainers will choose them for you. If you are familiar with the team, feel free to mention some Reviewers yourself.\r\n\r\nFor more information about the roles of Reviewer and Assignee, refer to CONTRIBUTING.md.\r\n\r\n-->\r\n",
  "closed_at": "2018-05-23T04:18:42Z",
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@daxian-dbw I think I'm a little late with the PR, but it could still be useful for a while.",
      "created_at": "2017-06-01T16:08:23Z",
      "updated_at": "2017-06-01T16:08:23Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@iSazonov We still need to have `TypeCatalogGen` in our build. With the type catalog, you can use a .NET type without caring whether the assembly that contains it is already loaded because powershell is able to look it up in the type catalog and load the assembly automatically. So it would be a breaking change if we remove the type catalog. And `TypeCatalogGen` will be useful for new features too, for example, the extension methods support @powercode is working on -- we will need to do some analysis of all reference assemblies at build time to build a cache of all .NET extension methods, which will improve the runtime performance. So this PR is not late \ud83d\ude04\r\nBTW, I'm busy on other tasks recently and thus is slow on code review, sorry for that.",
      "created_at": "2017-06-01T19:57:10Z",
      "updated_at": "2017-06-01T19:57:10Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@TravisEz13 @daxian-dbw Could you please continue the code review?",
      "created_at": "2017-06-14T06:44:31Z",
      "updated_at": "2017-06-14T06:44:31Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "@daxian-dbw Are you ok with this change now?",
      "created_at": "2017-06-23T02:14:05Z",
      "updated_at": "2017-06-23T02:14:05Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@TravisEz13 I haven't got the time to carefully review this yet. Will do it soon.",
      "created_at": "2017-06-23T15:44:57Z",
      "updated_at": "2017-06-23T15:44:57Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@daxian-dbw Could you please review?",
      "created_at": "2017-07-14T10:12:50Z",
      "updated_at": "2017-07-14T10:12:50Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "Will the `TypeCatalogGen` target execute when we running `dotnet restore` or `dotnet build` on `Microsoft.PowerShell.SDK.csproj`?",
      "created_at": "2017-08-18T23:27:35Z",
      "updated_at": "2017-08-18T23:27:35Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "We call `dotnet msbuild .\\Microsoft.PowerShell.SDK.csproj /t:\"Clean;TypeCatalogGen\" \"/property:DesignTimeBuild=true\" ` in Build.psm1 in the same point as before - so the behavior must be the same.\r\n\r\nAh, sorry - your question of a direct call - it needs to be checked explicitly because dependencies is deeply.\r\n\r\nUpdate: I preserve current logic - currently we call `Start-PSBuild -TypeGen` (and `dotnet msbuild .\\Microsoft.PowerShell.SDK.csproj /t:_GetDependencies \"/property:DesignTimeBuild=true;_DependencyFile=$ps_inc_file\" /nologo`) to update the type catalog and also the type catalog file `CorePsTypeCatalog.cs` will be generated if it absent (or changed, or we have updates in type references.).",
      "created_at": "2017-08-19T21:43:45Z",
      "updated_at": "2017-08-21T10:55:18Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "Great. My concern was that the type catalog (both `.inc` and `.cs`) would be generated when just running `Start-PSBuild` for a build. I will continue the review.\r\n(BTW, I took Monday off, so please don't be concerned if I didn't reply promptly.)",
      "created_at": "2017-08-21T22:57:28Z",
      "updated_at": "2017-08-21T22:57:28Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "@daxian-dbw Do you want to review?",
      "created_at": "2018-03-14T01:13:01Z",
      "updated_at": "2018-03-14T01:13:01Z"
    },
    {
      "author": "stale[bot]",
      "author_association": "NONE",
      "body": "This PR has been automatically marked as stale because it has not had activity in the last 30 days. It will be closed if no further activity occurs within 10 days.\nThank you for your contributions.\nCommunity members are welcome to grab these works.\n",
      "created_at": "2018-04-13T01:35:40Z",
      "updated_at": "2018-04-13T01:35:40Z"
    },
    {
      "author": "stale[bot]",
      "author_association": "NONE",
      "body": "This PR has been automatically marked as stale because it has not had activity in the last 30 days. It will be closed if no further activity occurs within 10 days.\nThank you for your contributions.\nCommunity members are welcome to grab these works.\n",
      "created_at": "2018-05-20T07:41:21Z",
      "updated_at": "2018-05-20T07:41:21Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Should I fix or close the PR?\r\n\r\n/cc @daxian-dbw ",
      "created_at": "2018-05-21T03:35:40Z",
      "updated_at": "2018-05-21T03:35:40Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "Sorry that I completely lost the context here. I won't have much time for code review recently. I'm fine we close this PR for now and we can revive it when needed.",
      "created_at": "2018-05-22T17:37:58Z",
      "updated_at": "2018-05-22T17:37:58Z"
    }
  ],
  "created_at": "2017-05-26T11:56:24Z",
  "number": 3870,
  "state": "closed",
  "title": "Move Start-TypeGen logic from Build.psm1 to SDK csproj file",
  "updated_at": "2018-05-23T04:18:42Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/16850",
  "author": "schuelermine",
  "body": "### Prerequisites\n\n- [X] Write a descriptive title.\n- [X] Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\n- [X] Search the existing issues.\n- [X] Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\n- [X] Refer to [Differences between Windows PowerShell 5.1 and PowerShell](https://docs.microsoft.com/powershell/scripting/whats-new/differences-from-windows-powershell).\n\n### Steps to reproduce\n\nOn Unix-like systems, if a `FileInfo` or `DirectoryInfo` object is formatted as a list by `Format-List`, it displays the `Mode` property, but if it is formatted as a table, e.g. by `Format-Table`, it displays the `UnixMode` property.\n\n### Expected behavior\n\n```console\nPS /> gi . | ft\r\n\r\n    Directory: \r\n\r\nUnixMode   User             Group                 LastWriteTime           Size Name\r\n--------   ----             -----                 -------------           ---- ----\r\ndrwxr-xr-x root             root               11/10/2021 00:23           4096 /\r\n\r\nPS /> gi . | fl\r\n\r\n    Directory: \r\n\r\nName           : /\r\nCreationTime   : 11/10/2021 00:23:56\r\nLastWriteTime  : 11/10/2021 00:23:56\r\nLastAccessTime : 05/02/2022 10:56:57\r\nUnixMode       : drwxr-xr-x\r\nLinkType       : \r\nTarget         :\n```\n\n\n### Actual behavior\n\n```console\nPS /> gi . | ft\r\n\r\n    Directory: \r\n\r\nUnixMode   User             Group                 LastWriteTime           Size Name\r\n--------   ----             -----                 -------------           ---- ----\r\ndrwxr-xr-x root             root               11/10/2021 00:23           4096 /\r\n\r\nPS /> gi . | fl\r\n\r\n    Directory: \r\n\r\nName           : /\r\nCreationTime   : 11/10/2021 00:23:56\r\nLastWriteTime  : 11/10/2021 00:23:56\r\nLastAccessTime : 05/02/2022 10:56:57\r\nMode           : d-r--\r\nLinkType       : \r\nTarget         :\n```\n\n\n### Error details\n\n_No response_\n\n### Environment data\n\n```powershell\nPS /> $PSVersionTable\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.2.1\r\nPSEdition                      Core\r\nGitCommitId                    7.2.1\r\nOS                             Linux 5.16.2 #1-NixOS SMP PREEMPT Thu Jan 20 08:12:22 UTC 2022\r\nPlatform                       Unix\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\n```\n\n\n### Visuals\n\n_No response_",
  "closed_at": null,
  "comments": [
    {
      "author": "237dmitry",
      "author_association": "NONE",
      "body": "You can edit output format and  update default with custom one. `Update-FormatData`\r\n![fd](https://user-images.githubusercontent.com/78153320/152644779-6b9a6492-5db6-4619-b6af-35bb6d0d56b6.png)\r\n\r\n<details>\r\n  <summary>CustomFormat.ps1xml (Thanks to @jhoneill)</summary>\r\n\r\n  ```powershell\r\n  <?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<Configuration>\r\n  <SelectionSets><SelectionSet>\r\n    <Name>FileSystemTypes</Name>\r\n      <Types>\r\n        <TypeName>System.IO.DirectoryInfo</TypeName>\r\n        <TypeName>System.IO.FileInfo</TypeName>\r\n      </Types>\r\n    </SelectionSet></SelectionSets>\r\n\r\n    <!-- ################ GLOBAL CONTROL DEFINITIONS ################ -->\r\n    <Controls><Control>\r\n      <Name>FileSystemTypes-GroupingFormat</Name>\r\n      <CustomControl><CustomEntries><CustomEntry><CustomItem><Frame><CustomItem>\r\n        <Text AssemblyName=\"System.Management.Automation\" BaseName=\"FileSystemProviderStrings\" ResourceId=\"DirectoryDisplayGrouping\"/>\r\n        <ExpressionBinding><ScriptBlock>$_.PSParentPath.Replace(\"Microsoft.PowerShell.Core\\FileSystem::\", \"\").Replace($HOME,\"~\")</ScriptBlock></ExpressionBinding>\r\n      </CustomItem></Frame></CustomItem></CustomEntry></CustomEntries></CustomControl>\r\n    </Control></Controls>\r\n\r\n    <!-- ################ VIEW DEFINITIONS ################ -->\r\n    <ViewDefinitions>\r\n      <View>\r\n        <Name>children</Name>\r\n        <ViewSelectedBy><SelectionSetName>FileSystemTypes</SelectionSetName></ViewSelectedBy>\r\n        <GroupBy>\r\n            <PropertyName>PSParentPath</PropertyName>\r\n            <CustomControlName>FileSystemTypes-GroupingFormat</CustomControlName>\r\n        </GroupBy>\r\n        <TableControl>\r\n            <TableHeaders>\r\n                <TableColumnHeader><Label>UnixMode</Label><Width>10</Width><Alignment>left</Alignment></TableColumnHeader>\r\n                <TableColumnHeader><Label>ACL</Label><Width>5</Width><Alignment>right</Alignment></TableColumnHeader>\r\n                <TableColumnHeader><Label>User</Label><Width>7</Width><Alignment>right</Alignment></TableColumnHeader>\r\n                <TableColumnHeader><Label>Group</Label><Width>7</Width><Alignment>right</Alignment></TableColumnHeader>\r\n                <TableColumnHeader><Label>LastWriteTime</Label><Width>18</Width><Alignment>right</Alignment></TableColumnHeader>\r\n                <TableColumnHeader><Label>Size</Label><Width>7</Width><Alignment>right</Alignment></TableColumnHeader>\r\n                <TableColumnHeader><Label>Name</Label></TableColumnHeader>\r\n            </TableHeaders>\r\n            <TableRowEntries><TableRowEntry>\r\n                <Wrap/>\r\n                <TableColumnItems>\r\n                    <TableColumnItem><PropertyName>UnixMode</PropertyName></TableColumnItem>\r\n                    <TableColumnItem><ScriptBlock>\r\n\r\n                        switch ($_.UnixStat.ItemType)\r\n                        {\r\n                            'NamedPipe'       { $a =  4096 }\r\n                            'CharacterDevice' { $a =  8192 }\r\n                            'Directory'       { $a = 16384 }\r\n                            'BlockDevice'     { $a = 24576 }\r\n                            'File'            { $a = 32768 }\r\n                            'SymbolicLink'    { $a = 40960 }\r\n                            'Socket'          { $a = 49152 }\r\n                        }\r\n\r\n                        [convert]::ToString(($_.UnixStat.Mode - $a),8)\r\n\r\n                    </ScriptBlock></TableColumnItem>\r\n                    <TableColumnItem><PropertyName>User</PropertyName></TableColumnItem>\r\n                    <TableColumnItem><PropertyName>Group</PropertyName></TableColumnItem>\r\n                    <TableColumnItem><ScriptBlock>\r\n                        '{0,16:dd.MM.yyyy HH:mm}' -f $_.LastWriteTime\r\n                    </ScriptBlock></TableColumnItem>\r\n                    <TableColumnItem><ScriptBlock>\r\n                            switch ($_)\r\n                            {\r\n                                { $_ -is [System.IO.DirectoryInfo] } { $null }\r\n                                { $_.Length -gt 1TB } { '{0:#.#}T' -f ($_.Length / 1TB); break }\r\n                                { $_.Length -gt 1GB } { '{0:#.#}G' -f ($_.Length / 1GB); break }\r\n                                { $_.Length -gt 1MB } { '{0:#.#}M' -f ($_.Length / 1MB); break }\r\n                                { $_.Length -gt 1KB } { '{0:#.#}K' -f ($_.Length / 1KB); break }\r\n                                              default { $_.Length }\r\n                            }\r\n                    </ScriptBlock></TableColumnItem>\r\n                  <TableColumnItem><PropertyName>NameString</PropertyName></TableColumnItem>\r\n                </TableColumnItems>\r\n            </TableRowEntry></TableRowEntries>\r\n        </TableControl>\r\n      </View>\r\n      <View>\r\n        <Name>children</Name>\r\n        <ViewSelectedBy><SelectionSetName>FileSystemTypes</SelectionSetName></ViewSelectedBy>\r\n        <GroupBy>\r\n            <PropertyName>PSParentPath</PropertyName>\r\n            <CustomControlName>FileSystemTypes-GroupingFormat</CustomControlName>\r\n        </GroupBy>\r\n        <ListControl>\r\n          <ListEntries>\r\n            <ListEntry>\r\n              <ListItems>\r\n                <ListItem><PropertyName>Name</PropertyName></ListItem>\r\n                <ListItem><Label>Size</Label><ScriptBlock>\r\n\r\n                  switch ($_)\r\n                  {\r\n                      { $_ -is [System.IO.DirectoryInfo] } { $null }\r\n                      { $_.Length -gt 1TB } { '{0:#.#}T' -f ($_.Length / 1TB); break }\r\n                      { $_.Length -gt 1GB } { '{0:#.#}G' -f ($_.Length / 1GB); break }\r\n                      { $_.Length -gt 1MB } { '{0:#.#}M' -f ($_.Length / 1MB); break }\r\n                      { $_.Length -gt 1KB } { '{0:#.#}K' -f ($_.Length / 1KB); break }\r\n                                    default { $_.Length }\r\n                  }\r\n\r\n                </ScriptBlock></ListItem>\r\n                <ListItem><PropertyName>CreationTime</PropertyName></ListItem>\r\n                <ListItem><PropertyName>LastWriteTime</PropertyName></ListItem>\r\n                <ListItem><PropertyName>LastAccessTime</PropertyName></ListItem>\r\n                <ListItem><PropertyName>UnixMode</PropertyName></ListItem>\r\n                <ListItem><Label>ACL</Label><ScriptBlock>\r\n\r\n                  switch ($_.UnixStat.ItemType)\r\n                  {\r\n                      'NamedPipe'       { $a =  4096 }\r\n                      'CharacterDevice' { $a =  8192 }\r\n                      'Directory'       { $a = 16384 }\r\n                      'BlockDevice'     { $a = 24576 }\r\n                      'File'            { $a = 32768 }\r\n                      'SymbolicLink'    { $a = 40960 }\r\n                      'Socket'          { $a = 49152 }\r\n                  }\r\n\r\n                  [convert]::ToString(($_.UnixStat.Mode - $a),8)\r\n\r\n              </ScriptBlock></ListItem>\r\n              <ListItem><PropertyName>LinkType</PropertyName></ListItem>\r\n              <ListItem><PropertyName>Target</PropertyName></ListItem>\r\n          </ListItems>\r\n        </ListEntry></ListEntries></ListControl>\r\n      </View>\r\n    </ViewDefinitions>\r\n</Configuration>\r\n  ```\r\n</details>\r\n\r\n",
      "created_at": "2022-02-05T14:10:52Z",
      "updated_at": "2022-02-05T14:30:07Z"
    },
    {
      "author": "schuelermine",
      "author_association": "CONTRIBUTOR",
      "body": "Yes, but I think that should be the default wherever UnixMode is already the default.",
      "created_at": "2022-02-05T14:52:33Z",
      "updated_at": "2022-02-05T14:52:33Z"
    },
    {
      "author": "jhoneill",
      "author_association": "NONE",
      "body": "You can customize it, but really the properties for list and table should be in sync - there is no reason for them to be different. \r\n\r\nIt looks to me like the table was changed for Unix and the list was overlooked.   ",
      "created_at": "2022-02-05T18:52:08Z",
      "updated_at": "2022-02-05T18:52:08Z"
    },
    {
      "author": "rkeithhill",
      "author_association": "COLLABORATOR",
      "body": "As an example of the customization, I use `Update-TypeData` to remove the `@AD.COMPANYNAME.COM` from both `User` and `Group` PSScriptProperties since it was causing gci tabular output to wrap.",
      "created_at": "2022-02-05T19:02:44Z",
      "updated_at": "2022-02-05T19:13:20Z"
    },
    {
      "author": "jhoneill",
      "author_association": "NONE",
      "body": "@iSazonov   Do we know a reason why the list _should_ show a different mode from the table ?\r\n\r\nhttps://github.com/PowerShell/PowerShell/blob/master/src/System.Management.Automation/FormatAndOutput/DefaultFormatters/FileSystem_format_ps1xml.cs  has an `#if unix` block _for tables_ at line 44,  but there isn't one _for lists_.  \r\n\r\nIf I'm right and this was by omission not by design , then should be marked as a bug not an enhancement.  It's one of those mods where adding a test is much more work than making the change :-)    \r\n\n\n<blockquote><img src=\"https://repository-images.githubusercontent.com/49609581/aad0ad80-cdec-11ea-8248-a37bc0571bfd\" width=\"48\" align=\"right\"><div><img src=\"https://github.githubassets.com/favicons/favicon.svg\" height=\"14\"> GitHub</div><div><strong><a href=\"https://github.com/PowerShell/PowerShell\">PowerShell/FileSystem_format_ps1xml.cs at master \u00b7 PowerShell/PowerShell</a></strong></div><div>PowerShell for every system! Contribute to PowerShell/PowerShell development by creating an account on GitHub.</div></blockquote>",
      "created_at": "2022-02-06T11:49:44Z",
      "updated_at": "2022-02-06T11:49:46Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "> @iSazonov Do we know a reason why the list _should_ show a different mode from the table ?\r\n\r\nIt was an enhancement from @JamesWTruher for table format. Anybody could pull a PR to enhance list format too.",
      "created_at": "2022-02-06T17:51:31Z",
      "updated_at": "2022-02-06T17:51:31Z"
    }
  ],
  "created_at": "2022-02-05T10:52:11Z",
  "number": 16850,
  "state": "open",
  "title": "List format on FileInfo and DirectoryInfo on Unix-like systems shows Mode property instead of UnixMode, unlike table format",
  "updated_at": "2022-02-06T17:51:31Z"
}
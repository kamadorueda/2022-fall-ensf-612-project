{
  "_url": "https://github.com/PowerShell/PowerShell/issues/16947",
  "author": "ahrib",
  "body": "### Prerequisites\n\n- [X] Write a descriptive title.\n- [X] Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\n- [X] Search the existing issues.\n- [X] Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\n- [X] Refer to [Differences between Windows PowerShell 5.1 and PowerShell](https://docs.microsoft.com/powershell/scripting/whats-new/differences-from-windows-powershell).\n\n### Steps to reproduce\n\nAttempting to study for AZ-104 certification on Mac\r\n\r\nenvironment:\r\nCPU: Apple M1 Pro\r\nOS: macOS Monterey version 12.2.1\r\nPowershell version: 7.2.1\r\n\r\nreplication steps:\r\n```\r\nInstall-Module -Name Az -Force\r\nInstall-Module -Name AzureAD -Force\r\nConnect-AzureAD\r\n```\r\n\r\n\r\nadditional diagnosis steps:\r\nrunning `Import-Module AzureAD` results in the message:\r\n> Import-Module: The current processor architecture is: MSIL. The module '_REDACTED_/.local/share/powershell/Modules/AzureAD/2.0.2.140/AzureAD.psd1' requires the following architecture: Amd64.\r\n\r\nA note that _REDACTED_ contained my username and was manually redacted by myself.\n\n### Expected behavior\n\n```console\nthat it works as documented\n```\n\n\n### Actual behavior\n\n```console\nThe term 'Connect-AzureAD' is not recognized as a name of a cmdlet, function, script file, or executable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again\n```\n\n\n### Error details\n\n```console\nxception             : \r\n    Type        : System.Management.Automation.CommandNotFoundException\r\n    ErrorRecord : \r\n        Exception             : \r\n            Type    : System.Management.Automation.ParentContainsErrorRecordException\r\n            Message : The term 'Connect-AzureAD' is not recognized as a name of a cmdlet, function, script file, or \r\nexecutable program.\r\n                      Check the spelling of the name, or if a path was included, verify that the path is correct and \r\ntry again.\r\n            HResult : -2146233087\r\n        TargetObject          : Connect-AzureAD\r\n        CategoryInfo          : ObjectNotFound: (Connect-AzureAD:String) [], ParentContainsErrorRecordException\r\n        FullyQualifiedErrorId : CommandNotFoundException\r\n        InvocationInfo        : \r\n            ScriptLineNumber : 1\r\n            OffsetInLine     : 1\r\n            HistoryId        : 11\r\n            Line             : Connect-AzureAD\r\n            PositionMessage  : At line:1 char:1\r\n                               + Connect-AzureAD\r\n                               + ~~~~~~~~~~~~~~~\r\n            InvocationName   : Connect-AzureAD\r\n            CommandOrigin    : Internal\r\n        ScriptStackTrace      : at <ScriptBlock>, <No file>: line 1\r\n    CommandName : Connect-AzureAD\r\n    TargetSite  : \r\n        Name          : LookupCommandInfo\r\n        DeclaringType : System.Management.Automation.CommandDiscovery, System.Management.Automation, \r\nVersion=7.2.1.500, Culture=neutral, PublicKeyToken=31bf3856ad364e35\r\n        MemberType    : Method\r\n        Module        : System.Management.Automation.dll\r\n    Message     : The term 'Connect-AzureAD' is not recognized as a name of a cmdlet, function, script file, or \r\nexecutable program.\r\n                  Check the spelling of the name, or if a path was included, verify that the path is correct and try \r\nagain.\r\n    Data        : System.Collections.ListDictionaryInternal\r\n    Source      : System.Management.Automation\r\n    HResult     : -2146233087\r\n    StackTrace  : \r\n   at System.Management.Automation.CommandDiscovery.LookupCommandInfo(String commandName, CommandTypes commandTypes, \r\nSearchResolutionOptions searchResolutionOptions, CommandOrigin commandOrigin, ExecutionContext context)\r\n   at System.Management.Automation.CommandDiscovery.LookupCommandInfo(String commandName, CommandOrigin commandOrigin, \r\nExecutionContext context)\r\n   at System.Management.Automation.CommandDiscovery.LookupCommandInfo(String commandName, CommandOrigin commandOrigin)\r\n   at System.Management.Automation.CommandDiscovery.LookupCommandProcessor(String commandName, CommandOrigin \r\ncommandOrigin, Nullable`1 useLocalScope)\r\n   at System.Management.Automation.ExecutionContext.CreateCommand(String command, Boolean dotSource)\r\n   at System.Management.Automation.PipelineOps.AddCommand(PipelineProcessor pipe, CommandParameterInternal[] \r\ncommandElements, CommandBaseAst commandBaseAst, CommandRedirection[] redirections, ExecutionContext context)\r\n   at System.Management.Automation.PipelineOps.InvokePipeline(Object input, Boolean ignoreInput, \r\nCommandParameterInternal[][] pipeElements, CommandBaseAst[] pipeElementAsts, CommandRedirection[][] \r\ncommandRedirections, FunctionContext funcContext)\r\n   at System.Management.Automation.Interpreter.ActionCallInstruction`6.Run(InterpretedFrame frame)\r\n   at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame)\r\nTargetObject          : Connect-AzureAD\r\nCategoryInfo          : ObjectNotFound: (Connect-AzureAD:String) [], CommandNotFoundException\r\nFullyQualifiedErrorId : CommandNotFoundException\r\nInvocationInfo        : \r\n    ScriptLineNumber : 1\r\n    OffsetInLine     : 1\r\n    HistoryId        : 11\r\n    Line             : Connect-AzureAD\r\n    PositionMessage  : At line:1 char:1\r\n                       + Connect-AzureAD\r\n                       + ~~~~~~~~~~~~~~~\r\n    InvocationName   : Connect-AzureAD\r\n    CommandOrigin    : Internal\r\nScriptStackTrace      : at <ScriptBlock>, <No file>: line 1\n```\n\n\n### Environment data\n\n```powershell\nName                           Value\r\n----                           -----\r\nPSVersion                      7.2.1\r\nPSEdition                      Core\r\nGitCommitId                    7.2.1\r\nOS                             Darwin 21.3.0 Darwin Kernel Version 21.3.0: Wed Jan  5 21:37:58 PST 2022; root:xnu-8019\u2026\r\nPlatform                       Unix\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\n```\n\n\n### Visuals\n\n_No response_",
  "closed_at": "2022-03-04T00:00:40Z",
  "comments": [
    {
      "author": "jhoneill",
      "author_association": "NONE",
      "body": "This module isn't delivered by the PowerShell group, but by another team in Microsoft. \r\nIt is written for Windows PowerShell V3 to V5.1, and the authors put this specifically in their PSD file (path in error message) \r\n```\r\n# Processor architecture (None, X86, Amd64) required by this module\r\nProcessorArchitecture = 'Amd64'\r\n\r\n# A URL to the main website for this project.\r\nProjectUri = 'https://docs.microsoft.com/en-us/powershell/azuread/v2/azureactivedirectory'\r\n```\r\nDepending on how the DLLs behind it were compiled it may work if you simply remove the processor architecture reference from the file, but really you need to contact the team behind it. ",
      "created_at": "2022-03-02T13:22:50Z",
      "updated_at": "2022-03-02T13:22:50Z"
    },
    {
      "author": "msftbot[bot]",
      "author_association": "NONE",
      "body": "This issue has been marked as answered and has not had any activity for **1 day**. It has been closed for housekeeping purposes.",
      "created_at": "2022-03-04T00:00:39Z",
      "updated_at": "2022-03-04T00:00:39Z"
    }
  ],
  "created_at": "2022-03-02T04:33:51Z",
  "number": 16947,
  "state": "closed",
  "title": "Connect-AzureAD is not recognized on M1 Mac",
  "updated_at": "2022-03-04T00:00:40Z"
}
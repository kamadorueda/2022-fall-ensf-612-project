{
  "_url": "https://github.com/PowerShell/PowerShell/issues/4573",
  "author": "SteveL-MSFT",
  "body": "Since -File is now the positional parameter for powershell.exe, made the error message consistent with \r\n-Command when passed an invalid file.\r\n\r\nIf ambiguous arg is passed, give a better error message:\r\n\r\n```powershell\r\nPS C:\\users\\poker\\repos\\PowerShell> powershell -no -file foo\r\nInvalid argument '-no', did you mean:\r\n\r\n        -nologo\r\n        -noexit\r\n        -noprofile\r\n        -noninteractive\r\nPowerShell v6.0.0-beta.5-42-g3ed9a816b2452551aaad1ac1245a1cbb35e87612-dirty\r\nCopyright (C) Microsoft Corporation. All rights reserved.\r\n```\r\n\r\nEnable -WindowStyle to work\r\n\r\nFix https://github.com/PowerShell/PowerShell/issues/4351\r\n\r\n<!--\r\n\r\nIf you are a PowerShell Team member, please make sure you choose the Reviewer(s) and Assignee for your PR.\r\nIf you are not from the PowerShell Team, you can leave the fields blank and the Maintainers will choose them for you. If you are familiar with the team, feel free to mention some Reviewers yourself.\r\n\r\nFor more information about the roles of Reviewer and Assignee, refer to CONTRIBUTING.md.\r\n\r\n-->\r\n",
  "closed_at": "2017-08-17T03:34:02Z",
  "comments": [
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "Not sure why some of the new tests fail in AppVeyor but not on my desktop.  Figured it out, need to redirect stderr to stdout.  However, I noticed the tests fail on Mac because the exit code isn't being set, but still shows as passed overall.",
      "created_at": "2017-08-16T12:04:17Z",
      "updated_at": "2017-08-16T13:23:27Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "Figured out why it's failing on non-Windows.  It appears that exit codes from programs have to be in the [range 0-255 and anything greater than 255 is mod 256](http://www.tldp.org/LDP/abs/html/exitcodes.html).  I verified this with a simple console c# app.  In this case, the value for ExitCodeBadCommandLineParameter mod 256 == 0.  Hmmm.\r\n\r\nAlthough a breaking change, I think we should conform to [libc standards](https://opensource.apple.com/source/Libc/Libc-320/include/sysexits.h) which means this error code should be 64 \"command line usage error\".  We should also update all the other error codes that powershell console returns.\r\n\r\nIn general, I don't think this should be a problem as typically 0 means success and non-0 means error so although a breaking change, I suspect it have limited real world impact.\r\n\r\ncc @PowerShell/powershell-committee ",
      "created_at": "2017-08-16T13:58:58Z",
      "updated_at": "2017-08-16T13:58:58Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@lzybkr are you referring to -WindowStyle and everything else as two commits?",
      "created_at": "2017-08-16T21:36:30Z",
      "updated_at": "2017-08-16T21:36:30Z"
    },
    {
      "author": "lzybkr",
      "author_association": "MEMBER",
      "body": "Yeah, `-WindowStyle` is buried at the bottom of your PR description, so it felt like it's own thing.",
      "created_at": "2017-08-16T21:38:10Z",
      "updated_at": "2017-08-16T21:38:10Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@lzybkr sure, I can make that two commits in the same PR.",
      "created_at": "2017-08-16T21:38:42Z",
      "updated_at": "2017-08-16T21:38:42Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "Split into 3 commits (Thanks @lzybkr for the tip on `git add -p`!)",
      "created_at": "2017-08-16T22:07:52Z",
      "updated_at": "2017-08-16T22:07:52Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@PowerShell/powershell-committee reviewed this and is ok with changing the exit codes",
      "created_at": "2017-08-16T22:09:38Z",
      "updated_at": "2017-08-16T22:09:38Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "@iSazonov, @lzybkr  and @SteveL-MSFT  thanks as always!",
      "created_at": "2017-08-17T16:00:03Z",
      "updated_at": "2017-08-17T16:00:32Z"
    }
  ],
  "created_at": "2017-08-14T23:04:17Z",
  "number": 4573,
  "state": "closed",
  "title": "Make error message consistent when invalid script is passed to -File, better error when passed ambiguous arg",
  "updated_at": "2017-08-24T03:02:22Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/11195",
  "author": "diering5",
  "body": "# Support Question\r\nI am writing a powershell script which reads in a json file, I manipulate it, and then I write it back to a json file. The problem is that when I write the values to a file the html characters are not escaped. For example, the character \">\" is getting written as \"\\u003e\". \r\n\r\nWhen converting to json I tried using this in my code:\r\n`$jsonOut = $navJson | ConvertTo-Json -Depth 50 -EscapeHandling EscapeHtml`\r\n\r\nHowever, I keep receiving the error:\r\n`A parameter cannot be found that matches parameter name 'EscapeHandling'`\r\n\r\nThis is very confusing because it is clearly a parameter based on the Microsoft docs:\r\nhttps://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/convertto-json?view=powershell-6\r\n\r\n## Official support\r\n\r\n[PowerShell Support Lifecycle](https://aka.ms/pslifecycle)\r\n\r\n## Community Resources\r\n\r\n[Slack][powershell-slack] and [Discord][powershell-discord] Community Chat - Interactive chat with other PowerShell enthusiasts. Both Slack and Discord are bridged via a bot and can seamlessly talk to each other.\r\n\r\n[StackOverflow.com](https://stackoverflow.com/questions/tagged/powershell) and [PowerShell.org Forum](https://powershell.org/forums/) - Search or post new general PowerShell usage questions\r\n\r\n[powershell-slack]: https://join.slack.com/t/powershell/shared_invite/enQtMzA3MDcxNTM5MTkxLTBmMWIyNzhkYzVjNGRiOTgxZmFlN2E0ZmVmOWU5NDczNTY2NDFhZjFlZTM1MTZiMWIzZDcwMGYzNjQ3YTRkNWM\r\n[powershell-discord]: https://discordapp.com/invite/AtzXnJM\r\n",
  "closed_at": "2019-11-27T12:00:23Z",
  "comments": [
    {
      "author": "he852100",
      "author_association": "NONE",
      "body": "You need to provide json data.",
      "created_at": "2019-11-26T02:54:30Z",
      "updated_at": "2019-11-26T02:54:30Z"
    },
    {
      "author": "diering5",
      "author_association": "NONE",
      "body": "Here is a sample of the json data. Sorry I couldn't get the indentation to copy over. I'm not sure why that would affect the parameter for the function though:\r\n{\r\n    \"shortcuts\": [\r\n        {\r\n            \"title\": \"stuff & things\",\r\n            \"things\": [\r\n                {\r\n                    \"items\": [\r\n                        {\r\n                            \"heading\": \"Home\"\r\n                        },\r\n                        {\r\n                            \"url\": \"/home/ethics/\",\r\n                            \"text\": \"Ethics\"\r\n                        },\r\n                        {\r\n                            \"url\": \"/home/fax/\",\r\n                            \"text\": \"Fax\"\r\n                        },\r\n                        {\r\n                            \"url\": \"/who/ips.htm\",\r\n                            \"text\": \"IPS Menu\"\r\n                        },\r\n                        {\r\n                            \"url\": \"/regulator/\",\r\n                            \"text\": \"Regulator\"\r\n                        },\r\n                        {\r\n                            \"url\": \"/who/\",\r\n                            \"text\": \"Who\"\r\n                        }\r\n                    ]\r\n                },\r\n                {\r\n                    \"items\": [\r\n                        {\r\n                            \"heading\": \"Business Supplies\"\r\n                        },\r\n                        {\r\n                            \"url\": \"/sc/login.aspx\",\r\n                            \"text\": \"TechStor\",\r\n                            \"helptext\": \"computer, printers & accessories\"\r\n                        },\r\n                        {\r\n                            \"url\": \"/supplies/index.htm\",\r\n                            \"text\": \"Office Supplies\",\r\n                            \"helptext\": \"office supplies\"\r\n                        }\r\n                    ]\r\n                }\r\n            ]\r\n        },\r\n        {\r\n            \"title\": \"Internet Sites\",\r\n            \"columns\": [\r\n                {\r\n                    \"items\": [\r\n                        {\r\n                            \"heading\": \"Stock Market\"\r\n                        },\r\n                        {\r\n                            \"url\": \"http://www.marketwatch.com\",\r\n                            \"text\": \"CBS-MarketWatch\"\r\n                        },\r\n                        {\r\n                            \"url\": \"http://finance.google.com/finance\",\r\n                            \"text\": \"Google Finance\"\r\n                        },\r\n                        {\r\n                            \"url\": \"http://www.morningstar.com\",\r\n                            \"text\": \"Morningstar\"\r\n                        },\r\n                        {\r\n                            \"url\": \"http://finance.yahoo.com\",\r\n                            \"text\": \"Yahoo! Finance\"\r\n                        },\r\n                        {\r\n                            \"heading\": \"News\"\r\n                        },\r\n                        {\r\n                            \"url\": \"http://www.cnn.com\",\r\n                            \"text\": \"CNN\"\r\n                        },\r\n                        {\r\n                            \"url\": \"http://www.cbsnews.com/\",\r\n                            \"text\": \"CBS News\"\r\n                        },\r\n                        {\r\n                            \"url\": \"http://www.foxnews.com/ \",\r\n                            \"text\": \"Fox\"\r\n                        },\r\n                        {\r\n                            \"url\": \"http://www.npr.org/\",\r\n                            \"text\": \"National Public Radio\"\r\n                        },\r\n                        {\r\n                            \"url\": \"http://www.msnbc.com\",\r\n                            \"text\": \"MSNBC\"\r\n                        },\r\n                        {\r\n                            \"heading\": \"Maps\"\r\n                        },\r\n                        {\r\n                            \"url\": \"http://maps.google.com/maps\",\r\n                            \"text\": \"Google Maps\"\r\n                        },\r\n                        {\r\n                            \"url\": \"http://www.mapquest.com\",\r\n                            \"text\": \"Mapquest\"\r\n                        }\r\n                    ]\r\n                },\r\n                {\r\n                    \"items\": [\r\n                        {\r\n                            \"heading\": \"Social Media\"\r\n                        },\r\n                        {\r\n                            \"url\": \"http://www.facebook.com\",\r\n                            \"text\": \"Facebook\"\r\n                        },\r\n                        {\r\n                            \"url\": \"http://www.linkedin.com\",\r\n                            \"text\": \"LinkedIn\"\r\n                        },\r\n                        {\r\n                            \"url\": \"https://twitter.com\",\r\n                            \"text\": \"Twitter @nmbradford\"\r\n                        },\r\n                        {\r\n                            \"url\": \"https://twitter.com\",\r\n                            \"text\": \"Twitter @NM\"\r\n                        },\r\n                        {\r\n                            \"url\": \"http://www.youtube.com/\",\r\n                            \"text\": \"YouTube\"\r\n                        },\r\n                        {\r\n                            \"heading\": \"Web\"\r\n                        },\r\n                        {\r\n                            \"url\": \"http://www.bing.com\",\r\n                            \"text\": \"Bing\"\r\n                        },\r\n                        {\r\n                            \"url\": \"http://www.google.com\",\r\n                            \"text\": \"Google\"\r\n                        },\r\n                        {\r\n                            \"url\": \"http://www.yahoo.com\",\r\n                            \"text\": \"Yahoo!\"\r\n                        }\r\n                    ]\r\n                }\r\n            ]\r\n        },\r\n        {\r\n            \"title\": \"Communities\",\r\n            \"columns\": [\r\n                {\r\n                    \"items\": [\r\n                        {\r\n                            \"url\": \"/ccp/Pages/default.aspx\",\r\n                            \"text\": \"CCP <em>Childhood Cancer Program</em>\"\r\n                        }\r\n                    ]\r\n                }\r\n            ]\r\n        }\r\n    ],\r\n    \"nav\": [\r\n        {\r\n            \"title\": \"Client Service\",\r\n            \"folder\": \"/client_svc/\",\r\n            \"option\": [\r\n                {\r\n                    \"url\": \"/resources/\",\r\n                    \"text\": \"Resources\"\r\n                },\r\n                {\r\n                    \"url\": \"/insurance/\",\r\n                    \"text\": \"Insurance\"\r\n                },\r\n                {\r\n                    \"url\": \"/annuities/\",\r\n                    \"text\": \"Annuities\"\r\n                },\r\n                {\r\n                    \"url\": \"/crc/\",\r\n                    \"text\": \"CRC <em>Client Relations Center</em>\"\r\n                }\r\n            ]\r\n        },\r\n        {\r\n            \"title\": \"Running<br>the Business\",\r\n            \"folder\": \"/run_bus/\",\r\n            \"option\": [\r\n                {\r\n                    \"url\": \"/mgmnt/\",\r\n                    \"text\": \"Management\"\r\n                },\r\n                {\r\n                    \"url\": \"/plan/\",\r\n                    \"text\": \"Planning\"\r\n                },\r\n                {\r\n                    \"url\": \"/compl/\",\r\n                    \"text\": \"Compliance\"\r\n                },\r\n                {\r\n                    \"url\": \"/technology/\",\r\n                    \"text\": \"Technology\"\r\n                },\r\n\t\t{\r\n                    \"url\": \"/sbs/\",\r\n                    \"text\": \"Services\"\r\n                },\r\n                {\r\n                    \"url\": \"/supplies/\",\r\n                    \"text\": \"Supplies\"\r\n                },\r\n                {\r\n                    \"url\": \"/recruiting/\",\r\n                    \"text\": \"Recruiting\"\r\n                },\r\n                {\r\n                    \"url\": \"/staffing\",\r\n                    \"text\": \"Staffing\"\r\n                },\r\n                {\r\n                    \"url\": \"/diversity/\",\r\n                    \"text\": \"Diversity\"\r\n                }\r\n            ]\r\n        },\r\n        {\r\n            \"title\": \"Financial\",\r\n            \"folder\": \"/fin/\",\r\n            \"option\": [\r\n                {\r\n                    \"url\": \"/comp/\",\r\n                    \"text\": \"Compensation\"\r\n                },\r\n                {\r\n                    \"url\": \"/benefits/\",\r\n                    \"text\": \"Benefits\"\r\n                },\r\n                {\r\n                    \"url\": \"/sales/\",\r\n                    \"text\": \"Sales\"\r\n                },\r\n                {\r\n                    \"url\": \"/account/\",\r\n                    \"text\": \"Accounting\"\r\n                }\r\n            ]\r\n        },\r\n        {\r\n            \"title\": \"News\",\r\n            \"folder\": \"/news/\",\r\n            \"option\": [\r\n                {\r\n                    \"url\": \"/news/\",\r\n                    \"text\": \"News\"\r\n                },\r\n                {\r\n                    \"url\": \"/newsletters/\",\r\n                    \"text\": \"Newsletters\"\r\n                },\r\n                {\r\n                    \"url\": \"/info/\",\r\n                    \"text\": \"Information\"\r\n                },\r\n                {\r\n                    \"url\": \"/annual/\",\r\n                    \"text\": \"Annual\"\r\n                },\r\n                {\r\n                    \"url\": \"/regional/\",\r\n                    \"text\": \"Regional\"\r\n                },\r\n                {\r\n                    \"url\": \"/other/\",\r\n                    \"text\": \"Other\"\r\n                },\r\n                {\r\n                    \"url\": \"/stories/\",\r\n                    \"text\": \"Stories\"\r\n                }\r\n            ]\r\n        },\r\n        {\r\n            \"title\": \"Contacts\",\r\n            \"folder\": \"/contacts/\",\r\n            \"option\": [\r\n                {\r\n                    \"url\": \"/home/\",\r\n                    \"text\": \"Home\"\r\n                },\r\n                {\r\n                    \"url\": \"/field/\",\r\n                    \"text\": \"Field\"\r\n                },\r\n                {\r\n                    \"url\": \"/associations/\",\r\n                    \"text\": \"Associations\"\r\n                },\r\n                {\r\n                    \"url\": \"/change/\",\r\n                    \"text\": \"Changes\"\r\n                }\r\n            ]\r\n        }\r\n    ]\r\n}",
      "created_at": "2019-11-26T04:47:29Z",
      "updated_at": "2019-11-26T04:49:28Z"
    },
    {
      "author": "he852100",
      "author_association": "NONE",
      "body": "```powershell\r\nPS /root> cat ~/3                     \r\n{\"employees\":[\r\n  { \"first?~~\\uFF20\\uFF05\\u3010\\u3011\\uFF09Nam\":\"Anna\", \"lastName\":\"S?~~\\u2026-@\\uFF1B\\uFF09mith\" }\r\n]}\r\n\r\nPS /root> cat ~/3|ConvertFrom-Json                                \r\nemployees\r\n---------\r\n{@{first?~~\uff20\uff05\u3010\u3011\uff09Nam=Anna; lastName=S?~~\u2026-@\uff1b\uff09mith}}\r\n\r\nPS /root> cat ~/3|ConvertTo-Json\r\n[\r\n  \"{\\\"employees\\\":[\",\r\n  \"  { \\\"first?~~\\\\uFF20\\\\uFF05\\\\u3010\\\\u3011\\\\uFF09Nam\\\":\\\"Anna\\\", \\\"lastName\\\":\\\"S?~~\\\\u2026-@\\\\uFF1B\\\\uFF09mith\\\" }\",\r\n  \"]}\"\r\n]\r\nPS /root> cat ~/3|ConvertFrom-Json|Convertto-Json\r\n{\r\n  \"employees\": [\r\n    {\r\n      \"first?~~\uff20\uff05\u3010\u3011\uff09Nam\": \"Anna\",\"lastName\": \"S?~~\u2026-@\uff1b\uff09mith\"\r\n    }\r\n  ]  \r\n }\r\n```",
      "created_at": "2019-11-26T07:17:45Z",
      "updated_at": "2019-11-26T07:19:52Z"
    },
    {
      "author": "mklement0",
      "author_association": "CONTRIBUTOR",
      "body": "You're probably running _Windows PowerShell_, where `-EscapeHandling` isn't supported.\r\n\r\nPlease note that this repo is only for PowerShell _Core_ (now just called _PowerShell_), and not for general support questions (the template is meant to be information only, to direct you to the appropriate places for getting support).",
      "created_at": "2019-11-26T07:56:46Z",
      "updated_at": "2019-11-26T07:56:46Z"
    },
    {
      "author": "msftbot[bot]",
      "author_association": "NONE",
      "body": "This issue has been marked as answered and has not had any activity for **1 day**. It has been closed for housekeeping purposes.",
      "created_at": "2019-11-27T12:00:22Z",
      "updated_at": "2019-11-27T12:00:22Z"
    }
  ],
  "created_at": "2019-11-26T01:26:59Z",
  "labels": [
    "Issue-Question",
    "Resolution-Answered"
  ],
  "number": 11195,
  "state": "closed",
  "title": "Where is ConvertTo-Json -EscapeHandling EscapeHtml",
  "updated_at": "2019-11-27T12:00:23Z"
}
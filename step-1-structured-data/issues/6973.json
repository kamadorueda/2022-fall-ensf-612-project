{
  "_url": "https://github.com/PowerShell/PowerShell/issues/6973",
  "author": "alx9r",
  "body": "The error includes the message \r\n\r\n>The syntax is not supported by this runspace. This can occur if the runspace is in no-language mode.\r\n\r\nbut I'm not sure what syntax it's referring to.\r\n\r\nSteps to reproduce\r\n------------------\r\n\r\n```powershell\r\n$initialSessionState = [initialsessionstate]::Create()\r\n$rsp = [runspacefactory]::CreateRunspacePool($initialSessionState)\r\n$rsp.Open()\r\n$ps = [powershell]::Create().AddScript({1})\r\n$ps.RunspacePool = $rsp\r\n$ps.Invoke()\r\n```\r\n\r\nExpected behavior\r\n-----------------\r\n\r\n```none\r\n1\r\n```\r\n\r\nActual behavior\r\n---------------\r\n\r\n```none\r\nException calling \"Invoke\" with \"0\" argument(s): \"The syntax is not supported by\r\n this runspace. This can occur if the runspace is in no-language mode.\"\r\nAt C:\\users\\un1\\Desktop\\test5.ps1:6 char:1\r\n+ $ps.Invoke()\r\n+ ~~~~~~~~~~~~\r\n+ CategoryInfo          : NotSpecified: (:) [], MethodInvocationException\r\n+ FullyQualifiedErrorId : ParseException\r\n```\r\n\r\nEnvironment data\r\n----------------\r\n\r\n<!-- provide the output of $PSVersionTable -->\r\n\r\n```powershell\r\n> $PSVersionTable\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      6.1.0-preview.691\r\nPSEdition                      Core\r\nGitCommitId                    v6.1.0-preview.691\r\nOS                             Microsoft Windows 6.3.9600 \r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n",
  "closed_at": "2018-06-05T21:24:20Z",
  "comments": [
    {
      "author": "BrucePay",
      "author_association": "COLLABORATOR",
      "body": "The `Create()` method on `InitialSessionState` creates the configuration for a minimal, restricted runspace. From the docs\r\n> The variants of this method can create an InitialSessionState object that is empty, ...\r\n\r\nIf you inspect the object that's created, you can see that it's in [`NoLanguage` mode](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_language_modes?view=powershell-6) and has no commands:\r\n```powershell\r\nPSCore (1:321) >  $initialSessionState = [initialsessionstate]::Create()\r\nPSCore (1:322) >  $initialSessionState\r\n\r\nLanguageMode                  : NoLanguage\r\nTranscriptDirectory           :\r\nExecutionPolicy               : Restricted\r\nUseFullLanguageModeInDebugger : False\r\nThreadOptions                 : Default\r\nThrowOnRunspaceOpenError      : False\r\nAuthorizationManager          : Microsoft.PowerShell.PSAuthorizationManager\r\nModules                       : {}\r\nAssemblies                    : {}\r\nTypes                         : {}\r\nFormats                       : {}\r\nDisableFormatUpdates          : False\r\nProviders                     : {}\r\nCommands                      : {}\r\nVariables                     : {}\r\nEnvironmentVariables          : {}\r\nStartupScripts                : {}\r\n```\r\nIf you want a \"normal\" or default runspace, you should use the `CreateDefault()` method instead because it\r\n> Creates the default PowerShell one with default cmdlets, provider etc.\r\n\r\nLooking at what this method produces, you can see that the `LanguageMode` is `FullLanguage`:\r\n```powershell\r\nPSCore (1:323) >  $initialSessionState = [initialsessionstate]::CreateDefault()\r\nPSCore (1:324) >  $initialSessionState\r\n\r\nLanguageMode                  : FullLanguage\r\nTranscriptDirectory           :\r\nExecutionPolicy               : Restricted\r\nUseFullLanguageModeInDebugger : False\r\nThreadOptions                 : Default\r\nThrowOnRunspaceOpenError      : False\r\nAuthorizationManager          : Microsoft.PowerShell.PSAuthorizationManager\r\nModules                       : {}\r\nAssemblies                    : {Microsoft.PowerShell.Commands.Diagnostics, Version=6.1.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, ProcessorArchitecture=MSIL,\r\n                                Microsoft.PowerShell.ConsoleHost, Version=6.1.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, ProcessorArchitecture=MSIL,\r\n                                System.Management.Automation, Version=6.1.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, ProcessorArchitecture=MSIL,\r\n                                Microsoft.PowerShell.Security...}\r\nTypes                         : {C:\\Program Files\\PowerShell\\6-preview\\GetEvent.types.ps1xml, C:\\Program Files\\PowerShell\\6-preview\\types.ps1xml, C:\\Program\r\n                                Files\\PowerShell\\6-preview\\typesv3.ps1xml}\r\nFormats                       : {*, *, *, *...}\r\nDisableFormatUpdates          : False\r\nProviders                     : {Registry, Alias, Environment, FileSystem...}\r\nCommands                      : {*, *, prompt, TabExpansion2...}\r\nVariables                     : {$, ^, StackTrace, OutputEncoding...}\r\nEnvironmentVariables          : {}\r\nStartupScripts                : {}\r\n```\r\n",
      "created_at": "2018-06-02T04:34:25Z",
      "updated_at": "2018-06-02T04:34:25Z"
    },
    {
      "author": "alx9r",
      "author_association": "NONE",
      "body": "Thank you @BrucePay.  This is much clearer now.  \r\n\r\nIt looks like the statement\r\n\r\n> The variants of this method can create an InitialSessionState object that is empty, ...\r\n\r\nis present in [the msdn doc](https://msdn.microsoft.com/en-us/library/system.management.automation.runspaces.initialsessionstate_members(v=vs.85).aspx), but not the [docs doc](https://docs.microsoft.com/en-us/dotnet/api/system.management.automation.runspaces.initialsessionstate.create?view=pscore-6.0.0).",
      "created_at": "2018-06-05T21:24:20Z",
      "updated_at": "2018-06-05T21:24:20Z"
    }
  ],
  "created_at": "2018-06-02T01:27:09Z",
  "number": 6973,
  "state": "closed",
  "title": "Runspace using RunspacePool initialized with InitialSessionState causes ParseException",
  "updated_at": "2018-06-05T21:24:20Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/11192",
  "author": "ViperTG",
  "body": "<!--\r\n\r\nFor Windows PowerShell 5.1 issues, suggestions, or feature requests please use the following link instead:\r\nWindows PowerShell [UserVoice](https://windowsserver.uservoice.com/forums/301869-powershell)\r\n\r\nThis repository is **ONLY** for PowerShell Core 6 issues.\r\n\r\n- Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\r\n- Search the existing issues.\r\n- Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\r\n- Refer to the [known issues](https://docs.microsoft.com/powershell/scripting/whats-new/known-issues-ps6?view=powershell-6).\r\n\r\n-->\r\n\r\nIn **PowerShell 7.0.0-preview.6**\r\n\r\nI was testing some more with Out-GridView and the problems with the columns in #11182 and #11184 and I found these other chars that in some combinations causes Out-GridView to throw and exception. \r\nThe examples here are all valid property names and work fine with Format-Table or Format-List so they should also be working for Out-GridView.\r\n\r\nIt's almost as if it is trying to evaluate the property name or something.\r\n\r\nI tested multiple combinations of brackets and parenthesis to find what caused the different exceptions (Code is at the end).\r\n\r\n```none\r\nColumnName             Result  Exception\r\n----------             ------  ---------\r\nControl                Success\r\n[BalancedBraces]       Success\r\n[UnbalancedBraces      Failure Syntax error in PropertyPath 'Unmatched bracket '[UnbalancedBraces'.'.\r\nUnbalancedBraces]      Failure Syntax error in PropertyPath 'Syntax error in Binding.Path 'UnbalancedBraces' ... ']'.'.\r\nEmpty[]Brace           Failure Syntax error in PropertyPath 'Syntax error in Binding.Path 'Empty[]' ... 'Brace'.'.\r\nBalancedParenthesis()  Success \r\nUnbalanced(Parenthesis Failure Syntax error in PropertyPath 'Unmatched parenthesis 'Unbalanced(Parenthesis'.'.\r\nUnbalancedParent)hesis Failure Syntax error in PropertyPath 'Unmatched parenthesis 'UnbalancedParent)hesis'.'.\r\nThis)(Works            Success\r\nButThis][Fails         Failure Syntax error in PropertyPath 'Syntax error in Binding.Path 'ButThis' ... '][Fails'.'.\r\n```\r\n\r\n# Steps to reproduce\r\n\r\n```powershell\r\n[pscustomobject]@{\r\n    'Bracket[' = \"Some Data\"\r\n} | Out-GridView\r\n```\r\n\r\n```powershell\r\n[pscustomobject]@{\r\n    'Paren)thesis' = \"Some Data\"\r\n} | Out-GridView\r\n```\r\n# Expected behavior\r\n\r\nI expected the Out-GridView window to show the object with it's property name as column name and the property value in the column like Format-Table shows the following.\r\n\r\n```none\r\nBracket[\r\n--------\r\nSome Data\r\n```\r\n\r\n```none\r\nParen)thesis\r\n------------\r\nSome Data\r\n```\r\n\r\n# Actual behavior\r\n\r\n```none\r\nOut-GridView:\r\nLine |\r\n   3 | } | Out-GridView\r\n     |     ^ Syntax error in PropertyPath 'Unmatched bracket '['.'.\r\n```\r\n\r\n```none\r\nOut-GridView:\r\nLine |\r\n   3 | } | Out-GridView\r\n     |     ^ Syntax error in PropertyPath 'Unmatched parenthesis 'Paren)thesis'.'.\r\n```\r\nAlso the Out-GridView window pops up but in a loading state, but is otherwise responsive.\r\n\r\n![image](https://user-images.githubusercontent.com/26866146/69577923-b2c31e00-0fcf-11ea-921c-a09926ba8346.png)\r\n\r\n\r\n# Environment data\r\n\r\n<!-- provide the output of $PSVersionTable -->\r\n\r\n```none\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.0.0-preview.6\r\nPSEdition                      Core\r\nGitCommitId                    7.0.0-preview.6\r\nOS                             Microsoft Windows 10.0.18363\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n\r\n# Testing code for combinations\r\nI wrote this to see what different exceptions would be thrown\r\n\r\n```powershell\r\n$teststrings = @(\r\n'Control'\r\n'[BalancedBraces]'\r\n'[UnbalancedBraces'\r\n'UnbalancedBraces]'\r\n'Empty[]Brace'\r\n'BalancedParenthesis()'\r\n'Unbalanced(Parenthesis'\r\n'UnbalancedParent)hesis'\r\n'This)(Works'\r\n'ButThis][Fails'\r\n)\r\n\r\n$teststrings | ForEach-Object {\r\n    $obj = [pscustomobject]@{\r\n        $_ = \"Test\"\r\n        ColumnName = $_\r\n        Result = \"\"\r\n    }\r\n\r\n    try {\r\n        $obj | Out-GridView\r\n        $obj.Result = \"Success\"\r\n    } catch {\r\n        $obj.Result = \"Failure\"\r\n        $obj | Add-Member -NotePropertyMembers @{\r\n            Exception = $_\r\n        }\r\n    } finally {\r\n        $obj\r\n    }\r\n} | Select-Object -Property ColumnName,Result,Exception\r\n```\r\n",
  "closed_at": "2019-11-28T11:44:11Z",
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "The cmdlet was included in PowerShell 7.0 for backward compatibility only. No plans exist to improve something in the code. All new work will be in https://github.com/PowerShell/GraphicalTools\n\n<blockquote><img src=\"https://avatars0.githubusercontent.com/u/11524380?s=400&v=4\" width=\"48\" align=\"right\"><div><img src=\"https://github.githubassets.com/favicon.ico\" height=\"14\"> GitHub</div><div><strong><a href=\"https://github.com/PowerShell/GraphicalTools\">PowerShell/GraphicalTools</a></strong></div><div>A module that mixes PowerShell and GUIs! - built on Avalonia - PowerShell/GraphicalTools</div></blockquote>",
      "created_at": "2019-11-28T11:44:11Z",
      "updated_at": "2019-11-28T11:44:13Z"
    }
  ],
  "created_at": "2019-11-25T21:24:27Z",
  "number": 11192,
  "state": "closed",
  "title": "Out-GridView throw exception for objects with property names containing unbalanced brackets or parenthesis",
  "updated_at": "2019-11-28T11:49:34Z"
}
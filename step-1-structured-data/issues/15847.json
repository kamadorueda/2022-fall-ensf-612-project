{
  "_url": "https://github.com/PowerShell/PowerShell/issues/15847",
  "author": "dennisl68-castra",
  "body": "### Prerequisites\r\n\r\n- [X] Write a descriptive title.\r\n- [X] Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\r\n- [X] Search the existing issues.\r\n- [X] Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\r\n- [X] Refer to [Differences between Windows PowerShell 5.1 and PowerShell](https://docs.microsoft.com/powershell/scripting/whats-new/differences-from-windows-powershell).\r\n\r\n### Steps to reproduce\r\n\r\nWhen pasting a command to the console, hyphens is sometimes missing.\r\n\r\nPlease use the code below to generate a sample string for pasting into a PowerShell 7 console...\r\n\r\n```\r\n$step = [System.Convert]::FromBase64String(\r\n    'IyAxLiBUbyBkaXNwbGF5IGEgbGlzdCBvZiBzZXJ2aWNlcyB0aGF0IHNob3dzIH' +\r\n    'N0b3BwZWQgc2VydmljZXMgbGFzdCwgcnVuOgogICAgCkdldC1TZXJ2aWNlIHwg' +\r\n    'ClNvcnQgU3RhdHVzIOKAk0Rlc2NlbmRpbmc='\r\n)\r\n[System.Text.Encoding]::UTF8.GetString($step)\r\n```\r\n\r\n\r\n\r\n### Expected behavior\r\n\r\n```console\r\nGet-Service |\r\nSort Status \u2013Descending\r\n\r\n<Mark, Ctrl-C, Ctrl-V>\r\n\r\nGet-Service |\r\nSort Status \u2013Descending\r\n```\r\n\r\n\r\n### Actual behavior\r\n\r\n```console\r\nGet-Service |\r\nSort Status \u2013Descending\r\n\r\n<Mark, Ctrl-C, Ctrl-V>\r\n\r\nGet-Service |\r\nSort Status Descending\r\n```\r\n\r\n\r\n### Error details\r\n\r\n```console\r\nException             :\r\n    Type              : System.Management.Automation.ParameterBindingException\r\n    Message           : A positional parameter cannot be found that accepts argument 'Descending'.\r\n    ParameterName     : Descending\r\n    TypeSpecified     : string\r\n    ErrorId           : PositionalParameterNotFound\r\n    Line              : 2\r\n    Offset            : 1\r\n    CommandInvocation :\r\n        MyCommand        : Sort-Object\r\n        BoundParameters  :\r\n            BoundPositionally :\r\n                Length : 8\r\n            Comparer          : System.OrdinalIgnoreCaseComparer\r\n            Count             : 1\r\n            Keys              :\r\n                Length : 8\r\n            Values            :\r\n                Length      : 1\r\n                LongLength  : 1\r\n                Rank        : 1\r\n                SyncRoot    :\r\n                    Length : 6\r\n                IsFixedSize : True\r\n                Count       : 1\r\n            SyncRoot          :\r\n                BoundPositionally :\r\n                    Length : 8\r\n                Comparer          : System.OrdinalIgnoreCaseComparer\r\n                Count             : 1\r\n                Keys              :\r\n                    Length : 8\r\n                Values            :\r\n                    Length      : 1\r\n                    LongLength  : 1\r\n                    Rank        : 1\r\n                    SyncRoot    :\r\n                        Length : 6\r\n                    IsFixedSize : True\r\n                    Count       : 1\r\n                SyncRoot          :\r\n                    BoundPositionally :\r\n                        Length : 8\r\n                    Comparer          : System.OrdinalIgnoreCaseComparer\r\n                    Count             : 1\r\n                    Keys              :\r\n                        Length : 8\r\n                    Values            :\r\n                        Length      : 1\r\n                        LongLength  : 1\r\n                        Rank        : 1\r\n                        SyncRoot    :\r\n                            Length : 6\r\n                        IsFixedSize : True\r\n                        Count       : 1\r\n                    SyncRoot          :\r\n                        BoundPositionally :\r\n                            Length : 8\r\n                        Comparer          : System.OrdinalIgnoreCaseComparer\r\n                        Count             : 1\r\n                        Keys              :\r\n                            Length : 8\r\n                        Values            :\r\n                            Length      : 1\r\n                            LongLength  : 1\r\n                            Rank        : 1\r\n                            SyncRoot    :\r\n                                Length : 6\r\n                            IsFixedSize : True\r\n                            Count       : 1\r\n                        SyncRoot          :\r\n                            BoundPositionally :\r\n                                Length : 8\r\n                            Comparer          : System.OrdinalIgnoreCaseComparer\r\n                            Count             : 1\r\n                            Keys              :\r\n                                Length : 8\r\n                            Values            :\r\n                                Length      : 1\r\n                                LongLength  : 1\r\n                                Rank        : 1\r\n                                SyncRoot    :\r\n                                    Length : 6\r\n                                IsFixedSize : True\r\n                                Count       : 1\r\n                            SyncRoot          :\r\n                                BoundPositionally :\r\n                                    Length : 8\r\n                                Comparer          : System.OrdinalIgnoreCaseComparer\r\n                                Count             : 1\r\n                                Keys              :\r\n                                    Length : 8\r\n                                Values            :\r\n                                    Length      : 1\r\n                                    LongLength  : 1\r\n                                    Rank        : 1\r\n                                    SyncRoot    : \u2026\r\n                                    IsFixedSize : True\r\n                                    Count       : 1\r\n                                SyncRoot          :\r\n                                    BoundPositionally : \u2026\r\n                                    Comparer          : System.OrdinalIgnoreCaseComparer\r\n                                    Count             : 1\r\n                                    Keys              : \u2026\r\n                                    Values            : \u2026\r\n                                    SyncRoot          : \u2026\r\n        ScriptLineNumber : 2\r\n        OffsetInLine     : 1\r\n        HistoryId        : 3\r\n        Line             : Sort Status Descending\r\n        PositionMessage  : At line:2 char:1\r\n                           + Sort Status Descending\r\n                           + ~~~~~~~~~~~~~~~~~~~~~~\r\n        InvocationName   : Sort\r\n        PipelineLength   : 2\r\n        PipelinePosition : 2\r\n        ExpectingInput   : True\r\n    ErrorRecord       :\r\n        Exception             :\r\n            Type    : System.Management.Automation.ParentContainsErrorRecordException\r\n            Message : A positional parameter cannot be found that accepts argument 'Descending'.\r\n            HResult : -2146233087\r\n        CategoryInfo          : InvalidArgument: (:) [Sort-Object], ParentContainsErrorRecordException\r\n        FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell.Commands.SortObjectCommand\r\n        InvocationInfo        :\r\n            MyCommand        : Sort-Object\r\n            ScriptLineNumber : 2\r\n            OffsetInLine     : 1\r\n            HistoryId        : 3\r\n            Line             : Sort Status Descending\r\n            PositionMessage  : At line:2 char:1\r\n                               + Sort Status Descending\r\n                               + ~~~~~~~~~~~~~~~~~~~~~~\r\n            CommandOrigin    : Internal\r\n        ScriptStackTrace      : at <ScriptBlock>, <No file>: line 1\r\n    TargetSite        :\r\n        Name          : VerifyArgumentsProcessed\r\n        DeclaringType : System.Management.Automation.CmdletParameterBinderController, System.Management.Automation,\r\nVersion=7.1.3.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\r\n        MemberType    : Method\r\n        Module        : System.Management.Automation.dll\r\n    StackTrace        :\r\n   at System.Management.Automation.CmdletParameterBinderController.VerifyArgumentsProcessed(ParameterBindingException\r\noriginalBindingException)\r\n   at System.Management.Automation.CmdletParameterBinderController.BindCommandLineParametersNoValidation(Collection`1\r\narguments)\r\n   at System.Management.Automation.CmdletParameterBinderController.BindCommandLineParameters(Collection`1 arguments)\r\n   at System.Management.Automation.CommandProcessor.BindCommandLineParameters()\r\n   at System.Management.Automation.CommandProcessor.Prepare(IDictionary psDefaultParameterValues)\r\n   at System.Management.Automation.CommandProcessorBase.DoPrepare(IDictionary psDefaultParameterValues)\r\n   at System.Management.Automation.Internal.PipelineProcessor.Start(Boolean incomingStream)\r\n   at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)\r\n--- End of stack trace from previous location ---\r\n   at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)\r\n   at System.Management.Automation.PipelineOps.InvokePipeline(Object input, Boolean ignoreInput,\r\nCommandParameterInternal[][] pipeElements, CommandBaseAst[] pipeElementAsts, CommandRedirection[][]\r\ncommandRedirections, FunctionContext funcContext)\r\n   at System.Management.Automation.Interpreter.ActionCallInstruction`6.Run(InterpretedFrame frame)\r\n   at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame)\r\n    Data              : System.Collections.ListDictionaryInternal\r\n    Source            : System.Management.Automation\r\n    HResult           : -2146233087\r\nCategoryInfo          : InvalidArgument: (:) [Sort-Object], ParameterBindingException\r\nFullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell.Commands.SortObjectCommand\r\nInvocationInfo        :\r\n    MyCommand        : Sort-Object\r\n    ScriptLineNumber : 2\r\n    OffsetInLine     : 1\r\n    HistoryId        : 3\r\n    Line             : Sort Status Descending\r\n    PositionMessage  : At line:2 char:1\r\n                       + Sort Status Descending\r\n                       + ~~~~~~~~~~~~~~~~~~~~~~\r\n    CommandOrigin    : Internal\r\nScriptStackTrace      : at <ScriptBlock>, <No file>: line 1\r\n```\r\n\r\n\r\n### Environment data\r\n\r\n```powershell\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.1.3\r\nPSEdition                      Core\r\nGitCommitId                    7.1.3\r\nOS                             Microsoft Windows 10.0.17763\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n\r\n\r\n### Visuals\r\n\r\n![image](https://user-images.githubusercontent.com/49750419/127619575-169f93d6-507c-4f70-ba4d-b9567577fd5e.png)\r\n",
  "closed_at": "2021-08-01T13:00:37Z",
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Does the issue exists if PSReadline module unloaded?",
      "created_at": "2021-07-30T15:30:53Z",
      "updated_at": "2021-07-30T15:30:53Z"
    },
    {
      "author": "dennisl68-castra",
      "author_association": "NONE",
      "body": "If I remove PSReadline using \r\n`Remove-Module PSReadLine`\r\nthe issue goes away.\r\n\r\n![image](https://user-images.githubusercontent.com/49750419/127680280-aa456ac7-4c53-4af7-b8e8-a5b48edd8790.png)\r\n",
      "created_at": "2021-07-30T16:00:15Z",
      "updated_at": "2021-07-30T16:02:14Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "I suggest you update to latest PSReadline (preview) and report this issue to PSReadline repository if the issue will still persist.",
      "created_at": "2021-07-30T16:21:05Z",
      "updated_at": "2021-07-30T16:21:05Z"
    },
    {
      "author": "dennisl68-castra",
      "author_association": "NONE",
      "body": "Tried updating to latest available on PSGallery (2.2.0, beta3) using\r\n`Install-Module psreadline -AllowClobber -AllowPrerelease -Scope AllUsers -Force`\r\nThe console still misses out on hyphens with PSReadline present.\r\n\r\nI will report an issue in the PSReadline repo...\r\n\r\nEdit: Even tried the correct way of updating PSReadline now, using cmd.exe as admin instead\r\n`\"C:\\Program Files\\PowerShell\\7\\pwsh.exe\" -noprofile -command \"Install-Module PSReadLine -Force -SkipPublisherCheck -AllowPrerelease\"`\r\n(Why is `-Scope AllUsers` missing in the recomended setup instruction?)",
      "created_at": "2021-07-30T17:17:05Z",
      "updated_at": "2021-07-30T17:26:09Z"
    },
    {
      "author": "dennisl68-castra",
      "author_association": "NONE",
      "body": "Ok, removed all versions of PSReadLine from my system except the one that came with WindowsPowerShell 5.1 (2.0.0, beta 2) and now I can work again :)\r\n\r\nI did try installing the \"stable\" version of 2.0.0 and that has the same issue :/",
      "created_at": "2021-07-30T18:26:36Z",
      "updated_at": "2021-07-30T18:27:11Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Please share your investigations in PSReadline repo.",
      "created_at": "2021-07-31T12:13:16Z",
      "updated_at": "2021-07-31T12:13:16Z"
    },
    {
      "author": "dennisl68-castra",
      "author_association": "NONE",
      "body": "Yes, did that yesterday. \n\nNo response as of yet. \n\n[PSReadline #2175](https://github.com/PowerShell/PSReadLine/issues/2715)",
      "created_at": "2021-07-31T12:26:33Z",
      "updated_at": "2021-07-31T12:27:03Z"
    },
    {
      "author": "msftbot[bot]",
      "author_association": "NONE",
      "body": "This issue has been marked as external and has not had any activity for **1 day**. It has been be closed for housekeeping purposes.",
      "created_at": "2021-08-01T13:00:36Z",
      "updated_at": "2021-08-01T13:00:36Z"
    }
  ],
  "created_at": "2021-07-30T07:49:33Z",
  "labels": [
    "WG-Interactive-PSReadLine",
    "Resolution-External",
    "Needs-Triage"
  ],
  "number": 15847,
  "state": "closed",
  "title": "Pasting from clipboard to PWSH console sometimes omits hyphen",
  "updated_at": "2021-08-01T13:00:37Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/18531",
  "author": "brogers5",
  "body": "### Prerequisites\r\n\r\n- [X] Write a descriptive title.\r\n- [X] Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\r\n- [X] Search the existing issues.\r\n- [X] Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\r\n- [X] Refer to [Differences between Windows PowerShell 5.1 and PowerShell](https://docs.microsoft.com/powershell/scripting/whats-new/differences-from-windows-powershell).\r\n\r\n### Steps to reproduce\r\n\r\n```ps1\r\nInvoke-WebRequest -Uri 'https://www.foxit.com/downloads/latest.html?product=Foxit-Reader&platform=Windows&version=&package_type=exe&language=German' -Method Head\r\n```\r\n\r\n### Expected behavior\r\n\r\n`Invoke-WebRequest` succeeds without issues.\r\n\r\nI cannot reproduce this behavior with v7.2.7.\r\n\r\n### Actual behavior\r\n\r\n`Invoke-WebRequest` fails. The provided URI is claimed to be invalid, since the hostname is not parsed correctly.\r\n\r\n### Error details\r\n\r\n```console\r\nException             : \r\n    Type       : System.UriFormatException\r\n    TargetSite : \r\n        Name          : CreateThis\r\n        DeclaringType : uri\r\n        MemberType    : Method\r\n        Module        : System.Private.Uri.dll\r\n    Message    : Invalid URI: The hostname could not be parsed.\r\n    Source     : System.Private.Uri\r\n    HResult    : -2146233033\r\n    StackTrace : \r\n   at System.Uri.CreateThis(String uri, Boolean dontEscape, UriKind uriKind, UriCreationOptions& creationOptions)\r\n   at System.Uri.CreateUri(Uri baseUri, String relativeUri, Boolean dontEscape)\r\n   at Microsoft.PowerShell.Commands.WebRequestPSCmdlet.ParseLinkHeader(HttpResponseMessage response, Uri requestUri)\r\n   at Microsoft.PowerShell.Commands.WebRequestPSCmdlet.ProcessRecord()\r\n   at System.Management.Automation.CommandProcessor.ProcessRecord()\r\nCategoryInfo          : NotSpecified: (:) [Invoke-WebRequest], UriFormatException\r\nFullyQualifiedErrorId : System.UriFormatException,Microsoft.PowerShell.Commands.InvokeWebRequestCommand\r\nInvocationInfo        : \r\n    MyCommand        : Invoke-WebRequest\r\n    ScriptLineNumber : 1\r\n    OffsetInLine     : 1\r\n    HistoryId        : 5\r\n    Line             : Invoke-WebRequest -Uri 'https://www.foxit.com/downloads/latest.html?product=Foxit-Reader&platform=Windows&version=&package_type=exe&language=German' -Method Head\r\n    PositionMessage  : At line:1 char:1\r\n                       + Invoke-WebRequest -Uri 'https://www.foxit.com/downloads/latest.html?p \u2026\r\n                       + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    InvocationName   : Invoke-WebRequest\r\n    CommandOrigin    : Internal\r\nScriptStackTrace      : at <ScriptBlock>, <No file>: line 1\r\n```\r\n\r\n\r\n### Environment data\r\n\r\n```powershell\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.3.0\r\nPSEdition                      Core\r\nGitCommitId                    7.3.0\r\nOS                             Microsoft Windows 10.0.22621\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n\r\n\r\n### Visuals\r\n\r\n_No response_",
  "closed_at": null,
  "comments": [],
  "created_at": "2022-11-11T04:47:56Z",
  "labels": [
    "WG-Cmdlets-Utility",
    "Needs-Triage"
  ],
  "number": 18531,
  "state": "open",
  "title": "Invoke-WebRequest: Head request failing after update to v7.3.0",
  "updated_at": "2022-11-11T10:48:21Z"
}
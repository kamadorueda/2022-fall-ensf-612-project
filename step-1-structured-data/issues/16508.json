{
  "_url": "https://github.com/PowerShell/PowerShell/issues/16508",
  "author": "splatteredbits",
  "body": "### Prerequisites\r\n\r\n- [X] Write a descriptive title.\r\n- [X] Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\r\n- [X] Search the existing issues. (This is a duplicate of #2216, which is several years old, which I didn't think would be watched, so entering a new issue.)\r\n- [X] Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\r\n- [X] Refer to [Differences between Windows PowerShell 5.1 and PowerShell](https://docs.microsoft.com/powershell/scripting/whats-new/differences-from-windows-powershell).\r\n\r\n### Steps to reproduce\r\n\r\nThe `Test-ModuleManifest` cmdlet doesn't return an updated manifest if the .psd1 file gets updated. Here's a Pester 5 test case that reproduces the issue. I've reproduced on Windows PowerShell 5.1 and PowerShell 7.2.0. \r\n\r\n```powershell\r\n\r\nImport-Module -Name 'Pester' -MinimumVersion '5.0'\r\n\r\nDescribe 'Test-ModuleManifest.when manifest changes' {\r\n    It 'should reload manifest' {\r\n        $testRoot = $TestDrive\r\n        $psm1Path = Join-Path -Path $TestDrive -ChildPath 'MyModule.psm1'\r\n        New-Item -Path $psm1Path -ItemType 'File'\r\n        \r\n        $psd1Path = Join-Path -Path $TestDrive -ChildPath 'MyModule.psd1'\r\n        @\"\r\n@{\r\n    RootModule = 'MyModule.psm1';\r\n    Description = 'MyModule';\r\n    Author = 'ajensen';\r\n    ModuleVersion = '1.2.3';\r\n    PrivateData = @{\r\n        PSData = @{\r\n            Prerelease = '';\r\n        }\r\n    }\r\n}\r\n\"@ | Set-Content -Path $psd1Path\r\n        \r\n        $manifest = Test-ModuleManifest -Path $psd1Path\r\n        $manifest.PrivateData['PSData']['Prerelease'] | Should -BeNullOrEmpty\r\n        \r\n        @\"\r\n@{\r\n    RootModule = 'MyModule.psm1';\r\n    Description = 'MyModule';\r\n    Author = 'ajensen';\r\n    ModuleVersion = '1.2.3';\r\n    PrivateData = @{\r\n        PSData = @{\r\n            Prerelease = 'beta1';\r\n        }\r\n    }\r\n}\r\n\"@ | Set-Content -Path $psd1Path\r\n        $manifest = Test-ModuleManifest -Path $psd1Path\r\n        $manifest.PrivateData['PSData']['Prerelease'] | Should -Be 'beta1'\r\n    }\r\n}\r\n```\r\n\r\n### Expected behavior\r\n\r\n```console\r\nI expect `Test-ModuleManifest` to not cache the results of previous calls, or if it does, update its cache if the .psd1 file changes.\r\n```\r\n\r\n\r\n### Actual behavior\r\n\r\n```console\r\n`Test-ModuleManifest` returns the result of the last call no matter what changes you make to a module's .psd1 file.\r\n```\r\n\r\n\r\n### Error details\r\n\r\n_No response_\r\n\r\n### Environment data\r\n\r\n```powershell\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.2.0\r\nPSEdition                      Core\r\nGitCommitId                    7.2.0\r\nOS                             Microsoft Windows 10.0.19043\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n\r\n\r\n### Visuals\r\n\r\n_No response_",
  "closed_at": null,
  "comments": [],
  "created_at": "2021-11-23T20:22:11Z",
  "number": 16508,
  "state": "open",
  "title": "Test-ModuleManifest doesn't return different manifest after .psd1 file is updated",
  "updated_at": "2021-11-24T03:37:54Z"
}
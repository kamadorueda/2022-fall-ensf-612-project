{
  "_url": "https://github.com/PowerShell/PowerShell/issues/16826",
  "author": "SeeminglyScience",
  "body": "### Prerequisites\n\n- [X] Write a descriptive title.\n- [X] Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\n- [X] Search the existing issues.\n- [X] Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\n- [X] Refer to [Differences between Windows PowerShell 5.1 and PowerShell](https://docs.microsoft.com/powershell/scripting/whats-new/differences-from-windows-powershell).\n\n### Steps to reproduce\n\n```powershell\r\n$function:ProxyGci = [scriptblock]::Create(\r\n    [Management.Automation.ProxyCommand]::Create(\r\n        (Get-Command Get-ChildItem)))\r\n\r\nProxyGci -Attributes\r\n```\n\n### Expected behavior\n\n```console\nProxyGci: Missing an argument for parameter 'Attributes'. Specify a parameter of type 'System.Management.Automation.FlagsExpression`1[System.IO.FileAttributes]' and try again.\n```\n\n\n### Actual behavior\n\n```console\nInvalidOperation:\r\nLine |\r\n 101 |      $steppablePipeline.Clean()\r\n     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n     | You cannot call a method on a null-valued expression.\r\nProxyGci: Missing an argument for parameter 'Attributes'. Specify a parameter of type 'System.Management.Automation.FlagsExpression`1[System.IO.FileAttributes]' and try again.\n```\n\n\n### Error details\n\n```console\nException             : \r\n    Type              : System.Management.Automation.ParameterBindingException\r\n    Message           : Missing an argument for parameter 'Attributes'. Specify a parameter of type 'System.Management.Automation.FlagsExpression`1[System.IO.FileAttributes]' and try again.\r\n    ParameterName     : Attributes\r\n    ParameterType     : System.Management.Automation.FlagsExpression[System.IO.FileAttributes]\r\n    ErrorId           : MissingArgument\r\n    Line              : 1\r\n    Offset            : 10\r\n    CommandInvocation : \r\n        MyCommand        : ProxyGci\r\n        ScriptLineNumber : 1\r\n        OffsetInLine     : 1\r\n        HistoryId        : 4\r\n        Line             : proxygci -Attributes\r\n        PositionMessage  : At line:1 char:1\r\n                           + proxygci -Attributes\r\n                           + ~~~~~~~~~~~~~~~~~~~~\r\n        InvocationName   : proxygci\r\n        PipelineLength   : 1\r\n        PipelinePosition : 1\r\n    ErrorRecord       : \r\n        Exception             : \r\n            Type    : System.Management.Automation.ParentContainsErrorRecordException\r\n            Message : Missing an argument for parameter 'Attributes'. Specify a parameter of type 'System.Management.Automation.FlagsExpression`1[System.IO.FileAttributes]' and try again.\r\n            HResult : -2146233087\r\n        CategoryInfo          : InvalidArgument: (:) [ProxyGci], ParentContainsErrorRecordException\r\n        FullyQualifiedErrorId : MissingArgument,ProxyGci\r\n        InvocationInfo        : \r\n            MyCommand        : ProxyGci\r\n            ScriptLineNumber : 1\r\n            OffsetInLine     : 10\r\n            HistoryId        : 4\r\n            Line             : proxygci -Attributes\r\n            PositionMessage  : At line:1 char:10\r\n                               + proxygci -Attributes\r\n                               +          ~~~~~~~~~~~\r\n            CommandOrigin    : Internal\r\n        ScriptStackTrace      : at <ScriptBlock>, <No file>: line 1\r\n    TargetSite        : \r\n        Name          : ReparseUnboundArguments\r\n        DeclaringType : System.Management.Automation.ParameterBinderController, System.Management.Automation, Version=7.3.0.1, Culture=neutral, PublicKeyToken=31bf3856ad364e35\r\n        MemberType    : Method\r\n        Module        : System.Management.Automation.dll\r\n    Data              : System.Collections.ListDictionaryInternal\r\n    Source            : System.Management.Automation\r\n    HResult           : -2146233087\r\n    StackTrace        : \r\n   at System.Management.Automation.ParameterBinderController.ReparseUnboundArguments()\r\n   at System.Management.Automation.CmdletParameterBinderController.HandleCommandLineDynamicParameters(ParameterBindingException& outgoingBindingException)\r\n   at System.Management.Automation.CmdletParameterBinderController.BindCommandLineParametersNoValidation(Collection`1 arguments)\r\n   at System.Management.Automation.CmdletParameterBinderController.BindCommandLineParameters(Collection`1 arguments)\r\n   at System.Management.Automation.CommandProcessor.BindCommandLineParameters()\r\n   at System.Management.Automation.CommandProcessor.Prepare(IDictionary psDefaultParameterValues)\r\n   at System.Management.Automation.CommandProcessorBase.DoPrepare(IDictionary psDefaultParameterValues)\r\n   at System.Management.Automation.Internal.PipelineProcessor.Start(Boolean incomingStream)\r\n   at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)\r\n--- End of stack trace from previous location ---\r\n   at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)\r\n   at System.Management.Automation.PipelineOps.InvokePipeline(Object input, Boolean ignoreInput, CommandParameterInternal[][] pipeElements, CommandBaseAst[] pipeElementAsts, CommandRedirection[][] commandRedirections, FunctionContext funcContext)\r\n   at System.Management.Automation.Interpreter.ActionCallInstruction`6.Run(InterpretedFrame frame)\r\n   at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame)\r\nCategoryInfo          : InvalidArgument: (:) [ProxyGci], ParameterBindingException\r\nFullyQualifiedErrorId : MissingArgument,ProxyGci\r\nInvocationInfo        : \r\n    MyCommand        : ProxyGci\r\n    ScriptLineNumber : 1\r\n    OffsetInLine     : 10\r\n    HistoryId        : 4\r\n    Line             : proxygci -Attributes\r\n    PositionMessage  : At line:1 char:10\r\n                       + proxygci -Attributes\r\n                       +          ~~~~~~~~~~~\r\n    CommandOrigin    : Internal\r\nScriptStackTrace      : at <ScriptBlock>, <No file>: line 1\n```\n\n\n### Environment data\n\n```powershell\nName                           Value\r\n----                           -----\r\nPSVersion                      7.3.0-preview.1\r\nPSEdition                      Core\r\nGitCommitId                    7.3.0-preview.1\r\nOS                             Microsoft Windows 10.0.18363\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\n```\n\n\n### Visuals\n\n_No response_",
  "closed_at": "2022-02-03T19:39:08Z",
  "comments": [
    {
      "author": "msftbot[bot]",
      "author_association": "NONE",
      "body": ":tada:This issue was addressed in #16827, which has now been successfully released as `v7.3.0-preview.2`.:tada:\n\nHandy links:\n* [Release Notes](https://github.com/PowerShell/PowerShell/releases/tag/v7.3.0-preview.2)\n",
      "created_at": "2022-02-24T23:34:22Z",
      "updated_at": "2022-02-24T23:34:22Z"
    }
  ],
  "created_at": "2022-02-01T20:05:46Z",
  "number": 16826,
  "state": "closed",
  "title": "Proxy command should only invoke `$steppablePipeline.Clean()` when the variable is defined",
  "updated_at": "2022-02-24T23:34:22Z"
}
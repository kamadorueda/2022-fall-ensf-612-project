{
  "_url": "https://github.com/PowerShell/PowerShell/issues/17863",
  "author": "penalvch-zz",
  "body": "### Prerequisites\n\n- [X] Write a descriptive title.\n- [X] Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\n- [X] Search the existing issues.\n- [X] Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\n- [X] Refer to [Differences between Windows PowerShell 5.1 and PowerShell](https://docs.microsoft.com/powershell/scripting/whats-new/differences-from-windows-powershell).\n\n### Steps to reproduce\n\nI am experiencing a problem with the following commands on Windows 11 for ARM Insider Preview. It is not reproducible with Windows PowerShell built-in (i.e. PowerShell 7.2.5 bug):\r\n\r\nGet-AppxProvisionedPackage -Online | Where-Object {$_.DisplayName -eq 'Microsoft.BingNews'} |Remove-AppxProvisionedPackage -online\r\nRemove-AppxProvisionedPackage: Access is denied.\r\n\r\nGet-AppxProvisionedPackage -Online | Where-Object {$_.DisplayName -eq 'Microsoft.BingWeather'} |Remove-AppxProvisionedPackage -online\r\nRemove-AppxProvisionedPackage: Access is denied.\r\n\r\nGet-AppxProvisionedPackage -Online | Where-Object {$_.DisplayName -eq 'Microsoft.GetHelp'} |Remove-AppxProvisionedPackage -online\r\nRemove-AppxProvisionedPackage: Access is denied.\r\n\r\nGet-AppxProvisionedPackage -Online | Where-Object {$_.DisplayName -eq 'Microsoft.MicrosoftStickyNotes'} |Remove-AppxProvisionedPackage -online\r\nRemove-AppxProvisionedPackage: Access is denied.\r\n\r\nGet-AppxProvisionedPackage -Online | Where-Object {$_.DisplayName -eq 'Microsoft.WindowsCamera'} |Remove-AppxProvisionedPackage -online\r\nRemove-AppxProvisionedPackage: Access is denied.\r\n\r\nGet-AppxProvisionedPackage -Online | Where-Object {$_.DisplayName -eq 'Microsoft.Windows.Photos'} |Remove-AppxProvisionedPackage -online\r\nRemove-AppxProvisionedPackage: Access is denied.\r\n\r\nGet-AppxProvisionedPackage -Online | Where-Object {$_.DisplayName -eq 'Microsoft.WindowsCalculator'} |Remove-AppxProvisionedPackage -online\r\nRemove-AppxProvisionedPackage: Access is denied.\r\n\r\nGet-AppxProvisionedPackage -Online | Where-Object {$_.DisplayName -eq 'Microsoft.Windowscommunicationsapps'} |Remove-AppxProvisionedPackage -online\r\nRemove-AppxProvisionedPackage: Access is denied.\r\n\r\nGet-AppxProvisionedPackage -Online | Where-Object {$_.DisplayName -eq 'Microsoft.Xbox.TCUI'} |Remove-AppxProvisionedPackage -online\r\nRemove-AppxProvisionedPackage: Access is denied.\r\n\r\nGet-AppxProvisionedPackage -Online | Where-Object {$_.DisplayName -eq 'Microsoft.XboxGameOverlay'} |Remove-AppxProvisionedPackage -online\r\nRemove-AppxProvisionedPackage: Access is denied.\r\n\r\nGet-AppxProvisionedPackage -Online | Where-Object {$_.DisplayName -eq 'Microsoft.XboxIdentityProvider'} |Remove-AppxProvisionedPackage -online\r\nRemove-AppxProvisionedPackage: Access is denied.\r\n\r\nGet-AppxProvisionedPackage -Online | Where-Object {$_.DisplayName -eq 'Microsoft.XboxSpeechtotextoverlay'} |Remove-AppxProvisionedPackage -online\r\nRemove-AppxProvisionedPackage: Access is denied.\r\n\r\nGet-AppxProvisionedPackage -Online | Where-Object {$_.DisplayName -eq 'Microsoft.ZuneVideo'} |Remove-AppxProvisionedPackage -Online\r\nRemove-AppxProvisionedPackage: Access is denied.\n\n### Expected behavior\n\n```console\nSee above.\n```\n\n\n### Actual behavior\n\n```console\nSee above.\n```\n\n\n### Error details\n\n```console\nget-error\r\n\r\nException             :\r\n    Type       : System.Runtime.InteropServices.COMException\r\n    ErrorCode  : -2147024891\r\n    TargetSite :\r\n        Name          : ThrowTerminatingError\r\n        DeclaringType : System.Management.Automation.MshCommandRuntime, System.Management.Automation, Version=7.2.5.500, Culture=neutral, PublicKeyToken=31bf3856ad364e35\r\n        MemberType    : Method\r\n        Module        : System.Management.Automation.dll\r\n    Message    : Access is denied.\r\n\r\n    Source     : System.Management.Automation\r\n    HResult    : -2147024891\r\n    StackTrace :\r\n   at System.Management.Automation.MshCommandRuntime.ThrowTerminatingError(ErrorRecord errorRecord)\r\nCategoryInfo          : NotSpecified: (:) [Remove-AppxProvisionedPackage], COMException\r\nFullyQualifiedErrorId : Microsoft.Dism.Commands.RemoveAppxProvisionedPackageCommand\r\nInvocationInfo        :\r\n    MyCommand        : Remove-AppxProvisionedPackage\r\n    ScriptLineNumber : 1\r\n    OffsetInLine     : 95\r\n    HistoryId        : 68\r\n    Line             : Get-AppxProvisionedPackage -Online | Where-Object {$_.DisplayName -eq 'Microsoft.ZuneVideo'} |Remove-AppxProvisionedPackage -Online\r\n    PositionMessage  : At line:1 char:95\r\n                       + \u2026 ame -eq 'Microsoft.ZuneVideo'} |Remove-AppxProvisionedPackage -Online\r\n                       +                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    InvocationName   : Remove-AppxProvisionedPackage\r\n    CommandOrigin    : Internal\r\nScriptStackTrace      : at <ScriptBlock>, <No file>: line 1\n```\n\n\n### Environment data\n\n```powershell\n$psversiontable\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.2.5\r\nPSEdition                      Core\r\nGitCommitId                    7.2.5\r\nOS                             Microsoft Windows 10.0.25158\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\n```\n\n\n### Visuals\n\n_No response_",
  "closed_at": null,
  "comments": [
    {
      "author": "StevenBucher98",
      "author_association": "COLLABORATOR",
      "body": "Hmm I am unable to reproduce on my Windows 11 machine (not ARM preview), not sure of nuances from that particular version to mine that may be causing this...",
      "created_at": "2022-08-15T16:00:39Z",
      "updated_at": "2022-08-15T16:00:39Z"
    }
  ],
  "created_at": "2022-08-09T11:29:44Z",
  "number": 17863,
  "state": "open",
  "title": "As Administrator: Remove-AppxProvisionedPackage: Access is denied.",
  "updated_at": "2022-09-19T15:42:06Z"
}
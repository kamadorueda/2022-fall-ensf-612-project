{
  "_url": "https://github.com/PowerShell/PowerShell/issues/4942",
  "author": "SteveL-MSFT",
  "body": "For PSCore6, we are only supporting InitialSessionState.  The RunspaceConfiguration api was already made internal.  This PR removes all the code related to RunspaceConfiguration.  This also means that some public apis have changed.  Was deciding between leaving the RunspaceConfiguration parameters and throwing Unsupported, but thought it was better to have it a compile time error.  This should simplify the code base.\r\n\r\n<!--\r\n\r\nIf you are a PowerShell Team member, please make sure you choose the Reviewer(s) and Assignee for your PR.\r\nIf you are not from the PowerShell Team, you can leave the fields blank and the Maintainers will choose them for you. If you are familiar with the team, feel free to mention some Reviewers yourself.\r\n\r\nFor more information about the roles of Reviewer and Assignee, refer to [CONTRIBUTING.md](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md).\r\n\r\n-->\r\n",
  "closed_at": "2017-10-18T16:12:24Z",
  "comments": [
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@SteveL-MSFT `powershell.Invoke()` (maybe some other part of the powershell class) goes through `RunspaceConfiguration`, for example the following script:\r\n```\r\n$ps = [powershell]::Create()\r\n$ps.AddScript(\"gcm\")\r\n$ps.Invoke()\r\n```\r\nDid you change it to not depend on `RunspaceConfiguration`?",
      "created_at": "2017-09-28T23:54:12Z",
      "updated_at": "2017-09-28T23:54:12Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@daxian-dbw yes, I changed it to use InitialSessionState",
      "created_at": "2017-09-28T23:56:47Z",
      "updated_at": "2017-09-28T23:56:47Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@SteveL-MSFT Awesome! Can you please point me to the part of changes that related to `powershell.invoke()`?",
      "created_at": "2017-09-29T00:00:03Z",
      "updated_at": "2017-09-29T00:00:03Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@daxian-dbw after ripping out the RunspaceConfig code, to get it working (and those tests passing) I [create a ISS instance with defaults](https://github.com/PowerShell/PowerShell/pull/4942/files#diff-1eb100aa3dfb92932b58036835b262bfR46).",
      "created_at": "2017-09-29T00:02:11Z",
      "updated_at": "2017-09-29T00:02:11Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@PowerShell/powershell-committee reviewed this and agreed on removal on RunspaceConfiguration code",
      "created_at": "2017-10-12T00:51:01Z",
      "updated_at": "2017-10-12T00:51:01Z"
    },
    {
      "author": "lzybkr",
      "author_association": "MEMBER",
      "body": ">                 {\"Get-PSSnapin\",                      new SessionStateCmdletEntry(\"Get-PSSnapin\", typeof(GetPSSnapinCommand), helpFile) },\r\n\r\nYou can delete this line.\r\n\r\n---\r\nRefers to: src/System.Management.Automation/engine/InitialSessionState.cs:5572 in 6121d89. [](commit_id = 6121d891d98cf4f813ac013ef8faa1bc8e68296d, deletion_comment = False)",
      "created_at": "2017-10-12T22:56:17Z",
      "updated_at": "2017-10-12T22:56:17Z"
    },
    {
      "author": "lzybkr",
      "author_association": "MEMBER",
      "body": ">                 {\"Get-PSSnapin\",                      new SessionStateCmdletEntry(\"Get-PSSnapin\", typeof(GetPSSnapinCommand), helpFile) },\r\n\r\nAnd the *PSSnapin lines.\r\n\r\n---\r\nIn reply to: [336302306](https://github.com/PowerShell/PowerShell/pull/4942#issuecomment-336302306) [](ancestors = 336302306)\r\n\r\n---\r\nRefers to: src/System.Management.Automation/engine/InitialSessionState.cs:5572 in 6121d89. [](commit_id = 6121d891d98cf4f813ac013ef8faa1bc8e68296d, deletion_comment = False)",
      "created_at": "2017-10-12T22:57:20Z",
      "updated_at": "2017-10-12T22:57:20Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "I believe all feedback has been addressed",
      "created_at": "2017-10-13T18:33:11Z",
      "updated_at": "2017-10-13T18:33:11Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "There is also a comment at https://github.com/PowerShell/PowerShell/pull/4942#discussion_r145203074.",
      "created_at": "2017-10-17T18:05:42Z",
      "updated_at": "2017-10-17T18:05:42Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "New Update-FormatData with invalid xml is causing a problem with PowerShellGet tests to fail.  I repro'd it with binaries built from master so it's not the result of these changes.  Created https://github.com/PowerShell/PowerShell/issues/5154 to track.",
      "created_at": "2017-10-18T03:58:33Z",
      "updated_at": "2017-10-18T03:58:48Z"
    }
  ],
  "created_at": "2017-09-28T23:45:43Z",
  "number": 4942,
  "state": "closed",
  "title": "removed RunspaceConfiguration support",
  "updated_at": "2017-11-12T05:17:49Z"
}
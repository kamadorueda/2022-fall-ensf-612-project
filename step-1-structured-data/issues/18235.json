{
  "_url": "https://github.com/PowerShell/PowerShell/issues/18235",
  "author": "wjholden",
  "body": "### Prerequisites\n\n- [X] Write a descriptive title.\n- [X] Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\n- [X] Search the existing issues.\n- [X] Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\n- [X] Refer to [Differences between Windows PowerShell 5.1 and PowerShell](https://docs.microsoft.com/powershell/scripting/whats-new/differences-from-windows-powershell).\n\n### Steps to reproduce\n\nIn Windows PowerShell 5.1.17763.2931 on Windows Server 2019 version 1809 (OS Build 17763.3406), I can type `Get-DhcpServerv4Scope` and the output includes a `LeaseDuration` field with data.\r\n\r\nIn PowerShell 7.3.0-preview.8 on exactly the same computer, the `Get-DhcpServerv4Scope` output shows blanks in the `LeaseDuration` field. \n\n### Expected behavior\n\n```console\nThe LeaseDuration field should contain exactly the same data in PS5 and PS7.\n```\n\n\n### Actual behavior\n\n```console\nThe LeaseDuration field is blank on PS7.\n```\n\n\n### Error details\n\n_No response_\n\n### Environment data\n\n```powershell\n(Apologies, but the server is on a closed network with no access to the Internet. PSVersion is 7.3.0-preview.8 and OS is Mcirosoft Windows 10.0.17763).\n```\n\n\n### Visuals\n\n_No response_",
  "closed_at": null,
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "DHCP module is loaded in pwsh with WinCompatibility feature. So serialization is used.\r\n\r\nI think this will be never fixed since MSFT continue migrating modules to pwsh. Better thing what you can do is to report the issue with Windows Feedback tool and ask the module owner team to migrate the module as soon as possible.",
      "created_at": "2022-10-07T17:04:49Z",
      "updated_at": "2022-10-07T17:04:49Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "In this case, it looks like this module is a CDXML (aka WMI) based module, so it should just work in PS7 and not use the WInCompat layer.  I don't have WinServer as a DHCP server setup to test this, but looking at the source, it appears that `LeaseDuration` is a scriptblock for formatting in the ps1xml.  It's supposed to show `Infinite` if it's maxvalue, otherwise it's supposed to show the actual value as a string.\r\n\r\n@wjholden can you show what the output of this looks like?\r\n\r\n```powershell\r\n(get-dhcpserverv4scope).leaseduration\r\n```\r\n",
      "created_at": "2022-10-10T18:23:01Z",
      "updated_at": "2022-10-10T18:23:01Z"
    },
    {
      "author": "wjholden",
      "author_association": "NONE",
      "body": "Interesting! In PS7, when I enter something like `(Get-DhcpServerv4Scope -ComputerName myserver).LeaseDuration` it returns a list of `System.TimeSpan` objects.\r\n\r\nI did create a report using the Windows Feedback tool, as suggested. ",
      "created_at": "2022-10-11T07:32:26Z",
      "updated_at": "2022-10-11T07:32:26Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT The module hasn't `CompatiblePSEditions`.\r\n```\r\n\r\n\t\t@{\r\n\r\n            GUID = '90eaa9df-133a-450c-8728-91055cd946a1'\r\n\r\n            Author = 'Microsoft Corporation'\r\n\r\n            CompanyName = 'Microsoft Corporation'\r\n\r\n            Copyright = '\u00a9 Microsoft Corporation. All rights reserved.'\r\n\r\n            ModuleVersion = '2.0.0.0'\r\n\r\n            PowerShellVersion = '3.0'\r\n\r\n            ClrVersion = \"4.0\"\r\n\r\n            FormatsToProcess = 'DhcpServerPsProvider.Format.ps1xml'\t\r\n\r\n            HelpInfoUri=\"http://go.microsoft.com/fwlink/?linkid=285742\"\r\n\r\n            TypesToProcess = 'DhcpServerPsProvider.Types.PS1XML'    \r\n\t\t    \r\n            NestedModules = @(\"PS_DhcpServerAuditLog_v1.0.0.cdxml\", \"PS_DhcpServerDatabase_v1.0.0.cdxml\", \"PS_DhcpServerInDC_v1.0.0.cdxml\", \"PS_DhcpServerSetting_v1.0.0.cdxml\", \"PS_DhcpServerV4Binding_v1.0.0.cdxml\", \"PS_DhcpServerv4Class_v1.0.0.cdxml\", \"PS_DhcpServerv4DnsSetting_v1.0.0.cdxml\", \"PS_DhcpServerV4ExclusionRange_v1.0.0.cdxml\", \"PS_DhcpServerv4FailoverReplication_v1.0.0.cdxml\", \"PS_DhcpServerv4FailoverScope_v1.0.0.cdxml\", \"PS_DhcpServerv4Failover_v1.0.0.cdxml\", \"PS_DhcpServerv4FilterList_v1.0.0.cdxml\", \"PS_DhcpServerv4Filter_v1.0.0.cdxml\", \"PS_DhcpServerv4FreeIPAddress_v1.0.0.cdxml\", \"PS_DhcpServerv4Lease_v1.0.0.cdxml\", \"PS_DhcpServerV4OptionDefinition_v1.0.0.cdxml\", \"PS_DhcpServerV4OptionValue_v1.0.0.cdxml\", \"PS_DhcpServerv4PolicyIPRange_v1.0.0.cdxml\", \"PS_DhcpServerv4Policy_v1.0.0.cdxml\", \"PS_DhcpServerV4Reservation_v1.0.0.cdxml\", \"PS_DhcpServerV4SuperScopeStatistics_v1.0.0.cdxml\", \"PS_DhcpServerV4Scope_v1.0.0.cdxml\", \"PS_DhcpServerv4Statistics_v1.0.0.cdxml\", \"PS_DhcpServerV4Superscope_v1.0.0.cdxml\", \"PS_DhcpServerV6Binding_v1.0.0.cdxml\", \"PS_DhcpServerv6Class_v1.0.0.cdxml\", \"PS_DhcpServerv6DnsSetting_v1.0.0.cdxml\", \"PS_DhcpServerV6ExclusionRange_v1.0.0.cdxml\", \"PS_DhcpServerv6FreeIPAddress_v1.0.0.cdxml\", \"PS_DhcpServerv6Lease_v1.0.0.cdxml\", \"PS_DhcpServerV6OptionDefinition_v1.0.0.cdxml\", \"PS_DhcpServerV6OptionValue_v1.0.0.cdxml\", \"PS_DhcpServerV6Reservation_v1.0.0.cdxml\", \"PS_DhcpServerV6ScopeStatistics_v1.0.0.cdxml\", \"PS_DhcpServerV6Scope_v1.0.0.cdxml\", \"PS_DhcpServerv6StatelessStatistics_v1.0.0.cdxml\", \"PS_DhcpServerv6StatelessStore_v1.0.0.cdxml\", \"PS_DhcpServerv6Statistics_v1.0.0.cdxml\", \"PS_DhcpServerVersion_v1.0.0.cdxml\", \"PS_DhcpServer_v1.0.0.cdxml\", \"PS_DhcpServerSecurityGroup_v1.0.0.cdxml\", \"PS_DhcpServerv4IPRecord_v1.0.0.cdxml\", \"PS_DhcpServerV4ScopeStatistics_v1.0.0.cdxml\" , \"PS_DhcpServerV4MulticastScope_v1.0.0.cdxml\", \"PS_DhcpServerv4MulticastExclusionRange_v1.0.0.cdxml\" , \"PS_DhcpServerv4MulticastLease_v1.0.0.cdxml\" , \"PS_DhcpServerv4MulticastScopeStatistics_v1.0.0.cdxml\" , \"PS_DhcpServerDnsCredential_v1.0.0.cdxml\" , \"DhcpServerMigration.psm1\")\r\n\r\n\t    FunctionsToExport = @(\"Add-DhcpServerInDC\", \"Add-DhcpServerv4Class\", \"Add-DhcpServerv4ExclusionRange\", \"Add-DhcpServerv4Failover\", \"Add-DhcpServerv4FailoverScope\", \"Add-DhcpServerv4Filter\", \"Add-DhcpServerv4Lease\", \"Add-DhcpServerv4OptionDefinition\", \"Add-DhcpServerv4Policy\", \"Add-DhcpServerv4PolicyIPRange\", \"Add-DhcpServerv4Reservation\", \"Add-DhcpServerv4Scope\", \"Add-DhcpServerv4Superscope\", \"Add-DhcpServerv6Class\", \"Add-DhcpServerv6ExclusionRange\", \"Add-DhcpServerv6Lease\", \"Add-DhcpServerv6OptionDefinition\", \"Add-DhcpServerv6Reservation\", \"Add-DhcpServerv6Scope\", \"Backup-DhcpServer\", \"Export-DhcpServer\", \"Get-DhcpServerAuditLog\", \"Get-DhcpServerDatabase\", \"Get-DhcpServerInDC\", \"Get-DhcpServerSetting\", \"Get-DhcpServerv4Binding\", \"Get-DhcpServerv4Class\", \"Get-DhcpServerv4DnsSetting\", \"Get-DhcpServerv4ExclusionRange\", \"Get-DhcpServerv4Failover\", \"Get-DhcpServerv4Filter\", \"Get-DhcpServerv4FilterList\", \"Get-DhcpServerv4FreeIPAddress\", \"Get-DhcpServerv4Lease\", \"Get-DhcpServerv4OptionDefinition\", \"Get-DhcpServerv4OptionValue\", \"Get-DhcpServerv4Policy\", \"Get-DhcpServerv4PolicyIPRange\", \"Get-DhcpServerv4Reservation\", \"Get-DhcpServerv4Scope\", \"Get-DhcpServerv4SuperScopeStatistics\", \"Get-DhcpServerv4Statistics\", \"Get-DhcpServerv4Superscope\", \"Get-DhcpServerv6Binding\", \"Get-DhcpServerv6Class\", \"Get-DhcpServerv6DnsSetting\", \"Get-DhcpServerv6ExclusionRange\", \"Get-DhcpServerv6FreeIPAddress\", \"Get-DhcpServerv6Lease\", \"Get-DhcpServerv6OptionDefinition\", \"Get-DhcpServerv6OptionValue\", \"Get-DhcpServerv6Reservation\", \"Get-DhcpServerv6Scope\", \"Get-DhcpServerv6ScopeStatistics\", \"Get-DhcpServerv6StatelessStatistics\", \"Get-DhcpServerv6StatelessStore\", \"Get-DhcpServerv6Statistics\", \"Get-DhcpServerVersion\", \"Import-DhcpServer\", \"Invoke-DhcpServerv4FailoverReplication\", \"Remove-DhcpServerInDC\", \"Remove-DhcpServerv4Class\", \"Remove-DhcpServerv4ExclusionRange\", \"Remove-DhcpServerv4Failover\", \"Remove-DhcpServerv4FailoverScope\", \"Remove-DhcpServerv4Filter\", \"Remove-DhcpServerv4Lease\", \"Remove-DhcpServerv4OptionDefinition\", \"Remove-DhcpServerv4OptionValue\", \"Remove-DhcpServerv4Policy\", \"Remove-DhcpServerv4PolicyIPRange\", \"Remove-DhcpServerv4Reservation\", \"Remove-DhcpServerv4Scope\", \"Remove-DhcpServerv4Superscope\", \"Remove-DhcpServerv6Class\", \"Remove-DhcpServerv6ExclusionRange\", \"Remove-DhcpServerv6Lease\", \"Remove-DhcpServerv6OptionDefinition\", \"Remove-DhcpServerv6OptionValue\", \"Remove-DhcpServerv6Reservation\", \"Remove-DhcpServerv6Scope\", \"Restore-DhcpServer\", \"Set-DhcpServerAuditLog\", \"Set-DhcpServerDatabase\", \"Set-DhcpServerSetting\", \"Set-DhcpServerv4Binding\", \"Set-DhcpServerv4Class\", \"Set-DhcpServerv4DnsSetting\", \"Set-DhcpServerv4Failover\", \"Set-DhcpServerv4FilterList\", \"Set-DhcpServerv4OptionDefinition\", \"Set-DhcpServerv4OptionValue\", \"Set-DhcpServerv4Policy\", \"Set-DhcpServerv4Reservation\", \"Set-DhcpServerv4Scope\", \"Set-DhcpServerv6Binding\", \"Set-DhcpServerv6Class\", \"Set-DhcpServerv6DnsSetting\", \"Set-DhcpServerv6OptionDefinition\", \"Set-DhcpServerv6OptionValue\", \"Set-DhcpServerv6Reservation\", \"Set-DhcpServerv6Scope\", \"Set-DhcpServerv6StatelessStore\", \"Add-DhcpServerSecurityGroup\", \"Repair-DhcpServerv4IPRecord\" , \"Rename-DhcpServerv4Superscope\" , \"Get-DhcpServerv4ScopeStatistics\" , \"Add-DhcpServerv4MulticastScope\" , \"Set-DhcpServerv4MulticastScope\" , \"Get-DhcpServerv4MulticastScope\" , \"Remove-DhcpServerv4MulticastScope\" , \"Get-DhcpServerv4MulticastScopeStatistics\" , \"Add-DhcpServerv4MulticastExclusionRange\" , \"Get-DhcpServerv4MulticastExclusionRange\" , \"Remove-DhcpServerv4MulticastExclusionRange\" , \"Get-DhcpServerv4MulticastLease\" , \"Remove-DhcpServerv4MulticastLease\" , \"Get-DhcpServerDnsCredential\" , \"Set-DhcpServerDnsCredential\" , \"Remove-DhcpServerDnsCredential\" )\r\n\r\n\t\t}\r\n\r\n```",
      "created_at": "2022-10-11T17:00:43Z",
      "updated_at": "2022-10-11T17:00:43Z"
    }
  ],
  "created_at": "2022-10-07T12:41:26Z",
  "number": 18235,
  "state": "open",
  "title": "Get-DhcpServerv4Scope shows blank LeaseDuration on PowerShell 7.3.0-preview.8 ",
  "updated_at": "2022-10-11T17:00:43Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/4540",
  "author": "adityapatwardhan",
  "body": "The updates to build.psm1 and packaging.psm1 create a single package (per bitness), which works on all the Windows OS versions, namely Windows 7 / Windows Server 2008 R2, Windows 8.1 / Windows Server 2012 R2, Windows 10 / Windows Server 2016. \r\n\r\n> I am in process of testing the packages on the various OS versions, hence please **DO NOT MERGE**. I will update this PR when testing is complete.\r\n\r\n[daxian edited] This PR has been approved by @TravisEz13 and @iSazonov, so I merged it.\r\n\r\nFixes #4315 and #2608 ",
  "closed_at": "2017-08-28T23:10:04Z",
  "comments": [
    {
      "author": "adityapatwardhan",
      "author_association": "MEMBER",
      "body": "@joeyaiello @TravisEz13 @iSazonov Thanks for the feedback. To summarize, keep the value for -Runtime as win7-x86 and win7-x64 and remove other win* values. During packaging change the package name to win-x86 and win-x64. I will update PR soon.",
      "created_at": "2017-08-14T22:01:19Z",
      "updated_at": "2017-08-14T22:01:19Z"
    },
    {
      "author": "adityapatwardhan",
      "author_association": "MEMBER",
      "body": "@TravisEz13 @iSazonov @joeyaiello I have updated the PR. Please have a look.",
      "created_at": "2017-08-14T23:15:38Z",
      "updated_at": "2017-08-14T23:15:38Z"
    },
    {
      "author": "adityapatwardhan",
      "author_association": "MEMBER",
      "body": "@daxian-dbw @TravisEz13 @iSazonov @joeyaiello  Please have a look. All feedback is addressed.",
      "created_at": "2017-08-16T07:36:06Z",
      "updated_at": "2017-08-16T07:36:06Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "No new ideas yet :-)",
      "created_at": "2017-08-16T08:00:49Z",
      "updated_at": "2017-08-16T08:00:49Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "We will have the `beta-6` release on this Thursday (8/24), and we don't have enough time to stabilize this change. Travis and I chatted offline and agreed that we should hold off this change till after this release.",
      "created_at": "2017-08-22T16:39:40Z",
      "updated_at": "2017-08-22T16:39:40Z"
    },
    {
      "author": "adityapatwardhan",
      "author_association": "MEMBER",
      "body": "I agree, this should be merged after the release. We do not have the ability to test a package in an automated way. We should get that working first.\n\nGet Outlook for Android<https://aka.ms/ghei36>\n\n________________________________\nFrom: Dongbo Wang <notifications@github.com>\nSent: Tuesday, August 22, 2017 9:39:54 AM\nTo: PowerShell/PowerShell\nCc: Aditya Patwardhan; Mention\nSubject: Re: [PowerShell/PowerShell] Creates a single package for Windows (#4540)\n\n\nWe will have the beta-6 release on this Thursday (8/24), and we don't have enough time to stabilize this change. Travis and I chatted offline and agreed that we should hold off this change till after this release.\n\n\u2014\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub<https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2FPowerShell%2FPowerShell%2Fpull%2F4540%23issuecomment-324083453&data=02%7C01%7Cadityap%40microsoft.com%7Cdcfeca2cbbde41e722e908d4e97c6b24%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636390167972135774&sdata=GcVq9IzmSrapBfddMHIUl7wg3KOnWvWTRDdcsL3i0dQ%3D&reserved=0>, or mute the thread<https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fnotifications%2Funsubscribe-auth%2FAMOhvRZqIxURR3aQjRDHbIGQeoyz9GjNks5sawRZgaJpZM4Oyyz4&data=02%7C01%7Cadityap%40microsoft.com%7Cdcfeca2cbbde41e722e908d4e97c6b24%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C636390167972135774&sdata=RhRENrF%2F95PZIs%2FYdAEZFCxEe2pfLuZ09MvHR7c20gc%3D&reserved=0>.\n",
      "created_at": "2017-08-22T16:45:56Z",
      "updated_at": "2017-08-22T16:45:56Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "There is some logic in the MSI package that seems to check the Windows C Runtime and VS Studio 2015 C++ redistributables are present and return error message if not (see (https://github.com/PowerShell/PowerShell/commit/54e892ab06fc0b705a329be8061df9f77cbd54f8)). It seems this logic is enabled in downlevel MSI package (@mirichmo please correct me if I'm wrong).\r\n\r\nI bring this up because this caused an issue that causes Win81 packages fail to install on Server2012R2. I'm not sure if this will have any impact when running win7 MSI packages on Win10/Server2016.",
      "created_at": "2017-08-24T19:26:11Z",
      "updated_at": "2017-08-25T16:05:41Z"
    },
    {
      "author": "mirichmo",
      "author_association": "MEMBER",
      "body": "I filed #4665 to cover the installer issue. The check needs to be more generic to cover the scenario where the dependencies are installed via Windows Update",
      "created_at": "2017-08-24T22:27:52Z",
      "updated_at": "2017-08-24T22:27:52Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@TravisEz13 I have merged this PR. Do you think any other scripts need to be changed accordingly? (e.g. powershell/psrelease ??)",
      "created_at": "2017-08-28T23:12:30Z",
      "updated_at": "2017-08-28T23:12:30Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "@daxian-dbw  I'll look at the builds tomorrow and see if everything went correctly.",
      "created_at": "2017-08-28T23:24:44Z",
      "updated_at": "2017-08-28T23:24:44Z"
    }
  ],
  "created_at": "2017-08-10T00:15:43Z",
  "number": 4540,
  "state": "closed",
  "title": "Creates a single package for Windows ",
  "updated_at": "2017-09-13T17:30:09Z"
}
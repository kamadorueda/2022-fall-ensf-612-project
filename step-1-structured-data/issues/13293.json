{
  "_url": "https://github.com/PowerShell/PowerShell/issues/13293",
  "author": "rjmholt",
  "body": "\r\n## Steps to reproduce\r\n\r\nI've implemented a small cmdlet like this:\r\n\r\n```csharp\r\n    [Cmdlet(VerbsCommon.Get, \"RefilAssemblyMetadata\")]\r\n    public class GetRefilAssemblyMetadataCommand : PSCmdlet\r\n    {\r\n        [Parameter(Mandatory = true)]\r\n        public string[] Path { get; }\r\n\r\n        protected override void ProcessRecord()\r\n        {\r\n            foreach (string path in Path)\r\n            {\r\n                WriteObject(MetadataAssemblyDefinition.ReadFromFile(path));\r\n            }\r\n        }\r\n    }\r\n```\r\n\r\nAnd go to run it like this:\r\n\r\n```powershell\r\n$a = Get-RefilAssemblyMetadata -Path \"$PSHOME/System.Management.Automation\"\r\n```\r\n\r\n## Expected behavior\r\n\r\n`$a` should be set, or my cmdlet implementation should fail if I've done something wrong.\r\n\r\n## Actual behavior\r\n\r\n```none\r\n> $a = Get-RefilAssemblyMetadata -Path \"$PSHOME/System.Management.Automation\"\r\nGet-RefilAssemblyMetadata: Cannot bind parameter 'Path' to the target. Exception setting \"Path\": \"Expression must be writeable (Parameter 'left')\"\r\nC:\\Users\\Robert Holt\\Documents\\Dev\\Projects\\RefIL [master \u2261 +10 ~4 -2 !]\r\n> Get-error\r\n\r\nException             :\r\n    Type              : System.Management.Automation.ParameterBindingException\r\n    Message           : Cannot bind parameter 'Path' to the target. Exception setting \"Path\":\r\n\"Expression must be writeable (Parameter 'left')\"\r\n    ParameterName     : Path\r\n    ParameterType     : string[]\r\n    TypeSpecified     : string[]\r\n    ErrorId           : ParameterBindingFailed\r\n    Line              : 1\r\n    Offset            : 38\r\n    CommandInvocation :\r\n        MyCommand        : Get-RefilAssemblyMetadata\r\n        ScriptLineNumber : 1\r\n        OffsetInLine     : 6\r\n        HistoryId        : 6\r\n        Line             : $a = Get-RefilAssemblyMetadata -Path\r\n\"$PSHOME/System.Management.Automation\"\r\n        PositionMessage  : At line:1 char:6\r\n                           + $a = Get-RefilAssemblyMetadata -Path \"$PSHOME/System.Management.Autom \u2026\r\n                           +      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n        InvocationName   : Get-RefilAssemblyMetadata\r\n        PipelineLength   : 1\r\n        PipelinePosition : 1\r\n    ErrorRecord       :\r\n        Exception             :\r\n            Type    : System.Management.Automation.ParentContainsErrorRecordException\r\n            Message : Cannot bind parameter 'Path' to the target. Exception setting \"Path\":\r\n\"Expression must be writeable (Parameter 'left')\"\r\n            HResult : -2146233087\r\n        CategoryInfo          : WriteError: (:) [Get-RefilAssemblyMetadata],\r\nParentContainsErrorRecordException\r\n        FullyQualifiedErrorId :\r\nParameterBindingFailed,RefIL.PowerShell.GetRefilAssemblyMetadataCommand\r\n        InvocationInfo        :\r\n            MyCommand        : Get-RefilAssemblyMetadata\r\n            ScriptLineNumber : 1\r\n            OffsetInLine     : 38\r\n            HistoryId        : 6\r\n            Line             : $a = Get-RefilAssemblyMetadata -Path\r\n\"$PSHOME/System.Management.Automation\"\r\n            PositionMessage  : At line:1 char:38\r\n                               + \u2026 et-RefilAssemblyMetadata -Path\r\n\"$PSHOME/System.Management.Automation\"\r\n                               +\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n            CommandOrigin    : Internal\r\n        ScriptStackTrace      : at <ScriptBlock>, <No file>: line 1\r\n    TargetSite        :\r\n        Name          : BindParameter\r\n        DeclaringType : System.Management.Automation.ParameterBinderBase,\r\nSystem.Management.Automation, Version=7.1.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\r\n        MemberType    : Method\r\n        Module        : System.Management.Automation.dll\r\n    StackTrace        :\r\n   at System.Management.Automation.ParameterBinderBase.BindParameter(CommandParameterInternal\r\nparameter, CompiledCommandParameter parameterMetadata, ParameterBindingFlags flags)\r\n   at\r\nSystem.Management.Automation.CmdletParameterBinderController.BindParameter(CommandParameterInternal\r\nargument, MergedCompiledCommandParameter parameter, ParameterBindingFlags flags)\r\n   at System.Management.Automation.CmdletParameterBinderController.BindParameter(UInt32\r\nparameterSets, CommandParameterInternal argument, MergedCompiledCommandParameter parameter,\r\nParameterBindingFlags flags)\r\n   at System.Management.Automation.CmdletParameterBinderController.BindParameters(UInt32\r\nparameterSets, Collection`1 arguments)\r\n   at System.Management.Automation.CmdletParameterBinderController.BindCommandLineParametersNoValidat\r\nion(Collection`1 arguments)\r\n   at\r\nSystem.Management.Automation.CmdletParameterBinderController.BindCommandLineParameters(Collection`1\r\narguments)\r\n   at System.Management.Automation.CommandProcessor.BindCommandLineParameters()\r\n   at System.Management.Automation.CommandProcessor.Prepare(IDictionary psDefaultParameterValues)\r\n   at System.Management.Automation.CommandProcessorBase.DoPrepare(IDictionary\r\npsDefaultParameterValues)\r\n   at System.Management.Automation.Internal.PipelineProcessor.Start(Boolean incomingStream)\r\n   at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object\r\ninput)\r\n--- End of stack trace from previous location ---\r\n   at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object\r\ninput)\r\n   at System.Management.Automation.PipelineOps.InvokePipeline(Object input, Boolean ignoreInput,\r\nCommandParameterInternal[][] pipeElements, CommandBaseAst[] pipeElementAsts, CommandRedirection[][]\r\ncommandRedirections, FunctionContext funcContext)\r\n   at System.Management.Automation.Interpreter.ActionCallInstruction`6.Run(InterpretedFrame frame)\r\n   at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame\r\nframe)\r\n   at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame\r\nframe)\r\n    Data              : System.Collections.ListDictionaryInternal\r\n    InnerException    :\r\n        Type           : System.Management.Automation.SetValueInvocationException\r\n        ErrorRecord    :\r\n            Exception             :\r\n                Type    : System.Management.Automation.ParentContainsErrorRecordException\r\n                Message : Exception setting \"Path\": \"Expression must be writeable (Parameter 'left')\"\r\n                HResult : -2146233087\r\n            CategoryInfo          : NotSpecified: (:) [], ParentContainsErrorRecordException\r\n            FullyQualifiedErrorId : CatchFromBaseAdapterSetValue\r\n        TargetSite     :\r\n            Name          : BindParameter\r\n            DeclaringType : System.Management.Automation.ReflectionParameterBinder,\r\nSystem.Management.Automation, Version=7.1.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\r\n            MemberType    : Method\r\n            Module        : System.Management.Automation.dll\r\n        StackTrace     :\r\n   at System.Management.Automation.ReflectionParameterBinder.BindParameter(String name, Object\r\nvalue, CompiledCommandParameter parameterMetadata)\r\n   at System.Management.Automation.ParameterBinderBase.BindParameter(CommandParameterInternal\r\nparameter, CompiledCommandParameter parameterMetadata, ParameterBindingFlags flags)\r\n        Message        : Exception setting \"Path\": \"Expression must be writeable (Parameter 'left')\"\r\n        InnerException :\r\n            Type       : System.ArgumentException\r\n            Message    : Expression must be writeable (Parameter 'left')\r\n            ParamName  : left\r\n            TargetSite :\r\n                Name          : RequiresCanWrite\r\n                DeclaringType : System.Linq.Expressions.Expression\r\n                MemberType    : Method\r\n                Module        : System.Linq.Expressions.dll\r\n            StackTrace :\r\n   at System.Linq.Expressions.Expression.RequiresCanWrite(Expression expression, String paramName)\r\n   at System.Linq.Expressions.Expression.Assign(Expression left, Expression right)\r\n   at\r\nSystem.Management.Automation.ReflectionParameterBinder.<>c__DisplayClass8_0.<GetSetter>b__0(Tuple`2\r\n_)\r\n   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)\r\n   at System.Management.Automation.ReflectionParameterBinder.BindParameter(String name, Object\r\nvalue, CompiledCommandParameter parameterMetadata)\r\n            Source     : System.Linq.Expressions\r\n            HResult    : -2147024809\r\n        Source         : System.Management.Automation\r\n        HResult        : -2146233087\r\n    Source            : System.Management.Automation\r\n    HResult           : -2146233087\r\nCategoryInfo          : WriteError: (:) [Get-RefilAssemblyMetadata], ParameterBindingException\r\nFullyQualifiedErrorId : ParameterBindingFailed,RefIL.PowerShell.GetRefilAssemblyMetadataCommand\r\nInvocationInfo        :\r\n    MyCommand        : Get-RefilAssemblyMetadata\r\n    ScriptLineNumber : 1\r\n    OffsetInLine     : 38\r\n    HistoryId        : 6\r\n    Line             : $a = Get-RefilAssemblyMetadata -Path \"$PSHOME/System.Management.Automation\"\r\n    PositionMessage  : At line:1 char:38\r\n                       + \u2026 et-RefilAssemblyMetadata -Path \"$PSHOME/System.Management.Automation\"\r\n                       +                                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    CommandOrigin    : Internal\r\nScriptStackTrace      : at <ScriptBlock>, <No file>: line 1\r\n```\r\n\r\n## Environment data\r\n\r\n<!-- provide the output of $PSVersionTable -->\r\n\r\nThis is using the following PowerShell version:\r\n\r\n```none\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.1.0-preview.5\r\nPSEdition                      Core\r\nGitCommitId                    7.1.0-preview.5\r\nOS                             Microsoft Windows 10.0.19041\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n\r\nAnd compiling against Microsoft.PowerShell.SDK version 7.1.0-preview.5.",
  "closed_at": "2020-07-27T22:35:59Z",
  "comments": [
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "Isn't that expected? I was under the expression parameters always needed to have both getters and setters.",
      "created_at": "2020-07-27T22:32:10Z",
      "updated_at": "2020-07-27T22:32:10Z"
    },
    {
      "author": "rjmholt",
      "author_association": "COLLABORATOR",
      "body": "Oh wow, now I see that it's missing the setter.\r\n\r\nHmmm, I would love to have a better error message for that",
      "created_at": "2020-07-27T22:35:58Z",
      "updated_at": "2020-07-27T22:35:58Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "Yeah it would be good to maybe catch this error in the parameter binder specifically and issue a more direct error message to avoid confusion.",
      "created_at": "2020-07-27T23:23:15Z",
      "updated_at": "2020-07-27T23:23:15Z"
    }
  ],
  "created_at": "2020-07-27T20:53:18Z",
  "labels": [
    "Issue-Question"
  ],
  "number": 13293,
  "state": "closed",
  "title": "Custom cmdlet: cannot bind parameter ... expression must be writeable",
  "updated_at": "2020-07-27T23:23:16Z"
}
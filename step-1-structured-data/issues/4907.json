{
  "_url": "https://github.com/PowerShell/PowerShell/issues/4907",
  "author": "joandrsn",
  "body": "I had the time to look into this issue #2579\r\n\r\nI have added the following to the `Get-Service` command:\r\n* BinaryPathName (Was suggested as `ServicePath`)\r\n* Description\r\n* UserName (Was suggested as `LogOnAs`)\r\n* DelayedAutoStart\r\n* ServiceStartupType\r\n\r\nThe ServiceStartupType was also added, providing the user access to use services like in `services.msc`, having `Automatic`, `Automatic (Delayed Start)`, `Manual` and `Disabled` as options (Also includes `InvalidValue` as an initial value for `ServiceStartupType`)\r\n\r\nI'm not completely sure if my naming of the variables are correct and would like some feedback.\r\nI have tried to get a complete overview of what the different properties are called in the different ways to interact with services (With my additions marked like ***this***).\r\n\r\n| New-Service | Set-Service  | Get-Service            | Get-CimInstance     |\r\n| ----------- | ------------ | ---------------------- | ------------------- |\r\n| N/A         | Computername | N/A                    | SystemName?         |\r\n| Name        | Name         | Name                   | Name                |\r\n| DisplayName | DisplayName  | DisplayName            | DisplayName/Caption |\r\n| Description | Description  | ***Description***      | Description         |\r\n| StartupType | StartupType  | ***StartupType***      | Startmode (string)  |\r\n| N/A         | Status       | Status                 | State               |\r\n| Credentials | Credentials  | ***UserName****        | StartName*          |\r\n| BinaryPathName     | N/A          | ***BinaryPathName***          | PathName            |\r\n| DependsOn   | N/A          | RequiredServices       | N/A                 |\r\n| N/A         | N/A          | N/A                    | DelayedAutoStart    |\r\n| N/A         | N/A          | N/A                    | ProcessId           |\r\n\r\n*Only username of the account running the service.\r\n\r\nWhen adding the properties, I used NotePropertie and I don't know if it's possible to make autocomplete for this.\r\nI would love to have the ability to type:\r\n`$service = Get-Service -Name 'spooler'`\r\n`$service.Use<TAB>` => `$service.UserName`\r\n\r\nAnother thing: I'm not sure if I should/can split my function for adding properties up into smaller pieces since it's about 100 lines currently.\r\n\r\nI might remove DelayedAutoStart from the pull request since people might rather want it as a StartupType instead. I currently have it in since people might find the information useful on its own.",
  "closed_at": "2017-10-24T06:54:08Z",
  "comments": [
    {
      "author": "joandrsn",
      "author_association": "CONTRIBUTOR",
      "body": "I have converted the `StartupType` to a custom enum. It's now possible to use to specify AutomaticDelayedStart as a StartupType.",
      "created_at": "2017-09-24T18:41:22Z",
      "updated_at": "2017-09-24T18:41:22Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Does it make sense to use ETS here?\r\n\r\n/cc @lzybkr \r\n",
      "created_at": "2017-09-25T17:22:03Z",
      "updated_at": "2017-09-25T17:22:03Z"
    },
    {
      "author": "joandrsn",
      "author_association": "CONTRIBUTOR",
      "body": "It has been 3 days since the latest update on this issue, so I wanted to bring the issue up again.\r\nAre we waiting for @lzybkr to review this?\r\n\r\n@iSazonov, you mention ETS. \r\nI initially tried to use ETS but it seemed at bit hard. Then I saw what pull request #2850 did it and used the `Properties`-method.\r\nAre there any benifits to using ETS over using `Properties` directly?\r\nOr does it generate more readable code?\r\nOr does it maybe help PowerShell recognize properties and then enable tab-completion of the properties added?\r\nI am curious :)",
      "created_at": "2017-09-29T12:29:24Z",
      "updated_at": "2017-09-29T12:29:24Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "I think we can defer the ETS discussion and redo it if necessary.",
      "created_at": "2017-09-29T16:24:34Z",
      "updated_at": "2017-09-29T16:24:34Z"
    },
    {
      "author": "joandrsn",
      "author_association": "CONTRIBUTOR",
      "body": "This is my first time freeing memory.\r\n\r\nI think I still have some memory which does not get dereferenced, but I just can't find it.\r\nIf I run this command: \r\n`1..10000 | % { $null = Get-Service -Name 'spooler' }`\r\nI am not getting any less memory allocated, but only more (Very minor, but still relevant).\r\n\r\nI'm not sure if I should use [AllocCoTaskMem][0] or [AllocHGlobal][1] and I have searched a lot to figure out which one I should use.\r\nCurrently, I'm using both, but I should probably use only one of the methods since it gives better readability.\r\nI am however using the correct method for freeing memory, as [I should not mix][2].\r\n\r\nI would also free the memory when the other functions are called, but that is a different issue and I won't include it in this pull request.\r\n\r\n[0]: https://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.alloccotaskmem(v=vs.110).aspx\r\n[1]: https://msdn.microsoft.com/en-us/library/5cyb68cy(v=vs.110).aspx\r\n[2]: https://msdn.microsoft.com/en-us/library/windows/desktop/aa366533(v=vs.85).aspx",
      "created_at": "2017-09-30T11:18:09Z",
      "updated_at": "2017-09-30T11:18:09Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@joandrsn AllocHGlobal is from 16-bit Windows. See https://msdn.microsoft.com/en-us/library/aa366596.aspx\r\nAllocCoTaskMem is recommended.\r\n\r\nI agree that we should open a tracking Issue to review our code for the problem with memory free.",
      "created_at": "2017-09-30T19:03:20Z",
      "updated_at": "2017-09-30T19:03:20Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT We have new commits - Could you please take another look?\r\n\r\n@daxian-dbw Could you please review and approve as code owner?\r\n\r\n@mirichmo Could you please comment [about ApiSets](https://github.com/PowerShell/PowerShell/pull/4907#discussion_r141940852)?\r\n",
      "created_at": "2017-10-02T06:35:57Z",
      "updated_at": "2017-10-02T06:35:57Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@joandrsn Thanks for great work! Please wait improvements from MSFT experts.",
      "created_at": "2017-10-02T07:41:01Z",
      "updated_at": "2017-10-02T07:41:01Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@mirichmo Could you please take another look?",
      "created_at": "2017-10-19T05:15:36Z",
      "updated_at": "2017-10-19T05:15:36Z"
    },
    {
      "author": "joandrsn",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks @mirichmo! I believe I fixed it.",
      "created_at": "2017-10-20T22:35:49Z",
      "updated_at": "2017-10-20T22:35:49Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@joandrsn Please add `ServiceStartupType.InvalidValue` in the PR description.",
      "created_at": "2017-10-21T21:05:04Z",
      "updated_at": "2017-10-21T21:05:04Z"
    },
    {
      "author": "joandrsn",
      "author_association": "CONTRIBUTOR",
      "body": "@iSazonov did I understand you correctly? I just updated my initial PR comment to reflect how `ServiceStartupType` can be used.",
      "created_at": "2017-10-22T21:40:01Z",
      "updated_at": "2017-10-22T21:40:01Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "LGTM.",
      "created_at": "2017-10-23T05:38:28Z",
      "updated_at": "2017-10-23T05:38:28Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT We've got new commits - could you please take another look?",
      "created_at": "2017-10-23T05:41:06Z",
      "updated_at": "2017-10-23T05:41:06Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@joandrsn Many thanks for your contribution! Welcome back with new PRs!",
      "created_at": "2017-10-24T06:55:37Z",
      "updated_at": "2017-10-24T06:55:37Z"
    },
    {
      "author": "jcoffi",
      "author_association": "NONE",
      "body": "Whatever happened to this? It looks like it never made it into a final build as I'm not seeing it in 7.0.3.",
      "created_at": "2020-09-22T20:44:04Z",
      "updated_at": "2020-09-22T20:44:04Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@jcoffi You can see all properties with:\r\n```powershell\r\nGet-Service wuauserv | fl * -Force\r\n```",
      "created_at": "2020-09-23T03:08:23Z",
      "updated_at": "2020-09-23T03:08:23Z"
    }
  ],
  "created_at": "2017-09-23T23:12:49Z",
  "number": 4907,
  "state": "closed",
  "title": "Added BinPath, Description, UserName and Delayed Auto Start to Get-Service",
  "updated_at": "2021-04-23T07:09:58Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/6940",
  "author": "Stephanevg",
  "body": "Hi guys,\r\n\r\nI have searching around the internet, trying to find a way to add calulcated properties to for ListItems in a Format.ps1xml\r\n\r\nThe documentation does mention <scriptblocks> but **only** for Tables.\r\n\r\nWhen piped to Format-Table I get the following info back (ACtually, this is is the output by default)\r\n\r\n![image](https://user-images.githubusercontent.com/6302961/40570127-ec4d4a04-6087-11e8-806e-0a90fc5ee98d.png)\r\n\r\n\r\nWhen I  pipe my cmdlet to Format-list, (without any format.ps1xml loaded) this is the result I get back:\r\n\r\n![image](https://user-images.githubusercontent.com/6302961/40570121-d6ecf3da-6087-11e8-87b9-ef3c6a1446a6.png)\r\n\r\nClearly, this is not idea for the end user, \r\nI would like to default to Format-List, BUT I would like to present the object in an 'unested' manner to the end user. I could do it using **<scriptblock>** in the tablesection, but I cannot find anything similar to this for the list. \r\nI am wondering if this is actually supported? if not, what would be the way to go then ?\r\n\r\n\r\nThis is currrent structure of my format.ps1.xml\r\n\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"utf-8\" ?>\r\n<Configuration>\r\n<SelectionSets>\r\n        <SelectionSet>\r\n            <Name>DeputeTypes</Name>\r\n            <Types>\r\n                <TypeName>Depute</TypeName>\r\n            </Types>\r\n        </SelectionSet>\r\n   </SelectionSets>\r\n    <ViewDefinitions>\r\n        <View>\r\n            <Name>Table</Name>\r\n            <ViewSelectedBy>\r\n                <TypeName>Depute</TypeName>\r\n            </ViewSelectedBy>\r\n            <TableControl>\r\n                <TableHeaders>\r\n                    <TableColumnHeader>\r\n                        <Label>id</Label>\r\n                        <Width>3</Width>\r\n                    </TableColumnHeader>\r\n                    <TableColumnHeader>\r\n                        <Label>Nom</Label>\r\n                        <Width>15</Width>\r\n                        <Alignment>right</Alignment>\r\n                    </TableColumnHeader>\r\n                    <TableColumnHeader>\r\n                        <Label>Prenom</Label>\r\n                        <Width>15</Width>\r\n                        <Alignment>right</Alignment>\r\n                    </TableColumnHeader>\r\n                    <TableColumnHeader>\r\n                        <Label>DateNaissance</Label>\r\n                        <Width>13</Width>\r\n                        <Alignment>right</Alignment>\r\n                    </TableColumnHeader>\r\n                    <TableColumnHeader>\r\n                        <Label>LieuNaissance</Label>\r\n                        <Width>25</Width>\r\n                        <Alignment>right</Alignment>\r\n                    </TableColumnHeader>\r\n                    <TableColumnHeader>\r\n                        <Label>Profession</Label>\r\n                        <Width>50</Width>\r\n                        <Alignment>right</Alignment>\r\n                    </TableColumnHeader>\r\n                    <TableColumnHeader>\r\n                        <Label>AutresMandats</Label>\r\n                        <Width>13</Width>\r\n                        <Alignment>right</Alignment>\r\n                    </TableColumnHeader>\r\n                </TableHeaders>\r\n                <TableRowEntries>\r\n                    <TableRowEntry>\r\n                        <TableColumnItems>\r\n                            <TableColumnItem>\r\n                                <PropertyName>id</PropertyName>\r\n                            </TableColumnItem>\r\n                            <TableColumnItem>\r\n                                <ScriptBlock>$_.Identite.nom</ScriptBlock>\r\n                            </TableColumnItem>\r\n                            <TableColumnItem>\r\n                                <ScriptBlock>$_.Identite.prenom</ScriptBlock>\r\n                            </TableColumnItem>\r\n                            <TableColumnItem>\r\n                                <ScriptBlock>Get-Date $_.Identite.DateNaissance -UFormat %d/%m/%Y </ScriptBlock>\r\n                            </TableColumnItem>\r\n                            <TableColumnItem>\r\n                                <ScriptBlock>$_.Identite.LieuNaissance</ScriptBlock>\r\n                            </TableColumnItem>\r\n                            <TableColumnItem>\r\n                                <ScriptBlock>$_.Identite.Profession</ScriptBlock>\r\n                            </TableColumnItem>\r\n                            <TableColumnItem>\r\n                                <ScriptBlock>$_.autresmandats.count</ScriptBlock>\r\n                            </TableColumnItem>\r\n                        </TableColumnItems>\r\n                    </TableRowEntry>\r\n                </TableRowEntries>\r\n            </TableControl>\r\n        </View>\r\n        <View>\r\n            <Name>Depute</Name>\r\n            <ViewSelectedBy>\r\n                <SelectionSetName>DeputeTypes</SelectionSetName>\r\n            </ViewSelectedBy>\r\n            \r\n            <ListControl>\r\n                <ListEntries>\r\n                     <ListEntry>\r\n                        <ListItems>\r\n                            <ListItem>\r\n                                <PropertyName>Id</PropertyName>\r\n                            </ListItem>\r\n                        </ListItems>\r\n                    </ListEntry>\r\n                    <ListEntry>\r\n                        <EntrySelectedBy>\r\n                            <TypeName>Depute</TypeName>\r\n                        </EntrySelectedBy>\r\n                        <ListItems>\r\n                            <ListItem>\r\n                                <PropertyName>id</PropertyName>\r\n                            </ListItem>\r\n                            <ListItem>\r\n                                <PropertyName>nom</PropertyName>\r\n                            </ListItem>\r\n                        </ListItems>\r\n                    </ListEntry>\r\n                </ListEntries>\r\n            </ListControl>\r\n        </View>\r\n    </ViewDefinitions>\r\n</Configuration>\r\n\r\n```",
  "closed_at": "2018-05-26T00:25:12Z",
  "comments": [
    {
      "author": "Stephanevg",
      "author_association": "NONE",
      "body": "I actually got it to work using a Type.ps1xml\r\n\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"utf-8\" ?>\r\n<Types>\r\n  <Type>\r\n    <Name>Depute</Name>\r\n    <Members>\r\n\r\n      <ScriptProperty>\r\n        <Name>Groupe</Name>\r\n        <GetScriptBlock>\r\n          $this.IdentitePolitique.Groupe\r\n        </GetScriptBlock>\r\n      </ScriptProperty>\r\n      <ScriptProperty>\r\n        <Name>NomCirconscription</Name>\r\n        <GetScriptBlock>\r\n          $this.IdentitePolitique.NomCirconscription\r\n        </GetScriptBlock>\r\n      </ScriptProperty>\r\n      <ScriptProperty>\r\n        <Name>PlaceHemicylce</Name>\r\n        <GetScriptBlock>\r\n          $this.IdentitePolitique.PlaceHemicylce\r\n        </GetScriptBlock>\r\n      </ScriptProperty>\r\n      <ScriptProperty>\r\n        <Name>Collaborateurs</Name>\r\n        <GetScriptBlock>\r\n          $this.IdentitePolitique.Collaborateurs\r\n        </GetScriptBlock>\r\n      </ScriptProperty>\r\n\r\n    <ScriptProperty>\r\n        <Name>Twitter</Name>\r\n        <GetScriptBlock>\r\n          $this.contact.twitter\r\n        </GetScriptBlock>\r\n      </ScriptProperty>\r\n\r\n      <ScriptProperty>\r\n        <Name>Email</Name>\r\n        <GetScriptBlock>\r\n          $this.contact.Email\r\n        </GetScriptBlock>\r\n      </ScriptProperty>\r\n\r\n      <ScriptProperty>\r\n        <Name>Siteweb</Name>\r\n        <GetScriptBlock>\r\n          $this.contact.Siteweb\r\n        </GetScriptBlock>\r\n      </ScriptProperty>\r\n\r\n    <ScriptProperty>\r\n        <Name>NombreAutreMandats</Name>\r\n        <GetScriptBlock>\r\n          $this.autresmandats.count\r\n        </GetScriptBlock>\r\n      </ScriptProperty>\r\n\r\n    </Members>\r\n  </Type>\r\n</Types>\r\n```\r\n\r\nResulted in:\r\n\r\n![image](https://user-images.githubusercontent.com/6302961/40570520-ff91b18c-608b-11e8-9687-5dc31a973c56.png)\r\n",
      "created_at": "2018-05-26T00:25:12Z",
      "updated_at": "2018-05-26T00:25:12Z"
    }
  ],
  "created_at": "2018-05-26T00:00:00Z",
  "number": 6940,
  "state": "closed",
  "title": "Calculated properties in Listentries of Format.ps1xml?",
  "updated_at": "2018-05-26T00:25:12Z"
}
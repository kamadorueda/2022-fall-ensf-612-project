{
  "_url": "https://github.com/PowerShell/PowerShell/issues/6123",
  "author": "SteveL-MSFT",
  "body": "## PR Summary\r\n\r\nWhile investigating https://github.com/PowerShell/PowerShell/issues/1752 it was inconvenient to not be able to just do a `dir` and find the code signing cert.  And when `set-authenticodesignature` failed, `Status` just showed `UnknownError` and the real useful property was `StatusMessage`.\r\n\r\nFix is to expose `EnhancedKeyUsageList` in the table view for X509Certificate and `StatusMessage` for cert Signature types.\r\n\r\nAlso fixed an incorrect casing of `Thumbprint`.\r\n\r\nSet width of `Subject` to 20, so that more of the `EnhancedKeyUsageList` can show up as I find that more useful when finding a cert.  Using script to just show `FriendlyName` of `EnhancedKeyUsageList`.\r\n\r\n```none\r\nThumbprint                                Subject              EnhancedKeyUsageList\r\n----------                                -------              --------------------\r\nFBC22CDCE5C3883FE36674993ED003C8438C0A79  CN=testcert.steve    Code Signing\r\n9552B870CF7AB1D0506BC7E3EA89BC8A279E0723  CN=testcert.steve    {Client Authentication, Server Authentication}\r\n```\r\n\r\nThe change to `Signature` (used as output type for `Set-AuthenticodeSignature` now looks like:\r\n\r\n```none\r\nPS C:\\Users\\steve\\test> Set-AuthenticodeSignature -Certificate $cert -FilePath .\\test.ps1 -TimestampServer http://sha256ti\r\nmestamp.ws.symantec.com/sha256/timestamp\r\n\r\n\r\n    Directory: C:\\Users\\steve\\test\r\n\r\n\r\nSignerCertificate                         Status                     StatusMessage              Path\r\n-----------------                         ------                     -------------              ----\r\n                                          UnknownError               ASN1 bad tag value met     test.ps1\r\n```\r\n\r\n## PR Checklist\r\n\r\nNote: Please mark anything not applicable to this PR `NA`.\r\n\r\n- [X] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - [X] Use the present tense and imperative mood when describing your changes\r\n- [X] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [NA] User facing [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - [ ] Issue filed - Issue link:\r\n- [X] [Change is not breaking](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)\r\n- [NA] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n    - [ ] [Add `[feature]` if the change is significant or affects feature tests](https://github.com/PowerShell/PowerShell/blob/master/docs/testing-guidelines/testing-guidelines.md#requesting-additional-tests-for-a-pr)\r\n- [X] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - If the PR is work in progress, please add the prefix `WIP:` to the beginning of the title and remove the prefix when the PR is ready.\r\n",
  "closed_at": "2018-02-07T23:29:48Z",
  "comments": [
    {
      "author": "PaulHigin",
      "author_association": "COLLABORATOR",
      "body": "BTW we should consider porting this change to Windows PowerShell",
      "created_at": "2018-02-07T17:40:56Z",
      "updated_at": "2018-02-07T17:40:56Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "Should we consider this for the next `6.0.x` since we are considering backporting?\r\n",
      "created_at": "2018-02-07T22:47:07Z",
      "updated_at": "2018-02-07T22:47:07Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Is servicing releases for bug and security fixes only?",
      "created_at": "2018-02-08T03:27:06Z",
      "updated_at": "2018-02-08T03:27:06Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@iSazonov servicing releases are only for major blockers and security fixes",
      "created_at": "2018-02-09T22:19:41Z",
      "updated_at": "2018-02-09T22:19:41Z"
    }
  ],
  "created_at": "2018-02-07T01:03:59Z",
  "number": 6123,
  "state": "closed",
  "title": "Improve table view for Certs and Signatures by adding EnhancedKeyUsageList and StatusMessage",
  "updated_at": "2018-02-09T22:19:41Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/5930",
  "author": "kvprasoon",
  "body": "\r\nSteps to reproduce\r\n------------------\r\n\r\n```\r\nGet-Command -foo\r\n\r\n```\r\n\r\nExpected behavior\r\n-----------------\r\n\r\n```\r\nGet-Command : A parameter cannot be found that matches parameter name 'foo'.\r\nAt line:1 char:10\r\n+ get-help -foo\r\n+          ~~~~\r\n+ CategoryInfo          : InvalidArgument: (:) [Get-Command], ParameterBindingException\r\n+ FullyQualifiedErrorId : NamedParameterNotFound,Microsoft.PowerShell.Commands.GetCommand\r\n\r\n```\r\n\r\nActual behavior\r\n---------------\r\n\r\n```\r\nit just executes and all the commands are displayed\r\n\r\n```\r\n\r\nEnvironment data\r\n----------------\r\n\r\n\r\n\r\n```\r\n> $PSVersionTable\r\n\r\nName                           Value                                                                                                                                                                                                         \r\n----                           -----                                                                                                                                                                                                         \r\nPSVersion                      6.0.0                                                                                                                                                                                                         \r\nPSEdition                      Core                                                                                                                                                                                                          \r\nGitCommitId                    v6.0.0                                                                                                                                                                                                        \r\nOS                             Microsoft Windows 10.0.10586                                                                                                                                                                                  \r\nPlatform                       Win32NT                                                                                                                                                                                                       \r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}                                                                                                                                                                                       \r\nPSRemotingProtocolVersion      2.3                                                                                                                                                                                                           \r\nSerializationVersion           1.1.0.1                                                                                                                                                                                                       \r\nWSManStackVersion              3.0                                                                                                                                                                                                           \r\n\r\n\r\n\r\n```\r\n\r\nSame is the case for\r\n```\r\nJoin-Path\r\nOut-Null\r\nTrace-Command\r\n```",
  "closed_at": null,
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Looks like by-design. @SteveL-MSFT @mklement0 Thoughts?",
      "created_at": "2020-02-01T19:21:40Z",
      "updated_at": "2020-02-01T19:21:40Z"
    },
    {
      "author": "mklement0",
      "author_association": "CONTRIBUTOR",
      "body": "tl;dr:\r\n\r\nThe behavior is certainly surprising and only partially explained by the design intent.\r\nIt looks like there are issues worth addressing.\r\n\r\n---\r\n\r\nThe technical background is that `Get-Command` has a `ValueFromRemainingArguments` `-ArgumentList` parameter whose purpose is to allow you to specify sample arguments _through to the command being investigated_, so as to surface the _dynamic parameters_ that the _provider implied by the sample arguments_ adds to the command of interest:\r\n\r\nThat is, your invocation is equivalent to:\r\n\r\n```powershell\r\nGet-Command -ArgumentList '-Foo'\r\n```\r\n\r\nA meaningful example would be:\r\n\r\n```powershell\r\n# List Get-Item's parameters with the certificate provider's dynamic parameters,\r\n# such as -ExpiringInDays\r\nGet-Command -Syntax Get-Item -ArgumentList '-Path', 'cert:'\r\n\r\n# Or, more simply:\r\nGet-Command -Syntax Get-Item -Path cert:\r\n```\r\n\r\nSeemingly, such pass-through arguments are _quietly ignored_ for _non-provider_ cmdlets:\r\n\r\n```powershell\r\n# !! Since Get-Date has no -Foo switch (and isn't a provider cmdlet), -Foo is quietly ignored.\r\nPS> Get-Command Get-Date -Foo\r\n# same output as with Get-Command Get-Date\r\n```\r\n\r\nFor provider cmdlets whose name is matched _literally_, the pass-through parameters are not only respected, but also _validated_:\r\n\r\n```powershell\r\n# Since provider cmdlet Get-Item has no -Foo switch, this causes an error.\r\nPS> Get-Command Get-Item -Foo\r\nGet-Command : A parameter cannot be found that matches parameter name 'Foo'.\r\n```\r\n\r\nNote that the error message confusingly complains about _Get-Command_ not having a `-Foo` parameter.\r\n\r\nHowever, if the name is matched _by wildcard expression_ (as seemingly implicitly happens in the `Get-Command -Foo` case; like an implied `-Name *`), the pass-through parameters are seemingly  _mostly_ ignored for _all_ matching commands, including the provider ones:\r\n\r\n```powershell\r\nPS> Get-Command Get-[IC][to]* -Foo\r\n# mostly normal output\r\n```\r\n\r\nHowever, in my case the presence of `-Foo` caused a few custom functions (that do not have a `-Foo` parameter) to inexplicably _not_ be included.\r\n\r\nMore importantly, if you add `-Syntax` to the above, you'll see that errors seemingly occurred _internally_, because the _provider cmdlets_  then show _no parameters_ in their syntax diagrams:\r\n\r\n```powershell\r\nPS> Get-Command -Syntax Get-[IC][to]* -Foo\r\n# !! provider cmdlets show no parameters\r\n```\r\n",
      "created_at": "2020-02-01T20:08:53Z",
      "updated_at": "2020-02-01T20:57:48Z"
    }
  ],
  "created_at": "2018-01-17T19:31:25Z",
  "labels": [
    "Issue-Question",
    "WG-Engine"
  ],
  "number": 5930,
  "state": "open",
  "title": "No error is thrown for Invalid parameter",
  "updated_at": "2020-02-01T20:57:48Z"
}
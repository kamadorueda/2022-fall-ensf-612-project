{
  "_url": "https://github.com/PowerShell/PowerShell/issues/13563",
  "author": "BinaryWizard904",
  "body": "If you pipe the output of ``Get-Member`` to ``more``, the ellipsis used to indicate truncation becomes garbled and is not rendered properly.  Specifically, \"\u2026\" becomes \"\u0393\u00c7\u00aa\".\r\n\r\n## Steps to reproduce\r\nRun the following command in PowerShell v7.0.0+\r\n``Get-Process | Get-Member | more``\r\n\r\n## Expected behavior\r\nExpected behavior (sans pagination) can be seen by running ``Get-Process | Get-Member``.\r\n```\r\n   TypeName: System.Diagnostics.Process\r\n\r\nName                       MemberType     Definition\r\n----                       ----------     ----------\r\nHandles                    AliasProperty  Handles = Handlecount\r\nName                       AliasProperty  Name = ProcessName\r\nNPM                        AliasProperty  NPM = NonpagedSystemMemorySize64\r\nPM                         AliasProperty  PM = PagedMemorySize64\r\nSI                         AliasProperty  SI = SessionId\r\nVM                         AliasProperty  VM = VirtualMemorySize64\r\nWS                         AliasProperty  WS = WorkingSet64\r\nParent                     CodeProperty   System.Object Parent{get=GetParentProcess;}\r\nDisposed                   Event          System.EventHandler Disposed(System.Object, System.EventArgs)\r\nErrorDataReceived          Event          System.Diagnostics.DataReceivedEventHandler ErrorDataReceived(Syst\u2026\r\nExited                     Event          System.EventHandler Exited(System.Object, System.EventArgs)\r\nOutputDataReceived         Event          System.Diagnostics.DataReceivedEventHandler OutputDataReceived(Sys\u2026\r\nBeginErrorReadLine         Method         void BeginErrorReadLine()\r\nBeginOutputReadLine        Method         void BeginOutputReadLine()\r\nCancelErrorRead            Method         void CancelErrorRead()\r\nCancelOutputRead           Method         void CancelOutputRead()\r\n-- More  --\r\n```\r\n\r\n## Actual behavior\r\nNote the rightmost characters in the definitions of ErrorDataReceived and OutputDataReceived.\r\n```\r\n   TypeName: System.Diagnostics.Process\r\n\r\nName                       MemberType     Definition\r\n----                       ----------     ----------\r\nHandles                    AliasProperty  Handles = Handlecount\r\nName                       AliasProperty  Name = ProcessName\r\nNPM                        AliasProperty  NPM = NonpagedSystemMemorySize64\r\nPM                         AliasProperty  PM = PagedMemorySize64\r\nSI                         AliasProperty  SI = SessionId\r\nVM                         AliasProperty  VM = VirtualMemorySize64\r\nWS                         AliasProperty  WS = WorkingSet64\r\nParent                     CodeProperty   System.Object Parent{get=GetParentProcess;}\r\nDisposed                   Event          System.EventHandler Disposed(System.Object, System.EventArgs)\r\nErrorDataReceived          Event          System.Diagnostics.DataReceivedEventHandler ErrorDataReceived(Syste\u0393\u00c7\u00aa\r\nExited                     Event          System.EventHandler Exited(System.Object, System.EventArgs)\r\nOutputDataReceived         Event          System.Diagnostics.DataReceivedEventHandler OutputDataReceived(Syst\u0393\u00c7\u00aa\r\nBeginErrorReadLine         Method         void BeginErrorReadLine()\r\nBeginOutputReadLine        Method         void BeginOutputReadLine()\r\nCancelErrorRead            Method         void CancelErrorRead()\r\nCancelOutputRead           Method         void CancelOutputRead()\r\n-- More  --\r\n```\r\n\r\n## Environment data\r\n```\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.0.3\r\nPSEdition                      Core\r\nGitCommitId                    7.0.3\r\nOS                             Microsoft Windows 10.0.18363\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\nAdditionally, I was able to reproduce the issue on:\r\n```\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.0.0\r\nPSEdition                      Core\r\nGitCommitId                    7.0.0\r\nOS                             Microsoft Windows 6.2.9200\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0.}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```",
  "closed_at": "2020-09-04T00:00:15Z",
  "comments": [
    {
      "author": "mklement0",
      "author_association": "CONTRIBUTOR",
      "body": "Unfortunately, `more.com` (which Windows PowerShell wraps in a `more` _function_) is a legacy console application that fundamentally does not support Unicode, only the legacy OEM code pages.\r\n\r\nThus, any characters outside the active OEM code page (run `chcp`) - such as `\u2026` (HORIZONTAL ELLIPSIS, [`U+2026`](http://www.fileformat.info/info/unicode/char/2026)) - cannot be represented by `more.com`.\r\n\r\nIn the case of PowerShell Core, where `$OutputEncoding` now defaults to UTF-8, PowerShell sends UTF-8 bytes (3, in this case), which `more.com` then interprets as individual OEM characters, resulting in the symptom you're seeing:\r\n\r\n```powershell\r\n# [char] 0x2026 is '\u2026'\r\nPSCore> [char] 0x2026 | more\r\n\u0393\u00c7\u00aa\r\n```\r\n\r\nThe only workaround I know of is to use a modern pager application, which you can configure by assigning its path to `$env:PAGER` - see [this SO answer](https://stackoverflow.com/a/59240939/45375) for options.\r\n",
      "created_at": "2020-09-02T19:44:25Z",
      "updated_at": "2020-09-04T00:15:09Z"
    },
    {
      "author": "msftbot[bot]",
      "author_association": "NONE",
      "body": "This issue has been marked as answered and has not had any activity for **1 day**. It has been closed for housekeeping purposes.",
      "created_at": "2020-09-04T00:00:13Z",
      "updated_at": "2020-09-04T00:00:13Z"
    }
  ],
  "created_at": "2020-09-02T17:32:17Z",
  "number": 13563,
  "state": "closed",
  "title": "Text encoding mismatch when 'Get-Member' output is piped to 'more'",
  "updated_at": "2020-09-04T00:15:09Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/10137",
  "author": "iSazonov",
  "body": "## Summary of the new feature/enhancement\r\n\r\nNeed discuss before pulling RFC and find most appropriate form.\r\n\r\nToday we have the ability to describe parameters and parameter sets in cmdlets using attributes `Parameter(ParameterSetName = \"name\")`. \r\nThis works well for small and simple parameter sets.\r\n\r\n_In the case of the definition of more complex variants, this turns into a puzzle._\r\n\r\n## Proposed technical implementation details\r\nNotation http://docopt.org/\r\nFor reference https://docs.python.org/2/howto/argparse.html\r\n\r\n```\r\n[-Param1 [-OptionalParam11 | -OptionalParam12] | -Param2]\r\n(-Param1 -ParamMandatoryforParam1 [-OptionalParam11 | -OptionalParam12] | -Param2)\r\n```\r\nInitial sample based on Test-Connection cmdlet:\r\n\r\n```c#\r\n    [Cmdlet(VerbsDiagnostic.Test, \"Connection\", DefaultParameterSetName = ParameterSetPingCount, HelpUri = \"https://go.microsoft.com/fwlink/?LinkID=135266\")]\r\n    [OutputType(typeof(PingReport), ParameterSetName = new string[] { ParameterSetPingCount })]\r\n    [OutputType(typeof(PingReply), ParameterSetName = new string[] { ParameterSetPingContinues, ParameterSetDetectionOfMTUSize })]\r\n    [OutputType(typeof(bool), ParameterSetName = new string[] { ParameterSetPingCount, ParameterSetPingContinues, ParameterSetConnectionByTCPPort })]\r\n    [OutputType(typeof(Int32), ParameterSetName = new string[] { ParameterSetDetectionOfMTUSize })]\r\n    [OutputType(typeof(TraceRouteReply), ParameterSetName = new string[] { ParameterSetTraceRoute })]\r\n    [ParameterSet(\r\n        Name = ParameterSetPingCount,     // Optional\r\n        Positional(nameof(TargetName), nameof(Count)),\r\n        ParameterList(\r\n            Parameter(Name = nameof(Ping)),\r\n            MutuallyExclusiveGroup(\r\n                nameof(IPv4),   // First is default\r\n                nameof(IPv6),\r\n                Parameter(nameof(IPv7),\r\n                    MutuallyExclusiveGroup(\r\n                        nameof(ParForIPv7_A),\r\n                        nameof(ParForIPv7_B)\r\n                    )\r\n                )\r\n            ),\r\n            nameof(ResolveDestination),\r\n            nameof(Source),\r\n            nameof(MaxHops),\r\n            nameof(Count),\r\n            nameof(Delay),\r\n            nameof(BufferSize),\r\n            nameof(DontFragment),\r\n            nameof(Quiet),\r\n            nameof(TimeoutSeconds),\r\n            Parameter(Name = nameof(TargetName), Mandatory = true)\r\n        )\r\n    )]\r\n    [ParameterSet(\r\n        Name = ParameterSetPingContinues,\r\n        Parameters(\r\n            Parameter(Name = nameof(Ping)),\r\n            MutuallyExclusiveGroup(\r\n                nameof(IPv4),\r\n                nameof(IPv6)\r\n            ),\r\n            nameof(ResolveDestination),\r\n            nameof(Source),\r\n            nameof(MaxHops),\r\n            Parameter(Name = nameof(Continues), Mandatory = true,\r\n            nameof(Delay),\r\n            nameof(BufferSize),\r\n            nameof(DontFragment),\r\n            nameof(Quiet),\r\n            nameof(TimeoutSeconds),\r\n            Parameter(Name = nameof(TargetName), Mandatory = true)\r\n        )\r\n    )]\r\n    [ParameterSet(\r\n        Name = TraceRoute,\r\n        Parameters(\r\n            Parameter(Name = nameof(Traceroute), Mandatory = true),\r\n            MutuallyExclusiveGroup(\r\n                nameof(IPv4),\r\n                nameof(IPv6)\r\n            ),\r\n            nameof(ResolveDestination),\r\n            nameof(Source),\r\n            nameof(MaxHops),\r\n            nameof(Quiet),\r\n            nameof(TimeoutSeconds),\r\n            Parameter(Name = nameof(TargetName), Mandatory = true)\r\n        )\r\n    )]\r\n    public class TestConnectionCommand : PSCmdlet\r\n    {\r\n```",
  "closed_at": "2022-04-16T19:07:48Z",
  "comments": [],
  "created_at": "2019-07-12T09:49:43Z",
  "labels": [
    "Issue-Enhancement",
    "WG-Engine"
  ],
  "number": 10137,
  "state": "closed",
  "title": "Enhance ParameterSet defintion capabilities",
  "updated_at": "2022-04-16T19:07:48Z"
}
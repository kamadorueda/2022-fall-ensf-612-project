{
  "_url": "https://github.com/PowerShell/PowerShell/issues/3086",
  "author": "Francisco-Gamino",
  "body": "Addressing issue #1846 'Consider cross-gen of additional binaries'\r\n\r\nEnabling crossgen for the assemblies used by Add-Type. These are Microsoft.CodeAnalysis.CSharp.dll, Microsoft.CodeAnalysis.dll, Microsoft.CodeAnalysis.VisualBasic.dll, and Microsoft.CSharp.dll. By doing this, executing Add-Type goes from ~2.1 to 0.9 seconds.\r\n\r\n// Before crossgen \r\n``` \r\nPS C:\\windows\\system32> Measure-Command {\r\n     $Source = @\"\r\n public class BasicTest\r\n {\r\n   public static int Add(int a, int b)\r\n     {\r\n         return (a + b);\r\n     }\r\n   public int Multiply(int a, int b)\r\n     {\r\n     return (a * b);\r\n     }\r\n }\r\n \"@\r\n     Add-Type -TypeDefinition $Source\r\n     [BasicTest]::Add(4, 3)\r\n }\r\n\r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 2\r\nMilliseconds      : 9\r\nTicks             : 20091903\r\nTotalDays         : 2.32545173611111E-05\r\nTotalHours        : 0.000558108416666667\r\nTotalMinutes      : 0.033486505\r\nTotalSeconds      : 2.0091903\r\nTotalMilliseconds : 2009.1903\r\n``` \r\n\r\n// After crossgen\r\n``` \r\nPS C:\\windows\\system32> Measure-Command {\r\n     $Source = @\"\r\n public class BasicTest\r\n {\r\n   public static int Add(int a, int b)\r\n     {\r\n         return (a + b);\r\n     }\r\n   public int Multiply(int a, int b)\r\n     {\r\n     return (a * b);\r\n     }\r\n }\r\n \"@\r\n     Add-Type -TypeDefinition $Source\r\n     [BasicTest]::Add(4, 3)\r\n }\r\n\r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 0\r\nMilliseconds      : 888\r\nTicks             : 8883578\r\nTotalDays         : 1.02819189814815E-05\r\nTotalHours        : 0.000246766055555556\r\nTotalMinutes      : 0.0148059633333333\r\nTotalSeconds      : 0.8883578\r\nTotalMilliseconds : 888.3578\r\n```\r\n",
  "closed_at": "2017-02-03T23:19:05Z",
  "comments": [
    {
      "author": "Francisco-Gamino",
      "author_association": "CONTRIBUTOR",
      "body": "@daxian-dbw : Could you please take another look? Thanks.",
      "created_at": "2017-02-03T18:37:14Z",
      "updated_at": "2017-02-03T18:37:14Z"
    }
  ],
  "created_at": "2017-02-02T23:36:42Z",
  "number": 3086,
  "state": "closed",
  "title": "Enabling crossgen for the assemblies used by Add-Type",
  "updated_at": "2017-03-27T06:06:39Z"
}
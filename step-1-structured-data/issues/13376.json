{
  "_url": "https://github.com/PowerShell/PowerShell/issues/13376",
  "author": "Ghufz",
  "body": "<!--\r\n\r\nFor Windows PowerShell 5.1 issues, suggestions, or feature requests please use the following link instead:\r\nWindows PowerShell [UserVoice](https://windowsserver.uservoice.com/forums/301869-powershell)\r\n\r\nThis repository is **ONLY** for PowerShell Core 6 and PowerShell 7+ issues.\r\n\r\n- Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\r\n- Search the existing issues.\r\n- Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\r\n- Refer to the [known issues](https://docs.microsoft.com/powershell/scripting/whats-new/known-issues-ps6).\r\n\r\n-->\r\n\r\nWhen New-ModuleManifest cmdlets is used with the parameter PrivateData it generats the invalid PSData property in the .psd1 file. \r\nthe value provided for  PrivateData id of type hashtable\r\n\r\n```powershell\r\nPS C:\\> $Manifest.PrivateData.Gettype()\r\n\r\n\r\nIsPublic IsSerial Name                                     BaseType\r\n-------- -------- ----                                     --------\r\nTrue     True     Hashtable                                System.Object\r\n``` \r\n\r\n## Steps to reproduce\r\n\r\n```powershell\r\n#generate the .psd1 file with below snippet \r\n$Manifest = @{\r\n    Path = \".\\TestModule.psd1\"\r\n\r\n    Author = 'Confidential'\r\n    CompanyName = 'Confidential'\r\n    Description = 'The PowerShell module for xyz'\r\n\r\n    PrivateData = @{\r\n        PSData = @{\r\n            LicenseUri = 'https://www.apache.org/licenses/LICENSE-2.0.txt'\r\n        }\r\n    }\r\n\r\n    ModuleVersion = '1.0.0'\r\n\r\n    RootModule = 'TestModule.psm1'\r\n    Guid = '91e7c83e-351c-4def-95ea-a7cb20890fa0' \r\n\r\n    PowerShellVersion = '6.2'\r\n\r\n    FunctionsToExport = @()\r\n\r\n    VariablesToExport = @()\r\n    AliasesToExport = @()\r\n    CmdletsToExport = @()\r\n\r\n}\r\n\r\nNew-ModuleManifest @Manifest\r\n```\r\nThe generator module manifest file contains the PSData with invalid value\r\n\r\n\r\n## Expected behavior\r\n\r\n```powershell\r\n#the generated .psd1 file should be as below \r\n#\r\n# Module manifest for module 'TestModule'\r\n#\r\n# Generated by: Confidential\r\n#\r\n# Generated on: 07-08-2020\r\n#\r\n\r\n@{\r\n\r\n# Script module or binary module file associated with this manifest.\r\nRootModule = 'TestModule.psm1'\r\n\r\n# Version number of this module.\r\nModuleVersion = '1.0.0'\r\n\r\n# Supported PSEditions\r\n# CompatiblePSEditions = @()\r\n\r\n# ID used to uniquely identify this module\r\nGUID = '91e7c83e-351c-4def-95ea-a7cb20890fa0'\r\n\r\n# Author of this module\r\nAuthor = 'Confidential'\r\n\r\n# Company or vendor of this module\r\nCompanyName = 'Confidential'\r\n\r\n# Copyright statement for this module\r\nCopyright = '(c) Confidential. All rights reserved.'\r\n\r\n# Description of the functionality provided by this module\r\nDescription = 'The PowerShell module for xyz'\r\n\r\n# Minimum version of the PowerShell engine required by this module\r\nPowerShellVersion = '6.2'\r\n\r\n# Name of the PowerShell host required by this module\r\n# PowerShellHostName = ''\r\n\r\n# Minimum version of the PowerShell host required by this module\r\n# PowerShellHostVersion = ''\r\n\r\n# Minimum version of Microsoft .NET Framework required by this module. This prerequisite is valid for the PowerShell Desktop edition only.\r\n# DotNetFrameworkVersion = ''\r\n\r\n# Minimum version of the common language runtime (CLR) required by this module. This prerequisite is valid for the PowerShell Desktop edition only.\r\n# CLRVersion = ''\r\n\r\n# Processor architecture (None, X86, Amd64) required by this module\r\n# ProcessorArchitecture = ''\r\n\r\n# Modules that must be imported into the global environment prior to importing this module\r\n# RequiredModules = @()\r\n\r\n# Assemblies that must be loaded prior to importing this module\r\n# RequiredAssemblies = @()\r\n\r\n# Script files (.ps1) that are run in the caller's environment prior to importing this module.\r\n# ScriptsToProcess = @()\r\n\r\n# Type files (.ps1xml) to be loaded when importing this module\r\n# TypesToProcess = @()\r\n\r\n# Format files (.ps1xml) to be loaded when importing this module\r\n# FormatsToProcess = @()\r\n\r\n# Modules to import as nested modules of the module specified in RootModule/ModuleToProcess\r\n# NestedModules = @()\r\n\r\n# Functions to export from this module, for best performance, do not use wildcards and do not delete the entry, use an empty array if there are no functions to export.\r\nFunctionsToExport = @()\r\n\r\n# Cmdlets to export from this module, for best performance, do not use wildcards and do not delete the entry, use an empty array if there are no cmdlets to export.\r\nCmdletsToExport = @()\r\n\r\n# Variables to export from this module\r\n# VariablesToExport = @()\r\n\r\n# Aliases to export from this module, for best performance, do not use wildcards and do not delete the entry, use an empty array if there are no aliases to export.\r\nAliasesToExport = @()\r\n\r\n# DSC resources to export from this module\r\n# DscResourcesToExport = @()\r\n\r\n# List of all modules packaged with this module\r\n# ModuleList = @()\r\n\r\n# List of all files packaged with this module\r\n# FileList = @()\r\n\r\n# Private data to pass to the module specified in RootModule/ModuleToProcess. This may also contain a PSData hashtable with additional module metadata used by PowerShell.\r\nPrivateData = @{\r\n\r\n    PSData = @{\r\n\r\n        # Tags applied to this module. These help with module discovery in online galleries.\r\n        # Tags = @()\r\n\r\n        # A URL to the license for this module.\r\n         LicenseUri = 'https://www.apache.org/licenses/LICENSE-2.0.txt'\r\n\r\n        # A URL to the main website for this project.\r\n        # ProjectUri = ''\r\n\r\n        # A URL to an icon representing this module.\r\n        # IconUri = ''\r\n\r\n        # ReleaseNotes of this module\r\n        # ReleaseNotes = ''\r\n\r\n        # Prerelease string of this module\r\n        # Prerelease = ''\r\n\r\n        # Flag to indicate whether the module requires explicit user acceptance for install/update/save\r\n        # RequireLicenseAcceptance = $false\r\n\r\n        # External dependent modules of this module\r\n        # ExternalModuleDependencies = @()\r\n\r\n    } # End of PSData hashtable\r\n\r\n} # End of PrivateData hashtable\r\n\r\n# HelpInfo URI of this module\r\n# HelpInfoURI = ''\r\n\r\n# Default prefix for commands exported from this module. Override the default prefix using Import-Module -Prefix.\r\n# DefaultCommandPrefix = ''\r\n\r\n}\r\n\r\n\r\n```\r\n\r\n## Actual behavior\r\n#The generated .psd1 file contains the invalid value as below\r\n```powershell\r\n   # PSData\r\n    PSData = 'System.Collections.Hashtable'\r\n```\r\n#============== generated file .psd1 ==============================\r\n\r\n```powershell\r\n#\r\n# Module manifest for module 'TestModule'\r\n#\r\n# Generated by: Confidential\r\n#\r\n# Generated on: 07-08-2020\r\n#\r\n\r\n@{\r\n\r\n# Script module or binary module file associated with this manifest.\r\nRootModule = 'TestModule.psm1'\r\n\r\n# Version number of this module.\r\nModuleVersion = '1.0.0'\r\n\r\n# Supported PSEditions\r\n# CompatiblePSEditions = @()\r\n\r\n# ID used to uniquely identify this module\r\nGUID = '91e7c83e-351c-4def-95ea-a7cb20890fa0'\r\n\r\n# Author of this module\r\nAuthor = 'Confidential'\r\n\r\n# Company or vendor of this module\r\nCompanyName = 'Confidential'\r\n\r\n# Copyright statement for this module\r\nCopyright = '(c) Confidential. All rights reserved.'\r\n\r\n# Description of the functionality provided by this module\r\nDescription = 'The PowerShell module for xyz'\r\n\r\n# Minimum version of the PowerShell engine required by this module\r\nPowerShellVersion = '6.2'\r\n\r\n# Name of the PowerShell host required by this module\r\n# PowerShellHostName = ''\r\n\r\n# Minimum version of the PowerShell host required by this module\r\n# PowerShellHostVersion = ''\r\n\r\n# Minimum version of Microsoft .NET Framework required by this module. This prerequisite is valid for the PowerShell Desktop edition only.\r\n# DotNetFrameworkVersion = ''\r\n\r\n# Minimum version of the common language runtime (CLR) required by this module. This prerequisite is valid for the PowerShell Desktop edition only.\r\n# CLRVersion = ''\r\n\r\n# Processor architecture (None, X86, Amd64) required by this module\r\n# ProcessorArchitecture = ''\r\n\r\n# Modules that must be imported into the global environment prior to importing this module\r\n# RequiredModules = @()\r\n\r\n# Assemblies that must be loaded prior to importing this module\r\n# RequiredAssemblies = @()\r\n\r\n# Script files (.ps1) that are run in the caller's environment prior to importing this module.\r\n# ScriptsToProcess = @()\r\n\r\n# Type files (.ps1xml) to be loaded when importing this module\r\n# TypesToProcess = @()\r\n\r\n# Format files (.ps1xml) to be loaded when importing this module\r\n# FormatsToProcess = @()\r\n\r\n# Modules to import as nested modules of the module specified in RootModule/ModuleToProcess\r\n# NestedModules = @()\r\n\r\n# Functions to export from this module, for best performance, do not use wildcards and do not delete the entry, use an empty array if there are no functions to export.\r\nFunctionsToExport = @()\r\n\r\n# Cmdlets to export from this module, for best performance, do not use wildcards and do not delete the entry, use an empty array if there are no cmdlets to export.\r\nCmdletsToExport = @()\r\n\r\n# Variables to export from this module\r\n# VariablesToExport = @()\r\n\r\n# Aliases to export from this module, for best performance, do not use wildcards and do not delete the entry, use an empty array if there are no aliases to export.\r\nAliasesToExport = @()\r\n\r\n# DSC resources to export from this module\r\n# DscResourcesToExport = @()\r\n\r\n# List of all modules packaged with this module\r\n# ModuleList = @()\r\n\r\n# List of all files packaged with this module\r\n# FileList = @()\r\n\r\n# Private data to pass to the module specified in RootModule/ModuleToProcess. This may also contain a PSData hashtable with additional module metadata used by PowerShell.\r\nPrivateData = @{\r\n\r\n    PSData = @{\r\n\r\n        # Tags applied to this module. These help with module discovery in online galleries.\r\n        # Tags = @()\r\n\r\n        # A URL to the license for this module.\r\n        # LicenseUri = ''\r\n\r\n        # A URL to the main website for this project.\r\n        # ProjectUri = ''\r\n\r\n        # A URL to an icon representing this module.\r\n        # IconUri = ''\r\n\r\n        # ReleaseNotes of this module\r\n        # ReleaseNotes = ''\r\n\r\n        # Prerelease string of this module\r\n        # Prerelease = ''\r\n\r\n        # Flag to indicate whether the module requires explicit user acceptance for install/update/save\r\n        # RequireLicenseAcceptance = $false\r\n\r\n        # External dependent modules of this module\r\n        # ExternalModuleDependencies = @()\r\n\r\n    } # End of PSData hashtable\r\n\r\n\r\n    # PSData\r\n    PSData = 'System.Collections.Hashtable'\r\n\r\n} # End of PrivateData hashtable\r\n\r\n# HelpInfo URI of this module\r\n# HelpInfoURI = ''\r\n\r\n# Default prefix for commands exported from this module. Override the default prefix using Import-Module -Prefix.\r\n# DefaultCommandPrefix = ''\r\n\r\n}\r\n```\r\n\r\n## Environment data\r\n\r\n<!-- provide the output of $PSVersionTable -->\r\n\r\n```powershell\r\n#Powershell7 \r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.0.0-rc.2\r\nPSEdition                      Core\r\nGitCommitId                    7.0.0-rc.2\r\nOS                             Microsoft Windows 10.0.17134\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n\r\n\r\n#powershell 6.2\r\n\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      6.2.3\r\nPSEdition                      Core\r\nGitCommitId                    6.2.3\r\nOS                             Microsoft Windows 10.0.17134\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n\r\n\r\n```\r\n",
  "closed_at": null,
  "comments": [],
  "created_at": "2020-08-07T11:34:25Z",
  "number": 13376,
  "state": "open",
  "title": "New-ModuleManifest parameter PrivateData does not work as expected",
  "updated_at": "2020-08-07T16:59:49Z"
}
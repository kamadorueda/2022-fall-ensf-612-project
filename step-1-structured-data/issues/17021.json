{
  "_url": "https://github.com/PowerShell/PowerShell/issues/17021",
  "author": "Create-For-Fun",
  "body": "### Prerequisites\n\n- [X] Write a descriptive title.\n- [X] Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\n- [X] Search the existing issues.\n- [X] Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\n- [X] Refer to [Differences between Windows PowerShell 5.1 and PowerShell](https://docs.microsoft.com/powershell/scripting/whats-new/differences-from-windows-powershell).\n\n### Steps to reproduce\n\nGet-FileHash\r\n   [-InputStream] <Stream>\r\n   [[-Algorithm] <String>]\r\n   [<CommonParameters>]\n\n### Expected behavior\n\n```console\nsteps: - task: DownloadPipelineArtifact@2 inputs: source: specific project: PowerShellCore pipeline: '696' preferTriggeringPipeline: true runVersion: latestFromBranch runBranch: '$(Build.SourceBranch)' artifact: finalResults patterns: '**/*.nupkg' path: '$(Pipeline.Workspace)/releasePipeline/finalResults' - task: DownloadPipelineArtifact@2 inputs: source: specific project: PowerShellCore pipeline: '696' preferTriggeringPipeline: true runVersion: latestFromBranch runBranch: '$(Build.SourceBranch)' artifact: metadata path: '$(Pipeline.Workspace)/releasePipeline/metadata' - pwsh: | #Exclude all global tool packages. Their names start with 'PowerShell.' $null = New-Item -ItemType Directory -Path \"$(Pipeline.Workspace)/release\" Copy-Item \"$ENV:PIPELINE_WORKSPACE/releasePipeline/finalResults/*.nupkg\" -Destination \"$(Pipeline.Workspace)/release\" -Exclude \"PowerShell.*.nupkg\" -Force -Verbose $releaseVersion = Get-Content \"$ENV:PIPELINE_WORKSPACE/releasePipeline/metadata/release.json\" | ConvertFrom-Json | Select-Object -ExpandProperty 'ReleaseVersion' $globalToolPath = \"$ENV:PIPELINE_WORKSPACE/releasePipeline/finalResults/PowerShell.$releaseVersion.nupkg\" if ($releaseVersion -notlike '*-*') { # Copy the global tool package for stable releases Copy-Item $globalToolPath -Destination \"$(Pipeline.Workspace)/release\" } Get-ChildItem \"$(Pipeline.Workspace)/release\" -recurse displayName: Download and capture nupkgs - task: NuGetCommand@2 displayName: 'NuGet push' inputs: command: push packagesToPush: '$(Pipeline.Workspace)/release/*.nupkg' nuGetFeedType: external publishFeedCredentials: PowerShellNuGetOrgPush\n```\n\n\n### Actual behavior\n\n```console\nGet-FileHash /etc/apt/sources.list | Format-List\r\n\r\nAlgorithm : SHA256\r\nHash      : 3CBCFDDEC145E3382D592266BE193E5BE53443138EE6AB6CA09FF20DF609E268\r\nPath      : /etc/apt/sources.list\n```\n\n\n### Error details\n\n```console\nGet-FileHash C:\\Users\\user1\\Downloads\\Contoso8_1_ENT.iso -Algorithm SHA384 | Format-List\r\n\r\nAlgorithm : SHA384\r\nHash      : 20AB1C2EE19FC96A7C66E33917D191A24E3CE9DAC99DB7C786ACCE31E559144FEAFC695C58E508E2EBBC9D3C96F21FA3\r\nPath      : C:\\Users\\user1\\Downloads\\Contoso8_1_ENT.iso\n```\n\n\n### Environment data\n\n```powershell\n$wc = [System.Net.WebClient]::new()\r\n$pkgurl = 'https://github.com/PowerShell/PowerShell/releases/download/v6.2.4/powershell_6.2.4-1.debian.9_amd64.deb'\r\n$publishedHash = '8E28E54D601F0751922DE24632C1E716B4684876255CF82304A9B19E89A9CCAC'\r\n$FileHash = Get-FileHash -InputStream ($wc.OpenRead($pkgurl))\r\n$FileHash.Hash -eq $publishedHash\r\n\r\nTrue\n```\n\n\n### Visuals\n\n$stringAsStream = [System.IO.MemoryStream]::new()\r\n$writer = [System.IO.StreamWriter]::new($stringAsStream)\r\n$writer.write(\"Hello world\")\r\n$writer.Flush()\r\n$stringAsStream.Position = 0\r\nGet-FileHash -InputStream $stringAsStream | Select-Object Hash\r\n\r\nHash\r\n----\r\n64EC88CA00B268E5BA1A35678A1B5316D212F4F366B2477232534A8AECA37F3C",
  "closed_at": "2022-03-18T10:33:04Z",
  "comments": [
    {
      "author": "jhoneill",
      "author_association": "NONE",
      "body": "@PRACH4  you have posted 3 duplicates of this.  But what you show here is Get-FileHash working as designed, and generating the expected hash for a file. \r\n\r\nPlease explain what the command is doing that you believe to be wrong, or what extra functionality you would like to see. \r\n\r\n",
      "created_at": "2022-03-18T09:11:48Z",
      "updated_at": "2022-03-18T09:11:48Z"
    }
  ],
  "created_at": "2022-03-18T05:56:34Z",
  "number": 17021,
  "state": "closed",
  "title": "Get-FileHash",
  "updated_at": "2022-03-18T10:33:07Z"
}
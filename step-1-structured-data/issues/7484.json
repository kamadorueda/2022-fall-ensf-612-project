{
  "_url": "https://github.com/PowerShell/PowerShell/issues/7484",
  "author": "mi-hol",
  "body": "1.  fails to save module (even as root)\r\n2. Misleading \"Warning\" message 'install by adding \"-Scope CurrentUser\" to your command' is displayed that is not a vakid parameter !\r\n3. Misleading \"Warning\" message 'Windows PowerShell session with elevated rights (Run as Administrator)\" that refers to Windows only solution !\r\n\r\nSteps to reproduce\r\n------------------\r\n\r\n```powershell as root\r\nsave-Module -Name ImportExcel -literalPath ~/ImportExcel -v\r\n```\r\n\r\nExpected behavior\r\n-----------------\r\n\r\n```\r\nsave module to specified path\r\n```\r\n\r\nActual behavior\r\n---------------\r\n\r\n```\r\nPS /root> save-Module -Name ImportExcel -literalPath ~ -v\r\nVERBOSE: Acquiring providers for assembly: /opt/microsoft/powershell/6-preview/Modules/PackageManagement/1.1.7.0/coreclr/netcoreapp2.0/Microsoft.PackageManagement.CoreProviders.dll\r\nVERBOSE: Acquiring providers for assembly: /opt/microsoft/powershell/6-preview/Modules/PackageManagement/1.1.7.0/coreclr/netcoreapp2.0/Microsoft.PackageManagement.NuGetProvider.dll\r\nVERBOSE: Acquiring providers for assembly: /opt/microsoft/powershell/6-preview/Modules/PackageManagement/1.1.7.0/coreclr/netcoreapp2.0/Microsoft.PackageManagement.MetaProvider.PowerShell.dll\r\nVERBOSE: Acquiring providers for assembly: /opt/microsoft/powershell/6-preview/Modules/PackageManagement/1.1.7.0/coreclr/netcoreapp2.0/Microsoft.PackageManagement.ArchiverProviders.dll\r\nVERBOSE: Using the provider 'PowerShellGet' for searching packages.\r\nVERBOSE: The -Repository parameter was not specified.  PowerShellGet will use all of the registered repositories.\r\nVERBOSE: Getting the provider object for the PackageManagement Provider 'NuGet'.\r\nVERBOSE: The specified Location is 'https://www.powershellgallery.com/api/v2/' and PackageManagementProvider is 'NuGet'.\r\nVERBOSE: Searching repository 'https://www.powershellgallery.com/api/v2/FindPackagesById()?id='ImportExcel'' for ''.\r\nVERBOSE: Total package yield:'1' for the specified package 'ImportExcel'.\r\nVERBOSE: Performing the operation \"Save Package\" on target \"'ImportExcel' to location '/root'\".\r\nVERBOSE: The specified module will be installed in '/root'.\r\nVERBOSE: The specified Location is 'NuGet' and PackageManagementProvider is 'NuGet'.\r\nVERBOSE: Downloading module 'ImportExcel' with version '5.1.1' from the repository 'https://www.powershellgallery.com/api/v2/'.\r\nVERBOSE: Searching repository 'https://www.powershellgallery.com/api/v2/FindPackagesById()?id='ImportExcel'' for ''.\r\nVERBOSE: InstallPackage' - name='ImportExcel', version='5.1.1',destination='/tmp/151645995'\r\nVERBOSE: DownloadPackage' - name='ImportExcel', version='5.1.1',destination='/tmp/151645995/ImportExcel.5.1.1/ImportExcel.5.1.1.nupkg', uri='https://www.powershellgallery.com/api/v2/package/ImportExcel/5.1.1'\r\nVERBOSE: Downloading 'https://www.powershellgallery.com/api/v2/package/ImportExcel/5.1.1'.\r\nVERBOSE: Completed downloading 'https://www.powershellgallery.com/api/v2/package/ImportExcel/5.1.1'.\r\nVERBOSE: Completed downloading 'ImportExcel'.\r\nVERBOSE: InstallPackageLocal' - name='ImportExcel', version='5.1.1',destination='/tmp/151645995'\r\nWARNING: Administrator rights are required to install or update. Log on to the computer with an account that has Administrator rights, and then try again, or install by adding \"-Scope CurrentUser\" to your command. You can also try running the Windows PowerShell session with elevated rights (Run as Administrator).\r\nPackageManagement\\Save-Package : Unable to save the module 'ImportExcel'.\r\nAt /opt/microsoft/powershell/6-preview/Modules/PowerShellGet/1.6.0/PSModule.psm1:1835 char:21\r\n+             $null = PackageManagement\\Save-Package @PSBoundParameters\r\n+                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+ CategoryInfo          : InvalidOperation: (Microsoft.Power...ets.SavePackage:SavePackage) [Save-Package], Exception\r\n+ FullyQualifiedErrorId : ProviderFailToDownloadFile,Microsoft.PowerShell.PackageManagement.Cmdlets.SavePackage\r\n\r\n```\r\n\r\nEnvironment data\r\n----------------\r\n\r\n<!-- provide the output of $PSVersionTable -->\r\n\r\n```powershell\r\n> $PSVersionTable\r\nName                           Value\r\n----                           -----\r\nPSVersion                      6.1.0-preview.4\r\nPSEdition                      Core\r\nGitCommitId                    6.1.0-preview.4\r\nOS                             Linux 4.4.0-17134-Microsoft #112-Microsoft Thu Jun 07 22:57:00 PST 2018\r\nPlatform                       Unix\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n\r\n```\r\n",
  "closed_at": "2018-08-08T20:22:02Z",
  "comments": [
    {
      "author": "mi-hol",
      "author_association": "NONE",
      "body": "moved to https://github.com/PowerShell/PowerShellGet/issues/309",
      "created_at": "2018-08-08T20:22:02Z",
      "updated_at": "2018-08-08T20:22:02Z"
    }
  ],
  "created_at": "2018-08-08T20:07:50Z",
  "labels": [
    "Resolution-External"
  ],
  "number": 7484,
  "state": "closed",
  "title": "save-module from 6.1.preview4 broken on Linux",
  "updated_at": "2018-09-05T07:58:49Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/3897",
  "author": "anmenaga",
  "body": "This is fix for #3738 \"ScriptsToProcess not honored when Import-Module is passed -Version param\".\r\n\r\nThe bug was cased by existing check in LoadModule functions:\r\n\r\n> If  MinimumVersion/RequiredVersion/MaximumVersion has been specified, then only try to process manifest modules...\r\n> If the -Version flag was specified, don't look for non-manifest modules.\r\n\r\nWhen loading usual module files, this check is valid;\r\nHowever, same LoadModule function is used to load ScriptsToProcess - and this when this check was \r\ntriggered and ScriptsToProcess were not executed.\r\n\r\nThe fix is to work around that condition for ScriptsToProcess in the same way it is currently done for NestedModules - temporary reset the version info for the duration of processing ScriptsToProcess / NestedModules.\r\n\r\nTest results before the fix:\r\n![befoerfix](https://cloud.githubusercontent.com/assets/11860095/26646461/92a7ddf0-45f0-11e7-9327-c8d08b3c7612.png)\r\n\r\nTest results after the fix:\r\n![afterfix](https://cloud.githubusercontent.com/assets/11860095/26646462/92a9f7c0-45f0-11e7-8848-54cd63e8741b.png)",
  "closed_at": "2017-06-05T21:19:04Z",
  "comments": [],
  "created_at": "2017-05-31T18:04:08Z",
  "number": 3897,
  "state": "closed",
  "title": "Fixed ScriptsToProcess when -Version param is used in Import-Module",
  "updated_at": "2018-10-31T21:20:42Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/9033",
  "author": "rkeithhill",
  "body": "<!-- Anything that looks like this is a comment and can't be seen after the Pull Request is created. -->\r\n\r\n# PR Summary\r\n\r\nFix #7175 by using `Out-String -Stream -Width` before piping to an application.  This improves the help experience on macOS and Linux by ensuring lines of help text wrap properly for the given console width.\r\n\r\nFix #8912 by using the PS tokenizer to separate the pager command from arguments if both are specified in $env:PAGER.  Also ensures that there is no PowerShell interpretation of arguments to an application by using the stop parsing operator.\r\n\r\n## PR Context\r\n\r\nThe current reading experience of all help topics on macOS and Linux is sub-par giving PowerShell Core a bit of a black eye on those platforms.  See #7175 for images of what this looks like.\r\n\r\nSpecify a custom pager with arguments works in v6.1 but is broken in v6.2.  This PR fixes this issue - #8912.\r\n\r\n<!-- Provide a little reasoning as to why this Pull Request helps and why you have opened it. -->\r\n\r\n## PR Checklist\r\n\r\n- [x] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - Use the present tense and imperative mood when describing your changes\r\n- [x] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] [Change is not breaking](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)\r\n- [x] [Make sure all `.h`, `.cpp`, `.cs`, `.ps1` and `.psm1` files have the correct copyright header](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - If the PR is work in progress, please add the prefix `WIP:` or `[ WIP ]` to the beginning of the title (the `WIP` bot will keep its status check at `Pending` while the prefix is present) and remove the prefix when the PR is ready.\r\n- **User-facing changes**\r\n    - [x] Not Applicable\r\n    - **OR**\r\n    - [ ] [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n        - [x] Issue filed: <!-- Number/link of that issue here --> #7175 #8912\r\n- **Testing - New and feature**\r\n    - [x] N/A or can only be tested interactively\r\n    - **OR**\r\n    - [ ] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n        - [ ] [Add `[feature]` to your commit messages if the change is significant or affects feature tests](https://github.com/PowerShell/PowerShell/blob/master/docs/testing-guidelines/testing-guidelines.md#requesting-additional-tests-for-a-pr)\r\n",
  "closed_at": "2019-04-10T21:17:20Z",
  "comments": [
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "@RDIL all of those are within a string which is actually PowerShell embedded into the C# code, so they should follow PowerShell style. :)",
      "created_at": "2019-03-04T17:30:04Z",
      "updated_at": "2019-03-04T17:30:04Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "If for nothing else, because it'll help you pick all the nuances up that much faster! \ud83d\ude42 \r\n\r\nI had to triple check that, too, because something didn't look quite right, so don't feel bad. I stared at it for a good ten minutes before I realized what was going on. \ud83d\ude04 ",
      "created_at": "2019-03-04T17:36:46Z",
      "updated_at": "2019-03-04T17:36:46Z"
    },
    {
      "author": "rkeithhill",
      "author_association": "COLLABORATOR",
      "body": "I suppose it is unlikely that this will make it in for the 6.2 release, eh?",
      "created_at": "2019-03-09T03:03:31Z",
      "updated_at": "2019-03-09T03:03:31Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Yes, GA-6.2 was already forked. In next milestone perhaps we'll convert the function to cmdlet.",
      "created_at": "2019-03-09T04:34:01Z",
      "updated_at": "2019-03-09T04:34:01Z"
    },
    {
      "author": "pougetat",
      "author_association": "NONE",
      "body": "@rkeithhill Sorry about this one. I see your PR will fix the issue I introduced.",
      "created_at": "2019-03-10T14:50:08Z",
      "updated_at": "2019-03-10T14:50:08Z"
    },
    {
      "author": "stale[bot]",
      "author_association": "NONE",
      "body": "This PR has been automatically marked as stale because it has not had activity in the last 30 days. It will be closed if no further activity occurs within 10 days.\nThank you for your contributions.\nCommunity members are welcome to grab these works.\n",
      "created_at": "2019-04-09T15:17:33Z",
      "updated_at": "2019-04-09T15:17:33Z"
    },
    {
      "author": "rkeithhill",
      "author_association": "COLLABORATOR",
      "body": "This PR needs some more review and to be targeted for some milestone - 6.2.1 or 7.  I do not wish to see this closed as it addresses a real issue.",
      "created_at": "2019-04-09T15:57:48Z",
      "updated_at": "2019-04-09T15:57:48Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@rkeithhill Thanks for fixing the paging issues.",
      "created_at": "2019-04-11T03:09:16Z",
      "updated_at": "2019-04-11T03:09:16Z"
    }
  ],
  "created_at": "2019-03-03T08:20:53Z",
  "number": 9033,
  "state": "closed",
  "title": "Fix help paging issues on macOS/Linux and with custom pager that takes arguments",
  "updated_at": "2019-05-05T18:14:22Z"
}
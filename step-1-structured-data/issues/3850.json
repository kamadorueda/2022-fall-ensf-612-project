{
  "_url": "https://github.com/PowerShell/PowerShell/issues/3850",
  "author": "daxian-dbw",
  "body": "Address #2900\r\n\r\nRoot Cause\r\n------------\r\nOn Unix platforms, we are currently depending on `xdg-open` on Linux and `open` on OSX to open the default program for a registered file type, so the file path is served as an argument to `xdg-open` and `open`. However, we didn't handle the case when path contains spaces.\r\n\r\nFix\r\n---\r\nUse the method `NativeCommandParameterBinder.NeedQuotes`, which is used by powershell native command processor, to check if quote is needed. If yes, add quotes in the same way as our native command processor (see the code [here](https://github.com/PowerShell/PowerShell/blob/master/src/System.Management.Automation/engine/NativeCommandParameterBinder.cs#L198)).\r\nThere is another problem with the current `Invoke-Item` on Linux and OSX -- it cannot invoke an executable properly. The fix is to first run `Process.Start` directly with the file path, and if it fails, then try `xdg-open` or `open`.\r\n\r\nAdditional Info\r\n----------------\r\nWe are focusing on 2 scenarios for \"Invoke-Item\":\r\n- it can start an executable\r\n- it can open a file with the default program that is registered to the file type.",
  "closed_at": "2017-05-24T20:30:54Z",
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "The cmdlet seems to have the most unpredictable behavior\ud83d\ude15 ",
      "created_at": "2017-05-24T18:08:31Z",
      "updated_at": "2017-05-24T18:08:31Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@iSazonov I think we are focusing on 2 scenarios for this cmdlet:\r\n- it can start an executable\r\n- it can open a file with the default program that is registered to the file type.",
      "created_at": "2017-05-24T19:05:22Z",
      "updated_at": "2017-05-24T19:05:22Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@daxian-dbw Thanks for clarify. Could you move the comment to the PR description for future docs?",
      "created_at": "2017-05-25T03:37:46Z",
      "updated_at": "2017-05-25T03:37:46Z"
    }
  ],
  "created_at": "2017-05-23T22:22:03Z",
  "number": 3850,
  "state": "closed",
  "title": "Fix \"Invoke-Item\" to accept a file path with spaces on Unix platforms",
  "updated_at": "2017-05-25T16:28:39Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/18023",
  "author": "gregsdennis",
  "body": "<!-- Anything that looks like this is a comment and can't be seen after the Pull Request is created. -->\r\n\r\n# PR Summary\r\n\r\n<!-- Summarize your PR between here and the checklist. -->\r\nUpdates the `Test-Json` cmdlet to use [JsonSchema.Net](https://www.nuget.org/packages/JsonSchema.Net) instead of [NJsonSchema](https://www.nuget.org/packages/NJsonSchema) in order to:\r\n\r\n- use System.Text.Json instead of Newtonsoft\r\n- support the latest JSON Schema drafts (up to 2020-12)\r\n\r\nResolves \r\n\r\n## PR Context\r\n\r\n<!-- Provide a little reasoning as to why this Pull Request helps and why you have opened it. -->\r\n\r\nResolves #18009\r\n\r\nNJsonSchema only supports up to draft 7, which at this point is several years old and two versions behind.  Additionally, it relies on Newtonsoft.Json.\r\n\r\nThis change is a merely drop-in replacement of the implementation that provides validation.\r\n\r\nThe cmdlet API doesn't change, however the cmdlet will no longer support draft 4 schemas.  Draft 4 is a decade old at this point and the JSON Schema team (myself included) is encouraging tooling to only support draft 6/7 (6 is a subset of 7) and later.  (In the future, support for these should be dropped as newer versions are released.)  I'm not sure if this is considered a breaking change for this repo.\r\n\r\nTo assist users in their migration away from draft 4, the [alterschema draft migration tool](https://github.com/sourcemeta/alterschema) has been created.\r\n\r\nI expect the existing test coverage is adequate to cover this change.\r\n\r\n## PR Checklist\r\n\r\n- [x] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - Use the present tense and imperative mood when describing your changes\r\n- [x] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] [Make sure all `.h`, `.cpp`, `.cs`, `.ps1` and `.psm1` files have the correct copyright header](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [ ] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - If the PR is work in progress, please add the prefix `WIP:` or `[ WIP ]` to the beginning of the title (the `WIP` bot will keep its status check at `Pending` while the prefix is present) and remove the prefix when the PR is ready.\r\n- **[Breaking changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)**\r\n    - [ ] None\r\n    - **OR**\r\n    - [ ] [Experimental feature(s) needed](https://github.com/MicrosoftDocs/PowerShell-Docs/blob/main/reference/7.3/Microsoft.PowerShell.Core/About/about_Experimental_Features.md)\r\n        - [ ] Experimental feature name(s): <!-- Experimental feature name(s) here -->\r\n- **User-facing changes**\r\n    - [ ] Not Applicable\r\n    - **OR**\r\n    - [ ] [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n        - [ ] Issue filed: <!-- Number/link of that issue here -->\r\n- **Testing - New and feature**\r\n    - [ ] N/A or can only be tested interactively\r\n    - **OR**\r\n    - [x] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n- **Tooling**\r\n    - [x] I have considered the user experience from a tooling perspective and don't believe tooling will be impacted.\r\n    - **OR**\r\n    - [ ] I have considered the user experience from a tooling perspective and opened an issue in the relevant tool repository. This may include:\r\n        - [ ] Impact on [PowerShell Editor Services](https://github.com/PowerShell/PowerShellEditorServices) which is used in the [PowerShell extension](https://github.com/PowerShell/vscode-powershell) for VSCode\r\n        (which runs in a different PS Host).\r\n            - [ ] Issue filed: <!-- Number/link of that issue here -->\r\n        - [ ] Impact on Completions (both in the console and in editors) - one of PowerShell's most powerful features.\r\n            - [ ] Issue filed: <!-- Number/link of that issue here -->\r\n        - [ ] Impact on [PSScriptAnalyzer](https://github.com/PowerShell/PSScriptAnalyzer) (which provides linting & formatting in the editor extensions).\r\n            - [ ] Issue filed: <!-- Number/link of that issue here -->\r\n        - [ ] Impact on [EditorSyntax](https://github.com/PowerShell/EditorSyntax) (which provides syntax highlighting with in VSCode, GitHub, and many other editors).\r\n            - [ ] Issue filed: <!-- Number/link of that issue here -->\r\n",
  "closed_at": "2022-09-21T03:33:28Z",
  "comments": [
    {
      "author": "microsoft-cla-retired[bot]",
      "author_association": "NONE",
      "body": "[![CLA assistant check](https://cla.opensource.microsoft.com/pull/badge/signed)](https://cla.opensource.microsoft.com/PowerShell/PowerShell?pullRequest=18023) <br/>All CLA requirements met.",
      "created_at": "2022-09-03T21:49:56Z",
      "updated_at": "2022-09-04T01:37:53Z"
    },
    {
      "author": "gregsdennis",
      "author_association": "NONE",
      "body": "I'm not sure if this is a problem, but I notice that all of the tests are written with single quotes.  Newtonsoft is happy to parse these, but System.Text.Json will not.  I suspect this is the source the test failures, but I'm not sure.  I could use some help getting the tests to run locally.",
      "created_at": "2022-09-04T23:09:03Z",
      "updated_at": "2022-09-04T23:09:03Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@gregsdennis Yes, it is main breaking change in System.Text.Json. \r\n\r\n@SteveL-MSFT Do you agree to begin migration to System.Text.Json in the 7.4 milestone?",
      "created_at": "2022-09-05T06:18:49Z",
      "updated_at": "2022-09-05T06:18:49Z"
    },
    {
      "author": "gregsdennis",
      "author_association": "NONE",
      "body": "There seem to be a lot more changes to _files.wxs_ that I expected.  Maybe this is normal?",
      "created_at": "2022-09-05T23:56:43Z",
      "updated_at": "2022-09-06T00:00:43Z"
    },
    {
      "author": "gregsdennis",
      "author_association": "NONE",
      "body": "![image](https://user-images.githubusercontent.com/2676804/188521952-b7ada7fb-4331-4a83-ba9b-1428ec338ba0.png)\r\n\r\n\"invalid spacing\" - but what should it be?  It tells me its wrong but not how to fix it.",
      "created_at": "2022-09-05T23:59:44Z",
      "updated_at": "2022-09-05T23:59:44Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@gregsdennis Please finish replacing ' with \" in tests since you have started the process.\r\n\r\n\r\n> Invalid spacing\r\n\r\nTry reformat:\r\n```c#\r\nvar validationResults = _jschema.Validate(parsedJson, new ValidationOptions\r\n{\r\n    OutputFormat = OutputFormat.Basic\r\n});\r\n\r\n> files.wxs\r\n\r\nYou need to build win package locally and the script will publish new files.wxs in temp folder.",
      "created_at": "2022-09-06T03:19:50Z",
      "updated_at": "2022-09-06T03:19:50Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@gregsdennis Maybe #11397 help you a bit.",
      "created_at": "2022-09-06T03:23:05Z",
      "updated_at": "2022-09-06T03:23:05Z"
    },
    {
      "author": "gregsdennis",
      "author_association": "NONE",
      "body": "> Please finish replacing ' with \" in tests since you have started the process.\r\n\r\nI expect you don't mean _all_ the tests.  Even just in that file seems overkill.  It seems there's a preference to have `\"` wherever possible, so I only changed what was necessary.\r\n\r\n> Try reformat\r\n\r\nThe format of `Func(new Class { Prop = value });` seems to be working.  I can still change to what you have if that's preferred.",
      "created_at": "2022-09-06T05:52:35Z",
      "updated_at": "2022-09-06T05:52:35Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "> > Please finish replacing ' with \" in tests since you have started the process.\r\n> \r\n> I expect you don't mean _all_ the tests. Even just in that file seems overkill. It seems there's a preference to have `\"` wherever possible, so I only changed what was necessary.\r\n\r\nI still see test fails because of \"",
      "created_at": "2022-09-06T07:04:30Z",
      "updated_at": "2022-09-06T07:04:30Z"
    },
    {
      "author": "gregsdennis",
      "author_association": "NONE",
      "body": "The failing tests aren't (all) because of `\"`.\r\n\r\nFor example, `Json is valid against a valid schema from file` is failing because the lib doesn't know about `valid_schema_definitions.json`, which is being referenced.\r\n\r\nJSON Schema explicitly states that implementations SHOULD NOT download references that appear to be URLs.  The URIs that are used are merely identifiers, not locations.  As such, downloading is disabled in my lib by default, requiring pre-loading of all required schemas, but it seems that it may have been enabled in NJsonSchema.  I can make this change.\r\n\r\nI'll go through the other tests to see what the problems are.",
      "created_at": "2022-09-06T19:34:07Z",
      "updated_at": "2022-09-06T19:34:07Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "> As such, downloading is disabled in my lib by default, requiring pre-loading of all required schemas\r\n\r\nSo we cannot reference base schema file from new schema file?",
      "created_at": "2022-09-07T05:20:19Z",
      "updated_at": "2022-09-07T05:20:19Z"
    },
    {
      "author": "gregsdennis",
      "author_association": "NONE",
      "body": "If PowerShell is comfortable with automatically fetching external documents, it can be enabled, yes, but it's not generally recommended by JSON Schema.  Given that this is previous functionality, I think enabling it is fine.\n\nI suggest adding this to the docs as a deviation from the spec.",
      "created_at": "2022-09-07T08:30:14Z",
      "updated_at": "2022-09-07T08:30:14Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "> If PowerShell is comfortable with automatically fetching external documents, it can be enabled, yes, but it's not generally recommended by JSON Schema. Given that this is previous functionality, I think enabling it is fine.\r\n> \r\n> I suggest adding this to the docs as a deviation from the spec.\r\n\r\nSince this has not been reported as a security issue until now we should keep current behavior if possible. Then we will ask PowerShell security group.",
      "created_at": "2022-09-07T10:26:03Z",
      "updated_at": "2022-09-07T10:26:03Z"
    },
    {
      "author": "gregsdennis",
      "author_association": "NONE",
      "body": "It looks like there's some syntax issue I don't understand in the `Test-Json recognizes non-object types: <name>` tests on line 156.\r\n\r\nI've extracted the loop into a separate file:\r\n\r\n```powershell\r\n$types = 'string', 'number', 'boolean', 'null', 'array', 'object'\r\n$types | Where-Object {\r\n    $schema = \"{ \"\"type\"\": \"\"$_\"\" }\"\r\n    Write-Output $schema\r\n}\r\n\r\n\r\n$type = 'string'\r\n$schema = \"{ \"\"type\"\": \"\"$type\"\" }\"\r\nWrite-Output $schema\r\n```\r\n\r\nThis outputs \r\n\r\n```\r\nstring\r\nnumber\r\nboolean\r\nnull\r\narray\r\nobject\r\n{ \"type\": \"string\" }\r\n```\r\n\r\nI don't understand why the interpolation isn't working in the loop but it works outside of it.",
      "created_at": "2022-09-07T22:45:29Z",
      "updated_at": "2022-09-07T22:45:29Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "> I don't understand why the interpolation isn't working\r\n\r\nPowerShell interpolation works only in double quotes.\r\n\r\nI added commit to fix the test.",
      "created_at": "2022-09-08T05:11:50Z",
      "updated_at": "2022-09-08T05:11:50Z"
    },
    {
      "author": "gregsdennis",
      "author_association": "NONE",
      "body": "What's the policy on changing error codes?\r\n\r\n`Test-Json throw if a schema from file is invalid` is expecting `InvalidJsonSchema`, but the file isn't valid JSON at all.  It seems that NJsonSchema preprocesses `$ref`s so that it tries to deserialize the text as a schema before it ever reaches the validation stage.  JsonSchema.Net deserializes referenced data (and caches it) at validation time.  This means that the command reaches the validation stage and the resulting error is `InvalidJson` instead (which I think is actually more correct).\r\n\r\nIn both cases, it's an error, but the exact error is different.\r\n\r\n_Edit: After the commit below, all the tests are passing except for this._",
      "created_at": "2022-09-08T21:48:04Z",
      "updated_at": "2022-09-08T23:39:29Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "> This means that the command reaches the validation stage and the resulting error is `InvalidJson` instead (which I think is actually more correct).\r\n\r\nI agree with `InvalidJson` since we check just Json. However, the user must understand the root of the error whether it is the Json itself or a problem with the schema (reading/parsing). In other words `InvalidJson` must contain `InvalidJsonSchema` as an inner exception and the test should check this.",
      "created_at": "2022-09-09T04:58:21Z",
      "updated_at": "2022-09-09T05:12:52Z"
    },
    {
      "author": "gregsdennis",
      "author_association": "NONE",
      "body": "> In other words InvalidJson must contain InvalidJsonSchema as an inner exception and the test should check this.\n\nI don't know that this can be identified except by analyzing error messages.\n\nI'll need to run some tests on my implementation to see what it's doing.  If it throws a `JsonException` during validation, it might be safe to assume that it's the result of attempting to deserialize a schema, and we can add that as a `catch` to the cmdlet.  Otherwise, I'm not sure we can capture this.",
      "created_at": "2022-09-09T05:34:53Z",
      "updated_at": "2022-09-09T05:34:53Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Do you mean your JsonSchema.FromText() doesn't deserialize in call time?",
      "created_at": "2022-09-09T05:43:23Z",
      "updated_at": "2022-09-09T05:45:20Z"
    },
    {
      "author": "gregsdennis",
      "author_association": "NONE",
      "body": "> Do you mean your JsonSchema.FromText() doesn't deserialize in call time?\r\n\r\nIt does.  I just needed to check what the behavior was.  I didn't have that test.  I've added it to my repo, and `JsonException` is thrown as expected.  Will be adding a commit shortly.",
      "created_at": "2022-09-09T05:52:34Z",
      "updated_at": "2022-09-09T05:54:32Z"
    },
    {
      "author": "gregsdennis",
      "author_association": "NONE",
      "body": "> I agree with InvalidJson since we check just Json. However, the user must understand the root of the error whether it is the Json itself or a problem with the schema (reading/parsing). In other words InvalidJson must contain InvalidJsonSchema as an inner exception and the test should check this.\r\n\r\nDo we want to use this proposed behavior or maintain the current?  Since it's throwing `JsonException`, I can isolate this case and make it do either per your preference.",
      "created_at": "2022-09-09T05:54:11Z",
      "updated_at": "2022-09-09T05:54:11Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "> Do we want to use this proposed behavior or maintain the current?\r\n\r\nI think we should keep current behavior and have JsonSchemaException.",
      "created_at": "2022-09-09T05:56:00Z",
      "updated_at": "2022-09-09T05:56:00Z"
    },
    {
      "author": "gregsdennis",
      "author_association": "NONE",
      "body": "@iSazonov are you looking for more PowerShell tests or a new set of c# tests?\n\n(I can run the c# tests locally, but I haven't figured out running the PowerShell ones.)",
      "created_at": "2022-09-13T00:19:04Z",
      "updated_at": "2022-09-13T00:19:43Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "> @iSazonov are you looking for more PowerShell tests or a new set of c# tests?\r\n> \r\n> (I can run the c# tests locally, but I haven't figured out running the PowerShell ones.)\r\n\r\nI mean PowerShell tests. (We have C# tests only for some SDK API).",
      "created_at": "2022-09-13T04:38:30Z",
      "updated_at": "2022-09-13T04:38:30Z"
    },
    {
      "author": "gregsdennis",
      "author_association": "NONE",
      "body": "@iSazonov I'm looking through all of the catch blocks and the tests that exist, and I can't find any catches that aren't covered.  Which ones do you see?",
      "created_at": "2022-09-15T09:36:27Z",
      "updated_at": "2022-09-15T09:36:27Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@gregsdennis We moved to .Net 7 RC1. Please resolve merge conflicts.",
      "created_at": "2022-09-17T16:24:15Z",
      "updated_at": "2022-09-17T16:24:15Z"
    },
    {
      "author": "gregsdennis",
      "author_association": "NONE",
      "body": "I've rebased and pushed.",
      "created_at": "2022-09-17T20:52:46Z",
      "updated_at": "2022-09-17T20:52:46Z"
    },
    {
      "author": "gregsdennis",
      "author_association": "NONE",
      "body": "@iSazonov since the update to .Net 7 RC1, I can't build anymore.  I've installed the [preview framework](https://dotnet.microsoft.com/en-us/download/dotnet/thank-you/sdk-7.0.100-rc.1-windows-x64-installer) (Windows x64 installer).\r\n\r\nI'm getting a lot of errors saying that it can't find Microsoft.CodeAnalysis.\r\n\r\n```\r\nAn instance of analyzer Microsoft.CodeAnalysis.MakeFieldReadonly.MakeFieldReadonlyDiagnosticAnalyzer\r\ncannot be created from C:\\Program Files\\dotnet\\sdk\\7.0.100-rc.1.22431.12\\Sdks\\Microsoft.NET.Sdk\\codestyle\\cs\\Microsoft.CodeAnalysis.CodeStyle.dll :\r\nCould not load file or assembly 'Microsoft.CodeAnalysis, Version=4.4.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'\r\nor one of its dependencies. The system cannot find the file specified.\r\n```\r\n\r\nIt seems there are some rebase conflicts with how I merged the .wxs file.",
      "created_at": "2022-09-18T10:28:51Z",
      "updated_at": "2022-09-18T10:28:51Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "> I'm getting a lot of errors saying that it can't find Microsoft.CodeAnalysis.\r\n\r\nUsually we need to remove nuget cache in current user profile to fix such issues. Also you need to run once `Start-PSBuild -Clean`.",
      "created_at": "2022-09-18T17:55:25Z",
      "updated_at": "2022-09-18T17:55:25Z"
    },
    {
      "author": "gregsdennis",
      "author_association": "NONE",
      "body": "@iSazonov I've regen'd the files.wxs file (and removed the pdb's) but I'm not sure it's right.  There seem to be other DLLs listed that I didn't do anything with.",
      "created_at": "2022-09-19T08:26:08Z",
      "updated_at": "2022-09-19T08:26:08Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "> @iSazonov I've regen'd the files.wxs file (and removed the pdb's) but I'm not sure it's right. There seem to be other DLLs listed that I didn't do anything with.\r\n\r\nPlease build msi package locally and use files.wxs from the build.",
      "created_at": "2022-09-19T09:23:20Z",
      "updated_at": "2022-09-19T09:23:20Z"
    },
    {
      "author": "gregsdennis",
      "author_association": "NONE",
      "body": "> Please build msi package locally and use files.wxs from the build.\r\n\r\nAre there instructions for this?  All I can find is the [Windows build instructions](https://github.com/PowerShell/PowerShell/blob/master/docs/building/windows-core.md).  This only generates an _.exe_.",
      "created_at": "2022-09-19T21:23:01Z",
      "updated_at": "2022-09-19T21:23:01Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "https://github.com/PowerShell/PowerShell/blob/7dc4587014bfa22919c933607bf564f0ba53db2e/.github/CONTRIBUTING.md#pull-request---automatic-checks\r\n```powershell\r\nImport-Module .\\build.psm1\r\nStart-PSBuild -Clean -CrossGen -PSModuleRestore -Runtime win7-x64 -Configuration Release -ReleaseTag <release tag>\r\nImport-Module .\\tools\\packaging\r\nStart-PSPackage -Type msi -ReleaseTag <release tag> -WindowsRuntime 'win7-x64' -SkipReleaseChecks\r\n```\r\nConsole output should contain a reference to new files.wxs.\n\n<blockquote><img src=\"https://repository-images.githubusercontent.com/49609581/aad0ad80-cdec-11ea-8248-a37bc0571bfd\" width=\"48\" align=\"right\"><div><img src=\"https://github.githubassets.com/favicons/favicon.svg\" height=\"14\"> GitHub</div><div><strong><a href=\"https://github.com/PowerShell/PowerShell\">PowerShell/CONTRIBUTING.md at 7dc4587014bfa22919c933607bf564f0ba53db2e \u00b7 PowerShell/PowerShell</a></strong></div><div>PowerShell for every system! Contribute to PowerShell/PowerShell development by creating an account on GitHub.</div></blockquote>",
      "created_at": "2022-09-20T04:34:02Z",
      "updated_at": "2022-09-20T04:34:04Z"
    },
    {
      "author": "gregsdennis",
      "author_association": "NONE",
      "body": "@iSazonov I ran that except that it didn't recognize the `-CrossGen` switch, so I had to remove that.\r\n\r\n```\r\nPS C:\\projects\\PowerShell> Start-PSBuild -Clean -CrossGen -PSModuleRestore -Runtime win7-x64 -Configuration Release -ReleaseTag v1.0.0-local\r\nStart-PSBuild: A parameter cannot be found that matches parameter name 'CrossGen'.\r\n```\r\n\r\nIt also added all of the `.pdb` files, so I removed those.  It still doesn't match. \ud83d\ude2d ",
      "created_at": "2022-09-20T08:05:35Z",
      "updated_at": "2022-09-20T08:05:35Z"
    },
    {
      "author": "pull-request-quantifier[bot]",
      "author_association": "NONE",
      "body": "### ![](https://img.shields.io/static/v1?label=Quantified&message=Large&color=red)\r\n\r\nThis PR has `209` quantified lines of changes. In general, a change size of upto `200` lines is ideal for the best PR experience!\r\n\r\n------\r\n\r\n<details >\r\n    <summary display=\"inline\"> <strong>Quantification details</strong></summary>\r\n    <p />\r\n\r\n```\r\nLabel      : Large\r\nSize       : +125 -84\r\nPercentile : 60.9%\r\n\r\nTotal files changed: 5\r\n\r\nChange summary by file extension:\r\n.wxs : +30 -22\r\n.csproj : +1 -1\r\n.cs : +59 -26\r\n.ps1 : +35 -35\r\n```\r\n> Change counts above are quantified counts, based on the [PullRequestQuantifier customizations](https://github.com/microsoft/PullRequestQuantifier/blob/main/docs/prquantifier-yaml.md).\r\n    \r\n</details>\r\n\r\n\r\n<details>\r\n    <summary display=\"inline\"> <strong>Why proper sizing of changes matters</strong> </summary>\r\n    <p/>\r\n    <p/>\r\n\r\nOptimal pull request sizes drive a better predictable PR flow as they strike a\r\nbalance between between PR complexity and PR review overhead. PRs within the\r\noptimal size (typical small, or medium sized PRs) mean:\r\n\r\n- Fast and predictable releases to production:\r\n  - Optimal size changes are more likely to be reviewed faster with fewer\r\niterations.\r\n  - Similarity in low PR complexity drives similar review times.\r\n- Review quality is likely higher as complexity is lower:\r\n  - Bugs are more likely to be detected.\r\n  - Code inconsistencies are more likely to be detected.\r\n- Knowledge sharing is improved within the participants:\r\n  - Small portions can be assimilated better.\r\n- Better engineering practices are exercised:\r\n  - Solving big problems by dividing them in well contained, smaller problems.\r\n  - Exercising separation of concerns within the code changes.\r\n\r\n#### What can I do to optimize my changes\r\n\r\n- Use the PullRequestQuantifier to quantify your PR accurately\r\n  - Create a context profile for your repo using the [context generator](https://github.com/microsoft/PullRequestQuantifier/releases)\r\n  - Exclude files that are not necessary to be reviewed or do not increase the review complexity. Example: Autogenerated code, docs, project IDE setting files, binaries, etc. Check out the `Excluded` section from your `prquantifier.yaml` context profile. \r\n  - Understand your typical change complexity, drive towards the desired complexity by adjusting the label mapping in your `prquantifier.yaml` context profile.\r\n  - Only use the labels that matter to you, [see context specification](./docs/prquantifier-yaml.md) to customize your `prquantifier.yaml` context profile.\r\n- Change your engineering behaviors\r\n  - For PRs that fall outside of the desired spectrum, review the details and check if:\r\n    - Your PR could be split in smaller, self-contained PRs instead\r\n    - Your PR only solves one particular issue. (For example, don't refactor and code new features in the same PR).\r\n\r\n#### How to interpret the change counts in git diff output\r\n\r\n- One line was added: `+1 -0`\r\n- One line was deleted: `+0 -1`\r\n- One line was modified: `+1 -1` (git diff doesn't know about modified, it will\r\ninterpret that line like one addition plus one deletion)\r\n- Change percentiles: Change characteristics (addition, deletion, modification)\r\nof this PR in relation to all other PRs within the repository.\r\n\r\n</details>\r\n\r\n<p />\r\n\r\n------\r\n\r\nWas this comment helpful? <a href=\"https://pullrequestquantifierfeedback.azurewebsites.net/feedback?payload=eyJBdXRob3JOYW1lIjoiZ3JlZ3NkZW5uaXMiLCJSZXBvc2l0b3J5TGluayI6Imh0dHBzOi8vZ2l0aHViLmNvbS9Qb3dlclNoZWxsL1Bvd2VyU2hlbGwiLCJQdWxsUmVxdWVzdExpbmsiOiJodHRwczovL2dpdGh1Yi5jb20vUG93ZXJTaGVsbC9Qb3dlclNoZWxsL3B1bGwvMTgwMjMiLCJFdmVudFR5cGUiOiJUaHVtYnNVcCJ9&amp;anonymous=True\" target=\"_blank\" title=\"Thumbs up\"><strong>:thumbsup:</strong></a> <a href=\"https://pullrequestquantifierfeedback.azurewebsites.net/feedback?payload=eyJBdXRob3JOYW1lIjoiZ3JlZ3NkZW5uaXMiLCJSZXBvc2l0b3J5TGluayI6Imh0dHBzOi8vZ2l0aHViLmNvbS9Qb3dlclNoZWxsL1Bvd2VyU2hlbGwiLCJQdWxsUmVxdWVzdExpbmsiOiJodHRwczovL2dpdGh1Yi5jb20vUG93ZXJTaGVsbC9Qb3dlclNoZWxsL3B1bGwvMTgwMjMiLCJFdmVudFR5cGUiOiJOZXV0cmFsIn0=&amp;anonymous=True\" target=\"_blank\" title=\"Neutral\"><strong>&nbsp;:ok_hand:</strong></a> <a href=\"https://pullrequestquantifierfeedback.azurewebsites.net/feedback?payload=eyJBdXRob3JOYW1lIjoiZ3JlZ3NkZW5uaXMiLCJSZXBvc2l0b3J5TGluayI6Imh0dHBzOi8vZ2l0aHViLmNvbS9Qb3dlclNoZWxsL1Bvd2VyU2hlbGwiLCJQdWxsUmVxdWVzdExpbmsiOiJodHRwczovL2dpdGh1Yi5jb20vUG93ZXJTaGVsbC9Qb3dlclNoZWxsL3B1bGwvMTgwMjMiLCJFdmVudFR5cGUiOiJUaHVtYnNEb3duIn0=&amp;anonymous=True\" target=\"_blank\" title=\"Thumbs down\"><strong>&nbsp;:thumbsdown:</strong></a> (<a href=\"MAILTO:prquantifier@microsoft.com\" title=\"Mail to prquantifier@microsoft.com\">Email</a>)\r\n[Customize PullRequestQuantifier](https://github.com/PowerShell/PowerShell/blob/master/.github/prquantifier.yaml) for this repository.\r\n\r\n",
      "created_at": "2022-09-20T17:28:23Z",
      "updated_at": "2022-09-20T17:28:23Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@gregsdennis I added new commit to fix packaging.",
      "created_at": "2022-09-20T18:01:41Z",
      "updated_at": "2022-09-20T18:01:41Z"
    },
    {
      "author": "gregsdennis",
      "author_association": "NONE",
      "body": "Thank you @iSazonov \r\n\r\nI'm going through the checklist now, and the only breaking change that I can think of is the lack of support for single-quoted JSON (which isn't really JSON anyway).\r\n\r\nDoes this need to be documented somewhere?  If so, where?  Do I need to create a separate issue to track that?",
      "created_at": "2022-09-20T21:41:37Z",
      "updated_at": "2022-09-20T21:41:37Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "> Does this need to be documented somewhere? If so, where? Do I need to create a separate issue to track that?\r\n\r\nCommon rule for PowerShell is to follow .Net behavior. I think it makes sense to explain the breaking change in docs. But now is not the time. The change has to be approved by MSFT team first. Then there are other Json cmdlets that should be migrated. And finally, there are many small differences between NewtonSoft and .Net implementations. I guess we are not able to describe them all. We can only point out this fact. I don't think this is a critical change, because the .Net implementations follow Json standard very closely.\r\n\r\n@gregsdennis The PR contains a lot of temporary comments, so I suggest to close the PR and open new one.",
      "created_at": "2022-09-21T03:20:43Z",
      "updated_at": "2022-09-21T03:20:43Z"
    }
  ],
  "created_at": "2022-09-03T21:49:42Z",
  "number": 18023,
  "state": "closed",
  "title": "Test-Json: use JsonSchema.Net instead of NJsonSchema",
  "updated_at": "2022-09-21T03:33:28Z"
}
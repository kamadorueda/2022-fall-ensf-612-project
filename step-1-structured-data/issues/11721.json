{
  "_url": "https://github.com/PowerShell/PowerShell/issues/11721",
  "author": "rjmholt",
  "body": "See https://github.com/PowerShell/PowerShell/pull/11331.\r\n\r\n# Steps to reproduce\r\n\r\n```powershell\r\nremove-item -force -recurse ./dir\r\n```\r\n\r\n# Expected behavior\r\n\r\n*Folder is deleted*\r\n\r\n# Actual behavior\r\n\r\n```none\r\n\r\nProviderInvocationException :\r\n    ProviderInfo   : Microsoft.PowerShell.Core\\FileSystem\r\n    ErrorRecord    :\r\n        Exception             :\r\n            TargetSite :\r\n                Name          : AppendFormatHelper\r\n                DeclaringType : System.Text.StringBuilder\r\n                MemberType    : Method\r\n                Module        : System.Private.CoreLib.dll\r\n            StackTrace :\r\n   at System.Text.StringBuilder.AppendFormatHelper(IFormatProvider provider, String format, ParamsArray args)\r\n   at System.String.FormatHelper(IFormatProvider provider, String format, ParamsArray args)\r\n   at System.Management.Automation.Internal.StringUtil.Format(String formatSpec, Object o)\r\n   at Microsoft.PowerShell.Commands.FileSystemProvider.RemoveDirectoryInfoItem(DirectoryInfo directory, Boolean recurse, Boolean force, Boolean rootOfRemoval)\r\n   at Microsoft.PowerShell.Commands.FileSystemProvider.RemoveItem(String path, Boolean recurse)\r\n   at System.Management.Automation.SessionStateInternal.RemoveItem(CmdletProvider providerInstance, String path, Boolean recurse, CmdletProviderContext context)\r\n            Message    : Index (zero based) must be greater than or equal to zero and less than the size of the argument list.\r\n            Source     : System.Private.CoreLib\r\n            HResult    : -2146233033\r\n        CategoryInfo          : InvalidOperation: (:) [], FormatException\r\n        FullyQualifiedErrorId : RemoveItemProviderException\r\n    Message        : Attempting to perform the RemoveItem operation on the 'FileSystem' provider failed for path 'C:\\Users\\roholt\\OneDrive - Microsoft\\Dev\\PowerShellEditorServices\\module\\PowerShellEditorServices\\bin'. Index (zero based) must be greater than or equal to zero and less than the size of the argument\r\nlist.\r\n    TargetSite     :\r\n        Name          : RemoveItem\r\n        DeclaringType : System.Management.Automation.SessionStateInternal\r\n        MemberType    : Method\r\n        Module        : System.Management.Automation.dll\r\n    StackTrace     :\r\n   at System.Management.Automation.SessionStateInternal.RemoveItem(CmdletProvider providerInstance, String path, Boolean recurse, CmdletProviderContext context)\r\n   at System.Management.Automation.SessionStateInternal.RemoveItem(String providerId, String path, Boolean recurse, CmdletProviderContext context)\r\n   at Microsoft.PowerShell.Commands.RemoveItemCommand.ProcessRecord()\r\n   at System.Management.Automation.CommandProcessor.ProcessRecord()\r\n    InnerException :\r\n        TargetSite :\r\n            Name          : AppendFormatHelper\r\n            DeclaringType : System.Text.StringBuilder\r\n            MemberType    : Method\r\n            Module        : System.Private.CoreLib.dll\r\n        StackTrace :\r\n   at System.Text.StringBuilder.AppendFormatHelper(IFormatProvider provider, String format, ParamsArray args)\r\n   at System.String.FormatHelper(IFormatProvider provider, String format, ParamsArray args)\r\n   at System.Management.Automation.Internal.StringUtil.Format(String formatSpec, Object o)\r\n   at Microsoft.PowerShell.Commands.FileSystemProvider.RemoveDirectoryInfoItem(DirectoryInfo directory, Boolean recurse, Boolean force, Boolean rootOfRemoval)\r\n   at Microsoft.PowerShell.Commands.FileSystemProvider.RemoveItem(String path, Boolean recurse)\r\n   at System.Management.Automation.SessionStateInternal.RemoveItem(CmdletProvider providerInstance, String path, Boolean recurse, CmdletProviderContext context)\r\n        Message    : Index (zero based) must be greater than or equal to zero and less than the size of the argument list.\r\n        Source     : System.Private.CoreLib\r\n        HResult    : -2146233033\r\n    Source         : System.Management.Automation\r\n    HResult        : -2146233087\r\nProviderInfo                : Microsoft.PowerShell.Core\\FileSystem\r\nErrorRecord                 :\r\n    Exception             :\r\n        TargetSite :\r\n            Name          : AppendFormatHelper\r\n            DeclaringType : System.Text.StringBuilder\r\n            MemberType    : Method\r\n            Module        : System.Private.CoreLib.dll\r\n        StackTrace :\r\n   at System.Text.StringBuilder.AppendFormatHelper(IFormatProvider provider, String format, ParamsArray args)\r\n   at System.String.FormatHelper(IFormatProvider provider, String format, ParamsArray args)\r\n   at System.Management.Automation.Internal.StringUtil.Format(String formatSpec, Object o)\r\n   at Microsoft.PowerShell.Commands.FileSystemProvider.RemoveDirectoryInfoItem(DirectoryInfo directory, Boolean recurse, Boolean force, Boolean rootOfRemoval)\r\n   at Microsoft.PowerShell.Commands.FileSystemProvider.RemoveItem(String path, Boolean recurse)\r\n   at System.Management.Automation.SessionStateInternal.RemoveItem(CmdletProvider providerInstance, String path, Boolean recurse, CmdletProviderContext context)\r\n        Message    : Index (zero based) must be greater than or equal to zero and less than the size of the argument list.\r\n        Source     : System.Private.CoreLib\r\n        HResult    : -2146233033\r\n    CategoryInfo          : NotSpecified: (:) [Remove-Item], FormatException\r\n    FullyQualifiedErrorId : System.FormatException,Microsoft.PowerShell.Commands.RemoveItemCommand\r\n    InvocationInfo        :\r\n        MyCommand        : Remove-Item\r\n        ScriptLineNumber : 1\r\n        OffsetInLine     : 1\r\n        HistoryId        : 34\r\n        Line             : Remove-Item \"$root/module/PowerShellEditorServices/bin\" -Recurse -Force -Verbose\r\n        PositionMessage  : At line:1 char:1\r\n                           + Remove-Item \"$root/module/PowerShellEditorServices/bin\" -Recurse -For \u2026\r\n                           + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n        InvocationName   : Remove-Item\r\n        CommandOrigin    : Internal\r\n    ScriptStackTrace      : at <ScriptBlock>, C:\\Users\\roholt\\OneDrive - Microsoft\\Dev\\PowerShellEditorServices\\PowerShellEditorServices.build.ps1: line 127\r\n                            at *Task, C:\\Users\\roholt\\Documents\\PowerShell\\Modules\\InvokeBuild\\5.4.1\\Invoke-Build.ps1: line 526\r\n                            at <ScriptBlock><End>, C:\\Users\\roholt\\Documents\\PowerShell\\Modules\\InvokeBuild\\5.4.1\\Invoke-Build.ps1: line 684\r\n                            at <ScriptBlock>, <No file>: line 1\r\n    PipelineIterationInfo :\r\n\r\n\r\n\r\nTargetSite                  :\r\n    Name          : Invoke\r\n    DeclaringType : System.Management.Automation.Runspaces.PipelineBase\r\n    MemberType    : Method\r\n    Module        : System.Management.Automation.dll\r\nStackTrace                  :\r\n   at System.Management.Automation.Runspaces.PipelineBase.Invoke(IEnumerable input)\r\n   at System.Management.Automation.PowerShell.Worker.ConstructPipelineAndDoWork(Runspace rs, Boolean performSyncInvoke)\r\n   at System.Management.Automation.PowerShell.CoreInvokeHelper[TInput,TOutput](PSDataCollection`1 input, PSDataCollection`1 output, PSInvocationSettings settings)\r\n   at System.Management.Automation.PowerShell.CoreInvoke[TInput,TOutput](PSDataCollection`1 input, PSDataCollection`1 output, PSInvocationSettings settings)\r\n   at System.Management.Automation.PowerShell.InvokeWithDebugger(IEnumerable`1 input, IList`1 output, PSInvocationSettings settings, Boolean invokeMustRun)\r\n   at System.Management.Automation.ScriptDebugger.ProcessCommand(PSCommand command, PSDataCollection`1 output)\r\n   at Microsoft.PowerShell.ConsoleHost.InputLoop.ProcessDebugCommand(String cmd, Exception& e)\r\nMessage                     : Index (zero based) must be greater than or equal to zero and less than the size of the argument list.\r\nData                        : System.Collections.ListDictionaryInternal\r\nInnerException              :\r\n    TargetSite :\r\n        Name          : AppendFormatHelper\r\n        DeclaringType : System.Text.StringBuilder\r\n        MemberType    : Method\r\n        Module        : System.Private.CoreLib.dll\r\n    StackTrace :\r\n   at System.Text.StringBuilder.AppendFormatHelper(IFormatProvider provider, String format, ParamsArray args)\r\n   at System.String.FormatHelper(IFormatProvider provider, String format, ParamsArray args)\r\n   at System.Management.Automation.Internal.StringUtil.Format(String formatSpec, Object o)\r\n   at Microsoft.PowerShell.Commands.FileSystemProvider.RemoveDirectoryInfoItem(DirectoryInfo directory, Boolean recurse, Boolean force, Boolean rootOfRemoval)\r\n   at Microsoft.PowerShell.Commands.FileSystemProvider.RemoveItem(String path, Boolean recurse)\r\n   at System.Management.Automation.SessionStateInternal.RemoveItem(CmdletProvider providerInstance, String path, Boolean recurse, CmdletProviderContext context)\r\n    Message    : Index (zero based) must be greater than or equal to zero and less than the size of the argument list.\r\n    Source     : System.Private.CoreLib\r\n    HResult    : -2146233033\r\nSource                      : System.Management.Automation\r\nHResult                     : -2146233087\r\n\r\n```\r\n\r\n# Environment data\r\n\r\n<!-- provide the output of $PSVersionTable -->\r\n\r\n```none\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.0.0-rc.2\r\nPSEdition                      Core\r\nGitCommitId                    7.0.0-rc.2\r\nOS                             Microsoft Windows 10.0.19535\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n\r\n```\r\n",
  "closed_at": "2021-06-22T23:00:05Z",
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": ".Net Core behavior https://github.com/dotnet/corefx/pull/28124",
      "created_at": "2020-01-30T06:44:21Z",
      "updated_at": "2020-01-30T06:44:21Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Dup #9246",
      "created_at": "2020-04-24T18:12:22Z",
      "updated_at": "2020-04-24T18:12:22Z"
    },
    {
      "author": "msftbot[bot]",
      "author_association": "NONE",
      "body": "This issue has been marked as duplicate and has not had any activity for **1 day**. It has been closed for housekeeping purposes.",
      "created_at": "2021-06-22T23:00:04Z",
      "updated_at": "2021-06-22T23:00:04Z"
    }
  ],
  "created_at": "2020-01-29T18:00:52Z",
  "labels": [
    "Issue-Bug",
    "Resolution-Duplicate",
    "WG-Cmdlets-Management"
  ],
  "number": 11721,
  "state": "closed",
  "title": "Unable to delete OneDrive-tracked directories with Remove-Item",
  "updated_at": "2021-06-22T23:00:05Z"
}
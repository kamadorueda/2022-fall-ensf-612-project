{
  "_url": "https://github.com/PowerShell/PowerShell/issues/7941",
  "author": "romero126",
  "body": "## PR Summary\r\nThe Proposed change Allows for the capability to specify a specific SessionState to Variable Cmdlet's\r\n\r\nExample:\r\n```\r\n    $Module = New-Module -Name \"TestVariables\" {\r\n        $script:TestGetVariable = \"True\"\r\n        $script:TestSetVariable = \"Set\"\r\n        $script:TestClearVariable = \"ShouldBeBlank\"\r\n        $Script:TestRemoveVariable = \"Should Not Exist\"\r\n\r\n        write-host \"Finished Loading Module\"\r\n    }\r\n    $Module = Import-Module $Module -PassThru\r\n    New-Variable -SessionStateEntry $Module.SessionState -Name \"TestNewVariable\" -Value \"True\"\r\n    Set-Variable -SessionStateEntry $Module.SessionState -Name \"TestSetVariable\" -Value \"True\"\r\n    Clear-Variable -SessionStateEntry $Module.SessionState -Name \"TestClearVariable\"\r\n    Remove-Variable -SessionStateEntry $Module.SessionState -Name \"TestRemoveVariable\"\r\n    Get-Variable -SessionStateEntry $Module.SessionState -Name \"Test*\"\r\n```\r\n\r\n\r\n## PR Checklist\r\n\r\n- [X] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - Change Implements a new Parameter to Get/Set/Remove/Clear/New Variable to allow for retrieval of variables outside of current SessionState. \r\n    -\r\n\r\n- [x] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n   - Change is specific to Microsoft.PowerShell.Commands.Utility/commands/utility/Var.cs\r\n   - Updates Helper Functions to allow for specific SessionState Functions.\r\n   - \r\n\r\n- [X] [Change is not breaking](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)\r\n   - Change passes all of the MS Included Pester Tests\r\n- [X] [Make sure all `.h`, `.cpp`, `.cs`, `.ps1` and `.psm1` files have the correct copyright header](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    \r\n- [X] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - This PR is complete and should not be a breaking change. \r\n- **User-facing changes**\r\n    - [ ] Not Applicable\r\n    - **OR**\r\n    - [X] User-facing [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n        - [ ] Issue filed - Issue link:\r\n- **Testing - New and feature**\r\n    - [ ] Not Applicable or can only be tested interactively\r\n    - **OR**\r\n    - [ ] [Make sure you've added a new test if existing tests do not effectively test the code changed]\r\n(https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n        - [ ] [Add `[feature]` if the change is significant or affects feature tests](https://github.com/PowerShell/PowerShell/blob/master/docs/testing-guidelines/testing-guidelines.md#requesting-additional-tests-for-a-pr)\r\n",
  "closed_at": "2018-11-14T23:52:26Z",
  "comments": [
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "There were some significant problems with your branch.  I manually rebased your branch and removed some duplicate commits which made the PR hard to review and you had added some files which were not part of the repo any more back, I removed those from your commits.",
      "created_at": "2018-10-03T22:37:01Z",
      "updated_at": "2018-10-03T22:37:01Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "Well... I thought I had...",
      "created_at": "2018-10-03T22:38:29Z",
      "updated_at": "2018-10-03T22:38:29Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "Okay, the rebase is done now.",
      "created_at": "2018-10-03T22:44:45Z",
      "updated_at": "2018-10-03T22:44:45Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "cc @PaulHigin ",
      "created_at": "2018-10-03T23:03:17Z",
      "updated_at": "2018-10-03T23:03:17Z"
    },
    {
      "author": "lzybkr",
      "author_association": "MEMBER",
      "body": "This looks like an alternative to the obscure syntax of specifying a module:\r\n\r\n```powershell\r\n& (Get-Module $myModule) Set-Variable -Name Something -Value $True\r\n```\r\n\r\nThis current syntax should be disallowed in restricted language mode, and hence I believe this new parameter should also not work in restricted language mode.",
      "created_at": "2018-10-03T23:15:38Z",
      "updated_at": "2018-10-03T23:15:38Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "@lzybkr are you referring to `StrictMode` or `Constrained Language Mode`?",
      "created_at": "2018-10-04T00:54:03Z",
      "updated_at": "2018-10-04T00:54:03Z"
    },
    {
      "author": "lzybkr",
      "author_association": "MEMBER",
      "body": "I'm referring to `System.Management.Automation.PSLanguageMode`, the relevant modes here I think are `RestrictedLanguage` and `ConstrainedLanguage`.",
      "created_at": "2018-10-04T01:17:32Z",
      "updated_at": "2018-10-04T01:17:32Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "Gotcha -- those ones are in `SessionState.LanguageMode`, right? Shouldn't be too tricky for ya @romero126 \ud83d\ude09 ",
      "created_at": "2018-10-04T01:21:00Z",
      "updated_at": "2018-10-04T01:21:00Z"
    },
    {
      "author": "romero126",
      "author_association": "CONTRIBUTOR",
      "body": "So my question is wouldn't we only want it to run correctly in FullLanguage mode?  ConstrainedLanguage, NoLanguage,RestrictedLanguage based on the descriptions all of them make restrictions on the Language in some way shape or form. ",
      "created_at": "2018-10-04T04:30:06Z",
      "updated_at": "2018-10-04T04:30:06Z"
    },
    {
      "author": "PaulHigin",
      "author_association": "COLLABORATOR",
      "body": "I agree with @lzybkr that this needs to work correctly with language modes.  Unfortunately I haven't had a chance to look at this closely yet, and probably won't until next week.  At the very least we should postpone this change until @daxian-dbw untrusted input tracking work is merged.  Then this change can follow that pattern to conform to language modes.",
      "created_at": "2018-10-04T23:03:09Z",
      "updated_at": "2018-10-04T23:03:09Z"
    },
    {
      "author": "romero126",
      "author_association": "CONTRIBUTOR",
      "body": "I Agree that we need to make certain LanguageMode is considered and handled carefully Without introducing redundancy in code.\r\n\r\nIf there is a way to pull the most current sessionstate. I believe the best solution would be to create a SetLanguageModeAttribute() and just attach it to the Parameter it would be the best and cleanest implementation.",
      "created_at": "2018-10-04T23:12:14Z",
      "updated_at": "2018-10-04T23:12:14Z"
    },
    {
      "author": "JamesWTruher",
      "author_association": "MEMBER",
      "body": "@romero126 I really like this, but I'm wondering if this isn't just manipulating the variable in another \"scope\", and whether the current scope parameter should be made smarter to accept the module sessionstate in addition to what it does today?\r\nEven if we take the behavior as submitted, with a change of such impact, we really need to see a set of tests which validate the new behavior.",
      "created_at": "2018-10-25T23:28:34Z",
      "updated_at": "2018-10-25T23:30:11Z"
    },
    {
      "author": "romero126",
      "author_association": "CONTRIBUTOR",
      "body": "@JamesWTruher This is a great idea. I really do like the idea putting this into the scope argument. Let me see what I can come up with, to implement this idea.\r\n\r\nAs well as working on getting some good pester tests in place.",
      "created_at": "2018-10-29T22:08:20Z",
      "updated_at": "2018-10-29T22:08:20Z"
    }
  ],
  "created_at": "2018-10-03T19:19:22Z",
  "number": 7941,
  "state": "closed",
  "title": "WIP: VariableFunctions outside of SessionState Capability",
  "updated_at": "2019-07-17T22:22:46Z"
}
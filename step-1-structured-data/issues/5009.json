{
  "_url": "https://github.com/PowerShell/PowerShell/issues/5009",
  "author": "PaulHigin",
  "body": "Fix test setup that was using New-PSSession instead of the helper function New-RemoteSession that works with AppVeyor.  Re-enabled the pending test since it now works.  Also added check to ensure WinRM remoting is enabled and an endpoint is available for PowerShell 6.0.",
  "closed_at": "2017-10-05T23:16:21Z",
  "comments": [
    {
      "author": "PaulHigin",
      "author_association": "COLLABORATOR",
      "body": "I didn't think of that.  Ok, will do.\r\n",
      "created_at": "2017-10-05T15:36:53Z",
      "updated_at": "2017-10-05T15:36:53Z"
    },
    {
      "author": "PaulHigin",
      "author_association": "COLLABORATOR",
      "body": "I'll use the same patter as with PSSessionConfiguration.Tests.ps1",
      "created_at": "2017-10-05T16:13:15Z",
      "updated_at": "2017-10-05T16:13:15Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "There is one test failure:\r\n```\r\n [-] Validate Invoke-WebRequest error with -Proxy option set - 'http_proxy' 5.33s\r\n   Expected: {System.Threading.Tasks.TaskCanceledException,Microsoft.PowerShell.Commands.InvokeWebRequestCommand}\r\n   But was:  {}\r\n   at line: 558 in /Users/travis/build/PowerShell/PowerShell/test/powershell/Modules/Microsoft.PowerShell.Utility/WebCmdlets.Tests.ps1\r\n   558:         $result.Error.FullyQualifiedErrorId | Should Be \"System.Threading.Tasks.TaskCanceledException,Microsoft.PowerShell.Commands.InvokeWebRequestCommand\"\r\n```\r\n\r\n@SteveL-MSFT Is this failure also due to a race condition between the test and the test service?  I think it's not related to this PR.",
      "created_at": "2017-10-05T21:31:16Z",
      "updated_at": "2017-10-05T21:31:16Z"
    },
    {
      "author": "PaulHigin",
      "author_association": "COLLABORATOR",
      "body": "No, it is not related to this PR.  I am trying to rebase to see if a new version of the Invoke-WebRequest tests fixes the issue.",
      "created_at": "2017-10-05T21:58:49Z",
      "updated_at": "2017-10-05T21:58:49Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@daxian-dbw yes, that is the race condition between the web service waiting on a delay and the test waiting on a timeout",
      "created_at": "2017-10-05T22:14:18Z",
      "updated_at": "2017-10-05T22:14:18Z"
    }
  ],
  "created_at": "2017-10-04T20:48:15Z",
  "number": 5009,
  "state": "closed",
  "title": "Fix for impliict remoting test",
  "updated_at": "2017-10-06T14:16:07Z"
}
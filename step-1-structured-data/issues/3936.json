{
  "_url": "https://github.com/PowerShell/PowerShell/issues/3936",
  "author": "zacateras",
  "body": "#3212",
  "closed_at": "2018-03-12T17:40:00Z",
  "comments": [
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@iSazonov if you have time, could you please review this PR?",
      "created_at": "2017-06-06T05:17:29Z",
      "updated_at": "2017-06-06T05:17:29Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@zacateras Thanks for your work! I have question about the algorithm that I addressed to PowerShell team - please wait the conclusion before continue.\r\n\r\nAlso we haven't tests for the cmdlet - you should add its and pass CI before we can merge.",
      "created_at": "2017-06-06T12:04:26Z",
      "updated_at": "2017-06-06T12:04:26Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT The algorithm is broken! Please see my comment above https://github.com/PowerShell/PowerShell/pull/3936#discussion_r121588232 I believe we cannot merge the PR. ",
      "created_at": "2017-07-19T17:49:27Z",
      "updated_at": "2017-07-19T17:49:27Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@daxian-dbw Can we use [System.DirectoryService](https://dotnet.myget.org/feed/dotnet-core/package/nuget/System.DirectoryServices) or before we should move to 4.5.0 version ?",
      "created_at": "2017-07-31T14:26:24Z",
      "updated_at": "2017-07-31T14:26:24Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@zacateras Do you plan to continue?",
      "created_at": "2017-08-03T12:11:48Z",
      "updated_at": "2017-08-03T12:11:48Z"
    },
    {
      "author": "zacateras",
      "author_association": "NONE",
      "body": "@iSazonov yep. I thought that we are waiting for some external review.\r\n",
      "created_at": "2017-08-03T23:33:09Z",
      "updated_at": "2017-08-03T23:33:09Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "Now that Beta.5 is out, I'll spend time on this tomorrow",
      "created_at": "2017-08-04T01:19:40Z",
      "updated_at": "2017-08-04T01:19:40Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "We should follow MSDN docs - see my comment above.",
      "created_at": "2017-08-04T03:35:50Z",
      "updated_at": "2017-08-04T03:35:50Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT Could you please continue?",
      "created_at": "2017-08-24T10:19:33Z",
      "updated_at": "2017-08-24T10:19:33Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "Sorry this took so long, got randomized by other things.  I also compared the result with \r\n\r\n```powershell\r\nConvertFrom-SddlString \"D:(A;;FA;;;SY)(A;;FA;;;BA)\"\r\n```\r\n\r\n```powershell\r\n# old script version\r\nDiscretionaryAcl : {NT AUTHORITY\\SYSTEM: AccessAllowed (ChangePermissions, CreateDirectories, Delete, DeleteSubdirectoriesAndFiles, ExecuteKey, FullControl,\r\n                   FullControl, FullControl, FullControl, ListDirectory, Modify, Read, ReadAndExecute, ReadAttributes, ReadExtendedAttributes,\r\n                   ReadPermissions, Synchronize, TakeOwnership, Traverse, Write, WriteAttributes, WriteData, WriteExtendedAttributes, WriteKey),\r\n                   BUILTIN\\Administrators: AccessAllowed (ChangePermissions, CreateDirectories, Delete, DeleteSubdirectoriesAndFiles, ExecuteKey, FullControl,\r\n                   FullControl, FullControl, FullControl, ListDirectory, Modify, Read, ReadAndExecute, ReadAttributes, ReadExtendedAttributes,\r\n                   ReadPermissions, Synchronize, TakeOwnership, Traverse, Write, WriteAttributes, WriteData, WriteExtendedAttributes, WriteKey)}\r\n```\r\n\r\n```powershell\r\n# c# version\r\nDiscretionaryAcl : {NT AUTHORITY\\SYSTEM: AccessAllowed (AppendData, ChangePermissions, CreateFiles, Delete, DeleteSubdirectoriesAndFiles, ExecuteFile,\r\n                   FullControl, FullControl, FullControl, FullControl, Modify, Read, ReadAndExecute, ReadAttributes, ReadData, ReadExtendedAttributes,\r\n                   ReadKey, ReadPermissions, Synchronize, TakeOwnership, Write, WriteAttributes, WriteExtendedAttributes, WriteKey), BUILTIN\\Administrators:\r\n                   AccessAllowed (AppendData, ChangePermissions, CreateFiles, Delete, DeleteSubdirectoriesAndFiles, ExecuteFile, FullControl, FullControl,\r\n                   FullControl, FullControl, Modify, Read, ReadAndExecute, ReadAttributes, ReadData, ReadExtendedAttributes, ReadKey, ReadPermissions,\r\n                   Synchronize, TakeOwnership, Write, WriteAttributes, WriteExtendedAttributes, WriteKey)}\r\n```\r\n\r\nAnd the newer version has more permissions (although not sure if the old one was wrong).\r\n\r\n",
      "created_at": "2017-08-29T00:51:44Z",
      "updated_at": "2017-08-29T00:52:02Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT Did you look [my comment](https://github.com/PowerShell/PowerShell/pull/3936#discussion_r121588232) above? Main is \"SDDL has no meaning without object entity - the cmdlet should get the object type as argument.\"\r\n\r\n",
      "created_at": "2017-08-29T06:02:59Z",
      "updated_at": "2017-08-29T06:02:59Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@iSazonov Seems like if you have the object, you would be using `Get-Acl`.  `ConvertFrom-SDDLString` is more likely used when you have just the SDDL and just want to understand (perhaps roughly) what it represents.  Not sure how useful this is if you require the object.",
      "created_at": "2017-08-29T15:57:30Z",
      "updated_at": "2017-08-29T15:57:30Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT My idea is that we should make `-Type` mandatory.",
      "created_at": "2017-08-29T17:28:53Z",
      "updated_at": "2017-08-29T17:28:53Z"
    },
    {
      "author": "zacateras",
      "author_association": "NONE",
      "body": "@iSazonov If AccessMask is presented using [well known aliases](https://github.com/tpn/winsdk-10/blob/master/Include/10.0.10240.0/shared/sddl.h#L126) then it can be parsed entirely without the knowledge of securable object type (Type parameter).\r\n\r\nIn case of numerical AccessMasks (eg. 0x02142512) we can translate only higher [16-32bits](https://msdn.microsoft.com/pl-pl/library/windows/desktop/aa374896(v=vs.85).aspx) if the Type is not provided (lower bits can remain unparsed as a reminder). If the Type parameter is present then specific rights scheme could be used - according to constant definitions in [winnt.h](https://source.winehq.org/source/include/winnt.h). Also more securable object types can be considered - according to the list in [docs](https://msdn.microsoft.com/en-us/library/aa379557(VS.85).aspx).\r\n\r\nI started an implementation of SDDL parser using the documentation. The code can be found [here](https://github.com/zacateras/sddl-parser) (with examples [here](https://github.com/zacateras/sddl-parser/blob/master/test/Sddl.Parser.Tests/SddlTests.cs)). If we want to use parts of the implemented approach then I can integrate its simplified form into the command.\r\n\r\nWhat do you think about such solution?",
      "created_at": "2017-08-29T21:24:20Z",
      "updated_at": "2017-08-29T21:25:09Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@zacateras I still don't understand the need for this heuristic. For which scenarios is it addressed? As for me it looks like a trasformation enum1 -> int -> enum2 - what's confusing.",
      "created_at": "2017-09-04T12:46:41Z",
      "updated_at": "2017-09-04T12:46:41Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "This PR has been left unattended for a long time. I will close this PR for now.\r\n@zacateras Please feel free to reopen it if you decide to continue on it at a later time.",
      "created_at": "2018-03-12T17:39:59Z",
      "updated_at": "2018-03-12T17:39:59Z"
    }
  ],
  "created_at": "2017-06-05T18:17:53Z",
  "number": 3936,
  "state": "closed",
  "title": "Rewrite convertfrom sddlstring in csharp",
  "updated_at": "2018-03-12T17:40:00Z"
}
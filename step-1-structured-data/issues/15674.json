{
  "_url": "https://github.com/PowerShell/PowerShell/issues/15674",
  "author": "xtqqczze",
  "body": "Enable [CA1812: Avoid uninstantiated internal classes](https://docs.microsoft.com/dotnet/fundamentals/code-analysis/quality-rules/ca1812)\r\n\r\nAdd suppression for classes instantiated with `System.Activator.CreateInstance`.",
  "closed_at": "2021-06-27T15:16:18Z",
  "comments": [
    {
      "author": "xtqqczze",
      "author_association": "CONTRIBUTOR",
      "body": "```\r\nD:\\a\\1\\s\\src\\Microsoft.Management.UI.Internal\\commandHelpers\\OutGridView.cs(21,20): error CA1812: OutGridViewWindow is an internal class that is apparently never instantiated. If so, remove the code from the assembly. If this class is intended to contain only static members, make it static (Shared in Visual Basic). [D:\\a\\1\\s\\src\\Microsoft.Management.UI.Internal\\Microsoft.PowerShell.GraphicalHost_j30bp2hs_wpftmp.csproj]\r\nD:\\a\\1\\s\\src\\Microsoft.Management.UI.Internal\\ManagementList\\Common\\WeakEventListener.cs(13,20): error CA1812: WeakEventListener<TEventArgs> is an internal class that is apparently never instantiated. If so, remove the code from the assembly. If this class is intended to contain only static members, make it static (Shared in Visual Basic). [D:\\a\\1\\s\\src\\Microsoft.Management.UI.Internal\\Microsoft.PowerShell.GraphicalHost_j30bp2hs_wpftmp.csproj]\r\nD:\\a\\1\\s\\src\\Microsoft.Management.UI.Internal\\commandHelpers\\ShowCommandHelper.cs(26,20): error CA1812: ShowCommandHelper is an internal class that is apparently never instantiated. If so, remove the code from the assembly. If this class is intended to contain only static members, make it static (Shared in Visual Basic). [D:\\a\\1\\s\\src\\Microsoft.Management.UI.Internal\\Microsoft.PowerShell.GraphicalHost_j30bp2hs_wpftmp.csproj]\r\n```\r\n\r\nI thought we had suppressed analyzers in `Microsoft.Management.UI.Internal`, now this is ineffective?\r\n\r\nhttps://github.com/PowerShell/PowerShell/blob/756aef9a8670fad089507f35023301a90b01d32f/src/Microsoft.Management.UI.Internal/.globalconfig#L1-L3\r\n",
      "created_at": "2021-06-25T15:31:54Z",
      "updated_at": "2021-06-25T15:31:54Z"
    },
    {
      "author": "xtqqczze",
      "author_association": "CONTRIBUTOR",
      "body": "The `Microsoft.Management.UI.Internal` analyzers issue is resolved in #15677 by setting `RunAnalyzers` to `false` in `Microsoft.PowerShell.GraphicalHost.csproj`.",
      "created_at": "2021-06-25T15:34:40Z",
      "updated_at": "2021-07-04T20:56:08Z"
    },
    {
      "author": "msftbot[bot]",
      "author_association": "NONE",
      "body": ":tada:`v7.2.0-preview.8` has been released which incorporates this pull request.:tada:\n\nHandy links:\n* [Release Notes](https://github.com/PowerShell/PowerShell/releases/tag/v7.2.0-preview.8)\n",
      "created_at": "2021-07-22T21:40:31Z",
      "updated_at": "2021-07-22T21:40:31Z"
    }
  ],
  "created_at": "2021-06-25T14:04:07Z",
  "number": 15674,
  "state": "closed",
  "title": "Enable CA1812: Avoid uninstantiated internal classes",
  "updated_at": "2021-07-22T21:40:31Z"
}
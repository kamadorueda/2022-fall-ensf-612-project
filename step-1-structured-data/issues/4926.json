{
  "_url": "https://github.com/PowerShell/PowerShell/issues/4926",
  "author": "JamesWTruher",
  "body": "This PR also removes code protected by #!CORE in Computer.cs which removed a very large amount of code.\r\n\r\nIn order to test without actually rebooting the system, I implemented a number of InternalTestHooks to avoid making the call to actually calling the CIM method to actually reboot/halt the system. While I was in the code I simplified a number of parameters, especially throttling, which was way more complicated than it needed to be.\r\n\r\nthe breaking change is specific to parameter values which were silently \"corrected\" for throttling (which FWIW isn't even implemented)\r\n\r\nFix https://github.com/PowerShell/PowerShell/issues/4146",
  "closed_at": "2017-10-26T19:43:01Z",
  "comments": [
    {
      "author": "dantraMSFT",
      "author_association": "CONTRIBUTOR",
      "body": ">                 throttlelimit = value;\r\n\r\nShouldn't this logic remain for cases where the cmdlet is called programmatically?\r\n\r\n---\r\nRefers to: src/Microsoft.PowerShell.Commands.Management/commands/management/Computer.cs:207 in e283582. [](commit_id = e28358202134177049fe78beba58357ff878b888, deletion_comment = True)",
      "created_at": "2017-09-26T23:09:03Z",
      "updated_at": "2017-09-26T23:09:03Z"
    },
    {
      "author": "dantraMSFT",
      "author_association": "CONTRIBUTOR",
      "body": ">         [ValidateSet(ComputerWMIHelper.DcomProtocol, ComputerWMIHelper.WsmanProtocol)]\r\n\r\nThe ValidateSet should be updated as well.\r\n\r\n---\r\nRefers to: src/Microsoft.PowerShell.Commands.Management/commands/management/Computer.cs:102 in e283582. [](commit_id = e28358202134177049fe78beba58357ff878b888, deletion_comment = False)",
      "created_at": "2017-09-26T23:11:15Z",
      "updated_at": "2017-09-26T23:11:15Z"
    },
    {
      "author": "dantraMSFT",
      "author_association": "CONTRIBUTOR",
      "body": ">         [ValidateSet(ComputerWMIHelper.DcomProtocol, ComputerWMIHelper.WsmanProtocol)]\r\n\r\nI also think that validation should occur here, since it is removed from BeginProcessing.\r\n\r\n---\r\nIn reply to: [332362109](https://github.com/PowerShell/PowerShell/pull/4926#issuecomment-332362109) [](ancestors = 332362109)\r\n\r\n---\r\nRefers to: src/Microsoft.PowerShell.Commands.Management/commands/management/Computer.cs:102 in e283582. [](commit_id = e28358202134177049fe78beba58357ff878b888, deletion_comment = False)",
      "created_at": "2017-09-26T23:14:04Z",
      "updated_at": "2017-09-26T23:14:04Z"
    },
    {
      "author": "dantraMSFT",
      "author_association": "CONTRIBUTOR",
      "body": ">             switch (_transportProtocol)\r\n\r\nIs the switch statement unnecessary? The transport can only be one value.\r\n\r\n---\r\nRefers to: src/Microsoft.PowerShell.Commands.Management/commands/management/Computer.cs:283 in e283582. [](commit_id = e28358202134177049fe78beba58357ff878b888, deletion_comment = False)",
      "created_at": "2017-09-26T23:15:20Z",
      "updated_at": "2017-09-26T23:15:20Z"
    },
    {
      "author": "dantraMSFT",
      "author_association": "CONTRIBUTOR",
      "body": ">         [ValidateSet(ComputerWMIHelper.DcomProtocol, ComputerWMIHelper.WsmanProtocol)]\r\n\r\nThe same comments as above; the ValidateSet should be updated and validation inserted to ensure only WsmanProtocol\r\n\r\n---\r\nRefers to: src/Microsoft.PowerShell.Commands.Management/commands/management/Computer.cs:713 in e283582. [](commit_id = e28358202134177049fe78beba58357ff878b888, deletion_comment = False)",
      "created_at": "2017-09-26T23:30:49Z",
      "updated_at": "2017-09-26T23:30:49Z"
    },
    {
      "author": "JamesWTruher",
      "author_association": "MEMBER",
      "body": "I hadn't intended a complete overhaul, but that's what it looks like is needed. I will update accordingly",
      "created_at": "2017-09-27T17:21:45Z",
      "updated_at": "2017-09-27T17:21:45Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "Added issue this fixes",
      "created_at": "2017-10-02T03:55:24Z",
      "updated_at": "2017-10-02T03:55:24Z"
    }
  ],
  "created_at": "2017-09-26T22:41:59Z",
  "number": 4926,
  "state": "closed",
  "title": "Add Tests for *-computer cmdlets",
  "updated_at": "2022-05-11T16:35:34Z"
}
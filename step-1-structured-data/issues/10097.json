{
  "_url": "https://github.com/PowerShell/PowerShell/issues/10097",
  "author": "pfurches",
  "body": "# Steps to reproduce\r\n```\r\nImport-Module -Name DellBIOSProvider -Verbose\r\n```\r\n\r\n# Expected behavior\r\n```\r\nVERBOSE: Loading module from path 'C:\\Program Files\\WindowsPowerShell\\Modules\\DellBIOSProvider\\DellBIOSProvider.psd1'.\r\nVERBOSE: Loading module from path 'C:\\Program Files\\WindowsPowerShell\\Modules\\DellBIOSProvider\\DellBIOSProvider.psm1'.\r\nVERBOSE: Exporting function 'Set-Dell1stBootdevice'.\r\nVERBOSE: Exporting function 'Get-DellBiosSettings'.\r\nVERBOSE: Exporting function 'Clear-DellAdminPassword'.\r\nVERBOSE: Exporting function 'Set-DellAutoOnForSelectDays'.\r\nVERBOSE: Exporting function 'Get-DellBIOSPasswordPath'.\r\nVERBOSE: Exporting function 'Write-DellBIOSPassword'.\r\nVERBOSE: Exporting function 'Read-DellBIOSPassword'.\r\nVERBOSE: Importing function 'Clear-DellAdminPassword'.\r\nVERBOSE: Importing function 'Get-DellBIOSPasswordPath'.\r\nVERBOSE: Importing function 'Get-DellBiosSettings'.\r\nVERBOSE: Importing function 'Read-DellBIOSPassword'.\r\nVERBOSE: Importing function 'Set-Dell1stBootdevice'.\r\nVERBOSE: Importing function 'Set-DellAutoOnForSelectDays'.\r\nVERBOSE: Importing function 'Write-DellBIOSPassword'.\r\nVERBOSE: Loading module from path 'C:\\Program Files\\WindowsPowerShell\\Modules\\DellBIOSProvider\\DellBIOSProvider.dll'.\r\nVERBOSE: Starting PS provider DellSmbiosProv\r\nVERBOSE: .NET Version: 4.0.30319.42000\r\nVERBOSE: Performing InitializeDefaultDrives operation on the 'DellSmbiosProv'provider.\r\nVERBOSE: Performing operation New-PSDrive for the provider DellSmbiosProv.\r\nVERBOSE: Category 'BIOSSetupAdvancedMode' does not contain any supported attributes.\r\nVERBOSE: Category 'AdvancedConfigurations' does not contain any supported attributes.\r\nVERBOSE: Category 'SupportAssistSystemResolution' does not contain any supported attributes.\r\nVERBOSE: Category 'ThermalConfiguration' does not contain any supported attributes.\r\nVERBOSE: To get more help about the Dell Command PowerShell provider, type Get-Help DellBIOSProvider.\r\nVERBOSE: Exporting function 'Clear-DellAdminPassword'.\r\nVERBOSE: Exporting function 'Get-DellBIOSPasswordPath'.\r\nVERBOSE: Exporting function 'Get-DellBiosSettings'.\r\nVERBOSE: Exporting function 'Read-DellBIOSPassword'.\r\nVERBOSE: Exporting function 'Set-Dell1stBootdevice'.\r\nVERBOSE: Exporting function 'Set-DellAutoOnForSelectDays'.\r\nVERBOSE: Exporting function 'Write-DellBIOSPassword'.\r\nVERBOSE: Importing function 'Clear-DellAdminPassword'.\r\nVERBOSE: Importing function 'Get-DellBIOSPasswordPath'.\r\nVERBOSE: Importing function 'Get-DellBiosSettings'.\r\nVERBOSE: Importing function 'Read-DellBIOSPassword'.\r\nVERBOSE: Importing function 'Set-Dell1stBootdevice'.\r\nVERBOSE: Importing function 'Set-DellAutoOnForSelectDays'.\r\nVERBOSE: Importing function 'Write-DellBIOSPassword'.```\r\n```\r\n\r\n# Actual behavior\r\n\r\nError loading PSDrive:\r\n\r\n```\r\nVERBOSE: Loading module from path 'C:\\Program Files\\WindowsPowerShell\\Modules\\DellBIOSProvider\\DellBIOSProvider.psd1'.\r\nVERBOSE: Loading module from path 'C:\\Program Files\\WindowsPowerShell\\Modules\\DellBIOSProvider\\DellBIOSProvider.psm1'.\r\nVERBOSE: Exporting function 'Set-Dell1stBootdevice'.\r\nVERBOSE: Exporting function 'Get-DellBiosSettings'.\r\nVERBOSE: Exporting function 'Clear-DellAdminPassword'.\r\nVERBOSE: Exporting function 'Set-DellAutoOnForSelectDays'.\r\nVERBOSE: Exporting function 'Get-DellBIOSPasswordPath'.\r\nVERBOSE: Exporting function 'Write-DellBIOSPassword'.\r\nVERBOSE: Exporting function 'Read-DellBIOSPassword'.\r\nVERBOSE: Importing function 'Clear-DellAdminPassword'.\r\nVERBOSE: Importing function 'Get-DellBIOSPasswordPath'.\r\nVERBOSE: Importing function 'Get-DellBiosSettings'.\r\nVERBOSE: Importing function 'Read-DellBIOSPassword'.\r\nVERBOSE: Importing function 'Set-Dell1stBootdevice'.\r\nVERBOSE: Importing function 'Set-DellAutoOnForSelectDays'.\r\nVERBOSE: Importing function 'Write-DellBIOSPassword'.\r\nVERBOSE: Loading module from path 'C:\\Program Files\\WindowsPowerShell\\Modules\\DellBIOSProvider\\DellBIOSProvider.dll'.\r\nVERBOSE: Starting PS provider DellSmbiosProv\r\nVERBOSE: .NET Version: 4.0.30319.42000\r\nVERBOSE: Performing InitializeDefaultDrives operation on the 'DellSmbiosProv'provider.\r\nImport-Module : The type initializer for '<Module>' threw an exception.\r\nAt line:1 char:1\r\n+ Import-Module -Name DellBIOSProvider -Verbose\r\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+ CategoryInfo          : InvalidOperation: (:) [Import-Module], TypeInitializationException\r\n+ FullyQualifiedErrorId : NewDriveProviderException,Microsoft.PowerShell.Commands.ImportModuleCommand\r\n\r\nVERBOSE: Exporting function 'Clear-DellAdminPassword'.\r\nVERBOSE: Exporting function 'Get-DellBIOSPasswordPath'.\r\nVERBOSE: Exporting function 'Get-DellBiosSettings'.\r\nVERBOSE: Exporting function 'Read-DellBIOSPassword'.\r\nVERBOSE: Exporting function 'Set-Dell1stBootdevice'.\r\nVERBOSE: Exporting function 'Set-DellAutoOnForSelectDays'.\r\nVERBOSE: Exporting function 'Write-DellBIOSPassword'.\r\nVERBOSE: Importing function 'Clear-DellAdminPassword'.\r\nVERBOSE: Importing function 'Get-DellBIOSPasswordPath'.\r\nVERBOSE: Importing function 'Get-DellBiosSettings'.\r\nVERBOSE: Importing function 'Read-DellBIOSPassword'.\r\nVERBOSE: Importing function 'Set-Dell1stBootdevice'.\r\nVERBOSE: Importing function 'Set-DellAutoOnForSelectDays'.\r\nVERBOSE: Importing function 'Write-DellBIOSPassword'.\r\n```\r\n\r\n```\r\n\r\n# Environment data\r\nPowershell Core 6.2.1\r\nWindows 10 1803, 1809 and 1903 Enterprise\r\nDell BIOS Provider 2.2\r\n\r\nPS C:\\> $PSVersionTable\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      6.2.1\r\nPSEdition                      Core\r\nGitCommitId                    6.2.1\r\nOS                             Microsoft Windows 10.0.17134\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n\r\n```\r\n\r\n![PScore-Error](https://user-images.githubusercontent.com/7400863/61008724-5fad3f00-a33e-11e9-8a53-4d9bcec421d3.PNG)\r\n",
  "closed_at": "2019-07-11T19:10:01Z",
  "comments": [
    {
      "author": "rjmholt",
      "author_association": "COLLABORATOR",
      "body": "The error message you're getting indicates that this is a module written in Managed C++, which is incompatible with PowerShell 6.2.1.\r\n\r\nYou can try it with PowerShell 7-preview.1 and see if it works in that; .NET Core 3.0 has added some support that enables loading of some Managed C++ modules.",
      "created_at": "2019-07-10T23:16:47Z",
      "updated_at": "2019-07-10T23:16:47Z"
    },
    {
      "author": "pfurches",
      "author_association": "NONE",
      "body": "You are right. It works in PS 7 preview 1. Thanks rjmholt!",
      "created_at": "2019-07-11T15:03:17Z",
      "updated_at": "2019-07-11T15:03:17Z"
    }
  ],
  "created_at": "2019-07-10T22:14:09Z",
  "labels": [
    "Issue-Question",
    "Resolution-Answered"
  ],
  "number": 10097,
  "state": "closed",
  "title": "Import-Module : The type initializer for '<Module>' threw an exception.",
  "updated_at": "2019-07-11T19:10:01Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/6660",
  "author": "bergmeister",
  "body": "## PR Summary\r\n\r\nFixes #6598 by using PR #6612 that adds a `-WorkingDirectory` parameter on `pwsh.exe` that this PR uses in order to make the explorer context menu also work when the path contains a single quote.\r\nTechnical note: `&quot;` is an escape character for a double quote in WiX.\r\nNote that this bug also occurs for the Windows PowerShell Explorer integration in Windows 10.\r\n\r\n## PR Checklist\r\n\r\n- [x] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - Use the present tense and imperative mood when describing your changes\r\n- [x] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] [Change is not breaking](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)\r\n- [x] [Make sure all `.h`, `.cpp`, `.cs`, `.ps1` and `.psm1` files have the correct copyright header](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [ ] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - If the PR is work in progress, please add the prefix `WIP:` to the beginning of the title and remove the prefix when the PR is ready.\r\n- **User-facing changes**\r\n    - [ ] Not Applicable\r\n    - **OR**\r\n    - [ ] User-facing [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n        - [ ] Issue filed - Issue link:\r\n- **Testing - New and feature**\r\n    - [ ] Not Applicable or can only be tested interactively\r\n    - **OR**\r\n    - [ ] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n        - [ ] [Add `[feature]` if the change is significant or affects feature tests](https://github.com/PowerShell/PowerShell/blob/master/docs/testing-guidelines/testing-guidelines.md#requesting-additional-tests-for-a-pr)\r\n",
  "closed_at": "2018-04-25T00:03:15Z",
  "comments": [
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "Put `WIP:` in title until pending PR is merged",
      "created_at": "2018-04-17T09:41:29Z",
      "updated_at": "2018-04-17T09:41:29Z"
    },
    {
      "author": "bergmeister",
      "author_association": "CONTRIBUTOR",
      "body": "I pulled in the required changes from master (that are merged now) and tested locally that it works using a folder that ends with a single quote. There was one sporadic test failure (it passed in my branch, which is now even with `master`) and the same test also failed after the PR 6612 of @SteveL-MSFT was merged into master. Unless we are aware of that, we should create an issue for each failure, even if it is sporadic and try to improve the test. From personal experience, sporadic failures can get quickly out of hand if they are not constantly being looked at and can cost a lot of time at the end over time even if they just start as a small nuisance.\r\n![image](https://user-images.githubusercontent.com/9250262/39157059-f394ecb8-4750-11e8-9ab8-8fdecbfc3a87.png)",
      "created_at": "2018-04-23T21:42:39Z",
      "updated_at": "2018-04-23T22:51:22Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "#6707 is opened to track the test failure in AppVeyor. I have restarted the build.",
      "created_at": "2018-04-23T22:51:46Z",
      "updated_at": "2018-04-23T22:51:46Z"
    },
    {
      "author": "bergmeister",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks",
      "created_at": "2018-04-23T22:52:09Z",
      "updated_at": "2018-04-23T22:52:09Z"
    },
    {
      "author": "munrobasher",
      "author_association": "NONE",
      "body": "Can cross-reference this with [https://superuser.com/questions/1323501/bug-in-powershell-classes-when-script-is-in-a-folder-containing-a-single-quote](url) - is this the same issue here? My problem is with the class statement inside a script that resides in a folder containing a single quote character.",
      "created_at": "2019-05-29T19:51:30Z",
      "updated_at": "2019-05-29T19:51:30Z"
    },
    {
      "author": "bergmeister",
      "author_association": "CONTRIBUTOR",
      "body": "@munrobasher No, this issue/PR was about a different problem although it looks similar.\r\nI repro-ed your linked issue in PowerShell 5.1 and can also confirm that the issue does not happen when using PowerShell 6.2.1\r\nWindows PowerShell receives only critical and security fixes, I suggest to upgrade to PowerShell 6.2 or not use classes in this case then.",
      "created_at": "2019-05-29T20:40:50Z",
      "updated_at": "2019-05-29T20:41:18Z"
    }
  ],
  "created_at": "2018-04-15T21:56:00Z",
  "number": 6660,
  "state": "closed",
  "title": "Use new -WorkingDirectory parameter on pwsh.exe to be able to use context menu when path contains single quotes.",
  "updated_at": "2019-05-29T20:41:18Z"
}
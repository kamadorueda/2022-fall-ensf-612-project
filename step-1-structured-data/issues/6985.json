{
  "_url": "https://github.com/PowerShell/PowerShell/issues/6985",
  "author": "bergmeister",
  "body": "## PR Summary\r\n\r\nBackground/Recap: PR #6913 added a JumpList on Windows only and already made sure that in case of pwsh being non-interactive or not being the owner of the current window, the algorithm aborts as early as possible (<1ms) but in cases when the JumpList needs to be created, the work in the ConsoleHost is done synchronously and takes around 55ms.\r\n\r\nThis PR enhances the last scenario by eliminating the blocking time completely by doing the work in a background thread without waiting for it and as suggested in the PR review, moving it to a later stage.\r\nSome more info: Once the JumpList is being set the first time, it will persist (if the file path remains the same), therefore it is OK to move it to a later stage in general. As already discussed there is no 'GET' API to check whether the JumpList needs to be created or not. In theory, one could possibly even try to call it in a WiX custom action during the installation but even if that worked, I am questioning its persistence e.g. during one of the bi-annual Windows updates (personally, I have seen e.g. that registry keys, etc. do not get persisted). Therefore I think this optimisation makes it polished enough to not worry about those few extra CPU cycles, especially since Windows deployments nowadays usually have multi-core CPUs as well.\r\n\r\n## PR Checklist\r\n\r\n- [x] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - Use the present tense and imperative mood when describing your changes\r\n- [x] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] [Change is not breaking](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)\r\n- [x] [Make sure all `.h`, `.cpp`, `.cs`, `.ps1` and `.psm1` files have the correct copyright header](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - If the PR is work in progress, please add the prefix `WIP:` to the beginning of the title and remove the prefix when the PR is ready.\r\n- **User-facing changes**\r\n    - [x] Not Applicable\r\n    - **OR**\r\n    - [ ] User-facing [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n        - [ ] Issue filed - Issue link:\r\n- **Testing - New and feature**\r\n    - [x] Not Applicable or can only be tested interactively\r\n    - **OR**\r\n    - [ ] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n        - [ ] [Add `[feature]` if the change is significant or affects feature tests](https://github.com/PowerShell/PowerShell/blob/master/docs/testing-guidelines/testing-guidelines.md#requesting-additional-tests-for-a-pr)\r\n",
  "closed_at": "2018-06-05T12:44:45Z",
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@bergmeister Please address @anmenaga comment and we'll be ready to merge.",
      "created_at": "2018-06-05T03:38:06Z",
      "updated_at": "2018-06-05T03:38:06Z"
    }
  ],
  "created_at": "2018-06-04T07:09:08Z",
  "number": 6985,
  "state": "closed",
  "title": "Create JumpList in background thread to improve performance",
  "updated_at": "2018-06-05T12:44:46Z"
}
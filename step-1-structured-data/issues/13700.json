{
  "_url": "https://github.com/PowerShell/PowerShell/issues/13700",
  "author": "kvprasoon",
  "body": "<!-- Anything that looks like this is a comment and can't be seen after the Pull Request is created. -->\r\n\r\n# PR Summary\r\n\r\nChange min depth to 0 for ConvertTo-Json\r\n\r\n\r\n## PR Checklist\r\n\r\n- [x] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - Use the present tense and imperative mood when describing your changes\r\n- [x] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] [Make sure all `.h`, `.cpp`, `.cs`, `.ps1` and `.psm1` files have the correct copyright header](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - If the PR is work in progress, please add the prefix `WIP:` or `[ WIP ]` to the beginning of the title (the `WIP` bot will keep its status check at `Pending` while the prefix is present) and remove the prefix when the PR is ready.\r\n- **[Breaking changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)**\r\n    - [ ] None\r\n    - **OR**\r\n    - [ ] [Experimental feature(s) needed](https://github.com/MicrosoftDocs/PowerShell-Docs/blob/staging/reference/6/Microsoft.PowerShell.Core/About/about_Experimental_Features.md)\r\n        - [ ] Experimental feature name(s): <!-- Experimental feature name(s) here -->\r\n- **User-facing changes**\r\n    - [x] Not Applicable\r\n    - **OR**\r\n    - [ ] [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n        - [x] Issue filed: https://github.com/PowerShell/PowerShell/issues/13660\r\n- **Testing - New and feature**\r\n    - [ ] N/A or can only be tested interactively\r\n    - **OR**\r\n    - [x] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n- **Tooling**\r\n    - [ ] I have considered the user experience from a tooling perspective and don't believe tooling will be impacted.\r\n    - **OR**\r\n    - [ ] I have considered the user experience from a tooling perspective and enumerated concerns in the summary. This may include:\r\n        - Impact on [PowerShell Editor Services](https://github.com/PowerShell/PowerShellEditorServices) which is used in the [PowerShell extension](https://github.com/PowerShell/vscode-powershell) for VSCode (which runs in a different PS Host).\r\n        - Impact on Completions (both in the console and in editors) - one of PowerShell's most powerful features.\r\n        - Impact on [PSScriptAnalyzer](https://github.com/PowerShell/PSScriptAnalyzer) (which provides linting & formatting in the editor extensions).\r\n        - Impact on [EditorSyntax](https://github.com/PowerShell/EditorSyntax) (which provides syntax highlighting with in VSCode, GitHub, and many other editors).\r\n",
  "closed_at": "2021-02-17T18:08:37Z",
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "I don't see any value in the change. If we plan to move new .Net Json API and follow the API behavior the change makes no sense at all.",
      "created_at": "2020-09-27T18:29:48Z",
      "updated_at": "2020-09-27T18:29:48Z"
    },
    {
      "author": "PrzemyslawKlys",
      "author_association": "NONE",
      "body": "@iSazonov  From what I understand you want to take away the ability to choose depth right? Why do you want to limit how people use PowerShell? Some choices may make no sense to you, but for other people, it makes a lot of sense. NET is NET, PowerShell is PowerShell - they serve a different purpose. ",
      "created_at": "2020-09-27T19:36:30Z",
      "updated_at": "2020-09-27T19:37:14Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "What does depth 0 mean?",
      "created_at": "2020-10-02T17:48:09Z",
      "updated_at": "2020-10-02T17:48:09Z"
    },
    {
      "author": "PrzemyslawKlys",
      "author_association": "NONE",
      "body": "@TravisEz13 https://github.com/PowerShell/PowerShell/issues/13660 describes why I want Depth 0. ",
      "created_at": "2020-10-02T17:51:34Z",
      "updated_at": "2020-10-02T17:51:34Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "The short of it is that depth 0 is \"flat\" with no nesting at all.",
      "created_at": "2020-10-02T17:55:43Z",
      "updated_at": "2020-10-02T17:55:55Z"
    },
    {
      "author": "PrzemyslawKlys",
      "author_association": "NONE",
      "body": "```powershell\r\n$Object = [PSCustomObject] @{\r\n    AnotherObject  = @{\r\n        Test = 0\r\n    }\r\n    AnotherObject1 = @{\r\n        LetsSett = 'dfdf'\r\n        OhNo     = @{\r\n            OrAnotherLevel = @{\r\n                AndAnother = @{\r\n                    Color = [System.Drawing.Color]::AliceBlue\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n$Object | ConvertTo-Json -Depth 1\r\n```\r\nOutput:\r\n```\r\n{\r\n    \"AnotherObject\":  {\r\n                          \"Test\":  0\r\n                      },\r\n    \"AnotherObject1\":  {\r\n                           \"OhNo\":  \"System.Collections.Hashtable\",\r\n                           \"LetsSett\":  \"dfdf\"\r\n                       }\r\n}\r\n```\r\nWhat I'm after:\r\n\r\n```\r\n{\r\n\"AnotherObject\":\"System.Collections.Hashtable\",\r\n\"AnotherObject1\":\"System.Collections.Hashtable\"\r\n}\r\n```\r\n\r\nOf course for nested hashtables the visual part will be bad. But what I'm after actually is same behavior:\r\n\r\n```powershell\r\n$Object | ConvertTo-Html -Fragment\r\n```\r\n\r\nOutput:\r\n```\r\n<table>\r\n<colgroup><col/><col/></colgroup>\r\n<tr><th>AnotherObject</th><th>AnotherObject1</th></tr>\r\n<tr><td>System.Collections.Hashtable</td><td>System.Collections.Hashtable</td></tr>\r\n</table>\r\n```",
      "created_at": "2020-10-02T17:58:30Z",
      "updated_at": "2020-10-02T17:58:30Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "Can you rebase to try to fix the errors?",
      "created_at": "2020-10-02T19:39:29Z",
      "updated_at": "2020-10-02T19:39:29Z"
    },
    {
      "author": "kvprasoon",
      "author_association": "CONTRIBUTOR",
      "body": "@TravisEz13 fixed",
      "created_at": "2020-10-05T19:04:55Z",
      "updated_at": "2020-10-05T19:04:55Z"
    },
    {
      "author": "msftbot[bot]",
      "author_association": "NONE",
      "body": "This pull request has been automatically marked as Review Needed because it has been there has not been any activity for **7 days**.\nMaintainer, please provide feedback and/or mark it as `Waiting on Author`",
      "created_at": "2020-10-13T02:00:10Z",
      "updated_at": "2020-10-13T02:00:10Z"
    },
    {
      "author": "kvprasoon",
      "author_association": "CONTRIBUTOR",
      "body": "@TravisEz13 are we doing this ?",
      "created_at": "2020-11-18T10:36:15Z",
      "updated_at": "2020-11-18T10:36:15Z"
    },
    {
      "author": "PrzemyslawKlys",
      "author_association": "NONE",
      "body": "I wrote a bunch of tests for my own ConvertTo-jsonLiteral which has a difference by default having Depth 0 and has additional settings such as BoolAsString, NumberAsString, DateTimeFormat where you can push how the date is formatted as a string, and NewLineFormatting. I do all that because I want it sometimes to behave like ConvertTo-HTML + usually JSON based queries for REST API don't like types or other stuff from native cmdlets.\r\n\r\nMaybe it will help, as most of the tests should work on the original cmdlets as I try to validate it with PowerShell implementation with a difference of testing additional parameters in most cases. But I do tests arrays, strings, enums and so on. \r\n\r\nhttps://github.com/EvotecIT/PSSharedGoods/blob/master/Tests/ConvertTo-JsonLiteral.Tests.ps1\r\n\r\nFeel free to copy/adjust and enhance if you see any benefit. \n\n<blockquote><img src=\"https://avatars2.githubusercontent.com/u/15376314?s=400&v=4\" width=\"48\" align=\"right\"><div><img src=\"https://github.githubassets.com/favicons/favicon.svg\" height=\"14\"> GitHub</div><div><strong><a href=\"https://github.com/EvotecIT/PSSharedGoods\">EvotecIT/PSSharedGoods</a></strong></div><div>PSSharedGoods is little PowerShell Module that primary purpose is to be useful for multiple tasks, unrelated to each other. I&#39;ve created this module as \u201ca glue\u201d between my other modules.  - Evo...</div></blockquote>",
      "created_at": "2020-12-15T21:13:27Z",
      "updated_at": "2020-12-15T21:13:33Z"
    },
    {
      "author": "msftbot[bot]",
      "author_association": "NONE",
      "body": "This pull request has been automatically marked as Review Needed because it has been there has not been any activity for **7 days**.\nMaintainer, please provide feedback and/or mark it as `Waiting on Author`",
      "created_at": "2020-12-26T02:00:07Z",
      "updated_at": "2020-12-26T02:00:07Z"
    },
    {
      "author": "kvprasoon",
      "author_association": "CONTRIBUTOR",
      "body": "Just a gentle reminder @TravisEz13 :-)",
      "created_at": "2021-01-21T18:28:03Z",
      "updated_at": "2021-01-21T18:28:03Z"
    },
    {
      "author": "kvprasoon",
      "author_association": "CONTRIBUTOR",
      "body": "Somebody please help to fix the CI error.",
      "created_at": "2021-02-13T07:20:16Z",
      "updated_at": "2021-02-13T07:20:41Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@kvprasoon It seems unrelated to the PR, please rebase.",
      "created_at": "2021-02-13T14:57:14Z",
      "updated_at": "2021-02-13T14:57:14Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@kvprasoon I see unrelated commits. Please fix your rebase.",
      "created_at": "2021-02-14T17:49:47Z",
      "updated_at": "2021-02-14T17:49:47Z"
    },
    {
      "author": "kvprasoon",
      "author_association": "CONTRIBUTOR",
      "body": "@iSazonov ohh yeah...donno how did this happen, was doing the changes from different laptops. Will fix it.",
      "created_at": "2021-02-16T04:40:46Z",
      "updated_at": "2021-02-16T04:40:46Z"
    },
    {
      "author": "kvprasoon",
      "author_association": "CONTRIBUTOR",
      "body": "@iSazonov @TravisEz13 Closing and I've created a fresh one here https://github.com/PowerShell/PowerShell/pull/14830",
      "created_at": "2021-02-17T18:08:37Z",
      "updated_at": "2021-02-17T18:08:37Z"
    }
  ],
  "created_at": "2020-09-25T17:37:29Z",
  "number": 13700,
  "state": "closed",
  "title": "Change min depth to 0 for ConvertTo-Json",
  "updated_at": "2021-02-18T10:33:36Z"
}
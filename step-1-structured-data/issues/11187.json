{
  "_url": "https://github.com/PowerShell/PowerShell/issues/11187",
  "author": "holishing",
  "body": "<!--\r\nFor Windows PowerShell 5.1 issues, suggestions, or feature requests please use the following link instead:\r\nWindows PowerShell [UserVoice](https://windowsserver.uservoice.com/forums/301869-powershell)\r\n\r\nThis repository is **ONLY** for PowerShell Core 6 issues.\r\n\r\n- Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\r\n- Search the existing issues.\r\n- Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\r\n- Refer to the [known issues](https://docs.microsoft.com/powershell/scripting/whats-new/known-issues-ps6?view=powershell-6).\r\n-->\r\n\r\n\r\n\r\n# Steps to reproduce\r\n\r\n```bash\r\nsudo apt install ./powershell-preview_7.0.0-preview.6-1.debian.10_amd64.deb\r\n# or install powershell-preview from \r\n# deb [arch=amd64] https://packages.microsoft.com/debian/10/prod buster main\r\n```\r\n\r\n# Expected behavior\r\n\r\n```none\r\nReading package lists... Done\r\nBuilding dependency tree       \r\nReading state information... Done\r\nNote, selecting 'powershell-preview' instead of './powershell-preview_7.0.0-preview.6-1.1.debian.10_amd64.deb'\r\nThe following NEW packages will be installed:\r\n  powershell-preview\r\n0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.\r\nAfter this operation, 158 MB of additional disk space will be used.\r\nGet:1 /home/user/tests/powershell-preview_7.0.0-preview.6-1.1.debian.10_amd64.deb powershell-preview amd64 7.0.0-preview.6-1.debian.10 [99.0 MB]\r\nSelecting previously unselected package powershell-preview.\r\n(Reading database ... 545800 files and directories currently installed.)\r\nPreparing to unpack .../powershell-preview_7.0.0-preview.6-1.1.debian.10_amd64.deb ...\r\nUnpacking powershell-preview (7.0.0-preview.6-1.debian.10) ...\r\nSetting up powershell-preview (7.0.0-preview.6-1.debian.10) ...\r\nProcessing triggers for man-db (2.8.5-2) ...\r\n```\r\n\r\n# Actual behavior\r\n\r\n```none\r\nReading package lists... Done\r\nBuilding dependency tree       \r\nReading state information... Done\r\nNote, selecting 'powershell-preview' instead of './powershell-preview_7.0.0-preview.6-1.debian.10_amd64.deb'\r\nSome packages could not be installed. This may mean that you have\r\nrequested an impossible situation or if you are using the unstable\r\ndistribution that some required packages have not yet been created\r\nor been moved out of Incoming.\r\nThe following information may help to resolve the situation:\r\n\r\nThe following packages have unmet dependencies:\r\n powershell-preview : Depends: libssl1.0.2 but it is not installable\r\n                      Depends: libicu57 but it is not installable\r\nE: Unable to correct problems, you have held broken packages.\r\n```\r\n\r\n# Environment data\r\n\r\n<!-- provide the output of $PSVersionTable -->\r\n```\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.0.0-preview.6\r\nPSEdition                      Core\r\nGitCommitId                    7.0.0-preview.6\r\nOS                             Linux 5.2.0-0.bpo.3-amd64 #1 SMP Debian 5.2.17-1~bpo10+1 (2019-09-30)\r\nPlatform                       Unix\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n\r\n```none\r\nPackage: powershell-preview\r\nVersion: 7.0.0-preview.6-1.debian.10\r\nPriority: extra\r\nSection: shells\r\nMaintainer: PowerShell Team <PowerShellTeam@hotmail.com>\r\nInstalled-Size: 158 MB\r\nDepends: libc6, libgcc1, libgssapi-krb5-2, liblttng-ust0, libstdc++6, zlib1g, libssl1.0.2, libicu57\r\nHomepage: https://microsoft.com/powershell\r\nLicense: MIT License\r\nVendor: Microsoft Corporation\r\nDownload-Size: 58.1 MB\r\nAPT-Sources: https://packages.microsoft.com/debian/10/prod buster/main amd64 Packages\r\nDescription: PowerShell is an automation and configuration management platform.\r\n It consists of a cross-platform command-line shell and associated scripting language.\r\n```\r\n\r\n# Suggestions\r\n\r\n* Directly change dependencies to `libssl1.1, libicu63`, for e.g.:\r\n\r\n```\r\nPackage: powershell-preview\r\nVersion: 7.0.0-preview.6-1.debian.10\r\nStatus: install ok installed\r\nPriority: extra\r\nSection: shells\r\nMaintainer: PowerShell Team <PowerShellTeam@hotmail.com>\r\nInstalled-Size: 158 MB\r\nDepends: libc6, libgcc1, libgssapi-krb5-2, liblttng-ust0, libstdc++6, zlib1g, libssl1.1, libicu63\r\nHomepage: https://microsoft.com/powershell\r\nLicense: MIT License\r\nVendor: Microsoft Corporation\r\nDownload-Size: unknown\r\nAPT-Manual-Installed: yes\r\nAPT-Sources: /var/lib/dpkg/status\r\nDescription: PowerShell is an automation and configuration management platform.\r\n It consists of a cross-platform command-line shell and associated scripting language.\r\n```\r\n\r\n# Work around method for current Debian Buster users:\r\n\r\n*Note: this method is dirty, and use this on your own risk*\r\n\r\n## extract\r\n\r\n```bash\r\nmkdir powershell-preview_7.0.0-preview.6-1-1.debian.10_amd64\r\nbsdtar xvf powershell-preview_7.0.0-preview.6-1.debian.10_amd64.deb -C powershell-preview_7.0.0-preview.6-1-1.debian.10_amd64\r\ncd powershell-preview_7.0.0-preview.6-1-1.debian.10_amd64\r\nmkdir DEBIAN\r\ntar xvf control.tar.gz -C DEBIAN ## non gzip archive actually\r\ntar zxvf data.tar.gz\r\nrm control.tar.gz data.tar.gz\r\nls\r\n## It should be:\r\n# DEBIAN  opt  usr\r\n```\r\n\r\n## fix info\r\n```diff\r\n--- DEBIAN/control       2019-11-19 06:02:18.000000000 +0800\r\n+++ DEBIAN/control       2019-11-25 19:11:41.986636209 +0800\r\n@@ -1,11 +1,11 @@\r\n Package: powershell-preview\r\n-Version: 7.0.0-preview.6-1.debian.10\r\n+Version: 7.0.0-preview.6-1-1.debian.10\r\n License: MIT License\r\n Vendor: Microsoft Corporation\r\n Architecture: amd64\r\n Maintainer: PowerShell Team <PowerShellTeam@hotmail.com>\r\n Installed-Size: 154170\r\n-Depends: libc6, libgcc1, libgssapi-krb5-2, liblttng-ust0, libstdc++6, zlib1g, libssl1.0.2, libicu57\r\n+Depends: libc6, libgcc1, libgssapi-krb5-2, liblttng-ust0, libstdc++6, zlib1g, libssl1.1, libicu63\r\n Section: shells\r\n Priority: extra\r\n Homepage: https://microsoft.com/powershell\r\n```\r\n\r\n## Package it again\r\n\r\n```bash\r\ncd .. ## $OLDPWD is under powershell-preview_7.0.0-preview.6-1-1.debian.10_amd64\r\ndpkg-deb -b powershell-preview_7.0.0-preview.6-1-1.debian.10_amd64\r\nbsdtar tf powershell-preview_7.0.0-preview.6-1-1.debian.10_amd64.deb ## check\r\nsudo apt install ./powershell-preview_7.0.0-preview.6-1-1.debian.10_amd64.deb\r\n```\r\n\r\n## Done!",
  "closed_at": "2019-12-03T19:39:07Z",
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "It is documented https://github.com/MicrosoftDocs/PowerShell-Docs/blob/staging/reference/docs-conceptual/install/Installing-PowerShell-Core-on-Linux.md#debian-10\n\n<blockquote><img src=\"https://repository-images.githubusercontent.com/44411511/850abe80-7ca6-11e9-886f-a1b13b275ae0\" width=\"48\" align=\"right\"><div><img src=\"https://github.githubassets.com/favicon.ico\" height=\"14\"> GitHub</div><div><strong><a href=\"https://github.com/MicrosoftDocs/PowerShell-Docs\">MicrosoftDocs/PowerShell-Docs</a></strong></div><div>The official PowerShell documentation sources. Contribute to MicrosoftDocs/PowerShell-Docs development by creating an account on GitHub.</div></blockquote>",
      "created_at": "2019-11-29T12:02:50Z",
      "updated_at": "2019-11-29T12:02:52Z"
    },
    {
      "author": "holishing",
      "author_association": "NONE",
      "body": "But this official 7-preview package for **Debian 10**, still set `libssl1.0.2, libicu57` (which only appear in Debian 9) as dependencies, it should be corrected.\r\n\r\nDocuments only told you how to build and manually install, but installed contents by that method cannot be managed by `apt`, and apply security or feature update in the future.",
      "created_at": "2019-11-29T12:56:30Z",
      "updated_at": "2019-11-29T13:01:07Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@holishing Thanks for clarify!\r\nIt seems here https://github.com/PowerShell/PowerShell/blob/d68d126cae263637a819a14f83062d63a6f221b0/tools/packaging/packaging.psm1#L1173\r\n\r\n/cc @SteveL-MSFT @TravisEz13 ",
      "created_at": "2019-11-29T13:26:41Z",
      "updated_at": "2019-11-29T13:26:41Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "@holishing we are getting another report that the same libraries should be used on debian10... any feedback?",
      "created_at": "2019-12-06T19:53:23Z",
      "updated_at": "2019-12-06T19:53:23Z"
    },
    {
      "author": "holishing",
      "author_association": "NONE",
      "body": "Well, I think we cannot find out the same libraries (`libssl1.0.2`, `libicu57`) in official repo(`main`, sec urity-update ) in Debian Buster, if old-stable version of those package is needed, maybe we should consider add them into custom repo (i.e. `packages.microsoft.com`) or figure out more clean way to solve dependencies problem? :\r\n\r\n```\r\n$ docker run -it debian:buster bash\r\nroot@3729f145bf6f:/# apt update\r\nGet:1 http://security-cdn.debian.org/debian-security buster/updates InRelease [65.4 kB]\r\nGet:2 http://cdn-fastly.deb.debian.org/debian buster InRelease [122 kB]                                               \r\nGet:4 http://security-cdn.debian.org/debian-security buster/updates/main amd64 Packages [159 kB]\r\nGet:3 http://cdn-fastly.deb.debian.org/debian buster-updates InRelease [49.3 kB]\r\nGet:5 http://cdn-fastly.deb.debian.org/debian buster/main amd64 Packages [7908 kB]\r\nGet:6 http://cdn-fastly.deb.debian.org/debian buster-updates/main amd64 Packages [5792 B]                                                                                                   \r\nFetched 8309 kB in 8s (1105 kB/s)                                                                                                                                                           \r\nReading package lists... Done\r\nBuilding dependency tree       \r\nReading state information... Done\r\nAll packages are up to date.\r\nroot@3729f145bf6f:/# apt search libssl\r\nSorting... Done\r\nFull Text Search... Done\r\nlibssl-dev/stable,stable 1.1.1d-0+deb10u2 amd64\r\n  Secure Sockets Layer toolkit - development files\r\n\r\nlibssl-doc/stable,stable 1.1.1d-0+deb10u2 all\r\n  Secure Sockets Layer toolkit - development documentation\r\n\r\nlibssl-ocaml/stable 0.5.5-1 amd64\r\n  OCaml bindings for OpenSSL (runtime)\r\n\r\nlibssl-ocaml-dev/stable 0.5.5-1 amd64\r\n  OCaml bindings for OpenSSL\r\n\r\nlibssl-utils-clojure/stable 0.8.3-2 all\r\n  library for SSL certificate management on the JVM\r\n\r\nlibssl1.1/stable,stable 1.1.1d-0+deb10u2 amd64\r\n  Secure Sockets Layer toolkit - shared libraries\r\n\r\nroot@3729f145bf6f:/# apt search libicu\r\nSorting... Done\r\nFull Text Search... Done\r\nlibicu-dev/stable 63.1-6 amd64\r\n  Development files for International Components for Unicode\r\n\r\nlibicu-le-hb-dev/stable 1.0.3+git180724-3 amd64\r\n  ICU Layout Engine API on top of HarfBuzz shaping library (development)\r\n\r\nlibicu-le-hb0/stable 1.0.3+git180724-3 amd64\r\n  ICU Layout Engine API on top of HarfBuzz shaping library\r\n\r\nlibicu4j-4.4-java/stable 4.4.2.2-3 all\r\n  Library for Unicode support and internationalization\r\n\r\nlibicu4j-java/stable 62.1-2 all\r\n  Library for Unicode support and internationalization\r\n\r\nlibicu4j-java-doc/stable 62.1-2 all\r\n  Library for Unicode support and internationalization - Docs\r\n\r\nlibicu63/stable 63.1-6 amd64\r\n  International Components for Unicode\r\n\r\nroot@3729f145bf6f:/#\r\n```",
      "created_at": "2019-12-06T20:01:07Z",
      "updated_at": "2019-12-06T20:03:48Z"
    },
    {
      "author": "msftbot[bot]",
      "author_association": "NONE",
      "body": ":tada:This issue was addressed in #11236, which has now been successfully released as `v7.0.0-rc.1`.:tada:\n\nHandy links:\n* [Release Notes](https://github.com/PowerShell/PowerShell/releases/tag/v7.0.0-rc.1)\n",
      "created_at": "2019-12-16T21:37:18Z",
      "updated_at": "2019-12-16T21:37:18Z"
    }
  ],
  "created_at": "2019-11-25T11:19:35Z",
  "number": 11187,
  "state": "closed",
  "title": "Wrong depedencies of powershell-preview (7.0.0) package for Debian 10",
  "updated_at": "2019-12-16T21:37:18Z"
}
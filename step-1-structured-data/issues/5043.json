{
  "_url": "https://github.com/PowerShell/PowerShell/issues/5043",
  "author": "bergmeister",
  "body": "Address https://github.com/PowerShell/PowerShell/issues/3623.\r\n\r\nImplementation symmetric to traditional code path that returns a `PSCustomObject`. Code is shared on the top level but 2 low level methods were difficult to share, therefore 2 separate but similar methods were created for HashTables.\r\nAll existing tests related to this change were adapted to also test against this new switch and were slightly improved. \r\n\r\nUpdate (@TravisEz13):\r\n`-AsHashtable` is an existing pattern used in `Group-Object`",
  "closed_at": "2017-10-25T15:57:06Z",
  "comments": [
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "`-AsHashtable` is an existing pattern used in `Group-Object`.  I don't think this needs committee review.",
      "created_at": "2017-10-10T20:36:19Z",
      "updated_at": "2017-10-10T20:37:30Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "We have discussion for this https://github.com/PowerShell/PowerShell/issues/3623",
      "created_at": "2017-10-11T14:22:04Z",
      "updated_at": "2017-10-11T14:22:04Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "@dantraMSFT Can you review this?",
      "created_at": "2017-10-16T18:43:29Z",
      "updated_at": "2017-10-16T18:43:29Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "As part of this PR, if we can detect that the json has an property named empty string for the pscustomobject path and provide an error message like:\r\n\r\n```markdown\r\nThe provided json includes a property who name is an empty string, this is only supported using the `-AsHashTable` switch.\r\n```\r\n\r\nThen we can resolve https://github.com/PowerShell/PowerShell/issues/1755 as fixed.",
      "created_at": "2017-10-17T04:33:01Z",
      "updated_at": "2017-10-17T04:33:01Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT @TravisEz13 @dantraMSFT Could you please review?\r\n\r\nAlso should we address the [comment](https://github.com/PowerShell/PowerShell/issues/3623#issuecomment-296537316) from @powercode \r\n>Apart from object size and performance, it may matter with case sensitivity. I have run into issues where I couldn't use the PowerShell cmdlets because the json contained 'Property' and 'property'.",
      "created_at": "2017-10-19T06:31:16Z",
      "updated_at": "2017-10-19T06:31:16Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@bergmeister Thanks for your contribution! LGTM with above question about  case sensitivity.",
      "created_at": "2017-10-19T06:50:01Z",
      "updated_at": "2017-10-19T06:50:01Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@iSazonov @powercode regarding case sensitivity, I think we should treat it the same as the empty key.  [Hashtable] allows two keys differing in case, so if we detect that, we should just tell the user to use `-AsHashTable`.",
      "created_at": "2017-10-21T00:45:00Z",
      "updated_at": "2017-10-21T00:45:00Z"
    },
    {
      "author": "bergmeister",
      "author_association": "CONTRIBUTOR",
      "body": "@SteveL-MSFT @iSazonov @powercode I added a specific error message to point the user to the new `-AsHashTable` option.\r\nAs part of this I also found out that actually no error is thrown in the case of duplicate keys with the same casing. This is due to the behaviour of Newtonsoft.Json that just uses the last item if there are multiple items with the same key of the same casing. The PowerShell code currently caters for it should this behaviour change in a newer version of Newtonsoft.Json. This should definitely be discussed in another issue if you want to make a breaking change to throw when encountering case matching duplicate keys.",
      "created_at": "2017-10-22T15:35:00Z",
      "updated_at": "2017-10-22T15:35:00Z"
    },
    {
      "author": "bergmeister",
      "author_association": "CONTRIBUTOR",
      "body": "@iSazonov @SteveL-MSFT I added more validation to the positive test cases and shortened the error message a bit. I opened issue #5199 for the problem with Newtonsoft.Json for keys with matching cases, which is unrelated to this PR.",
      "created_at": "2017-10-22T20:25:38Z",
      "updated_at": "2017-10-22T20:25:38Z"
    },
    {
      "author": "bergmeister",
      "author_association": "CONTRIBUTOR",
      "body": "@SteveL-MSFT I see that the documentation [here](https://github.com/PowerShell/PowerShell-Docs/blob/a1520688fb6b3e25ec51096d2611de9b54d08c2d/reference/6/Microsoft.PowerShell.Utility/ConvertFrom-Json.md) has not been updated yet for the new `-AsHashTable` switch (or is it already done in another branch?). Am I supposed to do that or shall I simply open an issue in the docs repo?",
      "created_at": "2017-11-14T12:26:17Z",
      "updated_at": "2017-11-14T12:26:17Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@bergmeister Feel free to open an Issue in docs repo or push PR with the fix.",
      "created_at": "2017-11-14T13:38:17Z",
      "updated_at": "2017-11-14T13:38:17Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@bergmeister preferably submit a PR to powershell-docs repo.  The `Documentation Needed` label here means you don't need to open an issue in the powershell-docs repo.  But my team won't be reviewing and adding docs until sometime after RC is out.  If you submit a PR for the doc update, please reference this PR so we can remove the `Documentation Needed` label.  Thanks!",
      "created_at": "2017-11-14T17:47:38Z",
      "updated_at": "2017-11-14T17:47:38Z"
    }
  ],
  "created_at": "2017-10-06T22:49:46Z",
  "number": 5043,
  "state": "closed",
  "title": "Add -AsHashtable switch to ConvertFrom-Json for issue #3623",
  "updated_at": "2018-10-15T21:53:56Z"
}
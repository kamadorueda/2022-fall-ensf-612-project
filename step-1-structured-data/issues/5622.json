{
  "_url": "https://github.com/PowerShell/PowerShell/issues/5622",
  "author": "dantraMSFT",
  "body": "Issue https://github.com/PowerShell/PowerShell/issues/4029 exposed two problems when failing to load libpsrpclient. \r\n* WSManAPIDataCommon.ctor was not identifying the binary that failed DLLImport; hindering diagnosability \r\n* PrioritySendDataCollection.Clear() would throw a NullReferenceException when called from the finalizer after an error path.\r\n\r\nThis change addresses both of the above:\r\n\r\n* Guard against null arrays in PrioritySendDataCollection.Clear() - called from finalizer in error paths.\r\n\r\n* Diagnosability: Log the DllNotFoundException in WSManAPIDataCommon ctor and also include it as the internal exception when throwing PSRemotingTransportException.\r\n",
  "closed_at": "2018-01-04T21:08:33Z",
  "comments": [
    {
      "author": "dantraMSFT",
      "author_association": "CONTRIBUTOR",
      "body": "@mirichmo and @PaulHigin will either of you be able to look at this?",
      "created_at": "2017-12-05T17:57:36Z",
      "updated_at": "2017-12-05T17:57:36Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "also related to issue #5566",
      "created_at": "2017-12-06T00:05:34Z",
      "updated_at": "2017-12-06T00:05:34Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "LGTM, but I would like @PaulHigin  to have a look.",
      "created_at": "2017-12-07T18:38:11Z",
      "updated_at": "2017-12-07T18:38:11Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "@anmenaga Do you want to sign off, or did you just comment?",
      "created_at": "2017-12-07T18:40:44Z",
      "updated_at": "2017-12-07T18:40:44Z"
    },
    {
      "author": "anmenaga",
      "author_association": "CONTRIBUTOR",
      "body": "@TravisEz13 \r\nThe conversation continues about refactoring that Dan proposed; but I think that refactoring (if needs to be done at all) can be done as separate PR.",
      "created_at": "2017-12-07T18:48:30Z",
      "updated_at": "2017-12-07T18:48:30Z"
    },
    {
      "author": "dantraMSFT",
      "author_association": "CONTRIBUTOR",
      "body": "@TravisEz13 This should be ready to merge.",
      "created_at": "2017-12-15T02:09:09Z",
      "updated_at": "2017-12-15T02:09:09Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "I've been asked to wait for a review by @PaulHigin  or @daxian-dbw ",
      "created_at": "2017-12-15T23:37:10Z",
      "updated_at": "2017-12-15T23:37:10Z"
    },
    {
      "author": "dantraMSFT",
      "author_association": "CONTRIBUTOR",
      "body": "@daxian-dbw do you have any additional feedback?",
      "created_at": "2018-01-02T23:10:42Z",
      "updated_at": "2018-01-02T23:10:42Z"
    },
    {
      "author": "dantraMSFT",
      "author_association": "CONTRIBUTOR",
      "body": "@PaulHigin, @daxian-dbw, please take a look at this; it's marked as GA. Thanks.",
      "created_at": "2018-01-03T23:18:13Z",
      "updated_at": "2018-01-03T23:18:13Z"
    }
  ],
  "created_at": "2017-12-04T21:49:40Z",
  "number": 5622,
  "state": "closed",
  "title": "remoting: Handle DLLImport failure of libpsrpclient",
  "updated_at": "2018-01-05T18:32:24Z"
}
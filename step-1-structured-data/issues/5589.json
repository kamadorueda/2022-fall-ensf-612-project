{
  "_url": "https://github.com/PowerShell/PowerShell/issues/5589",
  "author": "1RedOne",
  "body": "\r\nSteps to reproduce\r\n------------------\r\n\r\n```powershell\r\n#Create a new WebServiceProxy to the free Zip code service\r\n\r\n$zip = New-WebServiceProxy -Uri \"http://www.webservicex.net/uszip.asmx?WSDL\"\r\n\r\n#view all of the methods\r\n$zip | gm -MemberType Method Get*\r\n\r\n\r\n   TypeName: Microsoft.PowerShell.Commands.NewWebserviceProxy.AutogeneratedTypes.WebServiceProxy1ebservicex_net_uszip_asmx_WSDL.USZip\r\n\r\nName                   MemberType Definition                                                                                                    \r\n----                   ---------- ----------                                                                                                    \r\nGetHashCode            Method     int GetHashCode()                                                                                             \r\nGetInfoByAreaCode      Method     System.Xml.XmlNode GetInfoByAreaCode(string USAreaCode)                                                       \r\nGetInfoByAreaCodeAsync Method     void GetInfoByAreaCodeAsync(string USAreaCode), void GetInfoByAreaCodeAsync(string USAreaCode, System.Objec...\r\nGetInfoByCity          Method     System.Xml.XmlNode GetInfoByCity(string USCity)                                                               \r\nGetInfoByCityAsync     Method     void GetInfoByCityAsync(string USCity), void GetInfoByCityAsync(string USCity, System.Object userState)       \r\nGetInfoByState         Method     System.Xml.XmlNode GetInfoByState(string USState)                                                             \r\nGetInfoByStateAsync    Method     void GetInfoByStateAsync(string USState), void GetInfoByStateAsync(string USState, System.Object userState)   \r\nGetInfoByZIP           Method     System.Xml.XmlNode GetInfoByZIP(string USZip)                                                                 \r\nGetInfoByZIPAsync      Method     void GetInfoByZIPAsync(string USZip), void GetInfoByZIPAsync(string USZip, System.Object userState)           \r\nGetLifetimeService     Method     System.Object GetLifetimeService()                                                                            \r\nGetType                Method     type GetType()         \r\n\r\n#export to CLIXMl \r\n$zip | Export-Clixml c:\\temp\\zip.ps1xml -Depth 5\r\n\r\n```\r\n\r\nExpected behavior\r\n-----------------\r\nIn our expected behavior, the methods would be preserved during the Export, and be available to us again 'on the other side'.\r\n```powershell\r\n$zip = Import-CliXML c:\\temp\\zip.ps1xml\r\n\r\n$zip | gm -MemberType Method Get*\r\n\r\n\r\n   TypeName: Microsoft.PowerShell.Commands.NewWebserviceProxy.AutogeneratedTypes.WebServiceProxy1ebservicex_net_uszip_asmx_WSDL.USZip\r\n\r\nName                   MemberType Definition                                                                                                    \r\n----                   ---------- ----------                                                                                                    \r\nGetHashCode            Method     int GetHashCode()                                                                                             \r\nGetInfoByAreaCode      Method     System.Xml.XmlNode GetInfoByAreaCode(string USAreaCode)                                                       \r\nGetInfoByAreaCodeAsync Method     void GetInfoByAreaCodeAsync(string USAreaCode), void GetInfoByAreaCodeAsync(string USAreaCode, System.Objec...\r\nGetInfoByCity          Method     System.Xml.XmlNode GetInfoByCity(string USCity)                                                               \r\nGetInfoByCityAsync     Method     void GetInfoByCityAsync(string USCity), void GetInfoByCityAsync(string USCity, System.Object userState)       \r\nGetInfoByState         Method     System.Xml.XmlNode GetInfoByState(string USState)                                                             \r\nGetInfoByStateAsync    Method     void GetInfoByStateAsync(string USState), void GetInfoByStateAsync(string USState, System.Object userState)   \r\nGetInfoByZIP           Method     System.Xml.XmlNode GetInfoByZIP(string USZip)                                                                 \r\nGetInfoByZIPAsync      Method     void GetInfoByZIPAsync(string USZip), void GetInfoByZIPAsync(string USZip, System.Object userState)           \r\nGetLifetimeService     Method     System.Object GetLifetimeService()                                                                            \r\nGetType                Method     type GetType()         \r\n\r\n\r\n```\r\n\r\nActual behavior\r\n---------------\r\nIn our actual behavior, the methods are discarded and the object is not as useful.  This leaves us with essentially no way to export or reuse autogenerated types from a WebServiceProxy.  \r\n```powershell\r\n\r\n\r\n```\r\n\r\nEnvironment data\r\n----------------\r\n```powershell\r\n> $PSVersionTable\r\n\r\n\r\nName                           Value                                                                                                            \r\n----                           -----                                                                                                            \r\nPSVersion                      5.1.16299.64                                                                                                     \r\nPSEdition                      Desktop                                                                                                          \r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}                                                                                          \r\nBuildVersion                   10.0.16299.64                                                                                                    \r\nCLRVersion                     4.0.30319.42000                                                                                                  \r\nWSManStackVersion              3.0                                                                                                              \r\nPSRemotingProtocolVersion      2.3                                                                                                              \r\nSerializationVersion           1.1.0.1                                                                                                          \r\n\r\n\r\n\r\n\r\n```\r\n",
  "closed_at": "2018-06-29T14:13:13Z",
  "comments": [
    {
      "author": "markekraus",
      "author_association": "CONTRIBUTOR",
      "body": "Hi @1RedOne `New-WebServiceProxy` is not available in PSCore. Can you please move this issue to [UserVoice](https://windowsserver.uservoice.com/forums/301869-powershell)? Thanks!",
      "created_at": "2017-11-30T15:03:40Z",
      "updated_at": "2017-11-30T15:03:40Z"
    },
    {
      "author": "BrucePay",
      "author_association": "COLLABORATOR",
      "body": "Hi folks, CliXML is intended to be a loose **data-only** serializer (also used for remoting). Methods are not included in the output by design. Likewise, only a small number of types are serialized with fidelity. When it was designed, we wanted to avoid some of the problems that WMI had due to it's use of method proxies.",
      "created_at": "2018-03-09T19:42:46Z",
      "updated_at": "2018-03-09T19:42:46Z"
    },
    {
      "author": "1RedOne",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for the clarification, Bruce and Marke, good to know!  Closing.",
      "created_at": "2018-06-29T14:13:13Z",
      "updated_at": "2018-06-29T14:13:13Z"
    }
  ],
  "created_at": "2017-11-30T14:52:09Z",
  "labels": [
    "Issue-Question",
    "Resolution-Answered"
  ],
  "number": 5589,
  "state": "closed",
  "title": "Export-CLIXml discards Autogenerated Methods from WebServiceProxy ",
  "updated_at": "2018-06-29T14:47:47Z"
}
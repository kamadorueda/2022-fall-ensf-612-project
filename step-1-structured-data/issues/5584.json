{
  "_url": "https://github.com/PowerShell/PowerShell/issues/5584",
  "author": "JohnLBevan",
  "body": "Steps to reproduce\r\n------------------\r\n\r\n**Demo.ps1**\r\n\r\n```powershell\r\nfunction Test-CredentialAttribute {\r\n\tParam (\r\n\t\t[Parameter()]\r\n\t\t[System.Management.Automation.PSCredential]\r\n\t\t[System.Management.Automation.Credential()]\r\n\t\t$Credential\r\n\t)\r\n\t$Credential.UserName\r\n}\r\nTest-CredentialAttribute -Credential 'usernameAsString'\r\n```\r\n\r\n```batchfile\r\npowershell -noninteractive -file \"c:\\somewhere\\Demo.ps1\"\r\n```\r\n\r\nExpected behavior\r\n-----------------\r\n\r\nError:\r\n```none\r\nTest-CredentialAttribute : Windows PowerShell is in NonInteractive mode. Read and Prompt functionality is not available.\r\n```\r\n\r\nActual behavior\r\n---------------\r\n\r\nPrompts user for credentials (i.e. the same behaviour we'd expect had the command been run in interactive mode.\r\n\r\nEnvironment data\r\n----------------\r\n\r\n```powershell\r\n> (Get-WmiObject -class Win32_OperatingSystem).Version\r\n6.1.7601\r\n```\r\n\r\n```powershell\r\n> $PSVersionTable\r\nName                           Value                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \r\n----                           -----                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \r\nPSVersion                      5.1.14409.1012                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \r\nPSEdition                      Desktop                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}                                                                                                                                                                                                                                                                                                                                                                                                                                                             \r\nBuildVersion                   10.0.14409.1012                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \r\nCLRVersion                     4.0.30319.42000                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \r\nWSManStackVersion              3.0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \r\nPSRemotingProtocolVersion      2.3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \r\nSerializationVersion           1.1.0.1    \r\n```\r\n\r\n(Related discussion on SO: https://stackoverflow.com/questions/47560421/change-behaviour-of-credentials-when-in-non-interactive-mode)",
  "closed_at": "2017-12-01T13:42:18Z",
  "comments": [
    {
      "author": "MaximoTrinidad",
      "author_association": "NONE",
      "body": "Hi @JohnLBevan,\r\n\r\nAs stated in the PowerShell Github section \"Windows PowerShell vs PowerShell Core\". You can only post PowerShell Core issues here.  Please, for Windows PowerShell issues yoiu need to use the following UserVoice link: https://windowsserver.uservoice.com/forums/301869-powershell \r\n\r\nThanks\r\n",
      "created_at": "2017-11-30T15:39:35Z",
      "updated_at": "2017-11-30T15:43:38Z"
    },
    {
      "author": "markekraus",
      "author_association": "CONTRIBUTOR",
      "body": "This does not repro on 6.0.0-rc:\r\n\r\n![2017-11-30_10-47-52](https://user-images.githubusercontent.com/6509955/33442961-fc983c72-d5bb-11e7-8e8f-bfe2600381ea.png)\r\n",
      "created_at": "2017-11-30T16:00:33Z",
      "updated_at": "2017-11-30T16:48:29Z"
    },
    {
      "author": "JohnLBevan",
      "author_association": "NONE",
      "body": "Apologies; I'd misunderstood PowerShell Core as being the core PowerShell engine (as opposed to its various modules); not as being a .Net Core implementation of PowerShell. Closing here & raising in Uservoice.  https://windowsserver.uservoice.com/forums/301869-powershell/suggestions/32453510-behaviour-of-system-management-automation-credent",
      "created_at": "2017-12-01T13:42:18Z",
      "updated_at": "2017-12-01T13:42:18Z"
    }
  ],
  "created_at": "2017-11-29T23:53:00Z",
  "number": 5584,
  "state": "closed",
  "title": "Behaviour of `System.Management.Automation.Credential()` in NonInteractive session",
  "updated_at": "2017-12-01T13:42:18Z"
}
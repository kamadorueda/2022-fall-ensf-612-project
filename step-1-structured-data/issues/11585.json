{
  "_url": "https://github.com/PowerShell/PowerShell/issues/11585",
  "author": "chasewilson",
  "body": "<!--\r\n\r\nFor Windows PowerShell 5.1 issues, suggestions, or feature requests please use the following link instead:\r\nWindows PowerShell [UserVoice](https://windowsserver.uservoice.com/forums/301869-powershell)\r\n\r\nThis repository is **ONLY** for PowerShell Core 6 and PowerShell 7+ issues.\r\n\r\n- Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\r\n- Search the existing issues.\r\n- Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\r\n- Refer to the [known issues](https://docs.microsoft.com/powershell/scripting/whats-new/known-issues-ps6?view=powershell-6).\r\n\r\n-->\r\n\r\n# Steps to reproduce\r\nThere are several variations of the issue when using a boolean along side a number:\r\n\r\n### Example 1 - Boolean gets classified as an int32 but separated from other ints in an array\r\n```powershell\r\n$true, 2, 123 | Format-Hex\r\n```\r\n\r\n```Output\r\nLabel: Int32 (System.Int32) <5692E06D>\r\n\u00a0\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Offset Bytes \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Ascii\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a000 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ------ ----------------------------------------------- -----\r\n0000000000000000 01 00 00 00 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ?\r\n\u00a0\r\n\u00a0 \u00a0Label: Int32 (System.Int32) <0ABB4E98>\r\n\u00a0\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Offset Bytes \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Ascii\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a000 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ------ ----------------------------------------------- -----\r\n0000000000000000 02 00 00 00 7B 00 00 00 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ? \u00a0 {\r\n```\r\n\r\n### Example 2 - '123' is labeled and output as a boolean and $true is grouped in the ints\r\n\r\n```powershell\r\n123,$true,2,123 | Format-Hex\r\n```\r\n\r\n```Output\r\nLabel: Boolean (System.Boolean) <5437D5CB>\r\n\u00a0\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Offset Bytes \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Ascii\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a000 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ------ ----------------------------------------------- -----\r\n0000000000000000 7B 00 00 00 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 {\r\n\u00a0\r\n\u00a0 \u00a0Label: Int32 (System.Int32) <23FB0F32>\r\n\u00a0\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Offset Bytes \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Ascii\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a000 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ------ ----------------------------------------------- -----\r\n0000000000000000 01 00 00 00 02 00 00 00 7B 00 00 00 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ? \u00a0 ? \u00a0 {\r\n```\r\n\r\n### Example 3 - Processes the first object in the pipe correctly and throws and error for the second. This is true whether the Boolean is first or second in the array.\r\n\r\n```powershell\r\n123,$true | Format-Hex\r\n```\r\n\r\n```Output\r\nLabel: Boolean (System.Boolean) <16312C72>\r\n\u00a0\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Offset Bytes \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Ascii\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a000 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ------ ----------------------------------------------- -----\r\n0000000000000000 7B 00 00 00 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 {\r\nFormat-Hex: Object reference not set to an instance of an object.\r\n```\r\n\r\n### Example 4 - Showing the Boolean doesn't have to be $True. Similar to [Example 2](#Example-2-'123'-is-labeled-and-output-as-a-boolean-and-$true-is-grouped-in-the-ints)\r\n\r\n```powershell\r\n123,$false,2,123 | Format-Hex\r\n```\r\n```Output\r\nLabel: Boolean (System.Boolean) <4A512B9F>\r\n\u00a0\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Offset Bytes \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Ascii\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a000 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ------ ----------------------------------------------- -----\r\n0000000000000000 7B 00 00 00 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 {\r\n\u00a0\r\n\u00a0 \u00a0Label: Int32 (System.Int32) <4B76B7B6>\r\n\u00a0\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Offset Bytes \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Ascii\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a000 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ------ ----------------------------------------------- -----\r\n0000000000000000 00 00 00 00 02 00 00 00 7B 00 00 00 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ? \u00a0 {\r\n\r\n```\r\n\r\n# Expected behavior\r\n\r\n```powershell\r\n# Should not throw an error and correctly label and group objects\r\n$true, 123 | Format-Hex\r\n```\r\n\r\n```Output\r\nLabel: Boolean (System.Boolean) <5437D5CB>\r\n\u00a0\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Offset Bytes \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Ascii\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a000 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ------ ----------------------------------------------- -----\r\n0000000000000000 01 00 00 00 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ?\r\n\u00a0\r\n\u00a0 \u00a0Label: Int32 (System.Int32) <23FB0F32>\r\n\u00a0\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Offset Bytes \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Ascii\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a000 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ------ ----------------------------------------------- -----\r\n0000000000000000 7B 00 00 00                         \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 {\r\n```\r\n\r\n```powershell\r\n# Group label and group objects correctly\r\n$true,2,123 | Format-Hex\r\n```\r\n\r\n```Output\r\nLabel: Boolean (System.Boolean) <5437D5CB>\r\n\u00a0\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Offset Bytes \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Ascii\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a000 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ------ ----------------------------------------------- -----\r\n0000000000000000 01 00 00 00 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ?\r\n\u00a0\r\n\u00a0 \u00a0Label: Int32 (System.Int32) <0ABB4E98>\r\n\u00a0\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Offset Bytes \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Ascii\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a000 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ------ ----------------------------------------------- -----\r\n0000000000000000 02 00 00 00 7B 00 00 00 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ? \u00a0 {\r\n```\r\n\r\n# Actual behavior\r\n\r\nSee [Steps to reproduce](#Steps-to-reproduce)\r\n\r\n# Environment data\r\n\r\n<!-- provide the output of $PSVersionTable -->\r\n\r\n```none\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.0.0-rc.1\r\nPSEdition                      Core\r\nGitCommitId                    7.0.0-rc.1\r\nOS                             Microsoft Windows 10.0.18363\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n",
  "closed_at": "2020-01-24T04:52:22Z",
  "comments": [
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "cc @vexx32 ",
      "created_at": "2020-01-14T22:12:46Z",
      "updated_at": "2020-01-14T22:12:46Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "Yeah, shouldn't really be casting there -- or if it is, it should be doing it more sensibly. I'll check it out this evening, shouldn't be too complicated to fix. \ud83d\ude42 ",
      "created_at": "2020-01-14T23:37:26Z",
      "updated_at": "2020-01-14T23:37:26Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "@chasewilson @SteveL-MSFT looks like it was a fairly simple fix. Behaviour after the fixes:\r\n```powershell\r\nPS> [bool[]]($true, $false, $true), 123, 100, 76, $true, $false | Format-Hex\r\n\r\n\r\n   Label: Boolean[] (System.Boolean[]) <1E7D1E5A>\r\n\r\n          Offset Bytes                                           Ascii       \r\n                 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F\r\n          ------ ----------------------------------------------- -----       \r\n0000000000000000 01 00 01                                        \ufffd \ufffd\r\n\r\n   Label: Int32 (System.Int32) <5FEF9EC2>\r\n\r\n          Offset Bytes                                           Ascii       \r\n                 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F\r\n          ------ ----------------------------------------------- -----       \r\n0000000000000000 7B 00 00 00 64 00 00 00 4C 00 00 00             {   d   L   \r\n\r\n   Label: Boolean (System.Boolean) <7D8C4C1D>\r\n\r\n          Offset Bytes                                           Ascii\r\n                 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F\r\n          ------ ----------------------------------------------- -----\r\n0000000000000000 01 00                                           \ufffd\r\n```\r\nI squashed booleans into a single byte for their hex representation because that's really all they are; .NET technically pads them out to 4 bytes, but that's not especially _useful_ for anyone to see, those extra bytes will always be blank.",
      "created_at": "2020-01-15T04:53:20Z",
      "updated_at": "2020-01-15T05:00:48Z"
    },
    {
      "author": "msftbot[bot]",
      "author_association": "NONE",
      "body": ":tada:This issue was addressed in #11587, which has now been successfully released as `v7.1.0-preview.1`.:tada:\n\nHandy links:\n* [Release Notes](https://github.com/PowerShell/PowerShell/releases/tag/v7.1.0-preview.1)\n",
      "created_at": "2020-03-26T17:46:45Z",
      "updated_at": "2020-03-26T17:46:45Z"
    }
  ],
  "created_at": "2020-01-14T22:09:19Z",
  "labels": [
    "Issue-Bug",
    "WG-Cmdlets-Utility"
  ],
  "number": 11585,
  "state": "closed",
  "title": "Formatting issue in Format-Hex when Boolean's are involved in a mixed array.",
  "updated_at": "2020-03-26T17:46:46Z"
}
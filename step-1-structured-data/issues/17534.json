{
  "_url": "https://github.com/PowerShell/PowerShell/issues/17534",
  "author": "prepstarr",
  "body": "### Prerequisites\n\n- [X] Write a descriptive title.\n- [X] Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\n- [X] Search the existing issues.\n- [X] Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\n- [X] Refer to [Differences between Windows PowerShell 5.1 and PowerShell](https://docs.microsoft.com/powershell/scripting/whats-new/differences-from-windows-powershell).\n\n### Steps to reproduce\n\nUpdate-Help -UICulture en-US\n\n### Expected behavior\n\n```console\nDownloads and installs the newest help files on your computer.\n```\n\n\n### Actual behavior\n\n```console\nUpdate-Help: Failed to update Help for the module(s) '7zip-Archive' with UI culture(s) {en-US} : The value of the HelpInfoUri key in the module manifest must resolve to a container or root URL on a website where the help files are stored. The HelpInfoUri 'https://github.com/stadub/PowershellScripts/blob/master/7Zip/README.md' does not resolve to a container..\r\nEnglish-US help content is available and can be installed using: Update-Help -UICulture en-US.\r\nUpdate-Help: Failed to update Help for the module(s) 'WindowsUpdateProvider' with UI culture(s) {en-US} : One or more errors occurred. (Response status code does not indicate success: 404 (Not Found).).\r\nEnglish-US help content is available and can be installed using: Update-Help -UICulture en-US.\n```\n\n\n### Error details\n\n```console\nException             :\r\n    Type    : System.Exception\r\n    Message : Failed to update Help for the module(s) 'WindowsUpdateProvider' with UI culture(s) {en-US} : One or more errors occurred. (Response status code does not indicate success: 404 (Not Found).).\r\n              English-US help content is available and can be installed using: Update-Help -UICulture en-US.\r\n    HResult : -2146233088\r\nCategoryInfo          : InvalidOperation: (:) [Update-Help], Exception\r\nFullyQualifiedErrorId : UnknownErrorId,Microsoft.PowerShell.Commands.UpdateHelpCommand\r\nInvocationInfo        :\r\n    MyCommand        : Update-Help\r\n    ScriptLineNumber : 1\r\n    OffsetInLine     : 1\r\n    HistoryId        : 5\r\n    Line             : Update-Help -UICulture en-US\r\n    PositionMessage  : At line:1 char:1\r\n                       + Update-Help -UICulture en-US\r\n                       + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    InvocationName   : Update-Help\r\n    CommandOrigin    : Internal\r\nScriptStackTrace      : at <ScriptBlock>, <No file>: line 1\r\nPipelineIterationInfo :\n```\n\n\n### Environment data\n\n```powershell\n$PSVersionTable\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.2.4\r\nPSEdition                      Core\r\nGitCommitId                    7.2.4\r\nOS                             Microsoft Windows 10.0.19044\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\n```\n\n\n### Visuals\n\n![image](https://user-images.githubusercontent.com/65930206/174206787-05523ec6-047b-413b-b194-6ef57923eb74.png)\r\n",
  "closed_at": null,
  "comments": [
    {
      "author": "ehmiiz",
      "author_association": "NONE",
      "body": "I remember trying to solve this issue before:\r\n\r\nhttps://answers.microsoft.com/en-us/windows/forum/all/updateing-powershell-user-help-files/07afd880-c543-4e56-9446-1e9eb509003d\r\n\r\nPeople suggest running get-help with -Force -ErrorAction SilentlyContinue - however this will not update the failing modules, only hide the errors\r\n\r\nI would suspect the issue lies either in naming rules of blobs:\r\nhttps://docs.microsoft.com/en-us/rest/api/storageservices/Naming-and-Referencing-Containers--Blobs--and-Metadata?redirectedfrom=MSDN\r\n\r\nand since you have the issue (FR) and I have the same (Swedish layout) it seems to be cause by Thread.CurrentUICulture property\r\n\r\nedit: seems to be caused by case sensitivity in the actual module folders, example that fails:\r\nPKI (should be pki)\r\nPSReadline (should be PSReadLine)\r\n\r\n\r\n<blockquote><div><strong><a href=\"https://answers.microsoft.com/en-us/windows/forum/all/updateing-powershell-user-help-files/07afd880-c543-4e56-9446-1e9eb509003d\">Redirecting</a></strong></div></blockquote>\r\n<blockquote><img src=\"https://docs.microsoft.com/en-us/media/logos/logo-ms-social.png\" width=\"48\" align=\"right\"><div><strong><a href=\"https://docs.microsoft.com/en-us/rest/api/storageservices/naming-and-referencing-containers--blobs--and-metadata\">Naming and Referencing Containers, Blobs, and Metadata - Azure Storage</a></strong></div><div>This topic describes naming and referring to containers, blobs, metadata, and snapshots. A storage account can contain zero or more containers. A container contains properties, metadata, and zero or more blobs. A blob is any single entity comprised of binary data, properties, and metadata.</div></blockquote>",
      "created_at": "2022-06-17T11:02:29Z",
      "updated_at": "2022-06-17T12:46:52Z"
    },
    {
      "author": "ehmiiz",
      "author_association": "NONE",
      "body": "After some digging I found this:\r\nhttps://github.com/MicrosoftDocs/windows-powershell-docs/issues/2247\r\nSeems to be a known issue with Get-Help / Update-Help that causes this\r\n\r\nAs described here by Sean:\r\nhttps://devblogs.microsoft.com/powershell/updating-help-for-the-psreadline-module-in-windows-powershell-5-1/\r\na work-around is to rename the module folder that you need to update help for, just tested for the module PKI (renamed to the new module name lowercase: pki), \"update-help pki\" worked fine\n\n<blockquote><img src=\"https://devblogs.microsoft.com/powershell/wp-content/uploads/sites/30/2018/09/Powershell_256.png\" width=\"48\" align=\"right\"><div><img src=\"https://devblogs.microsoft.com/powershell/wp-content/uploads/sites/30/2019/02/Powershell_2561.png\" height=\"14\"> PowerShell Team</div><div><strong><a href=\"https://devblogs.microsoft.com/powershell/updating-help-for-the-psreadline-module-in-windows-powershell-5-1/\">Updating help for the PSReadLine module in Windows PowerShell 5.1</a></strong></div><div>Describes how to workaround the error when you try to update help for PSReadline in Windows PowerShell 5.1.</div></blockquote>",
      "created_at": "2022-06-17T12:32:24Z",
      "updated_at": "2022-06-17T12:32:28Z"
    },
    {
      "author": "ehmiiz",
      "author_association": "NONE",
      "body": "> After some digging I found this: [MicrosoftDocs/windows-powershell-docs#2247](https://github.com/MicrosoftDocs/windows-powershell-docs/issues/2247) Seems to be a known issue with Get-Help / Update-Help that causes this\r\n> \r\n> As described here by Sean: https://devblogs.microsoft.com/powershell/updating-help-for-the-psreadline-module-in-windows-powershell-5-1/ a work-around is to rename the module folder that you need to update help for, just tested for the module PKI (renamed to the new module name lowercase: pki), \"update-help pki\" worked fine\r\n> \r\n> > <img alt=\"\" width=\"48\" src=\"https://camo.githubusercontent.com/e68e34fec82df597ef2257f5c1caf66389261e928d626d20543a46464430cf65/68747470733a2f2f646576626c6f67732e6d6963726f736f66742e636f6d2f706f7765727368656c6c2f77702d636f6e74656e742f75706c6f6164732f73697465732f33302f323031382f30392f506f7765727368656c6c5f3235362e706e67\"><img alt=\"\" height=\"14\" src=\"https://camo.githubusercontent.com/51145e85e7e07991fb2b235b9306ab50d9e4843dd1c5dc1bed7f3b5821707a53/68747470733a2f2f646576626c6f67732e6d6963726f736f66742e636f6d2f706f7765727368656c6c2f77702d636f6e74656e742f75706c6f6164732f73697465732f33302f323031392f30322f506f7765727368656c6c5f323536312e706e67\"> PowerShell Team**[Updating help for the PSReadLine module in Windows PowerShell 5.1](https://devblogs.microsoft.com/powershell/updating-help-for-the-psreadline-module-in-windows-powershell-5-1/)**Describes how to workaround the error when you try to update help for PSReadline in Windows PowerShell 5.1.\r\n\r\nAs this thread talks about the 404 error, In my case it seems to fail because what is displayed and stored in the module path is actually folders with incorrect names, either the module author/owner/microsoft changed name completely or casing (PKI>pki)\r\n\r\nPKI should be pki\r\nDism should be DISM\r\nConfigDefenderPerformance should be (even more strange) Defender\r\nKds should be KDS\r\nAnd so on\r\n\r\nA work-around is to rename them with their newer name as described here:\r\nhttps://devblogs.microsoft.com/powershell/updating-help-for-the-psreadline-module-in-windows-powershell-5-1/\r\n\r\nNote that this will probably only work well for modules with the \"wrong\" casing, some modules like ConfigDefenderPerformance actually have dead links in their HelpInfoURI in their manifest, so it's an actual case of 404",
      "created_at": "2022-06-21T11:34:45Z",
      "updated_at": "2022-06-21T11:34:45Z"
    },
    {
      "author": "dkaszews",
      "author_association": "CONTRIBUTOR",
      "body": "I'll take a look at it as part of PR #17780 , I saw something that may suggest the error hint about `en-US` being available does not actually take into account the real culture of the module.\r\n\r\nCan you please provide link to the 7-zip module that gives you trouble and paste output of `Get-UICulture`? ",
      "created_at": "2022-07-30T17:49:04Z",
      "updated_at": "2022-07-30T17:49:04Z"
    },
    {
      "author": "dkaszews",
      "author_association": "CONTRIBUTOR",
      "body": "I found an issue in `UpdatableHelpCommandBase:EndProcessing`: even though original exceptions contain a list of supported cultures: `\"The specified culture is not supported: en-GB. Specify a culture from the following list: {en-US}.\"`, when we fold them over multiple modules we ignore it and just assume it was `en-US`: `\"Failed to update Help for the module(s) '{0}' with UI culture(s) {{{1}}} : {2}.\\nEnglish-US help content is available and can be installed using: Update-Help -UICulture en-US.\"`\r\n\r\nThis can lead to situation where `Update-Help -UICulture en-US` fails because the help is actually available in let's say `en-GB` or `fr-FR` or whatever, then tell you to use `en-US` again regardless.",
      "created_at": "2022-08-01T11:21:12Z",
      "updated_at": "2022-08-01T11:21:12Z"
    }
  ],
  "created_at": "2022-06-17T01:53:56Z",
  "number": 17534,
  "state": "open",
  "title": " Update-Help -UICulture en-US",
  "updated_at": "2022-08-01T11:21:12Z"
}
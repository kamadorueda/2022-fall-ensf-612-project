{
  "_url": "https://github.com/PowerShell/PowerShell/issues/17034",
  "author": "doctordns",
  "body": "### Prerequisites\r\n\r\n- [X] Write a descriptive title.\r\n- [X] Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\r\n- [X] Search the existing issues.\r\n- [X] Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\r\n- [X] Refer to [Differences between Windows PowerShell 5.1 and PowerShell](https://docs.microsoft.com/powershell/scripting/whats-new/differences-from-windows-powershell).\r\n\r\n### Steps to reproduce\r\n\r\nI am running PowerShell 7,2,1, As expected (following the release of 7.2.2) when I run PowerShell I get the notification message. This is consistent with several hosts. However, on every host - I installed PowerShell 7 using the MSI AND selecting the option to update by MU. The update to 7.2.2 is not happening on all my Win 11 (Insiders) hosts.\r\n\r\nI can appreciate it might take a few days after the release hits Github. But it should be the case the MU updates work at the same time as the message starts to appear. In a perfect world, I should never see that message as MU should have updated my version of PowerShell 7. \r\n\r\n\r\n### Expected behavior\r\n\r\n```console\r\nPowershell 7.2.1 should see the update, and thanks to MU, that update should be downloaded, installed, and becomes useful.\r\n```\r\n\r\n\r\n### Actual behavior\r\n\r\n```console\r\n7.2.2 appears only to be installable manually.\r\n```\r\n\r\n\r\n### Error details\r\n\r\n_No response_\r\n\r\n### Environment data\r\n\r\n```powershell\r\nPS C:\\Foo> $PSVersionTable\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.2.1\r\nPSEdition                      Core\r\nGitCommitId                    7.2.1\r\nOS                             Microsoft Windows 10.0.22572\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0, 5.0, 5.1.10032.0, 6.0.0, 6.1.0, 6.2.0, 7.0.0, 7.1.0, 7.2.1}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n\r\n\r\n### Visuals\r\n\r\n_No response_",
  "closed_at": "2022-03-23T00:00:39Z",
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "See https://github.com/PowerShell/PowerShell/discussions/16459#discussioncomment-2389665",
      "created_at": "2022-03-20T16:13:45Z",
      "updated_at": "2022-03-20T16:13:45Z"
    },
    {
      "author": "sdwheeler",
      "author_association": "COLLABORATOR",
      "body": "FYI - This is what our documentation says:\r\n\r\nhttps://docs.microsoft.com/powershell/scripting/install/microsoft-update-faq?#what-version-of-windows-is-required-to-support-the-microsoft-update-feature\r\n\r\n> **How soon after release are updates advertised by Microsoft Update?**\r\n> When a new version of PowerShell is released, it can take up to two weeks for that version to become available through Microsoft Update. Updates are delivered as optional software updates, even if the update contains a security fix.\n\n<blockquote><img src=\"https://docs.microsoft.com/media/logos/logo-powershell-social.png\" width=\"48\" align=\"right\"><div><strong><a href=\"https://docs.microsoft.com/en-us/powershell/scripting/install/microsoft-update-faq\">Microsoft Update for PowerShell FAQ - PowerShell</a></strong></div><div>Frequently asked questions about the using Microsoft Update to update PowerShell</div></blockquote>",
      "created_at": "2022-03-21T20:31:08Z",
      "updated_at": "2022-03-21T20:31:10Z"
    },
    {
      "author": "msftbot[bot]",
      "author_association": "NONE",
      "body": "This issue has been marked as answered and has not had any activity for **1 day**. It has been closed for housekeeping purposes.",
      "created_at": "2022-03-23T00:00:38Z",
      "updated_at": "2022-03-23T00:00:38Z"
    }
  ],
  "created_at": "2022-03-20T11:25:15Z",
  "number": 17034,
  "state": "closed",
  "title": "PowerShell 7 not being updated by Microsoft Update",
  "updated_at": "2022-03-23T00:00:39Z"
}
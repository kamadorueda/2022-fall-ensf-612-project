{
  "_url": "https://github.com/PowerShell/PowerShell/issues/3377",
  "author": "SteveL-MSFT",
  "body": "It appears that Pester is causing PowerShell to reflect on the Win32.Registry type which causes a `type initialization` exception even if not being used on Linux.   Changed usage of registry to psdrive to avoid this problem.\r\n\r\nAddresses https://github.com/PowerShell/PowerShell/issues/3098\r\n\r\n<!--\r\n\r\nIf you are a PowerShell Team member, please make sure you choose the Reviewer(s) and Assignee for your PR.\r\nIf you are not from the PowerShell Team, you can leave the fields blank and the Maintainers will choose them for you. If you are familiar with the team, feel free to mention some Reviewers yourself.\r\n\r\nFor more information about the roles of Reviewer and Assignee, refer to CONTRIBUTING.md.\r\n\r\n-->\r\n",
  "closed_at": "2017-03-21T17:04:47Z",
  "comments": [
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "This `if((-not ($skipTest)) -and $IsWindows)` block was introduced because our default-browser-discovery code, which was used in `Get-Help -Online`, doesn't work correctly on the Azure code-coverage VM (see PR #3051). After #3281, that code was repalced by calling into `ShellExecuteEx`. Although I never tried on the Azure code-coverage VM, I think the problem should be solved, and if that's the case, this if block can be removed completely.",
      "created_at": "2017-03-21T01:08:44Z",
      "updated_at": "2017-03-21T01:08:44Z"
    },
    {
      "author": "vors",
      "author_association": "COLLABORATOR",
      "body": "LGTM, I'm going to re-assign it to Dongbo. If he is right that we don't need this code, it would be better to remove it completely.",
      "created_at": "2017-03-21T01:25:16Z",
      "updated_at": "2017-03-21T01:25:16Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@daxian-dbw since this is blocking nightly's from passing, we should make a call on this sooner than later.  perhaps we should merge this to get it passing and separately see if the code is still needed for CC?",
      "created_at": "2017-03-21T16:06:40Z",
      "updated_at": "2017-03-21T16:06:40Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@SteveL-MSFT that sounds reasonable. #3079 is tracking this issue.",
      "created_at": "2017-03-21T17:04:25Z",
      "updated_at": "2017-03-21T17:04:25Z"
    }
  ],
  "created_at": "2017-03-21T00:11:43Z",
  "number": 3377,
  "state": "closed",
  "title": "Fix use of registry in nightly tests causing failure on Linux",
  "updated_at": "2017-03-21T20:23:43Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/3143",
  "author": "stej",
  "body": "<!--\r\nIf it is a bug report:\r\n- make sure you are able to repro it on the latest released version. \r\nYou can install the latest version from https://github.com/PowerShell/PowerShell/releases\r\n- Search the existing issues.\r\n- Refer to the [FAQ](../docs/FAQ.md).\r\n- Refer to the [known issues](../docs/KNOWNISSUES.md).\r\n- Fill out the following repro template\r\n\r\nIf it's not a bug, please remove the template and elaborate the issue in your own words.\r\n-->\r\n\r\nSteps to reproduce\r\n------------------\r\nI created some new machines in Azure and enabled HTTPS remoting.\r\n\r\nThen ran code like this:\r\n```\r\n$ips = '10.1.0.0', '10.1.0.1'\r\n$credentials = New-Object Management.Automation.PSCredential (\"user\", (ConvertTo-SecureString \"creds\" -AsPlainText -Force))\r\n$sessions = New-PsSession -SessionOption (New-PsSessionOption \u2013SkipCACheck -SkipCNCheck) -computer $ips -credential $credentials -usessl\r\n\r\ninvoke-command -session $sessions { mkdir c:\\temp }\r\n$sessions | % { \r\n  Copy-Item $dir\\tools-common.zip -dest c:\\temp\\ -tosession $_ -verbose\r\n}\r\n```\r\n\r\nExpected behavior\r\n-----------------\r\n1) Should be working. No idea why it makes some remote path validation.\r\n2) the XmlDocument exception is quite confusing\r\n\r\nActual behavior\r\n---------------\r\n```\r\nCopy-Item : Cannot convert the \"System.Xml.XmlDocument\" value of type \"System.Xml.XmlDocument\" to type \"System.Collec tions.Hashtable\".\r\nAt line:2 char:3\r\n+   Copy-Item $dir\\tools-common.zip -dest c:\\temp\\ -tosession $_ -verbo ...\r\n+   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    + CategoryInfo          : InvalidOperation: (System.Management.Automation.PowerShell:PowerShell) [Copy-Item], PS\r\n   InvalidCastException\r\n    + FullyQualifiedErrorId : CopyFileRemoteExecutionError,Microsoft.PowerShell.Commands.CopyItemCommand\r\n\r\nCopy-Item : Cannot validate remote path 'c:\\temp\\'.\r\nAt line:2 char:3\r\n+   Copy-Item $dir\\tools-common.zip -dest c:\\temp\\ -tosession $_ -verbo ...\r\n+   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    + CategoryInfo          : InvalidOperation: (c:\\temp\\:String) [Copy-Item], InvalidOperationException\r\n    + FullyQualifiedErrorId : FailedToValidateRemotePath,Microsoft.PowerShell.Commands.CopyItemCommand\r\n```\r\n\r\nEnvironment data\r\n----------------\r\n\r\n<!-- provide the output of $PSVersionTable -->\r\n\r\n**Local**\r\n```powershell\r\n> $PSVersionTable\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      5.1.14393.693\r\nPSEdition                      Desktop\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\r\nBuildVersion                   10.0.14393.693\r\nCLRVersion                     4.0.30319.42000\r\nWSManStackVersion              3.0\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\n```\r\n\r\n**Remote**\r\n```\r\n[45]: Invoke-Command -Session $sessions[0] { $PSVersionTable }\r\n\r\nName                           Value\r\n----                           -----\r\nPSRemotingProtocolVersion      2.3\r\nBuildVersion                   10.0.14393.693\r\nPSVersion                      5.1.14393.693\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\r\nPSEdition                      Desktop\r\nCLRVersion                     4.0.30319.42000\r\nWSManStackVersion              3.0\r\nSerializationVersion           1.1.0.1\r\n\r\n\r\n[46]: Invoke-Command -Session $sessions[1] { $PSVersionTable }\r\n\r\nName                           Value\r\n----                           -----\r\nPSRemotingProtocolVersion      2.3\r\nBuildVersion                   10.0.14393.693\r\nPSVersion                      5.1.14393.693\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\r\nPSEdition                      Desktop\r\nCLRVersion                     4.0.30319.42000\r\nWSManStackVersion              3.0\r\nSerializationVersion           1.1.0.1\r\n```\r\n\r\n\r\nI tried to google this error, but with no luck. Found that it probably is thrown at this line https://github.com/PowerShell/PowerShell/blob/02b5f357a20e6dee9f8e60e3adb9025be3c94490/src/System.Management.Automation/engine/SessionStateContainer.cs#L5241 ",
  "closed_at": null,
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Thanks for reporting the issue!\r\nCould you publish results of `error[0..1] | fl -force` ?",
      "created_at": "2017-02-14T17:47:46Z",
      "updated_at": "2017-02-14T17:47:46Z"
    },
    {
      "author": "stej",
      "author_association": "NONE",
      "body": "I tried that yesterday and I was able to copy some files into the session. However, today again.. errors with copying. So this are the errors:\r\n\r\n```\r\n[30]: $error[0] | fl -force\r\n\r\n\r\nwriteErrorStream      : True\r\nException             : System.InvalidOperationException: Cannot validate remote path 'c:\\temp\\'.\r\nTargetObject          : c:\\temp\\\r\nCategoryInfo          : InvalidOperation: (c:\\temp\\:String) [Copy-Item], InvalidOperationException\r\nFullyQualifiedErrorId : FailedToValidateRemotePath,Microsoft.PowerShell.Commands.CopyItemCommand\r\nErrorDetails          :\r\nInvocationInfo        : System.Management.Automation.InvocationInfo\r\nScriptStackTrace      : at <ScriptBlock>, <No file>: line 2\r\n                        at <ScriptBlock>, <No file>: line 1\r\nPipelineIterationInfo : {0, 1}\r\nPSMessageDetails      :\r\n\r\n\r\n[31]: $error[1] | fl -force\r\n\r\n\r\nwriteErrorStream      : True\r\nException             : System.Management.Automation.PSInvalidCastException: Cannot convert the \"System.Xml.XmlDocume\r\n                        nt\" value of type \"System.Xml.XmlDocument\" to type \"System.Collections.Hashtable\".\r\n                           at System.Management.Automation.Runspaces.AsyncResult.EndInvoke()\r\n                           at System.Management.Automation.PowerShell.CoreInvokeRemoteHelper[TInput,TOutput](PSDataCo\r\n                        llection`1 input, PSDataCollection`1 output, PSInvocationSettings settings)\r\n                           at System.Management.Automation.PowerShell.CoreInvoke[TInput,TOutput](PSDataCollection`1 i\r\n                        nput, PSDataCollection`1 output, PSInvocationSettings settings)\r\n                           at System.Management.Automation.PowerShell.Invoke[T]()\r\n                           at Microsoft.PowerShell.Commands.SafeInvokeCommand.Invoke(PowerShell ps, FileSystemProvide\r\n                        r fileSystemContext, CmdletProviderContext cmdletContext, Boolean shouldHaveOutput)\r\nTargetObject          : System.Management.Automation.PowerShell\r\nCategoryInfo          : InvalidOperation: (System.Management.Automation.PowerShell:PowerShell) [Copy-Item], PSInvalid\r\n                        CastException\r\nFullyQualifiedErrorId : CopyFileRemoteExecutionError,Microsoft.PowerShell.Commands.CopyItemCommand\r\nErrorDetails          :\r\nInvocationInfo        : System.Management.Automation.InvocationInfo\r\nScriptStackTrace      : at <ScriptBlock>, <No file>: line 2\r\n                        at <ScriptBlock>, <No file>: line 1\r\nPipelineIterationInfo : {0, 1}\r\nPSMessageDetails      :\r\n```\r\n\r\nWhen using the old `Resolve-Error` cmdlet:\r\n\r\n```\r\n[32]: Resolve-Error\r\n\r\n\r\nwriteErrorStream      : True\r\nPSMessageDetails      :\r\nException             : System.InvalidOperationException: Cannot validate remote path 'c:\\temp\\'.\r\nTargetObject          : c:\\temp\\\r\nCategoryInfo          : InvalidOperation: (c:\\temp\\:String) [Copy-Item], InvalidOperationException\r\nFullyQualifiedErrorId : FailedToValidateRemotePath,Microsoft.PowerShell.Commands.CopyItemCommand\r\nErrorDetails          :\r\nInvocationInfo        : System.Management.Automation.InvocationInfo\r\nScriptStackTrace      : at <ScriptBlock>, <No file>: line 2\r\n                        at <ScriptBlock>, <No file>: line 1\r\nPipelineIterationInfo : {0, 1}\r\n\r\n\r\n\r\n\r\nMyCommand             : Copy-Item\r\nBoundParameters       : {}\r\nUnboundArguments      : {}\r\nScriptLineNumber      : 2\r\nOffsetInLine          : 3\r\nHistoryId             : 28\r\nScriptName            :\r\nLine                  :   Copy-Item $deploymentsDir\\tools-common.zip -dest c:\\temp\\ -tosession $_ -verbose }\r\nPositionMessage       : At line:2 char:3\r\n                        +   Copy-Item $deploymentsDir\\tools-common.zip -dest c:\\temp\\ -tosessio ...\r\n                        +   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\nPSScriptRoot          :\r\nPSCommandPath         :\r\nInvocationName        : Copy-Item\r\nPipelineLength        : 0\r\nPipelinePosition      : 0\r\nExpectingInput        : False\r\nCommandOrigin         : Internal\r\nDisplayScriptPosition :\r\n\r\n\r\n\r\n00000000000000000000000000000000000000000000000000000000000000000000000000000000\r\n\r\n\r\nMessage        : Cannot validate remote path 'c:\\temp\\'.\r\nData           : {}\r\nInnerException :\r\nTargetSite     :\r\nStackTrace     :\r\nHelpLink       :\r\nSource         :\r\nHResult        : -2146233079\r\n\r\n\r\n\r\n[33]: Resolve-Error -ErrorRecord $Error[1]\r\n\r\n\r\nwriteErrorStream      : True\r\nPSMessageDetails      :\r\nException             : System.Management.Automation.PSInvalidCastException: Cannot convert the \"System.Xml.XmlDocume\r\n                        nt\" value of type \"System.Xml.XmlDocument\" to type \"System.Collections.Hashtable\".\r\n                           at System.Management.Automation.Runspaces.AsyncResult.EndInvoke()\r\n                           at System.Management.Automation.PowerShell.CoreInvokeRemoteHelper[TInput,TOutput](PSDataCo\r\n                        llection`1 input, PSDataCollection`1 output, PSInvocationSettings settings)\r\n                           at System.Management.Automation.PowerShell.CoreInvoke[TInput,TOutput](PSDataCollection`1 i\r\n                        nput, PSDataCollection`1 output, PSInvocationSettings settings)\r\n                           at System.Management.Automation.PowerShell.Invoke[T]()\r\n                           at Microsoft.PowerShell.Commands.SafeInvokeCommand.Invoke(PowerShell ps, FileSystemProvide\r\n                        r fileSystemContext, CmdletProviderContext cmdletContext, Boolean shouldHaveOutput)\r\nTargetObject          : System.Management.Automation.PowerShell\r\nCategoryInfo          : InvalidOperation: (System.Management.Automation.PowerShell:PowerShell) [Copy-Item], PSInvalid\r\n                        CastException\r\nFullyQualifiedErrorId : CopyFileRemoteExecutionError,Microsoft.PowerShell.Commands.CopyItemCommand\r\nErrorDetails          :\r\nInvocationInfo        : System.Management.Automation.InvocationInfo\r\nScriptStackTrace      : at <ScriptBlock>, <No file>: line 2\r\n                        at <ScriptBlock>, <No file>: line 1\r\nPipelineIterationInfo : {0, 1}\r\n\r\n\r\n\r\n\r\nMyCommand             : Copy-Item\r\nBoundParameters       : {}\r\nUnboundArguments      : {}\r\nScriptLineNumber      : 2\r\nOffsetInLine          : 3\r\nHistoryId             : 28\r\nScriptName            :\r\nLine                  :   Copy-Item $deploymentsDir\\tools-common.zip -dest c:\\temp\\ -tosession $_ -verbose }\r\nPositionMessage       : At line:2 char:3\r\n                        +   Copy-Item $deploymentsDir\\tools-common.zip -dest c:\\temp\\ -tosessio ...\r\n                        +   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\nPSScriptRoot          :\r\nPSCommandPath         :\r\nInvocationName        : Copy-Item\r\nPipelineLength        : 0\r\nPipelinePosition      : 0\r\nExpectingInput        : False\r\nCommandOrigin         : Internal\r\nDisplayScriptPosition :\r\n\r\n\r\n\r\n00000000000000000000000000000000000000000000000000000000000000000000000000000000\r\n\r\n\r\nErrorRecord    : Cannot convert the \"System.Xml.XmlDocument\" value of type \"System.Xml.XmlDocument\" to type \"System.C\r\n                 ollections.Hashtable\".\r\nMessage        : Cannot convert the \"System.Xml.XmlDocument\" value of type \"System.Xml.XmlDocument\" to type \"System.C\r\n                 ollections.Hashtable\".\r\nData           : {}\r\nInnerException :\r\nTargetSite     : Void EndInvoke()\r\nStackTrace     :    at System.Management.Automation.Runspaces.AsyncResult.EndInvoke()\r\n                    at System.Management.Automation.PowerShell.CoreInvokeRemoteHelper[TInput,TOutput](PSDataCollectio\r\n                 n`1 input, PSDataCollection`1 output, PSInvocationSettings settings)\r\n                    at System.Management.Automation.PowerShell.CoreInvoke[TInput,TOutput](PSDataCollection`1 input, P\r\n                 SDataCollection`1 output, PSInvocationSettings settings)\r\n                    at System.Management.Automation.PowerShell.Invoke[T]()\r\n                    at Microsoft.PowerShell.Commands.SafeInvokeCommand.Invoke(PowerShell ps, FileSystemProvider fileS\r\n                 ystemContext, CmdletProviderContext cmdletContext, Boolean shouldHaveOutput)\r\nHelpLink       :\r\nSource         : System.Management.Automation\r\nHResult        : -2147467262\r\n```",
      "created_at": "2017-02-15T14:43:26Z",
      "updated_at": "2017-02-15T14:43:26Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Oh, sorry. It would be interesting to see a call stack:\r\n$error[0..1].Exception | fl -Force",
      "created_at": "2017-02-15T15:26:49Z",
      "updated_at": "2017-02-15T15:26:49Z"
    },
    {
      "author": "stej",
      "author_association": "NONE",
      "body": "Content of `Resolve-Error` is this\r\n\r\n```\r\n[1]: gc Function:\\Resolve-Error\r\nparam($ErrorRecord=$Error[0])\r\n\r\n   $ErrorRecord | Format-List * -Force\r\n   $ErrorRecord.InvocationInfo |Format-List *\r\n   $Exception = $ErrorRecord.Exception\r\n   for ($i = 0; $Exception; $i++, ($Exception = $Exception.InnerException))\r\n   {   \"$i\" * 80\r\n       $Exception |Format-List * -Force\r\n   }\r\n``` \r\nso the Exception is in fact in my previous response.",
      "created_at": "2017-02-16T12:37:37Z",
      "updated_at": "2017-02-16T12:37:37Z"
    },
    {
      "author": "stej",
      "author_association": "NONE",
      "body": "It's here again\r\n\r\n```\r\n[9]: $error[0..1].Exception | fl -Force\r\n\r\n\r\nMessage        : Cannot validate remote path 'c:\\temp\\'.\r\nData           : {}\r\nInnerException :\r\nTargetSite     :\r\nStackTrace     :\r\nHelpLink       :\r\nSource         :\r\nHResult        : -2146233079\r\n\r\nErrorRecord    : Cannot convert the \"System.Xml.XmlDocument\" value of type \"System.Xml.XmlDocument\" to type \"System.C\r\n                 ollections.Hashtable\".\r\nMessage        : Cannot convert the \"System.Xml.XmlDocument\" value of type \"System.Xml.XmlDocument\" to type \"System.C\r\n                 ollections.Hashtable\".\r\nData           : {}\r\nInnerException :\r\nTargetSite     : Void EndInvoke()\r\nStackTrace     :    at System.Management.Automation.Runspaces.AsyncResult.EndInvoke()\r\n                    at System.Management.Automation.PowerShell.CoreInvokeRemoteHelper[TInput,TOutput](PSDataCollectio\r\n                 n`1 input, PSDataCollection`1 output, PSInvocationSettings settings)\r\n                    at System.Management.Automation.PowerShell.CoreInvoke[TInput,TOutput](PSDataCollection`1 input, P\r\n                 SDataCollection`1 output, PSInvocationSettings settings)\r\n                    at System.Management.Automation.PowerShell.Invoke[T]()\r\n                    at Microsoft.PowerShell.Commands.SafeInvokeCommand.Invoke(PowerShell ps, FileSystemProvider fileS\r\n                 ystemContext, CmdletProviderContext cmdletContext, Boolean shouldHaveOutput)\r\nHelpLink       :\r\nSource         : System.Management.Automation\r\nHResult        : -2147467262\r\n```\r\n\r\nAnd it happened again after I created new VMs in Azure, setup windows remoting, opened session and ran the command (see the first post in this issue).",
      "created_at": "2017-02-21T19:58:57Z",
      "updated_at": "2017-02-21T19:58:57Z"
    },
    {
      "author": "stej",
      "author_association": "NONE",
      "body": "Tried `procdump -e 1 -ma <procid>`\r\nThen `!clrstack` in windbg:\r\n\r\n```\r\n0:017> !clrstack\r\nOS Thread Id: 0x2a00 (17)\r\n        Child SP               IP Call Site\r\n0000002bdef8e4a8 00007fff38036154 [HelperMethodFrame: 0000002bdef8e4a8] \r\n0000002bdef8e590 00007ffeed2c827c System.Management.Automation.LanguagePrimitives.ThrowInvalidCastException(System.Object, System.Type)\r\n0000002bdef8e5d0 00007ffeed2c729b System.Management.Automation.LanguagePrimitives.ConvertNoConversion(System.Object, System.Type, Boolean, System.Management.Automation.PSObject, System.IFormatProvider, System.Management.Automation.Runspaces.TypeTable)\r\n0000002bdef8e610 00007ffeec886005 System.Management.Automation.LanguagePrimitives+ConversionData`1[[System.__Canon, mscorlib]].Invoke(System.Object, System.Type, Boolean, System.Management.Automation.PSObject, System.IFormatProvider, System.Management.Automation.Runspaces.TypeTable)\r\n0000002bdef8e650 00007ffeec8854c1 System.Management.Automation.LanguagePrimitives.ConvertTo(System.Object, System.Type, Boolean, System.IFormatProvider, System.Management.Automation.Runspaces.TypeTable)\r\n0000002bdef8e6f0 00007ffeec91441b System.Management.Automation.Internal.PSDataCollectionStream`1[[System.__Canon, mscorlib]].Write(System.Object, Boolean)\r\n0000002bdef8e790 00007ffeed4011e5 System.Management.Automation.Runspaces.Internal.ClientRemotePowerShell.HandleOutputReceived(System.Object, System.Management.Automation.RemoteDataEventArgs`1)\r\n0000002bdef8e7f0 00007ffeec919cdf System.Management.Automation.ExtensionMethods.SafeInvoke[[System.__Canon, mscorlib]](System.EventHandler`1, System.Object, System.__Canon)\r\n0000002bdef8e820 00007ffeec858c69 System.Management.Automation.Internal.ClientPowerShellDataStructureHandler.ProcessReceivedData(System.Management.Automation.Remoting.RemoteDataObject`1)\r\n0000002bdef8e8c0 00007ffeec858a3c System.Management.Automation.Internal.ClientRunspacePoolDataStructureHandler.DispatchMessageToPowerShell(System.Management.Automation.Remoting.RemoteDataObject`1)\r\n0000002bdef8e910 00007ffeec93ec50 System.Management.Automation.Remoting.ClientRemoteSessionDSHandlerImpl.ProcessNonSessionMessages(System.Management.Automation.Remoting.RemoteDataObject`1)\r\n0000002bdef8e970 00007ffeec919cdf System.Management.Automation.ExtensionMethods.SafeInvoke[[System.__Canon, mscorlib]](System.EventHandler`1, System.Object, System.__Canon)\r\n0000002bdef8e9a0 00007ffeec93d4fe System.Management.Automation.Remoting.BaseTransportManager.OnDataAvailableCallback(System.Management.Automation.Remoting.RemoteDataObject`1)\r\n0000002bdef8ea20 00007ffeec93d100 System.Management.Automation.Remoting.Client.BaseClientTransportManager.ServicePendingCallbacks(System.Object)\r\n0000002bdef8ead0 00007ffeed2b5c96 System.Management.Automation.Utils.WorkItemCallback(System.Object)\r\n0000002bdef8eb40 00007fff18e7674e System.Threading.ExecutionContext.RunInternal(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object, Boolean)\r\n0000002bdef8ec10 00007fff18e765e7 System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object, Boolean)\r\n0000002bdef8ec40 00007fff18e804a0 System.Threading.QueueUserWorkItemCallback.System.Threading.IThreadPoolWorkItem.ExecuteWorkItem()\r\n0000002bdef8ec80 00007fff18e7fa10 System.Threading.ThreadPoolWorkQueue.Dispatch()\r\n0000002bdef8f118 00007fff1a736a53 [DebuggerU2MCatchHandlerFrame: 0000002bdef8f118]\r\n```\r\n\r\nAs PowerShell is compiled in release mode, there is no useful info when trying `!Clrstack -a` :/",
      "created_at": "2017-02-21T20:05:51Z",
      "updated_at": "2017-02-21T20:07:49Z"
    },
    {
      "author": "stej",
      "author_association": "NONE",
      "body": "Workaround: close sessions and open new sessions.\r\nBut this is really ugly to have such a workaround in deployment scripts..",
      "created_at": "2017-02-21T20:21:26Z",
      "updated_at": "2017-02-21T20:21:26Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@stej Thanks for the additional information!\r\nPlease clarify - is the problem only with connection to a remote Azure VM? Did you try to connect to non-Azure?",
      "created_at": "2017-02-22T04:43:47Z",
      "updated_at": "2017-02-22T04:43:47Z"
    },
    {
      "author": "stej",
      "author_association": "NONE",
      "body": "Haven't tried so far.. I don't have any suitable & available VM here right now.. ",
      "created_at": "2017-02-22T15:46:48Z",
      "updated_at": "2017-02-22T15:46:48Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "We need to check with latest builds.",
      "created_at": "2018-10-31T14:34:36Z",
      "updated_at": "2018-10-31T14:34:36Z"
    },
    {
      "author": "jwikman",
      "author_association": "NONE",
      "body": "I just stumbled upon this error myself.\r\nI narrowed it down to that I get a casting error if I have a variable called $result in the remote session that I'm trying to copy from.\r\n\r\nThis piece of code was run in the remote session before I called copy-item\r\n```\r\n[string[]]$Result = @()\r\n```\r\nIf I rename the variable to anything else, it works.",
      "created_at": "2018-11-29T20:12:58Z",
      "updated_at": "2018-11-29T20:12:58Z"
    },
    {
      "author": "yacuzo",
      "author_association": "NONE",
      "body": "This is old now, but I just encountered it. In the same session I ran some chocolatey installs, which I guess defined the $result variable.\r\n\r\nA workaround that is a bit simpler that restarting the session:\r\nRun `Remove-Variable result` on the VM\r\n\r\nPSVersion locally:  \r\n```\r\nName                           Value                                                                                                                                                          \r\n----                           -----                                                                                                                                                          \r\nPSVersion                      5.1.18362.752                                                                                                                                                  \r\nPSEdition                      Desktop                                                                                                                                                        \r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}                                                                                                                                        \r\nBuildVersion                   10.0.18362.752                                                                                                                                                 \r\nCLRVersion                     4.0.30319.42000                                                                                                                                                \r\nWSManStackVersion              3.0                                                                                                                                                            \r\nPSRemotingProtocolVersion      2.3                                                                                                                                                            \r\nSerializationVersion           1.1.0.1\r\n```\r\n\r\nPSVersion on VM:\r\n```\r\nName                           Value                                                                                        \r\n----                           -----                                                                                        \r\nPSVersion                      5.1.17763.1007                                                                               \r\nPSEdition                      Desktop                                                                                      \r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}                                                                      \r\nBuildVersion                   10.0.17763.1007                                                                              \r\nCLRVersion                     4.0.30319.42000                                                                              \r\nWSManStackVersion              3.0                                                                                          \r\nPSRemotingProtocolVersion      2.3                                                                                          \r\nSerializationVersion           1.1.0.1   \r\n```\r\n",
      "created_at": "2020-09-04T13:33:36Z",
      "updated_at": "2020-09-04T13:33:36Z"
    }
  ],
  "created_at": "2017-02-14T09:07:31Z",
  "number": 3143,
  "state": "open",
  "title": "Copy-Item throws Cannot validate remote path",
  "updated_at": "2021-11-30T17:54:45Z"
}
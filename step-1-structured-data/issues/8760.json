{
  "_url": "https://github.com/PowerShell/PowerShell/issues/8760",
  "author": "GeeLaw",
  "body": "# Synopsis\r\n\r\nFiles **not** uploaded from this Mac **cannot** be invoked with `Invoke-Item` in PowerShell for macOS, while files originating from this Mac **can**.\r\n\r\n# Steps to reproduce\r\n\r\nTo confirm that files originating from this Mac **can** be opened with `Invoke-Item`:\r\n\r\n1. Copy a picture (named `thepicture.jpg`) from local to the OneDrive folder, wait for it to sync.\r\n2. Open PowerShell for macOS and `Set-Location` to the OneDrive folder. Then do `Invoke-Item thepicture.jpg`. You **will** see the picture opened with its default program.\r\n3. Right-click the picture file in Finder, then select *Free up space*, and wait for it to be dehydrated.\r\n4. Return to PowerShell and do `Invoke-Item thepicture.jpg`. You **will** see the picture rehydrated and opened with its default program.\r\n\r\nTo confirm that files **not** originating from this Mac **cannot** be opened with `Invoke-Item`:\r\n\r\n1. Go to the Web version of OneDrive, upload the same picture with the Web interface (to a location that is not *Always kept on this device*). Then wait for OneDrive for macOS to sync this file.\r\n2. Open PowerShell for macOS and `Set-Location` to the folder. Then do `Invoke-Item thepicture.jpg`. You **will** see the picture hydrated, but **not** opened with its default program.\r\n3. Execute `Invoke-Item thepicture.jpg` again. The picture is still not opened.\r\n\r\n# Expected behavior\r\n\r\nIn both cases, the file should open.\r\n\r\n# Actual behavior\r\n\r\nOnly when the file is uploaded from this Mac, the file opens.\r\n\r\n# Environment data\r\n\r\n- macOS Mojave Version 10.14.3 (18D42)\r\n- OneDrive for macOS Version 18.240.1202.0004 (Standalone)\r\n- Personal OneDrive account\r\n\r\n\r\n```none\r\nName                           Value\r\n----                           -----\r\nPSVersion                      6.1.2\r\nPSEdition                      Core\r\nGitCommitId                    6.1.2\r\nOS                             Darwin 18.2.0 Darwin Kernel Version 18.2.0: Th...\r\nPlatform                       Unix\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n\r\n# Remarks\r\n\r\nUsing the `open` native utility, it is possible to emulate the behavior of opening a file in Finder. `Invoke-Item` should do the same. But **there is a deeper problem hiding here** -- there are differences between a file originating from this Mac and a file with metadata downloaded from OneDrive. I have also reported this issue to OneDrive team.",
  "closed_at": null,
  "comments": [],
  "created_at": "2019-01-28T00:46:18Z",
  "labels": [
    "Issue-Bug"
  ],
  "number": 8760,
  "state": "open",
  "title": "[BUG] `Invoke-Item` does not faithfully reproduce the effect of double-clicking a file in Finder (OneDrive Files On-Demand related)",
  "updated_at": "2019-01-28T00:46:18Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/10044",
  "author": "vexx32",
  "body": "<!-- Anything that looks like this is a comment and can't be seen after the Pull Request is created. -->\r\n\r\n# PR Summary\r\n\r\nRefactor the Test-Connection cmdlet according to https://github.com/PowerShell/PowerShell-RFC/pull/172\r\n\r\n## PR Context\r\n\r\nResolves #6768 \r\n\r\n**NOTE:** Currently this changes the pattern from `Ping.Send()` to `Ping.SendAsync()` with a manual event handler. This is due to a bug that was only recently resolved (see https://github.com/dotnet/corefx/issues/38770#issuecomment-507788270)\r\n\r\nWe can return to the simpler `Ping.Send()` pattern once we hit .NET Core 3-preview8 per the comment in that issue. \ud83d\ude42 \r\n\r\n### TODO:\r\n\r\n- Cleanup verbose messages\r\n- Add tests\r\n\r\n### Additional suggestions:\r\n\r\n- Add sequence numbers or timestamps to the standard PingStatus items so it's easy to see the order they were received in. https://github.com/PowerShell/PowerShell-RFC/pull/172#issuecomment-507719725 - @bobfrankly\r\n- Add the ability to ping all IP addresses in a given CIDR range (DDoS concerns maybe?) - @Romero126\r\n\r\n## PR Checklist\r\n\r\n- [x] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - Use the present tense and imperative mood when describing your changes\r\n- [x] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] [Make sure all `.h`, `.cpp`, `.cs`, `.ps1` and `.psm1` files have the correct copyright header](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [ ] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - If the PR is work in progress, please add the prefix `WIP:` or `[ WIP ]` to the beginning of the title (the `WIP` bot will keep its status check at `Pending` while the prefix is present) and remove the prefix when the PR is ready.\r\n- **[Breaking changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)**\r\n    - [ ] None\r\n    - **OR**\r\n    - [ ] [Experimental feature(s) needed](https://github.com/MicrosoftDocs/PowerShell-Docs/blob/staging/reference/6/Microsoft.PowerShell.Core/About/about_Experimental_Features.md)\r\n        - [ ] Experimental feature name(s): <!-- Experimental feature name(s) here -->\r\n- **User-facing changes**\r\n    - [ ] Not Applicable\r\n    - **OR**\r\n    - [x] [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n        - [ ] Issue filed: <!-- Number/link of that issue here -->\r\n- **Testing - New and feature**\r\n    - [ ] N/A or can only be tested interactively\r\n    - **OR**\r\n    - [ ] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n",
  "closed_at": "2019-10-04T17:55:33Z",
  "comments": [
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "Not sure it even makes sense to split style changes to be honest as this changes / rewrites a heck of a lot that I would cover in a style PR anyway.\r\n\r\nWe're still blocked on preview6 so I'm leaving the temp fix in for now so we can trust test results. When we get preview8 it isn't difficult to switch the pattern back.",
      "created_at": "2019-07-03T10:57:31Z",
      "updated_at": "2019-07-03T10:58:17Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Have pity!\ud83d\ude2d We have open about 50 PRs... ",
      "created_at": "2019-07-03T11:25:15Z",
      "updated_at": "2019-07-03T11:25:15Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "I know. But is one of these better, or four for the same thing? \ud83d\ude15 \r\n\r\nIf you'd really rather extra style PRs I can probably look to trim some of that out, but in a lot of ways the style changes are kind of tied into the rest of the changes. Let me know what you'd prefer! \ud83d\ude0a ",
      "created_at": "2019-07-03T13:19:29Z",
      "updated_at": "2019-07-03T13:21:12Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@vexx32 You will spend some time for temporary PRs but save a lot of time of reviewers. \r\nIt's incredible that someone can view more than 400-500 changes at a time.\r\nAfter PR exeeds 100 changes, any style change significantly slows down the code review and begins to annoy.\r\nWhile the PR draft you could make temporary PRs. I see many renames.\r\nAlso you could split functional changes too, ex. separate ping, traceroute and etc. to different PRs. \r\nAs for async, we get Preview7 in 5 weeks. I suppose we have nowhere to hurry.",
      "created_at": "2019-07-03T13:44:50Z",
      "updated_at": "2019-07-03T13:44:50Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "Yeah, I guess that makes sense.\r\n\r\nI'll look to do a style pass and see how I can split it out from there. Thanks! \ud83d\udc96 \r\nI may keep working in here till I see what I mucked up in the tests but as soon as I have this sorted I'll start splitting. \ud83d\ude42 ",
      "created_at": "2019-07-03T13:46:31Z",
      "updated_at": "2019-07-03T13:49:03Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "Closing this as this has been superceded by #10697 ",
      "created_at": "2019-10-04T17:55:33Z",
      "updated_at": "2019-10-04T17:55:33Z"
    }
  ],
  "created_at": "2019-07-01T23:10:00Z",
  "number": 10044,
  "state": "closed",
  "title": "Refactor Test-Connection",
  "updated_at": "2019-10-04T17:55:33Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/8889",
  "author": "TylerLeonhardt",
  "body": "<!-- Anything that looks like this is a comment and can't be seen after the Pull Request is created. -->  \r\n\r\n## PR Summary\r\n\r\nThis allows a user to start PowerShell up with the name of the named pipe that is used for cross process communication (I.e. `Enter-PSHostProcess`).\r\n\r\n### Example:\r\n\r\nterminal 1\r\n```\r\npwsh -custompipename mypipe\r\n```\r\nterminal 2\r\n```\r\nEnter-PSHostProcess -CustomPipeName mypipe\r\n```\r\n\r\n## PR Context  \r\n\r\nToday, it is impossible to predictively connect to a PowerShell process without knowing its process id. If you're stopping and starting a powershell process often... you have no mechanism for figuring out the process id.\r\n\r\nThis introduces a consistent way to connect to a PowerShell process by specifying the NamedPipe yourself.\r\n\r\nThis is very nice in PowerShell hosted scenarios - for example, in Azure Functions where PowerShell is hosted. This enables the ability to consistently connect to the PowerShell instance hosted there without any additional information besides the CustomPipeName that can be reused.\r\n\r\nThis feature also means that in the PowerShell extension for VSCode, we can achieve \"Attach to Process\" debugging with a single stroke of the <kbd>F5</kbd> key.\r\n\r\n## PR Checklist\r\n\r\n- [x] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - Use the present tense and imperative mood when describing your changes\r\n- [x] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] [Change is not breaking](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)\r\n- [x] [Make sure all `.h`, `.cpp`, `.cs`, `.ps1` and `.psm1` files have the correct copyright header](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - If the PR is work in progress, please add the prefix `WIP:` or `[ WIP ]` to the beginning of the title (the `WIP` bot will keep its status check at `Pending` while the prefix is present) and remove the prefix when the PR is ready.  \r\n- **User-facing changes**\r\n    - [ ] Not Applicable\r\n    - **OR**  \r\n    - [x] [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n        - [x] Issue filed: https://github.com/MicrosoftDocs/PowerShell-Docs/issues/3755\r\n- **Testing - New and feature**\r\n    - [ ] N/A or can only be tested interactively\r\n    - **OR**\r\n    - [x] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n        - [x] [Add `[feature]` to your commit messages if the change is significant or affects feature tests](https://github.com/PowerShell/PowerShell/blob/master/docs/testing-guidelines/testing-guidelines.md#requesting-additional-tests-for-a-pr)\r\n",
  "closed_at": "2019-02-22T18:40:04Z",
  "comments": [
    {
      "author": "TylerLeonhardt",
      "author_association": "MEMBER",
      "body": "@PaulHigin I've refactored this quite a bit based on your offline feedback. The same experience is there for a user at the CLI.\r\n\r\nFor users that are going through the API, the can use:\r\n\r\n```csharp\r\nS.M.A.Remoting.RemoteSessionNamedPipeServer.CreateCustomNamedPipeServer(\"mypipe\");\r\n```\r\n\r\nThere is 1 thing left to do here:\r\n\r\n- ~change the name from `DebugPipeName` to `CustomPipeName` - everyone feel free to comment~ changed\r\n\r\n- ~figure out what should happen when this static function is called multiple times - Should it throw? Or should it overwrite?~ I've added it to dispose of the current server and recreate the new one",
      "created_at": "2019-02-15T23:54:15Z",
      "updated_at": "2019-02-21T06:56:50Z"
    },
    {
      "author": "TylerLeonhardt",
      "author_association": "MEMBER",
      "body": "Addressed all feedback \ud83d\udc4d",
      "created_at": "2019-02-20T06:59:40Z",
      "updated_at": "2019-02-20T06:59:40Z"
    },
    {
      "author": "TylerLeonhardt",
      "author_association": "MEMBER",
      "body": "Ok I included a few CodeFactor and Codacy fixes as well. This should be good to go pending CI \u2705",
      "created_at": "2019-02-21T03:19:42Z",
      "updated_at": "2019-02-21T03:19:42Z"
    },
    {
      "author": "TylerLeonhardt",
      "author_association": "MEMBER",
      "body": "I've addressed @PaulHigin's final point which is that `DebugPipeName` is not totally accurate as this pipe could be used for other IPC scenarios. \r\n\r\nIt's mostly used for debugging though... and our usecase is really for debugging... so I've called this out in the `-help` page.\r\n\r\nHis recommendation and what I went with was `CustomPipeName`. I've updated that throughout.",
      "created_at": "2019-02-21T06:55:07Z",
      "updated_at": "2019-02-21T06:55:07Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@TylerLeonhardt Please create new Issue in PowerShell-Docs repo and add reference to the PR description.",
      "created_at": "2019-02-21T12:17:20Z",
      "updated_at": "2019-02-21T12:17:20Z"
    },
    {
      "author": "TylerLeonhardt",
      "author_association": "MEMBER",
      "body": "Alright CI is green and codacy and Code Factor are mostly happy. This should be good to go.",
      "created_at": "2019-02-22T02:15:04Z",
      "updated_at": "2019-02-22T02:15:04Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@TylerLeonhardt Please create new Issue in PowerShell-Docs repo before we merge.",
      "created_at": "2019-02-22T06:52:48Z",
      "updated_at": "2019-02-22T06:52:48Z"
    },
    {
      "author": "TylerLeonhardt",
      "author_association": "MEMBER",
      "body": "Done, @iSazonov!",
      "created_at": "2019-02-22T18:34:19Z",
      "updated_at": "2019-02-22T18:34:19Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@TylerLeonhardt Thanks for your contribution!",
      "created_at": "2019-02-22T18:40:24Z",
      "updated_at": "2019-02-22T18:40:24Z"
    }
  ],
  "created_at": "2019-02-13T19:44:49Z",
  "number": 8889,
  "state": "closed",
  "title": "[feature] Add -CustomPipeName to `pwsh` and `Enter-PSHostProcess`",
  "updated_at": "2019-03-22T18:29:04Z"
}
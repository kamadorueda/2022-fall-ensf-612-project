{
  "_url": "https://github.com/PowerShell/PowerShell/issues/17905",
  "author": "Flameancer",
  "body": "### Prerequisites\n\n- [X] Write a descriptive title.\n- [X] Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\n- [X] Search the existing issues.\n- [X] Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\n- [X] Refer to [Differences between Windows PowerShell 5.1 and PowerShell](https://docs.microsoft.com/powershell/scripting/whats-new/differences-from-windows-powershell).\n\n### Steps to reproduce\n\nWhenever I attempt to update powershell 7 using winget `winget upgrade --Id Microsoft.Powershell` this fails with the error: \"A newer version was found, but the install technology is different from the current version installed. Please uninstall the package and install the newer version\". \r\n\n\n### Expected behavior\n\n```console\nExpected behavior is still update powershell to the latest version using winget.\n```\n\n\n### Actual behavior\n\n```console\nUpdating powershell fails with an error. When viewing the logs, it appears that the local version installed is a .exe while the winget installer is a wix.\n```\n\n\n### Error details\n\n```console\n`winget upgrade --Id Microsoft.PowerShell\r\nA newer version was found, but the install technology is different from the current version installed. Please uninstall the package and install the newer version.`\n```\n\n\n### Environment data\n\n```powershell\nName                           Value\r\n----                           -----\r\nPSVersion                      7.2.5\r\nPSEdition                      Core\r\nGitCommitId                    7.2.5\r\nOS                             Microsoft Windows 10.0.25174\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\n```\n\n\n### Visuals\n\n[WinGet-2022-08-15-22-29-43.277.log](https://github.com/PowerShell/PowerShell/files/9347560/WinGet-2022-08-15-22-29-43.277.log)\r\n",
  "closed_at": "2022-08-16T02:47:50Z",
  "comments": [
    {
      "author": "kilasuit",
      "author_association": "COLLABORATOR",
      "body": "I think this is an issue that should have been raised on the [Winget Packages repo](https://github.com/microsoft/winget-pkgs) and not here as the PowerShell team do not own the install process via winget & as such I am closing this issue.",
      "created_at": "2022-08-16T02:47:50Z",
      "updated_at": "2022-08-16T02:47:50Z"
    },
    {
      "author": "OfficialEsco",
      "author_association": "NONE",
      "body": "This does indeed appear to be a Powershell issue according to the logs (which i also just replicated)\r\nPowershell version 7.2.5.0 reports to be installed as a EXE instead of a MSI/MSIX installer\r\n\r\n```\r\n2022-08-16 19:40:00.933 [CLI ] Starting installer selection.\r\n2022-08-16 19:40:00.933 [CLI ] Installer [X64,wix,Machine,] not applicable: Installed package type 'exe' is not compatible with installer type wix\r\n2022-08-16 19:40:00.933 [CLI ] Installer [X86,wix,Machine,] not applicable: Installed package type 'exe' is not compatible with installer type wix\r\n2022-08-16 19:40:00.933 [CLI ] Installer [Arm,msix,Machine,] not applicable: Installed package type 'exe' is not compatible with installer type msix\r\n2022-08-16 19:40:00.933 [CLI ] Installer [Arm,msix,Machine,] not applicable: Machine is not compatible with Arm\r\n2022-08-16 19:40:00.933 [CLI ] Installer [Arm64,msix,Machine,] not applicable: Installed package type 'exe' is not compatible with installer type msix\r\n2022-08-16 19:40:00.933 [CLI ] Installer [Arm64,msix,Machine,] not applicable: Machine is not compatible with Arm64\r\n2022-08-16 19:40:00.933 [CLI ] Installer [X86,msix,Machine,] not applicable: Installed package type 'exe' is not compatible with installer type msix\r\n2022-08-16 19:40:00.933 [CLI ] Installer [X64,msix,Machine,] not applicable: Installed package type 'exe' is not compatible with installer type msix\r\n```\r\n\r\nPlease don't stick your head into the sand before checking the easy to read logs next time :)\r\nIF you are going to say \"We've changed how the installer works\", how would we know?\r\n\r\nEdit: this is the registry key that triggers it\r\n```\r\nWindows Registry Editor Version 5.00\r\n\r\n[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\{9d71ada8-ab44-42bb-bee1-ac136a49f1af}]\r\n\"BundleCachePath\"=\"C:\\\\ProgramData\\\\Package Cache\\\\{9d71ada8-ab44-42bb-bee1-ac136a49f1af}\\\\PowerShell-7.2.5-win-x64.exe\"\r\n\"BundleUpgradeCode\"=hex(7):7b,00,37,00,41,00,38,00,30,00,34,00,43,00,42,00,42,\\\r\n  00,2d,00,36,00,34,00,38,00,45,00,2d,00,34,00,32,00,37,00,36,00,2d,00,39,00,\\\r\n  41,00,35,00,38,00,2d,00,30,00,38,00,31,00,38,00,36,00,32,00,44,00,42,00,31,\\\r\n  00,42,00,39,00,39,00,7d,00,00,00,00,00\r\n\"BundleAddonCode\"=hex(7):\r\n\"BundleDetectCode\"=hex(7):\r\n\"BundlePatchCode\"=hex(7):\r\n\"BundleVersion\"=\"7.2.5.0\"\r\n\"VersionMajor\"=dword:00000007\r\n\"VersionMinor\"=dword:00000002\r\n\"BundleProviderKey\"=\"{9d71ada8-ab44-42bb-bee1-ac136a49f1af}\"\r\n\"BundleTag\"=\"\"\r\n\"EngineVersion\"=\"3.11.2.4516\"\r\n\"DisplayIcon\"=\"C:\\\\ProgramData\\\\Package Cache\\\\{9d71ada8-ab44-42bb-bee1-ac136a49f1af}\\\\PowerShell-7.2.5-win-x64.exe,0\"\r\n\"DisplayName\"=\"PowerShell 7.2.5.0-x64\"\r\n\"DisplayVersion\"=\"7.2.5.0\"\r\n\"Publisher\"=\"Microsoft Corporation\"\r\n\"ModifyPath\"=\"\\\"C:\\\\ProgramData\\\\Package Cache\\\\{9d71ada8-ab44-42bb-bee1-ac136a49f1af}\\\\PowerShell-7.2.5-win-x64.exe\\\" /modify\"\r\n\"NoElevateOnModify\"=dword:00000001\r\n\"QuietUninstallString\"=\"\\\"C:\\\\ProgramData\\\\Package Cache\\\\{9d71ada8-ab44-42bb-bee1-ac136a49f1af}\\\\PowerShell-7.2.5-win-x64.exe\\\" /uninstall /quiet\"\r\n\"UninstallString\"=\"\\\"C:\\\\ProgramData\\\\Package Cache\\\\{9d71ada8-ab44-42bb-bee1-ac136a49f1af}\\\\PowerShell-7.2.5-win-x64.exe\\\"  /uninstall\"\r\n\"EstimatedSize\"=dword:000596f8\r\n\"Resume\"=dword:00000003\r\n\"Installed\"=dword:00000001\r\n```\r\n",
      "created_at": "2022-08-16T17:58:48Z",
      "updated_at": "2022-08-18T12:59:27Z"
    }
  ],
  "created_at": "2022-08-16T02:40:35Z",
  "labels": [
    "Resolution-External"
  ],
  "number": 17905,
  "state": "closed",
  "title": "Trying to update Powershell with winget fails",
  "updated_at": "2022-08-18T12:59:27Z"
}
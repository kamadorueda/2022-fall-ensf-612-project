{
  "_url": "https://github.com/PowerShell/PowerShell/issues/8845",
  "author": "MiYanni",
  "body": "# Description\r\nWhen creating [ProxyCommand](https://github.com/PowerShell/PowerShell/blob/master/src/System.Management.Automation/engine/ProxyCommand.cs), it does not copy over [ArgumentCompleter](https://github.com/PowerShell/PowerShell/blob/ec88045fee57028cfabd3877bfb588f46b063c1a/src/System.Management.Automation/engine/CommandCompletion/ExtensibleCompletion.cs#L23) attributes to the parameters. The attributes themselves are property copied over to the [ParameterMetadata](https://github.com/PowerShell/PowerShell/blob/ec88045fee57028cfabd3877bfb588f46b063c1a/src/System.Management.Automation/engine/TypeMetadata.cs#L367), but this class has hard-coded conditions for which attributes it handles. The [ArgumentCompleter](https://github.com/PowerShell/PowerShell/blob/ec88045fee57028cfabd3877bfb588f46b063c1a/src/System.Management.Automation/engine/CommandCompletion/ExtensibleCompletion.cs#L23) attribute type is not handled in [GetProxyAttributeData](https://github.com/PowerShell/PowerShell/blob/ec88045fee57028cfabd3877bfb588f46b063c1a/src/System.Management.Automation/engine/TypeMetadata.cs#L895).\r\n\r\n# Steps to reproduce\r\nThe script I have is more complex, so I'll attempt to simplify below. Basically, create a [CommandMetadata](https://github.com/PowerShell/PowerShell/blob/master/src/System.Management.Automation/engine/CommandMetadata.cs) out of a [CommandInfo](https://github.com/PowerShell/PowerShell/blob/master/src/System.Management.Automation/engine/CommandInfo.cs) (returned from [Get-Command](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/get-command)) that contains parameters with [ArgumentCompleterAttribute](https://github.com/PowerShell/PowerShell/blob/ec88045fee57028cfabd3877bfb588f46b063c1a/src/System.Management.Automation/engine/CommandCompletion/ExtensibleCompletion.cs#L23). Then, pass the [CommandMetadata](https://github.com/PowerShell/PowerShell/blob/master/src/System.Management.Automation/engine/CommandMetadata.cs) to the [Create](https://github.com/PowerShell/PowerShell/blob/ec88045fee57028cfabd3877bfb588f46b063c1a/src/System.Management.Automation/engine/ProxyCommand.cs#L40) method in [ProxyCommand](https://github.com/PowerShell/PowerShell/blob/master/src/System.Management.Automation/engine/ProxyCommand.cs). When you output the [ProxyCommand](https://github.com/PowerShell/PowerShell/blob/master/src/System.Management.Automation/engine/ProxyCommand.cs), you'll see there is no [ArgumentCompleterAttribute](https://github.com/PowerShell/PowerShell/blob/ec88045fee57028cfabd3877bfb588f46b063c1a/src/System.Management.Automation/engine/CommandCompletion/ExtensibleCompletion.cs#L23) attributes in the output.\r\n\r\n```powershell\r\n$cmdlet = Get-Command -Name 'Test-Cmdlet'\r\n$metadata = New-Object System.Management.Automation.CommandMetadata($_)\r\n$proxyCmdlet = [System.Management.Automation.ProxyCommand]::Create($metadata)\r\nSet-Content -Path 'TestProxyCmdlet.ps1' -Value $proxyCmdlet\r\n```\r\n\r\n# Expected behavior\r\nThe [ProxyCommand](https://github.com/PowerShell/PowerShell/blob/master/src/System.Management.Automation/engine/ProxyCommand.cs) contains the [ArgumentCompleter](https://github.com/PowerShell/PowerShell/blob/ec88045fee57028cfabd3877bfb588f46b063c1a/src/System.Management.Automation/engine/CommandCompletion/ExtensibleCompletion.cs#L23) attribute for the appropriate parameters.\r\n\r\n# Actual behavior\r\nThe [ProxyCommand](https://github.com/PowerShell/PowerShell/blob/master/src/System.Management.Automation/engine/ProxyCommand.cs) **does not** contain the [ArgumentCompleter](https://github.com/PowerShell/PowerShell/blob/ec88045fee57028cfabd3877bfb588f46b063c1a/src/System.Management.Automation/engine/CommandCompletion/ExtensibleCompletion.cs#L23) attribute for the appropriate parameters.\r\n\r\n# Environment data\r\n```none\r\nName                           Value\r\n----                           -----\r\nPSVersion                      6.0.1\r\nPSEdition                      Core\r\nGitCommitId                    v6.0.1\r\nOS                             Microsoft Windows 10.0.17763\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```",
  "closed_at": null,
  "comments": [],
  "created_at": "2019-02-07T19:00:06Z",
  "number": 8845,
  "state": "open",
  "title": "ProxyCommand does not support ArgumentCompleterAttribute for ParameterMetadata",
  "updated_at": "2021-01-15T07:41:55Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/14237",
  "author": "he852100",
  "body": "<!--\r\n\r\nFor Windows PowerShell 5.1 issues, suggestions, or feature requests please use the following link instead:\r\nWindows PowerShell [UserVoice](https://windowsserver.uservoice.com/forums/301869-powershell)\r\n\r\nThis repository is **ONLY** for PowerShell Core 6 and PowerShell 7+ issues.\r\n\r\n- Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\r\n- Search the existing issues.\r\n- Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\r\n- Refer to the [known issues](https://docs.microsoft.com/powershell/scripting/whats-new/known-issues-ps6).\r\n\r\n-->\r\n\r\n## Steps to reproduce\r\n\r\n```powershell\r\n\r\n$a=xxx.py\r\n$a\r\n```\r\n\r\n## Expected behavior\r\n\r\n```none\r\n\r\n\r\n```\r\n![image](https://user-images.githubusercontent.com/26913892/99953996-0d4ab200-2dbd-11eb-9b8b-f86b9a250147.png)\r\n## Actual behavior\r\n\r\n```none\r\n\r\n```\r\n\r\n## Environment data\r\n\r\n<!-- provide the output of $PSVersionTable -->\r\n\r\n```none\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.1.0\r\nPSEdition                      Core\r\nGitCommitId                    7.1.0\r\nOS                             Microsoft Windows 10.0.19042\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n",
  "closed_at": null,
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "The screenshot is with \"Windows PowerShell\" in title, not 7.1,.",
      "created_at": "2020-11-23T11:33:01Z",
      "updated_at": "2020-11-23T11:33:01Z"
    },
    {
      "author": "he852100",
      "author_association": "NONE",
      "body": "pwsh \u300aenter\u300b no way\uff1f\r\n\r\n",
      "created_at": "2020-11-23T13:17:09Z",
      "updated_at": "2020-12-19T03:12:12Z"
    },
    {
      "author": "he852100",
      "author_association": "NONE",
      "body": "python 3.8\r\n```python\r\ns = \"\u6211\u7231\u7956\u56fd\"\r\nprint (s+'default')\r\nstr1 = s.encode(encoding=\"utf-8\",errors=\"strict\")\r\nstr2 = s.encode(\"gb2312\") #\u7f16\u7801\u9519\u8bef\u7684\u5904\u7406\u65b9\u6848\u9ed8\u8ba4\u4e3a\"strict\"\r\nstr3 = s.encode(\"gbk\")\r\nprint(str1.decode(encoding=\"utf-8\",errors=\"strict\")+'utf8')#\u7528utf-8\u7684\u89e3\u7801\u683c\u5f0f\uff0c\u89e3\u7801str1.\r\nprint(str1.decode(encoding=\"gbk\",errors=\"ignore\")+'gbk-i')##\u5982\u679c\u4ee5gbk\u7684\u89e3\u7801\u683c\u5f0f\u5bf9str1\u8fdb\u884c\u89e3\u7801\u5f97\uff0c\u5c06\u65e0\u6cd5\u8fd8\u539f\u539f\u6765\u7684\u5b57\u7b26\u4e32\u5185\u5bb9\r\nprint(str1.decode(encoding=\"gbk\",errors=\"strict\")+'gbk-s')\r\nprint(str1.decode(encoding=\"gbk\",errors=\"replace\")+'gbk-r')\r\nprint(\"\\n\")\r\nprint(str2.decode(\"gb2312\")+'gb2312')\r\nprint(str3.decode(\"gbk\")+'gbk')\r\n```\r\npwsh7.1\r\n```powershell\r\nwrite-host 'Direct output' -ForegroundColor DarkRed\r\n& C:/Users/he/scoop/apps/python/current/python.exe c:/Users/he/Desktop/sh/weixin/tests1.py\r\n$test=& C:/Users/he/scoop/apps/python/current/python.exe c:/Users/he/Desktop/sh/weixin/tests1.py\r\nwrite-host 'variable output' -ForegroundColor  DarkRed\r\n    \r\n\r\n$test\r\nfunction test-encode {\r\n    PAram([string]$data)\r\n    if (-not($data)) { Write-Error \"\u6ca1\u6709\u8f93\u5165\u503c,\u4f8b\u5982\uff1a\u6d4b\u8bd5\"; break; }\r\n    $encode =\r\n    @(\r\n        37, 'IBM EBCDIC\uff08\u7f8e\u56fd-\u52a0\u62ff\u5927\uff09\r\n',\r\n        437, 'OEM\u7f8e\u56fd\r\n',\r\n        500, 'IBM EBCDIC\uff08\u56fd\u9645\uff09\r\n',\r\n        708, '\u963f\u62c9\u4f2f\u6587\uff08ASMO 708\uff09\r\n',\r\n        720, '\u963f\u62c9\u4f2f\u6587\uff08DOS\uff09\r\n',\r\n        737, '\u5e0c\u814a\u6587\uff08DOS\uff09\r\n',\r\n        775, '\u6ce2\u7f57\u7684\u6d77\uff08DOS\uff09\r\n',\r\n        850, '\u897f\u6b27\uff08DOS\uff09\r\n',\r\n        852, '\u4e2d\u6b27\uff08DOS\uff09\r\n',\r\n        855, '\u897f\u91cc\u5c14OEM\r\n',\r\n        857, '\u571f\u8033\u5176\u6587\uff08DOS\uff09\r\n',\r\n        858, 'OEM\u591a\u8bed\u79cd\u62c9\u4e01\u8bedI\r\n',\r\n        860, '\u8461\u8404\u7259\u8bed\uff08DOS\uff09\r\n',\r\n        861, '\u51b0\u5c9b\u6587\uff08DOS\uff09\r\n',\r\n        862, '\u5e0c\u4f2f\u6765\u8bed\uff08DOS\uff09\r\n',\r\n        863, '\u52a0\u62ff\u5927\u6cd5\u8bed\uff08DOS\uff09\r\n',\r\n        864, '\u963f\u62c9\u4f2f\u6587\uff08864\uff09\r\n',\r\n        865, '\u5317\u6b27\uff08DOS\uff09\r\n',\r\n        866, '\u897f\u91cc\u5c14\u5b57\u6bcd\uff08DOS\uff09\r\n',\r\n        869, '\u5e0c\u814a\u6587\uff0c\u73b0\u4ee3\uff08DOS\uff09\r\n',\r\n        870, 'IBM EBCDIC\uff08\u591a\u8bed\u8a00Latin-2\uff09\r\n',\r\n        874, '\u6cf0\u8bed\uff08Windows\uff09\r\n',\r\n        875, 'IBM EBCDIC\uff08\u5e0c\u814a\u8bed\u73b0\u4ee3\uff09\r\n',\r\n        932, '\u65e5\u8bed\uff08Shift-JIS\uff09\r\n',\r\n        936, '\u7b80\u4f53\u4e2d\u6587\uff08GB2312\uff09\r\n',\r\n        949, '\u97e9\u8bed\r\n',\r\n        950, '\u7e41\u4f53\u4e2d\u6587\uff08Big5\uff09\r\n',\r\n        1026, 'IBM EBCDIC\uff08\u571f\u8033\u5176\u8bedLatin-5\uff09\r\n',\r\n        1047, 'IBM Latin-1\r\n',\r\n        1140, 'IBM EBCDIC\uff08\u7f8e\u56fd-\u52a0\u62ff\u5927-\u6b27\u5143\uff09\r\n',\r\n        1141, 'IBM EBCDIC\uff08\u5fb7\u56fd-\u6b27\u6d32\uff09\r\n',\r\n        1142, 'IBM EBCDIC\uff08\u4e39\u9ea6-\u632a\u5a01-\u6b27\u6d32\uff09\r\n',\r\n        1143, 'IBM EBCDIC\uff08\u82ac\u5170-\u745e\u5178-\u6b27\u6d32\uff09\r\n',\r\n        1144, 'IBM EBCDIC\uff08\u610f\u5927\u5229-\u6b27\u6d32\uff09\r\n',\r\n        1145, 'IBM EBCDIC\uff08\u897f\u73ed\u7259-\u6b27\u6d32\uff09\r\n',\r\n        1146, 'IBM EBCDIC\uff08\u82f1\u56fd-\u6b27\u6d32\uff09\r\n',\r\n        1147, 'IBM EBCDIC\uff08\u6cd5\u56fd-\u6b27\u6d32\uff09\r\n',\r\n        1148, 'IBM EBCDIC\uff08\u56fd\u9645-\u6b27\u5143\uff09\r\n',\r\n        1149, 'IBM EBCDIC\uff08\u51b0\u5c9b\u6b27\u5143\uff09\r\n',\r\n        1200, '\u7edf\u4e00\u7801\r\n',\r\n        1201, 'Unicode\uff08\u5927\u7aef\uff09\r\n',\r\n        1250, '\u4e2d\u6b27\uff08Windows\uff09\r\n',\r\n        1251, '\u897f\u91cc\u5c14\u6587\uff08Windows\uff09\r\n',\r\n        1252, '\u897f\u6b27\uff08Windows\uff09\r\n',\r\n        1253, '\u5e0c\u814a\u6587\uff08Windows\uff09\r\n',\r\n        1254, '\u571f\u8033\u5176\u8bed\uff08Windows\uff09\r\n',\r\n        1255, '\u5e0c\u4f2f\u6765\u8bed\uff08Windows\uff09\r\n',\r\n        1256, '\u963f\u62c9\u4f2f\u8bed\uff08Windows\uff09\r\n',\r\n        1257, '\u6ce2\u7f57\u7684\u6d77\uff08Windows\uff09\r\n',\r\n        1258, '\u8d8a\u5357\u6587\uff08Windows\uff09\r\n',\r\n        1361, '\u97e9\u8bed\uff08Johab\uff09\r\n',\r\n        10000, '\u897f\u6b27\uff08Mac\uff09\r\n',\r\n        10001, '\u65e5\u8bed\uff08\u82f9\u679c\u673a\uff09\r\n',\r\n        10002, '\u7e41\u4f53\u4e2d\u6587\uff08Mac\uff09\r\n',\r\n        10003, '\u97e9\u6587\uff08Mac\uff09\r\n',\r\n        10004, '\u963f\u62c9\u4f2f\u6587\uff08Mac\uff09\r\n',\r\n        10005, '\u5e0c\u4f2f\u6765\u8bed\uff08Mac\uff09\r\n',\r\n        10006, '\u5e0c\u814a\u6587\uff08Mac\uff09\r\n',\r\n        10007, '\u897f\u91cc\u5c14\u6587\uff08Mac\uff09\r\n',\r\n        10008, '\u7b80\u4f53\u4e2d\u6587\uff08Mac\uff09\r\n',\r\n        10010, '\u7f57\u9a6c\u5c3c\u4e9a\u8bed\uff08Mac\uff09\r\n',\r\n        10017, '\u4e4c\u514b\u5170\u6587\uff08Mac\uff09\r\n',\r\n        10021, '\u6cf0\u8bed\uff08Mac\uff09\r\n',\r\n        10029, '\u4e2d\u6b27\uff08Mac\uff09\r\n',\r\n        10079, '\u51b0\u5c9b\u6587\uff08Mac\uff09\r\n',\r\n        10081, '\u571f\u8033\u5176\u6587\uff08Mac\uff09\r\n',\r\n        10082, '\u514b\u7f57\u5730\u4e9a\u8bed\uff08Mac\uff09\r\n',\r\n        12000, 'Unicode\uff08UTF-32\uff09\r\n',\r\n        12001, 'Unicode\uff08UTF-32\u5927\u7aef\uff09\r\n',\r\n        20000, '\u7e41\u4f53\u4e2d\u6587\uff08CNS\uff09\r\n',\r\n        20001, '\u53f0\u6e7eTCA\r\n',\r\n        20002, '\u7e41\u4f53\u4e2d\u6587\uff08\u5341\uff09\r\n',\r\n        20003, 'IBM5550\u53f0\u6e7e\r\n',\r\n        20004, '\u53f0\u6e7e\u56fe\u6587\u7535\u89c6\r\n',\r\n        20005, '\u738b\u53f0\r\n',\r\n        20105, '\u897f\u6b27\uff08IA5\uff09\r\n',\r\n        20106, '\u5fb7\u8bed\uff08IA5\uff09\r\n',\r\n        20107, '\u745e\u5178\u6587\uff08IA5\uff09\r\n',\r\n        20108, '\u632a\u5a01\u6587\uff08IA5\uff09\r\n',\r\n        20127, '\u7f8e\u56fdASCII\r\n',\r\n        20261, 'T.61\r\n',\r\n        20269, 'ISO-6937\r\n',\r\n        20273, 'IBM EBCDIC\uff08\u5fb7\u56fd\uff09\r\n',\r\n        20277, 'IBM EBCDIC\uff08\u4e39\u9ea6-\u632a\u5a01\uff09\r\n',\r\n        20278, 'IBM EBCDIC\uff08\u82ac\u5170-\u745e\u5178\uff09\r\n',\r\n        20280, 'IBM EBCDIC\uff08\u610f\u5927\u5229\uff09\r\n',\r\n        20284, 'IBM EBCDIC\uff08\u897f\u73ed\u7259\uff09\r\n',\r\n        20285, 'IBM EBCDIC\uff08\u82f1\u56fd\uff09\r\n',\r\n        20290, 'IBM EBCDIC\uff08\u65e5\u8bed\u7247\u5047\u540d\uff09\r\n',\r\n        20297, 'IBM EBCDIC\uff08\u6cd5\u56fd\uff09\r\n',\r\n        20420, 'IBM EBCDIC\uff08\u963f\u62c9\u4f2f\u8bed\uff09\r\n',\r\n        20423, 'IBM EBCDIC\uff08\u5e0c\u814a\u6587\uff09\r\n',\r\n        20424, 'IBM EBCDIC\uff08\u5e0c\u4f2f\u6765\u8bed\uff09\r\n',\r\n        20833, 'IBM EBCDIC\uff08\u97e9\u8bed\u6269\u5c55\uff09\r\n',\r\n        20838, 'IBM EBCDIC\uff08\u6cf0\u56fd\uff09\r\n',\r\n        20866, '\u897f\u91cc\u5c14\u5b57\u6bcd\uff08KOI8-R\uff09\r\n',\r\n        20871, 'IBM EBCDIC\uff08\u51b0\u5c9b\u8bed\uff09\r\n',\r\n        20880, 'IBM EBCDIC\uff08\u897f\u91cc\u5c14\u6587\uff09\r\n',\r\n        20905, 'IBM EBCDIC\uff08\u571f\u8033\u5176\u8bed\uff09\r\n',\r\n        20924, 'IBM Latin-1\r\n',\r\n        20932, '\u65e5\u8bed\uff08JIS 0208-1990\u548c0212-1990\uff09\r\n',\r\n        20936, '\u7b80\u4f53\u4e2d\u6587\uff08GB2312-80\uff09\r\n',\r\n        20949, '\u97e9\u56fd\u4e07\u6210\r\n',\r\n        21025, 'IBM EBCDIC\uff08\u897f\u91cc\u5c14\u6587-\u4fdd\u52a0\u5229\u4e9a\u6587\uff09\r\n',\r\n        21866, '\u897f\u91cc\u5c14\u5b57\u6bcd\uff08KOI8-U\uff09\r\n',\r\n        28591, '\u897f\u6b27\uff08ISO\uff09\r\n',\r\n        28592, '\u4e2d\u6b27\uff08ISO\uff09\r\n',\r\n        28593, '\u62c9\u4e01\u65873\uff08ISO\uff09\r\n',\r\n        28594, '\u6ce2\u7f57\u7684\u6d77\uff08ISO\uff09\r\n',\r\n        28595, '\u897f\u91cc\u5c14\u6587\uff08ISO\uff09\r\n',\r\n        28596, '\u963f\u62c9\u4f2f\u6587\uff08ISO\uff09\r\n',\r\n        28597, '\u5e0c\u814a\u6587\uff08ISO\uff09\r\n',\r\n        28598, '\u5e0c\u4f2f\u6765\u8bed\uff08ISO-Visual\uff09\r\n',\r\n        28599, '\u571f\u8033\u5176\u6587\uff08ISO\uff09\r\n',\r\n        28603, '\u7231\u6c99\u5c3c\u4e9a\u8bed\uff08ISO\uff09\r\n',\r\n        28605, '\u62c9\u4e01\u65879\uff08ISO\uff09\r\n',\r\n        29001, '\u6b27\u7f57\u5df4\r\n',\r\n        38598, '\u5e0c\u4f2f\u6765\u8bed\uff08ISO\u903b\u8f91\uff09\r\n',\r\n        50220, '\u65e5\u8bed\uff08JIS\uff09\r\n',\r\n        50221, '\u65e5\u8bed\uff08JIS\u5141\u8bb81\u5b57\u8282\u5047\u540d\uff09\r\n',\r\n        50222, '\u65e5\u8bed\uff08JIS\u5141\u8bb81\u5b57\u8282\u5047\u540d-SO / SI\uff09\r\n',\r\n        50225, '\u97e9\u6587\uff08ISO\uff09\r\n',\r\n        50227, '\u7b80\u4f53\u4e2d\u6587\uff08ISO-2022\uff09\r\n',\r\n        51932, '\u65e5\u8bed\uff08EUC\uff09\r\n',\r\n        51936, '\u7b80\u4f53\u4e2d\u6587\uff08EUC\uff09\r\n',\r\n        51949, '\u97e9\u6587\uff08EUC\uff09\r\n',\r\n        52936, '\u7b80\u4f53\u4e2d\u6587\uff08HZ\uff09\r\n',\r\n        54936, '\u7b80\u4f53\u4e2d\u6587\uff08GB18030\uff09\r\n',\r\n        57002, 'ISCII\u68b5\u6587\r\n',\r\n        57003, 'ISCII\u5b5f\u52a0\u62c9\u8bed\r\n',\r\n        57004, 'ISCII\u6cf0\u7c73\u5c14\u8bed\r\n',\r\n        57005, 'ISCII\u6cf0\u5362\u56fa\u8bed\r\n',\r\n        57006, 'ISCII\u963f\u8428\u59c6\u8bed\r\n',\r\n        57007, 'ISCII\u5965\u91cc\u4e9a\u8bed\r\n',\r\n        57008, 'ISCII\u5361\u7eb3\u8fbe\u8bed\r\n',\r\n        57009, 'ISCII\u9a6c\u62c9\u96c5\u62c9\u59c6\u8bed\r\n',\r\n        57010, 'ISCII\u53e4\u5409\u62c9\u7279\u8bed\r\n',\r\n        57011, 'ISCII\u65c1\u906e\u666e\u8bed\r\n',\r\n        65000, 'Unicode\uff08UTF-7\uff09\r\n',\r\n        65001, 'Unicode\uff08UTF-8\uff09\r\n'\r\n    )\r\n    $ErrorActionPreference = \"SilentlyContinue\"\r\n    $format = for (($i = 0), ($j = 1); $i -lt $encode.length; ($i += 2), ($j += 2)) {\r\n        [PScustomobject]@{'\u7f16\u7801' = $([string]$encode[$i]+'-'+$encode[$j]); '\u5b57\u7b26' = [System.Text.Encoding]::UTF8.GetString([System.Text.Encoding]::GetEncoding([int]$encode[$i]).GetBytes($data))\r\n        }\r\n    }\r\n\r\n    $format #|select-string -Pattern '\u6d4b\u8bd5'\r\n}\r\ntest-encode $test\r\n```\r\n![image](https://user-images.githubusercontent.com/26913892/102680768-5e03ce00-41f6-11eb-8573-3e19544e99ad.png)\r\n\r\nmagical\r\n@iSazonov \r\n",
      "created_at": "2020-12-19T03:14:58Z",
      "updated_at": "2020-12-19T04:37:12Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "What is  chcp output? Maybe you need to switch console to Unicode.",
      "created_at": "2020-12-19T06:24:46Z",
      "updated_at": "2020-12-19T06:24:46Z"
    }
  ],
  "created_at": "2020-11-23T10:55:11Z",
  "number": 14237,
  "state": "open",
  "title": "I don't know this font",
  "updated_at": "2020-12-19T06:24:46Z"
}
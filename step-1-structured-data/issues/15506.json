{
  "_url": "https://github.com/PowerShell/PowerShell/issues/15506",
  "author": "Mjj87776",
  "body": "<!--\r\n\r\n\r\n\r\nPS C:\\Windows\\System32>\r\n\r\n-->\r\n\r\n## Steps to reproduce\r\n\r\n```Using PowerShell 7.1.3 on W10 20h2, I'm trying to install ExchangeOnlineManagement but getting the following error:\r\n\r\n\r\nPS C:\\Windows\\System32> Install-Module ExchangeOnlineManagement\r\nWARNING: Unable to resolve package source 'https://www.powershellgallery.com/api/v2'.\r\nInstall-Package: C:\\program files\\powershell\\7\\Modules\\PowerShellGet\\PSModule.psm1:9711\r\nLine |\r\n9711 |  \u2026 talledPackages = PackageManagement\\Install-Package @PSBoundParameters\r\n     |                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n     | No match was found for the specified search criteria and module name 'ExchangeOnlineManagement'. Try\r\n     | Get-PSRepository to see all available registered module repositories.\r\n\r\n```\r\n\r\n## Expected behavior\r\n\r\n```none\r\n\r\n```\r\n\r\n## Actual behavior\r\n\r\n```I've ran with verbose and debug:\r\nPS C:\\Windows\\System32> Install-Module ExchangeOnlineManagement -Verbose -Debug\r\nDEBUG: 00:00:00.0000001 Calling New() : MethodName = 'GetDynamicOptions'\r\nDEBUG: 00:00:00.0000356 Name: ExchangeOnlineManagement\r\nDEBUG: 00:00:00.0000491 Verbose: True\r\nDEBUG: 00:00:00.0000565 Debug: True\r\nDEBUG: 00:00:00.0026067 INVOKING PowerShell Fn Get-DynamicOptions with args Provider that has length 1\r\nDEBUG: 00:00:00.0032679 In PowerShellGet Provider - 'Get-DynamicOptions'.\r\nDEBUG: 00:00:00.0044567 Done calling powershell \u00abGet-DynamicOptions\u00bb \u00abPSModule\u00bb\r\nDEBUG: 00:00:00.0091190 Calling New() : MethodName = 'GetDynamicOptions'\r\nDEBUG: 00:00:00.0091446 Name: ExchangeOnlineManagement\r\nDEBUG: 00:00:00.0091520 Verbose: True\r\nDEBUG: 00:00:00.0091588 Debug: True\r\nDEBUG: 00:00:00.0098284 INVOKING PowerShell Fn Get-DynamicOptions with args Source that has length 1\r\nDEBUG: 00:00:00.0103915 In PowerShellGet Provider - 'Get-DynamicOptions'.\r\nDEBUG: 00:00:00.0117005 Done calling powershell \u00abGet-DynamicOptions\u00bb \u00abPSModule\u00bb\r\nDEBUG: 00:00:00.0137037 Calling New() : MethodName = 'GetDynamicOptions'\r\nDEBUG: 00:00:00.0137299 Name: ExchangeOnlineManagement\r\nDEBUG: 00:00:00.0137379 Verbose: True\r\nDEBUG: 00:00:00.0137443 Debug: True\r\nDEBUG: 00:00:00.0144086 INVOKING PowerShell Fn Get-DynamicOptions with args Package that has length 1\r\nDEBUG: 00:00:00.0150325 In PowerShellGet Provider - 'Get-DynamicOptions'.\r\nDEBUG: 00:00:00.0173225 Done calling powershell \u00abGet-DynamicOptions\u00bb \u00abPSModule\u00bb\r\nDEBUG: 00:00:00.0195862 Calling New() : MethodName = 'GetDynamicOptions'\r\nDEBUG: 00:00:00.0196125 Name: ExchangeOnlineManagement\r\nDEBUG: 00:00:00.0196199 Verbose: True\r\nDEBUG: 00:00:00.0196268 Debug: True\r\nDEBUG: 00:00:00.0202156 INVOKING PowerShell Fn Get-DynamicOptions with args Install that has length 1\r\nDEBUG: 00:00:00.0207667 In PowerShellGet Provider - 'Get-DynamicOptions'.\r\nDEBUG: 00:00:00.0226469 Done calling powershell \u00abGet-DynamicOptions\u00bb \u00abPSModule\u00bb\r\nDEBUG: 00:00:00.0343107 Calling SearchForPackages. Name='ExchangeOnlineManagement'\r\nVERBOSE: Using the provider 'PowerShellGet' for searching packages.\r\nDEBUG: 00:00:00.0353564 PackageProvider::FindPackage with name ExchangeOnlineManagement\r\nDEBUG: 00:00:00.0363589 Calling SearchForPackages After Select 1\r\nDEBUG: 00:00:00.0378531 Calling New() : MethodName = 'FindPackage'\r\nDEBUG: 00:00:00.0384285 Verbose: True\r\nDEBUG: 00:00:00.0390176 Name: ExchangeOnlineManagement\r\nDEBUG: 00:00:00.0395570 Scope: CurrentUser\r\nDEBUG: 00:00:00.0400839 ProviderName: PowerShellGet\r\nDEBUG: 00:00:00.0406215 Debug: True\r\nDEBUG: 00:00:00.0413142 MessageResolver: Microsoft.PowerShell.PackageManagement.Cmdlets.GetMessageString\r\nDEBUG: 00:00:00.0421523 Type: Module\r\nDEBUG: 00:00:00.0584236 INVOKING PowerShell Fn Find-Package with args System.String[], , ,  that has length 4\r\nDEBUG: 00:00:00.0608427 In PowerShellGet Provider - 'Find-Package'.\r\nDEBUG: 00:00:00.0619294 OPTION: Verbose => True\r\nDEBUG: 00:00:00.0625510 OPTION: Name => ExchangeOnlineManagement\r\nDEBUG: 00:00:00.0631710 OPTION: Scope => CurrentUser\r\nDEBUG: 00:00:00.0638907 OPTION: ProviderName => PowerShellGet\r\nDEBUG: 00:00:00.0647056 OPTION: Debug => True\r\nDEBUG: 00:00:00.0654178 OPTION: MessageResolver => Microsoft.PowerShell.PackageManagement.Cmdlets.GetMessageString\r\nDEBUG: 00:00:00.0659782 OPTION: Type => Module\r\nVERBOSE: The -Repository parameter was not specified.  PowerShellGet will use all of the registered repositories.\r\nVERBOSE: Getting the provider object for the PackageManagement Provider 'NuGet'.\r\nVERBOSE: The specified Location is 'https://www.powershellgallery.com/api/v2' and PackageManagementProvider is 'NuGet'.\r\nDEBUG: 00:00:00.0711990 PackageProvider::FindPackage with name ExchangeOnlineManagement\r\nDEBUG: 00:00:00.0731945 Calling 'NuGet'::'FindPackage' - name='ExchangeOnlineManagement', requiredVersion='',minimumVersion='', maximumVersion='''.\r\nDEBUG: 00:00:00.0739694 Iterating 'ExchangeOnlineManagement'.\r\nDEBUG: 00:00:00.0760626 There are '0' registered sources in 'NuGet' provider.\r\nDEBUG: 00:00:00.0768264 Source 'https://www.powershellgallery.com/api/v2' is not one of the registered sources in 'NuGet' provider.\r\nWARNING: Unable to resolve package source 'https://www.powershellgallery.com/api/v2'.\r\n\r\nConfirm\r\nContinue with this operation?\r\n[Y] Yes  [A] Yes to All  [H] Halt Command  [S] Suspend  [?] Help (default is \"Y\"): Y\r\nVERBOSE: Total package yield:'0' for the specified package 'ExchangeOnlineManagement'.\r\nDEBUG: 00:00:01.3022692 Completed iterating for 'ExchangeOnlineManagement'.\r\nDEBUG: 00:00:01.3033743 Calling 'NuGetRequest'::'FindRegisteredSource', 'https://www.powershellgallery.com/api/v2'.\r\nDEBUG: 00:00:01.3041977 PowerShell Script 'PSModule' Function 'Find-Package' returns null.\r\nDEBUG: 00:00:01.3052509 Done calling powershell \u00abFind-Package\u00bb \u00abPSModule\u00bb\r\nDEBUG: 00:00:01.3062885 unmatched package name='ExchangeOnlineManagement'\r\nInstall-Package: C:\\program files\\powershell\\7\\Modules\\PowerShellGet\\PSModule.psm1:9711\r\nLine |\r\n9711 |  \u2026 talledPackages = PackageManagement\\Install-Package @PSBoundParameters\r\n     |                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n     | No match was found for the specified search criteria and module name 'ExchangeOnlineManagement'. Try\r\n     | Get-PSRepository to see all available registered module repositories.\r\n\r\n\r\n\r\n```\r\n\r\n## Environment data\r\n\r\n<!-- provide the output of $PSVersionTable -->\r\n\r\n```none\r\n\r\n```\r\n",
  "closed_at": "2022-01-18T09:16:21Z",
  "comments": [
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "Might be related to the cert issue? https://twitter.com/Steve_MSFT/status/1400290882515922950?s=20\n\n<blockquote><img src=\"https://pbs.twimg.com/profile_images/705100912310644736/cGIMuYyu_400x400.jpg\" width=\"48\" align=\"right\"><div>Twitter</div><div><strong><a href=\"https://twitter.com/Steve_MSFT/status/1400290882515922950\">Steve Lee on Twitter</a></strong></div><div>\u201cSorry folks, looks like the SSL cert for PowerShellGallery expired, we\u2019re fixing it, but need to understand how this happened again\u201d</div></blockquote>",
      "created_at": "2021-06-03T12:47:02Z",
      "updated_at": "2021-06-03T12:47:04Z"
    },
    {
      "author": "ThomasNieto",
      "author_association": "CONTRIBUTOR",
      "body": "I was able to install that module. Can we close out this issue?",
      "created_at": "2022-01-17T21:40:34Z",
      "updated_at": "2022-01-17T21:40:34Z"
    },
    {
      "author": "Mjj87776",
      "author_association": "NONE",
      "body": "> I was able to install that module. Can we close out this issue?\r\n\r\nYes, happy to close the issue - thanks.",
      "created_at": "2022-01-18T09:16:20Z",
      "updated_at": "2022-01-18T09:16:20Z"
    }
  ],
  "created_at": "2021-06-02T16:00:05Z",
  "labels": [],
  "number": 15506,
  "state": "closed",
  "title": "Can't install modules from PSGallery",
  "updated_at": "2022-01-18T09:16:26Z"
}
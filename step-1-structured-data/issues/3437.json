{
  "_url": "https://github.com/PowerShell/PowerShell/issues/3437",
  "author": "SteveL-MSFT",
  "body": "In some environments (like Puppet), the HOME env var is not defined and this causes PowerShell to fail to start as it assumes HOME is available and tries to end up concatenating $null with a string.  Fix is to return an empty string instead of $null.  Side effect is that some working directories like `.cache` get created in the current working directory instead of HOME (which doesn't exist in this case) which seems acceptable.\r\n\r\nAddresses https://github.com/PowerShell/PowerShell/issues/1794",
  "closed_at": "2017-04-09T16:23:06Z",
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Can we use something like `%temp%` instead of the null?\r\nhttp://stackoverflow.com/questions/31068/how-do-i-find-the-temp-directory-in-linux\r\nhttp://unix.stackexchange.com/questions/174817/finding-the-correct-tmp-dir-on-multiple-platforms",
      "created_at": "2017-03-28T04:52:04Z",
      "updated_at": "2017-03-28T04:57:58Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "We can use [Path.GetTempPath](https://msdn.microsoft.com/en-us/library/system.io.path.gettemppath(v=vs.110).aspx) ",
      "created_at": "2017-03-28T05:04:06Z",
      "updated_at": "2017-03-28T05:04:06Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "I'll update it to use `GetTempPath()`",
      "created_at": "2017-03-28T16:22:13Z",
      "updated_at": "2017-03-28T16:22:13Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@iSazonov @lzybkr any other feedback?",
      "created_at": "2017-03-31T18:15:43Z",
      "updated_at": "2017-03-31T18:15:43Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "LGTM.",
      "created_at": "2017-03-31T18:18:14Z",
      "updated_at": "2017-03-31T18:18:14Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@iSazonov can you mark your review as `Approved`?  thanks",
      "created_at": "2017-04-01T03:21:44Z",
      "updated_at": "2017-04-01T03:21:44Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Approved.",
      "created_at": "2017-04-01T07:56:20Z",
      "updated_at": "2017-04-01T07:56:20Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@lzybkr clean up added",
      "created_at": "2017-04-02T01:51:18Z",
      "updated_at": "2017-04-02T01:51:18Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "I'd not worried much about cleaning up temporary files and directories because the implication is that it's \"trash\", which can be removed by the user or by the system at any time. For example, Windows has Disk CleanUp Utility (I run it regularly on users computer by SCCM, GPO and scheduled tasks) and a group policy to create a temporary directory on the user session (%temp% is created on logon and removed on logoff).\r\nAdded clean-up is \ud83d\udc4d ",
      "created_at": "2017-04-02T07:46:38Z",
      "updated_at": "2017-04-02T07:50:43Z"
    },
    {
      "author": "lzybkr",
      "author_association": "MEMBER",
      "body": "Cleanup is important because shell processes are sometimes created frequently, and degrading system performance due to too many directories in TMP is not something we want to do. Not everybody cleans up TMP, or maybe not often enough at any rate.",
      "created_at": "2017-04-03T18:09:09Z",
      "updated_at": "2017-04-03T18:09:09Z"
    },
    {
      "author": "lzybkr",
      "author_association": "MEMBER",
      "body": "@SteveL-MSFT - I've approved the code, but would you mind squashing and improving the commit message?",
      "created_at": "2017-04-03T18:12:01Z",
      "updated_at": "2017-04-03T18:12:01Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@lzybkr I'll take care of it next week, at Whistler this week without my laptop",
      "created_at": "2017-04-03T18:59:17Z",
      "updated_at": "2017-04-03T18:59:17Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@lzybkr better?",
      "created_at": "2017-04-09T03:35:46Z",
      "updated_at": "2017-04-09T03:35:46Z"
    }
  ],
  "created_at": "2017-03-27T22:47:37Z",
  "number": 3437,
  "state": "closed",
  "title": "PowerShell doesn't start if env var HOME is not defined",
  "updated_at": "2017-06-19T21:16:01Z"
}
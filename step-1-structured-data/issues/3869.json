{
  "_url": "https://github.com/PowerShell/PowerShell/issues/3869",
  "author": "jeffbi",
  "body": "Contributes to the completion of #2123 and #2240.\r\n\r\nNow that the requisite components are implemented in corefx, compilation of the Send-MailMessage cmdlet has been enabled.\r\n\r\nThis PR includes a test script that allows the cmdlet to be tested against a working local SMTP server, but only on Linux and under specific conditions. A separate issue will be opened for improving test coverage and including additional platforms.",
  "closed_at": "2017-06-20T01:19:26Z",
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@jeffbi You need add new record in test/powershell/engine/DefaultCommands.Tests.ps1",
      "created_at": "2017-05-26T06:47:22Z",
      "updated_at": "2017-05-26T06:47:22Z"
    },
    {
      "author": "jeffbi",
      "author_association": "CONTRIBUTOR",
      "body": "@iSazonov Thanks, I wasn't aware of this.\r\n\r\nI see that there already is a record for Send-MailMessage. Do I just need to add `-or $CoreWindows -or $CoreUnix` into it?",
      "created_at": "2017-05-26T07:03:19Z",
      "updated_at": "2017-05-26T07:03:19Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Yes, you need edit and add -or $CoreWindows -or $CoreUnix ",
      "created_at": "2017-05-26T07:09:55Z",
      "updated_at": "2017-05-26T07:09:55Z"
    },
    {
      "author": "jeffbi",
      "author_association": "CONTRIBUTOR",
      "body": "Done.",
      "created_at": "2017-05-26T07:16:16Z",
      "updated_at": "2017-05-26T07:16:16Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@jeffbi The tests is skipped on both CI - I believe we should remove its at all.\r\n\r\nMaybe we can merge without tests if the cmdlet passes manual tests locally.\r\n\r\nRelated https://github.com/tedious/DovecotTesting/blob/master/resources/Scripts/Provision.sh#L28\r\nhttp://michaelthessel.com/mock-mail-setup-for-travis-ci/\r\n",
      "created_at": "2017-05-26T09:52:52Z",
      "updated_at": "2017-05-26T09:54:23Z"
    },
    {
      "author": "jeffbi",
      "author_association": "CONTRIBUTOR",
      "body": "@iSazonov I would guess that the test is being marked as Pending due to the machine name not matching the one specified in the test script. The test does require some pretty specific configuration.\r\n\r\nI have been able to manually send mail to myself on Linux with the cmdlet. I don't have an SMTP server for my Windows box to test with.\r\n\r\n@JamesWTruher, @SteveL-MSFT, do you have thoughts on this?",
      "created_at": "2017-05-26T16:12:26Z",
      "updated_at": "2017-05-26T16:12:26Z"
    },
    {
      "author": "jeffbi",
      "author_association": "CONTRIBUTOR",
      "body": "@iSazonov So you know, when the CI checks failed, the error was pointing to `test/powershell/engine/Remoting/SSHRemotingAPI.Tests.ps1` as the culprit, not my tests. It looks to me like that test script is trying to import a module that does not exist. Updating the entry in `DefaultCommands.Tests.ps1` appears to have fixed the problem, but I don't quite see how.",
      "created_at": "2017-05-26T16:45:20Z",
      "updated_at": "2017-05-26T16:45:20Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "I did not saw problem with  test/powershell/engine/Remoting/SSHRemotingAPI.Tests.ps1  - I saw only  failed DefaultCommands.Tests.ps1 that is expected.\r\n\r\nI believe it is very expensive install a mail server on CI VMs.",
      "created_at": "2017-05-26T18:00:27Z",
      "updated_at": "2017-05-26T18:00:27Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Can we use  [.Net Fake SMTP Server ](https://github.com/cmendible/netDumbster)?",
      "created_at": "2017-06-02T03:26:11Z",
      "updated_at": "2017-06-02T03:26:11Z"
    },
    {
      "author": "mirichmo",
      "author_association": "MEMBER",
      "body": "@SteveL-MSFT @JamesWTruher Have all of you concerns been addressed? Do you have any additional comments?",
      "created_at": "2017-06-06T15:49:36Z",
      "updated_at": "2017-06-06T15:49:36Z"
    },
    {
      "author": "mirichmo",
      "author_association": "MEMBER",
      "body": "@JamesWTruher Do you have any additional comments?",
      "created_at": "2017-06-10T01:17:23Z",
      "updated_at": "2017-06-10T01:17:23Z"
    },
    {
      "author": "JamesWTruher",
      "author_association": "MEMBER",
      "body": "LGTM",
      "created_at": "2017-06-13T18:47:00Z",
      "updated_at": "2017-06-13T18:47:00Z"
    }
  ],
  "created_at": "2017-05-26T06:12:24Z",
  "number": 3869,
  "state": "closed",
  "title": "Enable Send-MailMessage on CoreCLR",
  "updated_at": "2017-06-22T01:30:09Z"
}
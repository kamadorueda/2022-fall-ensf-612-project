{
  "_url": "https://github.com/PowerShell/PowerShell/issues/5106",
  "author": "daxian-dbw",
  "body": "Fix #3348\r\n\r\nPowerShell uses `InvariantCulture` for explicit type conversion. The implicit argument conversion for the script function/cmdlet also uses `InvariantCulture`. However, the implicit parameter argument type conversion for the C# cmdlet uses `CurrentCulture`. Change it to use 'InvariantCulture' too.",
  "closed_at": "2017-10-19T04:54:48Z",
  "comments": [
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "There are some test failures, I will investigate whether they are test or code issues.",
      "created_at": "2017-10-13T16:37:22Z",
      "updated_at": "2017-10-13T16:37:22Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "I see all test failures is culture-specific - the PR is really breaking change! :-)",
      "created_at": "2017-10-13T18:20:05Z",
      "updated_at": "2017-10-13T18:20:05Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "The early failures were because I didn't set the culture back after setting it to 'ru-RU'. It's now fixed.",
      "created_at": "2017-10-15T02:06:29Z",
      "updated_at": "2017-10-15T02:06:29Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "If we have so many culture-sensitive test should we fix them too?",
      "created_at": "2017-10-15T07:27:56Z",
      "updated_at": "2017-10-15T07:27:56Z"
    },
    {
      "author": "PetSerAl",
      "author_association": "CONTRIBUTOR",
      "body": "@iSazonov\r\n>If we have so many culture-sensitive test should we fix them too?\r\n\r\nIMO, tests which valid only in certain culture, like this one:\r\n```none\r\n [-] using -format produces the correct output 41ms\r\n   String lengths are both 9. Strings differ at index 0.\r\n   Expected: {Jan-01-20}\r\n   But was:  {\u044f\u043d\u0432-01-20}\r\n   -----------^\r\n   at line: 21 in D:\\PowerShell\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Get-Date.Tests.ps1\r\n   21:         Get-date -Date:\"Jan 1, 2020\"  -Format:\"MMM-dd-yy\" | Should be \"Jan-01-20\"\r\n```\r\nshould explicitly set that culture for themselves.",
      "created_at": "2017-10-15T16:06:57Z",
      "updated_at": "2017-10-15T16:06:57Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "Some tests call `ToString()`, which makes them culture dependent. Maybe it's not really necessary to call the `ToString` method in the first place.\r\n\r\n#5128 is opened for the culture-sensitive tests.",
      "created_at": "2017-10-15T18:39:48Z",
      "updated_at": "2017-10-15T20:26:38Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@PowerShell/powershell-committee reviewed this and due to the potential for breaking many existing modules, it's too risky to make this change so that c# and script cmdlets are alike for this case.  We should keep the current behavior.",
      "created_at": "2017-10-19T01:06:34Z",
      "updated_at": "2017-10-19T01:06:34Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "Given the review decision of powershell committee, I'm closing this PR.",
      "created_at": "2017-10-19T04:54:48Z",
      "updated_at": "2017-10-19T04:54:48Z"
    }
  ],
  "created_at": "2017-10-13T06:05:48Z",
  "number": 5106,
  "state": "closed",
  "title": "Use InvariantCulture for implicit argument conversion",
  "updated_at": "2018-10-15T21:50:52Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/12988",
  "author": "yecril71pl",
  "body": "<!--\r\n\r\nFor Windows PowerShell 5.1 issues, suggestions, or feature requests please use the following link instead:\r\nWindows PowerShell [UserVoice](https://windowsserver.uservoice.com/forums/301869-powershell)\r\n\r\nThis repository is **ONLY** for PowerShell Core 6 and PowerShell 7+ issues.\r\n\r\n- Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\r\n- Search the existing issues.\r\n- Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\r\n- Refer to the [known issues](https://docs.microsoft.com/powershell/scripting/whats-new/known-issues-ps6).\r\n\r\n-->\r\n\r\n## Steps to reproduce\r\n\r\n```powershell\r\nFUNCTION TEST-PARAM { [CMDLETBINDING()] PARAM([SWITCH] $B)\r\n DYNAMICPARAM {\r\nNEW-OBJECT Management.Automation.RuntimeDefinedParameterDictionary |\r\n % { $_.ADD('A', (\r\nNEW-OBJECT Management.Automation.RuntimeDefinedParameter (\r\n'A', [SWITCH], ((\r\nNEW-OBJECT  Management.Automation.PARAMETERATTRIBUTE\r\n))\r\n)\r\n)\r\n)\r\n$_\r\n }\r\n } PROCESS { '[{0}={1} {2}={3}]' -F $A, $PSBOUNDPARAMETERS.A, $B, $PSBOUNDPARAMETERS.B \r\n }\r\n }\r\n\r\nTEST-PARAM -A:5 -B:5\r\n\r\n```\r\n\r\n## Expected behavior\r\n\r\nCannot process argument transformation on parameter '``A``'. Cannot convert the \"``5``\" value of type \"``System.Int32``\" to type \"``System.Management.Automation.SwitchParameter``\"\r\n\r\n\r\n## Actual behavior\r\n\r\nCannot process argument transformation on parameter '``B``'. Cannot convert the \"``5``\" value of type \"``System.Int32``\" to type \"``System.Management.Automation.SwitchParameter``\"\r\n\r\n## Environment data\r\n\r\n<!-- provide the output of $PSVersionTable -->\r\n\r\n<DL ><DT >PSVersion                      <DD >7.0.2\r\n<DT >PSEdition                      <DD >Core\r\n<DT >GitCommitId                    <DD >7.0.2\r\n<DT >OS                             <DD >Microsoft Windows 10.0.18363\r\n<DT >Platform                       <DD >Win32NT\r\n<DT >PSCompatibleVersions           <DD >{1.0, 2.0, 3.0, 4.0\u2026}\r\n<DT >PSRemotingProtocolVersion      <DD >2.3\r\n<DT >SerializationVersion           <DD >1.1.0.1\r\n<DT >WSManStackVersion              <DD >3.0PSVersion                      7.0.2\r\n<DT >PSEdition                      <DD >Core\r\n<DT >GitCommitId                    <DD >7.0.2\r\n<DT >OS                             <DD >Microsoft Windows 10.0.18363\r\n<DT >Platform                       <DD >Win32NT\r\n<DT >PSCompatibleVersions           <DD >{1.0, 2.0, 3.0, 4.0\u2026}\r\n<DT >PSRemotingProtocolVersion      <DD >2.3\r\n<DT >SerializationVersion           <DD >1.1.0.1\r\n<DT >WSManStackVersion              <DD >3.0</DL >\r\n",
  "closed_at": null,
  "comments": [],
  "created_at": "2020-06-18T00:48:57Z",
  "labels": [
    "Issue-Question",
    "WG-Engine"
  ],
  "number": 12988,
  "state": "open",
  "title": "dynamic switch parameter valuations are too permissive",
  "updated_at": "2020-06-18T08:01:21Z"
}
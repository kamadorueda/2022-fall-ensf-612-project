{
  "_url": "https://github.com/PowerShell/PowerShell/issues/4463",
  "author": "adityapatwardhan",
  "body": "Since .Net Core 2.0, the api sets were moved to a nuget package. Adding a package reference for \"Microsoft.NETCore.Windows.ApiSets\" gets the required binaries for the Win7 package.\r\n\r\nOpening this PR for release branch. Original PR #4438 \r\n\r\nUpdated by iSazonov:\r\nFix #3747.",
  "closed_at": "2017-08-02T21:19:20Z",
  "comments": [
    {
      "author": "Zetanova",
      "author_association": "NONE",
      "body": "I am still getting the startup error in win7\r\nchecked the redist files and the Microsoft.NETCore.Windows.ApiSets packet\r\nboth are there. \r\n\r\nSystem.TypeInitializationException: The type initializer for 'System.Management.\r\nAutomation.Runspaces.RunspaceFactory' threw an exception. ---> System.DllNotFoun\r\ndException: Unable to load DLL 'api-ms-win-eventing-provider-l1-1-0.dll': The sp\r\necified module could not be found. (Exception from HRESULT: 0x8007007E)\r\n   at System.Management.Automation.Tracing.EtwActivity.UnsafeNativeMethods.Event\r\nActivityIdControl(ActivityControlCode controlCode, Guid& activityId)\r\n   at System.Management.Automation.Tracing.EtwActivity.GetActivityId()\r\n   at System.Management.Automation.Runspaces.RunspaceFactory..cctor()\r\n   --- End of inner exception stack trace ---\r\n   at System.Management.Automation.Runspaces.RunspaceFactory.CreateRunspace(PSHo\r\nst host, InitialSessionState initialSessionState)",
      "created_at": "2018-04-11T09:24:31Z",
      "updated_at": "2018-04-11T09:24:31Z"
    },
    {
      "author": "Zetanova",
      "author_association": "NONE",
      "body": "dotnet is trying to resolve the vcredist dll everywhere beside the nuget package location \r\nC:\\Program Files (x86)\\Microsoft SDKs\\NuGetPackages\\Microsoft.NETCore.Windows.ApiSets-x64\\1.0.0\\runtimes\\win7-x64\\native\r\n\r\nAfter i added the package runtime.win7-x64.Microsoft.NETCore.Windows.ApiSets explicitly to\r\nthe main project, the issue was resolved.",
      "created_at": "2018-04-11T13:19:38Z",
      "updated_at": "2018-04-11T13:19:38Z"
    }
  ],
  "created_at": "2017-08-02T20:28:00Z",
  "number": 4463,
  "state": "closed",
  "title": "Win7 loading issue",
  "updated_at": "2018-04-11T13:19:38Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/8999",
  "author": "GeeLaw",
  "body": "# Summary\r\n\r\nAs a Windows user who recently started using macOS, I configured the default Terminal profile to `exec pwsh`. However, opening a Terminal window to a folder is a pain on macOS:\r\n\r\n1. The default \"New Terminal at Folder\" and \"New Terminal Tab at Folder\" do not support PowerShell syntax.\r\n2. Those options appear in a submenu, reducing its efficiency.\r\n3. Those options doesn't appear when I open the context menu on the blank space of the current folder in Finder.\r\n\r\nAs a happy Windows user, I want to be able to open PowerShell like I could on Windows: I can open PowerShell from Ribbon, context menu of folder items, and context menu of folder background.\r\n\r\n# Workaround\r\n\r\nI currently use an Automator Workflow, which runs AppleScript with current folders in Finder:\r\n\r\n```applescript\r\non replace_chars(this_text, search_string, replacement_string)\r\n\tset AppleScript's text item delimiters to the search_string\r\n\tset the item_list to every text item of this_text\r\n\tset AppleScript's text item delimiters to the replacement_string\r\n\tset this_text to the item_list as string\r\n\tset AppleScript's text item delimiters to \"\"\r\n\treturn this_text\r\nend replace_chars\r\n\r\non run {input, parameters}\r\n\trepeat with folder in input\r\n\t\tset path0 to POSIX path of folder\r\n\t\tset path1 to replace_chars(path0, \"\\\\\", \"\\\\\\\\\")\r\n\t\tset path2 to replace_chars(path1, \"\\\"\", \"\\\\\\\"\")\r\n\t\tset path3 to replace_chars(path2, \"$\", \"\\\\$\")\r\n\t\tset path4 to replace_chars(path3, \"`\", \"\\\\`\")\r\n\t\tset command_todo to \"cd \\\"\" & path4 & \"\\\"; exec pwsh\"\r\n\t\ttell application \"Terminal\"\r\n\t\t\tdo script command_todo\r\n\t\t\tactivate\r\n\t\tend tell\r\n\tend repeat\r\nend run\r\n\r\n```\r\n\r\n# Explanation of item context menu and background context menu\r\n\r\nWhen the context menu for items is open, we get\r\n\r\n<img width=\"605\" alt=\"item-context\" src=\"https://user-images.githubusercontent.com/4462444/53482280-b707de00-3a33-11e9-8acf-182da8dd6f9c.png\">\r\n\r\nBy the way, the script I wrote handles escaping correctly for those folders. When the context menu of the blank is open, we get (switched to a OneDrive folder for expository purposes)\r\n\r\n<img width=\"320\" alt=\"folder-context\" src=\"https://user-images.githubusercontent.com/4462444/53482338-d9016080-3a33-11e9-97d2-6225b98838b0.png\">\r\n\r\nAs you can see, OneDrive is able to add options to the context menu on the blank space. **Please also introduce this functionality to PowerShell.**\r\n\r\n# Ribbon equivalent on macOS\r\n\r\nPlease add a button to Finder toolbar.",
  "closed_at": null,
  "comments": [],
  "created_at": "2019-02-27T10:10:14Z",
  "labels": [
    "Issue-Enhancement",
    "Area-Maintainers-Build"
  ],
  "number": 8999,
  "state": "open",
  "title": "[Feature Request] \"Open in PowerShell\" for macOS",
  "updated_at": "2019-02-27T12:51:19Z"
}
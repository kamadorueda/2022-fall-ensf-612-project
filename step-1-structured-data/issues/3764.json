{
  "_url": "https://github.com/PowerShell/PowerShell/issues/3764",
  "author": "mklement0",
  "body": "Note: Applies to all platforms.\r\n\r\nWhen using `Get-Command` with a _wildcard expression_ that resolves to _certain_ cmdlets, the output object's `.Parameters` property is initially `$null`.\r\n\r\nAfter referencing that cmdlet by literal name rather than wildcard, even the wildcard reference starts working.\r\n\r\nSee the bottom of this post for the list of affected cmdlets.\r\n\r\nSteps to reproduce\r\n------------------\r\n\r\nAs stated, it matters what cmdlet is targeted; the symptom does _not_ surface with `set-item*`, for instance.\r\n\r\n```powershell\r\n$null -eq (Get-Command -type cmdlet set-executionpolicy*).Parameters\r\n$null -eq (Get-Command -type cmdlet set-executionpolicy).Parameters\r\n$null -eq (Get-Command -type cmdlet set-executionpolicy*).Parameters\r\n```\r\n\r\nExpected behavior\r\n-----------------\r\n\r\n```\r\nFalse\r\nFalse\r\nFalse\r\n```\r\n\r\nActual behavior\r\n---------------\r\n\r\n```powershell\r\nTrue     # !! .Parameter is initially $null\r\nFalse    # A non-wildcard reference makes it non-$null\r\nFalse    # From then on, the wildcard reference works too.\r\n```\r\n\r\n\r\nEnvironment data\r\n----------------\r\n\r\n```powershell\r\nPowerShell Core v6.0.0-beta (v6.0.0-beta.1) on macOS 10.12.4\r\nPowerShell Core v6.0.0-beta (v6.0.0-beta.1) on Ubuntu 16.04.1 LTS\r\nPowerShell Core v6.0.0-beta (v6.0.0-beta.1) on Microsoft Windows 10 Pro (64-bit; v10.0.14393)\r\n```\r\n\r\n---\r\n\r\n**List of affected cmdlets**, obtained on PowerShell Core v6.0.0-beta (v6.0.0-beta.1) on macOS 10.12.4 with the following command:\r\n`gcm -type cmdlet,function | ? { $null -eq (Get-Command -type cmdlet,function \"$_*\").Parameters }`\r\n\r\n```none\r\nCommandType     Name                                               Version    Source                                                                                               \r\n-----------     ----                                               -------    ------                                                                                               \r\nCmdlet          Add-Content                                        3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          Clear-Content                                      3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          Clear-ItemProperty                                 3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          Convert-Path                                       3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          ConvertFrom-SecureString                           3.0.0.0    Microsoft.PowerShell.Security                                                                        \r\nCmdlet          ConvertTo-SecureString                             3.0.0.0    Microsoft.PowerShell.Security                                                                        \r\nCmdlet          Copy-ItemProperty                                  3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          Debug-Process                                      3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          Find-PackageProvider                               1.1.2.0    PackageManagement                                                                                    \r\nCmdlet          Get-ChildItem                                      3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          Get-Content                                        3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          Get-Credential                                     3.0.0.0    Microsoft.PowerShell.Security                                                                        \r\nCmdlet          Get-ExecutionPolicy                                3.0.0.0    Microsoft.PowerShell.Security                                                                        \r\nCmdlet          Get-ItemPropertyValue                              3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          Get-Location                                       3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          Get-PackageProvider                                1.1.2.0    PackageManagement                                                                                    \r\nCmdlet          Get-PackageSource                                  1.1.2.0    PackageManagement                                                                                    \r\nCmdlet          Get-PfxCertificate                                 3.0.0.0    Microsoft.PowerShell.Security                                                                        \r\nCmdlet          Get-Process                                        3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          Get-PSDrive                                        3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          Get-PSProvider                                     3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          Import-PackageProvider                             1.1.2.0    PackageManagement                                                                                    \r\nCmdlet          Install-PackageProvider                            1.1.2.0    PackageManagement                                                                                    \r\nCmdlet          Invoke-Item                                        3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          Join-Path                                          3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          Move-ItemProperty                                  3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          New-ItemProperty                                   3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          New-PSDrive                                        3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          Pop-Location                                       3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          Push-Location                                      3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          Register-PackageSource                             1.1.2.0    PackageManagement                                                                                    \r\nCmdlet          Remove-ItemProperty                                3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          Remove-PSDrive                                     3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          Rename-ItemProperty                                3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          Resolve-Path                                       3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          Save-Package                                       1.1.2.0    PackageManagement                                                                                    \r\nCmdlet          Set-Content                                        3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          Set-ExecutionPolicy                                3.0.0.0    Microsoft.PowerShell.Security                                                                        \r\nCmdlet          Set-ItemProperty                                   3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          Set-Location                                       3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          Set-PackageSource                                  1.1.2.0    PackageManagement                                                                                    \r\nCmdlet          Split-Path                                         3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          Start-Process                                      3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          Start-Transcript                                   3.0.0.0    Microsoft.PowerShell.Host                                                                            \r\nCmdlet          Stop-Process                                       3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          Stop-Transcript                                    3.0.0.0    Microsoft.PowerShell.Host                                                                            \r\nCmdlet          Test-Path                                          3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\nCmdlet          Uninstall-Package                                  1.1.2.0    PackageManagement                                                                                    \r\nCmdlet          Unregister-PackageSource                           1.1.2.0    PackageManagement                                                                                    \r\nCmdlet          Wait-Process                                       3.1.0.0    Microsoft.PowerShell.Management                                                                      \r\n```\r\n",
  "closed_at": null,
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "What means \"to certain cmdlets\"?",
      "created_at": "2017-05-12T18:56:17Z",
      "updated_at": "2017-05-12T18:56:17Z"
    },
    {
      "author": "mklement0",
      "author_association": "CONTRIBUTOR",
      "body": "To quote from the original post: \r\n \r\n> the symptom does not surface with set-item*, for instance.\r\n\r\nI haven't investigated further yet.  \r\nIf needed, we can look into creating an explicit list of cmdlets that are affected.",
      "created_at": "2017-05-12T19:19:58Z",
      "updated_at": "2017-05-12T19:20:19Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Yes, this can help identify the cause of the Issue.",
      "created_at": "2017-05-12T19:23:30Z",
      "updated_at": "2017-05-12T19:23:30Z"
    },
    {
      "author": "mklement0",
      "author_association": "CONTRIBUTOR",
      "body": "@iSazonov: I've adde a list to the original post, along with the command that created it.",
      "created_at": "2017-05-12T20:26:55Z",
      "updated_at": "2017-05-12T20:26:55Z"
    }
  ],
  "created_at": "2017-05-11T12:53:58Z",
  "number": 3764,
  "state": "open",
  "title": "State-dependent inability to access the .Parameters property of command definitions returned by some wildcard-based Get-Command calls",
  "updated_at": "2017-05-12T20:26:56Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/17653",
  "author": "MartinGC94",
  "body": "### Prerequisites\n\n- [X] Write a descriptive title.\n- [X] Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\n- [X] Search the existing issues.\n- [X] Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\n- [X] Refer to [Differences between Windows PowerShell 5.1 and PowerShell](https://docs.microsoft.com/powershell/scripting/whats-new/differences-from-windows-powershell).\n\n### Steps to reproduce\n\nConsider this example:\r\n```\r\nfunction Verb-Noun\r\n{\r\n    Param\r\n    (\r\n        [Parameter(Position = 0)]\r\n        [string]\r\n        $Param1,\r\n        [Parameter(Position = 1)]\r\n        [System.Management.Automation.ActionPreference]\r\n        $Param2\r\n    )\r\n}\r\nVerb-Noun -Param1 Hello <Tab>\r\n```\r\nI would expect the tab completion to suggest values for Param2 because it's the first positional parameter that hasn't been bound to a named parameter and this is how the real parameter binder works. Unfortunately it doesn't work, it simply falls back to the file/directory suggestions.  \r\nThe same issue occurs if you (presumably by mistake) try to start the positional parameters at 1 instead of 0:\r\n```\r\nfunction Verb-Noun\r\n{\r\n    Param\r\n    (\r\n        [Parameter(Position = 1)]\r\n        [System.Management.Automation.ActionPreference]\r\n        $Param1\r\n    )\r\n}\r\nVerb-Noun <Tab>\r\n```\r\n\r\nAs far as I can tell the issue is here: https://github.com/PowerShell/PowerShell/blob/master/src/System.Management.Automation/engine/CommandCompletion/CompletionCompleters.cs#L1596 where it looks if the position for the parameter matches exactly the position the cursor is at.\n\n### Expected behavior\n\n```console\nTab completion should find the right parameter to offer completions for.\n```\n\n\n### Actual behavior\n\n```console\nIt falls back to the generic file/directory completion\n```\n\n\n### Error details\n\n_No response_\n\n### Environment data\n\n```powershell\nPS C:\\> $PSVersionTable\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.3.0-preview.5\r\nPSEdition                      Core\r\nGitCommitId                    7.3.0-preview.5\r\nOS                             Microsoft Windows 10.0.19044\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\n```\n\n\n### Visuals\n\n_No response_",
  "closed_at": "2022-08-22T22:17:57Z",
  "comments": [],
  "created_at": "2022-07-09T12:54:33Z",
  "labels": [
    "Resolution-Fixed",
    "WG-Engine-ParameterBinder"
  ],
  "number": 17653,
  "state": "closed",
  "title": "Pseudo binding for tab completion doesn't work property for positional arguments",
  "updated_at": "2022-08-22T22:18:06Z"
}
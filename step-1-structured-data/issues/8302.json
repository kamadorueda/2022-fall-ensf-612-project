{
  "_url": "https://github.com/PowerShell/PowerShell/issues/8302",
  "author": "IISResetMe",
  "body": "While testing an experimental feature to [add support for interface declarations](https://github.com/PowerShell/PowerShell/issues/2223#issuecomment-439602845), I found that types generated using the `class` keyword can't correctly override get/set methods associated with properties.\r\n\r\n# Steps to reproduce\r\n\r\n```powershell\r\nAdd-Type @'\r\nnamespace TypeTest {\r\n  public interface Interface {\r\n    string S { get; set; }\r\n  }\r\n}\r\n'@\r\n\r\n# Execute this as a separate statement to ensure TypeTest.Interface is defined before the class definition is\r\nclass TestClass : TypeTest.Interface {\r\n  [string]$S\r\n}\r\n\r\n```\r\n\r\n# Expected behavior\r\n\r\nNew type `[TestClass]` implementing `[TypeTest.Interface]` should have been compiled and loaded.\r\n\r\n# Actual behavior\r\n\r\n```none\r\nAt line:1 char:1\r\n+ class TestClass : TypeTest.Interface {\r\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\nError during creation of type \"TestClass\". Error message:\r\nMethod 'get_S' in type 'TestClass' from assembly 'Powershell Class Assembly, Version=1.0.0.1, Culture=neutral, PublicKeyToken=null' does not have an implementation.\r\n    + CategoryInfo          : ParserError: (:) [], ParentContainsErrorRecordException\r\n    + FullyQualifiedErrorId : TypeCreationError\r\n```\r\n\r\n# Solution\r\n\r\nAfter comparing the CIL emitted by the C# compiler when implicitly implementing an interface property, I found that the get/set methods generated by the compiler are marked `virtual`.\r\n\r\nThe fix is to either attempt to discover properties with matching signatures in associated instances and mark the backing get/set methods `virtual`, or simply just mark *all* get/set methods `virtual` (might incur slight overhead in method resolution at runtime rather than at compile time)\r\n\r\n# Environment data\r\n\r\n<!-- provide the output of $PSVersionTable -->\r\n\r\n```none\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      6.2.0-preview.1\r\nPSEdition                      Core\r\nGitCommitId                    6.2.0-preview.1-79-g16569b157a430cc5d4a2e7bf189dcfef64beb31f\r\nOS                             Microsoft Windows 10.0.17134 \r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n",
  "closed_at": "2018-11-30T11:48:28Z",
  "comments": [],
  "created_at": "2018-11-17T15:53:23Z",
  "labels": [
    "Issue-Enhancement",
    "WG-Engine",
    "Resolution-Fixed"
  ],
  "number": 8302,
  "state": "closed",
  "title": "Generated get/set methods incorrectly marked non-virtual",
  "updated_at": "2019-04-02T06:33:51Z"
}
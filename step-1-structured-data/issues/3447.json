{
  "_url": "https://github.com/PowerShell/PowerShell/issues/3447",
  "author": "TheFlyingCorpse",
  "body": "<!--\r\n\r\nIf you are a PowerShell Team member, please make sure you choose the Reviewer(s) and Assignee for your PR.\r\nIf you are not from the PowerShell Team, you can leave the fields blank and the Maintainers will choose them for you. If you are familiar with the team, feel free to mention some Reviewers yourself.\r\n\r\nFor more information about the roles of Reviewer and Assignee, refer to CONTRIBUTING.md.\r\n\r\n-->\r\nThis commit adds a `-NoProxy` parameter to the WebCmdlet, used by both `Invoke-WebRequest` and `Invoke-RestMethod`. The fix is intended to allow for bypassing a DefaultWebProxy, such as a system configured one for direct requests.\r\n\r\nReferences #3418 \r\n\r\nI did not figure out where I can update the help files relevant to this, I'd appreciate being pointed in the right direction for this.",
  "closed_at": "2017-04-01T01:03:00Z",
  "comments": [
    {
      "author": "msftclas",
      "author_association": "NONE",
      "body": "\r\n@TheFlyingCorpse,\nThanks for having already signed the Contribution License Agreement. Your agreement was validated by Microsoft. We will now review your pull request.\n_Thanks,\nMicrosoft Pull Request Bot_",
      "created_at": "2017-03-28T19:23:33Z",
      "updated_at": "2017-03-28T19:23:33Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "Can you add a test?  Thanks!",
      "created_at": "2017-03-28T20:00:32Z",
      "updated_at": "2017-03-28T20:00:32Z"
    },
    {
      "author": "TheFlyingCorpse",
      "author_association": "CONTRIBUTOR",
      "body": "Tests added, if you want me to, I can add scenarios to verify it fails when proxy is defined to the made up proxy as a countermeasure to `-NoProxy`.\r\nI did not add a test for the following two scenarios, I am not certain if they are in or out of scope: \r\n- Internet Explorer proxy defined, it is however how I developed the `-NoProxy` addition.\r\n- Proxy defined via \"netsh winhttp\", in the testing I did by hand this did not have any effect on `Invoke-WebRequest` or `Invoke-RestMethod`",
      "created_at": "2017-03-28T20:40:15Z",
      "updated_at": "2017-03-28T20:43:09Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Probably enough:\r\n```powershell\r\nInvoke-WebRequest -Uri http://httpbin.org/headers -Proxy http://httpbin.org -NoProxy   - return expected result\r\nInvoke-WebRequest -Uri http://httpbin.org/headers -Proxy http://httpbin.org -NoProxy:$false - return empty content\r\n```",
      "created_at": "2017-03-29T12:29:15Z",
      "updated_at": "2017-03-29T12:29:15Z"
    },
    {
      "author": "TheFlyingCorpse",
      "author_association": "CONTRIBUTOR",
      "body": "Updated tests quite a bit.\r\n\r\nI did not split the parameters up to different parametersets as @iSazonov made a great case for why it ought not to be split up.",
      "created_at": "2017-03-29T15:48:12Z",
      "updated_at": "2017-03-29T15:51:33Z"
    },
    {
      "author": "TheFlyingCorpse",
      "author_association": "CONTRIBUTOR",
      "body": "Updated, incorporated ParameterSetName's and updated the tests to reflect this change.\r\n\r\nTo be able to make the `-NoProxy` not use `-Proxy`, I had to modify a bit more than expected since there already was defined two ParameterSets: `StandardMethod` and `CustomMethod`, there are now two extra that redirects to the existing one. Without the change to this, the `method` would never get since the new names introduced would break this. The `method` would break on both use of `-Proxy` and `-NoProxy` since the switch using ParameterSetName would not match either existing Method.",
      "created_at": "2017-03-29T21:14:00Z",
      "updated_at": "2017-03-29T21:21:28Z"
    },
    {
      "author": "TheFlyingCorpse",
      "author_association": "CONTRIBUTOR",
      "body": "Note: I didn't find a good way with the mock to have a dynamic proxy when using `$env` to assign it inside the function when using parameters, if the workaround which uses \"pure\" PowerShell is not accepted, let me know what the alternative is :-)\r\n\r\n",
      "created_at": "2017-03-31T19:03:32Z",
      "updated_at": "2017-03-31T19:03:32Z"
    }
  ],
  "created_at": "2017-03-28T19:23:29Z",
  "number": 3447,
  "state": "closed",
  "title": "Add option -NoProxy to WebCmdlet",
  "updated_at": "2017-04-01T01:03:00Z"
}
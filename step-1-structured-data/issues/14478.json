{
  "_url": "https://github.com/PowerShell/PowerShell/issues/14478",
  "author": "jborean93",
  "body": "There are 4 server mode options when calling `pwsh`\r\n\r\n|Argument|Description|Mediator|\r\n|-|-|-|\r\n| `namedpipeservermode`/`nam` | Creates a bidirectional named pipe to read/write PSRP data | [NamedPipeProcessMediator](https://github.com/PowerShell/PowerShell/blob/99a49e0eab9b137449b690ab4607d7932c6f9956/src/System.Management.Automation/engine/remoting/server/OutOfProcServerMediator.cs#L600-L619) |\r\n| `servermode`/`s` | Uses the process' stdin/stdout to read/write PSRP data | [OutOfProcessMediator](https://github.com/PowerShell/PowerShell/blob/99a49e0eab9b137449b690ab4607d7932c6f9956/src/System.Management.Automation/engine/remoting/server/OutOfProcServerMediator.cs#L459-L482) |\r\n| `socketservermode`/`so` | Uses a TCP socket to some Hyper-V endpoint | [HyperVSocketMediator](https://github.com/PowerShell/PowerShell/blob/99a49e0eab9b137449b690ab4607d7932c6f9956/src/System.Management.Automation/engine/remoting/server/OutOfProcServerMediator.cs#L707-L715) |\r\n| `sshservermode`/`sshs` | Uses the process' stdin/stdout to read/write PSRP data | [SSHProcessMediator](https://github.com/PowerShell/PowerShell/blob/99a49e0eab9b137449b690ab4607d7932c6f9956/src/System.Management.Automation/engine/remoting/server/OutOfProcServerMediator.cs#L526-L549) |\r\n\r\nIt seems like `servermode` and `sshservermode` are quite similar in behaviour. They both use the console's `stdout` to output and responses and the `stdin` to read and input from the client. They do have slightly different behaviour when getting the pipes:\r\n\r\n* stdin\r\n    * servermode: `new StreamReader(Console.OpenStandardInput(), true)`\r\n    * sshservermode (Windows): `new StreamReader(new FileStream(PlatformInvokes.GetStdHandle(Input), FileAccess.Read))`\r\n    * sshservermode (Unix): `new StreamReader(Console.OpenStandardInput(), true)`\r\n* stdout\r\n    * servermode: `new OutOfProcessTextWriter(Console.Out)`\r\n    * sshservermode (Windows): `new OutOfProcessTextWriter(new FileStream(PlatformInvokes.GetStdHandle(Output), FileAccess.Write))`\r\n    * sshservermode (Unix): `new OutOfProcessTextWriter(new StreamWriter(Console.OpenStandardOutput()))`\r\n* stderr\r\n    * servermode: `new OutOfProcessTextWriter(Console.Error)`\r\n    * sshservermode (Windows): `new OutOfProcessTextWriter(new FileStream(PlatformInvokes.GetStdHandle(Error), FileAccess.Write))`\r\n    * sshservermode (Unix): `new OutOfProcessTextWriter(new StreamWriter(Console.OpenStandardError()))`\r\n\r\nIs anyone able to explain the differences in behaviour between these 2 when it comes to getting the stdio pipes. If there are none (or very minor) why have a dedicated mode argument specifically for SSH. I can set the following in my `sshd_config` file and both `-s` and `-sshs` work just fine.\r\n\r\n```\r\nSubsystem powershell c:/progra~1/powershell/7/pwsh.exe -sshs -NoLogo -NoProfile\r\nSubsystem pwsh c:/progra~1/powershell/7/pwsh.exe -s -NoLogo -NoProfile\r\n```\r\n\r\nI did try setting a subsystem entry for Windows PowerShell as that does have the `-s` but it just hangs there forever.\r\n\r\n```\r\n# I don't know why I need -Version 5.1, without it it complains that .NET Framework 2.0 isn't available\r\nSubsystem win_pwsh C:/Windows/System32/WindowsPowerShell/v1.0/powershell.exe -Version 5.1 -s -NoLogo -NoProfile\r\n```",
  "closed_at": "2021-05-12T21:22:06Z",
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "SSH works another than Console and we had to put SSH in raw/transparent mode so that users can type and get responses exactly (there are still exceptions) as in console. I don't remember details but you could find some old discussions with @PaulHigin in the repo.",
      "created_at": "2020-12-22T06:02:39Z",
      "updated_at": "2020-12-22T06:03:08Z"
    },
    {
      "author": "jborean93",
      "author_association": "COLLABORATOR",
      "body": "Bump, @PaulHigin are you able to flesh out the above a bit more?",
      "created_at": "2021-04-14T01:11:34Z",
      "updated_at": "2021-04-14T01:11:34Z"
    },
    {
      "author": "PaulHigin",
      "author_association": "COLLABORATOR",
      "body": "`-SSHS` switch provides correct telemetry for the SSH transport.  It does not support endpoint configuration as other server modes do.  ServerMode may work but it is not intended for SSH connection.  For one thing ServerMode creates a child process to run through the remoting layer, whereas SSHServerMode does not.  The extra remoting layer is not needed and is hugely inefficient.",
      "created_at": "2021-04-14T16:05:19Z",
      "updated_at": "2021-04-14T16:05:19Z"
    },
    {
      "author": "jborean93",
      "author_association": "COLLABORATOR",
      "body": "Thanks for the reply and sharing that information.\r\n\r\n> For one thing ServerMode creates a child process to run through the remoting layer\r\n\r\nI don't actually see this happening when I test out `-s`. I've got a process that starts `pwsh.exe -NoLogo -s` through SSH and sends the PSRP packets manually. When the pipeling is running I see the following tree\r\n\r\n![image](https://user-images.githubusercontent.com/8462645/114801652-78823880-9ddf-11eb-8951-88ea0d6a2488.png)\r\n\r\nThe `pwsh.exe` is the one that runs `pwsh.exe -NoLogo -s`. I also compared the tree when running `-sshs` manually or creating it through the subsystem and it's exactly the same (except the argument used). Just for reference here is the PSRP exchanged with that scenario, it ran a pipeline of `echo \"hi\"; [void]$host.UI.ReadLine(); echo \"end\"`.\r\n\r\n```\r\nWrite\t<Data Stream='Default' PSGuid='00000000-0000-0000-0000-000000000000'>AAAAAAAAAAEAAAAAAAAAAAMAAADHAgAAAAIAAQAscW/exJ0wTa2KRlMUx02eAAAAAAAAAAAAAAAAAAAAADxPYmogUmVmSWQ9IjAiPjxNUz48VmVyc2lvbiBOPSJQU1ZlcnNpb24iPjIuMDwvVmVyc2lvbj48VmVyc2lvbiBOPSJwcm90b2NvbHZlcnNpb24iPjIuMzwvVmVyc2lvbj48VmVyc2lvbiBOPSJTZXJpYWxpemF0aW9uVmVyc2lvbiI+MS4xLjAuMTwvVmVyc2lvbj48L01TPjwvT2JqPgAAAAAAAAACAAAAAAAAAAADAAADggIAAAAEAAEALHFv3sSdME2tikZTFMdNngAAAAAAAAAAAAAAAAAAAAA8T2JqIFJlZklkPSIwIj48TVM+PEkzMiBOPSJNaW5SdW5zcGFjZXMiPjE8L0kzMj48STMyIE49Ik1heFJ1bnNwYWNlcyI+MTwvSTMyPjxPYmogUmVmSWQ9IjEiIE49IlBTVGhyZWFkT3B0aW9ucyI+PEkzMj4wPC9JMzI+PFROIFJlZklkPSIwIj48VD5TeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlJ1bnNwYWNlcy5QU1RocmVhZE9wdGlvbnM8L1Q+PFQ+U3lzdGVtLkVudW08L1Q+PFQ+U3lzdGVtLlZhbHVlVHlwZTwvVD48VD5TeXN0ZW0uT2JqZWN0PC9UPjwvVE4+PFRvU3RyaW5nPkRlZmF1bHQ8L1RvU3RyaW5nPjwvT2JqPjxPYmogUmVmSWQ9IjIiIE49IkFwYXJ0bWVudFN0YXRlIj48STMyPjI8L0kzMj48VE4gUmVmSWQ9IjEiPjxUPlN5c3RlbS5UaHJlYWRpbmcuQXBhcnRtZW50U3RhdGU8L1Q+PFQ+U3lzdGVtLkVudW08L1Q+PFQ+U3lzdGVtLlZhbHVlVHlwZTwvVD48VD5TeXN0ZW0uT2JqZWN0PC9UPjwvVE4+PFRvU3RyaW5nPlVua25vd248L1RvU3RyaW5nPjwvT2JqPjxPYmogUmVmSWQ9IjMiIE49Ikhvc3RJbmZvIj48TVM+PEIgTj0iX2lzSG9zdE51bGwiPmZhbHNlPC9CPjxCIE49Il9pc0hvc3RVSU51bGwiPmZhbHNlPC9CPjxCIE49Il9pc0hvc3RSYXdVSU51bGwiPnRydWU8L0I+PEIgTj0iX3VzZVJ1bnNwYWNlSG9zdCI+ZmFsc2U8L0I+PC9NUz48L09iaj48T2JqIFJlZklkPSI0IiBOPSJBcHBsaWNhdGlvbkFyZ3VtZW50cyI+PFROIFJlZklkPSIyIj48VD5TeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTUHJpbWl0aXZlRGljdGlvbmFyeTwvVD48VD5TeXN0ZW0uQ29sbGVjdGlvbnMuSGFzaHRhYmxlPC9UPjxUPlN5c3RlbS5PYmplY3Q8L1Q+PC9UTj48RENUIC8+PC9PYmo+PC9NUz48L09iaj4=</Data>\r\nRead\t<Data Stream='Default' PSGuid='00000000-0000-0000-0000-000000000000'>AAAAAAAAAAEAAAAAAAAAAAMAAADKAQAAAAIAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAO+7vzxPYmogUmVmSWQ9IjAiPjxNUz48VmVyc2lvbiBOPSJwcm90b2NvbHZlcnNpb24iPjIuMzwvVmVyc2lvbj48VmVyc2lvbiBOPSJQU1ZlcnNpb24iPjIuMDwvVmVyc2lvbj48VmVyc2lvbiBOPSJTZXJpYWxpemF0aW9uVmVyc2lvbiI+MS4xLjAuMTwvVmVyc2lvbj48L01TPjwvT2JqPg==</Data>\r\nRead\t<Data Stream='Default' PSGuid='00000000-0000-0000-0000-000000000000'>AAAAAAAAAAIAAAAAAAAAAAMAAAVvAQAAAAkQAgAscW/exJ0wTa2KRlMUx02eAAAAAAAAAAAAAAAAAAAAAO+7vzxPYmogUmVmSWQ9IjAiPjxNUz48T2JqIE49IkFwcGxpY2F0aW9uUHJpdmF0ZURhdGEiIFJlZklkPSIxIj48VE4gUmVmSWQ9IjAiPjxUPlN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNQcmltaXRpdmVEaWN0aW9uYXJ5PC9UPjxUPlN5c3RlbS5Db2xsZWN0aW9ucy5IYXNodGFibGU8L1Q+PFQ+U3lzdGVtLk9iamVjdDwvVD48L1ROPjxEQ1Q+PEVuPjxTIE49IktleSI+UFNWZXJzaW9uVGFibGU8L1M+PE9iaiBOPSJWYWx1ZSIgUmVmSWQ9IjIiPjxUTlJlZiBSZWZJZD0iMCIgLz48RENUPjxFbj48UyBOPSJLZXkiPldTTWFuU3RhY2tWZXJzaW9uPC9TPjxWZXJzaW9uIE49IlZhbHVlIj4zLjA8L1ZlcnNpb24+PC9Fbj48RW4+PFMgTj0iS2V5Ij5QU1ZlcnNpb248L1M+PFZlcnNpb24gTj0iVmFsdWUiPjcuMS4zPC9WZXJzaW9uPjwvRW4+PEVuPjxTIE49IktleSI+UGxhdGZvcm08L1M+PFMgTj0iVmFsdWUiPldpbjMyTlQ8L1M+PC9Fbj48RW4+PFMgTj0iS2V5Ij5HaXRDb21taXRJZDwvUz48UyBOPSJWYWx1ZSI+Ny4xLjM8L1M+PC9Fbj48RW4+PFMgTj0iS2V5Ij5QU1JlbW90aW5nUHJvdG9jb2xWZXJzaW9uPC9TPjxWZXJzaW9uIE49IlZhbHVlIj4yLjM8L1ZlcnNpb24+PC9Fbj48RW4+PFMgTj0iS2V5Ij5PUzwvUz48UyBOPSJWYWx1ZSI+TWljcm9zb2Z0IFdpbmRvd3MgMTAuMC4xNzc2MzwvUz48L0VuPjxFbj48UyBOPSJLZXkiPlBTRWRpdGlvbjwvUz48UyBOPSJWYWx1ZSI+Q29yZTwvUz48L0VuPjxFbj48UyBOPSJLZXkiPlBTU2VtYW50aWNWZXJzaW9uPC9TPjxTIE49IlZhbHVlIj43LjEuMzwvUz48L0VuPjxFbj48UyBOPSJLZXkiPlNlcmlhbGl6YXRpb25WZXJzaW9uPC9TPjxWZXJzaW9uIE49IlZhbHVlIj4xLjEuMC4xPC9WZXJzaW9uPjwvRW4+PEVuPjxTIE49IktleSI+UFNDb21wYXRpYmxlVmVyc2lvbnM8L1M+PE9iaiBOPSJWYWx1ZSIgUmVmSWQ9IjMiPjxUTiBSZWZJZD0iMSI+PFQ+U3lzdGVtLlZlcnNpb25bXTwvVD48VD5TeXN0ZW0uQXJyYXk8L1Q+PFQ+U3lzdGVtLk9iamVjdDwvVD48L1ROPjxMU1Q+PFZlcnNpb24+MS4wPC9WZXJzaW9uPjxWZXJzaW9uPjIuMDwvVmVyc2lvbj48VmVyc2lvbj4zLjA8L1ZlcnNpb24+PFZlcnNpb24+NC4wPC9WZXJzaW9uPjxWZXJzaW9uPjUuMDwvVmVyc2lvbj48VmVyc2lvbj41LjEuMTAwMzIuMDwvVmVyc2lvbj48VmVyc2lvbj42LjAuMDwvVmVyc2lvbj48VmVyc2lvbj42LjEuMDwvVmVyc2lvbj48VmVyc2lvbj42LjIuMDwvVmVyc2lvbj48VmVyc2lvbj43LjAuMDwvVmVyc2lvbj48VmVyc2lvbj43LjEuMzwvVmVyc2lvbj48L0xTVD48L09iaj48L0VuPjwvRENUPjwvT2JqPjwvRW4+PC9EQ1Q+PC9PYmo+PC9NUz48L09iaj4=</Data>\r\nRead\t<Data Stream='Default' PSGuid='00000000-0000-0000-0000-000000000000'>AAAAAAAAAAMAAAAAAAAAAAMAAABnAQAAAAUQAgAscW/exJ0wTa2KRlMUx02eAAAAAAAAAAAAAAAAAAAAAO+7vzxPYmogUmVmSWQ9IjAiPjxNUz48STMyIE49IlJ1bnNwYWNlU3RhdGUiPjI8L0kzMj48L01TPjwvT2JqPg==</Data>\r\nRead\t<DataAck PSGuid='00000000-0000-0000-0000-000000000000' />\r\nWrite\t<Command PSGuid='C4C8B14E-EFDB-40B4-948D-1BAAB3C647FA' />\r\nRead\t<CommandAck PSGuid='c4c8b14e-efdb-40b4-948d-1baab3c647fa' />\r\nWrite\t<Data Stream='Default' PSGuid='C4C8B14E-EFDB-40B4-948D-1BAAB3C647FA'>AAAAAAAAAAMAAAAAAAAAAAMAAAZnAgAAAAYQAgAscW/exJ0wTa2KRlMUx02eTrHIxNvvtECUjRuqs8ZH+jxPYmogUmVmSWQ9IjAiPjxNUz48QiBOPSJOb0lucHV0Ij50cnVlPC9CPjxPYmogUmVmSWQ9IjEiIE49IkFwYXJ0bWVudFN0YXRlIj48STMyPjI8L0kzMj48VE4gUmVmSWQ9IjAiPjxUPlN5c3RlbS5UaHJlYWRpbmcuQXBhcnRtZW50U3RhdGU8L1Q+PFQ+U3lzdGVtLkVudW08L1Q+PFQ+U3lzdGVtLlZhbHVlVHlwZTwvVD48VD5TeXN0ZW0uT2JqZWN0PC9UPjwvVE4+PFRvU3RyaW5nPlVua25vd248L1RvU3RyaW5nPjwvT2JqPjxPYmogUmVmSWQ9IjIiIE49IlJlbW90ZVN0cmVhbU9wdGlvbnMiPjxJMzI+MDwvSTMyPjxUTiBSZWZJZD0iMSI+PFQ+U3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5SZW1vdGVTdHJlYW1PcHRpb25zPC9UPjxUPlN5c3RlbS5FbnVtPC9UPjxUPlN5c3RlbS5WYWx1ZVR5cGU8L1Q+PFQ+U3lzdGVtLk9iamVjdDwvVD48L1ROPjxUb1N0cmluZz5Ob25lPC9Ub1N0cmluZz48L09iaj48QiBOPSJBZGRUb0hpc3RvcnkiPmZhbHNlPC9CPjxPYmogUmVmSWQ9IjMiIE49Ikhvc3RJbmZvIj48TVM+PEIgTj0iX2lzSG9zdE51bGwiPnRydWU8L0I+PEIgTj0iX2lzSG9zdFVJTnVsbCI+dHJ1ZTwvQj48QiBOPSJfaXNIb3N0UmF3VUlOdWxsIj50cnVlPC9CPjxCIE49Il91c2VSdW5zcGFjZUhvc3QiPnRydWU8L0I+PC9NUz48L09iaj48T2JqIFJlZklkPSI0IiBOPSJQb3dlclNoZWxsIj48TVM+PE9iaiBSZWZJZD0iNSIgTj0iQ21kcyI+PFROIFJlZklkPSIyIj48VD5TeXN0ZW0uQ29sbGVjdGlvbnMuQXJyYXlMaXN0PC9UPjxUPlN5c3RlbS5PYmplY3Q8L1Q+PC9UTj48TFNUPjxPYmogUmVmSWQ9IjYiPjxNUz48UyBOPSJDbWQiPmVjaG8gImhpIjsgW3ZvaWRdJGhvc3QuVUkuUmVhZExpbmUoKTsgZWNobyAiZW5kIjwvUz48T2JqIFJlZklkPSI3IiBOPSJBcmdzIj48VE5SZWYgUmVmSWQ9IjIiIC8+PExTVCAvPjwvT2JqPjxCIE49IklzU2NyaXB0Ij50cnVlPC9CPjxOaWwgTj0iVXNlTG9jYWxTY29wZSIgLz48T2JqIFJlZklkPSI4IiBOPSJNZXJnZU15UmVzdWx0Ij48STMyPjA8L0kzMj48VE4gUmVmSWQ9IjMiPjxUPlN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUnVuc3BhY2VzLlBpcGVsaW5lUmVzdWx0VHlwZXM8L1Q+PFQ+U3lzdGVtLkVudW08L1Q+PFQ+U3lzdGVtLlZhbHVlVHlwZTwvVD48VD5TeXN0ZW0uT2JqZWN0PC9UPjwvVE4+PFRvU3RyaW5nPk5vbmU8L1RvU3RyaW5nPjwvT2JqPjxSZWYgUmVmSWQ9IjgiIE49Ik1lcmdlVG9SZXN1bHQiIC8+PFJlZiBSZWZJZD0iOCIgTj0iTWVyZ2VQcmV2aW91c1Jlc3VsdHMiIC8+PFJlZiBSZWZJZD0iOCIgTj0iTWVyZ2VFcnJvciIgLz48UmVmIFJlZklkPSI4IiBOPSJNZXJnZVdhcm5pbmciIC8+PFJlZiBSZWZJZD0iOCIgTj0iTWVyZ2VWZXJib3NlIiAvPjxSZWYgUmVmSWQ9IjgiIE49Ik1lcmdlRGVidWciIC8+PFJlZiBSZWZJZD0iOCIgTj0iTWVyZ2VJbmZvcm1hdGlvbiIgLz48L01TPjwvT2JqPjwvTFNUPjwvT2JqPjxCIE49IklzTmVzdGVkIj5mYWxzZTwvQj48TmlsIE49Ikhpc3RvcnkiIC8+PEIgTj0iUmVkaXJlY3RTaGVsbEVycm9yT3V0cHV0UGlwZSI+dHJ1ZTwvQj48L01TPjwvT2JqPjxCIE49IklzTmVzdGVkIj5mYWxzZTwvQj48L01TPjwvT2JqPg==</Data>\r\nRead\t<DataAck PSGuid='c4c8b14e-efdb-40b4-948d-1baab3c647fa' />\r\nRead\t<Data Stream='Default' PSGuid='c4c8b14e-efdb-40b4-948d-1baab3c647fa'>AAAAAAAAAAQAAAAAAAAAAAMAAAA0AQAAAAQQBAAscW/exJ0wTa2KRlMUx02eTrHIxNvvtECUjRuqs8ZH+u+7vzxTPmhpPC9TPg==</Data>\r\nRead\t<Data Stream='Default' PSGuid='c4c8b14e-efdb-40b4-948d-1baab3c647fa'>AAAAAAAAAAUAAAAAAAAAAAMAAAGeAQAAAAARBAAscW/exJ0wTa2KRlMUx02eTrHIxNvvtECUjRuqs8ZH+u+7vzxPYmogUmVmSWQ9IjAiPjxNUz48STY0IE49ImNpIj4xPC9JNjQ+PE9iaiBOPSJtaSIgUmVmSWQ9IjEiPjxUTiBSZWZJZD0iMCI+PFQ+U3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5SZW1vdGluZy5SZW1vdGVIb3N0TWV0aG9kSWQ8L1Q+PFQ+U3lzdGVtLkVudW08L1Q+PFQ+U3lzdGVtLlZhbHVlVHlwZTwvVD48VD5TeXN0ZW0uT2JqZWN0PC9UPjwvVE4+PFRvU3RyaW5nPlJlYWRMaW5lPC9Ub1N0cmluZz48STMyPjExPC9JMzI+PC9PYmo+PE9iaiBOPSJtcCIgUmVmSWQ9IjIiPjxUTiBSZWZJZD0iMSI+PFQ+U3lzdGVtLkNvbGxlY3Rpb25zLkFycmF5TGlzdDwvVD48VD5TeXN0ZW0uT2JqZWN0PC9UPjwvVE4+PExTVCAvPjwvT2JqPjwvTVM+PC9PYmo+</Data>\r\npress to enter to continue pipeline\r\nWrite\t<Data Stream='PromptResponse' PSGuid='C4C8B14E-EFDB-40B4-948D-1BAAB3C647FA'>AAAAAAAAAAQAAAAAAAAAAAMAAAE6AgAAAAERBAAscW/exJ0wTa2KRlMUx02eTrHIxNvvtECUjRuqs8ZH+jxPYmogUmVmSWQ9IjAiPjxNUz48STY0IE49ImNpIj4xPC9JNjQ+PE9iaiBSZWZJZD0iMSIgTj0ibWkiPjxJMzI+MTE8L0kzMj48VE4gUmVmSWQ9IjAiPjxUPlN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUmVtb3RpbmcuUmVtb3RlSG9zdE1ldGhvZElkPC9UPjxUPlN5c3RlbS5FbnVtPC9UPjxUPlN5c3RlbS5WYWx1ZVR5cGU8L1Q+PFQ+U3lzdGVtLk9iamVjdDwvVD48L1ROPjxUb1N0cmluZz5SZWFkTGluZTwvVG9TdHJpbmc+PC9PYmo+PFMgTj0ibXIiIC8+PC9NUz48L09iaj4=</Data>\r\nRead\t<Data Stream='Default' PSGuid='c4c8b14e-efdb-40b4-948d-1baab3c647fa'>AAAAAAAAAAYAAAAAAAAAAAMAAAA1AQAAAAQQBAAscW/exJ0wTa2KRlMUx02eTrHIxNvvtECUjRuqs8ZH+u+7vzxTPmVuZDwvUz4=</Data>\r\nRead\t<Data Stream='Default' PSGuid='c4c8b14e-efdb-40b4-948d-1baab3c647fa'>AAAAAAAAAAcAAAAAAAAAAAMAAABnAQAAAAYQBAAscW/exJ0wTa2KRlMUx02eTrHIxNvvtECUjRuqs8ZH+u+7vzxPYmogUmVmSWQ9IjAiPjxNUz48STMyIE49IlBpcGVsaW5lU3RhdGUiPjQ8L0kzMj48L01TPjwvT2JqPg==</Data>\r\nRead\t<DataAck PSGuid='c4c8b14e-efdb-40b4-948d-1baab3c647fa' />\r\nWrite\t<Close PSGuid='C4C8B14E-EFDB-40B4-948D-1BAAB3C647FA' />\r\nRead\t<CloseAck PSGuid='c4c8b14e-efdb-40b4-948d-1baab3c647fa' />\r\n['hi', 'end']\r\nWrite\t<Close PSGuid='00000000-0000-0000-0000-000000000000' />\r\nRead\t<Data Stream='Default' PSGuid='00000000-0000-0000-0000-000000000000'>AAAAAAAAAAgAAAAAAAAAAAMAAABnAQAAAAUQAgAscW/exJ0wTa2KRlMUx02eAAAAAAAAAAAAAAAAAAAAAO+7vzxPYmogUmVmSWQ9IjAiPjxNUz48STMyIE49IlJ1bnNwYWNlU3RhdGUiPjQ8L0kzMj48L01TPjwvT2JqPg==</Data>\r\nRead\t<Data Stream='Default' PSGuid='00000000-0000-0000-0000-000000000000'>AAAAAAAAAAkAAAAAAAAAAAMAAABnAQAAAAUQAgAscW/exJ0wTa2KRlMUx02eAAAAAAAAAAAAAAAAAAAAAO+7vzxPYmogUmVmSWQ9IjAiPjxNUz48STMyIE49IlJ1bnNwYWNlU3RhdGUiPjM8L0kzMj48L01TPjwvT2JqPg==</Data>\r\nRead\t<CloseAck PSGuid='00000000-0000-0000-0000-000000000000' />\r\n```\r\n\r\nWhat's interesting is when I try to do the same with the command `powershell.exe -Version 5 -NoLogo -s` I see a similar process tree but the remote stops responding for any packets (can be a create pipeline, set runspace size, get availability, etc) sent after the runspace pool is opened\r\n\r\n![image](https://user-images.githubusercontent.com/8462645/114803108-37d7ee80-9de2-11eb-9ad0-473e3245fe44.png)\r\n\r\n```\r\nWrite\t<Data Stream='Default' PSGuid='00000000-0000-0000-0000-000000000000'>AAAAAAAAAAEAAAAAAAAAAAMAAADHAgAAAAIAAQC12a7gRFlsRILcuT7Hhe5TAAAAAAAAAAAAAAAAAAAAADxPYmogUmVmSWQ9IjAiPjxNUz48VmVyc2lvbiBOPSJQU1ZlcnNpb24iPjIuMDwvVmVyc2lvbj48VmVyc2lvbiBOPSJwcm90b2NvbHZlcnNpb24iPjIuMzwvVmVyc2lvbj48VmVyc2lvbiBOPSJTZXJpYWxpemF0aW9uVmVyc2lvbiI+MS4xLjAuMTwvVmVyc2lvbj48L01TPjwvT2JqPgAAAAAAAAACAAAAAAAAAAADAAADggIAAAAEAAEAtdmu4ERZbESC3Lk+x4XuUwAAAAAAAAAAAAAAAAAAAAA8T2JqIFJlZklkPSIwIj48TVM+PEkzMiBOPSJNaW5SdW5zcGFjZXMiPjE8L0kzMj48STMyIE49Ik1heFJ1bnNwYWNlcyI+MTwvSTMyPjxPYmogUmVmSWQ9IjEiIE49IlBTVGhyZWFkT3B0aW9ucyI+PEkzMj4wPC9JMzI+PFROIFJlZklkPSIwIj48VD5TeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlJ1bnNwYWNlcy5QU1RocmVhZE9wdGlvbnM8L1Q+PFQ+U3lzdGVtLkVudW08L1Q+PFQ+U3lzdGVtLlZhbHVlVHlwZTwvVD48VD5TeXN0ZW0uT2JqZWN0PC9UPjwvVE4+PFRvU3RyaW5nPkRlZmF1bHQ8L1RvU3RyaW5nPjwvT2JqPjxPYmogUmVmSWQ9IjIiIE49IkFwYXJ0bWVudFN0YXRlIj48STMyPjI8L0kzMj48VE4gUmVmSWQ9IjEiPjxUPlN5c3RlbS5UaHJlYWRpbmcuQXBhcnRtZW50U3RhdGU8L1Q+PFQ+U3lzdGVtLkVudW08L1Q+PFQ+U3lzdGVtLlZhbHVlVHlwZTwvVD48VD5TeXN0ZW0uT2JqZWN0PC9UPjwvVE4+PFRvU3RyaW5nPlVua25vd248L1RvU3RyaW5nPjwvT2JqPjxPYmogUmVmSWQ9IjMiIE49Ikhvc3RJbmZvIj48TVM+PEIgTj0iX2lzSG9zdE51bGwiPmZhbHNlPC9CPjxCIE49Il9pc0hvc3RVSU51bGwiPmZhbHNlPC9CPjxCIE49Il9pc0hvc3RSYXdVSU51bGwiPnRydWU8L0I+PEIgTj0iX3VzZVJ1bnNwYWNlSG9zdCI+ZmFsc2U8L0I+PC9NUz48L09iaj48T2JqIFJlZklkPSI0IiBOPSJBcHBsaWNhdGlvbkFyZ3VtZW50cyI+PFROIFJlZklkPSIyIj48VD5TeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTUHJpbWl0aXZlRGljdGlvbmFyeTwvVD48VD5TeXN0ZW0uQ29sbGVjdGlvbnMuSGFzaHRhYmxlPC9UPjxUPlN5c3RlbS5PYmplY3Q8L1Q+PC9UTj48RENUIC8+PC9PYmo+PC9NUz48L09iaj4=</Data>\r\nRead\t<Data Stream='Default' PSGuid='00000000-0000-0000-0000-000000000000'>AAAAAAAAAAEAAAAAAAAAAAMAAADKAQAAAAIAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAO+7vzxPYmogUmVmSWQ9IjAiPjxNUz48VmVyc2lvbiBOPSJwcm90b2NvbHZlcnNpb24iPjIuMzwvVmVyc2lvbj48VmVyc2lvbiBOPSJQU1ZlcnNpb24iPjIuMDwvVmVyc2lvbj48VmVyc2lvbiBOPSJTZXJpYWxpemF0aW9uVmVyc2lvbiI+MS4xLjAuMTwvVmVyc2lvbj48L01TPjwvT2JqPg==</Data>\r\nRead\t<Data Stream='Default' PSGuid='00000000-0000-0000-0000-000000000000'>AAAAAAAAAAIAAAAAAAAAAAMAAASqAQAAAAkQAgC12a7gRFlsRILcuT7Hhe5TAAAAAAAAAAAAAAAAAAAAAO+7vzxPYmogUmVmSWQ9IjAiPjxNUz48T2JqIE49IkFwcGxpY2F0aW9uUHJpdmF0ZURhdGEiIFJlZklkPSIxIj48VE4gUmVmSWQ9IjAiPjxUPlN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNQcmltaXRpdmVEaWN0aW9uYXJ5PC9UPjxUPlN5c3RlbS5Db2xsZWN0aW9ucy5IYXNodGFibGU8L1Q+PFQ+U3lzdGVtLk9iamVjdDwvVD48L1ROPjxEQ1Q+PEVuPjxTIE49IktleSI+UFNWZXJzaW9uVGFibGU8L1M+PE9iaiBOPSJWYWx1ZSIgUmVmSWQ9IjIiPjxUTlJlZiBSZWZJZD0iMCIgLz48RENUPjxFbj48UyBOPSJLZXkiPlBTVmVyc2lvbjwvUz48VmVyc2lvbiBOPSJWYWx1ZSI+NS4xLjE3NzYzLjc3MTwvVmVyc2lvbj48L0VuPjxFbj48UyBOPSJLZXkiPlBTRWRpdGlvbjwvUz48UyBOPSJWYWx1ZSI+RGVza3RvcDwvUz48L0VuPjxFbj48UyBOPSJLZXkiPlBTQ29tcGF0aWJsZVZlcnNpb25zPC9TPjxPYmogTj0iVmFsdWUiIFJlZklkPSIzIj48VE4gUmVmSWQ9IjEiPjxUPlN5c3RlbS5WZXJzaW9uW108L1Q+PFQ+U3lzdGVtLkFycmF5PC9UPjxUPlN5c3RlbS5PYmplY3Q8L1Q+PC9UTj48TFNUPjxWZXJzaW9uPjEuMDwvVmVyc2lvbj48VmVyc2lvbj4yLjA8L1ZlcnNpb24+PFZlcnNpb24+My4wPC9WZXJzaW9uPjxWZXJzaW9uPjQuMDwvVmVyc2lvbj48VmVyc2lvbj41LjA8L1ZlcnNpb24+PFZlcnNpb24+NS4xLjE3NzYzLjc3MTwvVmVyc2lvbj48L0xTVD48L09iaj48L0VuPjxFbj48UyBOPSJLZXkiPkNMUlZlcnNpb248L1M+PFZlcnNpb24gTj0iVmFsdWUiPjQuMC4zMDMxOS40MjAwMDwvVmVyc2lvbj48L0VuPjxFbj48UyBOPSJLZXkiPkJ1aWxkVmVyc2lvbjwvUz48VmVyc2lvbiBOPSJWYWx1ZSI+MTAuMC4xNzc2My43NzE8L1ZlcnNpb24+PC9Fbj48RW4+PFMgTj0iS2V5Ij5XU01hblN0YWNrVmVyc2lvbjwvUz48VmVyc2lvbiBOPSJWYWx1ZSI+My4wPC9WZXJzaW9uPjwvRW4+PEVuPjxTIE49IktleSI+UFNSZW1vdGluZ1Byb3RvY29sVmVyc2lvbjwvUz48VmVyc2lvbiBOPSJWYWx1ZSI+Mi4zPC9WZXJzaW9uPjwvRW4+PEVuPjxTIE49IktleSI+U2VyaWFsaXphdGlvblZlcnNpb248L1M+PFZlcnNpb24gTj0iVmFsdWUiPjEuMS4wLjE8L1ZlcnNpb24+PC9Fbj48L0RDVD48L09iaj48L0VuPjwvRENUPjwvT2JqPjwvTVM+PC9PYmo+</Data>\r\nRead\t<Data Stream='Default' PSGuid='00000000-0000-0000-0000-000000000000'>AAAAAAAAAAMAAAAAAAAAAAMAAABnAQAAAAUQAgC12a7gRFlsRILcuT7Hhe5TAAAAAAAAAAAAAAAAAAAAAO+7vzxPYmogUmVmSWQ9IjAiPjxNUz48STMyIE49IlJ1bnNwYWNlU3RhdGUiPjI8L0kzMj48L01TPjwvT2JqPg==</Data>\r\nRead\t<DataAck PSGuid='00000000-0000-0000-0000-000000000000' />\r\nWrite\t<Command PSGuid='425D2BAB-80EC-48F6-A7B4-A0A9A5F72004' />\r\n\r\n... No more responses, even for a <Close PSGuid='00000000-0000-0000-0000-000000000000' />\r\n```\r\n\r\nThere's nothing in `stderr` to indicate what might have gone wrong here so I'll keep at it but it might just be a dead end. The only thing I noticed in the `Analytic` event logs is that the logs indicate it sent the `DataAck` but nothing indicates it received the `Command` and other subsequent packets which is why there is no response. I cannot figure out why that may be, I might have to find a way to intercept the raw exchange that `Start-Job` uses and compare with the packets I'm sending.\r\n\r\nGetting a bit off track but are you able to elaborate the child process part of `-s` as I don't seem to see that happening. When looking at the codebase the only real difference I saw is how PowerShell created a stream to the stdio handles that I mentioned in the first comment and `-s` sets the actual handles to `TextWriter.Null`.",
      "created_at": "2021-04-15T02:05:25Z",
      "updated_at": "2021-04-15T03:02:29Z"
    },
    {
      "author": "jborean93",
      "author_association": "COLLABORATOR",
      "body": "I was able to find a way to capture the stdio traffic when running `Start-Job` to try and figure out if there was a different message flow but unfortunately nothing immediately jumped out at me. Here is the raw capture and parsed results from `Start-Job { echo \"abc\"; sleep 10 }`\r\n\r\n<details>\r\n  <summary>Exchange from PowerShell</summary>\r\n  \r\n```\r\n###########################\r\n### Raw Stream Messages ###\r\n###########################\r\n\r\n<Data Stream='Default' PSGuid='00000000-0000-0000-0000-000000000000'>AAAAAAAAAAEAAAAAAAAAAAMAAALwAgAAAAIAAQDvHgN7rfsBS5Cgs8Nefji+AAAAAAAAAAAAAAAAAAAAAO+7vzxPYmogUmVmSWQ9IjAiPjxNUz48VmVyc2lvbiBOPSJwcm90b2NvbHZlcnNpb24iPjIuMzwvVmVyc2lvbj48VmVyc2lvbiBOPSJQU1ZlcnNpb24iPjIuMDwvVmVyc2lvbj48VmVyc2lvbiBOPSJTZXJpYWxpemF0aW9uVmVyc2lvbiI+MS4xLjAuMTwvVmVyc2lvbj48QkEgTj0iVGltZVpvbmUiPkFBRUFBQUQvLy8vL0FRQUFBQUFBQUFBRUFRQUFBQnhUZVhOMFpXMHVRM1Z5Y21WdWRGTjVjM1JsYlZScGJXVmFiMjVsQkFBQUFCZHRYME5oWTJobFpFUmhlV3hwWjJoMFEyaGhibWRsY3cxdFgzUnBZMnR6VDJabWMyVjBEbTFmYzNSaGJtUmhjbVJPWVcxbERtMWZaR0Y1YkdsbmFIUk9ZVzFsQXdBQkFSeFRlWE4wWlcwdVEyOXNiR1ZqZEdsdmJuTXVTR0Z6YUhSaFlteGxDUWtDQUFBQUFCQ3MwVk1BQUFBS0NnUUNBQUFBSEZONWMzUmxiUzVEYjJ4c1pXTjBhVzl1Y3k1SVlYTm9kR0ZpYkdVSEFBQUFDa3h2WVdSR1lXTjBiM0lIVm1WeWMybHZiZ2hEYjIxd1lYSmxjaEJJWVhOb1EyOWtaVkJ5YjNacFpHVnlDRWhoYzJoVGFYcGxCRXRsZVhNR1ZtRnNkV1Z6QUFBREF3QUZCUXNJSEZONWMzUmxiUzVEYjJ4c1pXTjBhVzl1Y3k1SlEyOXRjR0Z5WlhJa1UzbHpkR1Z0TGtOdmJHeGxZM1JwYjI1ekxrbElZWE5vUTI5a1pWQnliM1pwWkdWeUNPeFJPRDhBQUFBQUNnb0RBQUFBQ1FNQUFBQUpCQUFBQUJBREFBQUFBQUFBQUJBRUFBQUFBQUFBQUFzPTwvQkE+PC9NUz48L09iaj4AAAAAAAAAAgAAAAAAAAAAAwAADq4CAAAABAABAO8eA3ut+wFLkKCzw15+OL4AAAAAAAAAAAAAAAAAAAAA77u/PE9iaiBSZWZJZD0iMCI+PE1TPjxJMzIgTj0iTWluUnVuc3BhY2VzIj4xPC9JMzI+PEkzMiBOPSJNYXhSdW5zcGFjZXMiPjE8L0kzMj48T2JqIE49IlBTVGhyZWFkT3B0aW9ucyIgUmVmSWQ9IjEiPjxUTiBSZWZJZD0iMCI+PFQ+U3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5SdW5zcGFjZXMuUFNUaHJlYWRPcHRpb25zPC9UPjxUPlN5c3RlbS5FbnVtPC9UPjxUPlN5c3RlbS5WYWx1ZVR5cGU8L1Q+PFQ+U3lzdGVtLk9iamVjdDwvVD48L1ROPjxUb1N0cmluZz5EZWZhdWx0PC9Ub1N0cmluZz48STMyPjA8L0kzMj48L09iaj48T2JqIE49IkFwYXJ0bWVudFN0YXRlIiBSZWZJZD0iMiI+PFROIFJlZklkPSIxIj48VD5TeXN0ZW0uVGhyZWFkaW5nLkFwYXJ0bWVudFN0YXRlPC9UPjxUPlN5c3RlbS5FbnVtPC9UPjxUPlN5c3RlbS5WYWx1ZVR5cGU8L1Q+PFQ+U3lzdGVtLk9iamVjdDwvVD48L1ROPjxUb1N0cmluZz5Vbmtub3duPC9Ub1N0cmluZz48STMyPjI8L0kzMj48L09iaj48T2JqIE49IkFwcGxpY2F0aW9uQXJndW1lbnRzIiBSZWZJZD0iMyI+PFROIFJlZklkPSIyIj48VD5TeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTUHJpbWl0aXZlRGljdGlvbmFyeTwvVD48VD5TeXN0ZW0uQ29sbGVjdGlvbnMuSGFzaHRhYmxlPC9UPjxUPlN5c3RlbS5PYmplY3Q8L1Q+PC9UTj48RENUPjxFbj48UyBOPSJLZXkiPlBTVmVyc2lvblRhYmxlPC9TPjxPYmogTj0iVmFsdWUiIFJlZklkPSI0Ij48VE5SZWYgUmVmSWQ9IjIiIC8+PERDVD48RW4+PFMgTj0iS2V5Ij5QU1ZlcnNpb248L1M+PFZlcnNpb24gTj0iVmFsdWUiPjUuMS4xNzc2My4xODUyPC9WZXJzaW9uPjwvRW4+PEVuPjxTIE49IktleSI+UFNFZGl0aW9uPC9TPjxTIE49IlZhbHVlIj5EZXNrdG9wPC9TPjwvRW4+PEVuPjxTIE49IktleSI+UFNDb21wYXRpYmxlVmVyc2lvbnM8L1M+PE9iaiBOPSJWYWx1ZSIgUmVmSWQ9IjUiPjxUTiBSZWZJZD0iMyI+PFQ+U3lzdGVtLlZlcnNpb25bXTwvVD48VD5TeXN0ZW0uQXJyYXk8L1Q+PFQ+U3lzdGVtLk9iamVjdDwvVD48L1ROPjxMU1Q+PFZlcnNpb24+MS4wPC9WZXJzaW9uPjxWZXJzaW9uPjIuMDwvVmVyc2lvbj48VmVyc2lvbj4zLjA8L1ZlcnNpb24+PFZlcnNpb24+NC4wPC9WZXJzaW9uPjxWZXJzaW9uPjUuMDwvVmVyc2lvbj48VmVyc2lvbj41LjEuMTc3NjMuMTg1MjwvVmVyc2lvbj48L0xTVD48L09iaj48L0VuPjxFbj48UyBOPSJLZXkiPkNMUlZlcnNpb248L1M+PFZlcnNpb24gTj0iVmFsdWUiPjQuMC4zMDMxOS40MjAwMDwvVmVyc2lvbj48L0VuPjxFbj48UyBOPSJLZXkiPkJ1aWxkVmVyc2lvbjwvUz48VmVyc2lvbiBOPSJWYWx1ZSI+MTAuMC4xNzc2My4xODUyPC9WZXJzaW9uPjwvRW4+PEVuPjxTIE49IktleSI+V1NNYW5TdGFja1ZlcnNpb248L1M+PFZlcnNpb24gTj0iVmFsdWUiPjMuMDwvVmVyc2lvbj48L0VuPjxFbj48UyBOPSJLZXkiPlBTUmVtb3RpbmdQcm90b2NvbFZlcnNpb248L1M+PFZlcnNpb24gTj0iVmFsdWUiPjIuMzwvVmVyc2lvbj48L0VuPjxFbj48UyBOPSJLZXkiPlNlcmlhbGl6YXRpb25WZXJzaW9uPC9TPjxWZXJzaW9uIE49IlZhbHVlIj4xLjEuMC4xPC9WZXJzaW9uPjwvRW4+PC9EQ1Q+PC9PYmo+PC9Fbj48L0RDVD48L09iaj48T2JqIE49Ikhvc3RJbmZvIiBSZWZJZD0iNiI+PE1TPjxPYmogTj0iX2hvc3REZWZhdWx0RGF0YSIgUmVmSWQ9IjciPjxNUz48T2JqIE49ImRhdGEiIFJlZklkPSI4Ij48VE4gUmVmSWQ9IjQiPjxUPlN5c3RlbS5Db2xsZWN0aW9ucy5IYXNodGFibGU8L1Q+PFQ+U3lzdGVtLk9iamVjdDwvVD48L1ROPjxEQ1Q+PEVuPjxJMzIgTj0iS2V5Ij45PC9JMzI+PE9iaiBOPSJWYWx1ZSIgUmVmSWQ9IjkiPjxNUz48UyBOPSJUIj5TeXN0ZW0uU3RyaW5nPC9TPjxTIE49IlYiPkM6XFdpbmRvd3NcU3lzdGVtMzJcV2luZG93c1Bvd2VyU2hlbGxcdjEuMFxwb3dlcnNoZWxsLmV4ZS5vcmlnPC9TPjwvTVM+PC9PYmo+PC9Fbj48RW4+PEkzMiBOPSJLZXkiPjg8L0kzMj48T2JqIE49IlZhbHVlIiBSZWZJZD0iMTAiPjxNUz48UyBOPSJUIj5TeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLkhvc3QuU2l6ZTwvUz48T2JqIE49IlYiIFJlZklkPSIxMSI+PE1TPjxJMzIgTj0id2lkdGgiPjYzNDwvSTMyPjxJMzIgTj0iaGVpZ2h0Ij44MTwvSTMyPjwvTVM+PC9PYmo+PC9NUz48L09iaj48L0VuPjxFbj48STMyIE49IktleSI+NzwvSTMyPjxPYmogTj0iVmFsdWUiIFJlZklkPSIxMiI+PE1TPjxTIE49IlQiPlN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uSG9zdC5TaXplPC9TPjxPYmogTj0iViIgUmVmSWQ9IjEzIj48TVM+PEkzMiBOPSJ3aWR0aCI+MTIwPC9JMzI+PEkzMiBOPSJoZWlnaHQiPjgxPC9JMzI+PC9NUz48L09iaj48L01TPjwvT2JqPjwvRW4+PEVuPjxJMzIgTj0iS2V5Ij42PC9JMzI+PE9iaiBOPSJWYWx1ZSIgUmVmSWQ9IjE0Ij48TVM+PFMgTj0iVCI+U3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5Ib3N0LlNpemU8L1M+PE9iaiBOPSJWIiBSZWZJZD0iMTUiPjxNUz48STMyIE49IndpZHRoIj4xMjA8L0kzMj48STMyIE49ImhlaWdodCI+MzA8L0kzMj48L01TPjwvT2JqPjwvTVM+PC9PYmo+PC9Fbj48RW4+PEkzMiBOPSJLZXkiPjU8L0kzMj48T2JqIE49IlZhbHVlIiBSZWZJZD0iMTYiPjxNUz48UyBOPSJUIj5TeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLkhvc3QuU2l6ZTwvUz48T2JqIE49IlYiIFJlZklkPSIxNyI+PE1TPjxJMzIgTj0id2lkdGgiPjEyMDwvSTMyPjxJMzIgTj0iaGVpZ2h0Ij45MDAxPC9JMzI+PC9NUz48L09iaj48L01TPjwvT2JqPjwvRW4+PEVuPjxJMzIgTj0iS2V5Ij40PC9JMzI+PE9iaiBOPSJWYWx1ZSIgUmVmSWQ9IjE4Ij48TVM+PFMgTj0iVCI+U3lzdGVtLkludDMyPC9TPjxJMzIgTj0iViI+MjU8L0kzMj48L01TPjwvT2JqPjwvRW4+PEVuPjxJMzIgTj0iS2V5Ij4zPC9JMzI+PE9iaiBOPSJWYWx1ZSIgUmVmSWQ9IjE5Ij48TVM+PFMgTj0iVCI+U3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5Ib3N0LkNvb3JkaW5hdGVzPC9TPjxPYmogTj0iViIgUmVmSWQ9IjIwIj48TVM+PEkzMiBOPSJ4Ij4wPC9JMzI+PEkzMiBOPSJ5Ij4wPC9JMzI+PC9NUz48L09iaj48L01TPjwvT2JqPjwvRW4+PEVuPjxJMzIgTj0iS2V5Ij4yPC9JMzI+PE9iaiBOPSJWYWx1ZSIgUmVmSWQ9IjIxIj48TVM+PFMgTj0iVCI+U3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5Ib3N0LkNvb3JkaW5hdGVzPC9TPjxPYmogTj0iViIgUmVmSWQ9IjIyIj48TVM+PEkzMiBOPSJ4Ij4wPC9JMzI+PEkzMiBOPSJ5Ij4wPC9JMzI+PC9NUz48L09iaj48L01TPjwvT2JqPjwvRW4+PEVuPjxJMzIgTj0iS2V5Ij4xPC9JMzI+PE9iaiBOPSJWYWx1ZSIgUmVmSWQ9IjIzIj48TVM+PFMgTj0iVCI+U3lzdGVtLkNvbnNvbGVDb2xvcjwvUz48STMyIE49IlYiPjA8L0kzMj48L01TPjwvT2JqPjwvRW4+PEVuPjxJMzIgTj0iS2V5Ij4wPC9JMzI+PE9iaiBOPSJWYWx1ZSIgUmVmSWQ9IjI0Ij48TVM+PFMgTj0iVCI+U3lzdGVtLkNvbnNvbGVDb2xvcjwvUz48STMyIE49IlYiPjc8L0kzMj48L01TPjwvT2JqPjwvRW4+PC9EQ1Q+PC9PYmo+PC9NUz48L09iaj48QiBOPSJfaXNIb3N0TnVsbCI+ZmFsc2U8L0I+PEIgTj0iX2lzSG9zdFVJTnVsbCI+ZmFsc2U8L0I+PEIgTj0iX2lzSG9zdFJhd1VJTnVsbCI+ZmFsc2U8L0I+PEIgTj0iX3VzZVJ1bnNwYWNlSG9zdCI+ZmFsc2U8L0I+PC9NUz48L09iaj48L01TPjwvT2JqPg==</Data>\r\n<Data Stream='Default' PSGuid='00000000-0000-0000-0000-000000000000'>AAAAAAAAAAEAAAAAAAAAAAMAAADKAQAAAAIAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAO+7vzxPYmogUmVmSWQ9IjAiPjxNUz48VmVyc2lvbiBOPSJwcm90b2NvbHZlcnNpb24iPjIuMzwvVmVyc2lvbj48VmVyc2lvbiBOPSJQU1ZlcnNpb24iPjIuMDwvVmVyc2lvbj48VmVyc2lvbiBOPSJTZXJpYWxpemF0aW9uVmVyc2lvbiI+MS4xLjAuMTwvVmVyc2lvbj48L01TPjwvT2JqPg==</Data>\r\n<Data Stream='Default' PSGuid='00000000-0000-0000-0000-000000000000'>AAAAAAAAAAIAAAAAAAAAAAMAAAXYAQAAAAkQAgDvHgN7rfsBS5Cgs8Nefji+AAAAAAAAAAAAAAAAAAAAAO+7vzxPYmogUmVmSWQ9IjAiPjxNUz48T2JqIE49IkFwcGxpY2F0aW9uUHJpdmF0ZURhdGEiIFJlZklkPSIxIj48VE4gUmVmSWQ9IjAiPjxUPlN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNQcmltaXRpdmVEaWN0aW9uYXJ5PC9UPjxUPlN5c3RlbS5Db2xsZWN0aW9ucy5IYXNodGFibGU8L1Q+PFQ+U3lzdGVtLk9iamVjdDwvVD48L1ROPjxEQ1Q+PEVuPjxTIE49IktleSI+QnJlYWtBbGw8L1M+PEIgTj0iVmFsdWUiPmZhbHNlPC9CPjwvRW4+PEVuPjxTIE49IktleSI+RGVidWdTdG9wPC9TPjxCIE49IlZhbHVlIj5mYWxzZTwvQj48L0VuPjxFbj48UyBOPSJLZXkiPlVuaGFuZGxlZEJyZWFrcG9pbnRNb2RlPC9TPjxJMzIgTj0iVmFsdWUiPjE8L0kzMj48L0VuPjxFbj48UyBOPSJLZXkiPlBTVmVyc2lvblRhYmxlPC9TPjxPYmogTj0iVmFsdWUiIFJlZklkPSIyIj48VE5SZWYgUmVmSWQ9IjAiIC8+PERDVD48RW4+PFMgTj0iS2V5Ij5QU1ZlcnNpb248L1M+PFZlcnNpb24gTj0iVmFsdWUiPjUuMS4xNzc2My4xODUyPC9WZXJzaW9uPjwvRW4+PEVuPjxTIE49IktleSI+UFNFZGl0aW9uPC9TPjxTIE49IlZhbHVlIj5EZXNrdG9wPC9TPjwvRW4+PEVuPjxTIE49IktleSI+UFNDb21wYXRpYmxlVmVyc2lvbnM8L1M+PE9iaiBOPSJWYWx1ZSIgUmVmSWQ9IjMiPjxUTiBSZWZJZD0iMSI+PFQ+U3lzdGVtLlZlcnNpb25bXTwvVD48VD5TeXN0ZW0uQXJyYXk8L1Q+PFQ+U3lzdGVtLk9iamVjdDwvVD48L1ROPjxMU1Q+PFZlcnNpb24+MS4wPC9WZXJzaW9uPjxWZXJzaW9uPjIuMDwvVmVyc2lvbj48VmVyc2lvbj4zLjA8L1ZlcnNpb24+PFZlcnNpb24+NC4wPC9WZXJzaW9uPjxWZXJzaW9uPjUuMDwvVmVyc2lvbj48VmVyc2lvbj41LjEuMTc3NjMuMTg1MjwvVmVyc2lvbj48L0xTVD48L09iaj48L0VuPjxFbj48UyBOPSJLZXkiPkNMUlZlcnNpb248L1M+PFZlcnNpb24gTj0iVmFsdWUiPjQuMC4zMDMxOS40MjAwMDwvVmVyc2lvbj48L0VuPjxFbj48UyBOPSJLZXkiPkJ1aWxkVmVyc2lvbjwvUz48VmVyc2lvbiBOPSJWYWx1ZSI+MTAuMC4xNzc2My4xODUyPC9WZXJzaW9uPjwvRW4+PEVuPjxTIE49IktleSI+V1NNYW5TdGFja1ZlcnNpb248L1M+PFZlcnNpb24gTj0iVmFsdWUiPjMuMDwvVmVyc2lvbj48L0VuPjxFbj48UyBOPSJLZXkiPlBTUmVtb3RpbmdQcm90b2NvbFZlcnNpb248L1M+PFZlcnNpb24gTj0iVmFsdWUiPjIuMzwvVmVyc2lvbj48L0VuPjxFbj48UyBOPSJLZXkiPlNlcmlhbGl6YXRpb25WZXJzaW9uPC9TPjxWZXJzaW9uIE49IlZhbHVlIj4xLjEuMC4xPC9WZXJzaW9uPjwvRW4+PC9EQ1Q+PC9PYmo+PC9Fbj48RW4+PFMgTj0iS2V5Ij5EZWJ1Z01vZGU8L1M+PEkzMiBOPSJWYWx1ZSI+MTwvSTMyPjwvRW4+PEVuPjxTIE49IktleSI+RGVidWdCcmVha3BvaW50Q291bnQ8L1M+PEkzMiBOPSJWYWx1ZSI+MDwvSTMyPjwvRW4+PC9EQ1Q+PC9PYmo+PC9NUz48L09iaj4=</Data>\r\n<Data Stream='Default' PSGuid='00000000-0000-0000-0000-000000000000'>AAAAAAAAAAMAAAAAAAAAAAMAAABnAQAAAAUQAgDvHgN7rfsBS5Cgs8Nefji+AAAAAAAAAAAAAAAAAAAAAO+7vzxPYmogUmVmSWQ9IjAiPjxNUz48STMyIE49IlJ1bnNwYWNlU3RhdGUiPjI8L0kzMj48L01TPjwvT2JqPg==</Data>\r\n<DataAck PSGuid='00000000-0000-0000-0000-000000000000' />\r\n<Command PSGuid='383eceb0-2697-4b4d-941d-f3f8170fac69' />\r\n<CommandAck PSGuid='383eceb0-2697-4b4d-941d-f3f8170fac69' />\r\n<Data Stream='Default' PSGuid='383eceb0-2697-4b4d-941d-f3f8170fac69'>AAAAAAAAAAMAAAAAAAAAAAMAAAmbAgAAAAYQAgDvHgN7rfsBS5Cgs8Nefji+sM4+OJcmTUuUHfP4Fw+sae+7vzxPYmogUmVmSWQ9IjAiPjxNUz48T2JqIE49IlBvd2VyU2hlbGwiIFJlZklkPSIxIj48TVM+PE9iaiBOPSJDbWRzIiBSZWZJZD0iMiI+PFROIFJlZklkPSIwIj48VD5TeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5MaXN0YDFbW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNPYmplY3QsIFN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24sIFZlcnNpb249My4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj0zMWJmMzg1NmFkMzY0ZTM1XV08L1Q+PFQ+U3lzdGVtLk9iamVjdDwvVD48L1ROPjxMU1Q+PE9iaiBSZWZJZD0iMyI+PE1TPjxTIE49IkNtZCI+X19TZXQtUFNEZWJ1Z01vZGU8L1M+PEIgTj0iSXNTY3JpcHQiPmZhbHNlPC9CPjxOaWwgTj0iVXNlTG9jYWxTY29wZSIgLz48T2JqIE49Ik1lcmdlTXlSZXN1bHQiIFJlZklkPSI0Ij48VE4gUmVmSWQ9IjEiPjxUPlN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUnVuc3BhY2VzLlBpcGVsaW5lUmVzdWx0VHlwZXM8L1Q+PFQ+U3lzdGVtLkVudW08L1Q+PFQ+U3lzdGVtLlZhbHVlVHlwZTwvVD48VD5TeXN0ZW0uT2JqZWN0PC9UPjwvVE4+PFRvU3RyaW5nPk5vbmU8L1RvU3RyaW5nPjxJMzI+MDwvSTMyPjwvT2JqPjxPYmogTj0iTWVyZ2VUb1Jlc3VsdCIgUmVmSWQ9IjUiPjxUTlJlZiBSZWZJZD0iMSIgLz48VG9TdHJpbmc+Tm9uZTwvVG9TdHJpbmc+PEkzMj4wPC9JMzI+PC9PYmo+PE9iaiBOPSJNZXJnZVByZXZpb3VzUmVzdWx0cyIgUmVmSWQ9IjYiPjxUTlJlZiBSZWZJZD0iMSIgLz48VG9TdHJpbmc+Tm9uZTwvVG9TdHJpbmc+PEkzMj4wPC9JMzI+PC9PYmo+PE9iaiBOPSJNZXJnZUVycm9yIiBSZWZJZD0iNyI+PFROUmVmIFJlZklkPSIxIiAvPjxUb1N0cmluZz5Ob25lPC9Ub1N0cmluZz48STMyPjA8L0kzMj48L09iaj48T2JqIE49Ik1lcmdlV2FybmluZyIgUmVmSWQ9IjgiPjxUTlJlZiBSZWZJZD0iMSIgLz48VG9TdHJpbmc+Tm9uZTwvVG9TdHJpbmc+PEkzMj4wPC9JMzI+PC9PYmo+PE9iaiBOPSJNZXJnZVZlcmJvc2UiIFJlZklkPSI5Ij48VE5SZWYgUmVmSWQ9IjEiIC8+PFRvU3RyaW5nPk5vbmU8L1RvU3RyaW5nPjxJMzI+MDwvSTMyPjwvT2JqPjxPYmogTj0iTWVyZ2VEZWJ1ZyIgUmVmSWQ9IjEwIj48VE5SZWYgUmVmSWQ9IjEiIC8+PFRvU3RyaW5nPk5vbmU8L1RvU3RyaW5nPjxJMzI+MDwvSTMyPjwvT2JqPjxPYmogTj0iTWVyZ2VJbmZvcm1hdGlvbiIgUmVmSWQ9IjExIj48VE5SZWYgUmVmSWQ9IjEiIC8+PFRvU3RyaW5nPk5vbmU8L1RvU3RyaW5nPjxJMzI+MDwvSTMyPjwvT2JqPjxPYmogTj0iQXJncyIgUmVmSWQ9IjEyIj48VE5SZWYgUmVmSWQ9IjAiIC8+PExTVD48T2JqIFJlZklkPSIxMyI+PE1TPjxTIE49Ik4iPk1vZGU8L1M+PE9iaiBOPSJWIiBSZWZJZD0iMTQiPjxUTiBSZWZJZD0iMiI+PFQ+U3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5EZWJ1Z01vZGVzPC9UPjxUPlN5c3RlbS5FbnVtPC9UPjxUPlN5c3RlbS5WYWx1ZVR5cGU8L1Q+PFQ+U3lzdGVtLk9iamVjdDwvVD48L1ROPjxUb1N0cmluZz5Mb2NhbFNjcmlwdCwgUmVtb3RlU2NyaXB0PC9Ub1N0cmluZz48STMyPjY8L0kzMj48L09iaj48L01TPjwvT2JqPjwvTFNUPjwvT2JqPjwvTVM+PC9PYmo+PC9MU1Q+PC9PYmo+PEIgTj0iSXNOZXN0ZWQiPmZhbHNlPC9CPjxOaWwgTj0iSGlzdG9yeSIgLz48QiBOPSJSZWRpcmVjdFNoZWxsRXJyb3JPdXRwdXRQaXBlIj50cnVlPC9CPjwvTVM+PC9PYmo+PEIgTj0iTm9JbnB1dCI+dHJ1ZTwvQj48T2JqIE49IkFwYXJ0bWVudFN0YXRlIiBSZWZJZD0iMTUiPjxUTiBSZWZJZD0iMyI+PFQ+U3lzdGVtLlRocmVhZGluZy5BcGFydG1lbnRTdGF0ZTwvVD48VD5TeXN0ZW0uRW51bTwvVD48VD5TeXN0ZW0uVmFsdWVUeXBlPC9UPjxUPlN5c3RlbS5PYmplY3Q8L1Q+PC9UTj48VG9TdHJpbmc+VW5rbm93bjwvVG9TdHJpbmc+PEkzMj4yPC9JMzI+PC9PYmo+PE9iaiBOPSJSZW1vdGVTdHJlYW1PcHRpb25zIiBSZWZJZD0iMTYiPjxUTiBSZWZJZD0iNCI+PFQ+U3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5SZW1vdGVTdHJlYW1PcHRpb25zPC9UPjxUPlN5c3RlbS5FbnVtPC9UPjxUPlN5c3RlbS5WYWx1ZVR5cGU8L1Q+PFQ+U3lzdGVtLk9iamVjdDwvVD48L1ROPjxUb1N0cmluZz5BZGRJbnZvY2F0aW9uSW5mbzwvVG9TdHJpbmc+PEkzMj4xNTwvSTMyPjwvT2JqPjxCIE49IkFkZFRvSGlzdG9yeSI+ZmFsc2U8L0I+PE9iaiBOPSJIb3N0SW5mbyIgUmVmSWQ9IjE3Ij48TVM+PEIgTj0iX2lzSG9zdE51bGwiPnRydWU8L0I+PEIgTj0iX2lzSG9zdFVJTnVsbCI+dHJ1ZTwvQj48QiBOPSJfaXNIb3N0UmF3VUlOdWxsIj50cnVlPC9CPjxCIE49Il91c2VSdW5zcGFjZUhvc3QiPnRydWU8L0I+PC9NUz48L09iaj48QiBOPSJJc05lc3RlZCI+ZmFsc2U8L0I+PC9NUz48L09iaj4=</Data>\r\n<DataAck PSGuid='383eceb0-2697-4b4d-941d-f3f8170fac69' />\r\n<Data Stream='Default' PSGuid='383eceb0-2697-4b4d-941d-f3f8170fac69'>AAAAAAAAAAQAAAAAAAAAAAMAAABnAQAAAAYQBADvHgN7rfsBS5Cgs8Nefji+sM4+OJcmTUuUHfP4Fw+sae+7vzxPYmogUmVmSWQ9IjAiPjxNUz48STMyIE49IlBpcGVsaW5lU3RhdGUiPjQ8L0kzMj48L01TPjwvT2JqPg==</Data>\r\n<Close PSGuid='383eceb0-2697-4b4d-941d-f3f8170fac69' />\r\n<CloseAck PSGuid='383eceb0-2697-4b4d-941d-f3f8170fac69' />\r\n<Command PSGuid='aee41703-b405-44de-80db-92f06b8732a1' />\r\n<CommandAck PSGuid='aee41703-b405-44de-80db-92f06b8732a1' />\r\n<Data Stream='Default' PSGuid='aee41703-b405-44de-80db-92f06b8732a1'>AAAAAAAAAAQAAAAAAAAAAAMAABFwAgAAAAYQAgDvHgN7rfsBS5Cgs8Nefji+AxfkrgW03kSA25Lwa4cyoe+7vzxPYmogUmVmSWQ9IjAiPjxNUz48T2JqIE49IlBvd2VyU2hlbGwiIFJlZklkPSIxIj48TVM+PE9iaiBOPSJFeHRyYUNtZHMiIFJlZklkPSIyIj48VE4gUmVmSWQ9IjAiPjxUPlN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljLkxpc3RgMVtbU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5QU09iamVjdCwgU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbiwgVmVyc2lvbj0zLjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPTMxYmYzODU2YWQzNjRlMzVdXTwvVD48VD5TeXN0ZW0uT2JqZWN0PC9UPjwvVE4+PExTVD48T2JqIFJlZklkPSIzIj48TVM+PE9iaiBOPSJDbWRzIiBSZWZJZD0iNCI+PFROUmVmIFJlZklkPSIwIiAvPjxMU1Q+PE9iaiBSZWZJZD0iNSI+PE1TPjxTIE49IkNtZCI+ZWNobzwvUz48QiBOPSJJc1NjcmlwdCI+ZmFsc2U8L0I+PE5pbCBOPSJVc2VMb2NhbFNjb3BlIiAvPjxPYmogTj0iTWVyZ2VNeVJlc3VsdCIgUmVmSWQ9IjYiPjxUTiBSZWZJZD0iMSI+PFQ+U3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5SdW5zcGFjZXMuUGlwZWxpbmVSZXN1bHRUeXBlczwvVD48VD5TeXN0ZW0uRW51bTwvVD48VD5TeXN0ZW0uVmFsdWVUeXBlPC9UPjxUPlN5c3RlbS5PYmplY3Q8L1Q+PC9UTj48VG9TdHJpbmc+Tm9uZTwvVG9TdHJpbmc+PEkzMj4wPC9JMzI+PC9PYmo+PE9iaiBOPSJNZXJnZVRvUmVzdWx0IiBSZWZJZD0iNyI+PFROUmVmIFJlZklkPSIxIiAvPjxUb1N0cmluZz5Ob25lPC9Ub1N0cmluZz48STMyPjA8L0kzMj48L09iaj48T2JqIE49Ik1lcmdlUHJldmlvdXNSZXN1bHRzIiBSZWZJZD0iOCI+PFROUmVmIFJlZklkPSIxIiAvPjxUb1N0cmluZz5Ob25lPC9Ub1N0cmluZz48STMyPjA8L0kzMj48L09iaj48T2JqIE49Ik1lcmdlRXJyb3IiIFJlZklkPSI5Ij48VE5SZWYgUmVmSWQ9IjEiIC8+PFRvU3RyaW5nPk5vbmU8L1RvU3RyaW5nPjxJMzI+MDwvSTMyPjwvT2JqPjxPYmogTj0iTWVyZ2VXYXJuaW5nIiBSZWZJZD0iMTAiPjxUTlJlZiBSZWZJZD0iMSIgLz48VG9TdHJpbmc+Tm9uZTwvVG9TdHJpbmc+PEkzMj4wPC9JMzI+PC9PYmo+PE9iaiBOPSJNZXJnZVZlcmJvc2UiIFJlZklkPSIxMSI+PFROUmVmIFJlZklkPSIxIiAvPjxUb1N0cmluZz5Ob25lPC9Ub1N0cmluZz48STMyPjA8L0kzMj48L09iaj48T2JqIE49Ik1lcmdlRGVidWciIFJlZklkPSIxMiI+PFROUmVmIFJlZklkPSIxIiAvPjxUb1N0cmluZz5Ob25lPC9Ub1N0cmluZz48STMyPjA8L0kzMj48L09iaj48T2JqIE49Ik1lcmdlSW5mb3JtYXRpb24iIFJlZklkPSIxMyI+PFROUmVmIFJlZklkPSIxIiAvPjxUb1N0cmluZz5Ob25lPC9Ub1N0cmluZz48STMyPjA8L0kzMj48L09iaj48T2JqIE49IkFyZ3MiIFJlZklkPSIxNCI+PFROUmVmIFJlZklkPSIwIiAvPjxMU1Q+PE9iaiBSZWZJZD0iMTUiPjxNUz48TmlsIE49Ik4iIC8+PFMgTj0iViI+YWJjPC9TPjwvTVM+PC9PYmo+PC9MU1Q+PC9PYmo+PC9NUz48L09iaj48L0xTVD48L09iaj48L01TPjwvT2JqPjxPYmogUmVmSWQ9IjE2Ij48TVM+PE9iaiBOPSJDbWRzIiBSZWZJZD0iMTciPjxUTlJlZiBSZWZJZD0iMCIgLz48TFNUPjxPYmogUmVmSWQ9IjE4Ij48TVM+PFMgTj0iQ21kIj5zbGVlcDwvUz48QiBOPSJJc1NjcmlwdCI+ZmFsc2U8L0I+PE5pbCBOPSJVc2VMb2NhbFNjb3BlIiAvPjxPYmogTj0iTWVyZ2VNeVJlc3VsdCIgUmVmSWQ9IjE5Ij48VE5SZWYgUmVmSWQ9IjEiIC8+PFRvU3RyaW5nPk5vbmU8L1RvU3RyaW5nPjxJMzI+MDwvSTMyPjwvT2JqPjxPYmogTj0iTWVyZ2VUb1Jlc3VsdCIgUmVmSWQ9IjIwIj48VE5SZWYgUmVmSWQ9IjEiIC8+PFRvU3RyaW5nPk5vbmU8L1RvU3RyaW5nPjxJMzI+MDwvSTMyPjwvT2JqPjxPYmogTj0iTWVyZ2VQcmV2aW91c1Jlc3VsdHMiIFJlZklkPSIyMSI+PFROUmVmIFJlZklkPSIxIiAvPjxUb1N0cmluZz5Ob25lPC9Ub1N0cmluZz48STMyPjA8L0kzMj48L09iaj48T2JqIE49Ik1lcmdlRXJyb3IiIFJlZklkPSIyMiI+PFROUmVmIFJlZklkPSIxIiAvPjxUb1N0cmluZz5Ob25lPC9Ub1N0cmluZz48STMyPjA8L0kzMj48L09iaj48T2JqIE49Ik1lcmdlV2FybmluZyIgUmVmSWQ9IjIzIj48VE5SZWYgUmVmSWQ9IjEiIC8+PFRvU3RyaW5nPk5vbmU8L1RvU3RyaW5nPjxJMzI+MDwvSTMyPjwvT2JqPjxPYmogTj0iTWVyZ2VWZXJib3NlIiBSZWZJZD0iMjQiPjxUTlJlZiBSZWZJZD0iMSIgLz48VG9TdHJpbmc+Tm9uZTwvVG9TdHJpbmc+PEkzMj4wPC9JMzI+PC9PYmo+PE9iaiBOPSJNZXJnZURlYnVnIiBSZWZJZD0iMjUiPjxUTlJlZiBSZWZJZD0iMSIgLz48VG9TdHJpbmc+Tm9uZTwvVG9TdHJpbmc+PEkzMj4wPC9JMzI+PC9PYmo+PE9iaiBOPSJNZXJnZUluZm9ybWF0aW9uIiBSZWZJZD0iMjYiPjxUTlJlZiBSZWZJZD0iMSIgLz48VG9TdHJpbmc+Tm9uZTwvVG9TdHJpbmc+PEkzMj4wPC9JMzI+PC9PYmo+PE9iaiBOPSJBcmdzIiBSZWZJZD0iMjciPjxUTlJlZiBSZWZJZD0iMCIgLz48TFNUPjxPYmogUmVmSWQ9IjI4Ij48TVM+PE5pbCBOPSJOIiAvPjxJMzIgTj0iViI+MTA8L0kzMj48L01TPjwvT2JqPjwvTFNUPjwvT2JqPjwvTVM+PC9PYmo+PC9MU1Q+PC9PYmo+PC9NUz48L09iaj48L0xTVD48L09iaj48T2JqIE49IkNtZHMiIFJlZklkPSIyOSI+PFROUmVmIFJlZklkPSIwIiAvPjxMU1Q+PE9iaiBSZWZJZD0iMzAiPjxNUz48UyBOPSJDbWQiPmVjaG88L1M+PEIgTj0iSXNTY3JpcHQiPmZhbHNlPC9CPjxOaWwgTj0iVXNlTG9jYWxTY29wZSIgLz48T2JqIE49Ik1lcmdlTXlSZXN1bHQiIFJlZklkPSIzMSI+PFROUmVmIFJlZklkPSIxIiAvPjxUb1N0cmluZz5Ob25lPC9Ub1N0cmluZz48STMyPjA8L0kzMj48L09iaj48T2JqIE49Ik1lcmdlVG9SZXN1bHQiIFJlZklkPSIzMiI+PFROUmVmIFJlZklkPSIxIiAvPjxUb1N0cmluZz5Ob25lPC9Ub1N0cmluZz48STMyPjA8L0kzMj48L09iaj48T2JqIE49Ik1lcmdlUHJldmlvdXNSZXN1bHRzIiBSZWZJZD0iMzMiPjxUTlJlZiBSZWZJZD0iMSIgLz48VG9TdHJpbmc+Tm9uZTwvVG9TdHJpbmc+PEkzMj4wPC9JMzI+PC9PYmo+PE9iaiBOPSJNZXJnZUVycm9yIiBSZWZJZD0iMzQiPjxUTlJlZiBSZWZJZD0iMSIgLz48VG9TdHJpbmc+Tm9uZTwvVG9TdHJpbmc+PEkzMj4wPC9JMzI+PC9PYmo+PE9iaiBOPSJNZXJnZVdhcm5pbmciIFJlZklkPSIzNSI+PFROUmVmIFJlZklkPSIxIiAvPjxUb1N0cmluZz5Ob25lPC9Ub1N0cmluZz48STMyPjA8L0kzMj48L09iaj48T2JqIE49Ik1lcmdlVmVyYm9zZSIgUmVmSWQ9IjM2Ij48VE5SZWYgUmVmSWQ9IjEiIC8+PFRvU3RyaW5nPk5vbmU8L1RvU3RyaW5nPjxJMzI+MDwvSTMyPjwvT2JqPjxPYmogTj0iTWVyZ2VEZWJ1ZyIgUmVmSWQ9IjM3Ij48VE5SZWYgUmVmSWQ9IjEiIC8+PFRvU3RyaW5nPk5vbmU8L1RvU3RyaW5nPjxJMzI+MDwvSTMyPjwvT2JqPjxPYmogTj0iTWVyZ2VJbmZvcm1hdGlvbiIgUmVmSWQ9IjM4Ij48VE5SZWYgUmVmSWQ9IjEiIC8+PFRvU3RyaW5nPk5vbmU8L1RvU3RyaW5nPjxJMzI+MDwvSTMyPjwvT2JqPjxPYmogTj0iQXJncyIgUmVmSWQ9IjM5Ij48VE5SZWYgUmVmSWQ9IjAiIC8+PExTVD48T2JqIFJlZklkPSI0MCI+PE1TPjxOaWwgTj0iTiIgLz48UyBOPSJWIj5hYmM8L1M+PC9NUz48L09iaj48L0xTVD48L09iaj48L01TPjwvT2JqPjwvTFNUPjwvT2JqPjxCIE49IklzTmVzdGVkIj5mYWxzZTwvQj48TmlsIE49Ikhpc3RvcnkiIC8+PEIgTj0iUmVkaXJlY3RTaGVsbEVycm9yT3V0cHV0UGlwZSI+dHJ1ZTwvQj48L01TPjwvT2JqPjxCIE49Ik5vSW5wdXQiPnRydWU8L0I+PE9iaiBOPSJBcGFydG1lbnRTdGF0ZSIgUmVmSWQ9IjQxIj48VE4gUmVmSWQ9IjIiPjxUPlN5c3RlbS5UaHJlYWRpbmcuQXBhcnRtZW50U3RhdGU8L1Q+PFQ+U3lzdGVtLkVudW08L1Q+PFQ+U3lzdGVtLlZhbHVlVHlwZTwvVD48VD5TeXN0ZW0uT2JqZWN0PC9UPjwvVE4+PFRvU3RyaW5nPlVua25vd248L1RvU3RyaW5nPjxJMzI+MjwvSTMyPjwvT2JqPjxPYmogTj0iUmVtb3RlU3RyZWFtT3B0aW9ucyIgUmVmSWQ9IjQyIj48VE4gUmVmSWQ9IjMiPjxUPlN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUmVtb3RlU3RyZWFtT3B0aW9uczwvVD48VD5TeXN0ZW0uRW51bTwvVD48VD5TeXN0ZW0uVmFsdWVUeXBlPC9UPjxUPlN5c3RlbS5PYmplY3Q8L1Q+PC9UTj48VG9TdHJpbmc+MDwvVG9TdHJpbmc+PEkzMj4wPC9JMzI+PC9PYmo+PEIgTj0iQWRkVG9IaXN0b3J5Ij50cnVlPC9CPjxPYmogTj0iSG9zdEluZm8iIFJlZklkPSI0MyI+PE1TPjxCIE49Il9pc0hvc3ROdWxsIj50cnVlPC9CPjxCIE49Il9pc0hvc3RVSU51bGwiPnRydWU8L0I+PEIgTj0iX2lzSG9zdFJhd1VJTnVsbCI+dHJ1ZTwvQj48QiBOPSJfdXNlUnVuc3BhY2VIb3N0Ij50cnVlPC9CPjwvTVM+PC9PYmo+PEIgTj0iSXNOZXN0ZWQiPmZhbHNlPC9CPjwvTVM+PC9PYmo+</Data>\r\n<DataAck PSGuid='aee41703-b405-44de-80db-92f06b8732a1' />\r\n<Data Stream='Default' PSGuid='aee41703-b405-44de-80db-92f06b8732a1'>AAAAAAAAAAUAAAAAAAAAAAMAAAA1AQAAAAQQBADvHgN7rfsBS5Cgs8Nefji+AxfkrgW03kSA25Lwa4cyoe+7vzxTPmFiYzwvUz4=</Data>\r\n\r\n########################\r\n### Decoded Messages ###\r\n########################\r\n\r\nType      : Data\r\nPSGuid    : 00000000-0000-0000-0000-000000000000\r\nStream    : Default\r\nFragments : ObjectID   : 1\r\n            FragmentID : 0\r\n            Start      : True\r\n            End        : True\r\n            Length     : 752\r\n\r\n            ObjectID   : 2\r\n            FragmentID : 0\r\n            Start      : True\r\n            End        : True\r\n            Length     : 3758\r\nMessages  : ObjectID    : 1\r\n            Destination : Server\r\n            MessageType : SESSION_CAPABILITY\r\n            RPID        : 7b031eef-fbad-4b01-90a0-b3c35e7e38be\r\n            PID         : 00000000-0000-0000-0000-000000000000\r\n            Object      : \r\n<Obj RefId=\"0\">\r\n  <MS>\r\n    <Version N=\"protocolversion\">2.3</Version>\r\n    <Version N=\"PSVersion\">2.0</Version>\r\n    <Version N=\"SerializationVersion\">1.1.0.1</Version>\r\n    <BA N=\"TimeZone\">AAEAAAD/////AQAAAAAAAAAEAQAAABxTeXN0ZW0uQ3VycmVudFN5c3RlbVRpbWVab25lBAAAABdtX0NhY2hlZERheWxpZ2h0Q2hhbmdlcw1tX3RpY2tzT2Zmc2V0Dm1fc3RhbmRhcmROYW1lDm1fZGF5bGlnaHROYW1lAwABARxTeXN0ZW0uQ29sbGVjdGlvbnMuSGFzaHRhYmxlCQkCAAAAABCs0VMAAAAKCgQCAAAAHFN5c3RlbS5Db2xsZWN0aW9ucy5IYXNodGFibGUHAAAACkxvYWRGYWN0b3IHVmVyc2lvbghDb21wYXJlchBIYXNoQ29kZVByb3ZpZGVyCEhhc2hTaXplBEtleXMGVmFsdWVzAAADAwAFBQsIHFN5c3RlbS5Db2xsZWN0aW9ucy5JQ29tcGFyZXIkU3lzdGVtLkNvbGxlY3Rpb25zLklIYXNoQ29kZVByb3ZpZGVyCOxROD8AAAAACgoDAAAACQMAAAAJBAAAABADAAAAAAAAABAEAAAAAAAAAAs=</BA>\r\n  </MS>\r\n</Obj>\r\n\r\n            ObjectID    : 2\r\n            Destination : Server\r\n            MessageType : INIT_RUNSPACEPOOL\r\n            RPID        : 7b031eef-fbad-4b01-90a0-b3c35e7e38be\r\n            PID         : 00000000-0000-0000-0000-000000000000\r\n            Object      : \r\n<Obj RefId=\"0\">\r\n  <MS>\r\n    <I32 N=\"MinRunspaces\">1</I32>\r\n    <I32 N=\"MaxRunspaces\">1</I32>\r\n    <Obj N=\"PSThreadOptions\" RefId=\"1\">\r\n      <TN RefId=\"0\">\r\n        <T>System.Management.Automation.Runspaces.PSThreadOptions</T>\r\n        <T>System.Enum</T>\r\n        <T>System.ValueType</T>\r\n        <T>System.Object</T>\r\n      </TN>\r\n      <ToString>Default</ToString>\r\n      <I32>0</I32>\r\n    </Obj>\r\n    <Obj N=\"ApartmentState\" RefId=\"2\">\r\n      <TN RefId=\"1\">\r\n        <T>System.Threading.ApartmentState</T>\r\n        <T>System.Enum</T>\r\n        <T>System.ValueType</T>\r\n        <T>System.Object</T>\r\n      </TN>\r\n      <ToString>Unknown</ToString>\r\n      <I32>2</I32>\r\n    </Obj>\r\n    <Obj N=\"ApplicationArguments\" RefId=\"3\">\r\n      <TN RefId=\"2\">\r\n        <T>System.Management.Automation.PSPrimitiveDictionary</T>\r\n        <T>System.Collections.Hashtable</T>\r\n        <T>System.Object</T>\r\n      </TN>\r\n      <DCT>\r\n        <En>\r\n          <S N=\"Key\">PSVersionTable</S>\r\n          <Obj N=\"Value\" RefId=\"4\">\r\n            <TNRef RefId=\"2\" />\r\n            <DCT>\r\n              <En>\r\n                <S N=\"Key\">PSVersion</S>\r\n                <Version N=\"Value\">5.1.17763.1852</Version>\r\n              </En>\r\n              <En>\r\n                <S N=\"Key\">PSEdition</S>\r\n                <S N=\"Value\">Desktop</S>\r\n              </En>\r\n              <En>\r\n                <S N=\"Key\">PSCompatibleVersions</S>\r\n                <Obj N=\"Value\" RefId=\"5\">\r\n                  <TN RefId=\"3\">\r\n                    <T>System.Version[]</T>\r\n                    <T>System.Array</T>\r\n                    <T>System.Object</T>\r\n                  </TN>\r\n                  <LST>\r\n                    <Version>1.0</Version>\r\n                    <Version>2.0</Version>\r\n                    <Version>3.0</Version>\r\n                    <Version>4.0</Version>\r\n                    <Version>5.0</Version>\r\n                    <Version>5.1.17763.1852</Version>\r\n                  </LST>\r\n                </Obj>\r\n              </En>\r\n              <En>\r\n                <S N=\"Key\">CLRVersion</S>\r\n                <Version N=\"Value\">4.0.30319.42000</Version>\r\n              </En>\r\n              <En>\r\n                <S N=\"Key\">BuildVersion</S>\r\n                <Version N=\"Value\">10.0.17763.1852</Version>\r\n              </En>\r\n              <En>\r\n                <S N=\"Key\">WSManStackVersion</S>\r\n                <Version N=\"Value\">3.0</Version>\r\n              </En>\r\n              <En>\r\n                <S N=\"Key\">PSRemotingProtocolVersion</S>\r\n                <Version N=\"Value\">2.3</Version>\r\n              </En>\r\n              <En>\r\n                <S N=\"Key\">SerializationVersion</S>\r\n                <Version N=\"Value\">1.1.0.1</Version>\r\n              </En>\r\n            </DCT>\r\n          </Obj>\r\n        </En>\r\n      </DCT>\r\n    </Obj>\r\n    <Obj N=\"HostInfo\" RefId=\"6\">\r\n      <MS>\r\n        <Obj N=\"_hostDefaultData\" RefId=\"7\">\r\n          <MS>\r\n            <Obj N=\"data\" RefId=\"8\">\r\n              <TN RefId=\"4\">\r\n                <T>System.Collections.Hashtable</T>\r\n                <T>System.Object</T>\r\n              </TN>\r\n              <DCT>\r\n                <En>\r\n                  <I32 N=\"Key\">9</I32>\r\n                  <Obj N=\"Value\" RefId=\"9\">\r\n                    <MS>\r\n                      <S N=\"T\">System.String</S>\r\n                      <S N=\"V\">C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe.orig</S>\r\n                    </MS>\r\n                  </Obj>\r\n                </En>\r\n                <En>\r\n                  <I32 N=\"Key\">8</I32>\r\n                  <Obj N=\"Value\" RefId=\"10\">\r\n                    <MS>\r\n                      <S N=\"T\">System.Management.Automation.Host.Size</S>\r\n                      <Obj N=\"V\" RefId=\"11\">\r\n                        <MS>\r\n                          <I32 N=\"width\">634</I32>\r\n                          <I32 N=\"height\">81</I32>\r\n                        </MS>\r\n                      </Obj>\r\n                    </MS>\r\n                  </Obj>\r\n                </En>\r\n                <En>\r\n                  <I32 N=\"Key\">7</I32>\r\n                  <Obj N=\"Value\" RefId=\"12\">\r\n                    <MS>\r\n                      <S N=\"T\">System.Management.Automation.Host.Size</S>\r\n                      <Obj N=\"V\" RefId=\"13\">\r\n                        <MS>\r\n                          <I32 N=\"width\">120</I32>\r\n                          <I32 N=\"height\">81</I32>\r\n                        </MS>\r\n                      </Obj>\r\n                    </MS>\r\n                  </Obj>\r\n                </En>\r\n                <En>\r\n                  <I32 N=\"Key\">6</I32>\r\n                  <Obj N=\"Value\" RefId=\"14\">\r\n                    <MS>\r\n                      <S N=\"T\">System.Management.Automation.Host.Size</S>\r\n                      <Obj N=\"V\" RefId=\"15\">\r\n                        <MS>\r\n                          <I32 N=\"width\">120</I32>\r\n                          <I32 N=\"height\">30</I32>\r\n                        </MS>\r\n                      </Obj>\r\n                    </MS>\r\n                  </Obj>\r\n                </En>\r\n                <En>\r\n                  <I32 N=\"Key\">5</I32>\r\n                  <Obj N=\"Value\" RefId=\"16\">\r\n                    <MS>\r\n                      <S N=\"T\">System.Management.Automation.Host.Size</S>\r\n                      <Obj N=\"V\" RefId=\"17\">\r\n                        <MS>\r\n                          <I32 N=\"width\">120</I32>\r\n                          <I32 N=\"height\">9001</I32>\r\n                        </MS>\r\n                      </Obj>\r\n                    </MS>\r\n                  </Obj>\r\n                </En>\r\n                <En>\r\n                  <I32 N=\"Key\">4</I32>\r\n                  <Obj N=\"Value\" RefId=\"18\">\r\n                    <MS>\r\n                      <S N=\"T\">System.Int32</S>\r\n                      <I32 N=\"V\">25</I32>\r\n                    </MS>\r\n                  </Obj>\r\n                </En>\r\n                <En>\r\n                  <I32 N=\"Key\">3</I32>\r\n                  <Obj N=\"Value\" RefId=\"19\">\r\n                    <MS>\r\n                      <S N=\"T\">System.Management.Automation.Host.Coordinates</S>\r\n                      <Obj N=\"V\" RefId=\"20\">\r\n                        <MS>\r\n                          <I32 N=\"x\">0</I32>\r\n                          <I32 N=\"y\">0</I32>\r\n                        </MS>\r\n                      </Obj>\r\n                    </MS>\r\n                  </Obj>\r\n                </En>\r\n                <En>\r\n                  <I32 N=\"Key\">2</I32>\r\n                  <Obj N=\"Value\" RefId=\"21\">\r\n                    <MS>\r\n                      <S N=\"T\">System.Management.Automation.Host.Coordinates</S>\r\n                      <Obj N=\"V\" RefId=\"22\">\r\n                        <MS>\r\n                          <I32 N=\"x\">0</I32>\r\n                          <I32 N=\"y\">0</I32>\r\n                        </MS>\r\n                      </Obj>\r\n                    </MS>\r\n                  </Obj>\r\n                </En>\r\n                <En>\r\n                  <I32 N=\"Key\">1</I32>\r\n                  <Obj N=\"Value\" RefId=\"23\">\r\n                    <MS>\r\n                      <S N=\"T\">System.ConsoleColor</S>\r\n                      <I32 N=\"V\">0</I32>\r\n                    </MS>\r\n                  </Obj>\r\n                </En>\r\n                <En>\r\n                  <I32 N=\"Key\">0</I32>\r\n                  <Obj N=\"Value\" RefId=\"24\">\r\n                    <MS>\r\n                      <S N=\"T\">System.ConsoleColor</S>\r\n                      <I32 N=\"V\">7</I32>\r\n                    </MS>\r\n                  </Obj>\r\n                </En>\r\n              </DCT>\r\n            </Obj>\r\n          </MS>\r\n        </Obj>\r\n        <B N=\"_isHostNull\">false</B>\r\n        <B N=\"_isHostUINull\">false</B>\r\n        <B N=\"_isHostRawUINull\">false</B>\r\n        <B N=\"_useRunspaceHost\">false</B>\r\n      </MS>\r\n    </Obj>\r\n  </MS>\r\n</Obj>\r\n\r\nType      : Data\r\nPSGuid    : 00000000-0000-0000-0000-000000000000\r\nStream    : Default\r\nFragments : ObjectID   : 1\r\n            FragmentID : 0\r\n            Start      : True\r\n            End        : True\r\n            Length     : 202\r\nMessages  : ObjectID    : 1\r\n            Destination : Client\r\n            MessageType : SESSION_CAPABILITY\r\n            RPID        : 00000000-0000-0000-0000-000000000000\r\n            PID         : 00000000-0000-0000-0000-000000000000\r\n            Object      : \r\n<Obj RefId=\"0\">\r\n  <MS>\r\n    <Version N=\"protocolversion\">2.3</Version>\r\n    <Version N=\"PSVersion\">2.0</Version>\r\n    <Version N=\"SerializationVersion\">1.1.0.1</Version>\r\n  </MS>\r\n</Obj>\r\n\r\nType      : Data\r\nPSGuid    : 00000000-0000-0000-0000-000000000000\r\nStream    : Default\r\nFragments : ObjectID   : 2\r\n            FragmentID : 0\r\n            Start      : True\r\n            End        : True\r\n            Length     : 1496\r\nMessages  : ObjectID    : 2\r\n            Destination : Client\r\n            MessageType : APPLICATION_PRIVATE_DATA\r\n            RPID        : 7b031eef-fbad-4b01-90a0-b3c35e7e38be\r\n            PID         : 00000000-0000-0000-0000-000000000000\r\n            Object      : \r\n<Obj RefId=\"0\">\r\n  <MS>\r\n    <Obj N=\"ApplicationPrivateData\" RefId=\"1\">\r\n      <TN RefId=\"0\">\r\n        <T>System.Management.Automation.PSPrimitiveDictionary</T>\r\n        <T>System.Collections.Hashtable</T>\r\n        <T>System.Object</T>\r\n      </TN>\r\n      <DCT>\r\n        <En>\r\n          <S N=\"Key\">BreakAll</S>\r\n          <B N=\"Value\">false</B>\r\n        </En>\r\n        <En>\r\n          <S N=\"Key\">DebugStop</S>\r\n          <B N=\"Value\">false</B>\r\n        </En>\r\n        <En>\r\n          <S N=\"Key\">UnhandledBreakpointMode</S>\r\n          <I32 N=\"Value\">1</I32>\r\n        </En>\r\n        <En>\r\n          <S N=\"Key\">PSVersionTable</S>\r\n          <Obj N=\"Value\" RefId=\"2\">\r\n            <TNRef RefId=\"0\" />\r\n            <DCT>\r\n              <En>\r\n                <S N=\"Key\">PSVersion</S>\r\n                <Version N=\"Value\">5.1.17763.1852</Version>\r\n              </En>\r\n              <En>\r\n                <S N=\"Key\">PSEdition</S>\r\n                <S N=\"Value\">Desktop</S>\r\n              </En>\r\n              <En>\r\n                <S N=\"Key\">PSCompatibleVersions</S>\r\n                <Obj N=\"Value\" RefId=\"3\">\r\n                  <TN RefId=\"1\">\r\n                    <T>System.Version[]</T>\r\n                    <T>System.Array</T>\r\n                    <T>System.Object</T>\r\n                  </TN>\r\n                  <LST>\r\n                    <Version>1.0</Version>\r\n                    <Version>2.0</Version>\r\n                    <Version>3.0</Version>\r\n                    <Version>4.0</Version>\r\n                    <Version>5.0</Version>\r\n                    <Version>5.1.17763.1852</Version>\r\n                  </LST>\r\n                </Obj>\r\n              </En>\r\n              <En>\r\n                <S N=\"Key\">CLRVersion</S>\r\n                <Version N=\"Value\">4.0.30319.42000</Version>\r\n              </En>\r\n              <En>\r\n                <S N=\"Key\">BuildVersion</S>\r\n                <Version N=\"Value\">10.0.17763.1852</Version>\r\n              </En>\r\n              <En>\r\n                <S N=\"Key\">WSManStackVersion</S>\r\n                <Version N=\"Value\">3.0</Version>\r\n              </En>\r\n              <En>\r\n                <S N=\"Key\">PSRemotingProtocolVersion</S>\r\n                <Version N=\"Value\">2.3</Version>\r\n              </En>\r\n              <En>\r\n                <S N=\"Key\">SerializationVersion</S>\r\n                <Version N=\"Value\">1.1.0.1</Version>\r\n              </En>\r\n            </DCT>\r\n          </Obj>\r\n        </En>\r\n        <En>\r\n          <S N=\"Key\">DebugMode</S>\r\n          <I32 N=\"Value\">1</I32>\r\n        </En>\r\n        <En>\r\n          <S N=\"Key\">DebugBreakpointCount</S>\r\n          <I32 N=\"Value\">0</I32>\r\n        </En>\r\n      </DCT>\r\n    </Obj>\r\n  </MS>\r\n</Obj>\r\n\r\nType      : Data\r\nPSGuid    : 00000000-0000-0000-0000-000000000000\r\nStream    : Default\r\nFragments : ObjectID   : 3\r\n            FragmentID : 0\r\n            Start      : True\r\n            End        : True\r\n            Length     : 103\r\nMessages  : ObjectID    : 3\r\n            Destination : Client\r\n            MessageType : RUNSPACEPOOL_STATE\r\n            RPID        : 7b031eef-fbad-4b01-90a0-b3c35e7e38be\r\n            PID         : 00000000-0000-0000-0000-000000000000\r\n            Object      : \r\n<Obj RefId=\"0\">\r\n  <MS>\r\n    <I32 N=\"RunspaceState\">2</I32>\r\n  </MS>\r\n</Obj>\r\n\r\nType      : DataAck\r\nPSGuid    : 00000000-0000-0000-0000-000000000000\r\nStream    : \r\nFragments : \r\nMessages  : \r\n\r\nType      : Command\r\nPSGuid    : 383eceb0-2697-4b4d-941d-f3f8170fac69\r\nStream    : \r\nFragments : \r\nMessages  : \r\n\r\nType      : CommandAck\r\nPSGuid    : 383eceb0-2697-4b4d-941d-f3f8170fac69\r\nStream    : \r\nFragments : \r\nMessages  : \r\n\r\nType      : Data\r\nPSGuid    : 383eceb0-2697-4b4d-941d-f3f8170fac69\r\nStream    : Default\r\nFragments : ObjectID   : 3\r\n            FragmentID : 0\r\n            Start      : True\r\n            End        : True\r\n            Length     : 2459\r\nMessages  : ObjectID    : 3\r\n            Destination : Server\r\n            MessageType : CREATE_PIPELINE\r\n            RPID        : 7b031eef-fbad-4b01-90a0-b3c35e7e38be\r\n            PID         : 383eceb0-2697-4b4d-941d-f3f8170fac69\r\n            Object      : \r\n<Obj RefId=\"0\">\r\n  <MS>\r\n    <Obj N=\"PowerShell\" RefId=\"1\">\r\n      <MS>\r\n        <Obj N=\"Cmds\" RefId=\"2\">\r\n          <TN RefId=\"0\">\r\n            <T>System.Collections.Generic.List`1[[System.Management.Automation.PSObject, System.Management.Automation, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35]]</T>\r\n            <T>System.Object</T>\r\n          </TN>\r\n          <LST>\r\n            <Obj RefId=\"3\">\r\n              <MS>\r\n                <S N=\"Cmd\">__Set-PSDebugMode</S>\r\n                <B N=\"IsScript\">false</B>\r\n                <Nil N=\"UseLocalScope\" />\r\n                <Obj N=\"MergeMyResult\" RefId=\"4\">\r\n                  <TN RefId=\"1\">\r\n                    <T>System.Management.Automation.Runspaces.PipelineResultTypes</T>\r\n                    <T>System.Enum</T>\r\n                    <T>System.ValueType</T>\r\n                    <T>System.Object</T>\r\n                  </TN>\r\n                  <ToString>None</ToString>\r\n                  <I32>0</I32>\r\n                </Obj>\r\n                <Obj N=\"MergeToResult\" RefId=\"5\">\r\n                  <TNRef RefId=\"1\" />\r\n                  <ToString>None</ToString>\r\n                  <I32>0</I32>\r\n                </Obj>\r\n                <Obj N=\"MergePreviousResults\" RefId=\"6\">\r\n                  <TNRef RefId=\"1\" />\r\n                  <ToString>None</ToString>\r\n                  <I32>0</I32>\r\n                </Obj>\r\n                <Obj N=\"MergeError\" RefId=\"7\">\r\n                  <TNRef RefId=\"1\" />\r\n                  <ToString>None</ToString>\r\n                  <I32>0</I32>\r\n                </Obj>\r\n                <Obj N=\"MergeWarning\" RefId=\"8\">\r\n                  <TNRef RefId=\"1\" />\r\n                  <ToString>None</ToString>\r\n                  <I32>0</I32>\r\n                </Obj>\r\n                <Obj N=\"MergeVerbose\" RefId=\"9\">\r\n                  <TNRef RefId=\"1\" />\r\n                  <ToString>None</ToString>\r\n                  <I32>0</I32>\r\n                </Obj>\r\n                <Obj N=\"MergeDebug\" RefId=\"10\">\r\n                  <TNRef RefId=\"1\" />\r\n                  <ToString>None</ToString>\r\n                  <I32>0</I32>\r\n                </Obj>\r\n                <Obj N=\"MergeInformation\" RefId=\"11\">\r\n                  <TNRef RefId=\"1\" />\r\n                  <ToString>None</ToString>\r\n                  <I32>0</I32>\r\n                </Obj>\r\n                <Obj N=\"Args\" RefId=\"12\">\r\n                  <TNRef RefId=\"0\" />\r\n                  <LST>\r\n                    <Obj RefId=\"13\">\r\n                      <MS>\r\n                        <S N=\"N\">Mode</S>\r\n                        <Obj N=\"V\" RefId=\"14\">\r\n                          <TN RefId=\"2\">\r\n                            <T>System.Management.Automation.DebugModes</T>\r\n                            <T>System.Enum</T>\r\n                            <T>System.ValueType</T>\r\n                            <T>System.Object</T>\r\n                          </TN>\r\n                          <ToString>LocalScript, RemoteScript</ToString>\r\n                          <I32>6</I32>\r\n                        </Obj>\r\n                      </MS>\r\n                    </Obj>\r\n                  </LST>\r\n                </Obj>\r\n              </MS>\r\n            </Obj>\r\n          </LST>\r\n        </Obj>\r\n        <B N=\"IsNested\">false</B>\r\n        <Nil N=\"History\" />\r\n        <B N=\"RedirectShellErrorOutputPipe\">true</B>\r\n      </MS>\r\n    </Obj>\r\n    <B N=\"NoInput\">true</B>\r\n    <Obj N=\"ApartmentState\" RefId=\"15\">\r\n      <TN RefId=\"3\">\r\n        <T>System.Threading.ApartmentState</T>\r\n        <T>System.Enum</T>\r\n        <T>System.ValueType</T>\r\n        <T>System.Object</T>\r\n      </TN>\r\n      <ToString>Unknown</ToString>\r\n      <I32>2</I32>\r\n    </Obj>\r\n    <Obj N=\"RemoteStreamOptions\" RefId=\"16\">\r\n      <TN RefId=\"4\">\r\n        <T>System.Management.Automation.RemoteStreamOptions</T>\r\n        <T>System.Enum</T>\r\n        <T>System.ValueType</T>\r\n        <T>System.Object</T>\r\n      </TN>\r\n      <ToString>AddInvocationInfo</ToString>\r\n      <I32>15</I32>\r\n    </Obj>\r\n    <B N=\"AddToHistory\">false</B>\r\n    <Obj N=\"HostInfo\" RefId=\"17\">\r\n      <MS>\r\n        <B N=\"_isHostNull\">true</B>\r\n        <B N=\"_isHostUINull\">true</B>\r\n        <B N=\"_isHostRawUINull\">true</B>\r\n        <B N=\"_useRunspaceHost\">true</B>\r\n      </MS>\r\n    </Obj>\r\n    <B N=\"IsNested\">false</B>\r\n  </MS>\r\n</Obj>\r\n\r\nType      : DataAck\r\nPSGuid    : 383eceb0-2697-4b4d-941d-f3f8170fac69\r\nStream    : \r\nFragments : \r\nMessages  : \r\n\r\nType      : Data\r\nPSGuid    : 383eceb0-2697-4b4d-941d-f3f8170fac69\r\nStream    : Default\r\nFragments : ObjectID   : 4\r\n            FragmentID : 0\r\n            Start      : True\r\n            End        : True\r\n            Length     : 103\r\nMessages  : ObjectID    : 4\r\n            Destination : Client\r\n            MessageType : PIPELINE_STATE\r\n            RPID        : 7b031eef-fbad-4b01-90a0-b3c35e7e38be\r\n            PID         : 383eceb0-2697-4b4d-941d-f3f8170fac69\r\n            Object      : \r\n<Obj RefId=\"0\">\r\n  <MS>\r\n    <I32 N=\"PipelineState\">4</I32>\r\n  </MS>\r\n</Obj>\r\n\r\nType      : Close\r\nPSGuid    : 383eceb0-2697-4b4d-941d-f3f8170fac69\r\nStream    : \r\nFragments : \r\nMessages  : \r\n\r\nType      : CloseAck\r\nPSGuid    : 383eceb0-2697-4b4d-941d-f3f8170fac69\r\nStream    : \r\nFragments : \r\nMessages  : \r\n\r\nType      : Command\r\nPSGuid    : aee41703-b405-44de-80db-92f06b8732a1\r\nStream    : \r\nFragments : \r\nMessages  : \r\n\r\nType      : CommandAck\r\nPSGuid    : aee41703-b405-44de-80db-92f06b8732a1\r\nStream    : \r\nFragments : \r\nMessages  : \r\n\r\nType      : Data\r\nPSGuid    : aee41703-b405-44de-80db-92f06b8732a1\r\nStream    : Default\r\nFragments : ObjectID   : 4\r\n            FragmentID : 0\r\n            Start      : True\r\n            End        : True\r\n            Length     : 4464\r\nMessages  : ObjectID    : 4\r\n            Destination : Server\r\n            MessageType : CREATE_PIPELINE\r\n            RPID        : 7b031eef-fbad-4b01-90a0-b3c35e7e38be\r\n            PID         : aee41703-b405-44de-80db-92f06b8732a1\r\n            Object      : \r\n<Obj RefId=\"0\">\r\n  <MS>\r\n    <Obj N=\"PowerShell\" RefId=\"1\">\r\n      <MS>\r\n        <Obj N=\"ExtraCmds\" RefId=\"2\">\r\n          <TN RefId=\"0\">\r\n            <T>System.Collections.Generic.List`1[[System.Management.Automation.PSObject, System.Management.Automation, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35]]</T>\r\n            <T>System.Object</T>\r\n          </TN>\r\n          <LST>\r\n            <Obj RefId=\"3\">\r\n              <MS>\r\n                <Obj N=\"Cmds\" RefId=\"4\">\r\n                  <TNRef RefId=\"0\" />\r\n                  <LST>\r\n                    <Obj RefId=\"5\">\r\n                      <MS>\r\n                        <S N=\"Cmd\">echo</S>\r\n                        <B N=\"IsScript\">false</B>\r\n                        <Nil N=\"UseLocalScope\" />\r\n                        <Obj N=\"MergeMyResult\" RefId=\"6\">\r\n                          <TN RefId=\"1\">\r\n                            <T>System.Management.Automation.Runspaces.PipelineResultTypes</T>\r\n                            <T>System.Enum</T>\r\n                            <T>System.ValueType</T>\r\n                            <T>System.Object</T>\r\n                          </TN>\r\n                          <ToString>None</ToString>\r\n                          <I32>0</I32>\r\n                        </Obj>\r\n                        <Obj N=\"MergeToResult\" RefId=\"7\">\r\n                          <TNRef RefId=\"1\" />\r\n                          <ToString>None</ToString>\r\n                          <I32>0</I32>\r\n                        </Obj>\r\n                        <Obj N=\"MergePreviousResults\" RefId=\"8\">\r\n                          <TNRef RefId=\"1\" />\r\n                          <ToString>None</ToString>\r\n                          <I32>0</I32>\r\n                        </Obj>\r\n                        <Obj N=\"MergeError\" RefId=\"9\">\r\n                          <TNRef RefId=\"1\" />\r\n                          <ToString>None</ToString>\r\n                          <I32>0</I32>\r\n                        </Obj>\r\n                        <Obj N=\"MergeWarning\" RefId=\"10\">\r\n                          <TNRef RefId=\"1\" />\r\n                          <ToString>None</ToString>\r\n                          <I32>0</I32>\r\n                        </Obj>\r\n                        <Obj N=\"MergeVerbose\" RefId=\"11\">\r\n                          <TNRef RefId=\"1\" />\r\n                          <ToString>None</ToString>\r\n                          <I32>0</I32>\r\n                        </Obj>\r\n                        <Obj N=\"MergeDebug\" RefId=\"12\">\r\n                          <TNRef RefId=\"1\" />\r\n                          <ToString>None</ToString>\r\n                          <I32>0</I32>\r\n                        </Obj>\r\n                        <Obj N=\"MergeInformation\" RefId=\"13\">\r\n                          <TNRef RefId=\"1\" />\r\n                          <ToString>None</ToString>\r\n                          <I32>0</I32>\r\n                        </Obj>\r\n                        <Obj N=\"Args\" RefId=\"14\">\r\n                          <TNRef RefId=\"0\" />\r\n                          <LST>\r\n                            <Obj RefId=\"15\">\r\n                              <MS>\r\n                                <Nil N=\"N\" />\r\n                                <S N=\"V\">abc</S>\r\n                              </MS>\r\n                            </Obj>\r\n                          </LST>\r\n                        </Obj>\r\n                      </MS>\r\n                    </Obj>\r\n                  </LST>\r\n                </Obj>\r\n              </MS>\r\n            </Obj>\r\n            <Obj RefId=\"16\">\r\n              <MS>\r\n                <Obj N=\"Cmds\" RefId=\"17\">\r\n                  <TNRef RefId=\"0\" />\r\n                  <LST>\r\n                    <Obj RefId=\"18\">\r\n                      <MS>\r\n                        <S N=\"Cmd\">sleep</S>\r\n                        <B N=\"IsScript\">false</B>\r\n                        <Nil N=\"UseLocalScope\" />\r\n                        <Obj N=\"MergeMyResult\" RefId=\"19\">\r\n                          <TNRef RefId=\"1\" />\r\n                          <ToString>None</ToString>\r\n                          <I32>0</I32>\r\n                        </Obj>\r\n                        <Obj N=\"MergeToResult\" RefId=\"20\">\r\n                          <TNRef RefId=\"1\" />\r\n                          <ToString>None</ToString>\r\n                          <I32>0</I32>\r\n                        </Obj>\r\n                        <Obj N=\"MergePreviousResults\" RefId=\"21\">\r\n                          <TNRef RefId=\"1\" />\r\n                          <ToString>None</ToString>\r\n                          <I32>0</I32>\r\n                        </Obj>\r\n                        <Obj N=\"MergeError\" RefId=\"22\">\r\n                          <TNRef RefId=\"1\" />\r\n                          <ToString>None</ToString>\r\n                          <I32>0</I32>\r\n                        </Obj>\r\n                        <Obj N=\"MergeWarning\" RefId=\"23\">\r\n                          <TNRef RefId=\"1\" />\r\n                          <ToString>None</ToString>\r\n                          <I32>0</I32>\r\n                        </Obj>\r\n                        <Obj N=\"MergeVerbose\" RefId=\"24\">\r\n                          <TNRef RefId=\"1\" />\r\n                          <ToString>None</ToString>\r\n                          <I32>0</I32>\r\n                        </Obj>\r\n                        <Obj N=\"MergeDebug\" RefId=\"25\">\r\n                          <TNRef RefId=\"1\" />\r\n                          <ToString>None</ToString>\r\n                          <I32>0</I32>\r\n                        </Obj>\r\n                        <Obj N=\"MergeInformation\" RefId=\"26\">\r\n                          <TNRef RefId=\"1\" />\r\n                          <ToString>None</ToString>\r\n                          <I32>0</I32>\r\n                        </Obj>\r\n                        <Obj N=\"Args\" RefId=\"27\">\r\n                          <TNRef RefId=\"0\" />\r\n                          <LST>\r\n                            <Obj RefId=\"28\">\r\n                              <MS>\r\n                                <Nil N=\"N\" />\r\n                                <I32 N=\"V\">10</I32>\r\n                              </MS>\r\n                            </Obj>\r\n                          </LST>\r\n                        </Obj>\r\n                      </MS>\r\n                    </Obj>\r\n                  </LST>\r\n                </Obj>\r\n              </MS>\r\n            </Obj>\r\n          </LST>\r\n        </Obj>\r\n        <Obj N=\"Cmds\" RefId=\"29\">\r\n          <TNRef RefId=\"0\" />\r\n          <LST>\r\n            <Obj RefId=\"30\">\r\n              <MS>\r\n                <S N=\"Cmd\">echo</S>\r\n                <B N=\"IsScript\">false</B>\r\n                <Nil N=\"UseLocalScope\" />\r\n                <Obj N=\"MergeMyResult\" RefId=\"31\">\r\n                  <TNRef RefId=\"1\" />\r\n                  <ToString>None</ToString>\r\n                  <I32>0</I32>\r\n                </Obj>\r\n                <Obj N=\"MergeToResult\" RefId=\"32\">\r\n                  <TNRef RefId=\"1\" />\r\n                  <ToString>None</ToString>\r\n                  <I32>0</I32>\r\n                </Obj>\r\n                <Obj N=\"MergePreviousResults\" RefId=\"33\">\r\n                  <TNRef RefId=\"1\" />\r\n                  <ToString>None</ToString>\r\n                  <I32>0</I32>\r\n                </Obj>\r\n                <Obj N=\"MergeError\" RefId=\"34\">\r\n                  <TNRef RefId=\"1\" />\r\n                  <ToString>None</ToString>\r\n                  <I32>0</I32>\r\n                </Obj>\r\n                <Obj N=\"MergeWarning\" RefId=\"35\">\r\n                  <TNRef RefId=\"1\" />\r\n                  <ToString>None</ToString>\r\n                  <I32>0</I32>\r\n                </Obj>\r\n                <Obj N=\"MergeVerbose\" RefId=\"36\">\r\n                  <TNRef RefId=\"1\" />\r\n                  <ToString>None</ToString>\r\n                  <I32>0</I32>\r\n                </Obj>\r\n                <Obj N=\"MergeDebug\" RefId=\"37\">\r\n                  <TNRef RefId=\"1\" />\r\n                  <ToString>None</ToString>\r\n                  <I32>0</I32>\r\n                </Obj>\r\n                <Obj N=\"MergeInformation\" RefId=\"38\">\r\n                  <TNRef RefId=\"1\" />\r\n                  <ToString>None</ToString>\r\n                  <I32>0</I32>\r\n                </Obj>\r\n                <Obj N=\"Args\" RefId=\"39\">\r\n                  <TNRef RefId=\"0\" />\r\n                  <LST>\r\n                    <Obj RefId=\"40\">\r\n                      <MS>\r\n                        <Nil N=\"N\" />\r\n                        <S N=\"V\">abc</S>\r\n                      </MS>\r\n                    </Obj>\r\n                  </LST>\r\n                </Obj>\r\n              </MS>\r\n            </Obj>\r\n          </LST>\r\n        </Obj>\r\n        <B N=\"IsNested\">false</B>\r\n        <Nil N=\"History\" />\r\n        <B N=\"RedirectShellErrorOutputPipe\">true</B>\r\n      </MS>\r\n    </Obj>\r\n    <B N=\"NoInput\">true</B>\r\n    <Obj N=\"ApartmentState\" RefId=\"41\">\r\n      <TN RefId=\"2\">\r\n        <T>System.Threading.ApartmentState</T>\r\n        <T>System.Enum</T>\r\n        <T>System.ValueType</T>\r\n        <T>System.Object</T>\r\n      </TN>\r\n      <ToString>Unknown</ToString>\r\n      <I32>2</I32>\r\n    </Obj>\r\n    <Obj N=\"RemoteStreamOptions\" RefId=\"42\">\r\n      <TN RefId=\"3\">\r\n        <T>System.Management.Automation.RemoteStreamOptions</T>\r\n        <T>System.Enum</T>\r\n        <T>System.ValueType</T>\r\n        <T>System.Object</T>\r\n      </TN>\r\n      <ToString>0</ToString>\r\n      <I32>0</I32>\r\n    </Obj>\r\n    <B N=\"AddToHistory\">true</B>\r\n    <Obj N=\"HostInfo\" RefId=\"43\">\r\n      <MS>\r\n        <B N=\"_isHostNull\">true</B>\r\n        <B N=\"_isHostUINull\">true</B>\r\n        <B N=\"_isHostRawUINull\">true</B>\r\n        <B N=\"_useRunspaceHost\">true</B>\r\n      </MS>\r\n    </Obj>\r\n    <B N=\"IsNested\">false</B>\r\n  </MS>\r\n</Obj>\r\n\r\nType      : DataAck\r\nPSGuid    : aee41703-b405-44de-80db-92f06b8732a1\r\nStream    : \r\nFragments : \r\nMessages  : \r\n\r\nType      : Data\r\nPSGuid    : aee41703-b405-44de-80db-92f06b8732a1\r\nStream    : Default\r\nFragments : ObjectID   : 5\r\n            FragmentID : 0\r\n            Start      : True\r\n            End        : True\r\n            Length     : 53\r\nMessages  : ObjectID    : 5\r\n            Destination : Client\r\n            MessageType : PIPELINE_OUTPUT\r\n            RPID        : 7b031eef-fbad-4b01-90a0-b3c35e7e38be\r\n            PID         : aee41703-b405-44de-80db-92f06b8732a1\r\n            Object      : \r\n<S>abc</S>\r\n```\r\n</details>\r\n\r\nThe exchange I'm running over SSH with the same process parameters is pretty much the same workflow but as per the above, doesn't get any further responses after the first `DataAck` once the Runspace Pool has been set up\r\n\r\n<details>\r\n  <summary>Exchange over SSH with my client</summary>\r\n  \r\n```\r\n###########################\r\n### Raw Stream Messages ###\r\n###########################\r\n\r\n<Data Stream='Default' PSGuid='00000000-0000-0000-0000-000000000000'>AAAAAAAAAAEAAAAAAAAAAAMAAADHAgAAAAIAAQC12a7gRFlsRILcuT7Hhe5TAAAAAAAAAAAAAAAAAAAAADxPYmogUmVmSWQ9IjAiPjxNUz48VmVyc2lvbiBOPSJQU1ZlcnNpb24iPjIuMDwvVmVyc2lvbj48VmVyc2lvbiBOPSJwcm90b2NvbHZlcnNpb24iPjIuMzwvVmVyc2lvbj48VmVyc2lvbiBOPSJTZXJpYWxpemF0aW9uVmVyc2lvbiI+MS4xLjAuMTwvVmVyc2lvbj48L01TPjwvT2JqPgAAAAAAAAACAAAAAAAAAAADAAADggIAAAAEAAEAtdmu4ERZbESC3Lk+x4XuUwAAAAAAAAAAAAAAAAAAAAA8T2JqIFJlZklkPSIwIj48TVM+PEkzMiBOPSJNaW5SdW5zcGFjZXMiPjE8L0kzMj48STMyIE49Ik1heFJ1bnNwYWNlcyI+MTwvSTMyPjxPYmogUmVmSWQ9IjEiIE49IlBTVGhyZWFkT3B0aW9ucyI+PEkzMj4wPC9JMzI+PFROIFJlZklkPSIwIj48VD5TeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlJ1bnNwYWNlcy5QU1RocmVhZE9wdGlvbnM8L1Q+PFQ+U3lzdGVtLkVudW08L1Q+PFQ+U3lzdGVtLlZhbHVlVHlwZTwvVD48VD5TeXN0ZW0uT2JqZWN0PC9UPjwvVE4+PFRvU3RyaW5nPkRlZmF1bHQ8L1RvU3RyaW5nPjwvT2JqPjxPYmogUmVmSWQ9IjIiIE49IkFwYXJ0bWVudFN0YXRlIj48STMyPjI8L0kzMj48VE4gUmVmSWQ9IjEiPjxUPlN5c3RlbS5UaHJlYWRpbmcuQXBhcnRtZW50U3RhdGU8L1Q+PFQ+U3lzdGVtLkVudW08L1Q+PFQ+U3lzdGVtLlZhbHVlVHlwZTwvVD48VD5TeXN0ZW0uT2JqZWN0PC9UPjwvVE4+PFRvU3RyaW5nPlVua25vd248L1RvU3RyaW5nPjwvT2JqPjxPYmogUmVmSWQ9IjMiIE49Ikhvc3RJbmZvIj48TVM+PEIgTj0iX2lzSG9zdE51bGwiPmZhbHNlPC9CPjxCIE49Il9pc0hvc3RVSU51bGwiPmZhbHNlPC9CPjxCIE49Il9pc0hvc3RSYXdVSU51bGwiPnRydWU8L0I+PEIgTj0iX3VzZVJ1bnNwYWNlSG9zdCI+ZmFsc2U8L0I+PC9NUz48L09iaj48T2JqIFJlZklkPSI0IiBOPSJBcHBsaWNhdGlvbkFyZ3VtZW50cyI+PFROIFJlZklkPSIyIj48VD5TeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTUHJpbWl0aXZlRGljdGlvbmFyeTwvVD48VD5TeXN0ZW0uQ29sbGVjdGlvbnMuSGFzaHRhYmxlPC9UPjxUPlN5c3RlbS5PYmplY3Q8L1Q+PC9UTj48RENUIC8+PC9PYmo+PC9NUz48L09iaj4=</Data>\r\n<Data Stream='Default' PSGuid='00000000-0000-0000-0000-000000000000'>AAAAAAAAAAEAAAAAAAAAAAMAAADKAQAAAAIAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAO+7vzxPYmogUmVmSWQ9IjAiPjxNUz48VmVyc2lvbiBOPSJwcm90b2NvbHZlcnNpb24iPjIuMzwvVmVyc2lvbj48VmVyc2lvbiBOPSJQU1ZlcnNpb24iPjIuMDwvVmVyc2lvbj48VmVyc2lvbiBOPSJTZXJpYWxpemF0aW9uVmVyc2lvbiI+MS4xLjAuMTwvVmVyc2lvbj48L01TPjwvT2JqPg==</Data>\r\n<Data Stream='Default' PSGuid='00000000-0000-0000-0000-000000000000'>AAAAAAAAAAIAAAAAAAAAAAMAAASqAQAAAAkQAgC12a7gRFlsRILcuT7Hhe5TAAAAAAAAAAAAAAAAAAAAAO+7vzxPYmogUmVmSWQ9IjAiPjxNUz48T2JqIE49IkFwcGxpY2F0aW9uUHJpdmF0ZURhdGEiIFJlZklkPSIxIj48VE4gUmVmSWQ9IjAiPjxUPlN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNQcmltaXRpdmVEaWN0aW9uYXJ5PC9UPjxUPlN5c3RlbS5Db2xsZWN0aW9ucy5IYXNodGFibGU8L1Q+PFQ+U3lzdGVtLk9iamVjdDwvVD48L1ROPjxEQ1Q+PEVuPjxTIE49IktleSI+UFNWZXJzaW9uVGFibGU8L1M+PE9iaiBOPSJWYWx1ZSIgUmVmSWQ9IjIiPjxUTlJlZiBSZWZJZD0iMCIgLz48RENUPjxFbj48UyBOPSJLZXkiPlBTVmVyc2lvbjwvUz48VmVyc2lvbiBOPSJWYWx1ZSI+NS4xLjE3NzYzLjc3MTwvVmVyc2lvbj48L0VuPjxFbj48UyBOPSJLZXkiPlBTRWRpdGlvbjwvUz48UyBOPSJWYWx1ZSI+RGVza3RvcDwvUz48L0VuPjxFbj48UyBOPSJLZXkiPlBTQ29tcGF0aWJsZVZlcnNpb25zPC9TPjxPYmogTj0iVmFsdWUiIFJlZklkPSIzIj48VE4gUmVmSWQ9IjEiPjxUPlN5c3RlbS5WZXJzaW9uW108L1Q+PFQ+U3lzdGVtLkFycmF5PC9UPjxUPlN5c3RlbS5PYmplY3Q8L1Q+PC9UTj48TFNUPjxWZXJzaW9uPjEuMDwvVmVyc2lvbj48VmVyc2lvbj4yLjA8L1ZlcnNpb24+PFZlcnNpb24+My4wPC9WZXJzaW9uPjxWZXJzaW9uPjQuMDwvVmVyc2lvbj48VmVyc2lvbj41LjA8L1ZlcnNpb24+PFZlcnNpb24+NS4xLjE3NzYzLjc3MTwvVmVyc2lvbj48L0xTVD48L09iaj48L0VuPjxFbj48UyBOPSJLZXkiPkNMUlZlcnNpb248L1M+PFZlcnNpb24gTj0iVmFsdWUiPjQuMC4zMDMxOS40MjAwMDwvVmVyc2lvbj48L0VuPjxFbj48UyBOPSJLZXkiPkJ1aWxkVmVyc2lvbjwvUz48VmVyc2lvbiBOPSJWYWx1ZSI+MTAuMC4xNzc2My43NzE8L1ZlcnNpb24+PC9Fbj48RW4+PFMgTj0iS2V5Ij5XU01hblN0YWNrVmVyc2lvbjwvUz48VmVyc2lvbiBOPSJWYWx1ZSI+My4wPC9WZXJzaW9uPjwvRW4+PEVuPjxTIE49IktleSI+UFNSZW1vdGluZ1Byb3RvY29sVmVyc2lvbjwvUz48VmVyc2lvbiBOPSJWYWx1ZSI+Mi4zPC9WZXJzaW9uPjwvRW4+PEVuPjxTIE49IktleSI+U2VyaWFsaXphdGlvblZlcnNpb248L1M+PFZlcnNpb24gTj0iVmFsdWUiPjEuMS4wLjE8L1ZlcnNpb24+PC9Fbj48L0RDVD48L09iaj48L0VuPjwvRENUPjwvT2JqPjwvTVM+PC9PYmo+</Data>\r\n<Data Stream='Default' PSGuid='00000000-0000-0000-0000-000000000000'>AAAAAAAAAAMAAAAAAAAAAAMAAABnAQAAAAUQAgC12a7gRFlsRILcuT7Hhe5TAAAAAAAAAAAAAAAAAAAAAO+7vzxPYmogUmVmSWQ9IjAiPjxNUz48STMyIE49IlJ1bnNwYWNlU3RhdGUiPjI8L0kzMj48L01TPjwvT2JqPg==</Data>\r\n<DataAck PSGuid='00000000-0000-0000-0000-000000000000' />\r\n<Command PSGuid='425D2BAB-80EC-48F6-A7B4-A0A9A5F72004' />\r\n\r\n########################\r\n### Decoded Messages ###\r\n########################\r\n\r\nType      : Data\r\nPSGuid    : 00000000-0000-0000-0000-000000000000\r\nStream    : Default\r\nFragments : ObjectID   : 1\r\n            FragmentID : 0\r\n            Start      : True\r\n            End        : True\r\n            Length     : 199\r\n\r\n            ObjectID   : 2\r\n            FragmentID : 0\r\n            Start      : True\r\n            End        : True\r\n            Length     : 898\r\nMessages  : ObjectID    : 1\r\n            Destination : Server\r\n            MessageType : SESSION_CAPABILITY\r\n            RPID        : e0aed9b5-5944-446c-82dc-b93ec785ee53\r\n            PID         : 00000000-0000-0000-0000-000000000000\r\n            Object      : \r\n<Obj RefId=\"0\">\r\n  <MS>\r\n    <Version N=\"PSVersion\">2.0</Version>\r\n    <Version N=\"protocolversion\">2.3</Version>\r\n    <Version N=\"SerializationVersion\">1.1.0.1</Version>\r\n  </MS>\r\n</Obj>\r\n\r\n            ObjectID    : 2\r\n            Destination : Server\r\n            MessageType : INIT_RUNSPACEPOOL\r\n            RPID        : e0aed9b5-5944-446c-82dc-b93ec785ee53\r\n            PID         : 00000000-0000-0000-0000-000000000000\r\n            Object      : \r\n<Obj RefId=\"0\">\r\n  <MS>\r\n    <I32 N=\"MinRunspaces\">1</I32>\r\n    <I32 N=\"MaxRunspaces\">1</I32>\r\n    <Obj RefId=\"1\" N=\"PSThreadOptions\">\r\n      <I32>0</I32>\r\n      <TN RefId=\"0\">\r\n        <T>System.Management.Automation.Runspaces.PSThreadOptions</T>\r\n        <T>System.Enum</T>\r\n        <T>System.ValueType</T>\r\n        <T>System.Object</T>\r\n      </TN>\r\n      <ToString>Default</ToString>\r\n    </Obj>\r\n    <Obj RefId=\"2\" N=\"ApartmentState\">\r\n      <I32>2</I32>\r\n      <TN RefId=\"1\">\r\n        <T>System.Threading.ApartmentState</T>\r\n        <T>System.Enum</T>\r\n        <T>System.ValueType</T>\r\n        <T>System.Object</T>\r\n      </TN>\r\n      <ToString>Unknown</ToString>\r\n    </Obj>\r\n    <Obj RefId=\"3\" N=\"HostInfo\">\r\n      <MS>\r\n        <B N=\"_isHostNull\">false</B>\r\n        <B N=\"_isHostUINull\">false</B>\r\n        <B N=\"_isHostRawUINull\">true</B>\r\n        <B N=\"_useRunspaceHost\">false</B>\r\n      </MS>\r\n    </Obj>\r\n    <Obj RefId=\"4\" N=\"ApplicationArguments\">\r\n      <TN RefId=\"2\">\r\n        <T>System.Management.Automation.PSPrimitiveDictionary</T>\r\n        <T>System.Collections.Hashtable</T>\r\n        <T>System.Object</T>\r\n      </TN>\r\n      <DCT />\r\n    </Obj>\r\n  </MS>\r\n</Obj>\r\n\r\nType      : Data\r\nPSGuid    : 00000000-0000-0000-0000-000000000000\r\nStream    : Default\r\nFragments : ObjectID   : 1\r\n            FragmentID : 0\r\n            Start      : True\r\n            End        : True\r\n            Length     : 202\r\nMessages  : ObjectID    : 1\r\n            Destination : Client\r\n            MessageType : SESSION_CAPABILITY\r\n            RPID        : 00000000-0000-0000-0000-000000000000\r\n            PID         : 00000000-0000-0000-0000-000000000000\r\n            Object      : \r\n<Obj RefId=\"0\">\r\n  <MS>\r\n    <Version N=\"protocolversion\">2.3</Version>\r\n    <Version N=\"PSVersion\">2.0</Version>\r\n    <Version N=\"SerializationVersion\">1.1.0.1</Version>\r\n  </MS>\r\n</Obj>\r\n\r\nType      : Data\r\nPSGuid    : 00000000-0000-0000-0000-000000000000\r\nStream    : Default\r\nFragments : ObjectID   : 2\r\n            FragmentID : 0\r\n            Start      : True\r\n            End        : True\r\n            Length     : 1194\r\nMessages  : ObjectID    : 2\r\n            Destination : Client\r\n            MessageType : APPLICATION_PRIVATE_DATA\r\n            RPID        : e0aed9b5-5944-446c-82dc-b93ec785ee53\r\n            PID         : 00000000-0000-0000-0000-000000000000\r\n            Object      : \r\n<Obj RefId=\"0\">\r\n  <MS>\r\n    <Obj N=\"ApplicationPrivateData\" RefId=\"1\">\r\n      <TN RefId=\"0\">\r\n        <T>System.Management.Automation.PSPrimitiveDictionary</T>\r\n        <T>System.Collections.Hashtable</T>\r\n        <T>System.Object</T>\r\n      </TN>\r\n      <DCT>\r\n        <En>\r\n          <S N=\"Key\">PSVersionTable</S>\r\n          <Obj N=\"Value\" RefId=\"2\">\r\n            <TNRef RefId=\"0\" />\r\n            <DCT>\r\n              <En>\r\n                <S N=\"Key\">PSVersion</S>\r\n                <Version N=\"Value\">5.1.17763.771</Version>\r\n              </En>\r\n              <En>\r\n                <S N=\"Key\">PSEdition</S>\r\n                <S N=\"Value\">Desktop</S>\r\n              </En>\r\n              <En>\r\n                <S N=\"Key\">PSCompatibleVersions</S>\r\n                <Obj N=\"Value\" RefId=\"3\">\r\n                  <TN RefId=\"1\">\r\n                    <T>System.Version[]</T>\r\n                    <T>System.Array</T>\r\n                    <T>System.Object</T>\r\n                  </TN>\r\n                  <LST>\r\n                    <Version>1.0</Version>\r\n                    <Version>2.0</Version>\r\n                    <Version>3.0</Version>\r\n                    <Version>4.0</Version>\r\n                    <Version>5.0</Version>\r\n                    <Version>5.1.17763.771</Version>\r\n                  </LST>\r\n                </Obj>\r\n              </En>\r\n              <En>\r\n                <S N=\"Key\">CLRVersion</S>\r\n                <Version N=\"Value\">4.0.30319.42000</Version>\r\n              </En>\r\n              <En>\r\n                <S N=\"Key\">BuildVersion</S>\r\n                <Version N=\"Value\">10.0.17763.771</Version>\r\n              </En>\r\n              <En>\r\n                <S N=\"Key\">WSManStackVersion</S>\r\n                <Version N=\"Value\">3.0</Version>\r\n              </En>\r\n              <En>\r\n                <S N=\"Key\">PSRemotingProtocolVersion</S>\r\n                <Version N=\"Value\">2.3</Version>\r\n              </En>\r\n              <En>\r\n                <S N=\"Key\">SerializationVersion</S>\r\n                <Version N=\"Value\">1.1.0.1</Version>\r\n              </En>\r\n            </DCT>\r\n          </Obj>\r\n        </En>\r\n      </DCT>\r\n    </Obj>\r\n  </MS>\r\n</Obj>\r\n\r\nType      : Data\r\nPSGuid    : 00000000-0000-0000-0000-000000000000\r\nStream    : Default\r\nFragments : ObjectID   : 3\r\n            FragmentID : 0\r\n            Start      : True\r\n            End        : True\r\n            Length     : 103\r\nMessages  : ObjectID    : 3\r\n            Destination : Client\r\n            MessageType : RUNSPACEPOOL_STATE\r\n            RPID        : e0aed9b5-5944-446c-82dc-b93ec785ee53\r\n            PID         : 00000000-0000-0000-0000-000000000000\r\n            Object      : \r\n<Obj RefId=\"0\">\r\n  <MS>\r\n    <I32 N=\"RunspaceState\">2</I32>\r\n  </MS>\r\n</Obj>\r\n\r\nType      : DataAck\r\nPSGuid    : 00000000-0000-0000-0000-000000000000\r\nStream    : \r\nFragments : \r\nMessages  : \r\n\r\nType      : Command\r\nPSGuid    : 425D2BAB-80EC-48F6-A7B4-A0A9A5F72004\r\nStream    : \r\nFragments : \r\nMessages  : \r\n```\r\n</details>\r\n\r\nSome of the differences I found\r\n\r\n* The `SESSION_CAPABILITY` with PowerShell contains the `TimeZone` field but I've never found this to be required before\r\n* The `INIT_RUNSPACEPOOL` contains the raw host ui info, I also did the same after this test exchange and it didn't fix the problem\r\n* The `APPLICATION_PRIVATE_DATA` back from the server had some debug information whereas the one from my test over SSH did not, I'm not sure why that is\r\n\r\nAt this point I'm not sure what is wrong with exchanging this data over SSH but considering this isn't a supported scenario I don't really have a leg to stand on when asking questoins. I'll keep this info here in case someone else is interested and wants to continue where I left off.",
      "created_at": "2021-04-21T01:24:51Z",
      "updated_at": "2021-04-21T01:24:51Z"
    },
    {
      "author": "PaulHigin",
      "author_association": "COLLABORATOR",
      "body": "Yes, you are right.  At this point the host pwsh process is already created and the PSRP message pump is started.  There is no extra process running (which only happens during job set up on the client).  So you are correct in that at this point the `-s` and `-sshs` switches do the same thing.  \r\n\r\nThe `SSHProcessMediator` is a thin layer over the `OutOfProcessMediatorBase`, and it was created because at the time .NET stream reader/writers did not work over std pipes on Non-Windows platforms (https://github.com/PowerShell/PowerShell/blob/2f0cc3b0f82e0e07e693db90daca39adb2caf591/src/System.Management.Automation/engine/remoting/server/OutOfProcServerMediator.cs#L529), but I believe this is no longer the case with latest .NET and it can be removed.  If you like, you can create an issue for this.\r\n\r\nBut I feel we still want the separate `SSHProcessMediator` as we will want to diverge from the `OutOfProcessMediator` in the future, to support other configuration and hosting scenarios for SSH.",
      "created_at": "2021-04-21T15:55:41Z",
      "updated_at": "2021-04-21T15:55:41Z"
    },
    {
      "author": "jborean93",
      "author_association": "COLLABORATOR",
      "body": "> and it was created because at the time .NET stream reader/writers did not work over std pipes on Non-Windows platforms (\r\n\r\nThanks, that sounds like the main reason for the difference and explains why there is both `-sshs` and `-s`.\r\n\r\n> But I feel we still want the separate SSHProcessMediator as we will want to diverge from the OutOfProcessMediator in the future, to support other configuration and hosting scenarios for SSH.\r\n\r\nThat makes sense, I'm not at all suggesting the SSH specific bits be dropped, was just curious as why they were slightly different when the operation was mostly the same but you've answered that above.\r\n\r\nOne other thing I noticed was `OutOfProcessMediator` sets the console handles to `TextReader/Writer.Null` but the `SSHProcessMediator` does not. This means writing to the console using `[Console]::WriteLine(\"line\")` in an SSH remoting session breaks the communication. I did open an issue for this https://github.com/PowerShell/PowerShell/issues/15229 as this sounds more like a bug to me.",
      "created_at": "2021-04-21T23:52:53Z",
      "updated_at": "2021-04-21T23:54:01Z"
    },
    {
      "author": "PaulHigin",
      "author_association": "COLLABORATOR",
      "body": "From WG-Remoting:\r\n@iSazonov please include the 'Needs-Triage' tag if you want the working group to triage the issue.",
      "created_at": "2021-05-12T21:13:35Z",
      "updated_at": "2021-05-12T21:13:35Z"
    },
    {
      "author": "jborean93",
      "author_association": "COLLABORATOR",
      "body": "I think you've answered my question and also addressed another issue as well. The only outstanding problem I have is replicating the `powershell.exe -s` behaviour when running over SSH as right now it just stops responding to packets sent to it but that's unrelated to this problem or at least isn't supported so I'll close the issue.\r\n\r\nThanks for explaining the details and working through this with me @PaulHigin ",
      "created_at": "2021-05-12T21:22:06Z",
      "updated_at": "2021-05-12T21:22:06Z"
    },
    {
      "author": "jborean93",
      "author_association": "COLLABORATOR",
      "body": "> The only outstanding problem I have is replicating the powershell.exe -s behaviour when running over SSH as right now it just stops responding to packets sent to it but that's unrelated to this problem or at least isn't supported so I'll close the issue.\r\n\r\nI was in the neighborhood again and have finally figured out why and thought I would share it in case anyone wanted to learn more in the future. .NET 4.x has a special function in it's `ConsoleStream` `Read` method called [WaitForAvailableConsoleInput](https://referencesource.microsoft.com/#mscorlib/system/io/__consolestream.cs,195) which is essentially getting blocked when running over an SSH session. The `WaitForAvailableConsoleInput` function isn't available online but others have monitored what happens and based on the details in https://sourceware.org/legacy-ml/cygwin/2013-12/msg00345.html the issue is with `OVERLAPPED` handles and how `WaitForAvailableConsoleInput` is waiting for input. Essentially if a .NET application tries to read it's stdin pipe and the stdin pipe of that process was created with `FILE_FLAG_OVERLAPPED` it will block in that function and never return. Unfortunately in the case of Win32-OpenSSH it spawns it's processes with stdio pipes created with `FILE_FLAG_OVERLAPPED` causing the issue at hand.\r\n\r\nPowerShell/.NET Core removed this function entirely so it does not have the same problem and why things just work there. There's unfortunately nothing that can be done about this as .NET Framework is EOF and Win32-OpenSSH most likely uses `OVERLAPPED` structures for it's operations. I do see a workaround that is essentially a stub that calls the raw Win32 functions to read from the pipe and bypass .NET entirely but that would have to be something provided outside of MS as Windows PowerShell is in a security/bugfix only phase.\n\n<blockquote><div><strong><a href=\"https://sourceware.org/legacy-ml/cygwin/2013-12/msg00345.html\">James Johnston - Pipe syncronization and incompatibility between Cygwin and .NET Framewor</a></strong></div></blockquote>",
      "created_at": "2022-03-11T04:35:14Z",
      "updated_at": "2022-03-11T04:35:17Z"
    },
    {
      "author": "jborean93",
      "author_association": "COLLABORATOR",
      "body": "Created a POC stub that could be used to enable this https://gist.github.com/jborean93/7d4cb107fa06251b080fa10ec844893e. This is experimental and unsupported so use at your own risk.\n\n<blockquote><img src=\"https://github.githubassets.com/images/modules/gists/gist-og-image.png\" width=\"48\" align=\"right\"><div><img src=\"https://github.githubassets.com/favicons/favicon.svg\" height=\"14\"> Gist</div><div><strong><a href=\"https://gist.github.com/jborean93/7d4cb107fa06251b080fa10ec844893e\">Windows PowerShell SSH Remoting Stub</a></strong></div><div>Windows PowerShell SSH Remoting Stub. GitHub Gist: instantly share code, notes, and snippets.</div></blockquote>",
      "created_at": "2022-03-11T06:18:43Z",
      "updated_at": "2022-03-11T06:18:45Z"
    }
  ],
  "created_at": "2020-12-21T20:29:21Z",
  "number": 14478,
  "state": "closed",
  "title": "ServerMode vs SSHServerMode",
  "updated_at": "2022-03-11T06:18:45Z"
}
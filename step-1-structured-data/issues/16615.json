{
  "_url": "https://github.com/PowerShell/PowerShell/issues/16615",
  "author": "jomarquez",
  "body": "### Prerequisites\r\n\r\n- [X] Write a descriptive title.\r\n- [X] Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\r\n- [X] Search the existing issues.\r\n- [X] Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\r\n- [X] Refer to [Differences between Windows PowerShell 5.1 and PowerShell](https://docs.microsoft.com/powershell/scripting/whats-new/differences-from-windows-powershell).\r\n\r\n### Steps to reproduce\r\n\r\nWhen connecting to Connect-ExchangeOnline via pwsh v. 7.2.1 on azure-powershell:ubuntu-18.04 container, I get the following error:\r\n\r\n```\r\npwsh: symbol lookup error: /opt/microsoft/powershell/7/libmi.so: undefined symbol: SSL_library_init\r\n```\r\n\r\nThe file does exist.\r\n\r\nThis error started on Dec 9, 2021. Had no issues connecting prior to this\r\n\r\n### Expected behavior\r\n\r\n```console\r\nLoading the PS modules for ExchangeOnline...\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Installing package 'ExchangeOnlineManagement'                                      Downloaded 0.00 MB out of 6.97 MB.                                              [                                                                    ]                                                                                                                                                                       Installing package 'ExchangeOnlineManagement'                                      Unzipping                                                                       [ooooooooooooooooooooooooooooooooooooooooooooooo                     ]                                                                                                                                                                       Installing package 'ExchangeOnlineManagement'                                      Process Package Manifest                                                        [oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo    ]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Installing package 'AzureAD'                                                       Downloaded 0.00 MB out of 7.67 MB.                                              [                                                                    ]                                                                                                                                                                       Installing package 'AzureAD'                                                       Copying unzipped package to '/tmp/481623747/AzureAD.2.0.2.140'                  [ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo       ]                                                                                                                                                                       Installing package 'AzureAD'                                                       Process Package Manifest                                                        [oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo    ]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Installing package 'ExchangePowerShell'                                            Downloaded 0.00 MB out of 0.02 MB.                                              [                                                                    ]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Connect to Exchange Online\r\n----------------------------------------------------------------------------\r\nThe module allows access to all existing remote PowerShell (V1) cmdlets in addition to the 9 new, faster, and more reliable cmdlets.\r\n|--------------------------------------------------------------------------|\r\n|    Old Cmdlets                    |    New/Reliable/Faster Cmdlets       |\r\n|--------------------------------------------------------------------------|\r\n|    Get-CASMailbox                 |    Get-EXOCASMailbox                 |\r\n|    Get-Mailbox                    |    Get-EXOMailbox                    |\r\n|    Get-MailboxFolderPermission    |    Get-EXOMailboxFolderPermission    |\r\n|    Get-MailboxFolderStatistics    |    Get-EXOMailboxFolderStatistics    |\r\n|    Get-MailboxPermission          |    Get-EXOMailboxPermission          |\r\n|    Get-MailboxStatistics          |    Get-EXOMailboxStatistics          |\r\n|    Get-MobileDeviceStatistics     |    Get-EXOMobileDeviceStatistics     |\r\n|    Get-Recipient                  |    Get-EXORecipient                  |\r\n|    Get-RecipientPermission        |    Get-EXORecipientPermission        |\r\n|--------------------------------------------------------------------------|\r\nTo get additional information, run: Get-Help Connect-ExchangeOnline or check https://aka.ms/exops-docs\r\nSend your product improvement suggestions and feedback to exocmdletpreview@service.microsoft.com. For issues related to the module, contact Microsoft support. Don't use the feedback alias for problems or support issues.\r\n----------------------------------------------------------------------------\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Creating implicit remoting module ...                                              Getting command information from remote session ... 16 commands received        [                                                                    ]          00:01:41 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 33 commands received        [oo                                                                  ]          00:01:00 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 50 commands received        [oooo                                                                ]          00:00:48 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 67 commands received        [ooooo                                                               ]          00:01:36 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 84 commands received        [oooooo                                                              ]          00:01:19 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 100 commands received       [oooooooo                                                            ]          00:01:09 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 132 commands received       [oooooooooo                                                          ]          00:00:54 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 150 commands received       [oooooooooooo                                                        ]          00:00:48 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 167 commands received       [ooooooooooooo                                                       ]          00:01:04 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 183 commands received       [oooooooooooooo                                                      ]          00:01:12 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 200 commands received       [oooooooooooooooo                                                    ]          00:01:21 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 216 commands received       [ooooooooooooooooo                                                   ]          00:01:28 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 232 commands received       [ooooooooooooooooooo                                                 ]          00:01:21 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 244 commands received       [oooooooooooooooooooo                                                ]          00:01:16 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 259 commands received       [ooooooooooooooooooooo                                               ]          00:01:11 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 274 commands received       [ooooooooooooooooooooooo                                             ]          00:01:06 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 292 commands received       [oooooooooooooooooooooooo                                            ]          00:01:01 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 308 commands received       [ooooooooooooooooooooooooo                                           ]          00:00:57 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 325 commands received       [ooooooooooooooooooooooooooo                                         ]          00:00:53 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 342 commands received       [oooooooooooooooooooooooooooo                                        ]          00:00:56 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 359 commands received       [ooooooooooooooooooooooooooooo                                       ]          00:00:52 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 376 commands received       [ooooooooooooooooooooooooooooooo                                     ]          00:00:48 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 392 commands received       [oooooooooooooooooooooooooooooooo                                    ]          00:00:45 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 403 commands received       [oooooooooooooooooooooooooooooooooo                                  ]          00:00:43 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 414 commands received       [oooooooooooooooooooooooooooooooooo                                  ]          00:00:41 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 425 commands received       [ooooooooooooooooooooooooooooooooooo                                 ]          00:00:40 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 431 commands received       [oooooooooooooooooooooooooooooooooooo                                ]          00:00:39 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 441 commands received       [oooooooooooooooooooooooooooooooooooo                                ]          00:00:51 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 451 commands received       [oooooooooooooooooooooooooooooooooooooo                              ]          00:00:49 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 460 commands received       [oooooooooooooooooooooooooooooooooooooo                              ]          00:00:47 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 472 commands received       [ooooooooooooooooooooooooooooooooooooooo                             ]          00:00:48 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 484 commands received       [oooooooooooooooooooooooooooooooooooooooo                            ]          00:00:46 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 491 commands received       [ooooooooooooooooooooooooooooooooooooooooo                           ]          00:00:45 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 506 commands received       [oooooooooooooooooooooooooooooooooooooooooo                          ]          00:00:42 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 523 commands received       [oooooooooooooooooooooooooooooooooooooooooooo                        ]          00:00:41 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 540 commands received       [ooooooooooooooooooooooooooooooooooooooooooooo                       ]          00:00:41 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 556 commands received       [oooooooooooooooooooooooooooooooooooooooooooooo                      ]          00:00:38 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 573 commands received       [oooooooooooooooooooooooooooooooooooooooooooooooo                    ]          00:00:34 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 590 commands received       [ooooooooooooooooooooooooooooooooooooooooooooooooo                   ]          00:00:31 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 606 commands received       [ooooooooooooooooooooooooooooooooooooooooooooooooooo                 ]          00:00:29 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 617 commands received       [ooooooooooooooooooooooooooooooooooooooooooooooooooo                 ]          00:00:29 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 628 commands received       [ooooooooooooooooooooooooooooooooooooooooooooooooooooo               ]          00:00:27 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 638 commands received       [ooooooooooooooooooooooooooooooooooooooooooooooooooooo               ]          00:00:26 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 646 commands received       [oooooooooooooooooooooooooooooooooooooooooooooooooooooo              ]          00:00:24 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 656 commands received       [ooooooooooooooooooooooooooooooooooooooooooooooooooooooo             ]          00:00:22 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 665 commands received       [ooooooooooooooooooooooooooooooooooooooooooooooooooooooo             ]          00:00:21 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 673 commands received       [oooooooooooooooooooooooooooooooooooooooooooooooooooooooo            ]          00:00:19 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 683 commands received       [ooooooooooooooooooooooooooooooooooooooooooooooooooooooooo           ]          00:00:18 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 689 commands received       [ooooooooooooooooooooooooooooooooooooooooooooooooooooooooo           ]          00:00:17 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 699 commands received       [ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo         ]          00:00:15 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 707 commands received       [ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo         ]          00:00:15 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 716 commands received       [oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo        ]          00:00:14 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 726 commands received       [ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo       ]          00:00:13 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 739 commands received       [oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo      ]          00:00:11 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 748 commands received       [ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo     ]          00:00:09 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 754 commands received       [ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo     ]          00:00:08 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 769 commands received       [oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo    ]          00:00:05 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 784 commands received       [ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo   ]          00:00:03 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting command information from remote session ... 800 commands received       [ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo ]          00:00:00 remaining.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting formatting and output information from remote session ... 23 objects     received                                                                       [ooo                                                                 ]          00:00:25 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting formatting and output information from remote session ... 44 objects     received                                                                       [oooooo                                                              ]          00:00:21 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting formatting and output information from remote session ... 66 objects     received                                                                       [ooooooooo                                                           ]          00:00:16 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting formatting and output information from remote session ... 89 objects     received                                                                       [ooooooooooooo                                                       ]          00:00:17 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting formatting and output information from remote session ... 112 object    s received                                                                      [ooooooooooooooooo                                                   ]          00:00:44 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting formatting and output information from remote session ... 134 object    s received                                                                      [oooooooooooooooooooo                                                ]          00:00:36 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting formatting and output information from remote session ... 155 object    s received                                                                      [ooooooooooooooooooooooo                                             ]          00:00:30 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting formatting and output information from remote session ... 175 object    s received                                                                      [oooooooooooooooooooooooooo                                          ]          00:00:42 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting formatting and output information from remote session ... 195 object    s received                                                                      [ooooooooooooooooooooooooooooo                                       ]          00:00:36 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting formatting and output information from remote session ... 211 object    s received                                                                      [ooooooooooooooooooooooooooooooo                                     ]          00:00:32 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting formatting and output information from remote session ... 234 object    s received                                                                      [ooooooooooooooooooooooooooooooooooo                                 ]          00:00:26 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting formatting and output information from remote session ... 254 object    s received                                                                      [oooooooooooooooooooooooooooooooooooooo                              ]          00:00:22 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting formatting and output information from remote session ... 273 object    s received                                                                      [ooooooooooooooooooooooooooooooooooooooooo                           ]          00:00:22 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting formatting and output information from remote session ... 290 object    s received                                                                      [oooooooooooooooooooooooooooooooooooooooooooo                        ]          00:00:19 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting formatting and output information from remote session ... 308 object    s received                                                                      [oooooooooooooooooooooooooooooooooooooooooooooo                      ]          00:00:16 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting formatting and output information from remote session ... 317 object    s received                                                                      [oooooooooooooooooooooooooooooooooooooooooooooooo                    ]          00:00:16 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting formatting and output information from remote session ... 330 object    s received                                                                      [oooooooooooooooooooooooooooooooooooooooooooooooooo                  ]          00:00:14 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting formatting and output information from remote session ... 353 object    s received                                                                      [ooooooooooooooooooooooooooooooooooooooooooooooooooooo               ]          00:00:10 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting formatting and output information from remote session ... 375 object    s received                                                                      [ooooooooooooooooooooooooooooooooooooooooooooooooooooooooo           ]          00:00:07 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting formatting and output information from remote session ... 396 object    s received                                                                      [oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo        ]          00:00:05 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting formatting and output information from remote session ... 413 object    s received                                                                      [ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo     ]          00:00:03 remaining.                                                                                                                                                                                                                          Creating implicit remoting module ...                                              Getting formatting and output information from remote session ... 430 object    s received                                                                      [ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo   ]          00:00:01 remaining\r\n```\r\n\r\n\r\n### Actual behavior\r\n\r\n```console\r\nLoading the PS modules for ExchangeOnline...\r\nConnect to Exchange Online\r\n----------------------------------------------------------------------------\r\nThe module allows access to all existing remote PowerShell (V1) cmdlets in addition to the 9 new, faster, and more reliable cmdlets.\r\n|--------------------------------------------------------------------------|\r\n|    Old Cmdlets                    |    New/Reliable/Faster Cmdlets       |\r\n|--------------------------------------------------------------------------|\r\n|    Get-CASMailbox                 |    Get-EXOCASMailbox                 |\r\n|    Get-Mailbox                    |    Get-EXOMailbox                    |\r\n|    Get-MailboxFolderPermission    |    Get-EXOMailboxFolderPermission    |\r\n|    Get-MailboxFolderStatistics    |    Get-EXOMailboxFolderStatistics    |\r\n|    Get-MailboxPermission          |    Get-EXOMailboxPermission          |\r\n|    Get-MailboxStatistics          |    Get-EXOMailboxStatistics          |\r\n|    Get-MobileDeviceStatistics     |    Get-EXOMobileDeviceStatistics     |\r\n|    Get-Recipient                  |    Get-EXORecipient                  |\r\n|    Get-RecipientPermission        |    Get-EXORecipientPermission        |\r\n|--------------------------------------------------------------------------|\r\nTo get additional information, run: Get-Help Connect-ExchangeOnline or check https://aka.ms/exops-docs\r\nSend your product improvement suggestions and feedback to exocmdletpreview@service.microsoft.com. For issues related to the module, contact Microsoft support. Don't use the feedback alias for problems or support issues.\r\n----------------------------------------------------------------------------\r\npwsh: symbol lookup error: /opt/microsoft/powershell/7/libmi.so: undefined symbol: SSL_library_init\r\n```\r\n\r\n\r\n### Error details\r\n\r\n_No response_\r\n\r\n### Environment data\r\n\r\n```powershell\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.2.1\r\nPSEdition                      Core\r\nGitCommitId                    7.2.1\r\nOS                             Linux 4.15.0-99-generic #100-Ubuntu SMP Wed Apr\u2026\r\nPlatform                       Unix\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n\r\n\r\n### Visuals\r\n\r\n_No response_",
  "closed_at": "2021-12-17T00:00:43Z",
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "/cc @jborean93 ",
      "created_at": "2021-12-15T03:25:25Z",
      "updated_at": "2021-12-15T03:25:25Z"
    },
    {
      "author": "jborean93",
      "author_association": "COLLABORATOR",
      "body": "This is more than likely to be an issue with OpenSSL issues. The version that of OMI that pwsh ships with is dynamically linked to OpenSSL 1.0.2. There is a symbolic link inside the `pwsh` dir that points to your OpenSSL library location but on most modern distributions this is pointing to OpenSSL 1.1.x. Because of the ABI incompatibilities between OpenSSL 1.0.2 and 1.1.x the hack that's in place fails when it tries to use a symbol that it expects to be there [SSL_library_init](https://www.openssl.org/docs/manmaster/man3/SSL_library_init.html). According to the docs this was deprecated in 1.1.x which according to the docs was deprecated in 1.1.0 and more than likely was removed in your version causing the error\r\n\r\n> The SSL_library_init() and OpenSSL_add_ssl_algorithms() functions were deprecated in OpenSSL 1.1.0 by OPENSSL_init_ssl().\r\n\r\nTo continue using the builtin version with pwsh you essentially need to install OpenSSL 1.0.2 and change the symlinks to point to that old version but this is a horrible thing to do. I would also suggest my [PSWSMan](https://www.powershellgallery.com/packages/PSWSMan/) module. This module is a fork of the code that `pwsh` includes that not only adds support for OpenSSL 1.1.x but fixes [a whole bunch of other issues](https://github.com/jborean93/omi#changes-from-upstream-omi). Keep in mind this fork is not affiliated with MS in any way and there is no guarantee of support. I try my best to help where I can but even then some things are beyond my abilities.",
      "created_at": "2021-12-15T06:14:50Z",
      "updated_at": "2021-12-15T06:14:50Z"
    },
    {
      "author": "msftbot[bot]",
      "author_association": "NONE",
      "body": "This issue has been marked as answered and has not had any activity for **1 day**. It has been closed for housekeeping purposes.",
      "created_at": "2021-12-17T00:00:42Z",
      "updated_at": "2021-12-17T00:00:42Z"
    },
    {
      "author": "jomarquez",
      "author_association": "NONE",
      "body": "Thanks, @jborean93, your answer paired with https://github.com/PowerShell/PowerShell/issues/12202#issuecomment-720169046 helped me find a soluton.\r\n\r\nI installed OpenSSL 1.0.2 and its patch, changed openssl symlink to point to OpenSSL 1.0.2 and adjusted the symlinks in /opt/microsoft/powershell/7 for libssl and libcrypto to point to the 1.0.2 versions.\r\n\r\n```console\r\napt-get update && apt-get install build-essential -y\r\napt install perl-modules-5.26 -y && apt-get install -y powershell\r\ncurl https://www.openssl.org/source/openssl-1.0.2l.tar.gz --output ./openssl-1.0.2l.tar.gz\r\ntar xz -f openssl-1.0.2l.tar.gz\r\ncd ./openssl-1.0.2l/\r\ncurl https://www.linuxfromscratch.org/patches/downloads/openssl/openssl-1.0.2l-compat_versioned_symbols-1.patch --output openssl-1.0.2l-compat_versioned_symbols-1.patch\r\npatch -Np1 -i ./openssl-1.0.2l-compat_versioned_symbols-1.patch\r\n./config --libdir=lib/openssl-1.0\r\nmake depend\r\nmake -j1\r\nmake install\r\nln -sf /usr/local/ssl/bin/openssl $(which openssl)\r\nln -sf ./libssl.so.1.0.0 /opt/microsoft/powershell/7/libssl.so.1.0.0\r\nln -sf ./libcrypto.so.1.0.0 /opt/microsoft/powershell/7/libcrypto.so.1.0.0\r\nopenssl version -v\r\n```\r\n",
      "created_at": "2021-12-20T19:58:36Z",
      "updated_at": "2021-12-20T20:09:47Z"
    }
  ],
  "created_at": "2021-12-14T20:30:55Z",
  "number": 16615,
  "state": "closed",
  "title": "Symbol lookup error when connecting to Connect-ExchangeOnline via pwsh v. 7.2.1 on azure-powershell:ubuntu-18.04",
  "updated_at": "2021-12-20T20:09:47Z"
}
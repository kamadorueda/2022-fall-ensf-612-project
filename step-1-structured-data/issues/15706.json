{
  "_url": "https://github.com/PowerShell/PowerShell/issues/15706",
  "author": "strawgate",
  "body": "<!-- Anything that looks like this is a comment and can't be seen after the Pull Request is created. -->\r\n\r\n# PR Summary\r\n\r\nThe current json tests do not adequately test datetimes and integers and while there are some unit tests for primitives there are no \"large object\" tests. I created a little test generator to take an object and produce tests using the various formats.\r\n\r\nThe datetime tests also do specific things in the case that newtonsoft chooses to convert the json string into a datetime versus when it does not.\r\n\r\nThe complex object test makes sure that our unit tests apply even when the object is large, with a variety of types and with nested arrays and objects.\r\n\r\nThe number tests make sure that we properly capture when newtonsoft decides to give us int64 vs double vs bigint objects.\r\n\r\nThis will make it apparent when changes to the deserializer cause a difference in behavior for datetime , numbers or complex objects.\r\n\r\n<!-- Summarize your PR between here and the checklist. -->\r\n\r\n## PR Context\r\n\r\nImprove test coverage for json cmdlets.  These tests document current behavior and do not have an opinion on what **correct** behavior looks like. These will help with a future move to system.text.json in understanding where the differences in deserialization are.\r\n\r\n<!-- Provide a little reasoning as to why this Pull Request helps and why you have opened it. -->\r\n\r\n## PR Checklist\r\n\r\n- [x] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - Use the present tense and imperative mood when describing your changes\r\n- [x] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] [Make sure all `.h`, `.cpp`, `.cs`, `.ps1` and `.psm1` files have the correct copyright header](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - If the PR is work in progress, please add the prefix `WIP:` or `[ WIP ]` to the beginning of the title (the `WIP` bot will keep its status check at `Pending` while the prefix is present) and remove the prefix when the PR is ready.\r\n- **[Breaking changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)**\r\n    - [x] None\r\n    - **OR**\r\n    - [ ] [Experimental feature(s) needed](https://github.com/MicrosoftDocs/PowerShell-Docs/blob/staging/reference/6/Microsoft.PowerShell.Core/About/about_Experimental_Features.md)\r\n        - [ ] Experimental feature name(s): <!-- Experimental feature name(s) here -->\r\n- **User-facing changes**\r\n    - [x] Not Applicable\r\n    - **OR**\r\n    - [ ] [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n        - [ ] Issue filed: <!-- Number/link of that issue here -->\r\n- **Testing - New and feature**\r\n    - [x] N/A or can only be tested interactively\r\n    - **OR**\r\n    - [ ] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n- **Tooling**\r\n    - [x] I have considered the user experience from a tooling perspective and don't believe tooling will be impacted.\r\n    - **OR**\r\n    - [ ] I have considered the user experience from a tooling perspective and opened an issue in the relevant tool repository. This may include:\r\n        - [ ] Impact on [PowerShell Editor Services](https://github.com/PowerShell/PowerShellEditorServices) which is used in the [PowerShell extension](https://github.com/PowerShell/vscode-powershell) for VSCode\r\n        (which runs in a different PS Host).\r\n            - [ ] Issue filed: <!-- Number/link of that issue here -->\r\n        - [ ] Impact on Completions (both in the console and in editors) - one of PowerShell's most powerful features.\r\n            - [ ] Issue filed: <!-- Number/link of that issue here -->\r\n        - [ ] Impact on [PSScriptAnalyzer](https://github.com/PowerShell/PSScriptAnalyzer) (which provides linting & formatting in the editor extensions).\r\n            - [ ] Issue filed: <!-- Number/link of that issue here -->\r\n        - [ ] Impact on [EditorSyntax](https://github.com/PowerShell/EditorSyntax) (which provides syntax highlighting with in VSCode, GitHub, and many other editors).\r\n            - [ ] Issue filed: <!-- Number/link of that issue here -->\r\n",
  "closed_at": "2021-07-16T23:01:47Z",
  "comments": [
    {
      "author": "strawgate",
      "author_association": "CONTRIBUTOR",
      "body": "If there are other tests you'd like to see please comment and Ill take care of writing them!",
      "created_at": "2021-07-01T14:51:43Z",
      "updated_at": "2021-07-01T14:51:43Z"
    },
    {
      "author": "strawgate",
      "author_association": "CONTRIBUTOR",
      "body": "Ive re-added the WIP tag as I am still adding more tests and a couple of the tests are failing at the moment.",
      "created_at": "2021-07-01T14:53:13Z",
      "updated_at": "2021-07-01T14:53:13Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "> If there are other tests you'd like to see please comment and Ill take care of writing them!\r\n\r\n1. I'd look existing issues for Json cmdlets to discover scenarios we could cover by tests.\r\n2. Using null values.\r\n3. Different enumerations (like array, Dictionary, HashSet and so on)",
      "created_at": "2021-07-01T19:08:18Z",
      "updated_at": "2021-07-01T19:08:18Z"
    },
    {
      "author": "msftbot[bot]",
      "author_association": "NONE",
      "body": "This pull request has been automatically marked as Review Needed because it has been there has not been any activity for **7 days**.\nMaintainer, please provide feedback and/or mark it as `Waiting on Author`",
      "created_at": "2021-07-09T02:00:36Z",
      "updated_at": "2021-07-09T02:00:36Z"
    },
    {
      "author": "strawgate",
      "author_association": "CONTRIBUTOR",
      "body": "> > If there are other tests you'd like to see please comment and Ill take care of writing them!\r\n> \r\n> 1. I'd look existing issues for Json cmdlets to discover scenarios we could cover by tests.\r\n> 2. Using null values.\r\n> 3. Different enumerations (like array, Dictionary, HashSet and so on)\r\n\r\nI was hoping to focus on the convertfrom-json tests for this one. I think that excludes the enumerations part, i think the existing tests cover null values, and I couldnt find any closed issues where i could add tests. The open issues I saw require code changes to resolve (in addition to adding tests when they are fixed).\r\n\r\nI think this is ready for review",
      "created_at": "2021-07-09T05:19:00Z",
      "updated_at": "2021-07-09T05:19:11Z"
    },
    {
      "author": "strawgate",
      "author_association": "CONTRIBUTOR",
      "body": "I've resolved all open comments that had questions or concerns about the code in the PR",
      "created_at": "2021-07-14T20:35:49Z",
      "updated_at": "2021-07-14T20:35:49Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@strawgate Thanks for your contribution!",
      "created_at": "2021-07-16T23:02:39Z",
      "updated_at": "2021-07-16T23:02:39Z"
    },
    {
      "author": "msftbot[bot]",
      "author_association": "NONE",
      "body": ":tada:`v7.2.0-preview.8` has been released which incorporates this pull request.:tada:\n\nHandy links:\n* [Release Notes](https://github.com/PowerShell/PowerShell/releases/tag/v7.2.0-preview.8)\n",
      "created_at": "2021-07-22T21:39:40Z",
      "updated_at": "2021-07-22T21:39:40Z"
    }
  ],
  "created_at": "2021-07-01T04:37:08Z",
  "number": 15706,
  "state": "closed",
  "title": "Add tests for ConvertFrom-Json",
  "updated_at": "2021-07-22T21:39:40Z"
}
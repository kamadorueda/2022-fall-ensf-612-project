{
  "_url": "https://github.com/PowerShell/PowerShell/issues/16933",
  "author": "wm2015email",
  "body": "### Prerequisites\n\n- [X] Write a descriptive title.\n- [X] Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\n- [X] Search the existing issues.\n- [X] Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\n- [X] Refer to [Differences between Windows PowerShell 5.1 and PowerShell](https://docs.microsoft.com/powershell/scripting/whats-new/differences-from-windows-powershell).\n\n### Steps to reproduce\n\nISSUE #1\r\n----------\r\n\r\nI think if you want to make powershell easy to use, then the shell should automatically strip quotes around files when calling resolve-path... its always the case that calls to things get nested and its complicated to think if you need quotes or not... my opinion is that powershell resolve-path should always strip quotes... to help users and make it easier to use...\r\n\r\n# GOOD CASE\r\nPS> $x = \"C:\\Users\\wpmoore\\Desktop\\VSC_MDU-R\\tb\\TB_VSC_B2_SRC\\AIC Calibration Strobe Signal\\\"\r\nPS> $x\r\nC:\\Users\\wpmoore\\Desktop\\VSC_MDU-R\\tb\\TB_VSC_B2_SRC\\AIC Calibration Strobe Signal\\\r\nPS> Resolve-Path -Path $x\r\n\r\nPath\r\n----\r\nC:\\Users\\wpmoore\\Desktop\\VSC_MDU-R\\tb\\TB_VSC_B2_SRC\\AIC Calibration Strobe Signal\\\r\n\r\n# BAD CASE - No automatic quote stripping from files with quotes....\r\nPS> $x = \"`\"C:\\Users\\wpmoore\\Desktop\\VSC_MDU-R\\tb\\TB_VSC_B2_SRC\\AIC Calibration Strobe Signal\\`\"\"\r\nPS> $p = Resolve-Path -Path $x\r\nResolve-Path : Cannot find drive. A drive with the name '\"C' does not exist.\r\nAt line:1 char:6\r\n+ $p = Resolve-Path -Path $x\r\n+      ~~~~~~~~~~~~~~~~~~~~~\r\n    + CategoryInfo          : ObjectNotFound: (\"C:String) [Resolve-Path], DriveNotFoundException\r\n    + FullyQualifiedErrorId : DriveNotFound,Microsoft.PowerShell.Commands.ResolvePathCommand\r\n\r\n----------\r\nISSUE #2:\r\n\r\nActually... While I'm complaining... I don't like that resolve-path doesn't have an option to resolve a path that doesn't exist yet... always need to write this bogus code bullcrap code to get what i want:.\r\n\r\n$pathfix = Resolve-Path -Path $file -ErrorAction SilentlyContinue -ErrorVariable ev\r\nif (-not($pathfix)) {\r\n    $pathfix - $ev[0].TargetObject\r\n}\r\n\r\nThis is complete bullcrap... give use a switch to resolve paths that doesn't already exist yet....  it always happens that i need to resolve a path to a place where i;m creating a new file that doens't exist yet.... why not this instead:\r\n\r\nPS> $pathfix = Resolve-Path -Path $file -NoRequireExists\r\n\r\nnow its nice and easy.....\r\n\r\n\r\n\r\n\n\n### Expected behavior\n\n```console\nPS> $x = \"`\"C:\\Users\\wpmoore\\Desktop\\VSC_MDU-R\\tb\\TB_VSC_B2_SRC\\AIC Calibration Strobe Signal\\`\"\"\r\nPS> $p = Resolve-Path -Path $x\r\nPS> Resolve-Path -Path $x\r\n\r\nPath\r\n----\r\nC:\\Users\\wpmoore\\Desktop\\VSC_MDU-R\\tb\\TB_VSC_B2_SRC\\AIC Calibration Strobe Signal\\\n```\n\n\n### Actual behavior\n\n```console\n# BAD CASE - No automatic quote stripping from files with quotes....\r\nPS> $x = \"`\"C:\\Users\\wpmoore\\Desktop\\VSC_MDU-R\\tb\\TB_VSC_B2_SRC\\AIC Calibration Strobe Signal\\`\"\"\r\nPS> $p = Resolve-Path -Path $x\r\nResolve-Path : Cannot find drive. A drive with the name '\"C' does not exist.\r\nAt line:1 char:6\r\n+ $p = Resolve-Path -Path $x\r\n+      ~~~~~~~~~~~~~~~~~~~~~\r\n    + CategoryInfo          : ObjectNotFound: (\"C:String) [Resolve-Path], DriveNotFoundException\r\n    + FullyQualifiedErrorId : DriveNotFound,Microsoft.PowerShell.Commands.ResolvePathCommand\n```\n\n\n### Error details\n\n```console\nResolve-Path : Cannot find drive. A drive with the name '\"C' does not exist.\r\nAt line:1 char:6\r\n+ $p = Resolve-Path -Path $x\r\n+      ~~~~~~~~~~~~~~~~~~~~~\r\n    + CategoryInfo          : ObjectNotFound: (\"C:String) [Resolve-Path], DriveNotFoundException\r\n    + FullyQualifiedErrorId : DriveNotFound,Microsoft.PowerShell.Commands.ResolvePathCommand\n```\n\n\n### Environment data\n\n```powershell\nResolve-Path : Cannot find drive. A drive with the name '\"C' does not exist.\r\nAt line:1 char:6\r\n+ $p = Resolve-Path -Path $x\r\n+      ~~~~~~~~~~~~~~~~~~~~~\r\n    + CategoryInfo          : ObjectNotFound: (\"C:String) [Resolve-Path], DriveNotFoundException\r\n    + FullyQualifiedErrorId : DriveNotFound,Microsoft.PowerShell.Commands.ResolvePathCommand\n```\n\n\n### Visuals\n\nN/A\r\n\r\n",
  "closed_at": null,
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Please split to 2 issues.",
      "created_at": "2022-03-02T17:19:09Z",
      "updated_at": "2022-03-02T17:19:09Z"
    }
  ],
  "created_at": "2022-02-28T14:24:04Z",
  "labels": [
    "Needs-Triage",
    "Needs-Repro"
  ],
  "number": 16933,
  "state": "open",
  "title": "Resolve-path doesn't strip quotes...",
  "updated_at": "2022-05-16T18:29:53Z"
}
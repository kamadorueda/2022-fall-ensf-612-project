{
  "_url": "https://github.com/PowerShell/PowerShell/issues/3940",
  "author": "anmenaga",
  "body": "This addresses #3789 \r\nCurrently New-ModuleManifest creates psd1 manifests in UTF-16 with BOM; this creates problems for Linux tools and Git diff'er.\r\nThis fix changes encoding of New-ModuleManifest to be UTF8 (no BOM).\r\nAlso mentioned New-ModuleManifest in \"[RFC 0020 DefaultFileEncoding](https://github.com/PowerShell/PowerShell-RFC/blob/master/1-Draft/RFC0020-DefaultFileEncoding.md)\".\r\n",
  "closed_at": "2017-06-27T19:48:26Z",
  "comments": [
    {
      "author": "joeyaiello",
      "author_association": "CONTRIBUTOR",
      "body": "As it currently stands, this is a breaking change (appropriate label added). \r\n\r\nBased on our current POR, we're okay changing the default *on non-Windows platforms*, but this shouldn't be changed (yet) on Windows until we've had the breaking change conversation. /cc @JamesWTruher ",
      "created_at": "2017-06-05T22:03:39Z",
      "updated_at": "2017-06-05T22:03:39Z"
    },
    {
      "author": "joeyaiello",
      "author_association": "CONTRIBUTOR",
      "body": "I understand that this currently breaks the `git` scenario, we just have to be thoughtful about this. ",
      "created_at": "2017-06-05T22:04:39Z",
      "updated_at": "2017-06-05T22:04:39Z"
    },
    {
      "author": "vors",
      "author_association": "COLLABORATOR",
      "body": "Are there plans to add UTF8-NoBom to powershell supported Encodings?\r\nI.e. for `Set-Content` and friends.\r\n\r\nChanging the most important scenarios is good, but it would be great to address the problem with encodings broader and consistently to help shape the conversation about breaking changes.",
      "created_at": "2017-06-06T01:53:56Z",
      "updated_at": "2017-06-06T01:53:56Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@vors UTF8noBOM is discussed in [RFC 0020 DefaultFileEncoding](https://github.com/PowerShell/PowerShell-RFC/blob/master/1-Draft/RFC0020-DefaultFileEncoding.md).",
      "created_at": "2017-06-06T03:10:28Z",
      "updated_at": "2017-06-06T03:10:28Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "New-PSSessionConfigurationFile uses `EncodingConversion.Unicode` too.",
      "created_at": "2017-06-06T03:13:57Z",
      "updated_at": "2017-06-06T03:13:57Z"
    },
    {
      "author": "joeyaiello",
      "author_association": "CONTRIBUTOR",
      "body": "@vors: first, yes. We're adding that (and making it the default across the board on Linux). The hard part is what to do with Windows (change the defaults? leave a legacy enum value for the \"traditional\" disparate defaults?) Which is why I want to have the discussion. ",
      "created_at": "2017-06-06T18:31:37Z",
      "updated_at": "2017-06-06T18:31:37Z"
    },
    {
      "author": "anmenaga",
      "author_association": "CONTRIBUTOR",
      "body": "@joeyaiello good point;\r\nPR updated to change encoding only for non-Windows.",
      "created_at": "2017-06-06T20:00:53Z",
      "updated_at": "2017-06-06T20:00:53Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "Is there an actual problem on Windows using UTF8NoBOM?  If only English is used, it's equivalent to an ascii file and Windows tools handle that just fine and I expect that to be the majority of use.  ",
      "created_at": "2017-06-06T20:23:25Z",
      "updated_at": "2017-06-06T20:23:25Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "Restarted AppVeyor due to MyGet connectivity issue",
      "created_at": "2017-06-06T21:22:01Z",
      "updated_at": "2017-06-06T21:22:01Z"
    },
    {
      "author": "joeyaiello",
      "author_association": "CONTRIBUTOR",
      "body": "@anmenaga if you could sync with @JamesWTruher before merging this, that'd be awesome. Assuming the @PowerShell/powershell-committee votes to accept tomorrow, we want to move to UTF8NoBOM everywhere. ",
      "created_at": "2017-06-06T22:19:56Z",
      "updated_at": "2017-06-06T22:19:56Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT \r\n>Is there an actual problem on Windows using UTF8NoBOM? \r\n\r\nUsers can add non-English comments in the manifest.",
      "created_at": "2017-06-07T03:15:44Z",
      "updated_at": "2017-06-07T03:15:44Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@iSazonov absolutely, but I believe the majority of usage is English.  Even with non-ascii characters, my understanding is that notepad has heuristics to determine encoding to display it correctly.  VSCode seems to support UTF8NoBom just fine.",
      "created_at": "2017-06-07T04:58:05Z",
      "updated_at": "2017-06-07T04:58:05Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": ">notepad has heuristics to determine encoding to display it correctly\r\n\r\nIt seem works on last versions only not on Windows 7/8(?).",
      "created_at": "2017-06-07T05:06:56Z",
      "updated_at": "2017-06-07T05:06:56Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "@joeyaiello  Are you saying this is blocked on a sign off from @JamesWTruher ?",
      "created_at": "2017-06-09T20:08:00Z",
      "updated_at": "2017-06-09T20:08:00Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "@joeyaiello @JamesWTruher  Do we want to document the output format of Cmdlets?",
      "created_at": "2017-06-09T20:09:51Z",
      "updated_at": "2017-06-09T20:09:51Z"
    },
    {
      "author": "joeyaiello",
      "author_association": "CONTRIBUTOR",
      "body": "@TravisEz13 yes and yes. I think the uber-point is that @JamesWTruher is doing so much work here, that it might get changed anyway (and it might just muddle his extensive notes). \r\n\r\nUltimately up to him, though. I just wanted to make sure everyone was on the same page. \r\n\r\nRegarding docs though: heck yes. We'll have a `Legacy` value for Encoding, and that will be well-documented. ",
      "created_at": "2017-06-13T18:54:50Z",
      "updated_at": "2017-06-13T18:54:50Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "@anmenaga Also, as a PowerShell team member, you need to submit the PR to update the docs before I merge this.  Please add a link to the PR here.  Thanks.",
      "created_at": "2017-06-13T22:40:34Z",
      "updated_at": "2017-06-13T22:40:34Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "For encoding changes, you might want to delay documenting as we expect big changes in this.",
      "created_at": "2017-06-14T03:06:13Z",
      "updated_at": "2017-06-14T03:06:13Z"
    },
    {
      "author": "anmenaga",
      "author_association": "CONTRIBUTOR",
      "body": "@TravisEz13\r\n1) [This PR](https://github.com/PowerShell/PowerShell-RFC/pull/95) in RFC repo was merged;\r\n2) I've ran a search in PowerShell-Docs and didn't find any mentioning of encoding for New-ModuleManifest, so there is nothing to update there. Besides, this PR will be anyway overwritten by Jim's encoding work that is arriving soon.",
      "created_at": "2017-06-16T21:47:49Z",
      "updated_at": "2017-06-16T21:47:49Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "@anmenaga Per the conversation in this PR, we want to add encoding documentation to the CmdLet docs.",
      "created_at": "2017-06-20T00:32:58Z",
      "updated_at": "2017-06-20T00:32:58Z"
    },
    {
      "author": "anmenaga",
      "author_association": "CONTRIBUTOR",
      "body": "@TravisEz13 Here is the doc PR: https://github.com/PowerShell/PowerShell-Docs/pull/1405 ",
      "created_at": "2017-06-26T21:34:29Z",
      "updated_at": "2017-06-26T21:34:29Z"
    },
    {
      "author": "kilasuit",
      "author_association": "COLLABORATOR",
      "body": "My only issue here is that although this is a change that I agree with, I think that this is where I have concerns of this causing a disparate and inconsistent behaviour between all versions of PowerShell below v6 due to the fact that New-ModuleManifest is baked into the **Microsoft.PowerShell.Core** module.\r\n\r\nI personally would **much** prefer to see that this update to the cmdlet gets released in a manner that **_fully_** supports being used on downlevel systems where PowerShell v6 is unable to be installed.\r\n\r\nHowever the only real solutions that I can really see available to be able to make that to happen would be to \r\n- Investigate the decoupling of a number of the cmdlets from the **Microsoft.PowerShell.Core** module into their own separate individual modules or a condensed updated singular module that has all the updates to any module in **Microsoft.PowerShell.Core** (not an overly fantastic solution) - similar in the idea put forward in #1979 \r\n- Look to recreate this cmdlet within the PowerShellGet module.  \r\n- Alongside the v6 updates look to release a completely updated and downlevel compatible version of the **Microsoft.PowerShell.Core** module to the PowerShell Gallery, which isn't really an overly viable solution either.\r\n\r\nIf this change could be easily replicated for downlevel versions of PowerShell I think that would be the best outcome all around.",
      "created_at": "2017-06-27T07:29:11Z",
      "updated_at": "2017-06-27T07:29:11Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "@kilasuit Thanks for the feedback.  I think most of the concerns raised would be best tracked in #1979 or a new issue.",
      "created_at": "2017-06-27T19:47:44Z",
      "updated_at": "2017-06-27T19:47:44Z"
    }
  ],
  "created_at": "2017-06-05T20:25:01Z",
  "number": 3940,
  "state": "closed",
  "title": "Change New-ModuleManifest encoding to UTF8NoBOM on non-Windows platforms",
  "updated_at": "2018-10-31T21:20:36Z"
}
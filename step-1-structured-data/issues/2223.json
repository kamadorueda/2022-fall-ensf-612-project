{
  "_url": "https://github.com/PowerShell/PowerShell/issues/2223",
  "author": "vors",
  "body": "Copied from TFS task 150409\n\nWe should be able to write something along these lines\n\n``` powershell\ninterface IFoo\n{\n  [string] foo();\n}\n\nclass Foo : IFoo\n{\n  [string] foo() { return 'foo' }\n}\n```\n",
  "closed_at": null,
  "comments": [
    {
      "author": "GeeLaw",
      "author_association": "NONE",
      "body": "Also, explicit implementation.\n",
      "created_at": "2016-09-11T17:20:42Z",
      "updated_at": "2016-09-11T17:20:42Z"
    },
    {
      "author": "forensicsguy20012004",
      "author_association": "NONE",
      "body": "I agree, this would be a great addition  to powershell\n",
      "created_at": "2016-10-05T12:48:45Z",
      "updated_at": "2016-10-05T12:48:45Z"
    },
    {
      "author": "IISResetMe",
      "author_association": "COLLABORATOR",
      "body": "I'd love to work on an implementation of this (I already have a ref implementation in PowerShell: https://github.com/IISResetMe/Legislator).\r\n\r\nThe creation and emission of new types seem pretty straightforward, but I'd need some help with the parsing bits, adding new keywords and expression trees",
      "created_at": "2018-04-10T23:22:01Z",
      "updated_at": "2018-04-10T23:22:01Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@daxian-dbw can help you out, but he's going to be attending PSConf.EU next week\r\n\r\ncc @rjmholt ",
      "created_at": "2018-04-13T01:17:52Z",
      "updated_at": "2018-04-13T01:17:52Z"
    },
    {
      "author": "rjmholt",
      "author_association": "COLLABORATOR",
      "body": "@IISResetMe I saw your lightning demo and went to your repo afterward. Really amazing work. Your interface DSL actually inspired me, both in how rich it was and since it means interfaces could be made definable in PowerShell without necessarily adding them as a universal language feature. With that said, more complicated things like inheritance might not be so straightforward and would probably need to be part of the parser.\r\n\r\nThere's a discussion of some of the class-specific stuff in #6418 as well.\r\n\r\nBut for settling on the syntax and general design, the best place to start might be with an [RFC](https://github.com/PowerShell/powershell-rfc/blob/master/RFC0000-RFC-Process.md), just to drive discussion on how interfaces should look and what features should be supported in PowerShell. Especially so that the PowerShell Committee can consider it.",
      "created_at": "2018-04-13T03:03:56Z",
      "updated_at": "2018-04-13T03:03:56Z"
    },
    {
      "author": "IISResetMe",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT Cool, I'll be at PSConfEU as well, will try to catch up with @daxian-dbw!\r\n\r\n@rjmholt Thank you for the kind words. I'll try to add support for inheritance to Legislator over the next week, but based on the MSIL generated by CSC for multiple inherited interfaces it looks quite trivial to add.\r\n\r\nIf we go for something like what @vors suggest here, interfaces (including inheritance) would require just a subset of the existing grammar already in place for classes, the only thing missing is basically the `interface` keyword itself \ud83d\ude03 \r\n\r\nI'll try to write up an RFC in the coming weeks and submit it to the RFC repo!  ",
      "created_at": "2018-04-13T16:27:51Z",
      "updated_at": "2018-04-13T16:27:51Z"
    },
    {
      "author": "IISResetMe",
      "author_association": "COLLABORATOR",
      "body": "Thanks to a few pointers from @daxian-dbw last month I got unstuck again \ud83c\udf89 \r\n\r\nIf anyone wants to check out a working implementation of parser support for `interface` declarations, I've pushed it here: https://github.com/IISResetMe/PowerShell/tree/feature/interfaces \r\n\r\nI still need to add a type compilation step for interfaces in `TypeOps`, already have a basic routine working just need to merge it into that branch, will try and add it during this week ",
      "created_at": "2018-11-13T14:23:24Z",
      "updated_at": "2018-11-13T14:23:24Z"
    },
    {
      "author": "IISResetMe",
      "author_association": "COLLABORATOR",
      "body": "Here we go: https://github.com/IISResetMe/PowerShell/commit/156e010413cbae1c7f5d5aa36e5a8d7116544eed\r\n\r\nParser rules for interface members are still slightly buggy (`;` not recognized as statement terminator atm), but it at least produces correct interface types as can bee seen below \ud83d\ude04 \r\n\r\n![image](https://user-images.githubusercontent.com/7413755/48620140-4adefe00-e99f-11e8-8988-2b6133bc650c.png)\r\n\r\nSyntax in this implementation also doesn't support get/set control, but it's arguably of limited value unless we decide on whether class properties in PowerShell should behave like fields or actualy properties (at which point we need to generate getters and setters implicitly)",
      "created_at": "2018-11-16T12:00:29Z",
      "updated_at": "2018-11-16T12:00:29Z"
    },
    {
      "author": "vors",
      "author_association": "COLLABORATOR",
      "body": "> class properties in PowerShell should behave like fields or actualy properties (at which point we need to generate getters and setters implicitly)\r\n\r\nWe are doing it already\r\n\r\nhttps://github.com/PowerShell/PowerShell/blob/dedddb6b59b8b01fadb4312bbddc7992a6cbbe0a/src/System.Management.Automation/engine/parser/PSType.cs#L605",
      "created_at": "2018-11-17T05:49:16Z",
      "updated_at": "2018-11-17T05:49:16Z"
    },
    {
      "author": "IISResetMe",
      "author_association": "COLLABORATOR",
      "body": "@vors I see, must be something else that trips up then, will keep digging\r\n\r\n![image](https://user-images.githubusercontent.com/7413755/48659475-0fe9d280-ea52-11e8-842a-a9d5b539addc.png)\r\n\r\n```\r\ninterface I1 {\r\n  [string]$S\r\n}\r\nclass C1 : I1 {\r\n  [string]$S\r\n}\r\nAt line:6 char:1\r\n+ class C1 : I1 {\r\n+ ~~~~~~~~~~~~~~~\r\nError during creation of type \"C1\". Error message:\r\nMethod 'get_S' in type 'C1' from assembly 'PowerShell Class Assembly, Version=1.0.0.1, Culture=neutral, PublicKeyToken=null' does not have an implementation.\r\n+ CategoryInfo          : ParserError: (:) [], ParentContainsErrorRecordException\r\n+ FullyQualifiedErrorId : TypeCreationError\r\n```",
      "created_at": "2018-11-17T09:18:34Z",
      "updated_at": "2018-11-17T09:19:26Z"
    },
    {
      "author": "ThomasNieto",
      "author_association": "CONTRIBUTOR",
      "body": "@IISResetMe are you still working on this? It would be nice to have interface definitions in PowerShell.",
      "created_at": "2020-01-12T05:24:50Z",
      "updated_at": "2020-01-12T05:24:50Z"
    },
    {
      "author": "IISResetMe",
      "author_association": "COLLABORATOR",
      "body": "@ThomasNieto no, I completely dropped the ball on this, but looks like @rjmholt and @daxian-dbw might pick it up in a near future, please see https://github.com/PowerShell/PowerShell-RFC/pull/152#issuecomment-594167624",
      "created_at": "2020-03-07T12:26:54Z",
      "updated_at": "2020-03-07T12:26:54Z"
    },
    {
      "author": "joeyaiello",
      "author_association": "CONTRIBUTOR",
      "body": "To be clear, @daxian-dbw and @rjmholt can *review* the implementation, but they don't currently have the time to take it and run it towards a production implementation. Are you still interested in taking it all the way to the finish line if that's the case? ",
      "created_at": "2020-03-10T19:57:05Z",
      "updated_at": "2020-03-10T19:57:05Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "If necessary, I can pick up the remainder of the necessary work once y'all are done reviewing what's currently done.\r\n\r\nI will probably need you to brief me on what's still left in the to-do pile, though, @IISResetMe \ud83d\ude01 ",
      "created_at": "2020-03-10T23:23:14Z",
      "updated_at": "2020-03-10T23:23:14Z"
    },
    {
      "author": "Xpyder",
      "author_association": "NONE",
      "body": "I think this is the right place for this but not 100% sure so if it's not please point me in the right place to post\r\n\r\nI'm trying to figure out how to implement [Composition Over Inheritance](https://www.makeuseof.com/tag/basic-programming-principles/#composition-over-inheritance) in my powershell scripts.\r\n\r\nI think it would go like this:\r\n\r\nDiagram for clarity:\r\n\r\n![2021-01-20_17-32-32](https://user-images.githubusercontent.com/12039454/105268405-09ca7180-5b47-11eb-813e-4d233a1d5f26.png)\r\n\r\n\r\n```\r\n# Actions #\r\ninterface Swims {\r\n    [bool] Swim();\r\n}\r\n\r\ninterface Lands {\r\n    [bool] Land( $land_spot );\r\n}\r\n\r\ninterface Flies : Lands {\r\n    [bool] Fly( $destination );\r\n}\r\n\r\n\r\n# Animals #\r\nclass Duck : Flies, Swims {\r\n    Duck(){}\r\n    \r\n    [bool] Fly( $destination, $land_spot ){\r\n        $this.Fly($destination);\r\n        $this.Land($land_spot)\r\n        return $true\r\n    }\r\n\r\n    [bool] Fly( $destination ){\r\n        write-host \"The duck flies to $($destination)\"\r\n        return $true\r\n    }\r\n\r\n    [bool] Land( $land_spot ){\r\n        write-host \"The duck lands at $($land_spot)\"\r\n        return $true\r\n    }\r\n\r\n    [bool] Swim(){\r\n        write-host \"The duck paddles it's flippers idly\"\r\n        return $true\r\n    }\r\n}\r\n\r\nclass Dove : Flies {\r\n    [bool] Fly( $destination, $land_spot ){\r\n        $this.Fly($destination);\r\n        $this.Land($land_spot)\r\n        return $true\r\n    }\r\n\r\n    [bool] Fly( $destination ){\r\n        write-host \"The dove flies to $($destination)\"\r\n        return $true\r\n    }\r\n\r\n    [bool] Land( $land_spot ){\r\n        write-host \"The dove lands at $($land_spot)\"\r\n        return $true\r\n    }\r\n}\r\n\r\n\r\n# Declarations #\r\n$duck = [Duck]::New()\r\n$dove = [Dove]::New()\r\n\r\nfunction Fly-To([Flies]$flier, $destination){ return $flier.Fly($destination) }\r\nfunction Swim-Idle([Swims]$swimmer){ return $swimmer.Swim() }\r\n\r\n\r\n# Tests #\r\n\r\n## Should Work ##\r\nFly-To $duck \"Minnesota\"\r\nFly-To $dove \"New York\"\r\nSwim-Idle $duck\r\n\r\n\r\n## Should Fail ##\r\n\r\n# should error because $dove doesn't implement [Swims]\r\n# or if Duck Typing then because it doesn't implement $_.Swim()\r\nSwim-Idle $dove\r\n```\r\n\r\nThe net result being that I don't have to create different versions of Fly-To for Duck and Dove, but Swim-To gives a meaningful error when trying to make the Dove swim\r\n\r\nI take it these aren't currently implemented (I can't find documentation for this anywhere) so I was going to submit a feature request but I think this ticket is a match for this pattern?  But let me know if it should be a separate issue",
      "created_at": "2021-01-21T01:44:52Z",
      "updated_at": "2021-01-21T02:02:06Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "Yeah, this more or less would allow for that pattern in full. \r\n\r\nFrom discussions with @IISResetMe as far as I recall, he had the features more or less ready to go, but there were some design decisions he felt shouldn't be made alone and he was trying to solicit feedback on his implementation as @joeyaiello mentioned above. \r\n\r\nI don't think that's gone anywhere thus far, though, as far as I can recall the implementation hasn't really had a good look that I'm aware of.",
      "created_at": "2021-01-21T02:02:16Z",
      "updated_at": "2021-01-21T02:02:16Z"
    }
  ],
  "created_at": "2016-09-10T00:11:19Z",
  "labels": [
    "WG-Language",
    "Up-for-Grabs"
  ],
  "number": 2223,
  "state": "open",
  "title": "Support interface declaration using classes",
  "updated_at": "2021-01-21T02:02:16Z"
}
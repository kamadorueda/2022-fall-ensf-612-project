{
  "_url": "https://github.com/PowerShell/PowerShell/issues/2068",
  "author": "glennsarti",
  "body": "## Steps to reproduce\n1. Create `c:\\test.txt` with the following content\n\n``` powershell\nfunction foo\n{\n  Write-Host \"Hello foo\"\n}\n\nfoo\n\n```\n\nNote - The newline at the end is requried\n1. Execute the following command from a Command Prompt (not within powershell)\n\n```\npowershell -NoProfile -NonInteractive -Nologo -ExecutionPolicy Bypass -Command - < c:\\test.txt\n```\n## Expected behavior\n\nConsole should write out\n\n```\nHello foo\n```\n## Actual behavior\n\n```\nAt line:1 char:13\n+ function foo\n+             ~\nMissing function body in function declaration.\n    + CategoryInfo          : ParserError: (:) [], ParentContainsErrorRecordException\n    + FullyQualifiedErrorId : MissingFunctionBody\n\n\n\n  Write-Host \"Hello foo\"\n\n\nfoo : The term 'foo' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the\nspelling of the name, or if a path was included, verify that the path is correct and try again.\nAt line:1 char:1\n+ foo\n+ ~~~\n    + CategoryInfo          : ObjectNotFound: (foo:String) [], CommandNotFoundException\n    + FullyQualifiedErrorId : CommandNotFoundException\n\n```\n## Also affects\n\nThis is not just limited to functions\n\nThis also affects `if`\n\n``` powershell\nif (1 -eq 1)\n{\n  Write-Host \"Hello if\"\n}\n\n```\n\nThis also affects `try catch`\n\n``` powershell\ntry\n{\n  Write-Host \"Hello try\"\n}\ncatch\n{\n  Write-Host \"Hello catch\"  \n}\n\n```\n\nIt appears that anything that has a implied script block start (curly brace) on a subsequent line is affected BUT only if it's not inside a script block already\n\ne.g. the following behaves as expected\n\n``` powershell\nif (1 -eq 1) {\n  if (1 -eq 1)\n  {\n    Write-Host \"Hello if\"\n  }\n}\n\n\n```\n\nNote - This requires TWO newlines at the end\n## Environment data\n\nSystem where it fails\nWindows 10 Enterprise (64bit) Build 1607 - 14393.82.amd64fre.rs1_release.160805-1735\n\n``` powershell\n> $PSVersionTable\nName                           Value\n----                           -----\nPSVersion                      5.1.14393.82\nPSEdition                      Desktop\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\nBuildVersion                   10.0.14393.82\nCLRVersion                     4.0.30319.42000\nWSManStackVersion              3.0\nPSRemotingProtocolVersion      2.3\nSerializationVersion           1.1.0.1\n```\n## Additional tests\n\nThis test works on the following systems\n\nWindows Server 2012 R2 (64bit) - 9600.18289.amd64fre.winblue_ltsb.160328-1315\n\n``` powershell\n> $PSVersionTable\nName                           Value\n----                           -----\nPSVersion                      5.0.10586.117\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\nBuildVersion                   10.0.10586.117\nCLRVersion                     4.0.30319.34209\nWSManStackVersion              3.0\nPSRemotingProtocolVersion      2.3\nSerializationVersion           1.1.0.1\n```\n\nWindows Server 2012 R2 (64bit) - 9600.18378.amd64fre.winblue_ltsb.160611-0600\n\n``` powershell\n> $PSVersionTable\nName                           Value\n----                           -----\nPSVersion                      4.0\nWSManStackVersion              3.0\nSerializationVersion           1.1.0.1\nCLRVersion                     4.0.30319.42000\nBuildVersion                   6.3.9600.17400\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0}\nPSRemotingProtocolVersion      2.2\n```\n## Workaround\n\nBy changing the initial curly brace to be on the same line as the function definition the behaviour of STDIN is restored  i.e.\n\nChange `C:\\test.txt` to\n\n``` powershell\nfunction foo {\n  Write-Host \"Hello foo\"\n}\n\nfoo\n\n```\n",
  "closed_at": "2016-08-31T20:52:47Z",
  "comments": [],
  "created_at": "2016-08-25T21:50:11Z",
  "labels": [
    "Issue-Bug",
    "WG-Interactive-Console"
  ],
  "number": 2068,
  "state": "closed",
  "title": "(PS 5.1.14393) Commands from STDIN don't honour beginning curly bracket on next line",
  "updated_at": "2016-08-31T20:52:47Z"
}
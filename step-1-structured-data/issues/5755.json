{
  "_url": "https://github.com/PowerShell/PowerShell/issues/5755",
  "author": "bergmeister",
  "body": "## PR Summary\r\n\r\nBefore this PR, when a `WiX` compilation error occurs then an error is thrown, which appears in the log with details but the AppVeyor build itself is still marked as green.\r\nThis PR makes the console host also return an exit code of -1 when being run on `AppVeyor` so that it can then interpret it as a build failure and mark the build as red. It uses the fact that AppVeyor defines an environment variable named CI. Exiting is OK since the MSI build is the last step in CI and nothing happens after that.\r\nThe git history shows a test build that proves that this works if the installer was broken.\r\n\r\n## PR Checklist\r\n\r\nNote: Please mark anything not applicable to this PR `NA`.\r\n\r\n- [x] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - [x] Use the present tense and imperative mood when describing your changes\r\n- [x] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [NA] User facing [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - [NA] Issue filed - Issue link:\r\n- [x] [Change is not breaking](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)\r\n- [NA] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n    - [ NA] [Add `[feature]` if the change is significant or affectes feature tests](https://github.com/PowerShell/PowerShell/blob/master/docs/testing-guidelines/testing-guidelines.md#requesting-additional-tests-for-a-pr)\r\n- [] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n",
  "closed_at": "2018-01-02T23:08:33Z",
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "I restarted Travis CI Linux job.",
      "created_at": "2017-12-29T13:41:40Z",
      "updated_at": "2017-12-29T13:41:40Z"
    },
    {
      "author": "markekraus",
      "author_association": "CONTRIBUTOR",
      "body": "@bergmeister this is where you tested it, correct? https://ci.appveyor.com/project/bergmeister/powershell/build/v6.1.0-preview.204 ",
      "created_at": "2017-12-29T13:58:40Z",
      "updated_at": "2017-12-29T13:58:40Z"
    },
    {
      "author": "bergmeister",
      "author_association": "CONTRIBUTOR",
      "body": "@markekraus Yes, sorry, it seems my link was broken, it is fixed now in the PR description. If you look at the commit history, the first commit contained also a syntax error to test that AppVeyor would actually fail and the 2nd commit reverted the syntax error. Maybe not clean in terms of git history but the PR commit gets squashed anyway.\r\nThanks @iSazonov but the travis CI build is not affected anyway due to MSI being Windows only.",
      "created_at": "2017-12-29T15:16:51Z",
      "updated_at": "2017-12-29T15:18:57Z"
    }
  ],
  "created_at": "2017-12-29T12:57:26Z",
  "number": 5755,
  "state": "closed",
  "title": "Fail AppVeyor Build if MSI does not build",
  "updated_at": "2018-01-03T10:39:58Z"
}
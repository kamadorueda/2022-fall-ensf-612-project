{
  "_url": "https://github.com/PowerShell/PowerShell/issues/4802",
  "author": "SteveL-MSFT",
  "body": "missed -ErrorAction Stop\r\nchanged new-service to return error when given unsupported startuptype\r\n\r\nFix https://github.com/PowerShell/PowerShell/issues/4800\r\nFix https://github.com/PowerShell/PowerShell/issues/4803\r\n<!--\r\n\r\nIf you are a PowerShell Team member, please make sure you choose the Reviewer(s) and Assignee for your PR.\r\nIf you are not from the PowerShell Team, you can leave the fields blank and the Maintainers will choose them for you. If you are familiar with the team, feel free to mention some Reviewers yourself.\r\n\r\nFor more information about the roles of Reviewer and Assignee, refer to [CONTRIBUTING.md](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md).\r\n\r\n-->",
  "closed_at": "2017-09-15T08:24:41Z",
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Blocked by #4803.",
      "created_at": "2017-09-11T03:09:48Z",
      "updated_at": "2017-09-11T03:09:48Z"
    },
    {
      "author": "markekraus",
      "author_association": "CONTRIBUTOR",
      "body": "@SteveL-MSFT something should probably be done about [Set-Service.Tests.ps1#L25](https://github.com/PowerShell/PowerShell/blob/fb60c47a1ecbca2a6f287e0626a372497112f0a3/test/powershell/Modules/Microsoft.PowerShell.Management/Set-Service.Tests.ps1#L25). That will continue to fail on Linux and macOS as the literal will still be parsed even though the `IT` is being skipped, and `Get-Service` is unavailable on Linux/macOS.",
      "created_at": "2017-09-11T22:38:27Z",
      "updated_at": "2017-09-11T22:38:27Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@markekraus I see.  will fix.",
      "created_at": "2017-09-11T23:07:48Z",
      "updated_at": "2017-09-11T23:07:48Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@iSazonov @daxian-dbw feedback addressed",
      "created_at": "2017-09-12T23:00:06Z",
      "updated_at": "2017-09-12T23:00:06Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@daxian-dbw feedback addressed",
      "created_at": "2017-09-14T01:05:10Z",
      "updated_at": "2017-09-14T01:05:10Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@daxian-dbw can you review latest change?",
      "created_at": "2017-09-14T19:47:04Z",
      "updated_at": "2017-09-14T19:47:04Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@SteveL-MSFT we cannot pass the value (-1) to `-StartupType` parameter. The parameter binding will fail because powershell cannot convert -1 to `[System.ServiceProcess.ServiceStartMode]`. That means `StartupType` in `New-Service` can never be `-1`, so we should be good without the last commit.\r\nThat's why I crossed out my original comment :)",
      "created_at": "2017-09-14T20:41:59Z",
      "updated_at": "2017-09-14T20:45:41Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@daxian-dbw yeah, I went through the code and for `New-Service`, StartupType defaults to Auto and can't ever be set to (-1), so I'll revert the last commit.",
      "created_at": "2017-09-14T22:17:11Z",
      "updated_at": "2017-09-14T22:17:11Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "Last commit was reverted.  We should be good to go.",
      "created_at": "2017-09-14T23:24:05Z",
      "updated_at": "2017-09-14T23:24:05Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT @daxian-dbw  Is the PR ready to merge?",
      "created_at": "2017-09-15T03:24:08Z",
      "updated_at": "2017-09-15T03:24:08Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@iSazonov Yes, it's good to go.\r\nBTW, please don't directly use the history commit messages as the description when squashing and merging. Instead, it's better to summarize the changes of the PR.",
      "created_at": "2017-09-15T04:53:01Z",
      "updated_at": "2017-09-15T04:55:33Z"
    }
  ],
  "created_at": "2017-09-10T21:38:27Z",
  "number": 4802,
  "state": "closed",
  "title": "fix set-service failing test",
  "updated_at": "2017-09-15T14:28:39Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/15040",
  "author": "stwolfe",
  "body": "I have a C# application that instantiates a remote powershell and invokes some small scripts on over the remote connection.  All of this work great when I am referencing a shared instance of .NET 5.   But when I run that application when it is published standalone, I get a missing dll issue.\r\n\r\n```\r\nPS > aseutil tiering egressperf \r\n\r\nOne or more errors occurred. (Could not load file or assembly 'Microsoft.Management.Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'. The system cannot find the file specified.)\r\n\r\nCould not load file or assembly 'Microsoft.Management.Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'. The system cannot find the file specified.\r\n\r\n   at System.Management.Automation.CimClassDeserializationCache`1..ctor()\r\n   at System.Management.Automation.DeserializationContext..ctor(DeserializationOptions options, PSRemotingCryptoHelper cryptoHelper)\r\n   at System.Management.Automation.Remoting.Fragmentor..ctor(Int32 fragmentSize, PSRemotingCryptoHelper cryptoHelper)\r\n   at System.Management.Automation.Remoting.BaseTransportManager..ctor(PSRemotingCryptoHelper cryptoHelper)\r\n   at System.Management.Automation.Remoting.Client.BaseClientTransportManager..ctor(Guid runspaceId, PSRemotingCryptoHelper cryptoHelper)\r\n   at System.Management.Automation.Remoting.Client.BaseClientSessionTransportManager..ctor(Guid runspaceId, PSRemotingCryptoHelper cryptoHelper)\r\n   at System.Management.Automation.Remoting.Client.WSManClientSessionTransportManager..ctor(Guid runspacePoolInstanceId, WSManConnectionInfo connectionInfo, PSRemotingCryptoHelper cryptoHelper, String sessionName)\r\n   at System.Management.Automation.Runspaces.WSManConnectionInfo.CreateClientSessionTransportManager(Guid instanceId, String sessionName, PSRemotingCryptoHelper cryptoHelper)\r\n   at System.Management.Automation.Remoting.ClientRemoteSessionDSHandlerImpl..ctor(ClientRemoteSession session, PSRemotingCryptoHelper cryptoHelper, RunspaceConnectionInfo connectionInfo, URIDirectionReported uriRedirectionHandler)\r\n   at System.Management.Automation.Remoting.ClientRemoteSessionImpl..ctor(RemoteRunspacePoolInternal rsPool, URIDirectionReported uriRedirectionHandler)\r\n   at System.Management.Automation.Internal.ClientRunspacePoolDataStructureHandler.CreateClientRemoteSession(RemoteRunspacePoolInternal rsPoolInternal)\r\n   at System.Management.Automation.Internal.ClientRunspacePoolDataStructureHandler..ctor(RemoteRunspacePoolInternal clientRunspacePool, TypeTable typeTable)\r\n   at System.Management.Automation.Runspaces.Internal.RemoteRunspacePoolInternal.CreateDSHandler(TypeTable typeTable)\r\n   at System.Management.Automation.Runspaces.Internal.RemoteRunspacePoolInternal..ctor(Int32 minRunspaces, Int32 maxRunspaces, TypeTable typeTable, PSHost host, PSPrimitiveDictionary applicationArguments, RunspaceConnectionInfo connectionInfo, String name)\r\n   at System.Management.Automation.Runspaces.RunspacePool..ctor(Int32 minRunspaces, Int32 maxRunspaces, TypeTable typeTable, PSHost host, PSPrimitiveDictionary applicationArguments, RunspaceConnectionInfo connectionInfo, String name)\r\n   at System.Management.Automation.RemoteRunspace..ctor(TypeTable typeTable, RunspaceConnectionInfo connectionInfo, PSHost host, PSPrimitiveDictionary applicationArguments, String name, Int32 id)\r\n   at System.Management.Automation.Runspaces.RunspaceFactory.CreateRunspace(RunspaceConnectionInfo connectionInfo, PSHost host, TypeTable typeTable, PSPrimitiveDictionary applicationArguments, String name)\r\n   at System.Management.Automation.Runspaces.RunspaceFactory.CreateRunspace(RunspaceConnectionInfo connectionInfo, PSHost host, TypeTable typeTable)\r\n   at System.Management.Automation.Runspaces.RunspaceFactory.CreateRunspace(PSHost host, RunspaceConnectionInfo connectionInfo)\r\n   at System.Management.Automation.Runspaces.RunspaceFactory.CreateRunspace(RunspaceConnectionInfo connectionInfo)\r\n   at Utility.Windows.Management.Automation.RemoteSession.OpenRunspace(Boolean ssh) in C:\\Repos\\EdgeOne.Developer\\Developer\\stwolfe\\src\\Libraries\\Utility\\Management\\Automation\\RemoteSession.cs:line 122\r\n   at Utility.Windows.Management.Automation.RemoteSession.InvokeScript(String script, IDictionary`2 args, CancellationToken cancelToken, String callerName) in C:\\Repos\\EdgeOne.Developer\\Developer\\stwolfe\\src\\Libraries\\Utility\\Management\\Automation\\RemoteSession.cs:line 44\r\n   at Utility.AzureStackEdge.ApplianceModel.AseNode.SetTestStage(Int32 stage) in C:\\Repos\\EdgeOne.Developer\\Developer\\stwolfe\\src\\Libraries\\Utility.Windows\\AzureStackEdge\\ApplianceModel\\AseNode.cs:line 568\r\n   at Utility.AzureStackEdge.ApplianceModel.AseAppliance.<>c__DisplayClass20_0.<SetTestStage>b__0(AseNode d) in C:\\Repos\\EdgeOne.Developer\\Developer\\stwolfe\\src\\Libraries\\Utility.Windows\\AzureStackEdge\\ApplianceModel\\AseAppliance.cs:line 156\r\n   at Utility.AzureStackEdge.ApplianceModel.AseAppliance.<>c__DisplayClass12_0.<ProcessOnAllNodes>b__0(AseNode d) in C:\\Repos\\EdgeOne.Developer\\Developer\\stwolfe\\src\\Libraries\\Utility.Windows\\AzureStackEdge\\ApplianceModel\\AseAppliance.cs:line 88\r\nASE Development Utility 0.0.1-preview\r\n```",
  "closed_at": "2021-03-16T20:48:44Z",
  "comments": [
    {
      "author": "stwolfe",
      "author_association": "NONE",
      "body": "Here are the packages I am referencing.\r\n\r\n![image](https://user-images.githubusercontent.com/27844532/111324127-7db16380-8638-11eb-9664-a1127dfd2e8a.png)\r\n",
      "created_at": "2021-03-16T14:18:05Z",
      "updated_at": "2021-03-16T14:18:05Z"
    },
    {
      "author": "stwolfe",
      "author_association": "NONE",
      "body": "I think I found at least a work around.  I was publishing with win-x64, and NOT win10-x64.  \r\n\r\nWith win10-x64 standalone works.",
      "created_at": "2021-03-16T20:48:44Z",
      "updated_at": "2021-03-16T20:48:44Z"
    }
  ],
  "created_at": "2021-03-16T14:17:01Z",
  "number": 15040,
  "state": "closed",
  "title": "My bug report",
  "updated_at": "2021-03-16T20:48:44Z"
}
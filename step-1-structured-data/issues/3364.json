{
  "_url": "https://github.com/PowerShell/PowerShell/issues/3364",
  "author": "SteveL-MSFT",
  "body": "code was indexing outside of it's range for the last element causing an exception which fails the whole discovery operation\r\n\r\naddresses #1345 \r\n\r\nneed some pointers on how to add a test for this",
  "closed_at": "2017-03-21T15:23:52Z",
  "comments": [
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "Didn't find any existing tests nor tests for TabExpansion++ so not sure how to validate",
      "created_at": "2017-03-18T02:12:19Z",
      "updated_at": "2017-03-18T02:12:19Z"
    },
    {
      "author": "lzybkr",
      "author_association": "MEMBER",
      "body": "You don't need TabExpansionPlusPlus.\r\n\r\nYou can look at:\r\n\r\n```\r\n#212 PS> rg TabExpansion2\r\npowershell\\Host\\TabCompletion\\BugFix.Tests.ps1\r\n4:        $result = TabExpansion2 -inputScript \"[system.manage\" -cursorColumn \"[system.manage\".Length\r\n11:        $result = TabExpansion2 -inputScript \"1 -sp\" -cursorColumn \"1 -sp\".Length\r\n18:        $result = TabExpansion2 -inputScript \"1 -a\" -cursorColumn \"1 -a\".Length\r\n25:        $result = TabExpansion2 -inputScript \"[pscu\" -cursorColumn \"[pscu\".Length\r\n#213 PS> rg CompleteInput\r\npowershell\\Language\\CompletionTestSupport.psm1\r\n69:    $results = [System.Management.Automation.CommandCompletion]::CompleteInput(\r\n\r\npowershell\\Language\\Classes\\Scripting.Classes.BasicParsing.Tests.ps1\r\n613:        $completions = [System.Management.Automation.CommandCompletion]::CompleteInput($line, $line.Length, $null)\r\n\r\npowershell\\Language\\Parser\\ExtensibleCompletion.Tests.ps1\r\n63:    $results = [System.Management.Automation.CommandCompletion]::CompleteInput(\r\n```",
      "created_at": "2017-03-18T02:35:21Z",
      "updated_at": "2017-03-18T02:35:21Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "Test added",
      "created_at": "2017-03-18T04:44:35Z",
      "updated_at": "2017-03-18T04:44:35Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@lzybkr anything else needed?",
      "created_at": "2017-03-21T01:11:24Z",
      "updated_at": "2017-03-21T01:11:24Z"
    }
  ],
  "created_at": "2017-03-18T00:07:45Z",
  "number": 3364,
  "state": "closed",
  "title": "tab expansion not working correctly for some parameters",
  "updated_at": "2017-03-21T19:53:26Z"
}
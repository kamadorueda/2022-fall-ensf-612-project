{
  "_url": "https://github.com/PowerShell/PowerShell/issues/13096",
  "author": "erenturkm",
  "body": "I need to call Get-NetAdapter from Powershell SDK. When I call directly, I get \"The term 'Get-NetAdapter' is not recognized as the name of a cmdlet, function, script file, or operable program\". So I tried calling Import-Module NetApdater and receive large number of errors.\r\n\r\n## Steps to reproduce\r\n\r\n```powershell\r\nImport-Module NetAdapter\r\nGet-NetAdapter\r\n```\r\n\r\n## Expected behavior\r\nI expect to receive the list of Network Adapters.\r\n\r\n## Actual behavior\r\nFile C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\NetAdapter\\MSFT_NetAdapter.cmdletDefinition.cdxml cannot be loaded because running scripts is disabled on this system. For more information, see about_Execution_Policies at https://go.microsoft.com/fwlink/?LinkID=135170.-2146233087,File C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\NetAdapter\\MSFT_NetAdapterAdvancedProperty.cmdletDefinition.cdxml cannot be loaded because running scripts is disabled on this system. For more information, see about_Execution_Policies at https://go.microsoft.com/fwlink/?LinkID=135170.-2146233087,File C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\NetAdapter\\MSFT_NetAdapterBinding.cmdletDefinition.cdxml cannot be loaded because running scripts is disabled on this system. For more information, see about_Execution_Policies at https://go.microsoft.com/fwlink/?LinkID=135170.-2146233087,File C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\NetAdapter\\MSFT_NetAdapterChecksumOffload.cdxml cannot be loaded because running scripts is disabled on this system. For more information, see about_Execution_Policies at https://go.microsoft.com/fwlink/?LinkID=135170.-2146233087,File C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\NetAdapter\\MSFT_NetAdapterEncapsulatedPacketTaskOffload.cdxml cannot be loaded because running scripts is disabled on this system. For more information, see about_Execution_Policies at https://go.microsoft.com/fwlink/?LinkID=135170.-2146233087,File C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\NetAdapter\\MSFT_NetAdapterHardwareInfo.cmdletDefinition.cdxml cannot be loaded because running scripts is disabled on this system. For more information, see about_Execution_Policies at https://go.microsoft.com/fwlink/?LinkID=135170.-2146233087,File C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\NetAdapter\\MSFT_NetAdapterIPsecOffload.cdxml cannot be loaded because running scripts is disabled on this system. For more information, see about_Execution_Policies at https://go.microsoft.com/fwlink/?LinkID=135170.-2146233087,File C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\NetAdapter\\MSFT_NetAdapterLso.cdxml cannot be loaded because running scripts is disabled on this system. For more information, see about_Execution_Policies at https://go.microsoft.com/fwlink/?LinkID=135170.-2146233087,File C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\NetAdapter\\MSFT_NetAdapterPowerManagement.cmdletDefinition.cdxml cannot be loaded because running scripts is disabled on this system. For more information, see about_Execution_Policies at https://go.microsoft.com/fwlink/?LinkID=135170.-2146233087,File C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\NetAdapter\\MSFT_NetAdapterQos.cdxml cannot be loaded because running scripts is disabled on this system. For more information, see about_Execution_Policies at https://go.microsoft.com/fwlink/?LinkID=135170.-2146233087,File C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\NetAdapter\\MSFT_NetAdapterRdma.cdxml cannot be loaded because running scripts is disabled on this system. For more information, see about_Execution_Policies at https://go.microsoft.com/fwlink/?LinkID=135170.-2146233087,File C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\NetAdapter\\MSFT_NetAdapterRsc.cdxml cannot be loaded because running scripts is disabled on this system. For more information, see about_Execution_Policies at https://go.microsoft.com/fwlink/?LinkID=135170.-2146233087,File C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\NetAdapter\\MSFT_NetAdapterRss.cmdletDefinition.cdxml cannot be loaded because running scripts is disabled on this system. For more information, see about_Execution_Policies at https://go.microsoft.com/fwlink/?LinkID=135170.-2146233087,File C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\NetAdapter\\MSFT_NetAdapterSriov.cdxml cannot be loaded because running scripts is disabled on this system. For more information, see about_Execution_Policies at https://go.microsoft.com/fwlink/?LinkID=135170.-2146233087,File C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\NetAdapter\\MSFT_NetAdapterSriovVf.cmdletDefinition.cdxml cannot be loaded because running scripts is disabled on this system. For more information, see about_Execution_Policies at https://go.microsoft.com/fwlink/?LinkID=135170.-2146233087,File C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\NetAdapter\\MSFT_NetAdapterStatistics.cmdletDefinition.cdxml cannot be loaded because running scripts is disabled on this system. For more information, see about_Execution_Policies at https://go.microsoft.com/fwlink/?LinkID=135170.-2146233087,File C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\NetAdapter\\MSFT_NetAdapterVmq.cmdletDefinition.cdxml cannot be loaded because running scripts is disabled on this system. For more information, see about_Execution_Policies at https://go.microsoft.com/fwlink/?LinkID=135170.-2146233087,File C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\NetAdapter\\MSFT_NetAdapterVmqQueue.cmdletDefinition.cdxml cannot be loaded because running scripts is disabled on this system. For more information, see about_Execution_Policies at https://go.microsoft.com/fwlink/?LinkID=135170.-2146233087,File C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\NetAdapter\\MSFT_NetAdapterVPort.cmdletDefinition.cdxml cannot be loaded because running scripts is disabled on this system. For more information, see about_Execution_Policies at https://go.microsoft.com/fwlink/?LinkID=135170.-2146233087,File C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\NetAdapter\\MSFT_NetAdapterPacketDirect.cdxml cannot be loaded because running scripts is disabled on this system. For more information, see about_Execution_Policies at https://go.microsoft.com/fwlink/?LinkID=135170.-2146233087,File C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\NetAdapter\\MSFT_NetAdapterUso.cdxml cannot be loaded because running scripts is disabled on this system. For more information, see about_Execution_Policies at https://go.microsoft.com/fwlink/?LinkID=135170.-2146233087,The term 'Get-NetAdapter' is not recognized as the name of a cmdlet, function, script file, or operable program.\r\n\r\n## Environment data\r\n```\r\nPSVersion=7.0.2\r\nPSEdition=Core\r\nWSManStackVersion=3.0\r\nPSRemotingProtocolVersion=2.3\r\n```\r\n",
  "closed_at": "2020-07-05T08:54:58Z",
  "comments": [
    {
      "author": "doctordns",
      "author_association": "COLLABORATOR",
      "body": "Set-ExecutionPolicy RemoteSigned\r\n\r\nThen try again.",
      "created_at": "2020-07-04T15:03:02Z",
      "updated_at": "2020-07-04T15:03:02Z"
    },
    {
      "author": "erenturkm",
      "author_association": "NONE",
      "body": "Hi,\r\n\r\nSorry I didnt make myself clear. This is not an interactive shell issue, it is a SDK call that I am invoking from c# code. The code that I ran is running on my local machine with Remote Execution already set to remote signed. \r\n1) When I run this command from Windows Powershell it runs perfectly. \r\n2) All other powershell commands that I invoke from SDK are running perfectly.  ",
      "created_at": "2020-07-04T15:09:59Z",
      "updated_at": "2020-07-04T15:09:59Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "From the errors, it would appear the SDK API is seeing a different execution policy than powershell sees interactively, so you may still need to set it for the SDK by invoking that command before trying to call Get-NetAdapter.\r\n\r\nGet-NetAdapter itself is not part of PowerShell 7, the module is a Windows component, so it has to be loaded over Windows Compatibility remoting. @adityapatwardhan may have additional insight into the precise issue you're seeing, as well.",
      "created_at": "2020-07-04T19:27:19Z",
      "updated_at": "2020-07-04T19:27:19Z"
    },
    {
      "author": "erenturkm",
      "author_association": "NONE",
      "body": "Setting this solved the issue. I am writing the command I issued in case somebody else needs it:\r\nset-ExecutionPolicy -scope Process remotesigned -Force\r\nSetting this in code was challanging since documentation does not state the argument dictionary has to be <string,dynamic> and Force arguement needs to be of type SwitchParameter. It would be nice to update the page:\r\n[https://docs.microsoft.com/en-us/dotnet/api/system.management.automation.powershell.addparameters?view=powershellsdk-7.0.0#System_Management_Automation_PowerShell_AddParameters_System_Collections_IDictionary_](url)",
      "created_at": "2020-07-05T08:54:58Z",
      "updated_at": "2020-07-05T08:54:58Z"
    }
  ],
  "created_at": "2020-07-04T14:27:14Z",
  "labels": [
    "Issue-Question"
  ],
  "number": 13096,
  "state": "closed",
  "title": "Can not run Get-NetAdapter from SDK",
  "updated_at": "2020-07-05T08:54:59Z"
}
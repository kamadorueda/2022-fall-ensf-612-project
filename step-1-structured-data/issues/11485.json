{
  "_url": "https://github.com/PowerShell/PowerShell/issues/11485",
  "author": "TravisEz13",
  "body": "<!-- Anything that looks like this is a comment and can't be seen after the Pull Request is created. -->\r\n\r\n# PR Summary\r\n\r\nAdd script to rebuild WIX component refs\r\n\r\n## PR Context\r\n\r\nSomeone (cc @SteveL-MSFT, @bergmeister), let the WIX file fragment be edited by hand and become corrupt.\r\nThis script examines the WXS fragment and looks for the corruption, fails the build, and outputs and correctly built WXS fragment.\r\n\r\nNote,  **Please** do not hand edit the files.wxs file.  Always let the CI system, find the problems and fix them. \r\nIf you try to hand edit, you risk us not being able to issues a security patch if needed.\r\n\r\n## PR Checklist\r\n\r\n- [x] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - Use the present tense and imperative mood when describing your changes\r\n- [x] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] [Make sure all `.h`, `.cpp`, `.cs`, `.ps1` and `.psm1` files have the correct copyright header](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - If the PR is work in progress, please add the prefix `WIP:` or `[ WIP ]` to the beginning of the title (the `WIP` bot will keep its status check at `Pending` while the prefix is present) and remove the prefix when the PR is ready.\r\n- **[Breaking changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)**\r\n    - [x] None\r\n    - **OR**\r\n    - [ ] [Experimental feature(s) needed](https://github.com/MicrosoftDocs/PowerShell-Docs/blob/staging/reference/6/Microsoft.PowerShell.Core/About/about_Experimental_Features.md)\r\n        - [ ] Experimental feature name(s): <!-- Experimental feature name(s) here -->\r\n- **User-facing changes**\r\n    - [x] Not Applicable\r\n    - **OR**\r\n    - [ ] [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n        - [ ] Issue filed: <!-- Number/link of that issue here -->\r\n- **Testing - New and feature**\r\n    - [x] N/A or can only be tested interactively\r\n    - **OR**\r\n    - [ ] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n- **Tooling**\r\n    - [x] I have considered the user experience from a tooling perspective and don't believe tooling will be impacted.\r\n    - **OR**\r\n    - [ ] I have considered the user experience from a tooling perspective and enumerated concerns in the summary. This may include:\r\n        - Impact on [PowerShell Editor Services](https://github.com/PowerShell/PowerShellEditorServices) which is used in the [PowerShell extension](https://github.com/PowerShell/vscode-powershell) for VSCode (which runs in a different PS Host).\r\n        - Impact on Completions (both in the console and in editors) - one of PowerShell's most powerful features.\r\n        - Impact on [PSScriptAnalyzer](https://github.com/PowerShell/PSScriptAnalyzer) (which provides linting & formatting in the editor extensions).\r\n        - Impact on [EditorSyntax](https://github.com/PowerShell/EditorSyntax) (which provides syntax highlighting with in VSCode, GitHub, and many other editors).\r\n",
  "closed_at": "2020-01-04T20:14:36Z",
  "comments": [
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "This run produced the fixed wix file: https://dev.azure.com/powershell/PowerShell/_build/results?buildId=42371&view=artifacts&type=publishedArtifacts",
      "created_at": "2020-01-03T20:53:01Z",
      "updated_at": "2020-01-03T20:53:01Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@TravisEz13 Can you please update the PR description to include some context information about this change?",
      "created_at": "2020-01-03T23:34:45Z",
      "updated_at": "2020-01-03T23:34:45Z"
    },
    {
      "author": "bergmeister",
      "author_association": "CONTRIBUTOR",
      "body": "I am missing the context as well. Usually, I've used the auto-generated WiX file that `Start-PSPackage` produced when updates to DLLs were required due to a newer .Net Core version. Since the script does XML parsing to check the contents anyway, I don't understand what you mean by 'corrupted'",
      "created_at": "2020-01-04T20:52:36Z",
      "updated_at": "2020-01-04T20:52:36Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "@bergmeister is you used the autogenerated files, then you are not the cause.  Someone did not and the ComponentGroup section of the file did not contain all the updated components.  ",
      "created_at": "2020-01-07T19:53:18Z",
      "updated_at": "2020-01-07T19:53:18Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "This happened in the fork we used to update to .NET Core 3.0.  We squash merged that fork, so.... I cannot tell where exactly the issue occurred. \r\nIt took more time to figure out what was wrong than to fix it.  So, the problem itself wasn't that bad.  It's just the fact that the problem was unexpected and we were not looking for it (as we expect people to use the auto-generated wxs files)",
      "created_at": "2020-01-07T19:54:25Z",
      "updated_at": "2020-01-07T19:55:59Z"
    },
    {
      "author": "msftbot[bot]",
      "author_association": "NONE",
      "body": ":tada:`v7.0.0-rc.2` has been released which incorporates this pull request.:tada:\n\nHandy links:\n* [Release Notes](https://github.com/PowerShell/PowerShell/releases/tag/v7.0.0-rc.2)\n",
      "created_at": "2020-01-16T23:36:01Z",
      "updated_at": "2020-01-16T23:36:01Z"
    }
  ],
  "created_at": "2020-01-03T20:33:14Z",
  "number": 11485,
  "state": "closed",
  "title": "Add script to rebuild component refs",
  "updated_at": "2020-01-16T23:36:02Z"
}
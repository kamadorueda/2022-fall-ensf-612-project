{
  "_url": "https://github.com/PowerShell/PowerShell/issues/4602",
  "author": "bergmeister",
  "body": "Implemented #4458: Checks that the following [pre-requisites](https://github.com/PowerShell/PowerShell/blob/master/docs/installation/windows.md#prerequisites) of PowerShell Core on Windows are met by displaying an error message that includes a download link:\r\n- [Universal C Runtime](https://www.microsoft.com/en-us/download/details.aspx?id=50410) prior to Windows 10: A check for the existence of ucrtbase.dll in the system32 folder is performed (it would be possible to additionally assert against a minimum file version if you wish so)\r\n- [Visual C++ Redistributable for VS2015](https://www.microsoft.com/en-gb/download/details.aspx?id=48145): Registry entries are checked. The 64 bit installer checks for the 32 and 64 bit version of it whereas the 32 bit installer only asserts against the 32 bit version of the redistributables.\r\n\r\nThe ideas against what to check comes from research and especially this example [here](https://github.com/dokan-dev/dokany/blob/master/dokan_wix/Dokan_x64.wxs) to which I was redirected in a WiX discussion.\r\n\r\nIncludes tests to check that the WiX file contains the download URLs and those URLs are not dead.\r\n\r\nI'll have to leave the extensive testing on different systems up to you. Maybe it is also best if you double check the used assertions with the right experts at MSFT.\r\n\r\nNB: Due to recent refactorings of the VC++ team (see blog post [here](https://blogs.msdn.microsoft.com/vcblog/2015/03/03/introducing-the-universal-crt/)) it has become very complicated to include those binaries and therefore a check against them should be the minimum viable solution as originally outlined by @SteveL-MSFT ",
  "closed_at": "2017-08-18T19:47:43Z",
  "comments": [
    {
      "author": "msftclas",
      "author_association": "NONE",
      "body": "\r\n@bergmeister,\nThanks for having already signed the Contribution License Agreement. Your agreement was validated by Microsoft. We will now review your pull request.\n_Thanks,\nMicrosoft Pull Request Bot_",
      "created_at": "2017-08-16T22:59:51Z",
      "updated_at": "2017-08-16T22:59:51Z"
    },
    {
      "author": "adityapatwardhan",
      "author_association": "MEMBER",
      "body": "@bergmeister Thanks!",
      "created_at": "2017-08-16T23:03:57Z",
      "updated_at": "2017-08-16T23:03:57Z"
    },
    {
      "author": "bergmeister",
      "author_association": "CONTRIBUTOR",
      "body": "Should I also update the link to the Visual Studio C++ redistributes in the [pre-requisites](https://github.com/PowerShell/PowerShell/blob/master/docs/installation/windows.md#prerequisites) documentation for consistency and also because the link in the documentation requires an MSDN subscription?",
      "created_at": "2017-08-17T07:54:27Z",
      "updated_at": "2017-08-17T07:55:13Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "If you have a good alternative, that would be great.",
      "created_at": "2017-08-17T17:02:04Z",
      "updated_at": "2017-08-17T17:02:04Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "@mirichmo can you update your review?",
      "created_at": "2017-08-17T21:48:11Z",
      "updated_at": "2017-08-17T21:48:11Z"
    }
  ],
  "created_at": "2017-08-16T22:59:47Z",
  "number": 4602,
  "state": "closed",
  "title": "MSI installer to perform pre-requisite checks",
  "updated_at": "2017-08-18T19:47:44Z"
}
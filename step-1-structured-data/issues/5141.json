{
  "_url": "https://github.com/PowerShell/PowerShell/issues/5141",
  "author": "chunqingchen",
  "body": "This is to resolve #4996\r\nNewtonsoft.Json.Linq.Jproperty is not properly handled.\r\n\r\nAdding handling for Newtonsoft.Json.Linq.Jproperty\r\n\r\nRepro:\r\n$EgJObject = New-Object -TypeName Newtonsoft.Json.Linq.JObject\r\n$EgJObject.Add(\"TestValue1\", \"123456\")\r\n$EgJObject.Add(\"TestValue2\", \"78910\")\r\n$EgJObject.Add(\"TestValue3\", \"99999\")\r\n$dict = @{}\r\n$dict.Add('JObject', $EgJObject)\r\n$dict.Add('StrObject', 'This is a string Object')\r\n$properties = @{'DictObject' = $dict; 'RandomString' = 'A quick brown fox jumped over the lazy dog'}\r\n$object = New-Object -TypeName psobject -Property $properties\r\n$object | ConvertTo-Json\r\n\r\nBefore fix:\r\n\r\n{\r\n    \"RandomString\":  \"A quick brown fox jumped over the lazy dog\",\r\n    \"DictObject\":  {\r\n                       \"JObject\":  [\r\n                                       \"123456\",\r\n                                       \"78910\",\r\n                                       \"99999\"\r\n                                   ],\r\n                       \"StrObject\":  \"This is a string Object\"\r\n                   }\r\n}\r\n\r\nAfter fix:\r\n\r\n{\r\n  \"DictObject\": {\r\n    \"JObject\": [\r\n      \"\\\"TestValue1\\\": 123456\",\r\n      \"\\\"TestValue2\\\": 78910\",\r\n      \"\\\"TestValue3\\\": 99999\"\r\n    ],\r\n    \"StrObject\": \"This is a string Object\"\r\n  },\r\n  \"RandomString\": \"A quick brown fox jumped over the lazy dog\"\r\n}",
  "closed_at": "2017-11-03T18:35:10Z",
  "comments": [
    {
      "author": "chunqingchen",
      "author_association": "CONTRIBUTOR",
      "body": "@markekraus @iSazonov Technically Jproperty cannot be equal to dictionary as it allows null value as key, while dictionary won't. ",
      "created_at": "2017-10-18T16:40:45Z",
      "updated_at": "2017-10-18T16:40:45Z"
    },
    {
      "author": "chunqingchen",
      "author_association": "CONTRIBUTOR",
      "body": "@markekraus your solution works better and your comment is resolved !",
      "created_at": "2017-10-27T10:42:30Z",
      "updated_at": "2017-10-27T10:42:30Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "Please use the present tense, imperative style for commit messages and title per [Contribution Guide](https://github.com/PowerShell/PowerShell/blob/7a8589a8c516c3048b4555415b9ac13a24b6d6ed/.github/CONTRIBUTING.md#pull-request-submission)",
      "created_at": "2017-10-28T17:49:11Z",
      "updated_at": "2017-10-28T17:49:11Z"
    },
    {
      "author": "chunqingchen",
      "author_association": "CONTRIBUTOR",
      "body": "@iSazonov your comment is resolved.",
      "created_at": "2017-11-01T11:22:00Z",
      "updated_at": "2017-11-01T11:22:00Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "` should` is not imperative.\r\nPlease use the present tense, imperative style for commit messages and title per [Contribution Guide](https://github.com/PowerShell/PowerShell/blob/7a8589a8c516c3048b4555415b9ac13a24b6d6ed/.github/CONTRIBUTING.md#pull-request-submission)",
      "created_at": "2017-11-02T22:38:08Z",
      "updated_at": "2017-11-02T22:38:08Z"
    },
    {
      "author": "markekraus",
      "author_association": "CONTRIBUTOR",
      "body": "@chunqingchen suggested title: `Add Jobject serialization support to ConvertTo-Json`",
      "created_at": "2017-11-02T22:41:45Z",
      "updated_at": "2017-11-02T22:41:45Z"
    },
    {
      "author": "chunqingchen",
      "author_association": "CONTRIBUTOR",
      "body": "@TravisEz13 @markekraus title updated",
      "created_at": "2017-11-02T23:39:29Z",
      "updated_at": "2017-11-02T23:39:29Z"
    }
  ],
  "created_at": "2017-10-17T10:02:40Z",
  "number": 5141,
  "state": "closed",
  "title": "Add Jobject serialization support to ConvertTo-Json",
  "updated_at": "2017-11-03T18:35:10Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/9250",
  "author": "SteveL-MSFT",
  "body": "<!-- Anything that looks like this is a comment and can't be seen after the Pull Request is created. -->\r\n\r\n# PR Summary\r\n\r\nOn a case-insensitive filesystem, if the path exists, we propagate the user typed casing of the path and reuse it.  This causes problems with some native tools like `git` where it expects correct casing of filesystem paths.  The change is to step through the path and retrieve the actual casing of the items in the path and return that during the path normalization method.\r\n\r\n## PR Context\r\n\r\nFix https://github.com/PowerShell/PowerShell/issues/5678\r\n\r\n## PR Checklist\r\n\r\n- [x] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - Use the present tense and imperative mood when describing your changes\r\n- [x] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] [Change is not breaking](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)\r\n- [x] [Make sure all `.h`, `.cpp`, `.cs`, `.ps1` and `.psm1` files have the correct copyright header](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - If the PR is work in progress, please add the prefix `WIP:` or `[ WIP ]` to the beginning of the title (the `WIP` bot will keep its status check at `Pending` while the prefix is present) and remove the prefix when the PR is ready.\r\n- **User-facing changes**\r\n    - [x] Not Applicable\r\n    - **OR**\r\n    - [ ] [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n        - [ ] Issue filed: <!-- Number/link of that issue here -->\r\n- **Testing - New and feature**\r\n    - [ ] N/A or can only be tested interactively\r\n    - **OR**\r\n    - [x] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n",
  "closed_at": "2019-04-23T20:31:45Z",
  "comments": [
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@PoshChan Please get failures",
      "created_at": "2019-03-29T23:35:46Z",
      "updated_at": "2019-03-29T23:35:46Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT, your last commit had 59 failures in `PowerShell-CI-linux`\r\n(These are 10 of the failures)### Extended FileSystem Item/Content Cmdlet Provider Tests.Valdiate New-Item parameters.Verify Directory + Whatif\r\n  Error: Expected an exception, with FullyQualifiedErrorId 'PathNotFound,Microsoft.PowerShell.Commands.GetItemCommand' to be thrown, but the FullyQualifiedErrorId was 'System.Management.Automation.PSArgumentException,Microsoft.PowerShell.Commands.GetItemCommand'. from /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1:887 char:15\r\n    +             { Get-Item -Path $testDir -ErrorAction Stop } |\r\n    +               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n```stacktrace\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 888\r\n888:                 Should -Throw -ErrorId \"PathNotFound,Microsoft.PowerShell.Commands.GetItemCommand\"\r\n```\r\n### Extended FileSystem Item/Content Cmdlet Provider Tests.Valdiate New-Item parameters.Verify File + Value\r\n  Error: Expected exactly 'testFile.txt', but got $null.\r\n```stacktrace\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 905\r\n905:             $result.Name | Should -BeExactly $testFile\r\n```\r\n### Extended FileSystem Item/Content Cmdlet Provider Tests.Valdiate Get-Item parameters.Verify Force\r\n  Error: Expected exactly 'testFile.txt', but got $null.\r\n```stacktrace\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 913\r\n913:             $result.Name | Should -BeExactly $testFile\r\n```\r\n### Extended FileSystem Item/Content Cmdlet Provider Tests.Valdiate Get-Item parameters.Verify Path Wildcard\r\n  Error: Expected exactly 'testFile2.txt', but got $null.\r\n```stacktrace\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 918\r\n918:             $result.Name | Should -BeExactly $testFile2\r\n```\r\n### Extended FileSystem Item/Content Cmdlet Provider Tests.Valdiate Get-Item parameters.Verify Include\r\n  Error: Expected exactly 'testFile2.txt', but got $null.\r\n```stacktrace\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 923\r\n923:             $result.Name | Should -BeExactly $testFile2\r\n```\r\n### Extended FileSystem Item/Content Cmdlet Provider Tests.Valdiate Get-Item parameters.Verify Include and Exclude Intersection\r\n  Error: Expected exactly 'testFile.txt', but got $null.\r\n```stacktrace\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 928\r\n928:             $result.Name | Should -BeExactly $testFile\r\n```\r\n### Extended FileSystem Item/Content Cmdlet Provider Tests.Valdiate Get-Item parameters.Verify Filter\r\n  Error: Expected exactly 'testFile2.txt', but got $null.\r\n```stacktrace\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 933\r\n933:             $result.Name | Should -BeExactly $testFile2\r\n```\r\n### Extended FileSystem Item/Content Cmdlet Provider Tests.Valdiate Get-Item parameters.Verify -LiteralPath with wildcard fails for file that doesn't exist\r\n  Error: Expected an exception, with FullyQualifiedErrorId 'PathNotFound,Microsoft.PowerShell.Commands.GetItemCommand' to be thrown, but the FullyQualifiedErrorId was 'System.Management.Automation.PSArgumentException,Microsoft.PowerShell.Commands.GetItemCommand'. from /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1:937 char:15\r\n    + ...           { Get-Item -LiteralPath \"a*b.txt\" -ErrorAction Stop } | Sho ...\r\n    +                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n```stacktrace\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 937\r\n937:             { Get-Item -LiteralPath \"a*b.txt\" -ErrorAction Stop } | Should -Throw -ErrorId \"PathNotFound,Microsoft.PowerShell.Commands.GetItemCommand\"\r\n```\r\n### Extended FileSystem Item/Content Cmdlet Provider Tests.Valdiate Get-Item parameters.Verify -LiteralPath with wildcard succeeds for file\r\n  Error: Expected exactly 'a*b.txt', but got $null.\r\n```stacktrace\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 943\r\n943:             $file.Name | Should -BeExactly \"a*b.txt\"\r\n```\r\n### Extended FileSystem Item/Content Cmdlet Provider Tests.Valdiate Move-Item parameters.Verify WhatIf\r\n  Error: Expected an exception, with FullyQualifiedErrorId 'PathNotFound,Microsoft.PowerShell.Commands.GetItemCommand' to be thrown, but the FullyQualifiedErrorId was 'System.Management.Automation.PSArgumentException,Microsoft.PowerShell.Commands.GetItemCommand'. from /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1:963 char:15\r\n    +             { Get-Item -Path $altTestFile -ErrorAction Stop } |\r\n    +               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n```stacktrace\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 964\r\n964:                 Should -Throw -ErrorId \"PathNotFound,Microsoft.PowerShell.Commands.GetItemCommand\"\r\n```\r\n",
      "created_at": "2019-03-29T23:36:49Z",
      "updated_at": "2019-04-03T04:46:14Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT, your last commit had 59 failures in `PowerShell-CI-macos`\r\n(These are 10 of the failures)### Extended FileSystem Item/Content Cmdlet Provider Tests.Valdiate New-Item parameters.Verify Directory + Whatif\r\n  Error: Expected an exception, with FullyQualifiedErrorId 'PathNotFound,Microsoft.PowerShell.Commands.GetItemCommand' to be thrown, but the FullyQualifiedErrorId was 'System.Management.Automation.PSArgumentException,Microsoft.PowerShell.Commands.GetItemCommand'. from /Users/vsts/agent/2.148.2/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1:887 char:15\r\n    +             { Get-Item -Path $testDir -ErrorAction Stop } |\r\n    +               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n```stacktrace\r\nat <ScriptBlock>, /Users/vsts/agent/2.148.2/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 888\r\n888:                 Should -Throw -ErrorId \"PathNotFound,Microsoft.PowerShell.Commands.GetItemCommand\"\r\n```\r\n### Extended FileSystem Item/Content Cmdlet Provider Tests.Valdiate New-Item parameters.Verify File + Value\r\n  Error: Expected exactly 'testFile.txt', but got $null.\r\n```stacktrace\r\nat <ScriptBlock>, /Users/vsts/agent/2.148.2/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 905\r\n905:             $result.Name | Should -BeExactly $testFile\r\n```\r\n### Extended FileSystem Item/Content Cmdlet Provider Tests.Valdiate Get-Item parameters.Verify Force\r\n  Error: Expected exactly 'testFile.txt', but got $null.\r\n```stacktrace\r\nat <ScriptBlock>, /Users/vsts/agent/2.148.2/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 913\r\n913:             $result.Name | Should -BeExactly $testFile\r\n```\r\n### Extended FileSystem Item/Content Cmdlet Provider Tests.Valdiate Get-Item parameters.Verify Path Wildcard\r\n  Error: Expected exactly 'testFile2.txt', but got $null.\r\n```stacktrace\r\nat <ScriptBlock>, /Users/vsts/agent/2.148.2/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 918\r\n918:             $result.Name | Should -BeExactly $testFile2\r\n```\r\n### Extended FileSystem Item/Content Cmdlet Provider Tests.Valdiate Get-Item parameters.Verify Include\r\n  Error: Expected exactly 'testFile2.txt', but got $null.\r\n```stacktrace\r\nat <ScriptBlock>, /Users/vsts/agent/2.148.2/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 923\r\n923:             $result.Name | Should -BeExactly $testFile2\r\n```\r\n### Extended FileSystem Item/Content Cmdlet Provider Tests.Valdiate Get-Item parameters.Verify Include and Exclude Intersection\r\n  Error: Expected exactly 'testFile.txt', but got $null.\r\n```stacktrace\r\nat <ScriptBlock>, /Users/vsts/agent/2.148.2/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 928\r\n928:             $result.Name | Should -BeExactly $testFile\r\n```\r\n### Extended FileSystem Item/Content Cmdlet Provider Tests.Valdiate Get-Item parameters.Verify Filter\r\n  Error: Expected exactly 'testFile2.txt', but got $null.\r\n```stacktrace\r\nat <ScriptBlock>, /Users/vsts/agent/2.148.2/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 933\r\n933:             $result.Name | Should -BeExactly $testFile2\r\n```\r\n### Extended FileSystem Item/Content Cmdlet Provider Tests.Valdiate Get-Item parameters.Verify -LiteralPath with wildcard fails for file that doesn't exist\r\n  Error: Expected an exception, with FullyQualifiedErrorId 'PathNotFound,Microsoft.PowerShell.Commands.GetItemCommand' to be thrown, but the FullyQualifiedErrorId was 'System.Management.Automation.PSArgumentException,Microsoft.PowerShell.Commands.GetItemCommand'. from /Users/vsts/agent/2.148.2/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1:937 char:15\r\n    + ...           { Get-Item -LiteralPath \"a*b.txt\" -ErrorAction Stop } | Sho ...\r\n    +                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n```stacktrace\r\nat <ScriptBlock>, /Users/vsts/agent/2.148.2/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 937\r\n937:             { Get-Item -LiteralPath \"a*b.txt\" -ErrorAction Stop } | Should -Throw -ErrorId \"PathNotFound,Microsoft.PowerShell.Commands.GetItemCommand\"\r\n```\r\n### Extended FileSystem Item/Content Cmdlet Provider Tests.Valdiate Get-Item parameters.Verify -LiteralPath with wildcard succeeds for file\r\n  Error: Expected exactly 'a*b.txt', but got $null.\r\n```stacktrace\r\nat <ScriptBlock>, /Users/vsts/agent/2.148.2/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 943\r\n943:             $file.Name | Should -BeExactly \"a*b.txt\"\r\n```\r\n### Extended FileSystem Item/Content Cmdlet Provider Tests.Valdiate Move-Item parameters.Verify WhatIf\r\n  Error: Expected an exception, with FullyQualifiedErrorId 'PathNotFound,Microsoft.PowerShell.Commands.GetItemCommand' to be thrown, but the FullyQualifiedErrorId was 'System.Management.Automation.PSArgumentException,Microsoft.PowerShell.Commands.GetItemCommand'. from /Users/vsts/agent/2.148.2/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1:963 char:15\r\n    +             { Get-Item -Path $altTestFile -ErrorAction Stop } |\r\n    +               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n```stacktrace\r\nat <ScriptBlock>, /Users/vsts/agent/2.148.2/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 964\r\n964:                 Should -Throw -ErrorId \"PathNotFound,Microsoft.PowerShell.Commands.GetItemCommand\"\r\n```\r\n",
      "created_at": "2019-03-29T23:36:50Z",
      "updated_at": "2019-04-03T04:46:20Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT, test results were not published for PowerShell-CI-static-analysis at vstfs:///Build/Build/18523",
      "created_at": "2019-03-29T23:36:51Z",
      "updated_at": "2019-03-29T23:36:51Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT, your last commit had 69 failures in `PowerShell-CI-windows`\r\n(These are 10 of the failures)### Implicit remoting tests.Command resolution for 'myOrder' should be respected by implicit remoting\r\n  Error: Sequence contains no elements\r\n```stacktrace\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Implicit.Remoting.Tests.ps1: line 1688\r\n1688:                 $null = New-Item $tempdir -ItemType Directory -Force\r\n\r\n```\r\n### Export-PSSession function.Test the module created by Export-PSSession\r\n  Error: You cannot call a method on a null-valued expression.\r\n```stacktrace\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Implicit.Remoting.Tests.ps1: line 1912\r\n1912:                 $ps.Dispose()\r\n\r\n```\r\n### TabCompletion.Miscellaneous completion tests.Tab completion UNC path\r\n  Error: Expected the actual value to be greater than 0, but got 0.\r\n```stacktrace\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Host\\TabCompletion\\TabCompletion.Tests.ps1: line 601\r\n601:             $res.CompletionMatches.Count | Should -BeGreaterThan 0\r\n```\r\n### Extended FileSystem Item/Content Cmdlet Provider Tests.Valdiate New-Item parameters.Verify Directory + Whatif\r\n  Error: Expected an exception, with FullyQualifiedErrorId 'PathNotFound,Microsoft.PowerShell.Commands.GetItemCommand' to be thrown, but the FullyQualifiedErrorId was 'System.Management.Automation.PSArgumentException,Microsoft.PowerShell.Commands.GetItemCommand'. from D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Management\\FileSystem.Tests.ps1:887 char:15\r\n    +             { Get-Item -Path $testDir -ErrorAction Stop } |\r\n    +               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n```stacktrace\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Management\\FileSystem.Tests.ps1: line 888\r\n888:                 Should -Throw -ErrorId \"PathNotFound,Microsoft.PowerShell.Commands.GetItemCommand\"\r\n```\r\n### Extended FileSystem Item/Content Cmdlet Provider Tests.Valdiate New-Item parameters.Verify File + Value\r\n  Error: Expected exactly 'testFile.txt', but got $null.\r\n```stacktrace\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Management\\FileSystem.Tests.ps1: line 905\r\n905:             $result.Name | Should -BeExactly $testFile\r\n```\r\n### Extended FileSystem Item/Content Cmdlet Provider Tests.Valdiate Get-Item parameters.Verify Force\r\n  Error: Expected exactly 'testFile.txt', but got $null.\r\n```stacktrace\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Management\\FileSystem.Tests.ps1: line 913\r\n913:             $result.Name | Should -BeExactly $testFile\r\n```\r\n### Extended FileSystem Item/Content Cmdlet Provider Tests.Valdiate Get-Item parameters.Verify Path Wildcard\r\n  Error: Expected exactly 'testFile2.txt', but got $null.\r\n```stacktrace\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Management\\FileSystem.Tests.ps1: line 918\r\n918:             $result.Name | Should -BeExactly $testFile2\r\n```\r\n### Extended FileSystem Item/Content Cmdlet Provider Tests.Valdiate Get-Item parameters.Verify Include\r\n  Error: Expected exactly 'testFile2.txt', but got $null.\r\n```stacktrace\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Management\\FileSystem.Tests.ps1: line 923\r\n923:             $result.Name | Should -BeExactly $testFile2\r\n```\r\n### Extended FileSystem Item/Content Cmdlet Provider Tests.Valdiate Get-Item parameters.Verify Include and Exclude Intersection\r\n  Error: Expected exactly 'testFile.txt', but got $null.\r\n```stacktrace\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Management\\FileSystem.Tests.ps1: line 928\r\n928:             $result.Name | Should -BeExactly $testFile\r\n```\r\n### Extended FileSystem Item/Content Cmdlet Provider Tests.Valdiate Get-Item parameters.Verify Filter\r\n  Error: Expected exactly 'testFile2.txt', but got $null.\r\n```stacktrace\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Management\\FileSystem.Tests.ps1: line 933\r\n933:             $result.Name | Should -BeExactly $testFile2\r\n```\r\n",
      "created_at": "2019-03-29T23:36:53Z",
      "updated_at": "2019-04-03T04:46:31Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@PoshChan Please get failures",
      "created_at": "2019-03-30T13:47:29Z",
      "updated_at": "2019-03-30T13:47:29Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT, your last commit had 59 failures in `PowerShell-CI-linux`\r\n(These are 5 of the failures)\r\nExtended FileSystem Item/Content Cmdlet Provider Tests.Valdiate New-Item parameters.Verify Directory + Whatif\r\n```powershell\r\nExpected an exception, with FullyQualifiedErrorId 'PathNotFound,Microsoft.PowerShell.Commands.GetItemCommand' to be thrown, but the FullyQualifiedErrorId was 'System.Management.Automation.PSArgumentException,Microsoft.PowerShell.Commands.GetItemCommand'. from /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1:887 char:15\r\n    +             { Get-Item -Path $testDir -ErrorAction Stop } |\r\n    +               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 888\r\n888:                 Should -Throw -ErrorId \"PathNotFound,Microsoft.PowerShell.Commands.GetItemCommand\"\r\n```\r\nExtended FileSystem Item/Content Cmdlet Provider Tests.Valdiate New-Item parameters.Verify File + Value\r\n```powershell\r\nExpected exactly 'testFile.txt', but got $null.\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 905\r\n905:             $result.Name | Should -BeExactly $testFile\r\n```\r\nExtended FileSystem Item/Content Cmdlet Provider Tests.Valdiate Get-Item parameters.Verify Force\r\n```powershell\r\nExpected exactly 'testFile.txt', but got $null.\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 913\r\n913:             $result.Name | Should -BeExactly $testFile\r\n```\r\nExtended FileSystem Item/Content Cmdlet Provider Tests.Valdiate Get-Item parameters.Verify Path Wildcard\r\n```powershell\r\nExpected exactly 'testFile2.txt', but got $null.\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 918\r\n918:             $result.Name | Should -BeExactly $testFile2\r\n```\r\nExtended FileSystem Item/Content Cmdlet Provider Tests.Valdiate Get-Item parameters.Verify Include\r\n```powershell\r\nExpected exactly 'testFile2.txt', but got $null.\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 923\r\n923:             $result.Name | Should -BeExactly $testFile2\r\n```\r\n",
      "created_at": "2019-03-30T13:48:29Z",
      "updated_at": "2019-04-03T04:46:39Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT, your last commit had 59 failures in `PowerShell-CI-macos`\r\n(These are 5 of the failures)\r\nExtended FileSystem Item/Content Cmdlet Provider Tests.Valdiate New-Item parameters.Verify Directory + Whatif\r\n```powershell\r\nExpected an exception, with FullyQualifiedErrorId 'PathNotFound,Microsoft.PowerShell.Commands.GetItemCommand' to be thrown, but the FullyQualifiedErrorId was 'System.Management.Automation.PSArgumentException,Microsoft.PowerShell.Commands.GetItemCommand'. from /Users/vsts/agent/2.148.2/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1:887 char:15\r\n    +             { Get-Item -Path $testDir -ErrorAction Stop } |\r\n    +               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\nat <ScriptBlock>, /Users/vsts/agent/2.148.2/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 888\r\n888:                 Should -Throw -ErrorId \"PathNotFound,Microsoft.PowerShell.Commands.GetItemCommand\"\r\n```\r\nExtended FileSystem Item/Content Cmdlet Provider Tests.Valdiate New-Item parameters.Verify File + Value\r\n```powershell\r\nExpected exactly 'testFile.txt', but got $null.\r\nat <ScriptBlock>, /Users/vsts/agent/2.148.2/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 905\r\n905:             $result.Name | Should -BeExactly $testFile\r\n```\r\nExtended FileSystem Item/Content Cmdlet Provider Tests.Valdiate Get-Item parameters.Verify Force\r\n```powershell\r\nExpected exactly 'testFile.txt', but got $null.\r\nat <ScriptBlock>, /Users/vsts/agent/2.148.2/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 913\r\n913:             $result.Name | Should -BeExactly $testFile\r\n```\r\nExtended FileSystem Item/Content Cmdlet Provider Tests.Valdiate Get-Item parameters.Verify Path Wildcard\r\n```powershell\r\nExpected exactly 'testFile2.txt', but got $null.\r\nat <ScriptBlock>, /Users/vsts/agent/2.148.2/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 918\r\n918:             $result.Name | Should -BeExactly $testFile2\r\n```\r\nExtended FileSystem Item/Content Cmdlet Provider Tests.Valdiate Get-Item parameters.Verify Include\r\n```powershell\r\nExpected exactly 'testFile2.txt', but got $null.\r\nat <ScriptBlock>, /Users/vsts/agent/2.148.2/work/1/s/test/powershell/Modules/Microsoft.PowerShell.Management/FileSystem.Tests.ps1: line 923\r\n923:             $result.Name | Should -BeExactly $testFile2\r\n```\r\n",
      "created_at": "2019-03-30T13:48:31Z",
      "updated_at": "2019-04-03T04:46:46Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT, test results were not published for PowerShell-CI-static-analysis at vstfs:///Build/Build/18594",
      "created_at": "2019-03-30T13:48:32Z",
      "updated_at": "2019-03-30T13:48:32Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT, your last commit had 66 failures in `PowerShell-CI-windows`\r\n(These are 5 of the failures)\r\nImplicit remoting tests.Command resolution for 'myOrder' should be respected by implicit remoting\r\n```powershell\r\nSequence contains no elements\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Implicit.Remoting.Tests.ps1: line 1688\r\n1688:                 $null = New-Item $tempdir -ItemType Directory -Force\r\n\r\n```\r\nExport-PSSession function.Test the module created by Export-PSSession\r\n```powershell\r\nYou cannot call a method on a null-valued expression.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Implicit.Remoting.Tests.ps1: line 1912\r\n1912:                 $ps.Dispose()\r\n\r\n```\r\nExtended FileSystem Item/Content Cmdlet Provider Tests.Valdiate New-Item parameters.Verify Directory + Whatif\r\n```powershell\r\nExpected an exception, with FullyQualifiedErrorId 'PathNotFound,Microsoft.PowerShell.Commands.GetItemCommand' to be thrown, but the FullyQualifiedErrorId was 'System.Management.Automation.PSArgumentException,Microsoft.PowerShell.Commands.GetItemCommand'. from D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Management\\FileSystem.Tests.ps1:887 char:15\r\n    +             { Get-Item -Path $testDir -ErrorAction Stop } |\r\n    +               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Management\\FileSystem.Tests.ps1: line 888\r\n888:                 Should -Throw -ErrorId \"PathNotFound,Microsoft.PowerShell.Commands.GetItemCommand\"\r\n```\r\nExtended FileSystem Item/Content Cmdlet Provider Tests.Valdiate New-Item parameters.Verify File + Value\r\n```powershell\r\nExpected exactly 'testFile.txt', but got $null.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Management\\FileSystem.Tests.ps1: line 905\r\n905:             $result.Name | Should -BeExactly $testFile\r\n```\r\nExtended FileSystem Item/Content Cmdlet Provider Tests.Valdiate Get-Item parameters.Verify Force\r\n```powershell\r\nExpected exactly 'testFile.txt', but got $null.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Management\\FileSystem.Tests.ps1: line 913\r\n913:             $result.Name | Should -BeExactly $testFile\r\n```\r\n",
      "created_at": "2019-03-30T13:48:34Z",
      "updated_at": "2019-04-03T04:46:52Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT, your last commit had 7 failures in `PowerShell-CI-windows`\r\n(These are 5 of the failures)\r\nImplicit remoting tests.Command resolution for 'myOrder' should be respected by implicit remoting\r\n```powershell\r\nSequence contains no elements\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Implicit.Remoting.Tests.ps1: line 1688\r\n1688:                 $null = New-Item $tempdir -ItemType Directory -Force\r\n\r\n```\r\nExport-PSSession function.Test the module created by Export-PSSession\r\n```powershell\r\nYou cannot call a method on a null-valued expression.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Implicit.Remoting.Tests.ps1: line 1912\r\n1912:                 $ps.Dispose()\r\n\r\n```\r\nGet-Content.Should support NTFS streams using colon syntax\r\n```powershell\r\nExpected exactly 'Foo', but got $null.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Management\\Get-Content.Tests.ps1: line 218\r\n218:         Get-Content \"${testPath}:Stream\" | Should -BeExactly \"Foo\"\r\n```\r\nTest-Path.Should allow piping objects to it\r\n```powershell\r\nExpected $true, but got $false.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Management\\Test-Path.Tests.ps1: line 26\r\n26:         $testdirectory                  | Test-Path | Should -BeTrue\r\n```\r\nTest suite for NewFileCatalogAndTestFileCatalogCmdlets.NewAndTestCatalogTests NegativeTestCases when creation or validation Fails.TestCatalogWhenNewFileAddedtoFolderBeforeValidation\r\n```powershell\r\nSequence contains no elements\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Security\\FileCatalog.Tests.ps1: line 319\r\n319:             $null = copy-item $testDataPath\\UserConfigProv $env:temp -Recurse -ErrorAction SilentlyContinue\r\n\r\n```\r\n",
      "created_at": "2019-03-30T14:56:44Z",
      "updated_at": "2019-04-03T04:46:58Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT, your last commit had 6 failures in `PowerShell-CI-windows`\r\n(These are 5 of the failures)\r\n\r\nImplicit remoting tests.Command resolution for 'myOrder' should be respected by implicit remoting\r\n```powershell\r\nSequence contains no elements\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Implicit.Remoting.Tests.ps1: line 1688\r\n1688:                 $null = New-Item $tempdir -ItemType Directory -Force\r\n\r\n```\r\nExport-PSSession function.Test the module created by Export-PSSession\r\n```powershell\r\nYou cannot call a method on a null-valued expression.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Implicit.Remoting.Tests.ps1: line 1912\r\n1912:                 $ps.Dispose()\r\n\r\n```\r\nTest-Path.Should allow piping objects to it\r\n```powershell\r\nExpected $true, but got $false.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Management\\Test-Path.Tests.ps1: line 26\r\n26:         $testdirectory                  | Test-Path | Should -BeTrue\r\n```\r\nTest suite for NewFileCatalogAndTestFileCatalogCmdlets.NewAndTestCatalogTests NegativeTestCases when creation or validation Fails.TestCatalogWhenNewFileAddedtoFolderBeforeValidation\r\n```powershell\r\nSequence contains no elements\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Security\\FileCatalog.Tests.ps1: line 319\r\n319:             $null = copy-item $testDataPath\\UserConfigProv $env:temp -Recurse -ErrorAction SilentlyContinue\r\n\r\n```\r\nTest suite for NewFileCatalogAndTestFileCatalogCmdlets.NewAndTestCatalogTests NegativeTestCases when creation or validation Fails.TestCatalogWhenNewFileDeletedFromFolderBeforeValidation\r\n```powershell\r\nSequence contains no elements\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Security\\FileCatalog.Tests.ps1: line 339\r\n339:             $null = copy-item $testDataPath\\UserConfigProv $env:temp -Recurse -ErrorAction SilentlyContinue\r\n\r\n```\r\n",
      "created_at": "2019-03-30T16:08:06Z",
      "updated_at": "2019-04-03T04:47:05Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT, your last commit had 6 failures in `PowerShell-CI-windows`\r\n(These are 5 of the failures)\r\n\r\nImplicit remoting tests.Command resolution for 'myOrder' should be respected by implicit remoting\r\n```powershell\r\nSequence contains no elements\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Implicit.Remoting.Tests.ps1: line 1688\r\n1688:                 $null = New-Item $tempdir -ItemType Directory -Force\r\n\r\n```\r\nExport-PSSession function.Test the module created by Export-PSSession\r\n```powershell\r\nYou cannot call a method on a null-valued expression.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Implicit.Remoting.Tests.ps1: line 1912\r\n1912:                 $ps.Dispose()\r\n\r\n```\r\nTest-Path.Should allow piping objects to it\r\n```powershell\r\nExpected $true, but got $false.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Management\\Test-Path.Tests.ps1: line 26\r\n26:         $testdirectory                  | Test-Path | Should -BeTrue\r\n```\r\nTest suite for NewFileCatalogAndTestFileCatalogCmdlets.NewAndTestCatalogTests NegativeTestCases when creation or validation Fails.TestCatalogWhenNewFileAddedtoFolderBeforeValidation\r\n```powershell\r\nSequence contains no elements\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Security\\FileCatalog.Tests.ps1: line 319\r\n319:             $null = copy-item $testDataPath\\UserConfigProv $env:temp -Recurse -ErrorAction SilentlyContinue\r\n\r\n```\r\nTest suite for NewFileCatalogAndTestFileCatalogCmdlets.NewAndTestCatalogTests NegativeTestCases when creation or validation Fails.TestCatalogWhenNewFileDeletedFromFolderBeforeValidation\r\n```powershell\r\nSequence contains no elements\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Security\\FileCatalog.Tests.ps1: line 339\r\n339:             $null = copy-item $testDataPath\\UserConfigProv $env:temp -Recurse -ErrorAction SilentlyContinue\r\n\r\n```\r\n",
      "created_at": "2019-03-30T17:10:46Z",
      "updated_at": "2019-04-03T04:47:14Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT, your last commit had 7 failures in `PowerShell-CI-windows`\r\n(These are 5 of the failures)\r\n\r\nWindowStyle argument.-WindowStyle Normal should work on Windows\r\n```powershell\r\nExpected exactly 'Normal', but got Hidden.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Host\\ConsoleHost.Tests.ps1: line 700\r\n700:         $showCmd | Should -BeExactly $WindowStyle\r\n```\r\nImplicit remoting tests.Command resolution for 'myOrder' should be respected by implicit remoting\r\n```powershell\r\nSequence contains no elements\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Implicit.Remoting.Tests.ps1: line 1688\r\n1688:                 $null = New-Item $tempdir -ItemType Directory -Force\r\n\r\n```\r\nExport-PSSession function.Test the module created by Export-PSSession\r\n```powershell\r\nYou cannot call a method on a null-valued expression.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Implicit.Remoting.Tests.ps1: line 1912\r\n1912:                 $ps.Dispose()\r\n\r\n```\r\nTest-Path.Should allow piping objects to it\r\n```powershell\r\nExpected $true, but got $false.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Management\\Test-Path.Tests.ps1: line 26\r\n26:         $testdirectory                  | Test-Path | Should -BeTrue\r\n```\r\nTest suite for NewFileCatalogAndTestFileCatalogCmdlets.NewAndTestCatalogTests NegativeTestCases when creation or validation Fails.TestCatalogWhenNewFileAddedtoFolderBeforeValidation\r\n```powershell\r\nSequence contains no elements\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Security\\FileCatalog.Tests.ps1: line 319\r\n319:             $null = copy-item $testDataPath\\UserConfigProv $env:temp -Recurse -ErrorAction SilentlyContinue\r\n\r\n```\r\n",
      "created_at": "2019-03-31T19:33:12Z",
      "updated_at": "2019-04-03T04:47:21Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@PoshChan Please retry windows",
      "created_at": "2019-04-01T00:18:50Z",
      "updated_at": "2019-04-01T00:18:50Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT, successfully started retry of `PowerShell-CI-Windows`",
      "created_at": "2019-04-01T00:19:50Z",
      "updated_at": "2019-04-01T00:19:50Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT, your last commit had 7 failures in `PowerShell-CI-windows`\r\n(These are 5 of the failures)\r\n\r\nWindowStyle argument.-WindowStyle Normal should work on Windows\r\n```powershell\r\nExpected exactly 'Normal', but got Hidden.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Host\\ConsoleHost.Tests.ps1: line 700\r\n700:         $showCmd | Should -BeExactly $WindowStyle\r\n```\r\nImplicit remoting tests.Command resolution for 'myOrder' should be respected by implicit remoting\r\n```powershell\r\nSequence contains no elements\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Implicit.Remoting.Tests.ps1: line 1688\r\n1688:                 $null = New-Item $tempdir -ItemType Directory -Force\r\n\r\n```\r\nExport-PSSession function.Test the module created by Export-PSSession\r\n```powershell\r\nYou cannot call a method on a null-valued expression.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Implicit.Remoting.Tests.ps1: line 1912\r\n1912:                 $ps.Dispose()\r\n\r\n```\r\nTest-Path.Should allow piping objects to it\r\n```powershell\r\nExpected $true, but got $false.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Management\\Test-Path.Tests.ps1: line 26\r\n26:         $testdirectory                  | Test-Path | Should -BeTrue\r\n```\r\nTest suite for NewFileCatalogAndTestFileCatalogCmdlets.NewAndTestCatalogTests NegativeTestCases when creation or validation Fails.TestCatalogWhenNewFileAddedtoFolderBeforeValidation\r\n```powershell\r\nSequence contains no elements\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Security\\FileCatalog.Tests.ps1: line 319\r\n319:             $null = copy-item $testDataPath\\UserConfigProv $env:temp -Recurse -ErrorAction SilentlyContinue\r\n\r\n```\r\n",
      "created_at": "2019-04-01T00:39:42Z",
      "updated_at": "2019-04-03T04:47:28Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT, your last commit had 6 failures in `PowerShell-CI-windows`\r\n(These are 5 of the failures)\r\n\r\nImplicit remoting tests.Command resolution for 'myOrder' should be respected by implicit remoting\r\n```powershell\r\nSequence contains no elements\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Implicit.Remoting.Tests.ps1: line 1689\r\n1689:                 $null = New-Item $tempdir -ItemType Directory -Force\r\n\r\n```\r\nExport-PSSession function.Test the module created by Export-PSSession\r\n```powershell\r\nYou cannot call a method on a null-valued expression.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Implicit.Remoting.Tests.ps1: line 1914\r\n1914:                 $ps.Dispose()\r\n\r\n```\r\nTest-Path.Should allow piping objects to it\r\n```powershell\r\nExpected $true, but got $false.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Management\\Test-Path.Tests.ps1: line 27\r\n27:         $testdirectory                  | Test-Path | Should -BeTrue\r\n```\r\nTest suite for NewFileCatalogAndTestFileCatalogCmdlets.NewAndTestCatalogTests NegativeTestCases when creation or validation Fails.TestCatalogWhenNewFileAddedtoFolderBeforeValidation\r\n```powershell\r\nSequence contains no elements\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Security\\FileCatalog.Tests.ps1: line 322\r\n322:             $null = copy-item $testDataPath\\UserConfigProv $env:temp -Recurse -ErrorAction SilentlyContinue\r\n\r\n```\r\nTest suite for NewFileCatalogAndTestFileCatalogCmdlets.NewAndTestCatalogTests NegativeTestCases when creation or validation Fails.TestCatalogWhenNewFileDeletedFromFolderBeforeValidation\r\n```powershell\r\nSequence contains no elements\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Security\\FileCatalog.Tests.ps1: line 342\r\n342:             $null = copy-item $testDataPath\\UserConfigProv $env:temp -Recurse -ErrorAction SilentlyContinue\r\n\r\n```\r\n",
      "created_at": "2019-04-01T01:38:49Z",
      "updated_at": "2019-04-03T04:47:34Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "Hmmm, looks like the failures are due to handling of long path names which explains why it didn't fail on my machine.  Might have to add some long path tests first.",
      "created_at": "2019-04-01T05:03:19Z",
      "updated_at": "2019-04-01T05:03:19Z"
    },
    {
      "author": "PoshChan",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT, your last commit had 6 failures in `PowerShell-CI-windows`\r\n(These are 5 of the failures)\r\n\r\nImplicit remoting tests.Command resolution for 'myOrder' should be respected by implicit remoting\r\n```powershell\r\nCould not find a part of the path 'C:\\Users\\VssAdministrator\\AppData\\Local\\Temp\\uln04nm4.izl\\myOrder.ps1'.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Implicit.Remoting.Tests.ps1: line 1691\r\n1691:                 'param([Parameter(Mandatory=$true)]$scriptParam) \"external script / $scriptParam\"' > $tempdir\\myOrder.ps1\r\n\r\n```\r\nExport-PSSession function.Test the module created by Export-PSSession\r\n```powershell\r\nYou cannot call a method on a null-valued expression.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Utility\\Implicit.Remoting.Tests.ps1: line 1912\r\n1912:                 $ps.Dispose()\r\n\r\n```\r\nTest-Path.Should allow piping objects to it\r\n```powershell\r\nExpected $true, but got $false.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Management\\Test-Path.Tests.ps1: line 26\r\n26:         $testdirectory                  | Test-Path | Should -BeTrue\r\n```\r\nTest suite for NewFileCatalogAndTestFileCatalogCmdlets.NewAndTestCatalogTests NegativeTestCases when creation or validation Fails.TestCatalogWhenNewFileAddedtoFolderBeforeValidation\r\n```powershell\r\nCould not find a part of the path 'C:\\UsersVSSADM~1'.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Security\\FileCatalog.Tests.ps1: line 319\r\n319:             $null = copy-item $testDataPath\\UserConfigProv $env:temp -Recurse -ErrorAction SilentlyContinue\r\n\r\n```\r\nTest suite for NewFileCatalogAndTestFileCatalogCmdlets.NewAndTestCatalogTests NegativeTestCases when creation or validation Fails.TestCatalogWhenNewFileDeletedFromFolderBeforeValidation\r\n```powershell\r\nCould not find a part of the path 'C:\\UsersVSSADM~1'.\r\nat <ScriptBlock>, D:\\a\\1\\s\\test\\powershell\\Modules\\Microsoft.PowerShell.Security\\FileCatalog.Tests.ps1: line 339\r\n339:             $null = copy-item $testDataPath\\UserConfigProv $env:temp -Recurse -ErrorAction SilentlyContinue\r\n\r\n```\r\n",
      "created_at": "2019-04-01T18:16:50Z",
      "updated_at": "2019-04-03T04:47:40Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@anmenaga Please merge by \"Squash and Merge\" in future unless we really want to preserve the PR history (should be rare).",
      "created_at": "2019-04-24T21:47:48Z",
      "updated_at": "2019-04-24T21:47:48Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT @daxian-dbw \r\nThe change is performance expensive.\r\nVersion 6.2.3 vs latest local build:\r\n![image](https://user-images.githubusercontent.com/22290914/68668373-d4e98480-0569-11ea-988a-456ffa34ef87.png)\r\n![image](https://user-images.githubusercontent.com/22290914/68668395-ddda5600-0569-11ea-8c24-99321d61fe98.png)\r\n\r\nPerfView:\r\n![image](https://user-images.githubusercontent.com/22290914/68668436-f0548f80-0569-11ea-8d63-843283a3c435.png)\r\n\r\nWe see a performance decreasing although overall performance of 7.0 builds is 2x better for file operations (like `dir -Recurse`)! \r\n\r\nAlso the trace shows that we call the method from some places several times. So the change slow down all file system operations without the need.\r\n\r\nFrom original issue:\r\n> If I use cmd.exe instead, it gives the expected/desired results.\r\n\r\nSo I hope there is another way to fix the issue without perf degradation. _I look cmd.exe and don't see that it does a path case normalization but works well._ It seems we did not find a root of the issue and the fix is not in right place.\r\n",
      "created_at": "2019-11-12T11:59:11Z",
      "updated_at": "2019-11-12T11:59:11Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@iSazonov I see different results -- it's even slightly faster in 7.0.0-preview.5 comparing with `6.2.3`.\r\n\r\n![image](https://user-images.githubusercontent.com/127450/68722918-de73ec00-056b-11ea-80f9-a384d921dd36.png)\r\n",
      "created_at": "2019-11-13T00:45:58Z",
      "updated_at": "2019-11-13T00:45:58Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@daxian-dbw I guess we use different cwd - my one is very long.\r\nAnd obviously many folder enumeration (current fix) is slower then replacing slashes (before the fix).",
      "created_at": "2019-11-13T03:01:19Z",
      "updated_at": "2019-11-13T03:01:19Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@iSazonov I still cannot reproduce it using a long current working directory\r\nCan you please provide a consistent repro using `preview.5`?\r\n\r\n![image](https://user-images.githubusercontent.com/127450/68802694-3dd90700-0613-11ea-9f81-9ff2f9818620.png)\r\n",
      "created_at": "2019-11-13T20:44:21Z",
      "updated_at": "2019-11-13T20:44:21Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@daxian-dbw I tested on another system and I guess it is Kaspersky AV that slow down the CreateFileW P/Invoke. I still don't like these extra P/Invokes taking in account how cmd.exe and Windows PowerShell  works.",
      "created_at": "2019-11-14T04:03:13Z",
      "updated_at": "2019-11-14T04:03:13Z"
    }
  ],
  "created_at": "2019-03-29T20:26:09Z",
  "number": 9250,
  "state": "closed",
  "title": "Return correct casing of filesystem path during normalization",
  "updated_at": "2019-11-14T04:03:13Z"
}
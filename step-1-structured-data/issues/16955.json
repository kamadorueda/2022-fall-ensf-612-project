{
  "_url": "https://github.com/PowerShell/PowerShell/issues/16955",
  "author": "solomoncyj",
  "body": "### Prerequisites\n\n- [X] Write a descriptive title.\n- [X] Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\n- [X] Search the existing issues.\n- [X] Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\n- [X] Refer to [Differences between Windows PowerShell 5.1 and PowerShell](https://docs.microsoft.com/powershell/scripting/whats-new/differences-from-windows-powershell).\n\n### Steps to reproduce\n\nrun ```ipmo APPX```\n\n### Expected behavior\n\n```console\nAPPX\r\nexpected result: import is successful and I can use the commands.\n```\n\n\n### Actual behavior\n\n```console\n>Import-Module Appx \r\nImport-Module: Operation is not supported on this platform. (0x80131539)\r\n\r\n```\n```\n\n\n### Error details\n\n```console\n>get-error\r\n\r\nException             :\r\n    Type       : System.PlatformNotSupportedException\r\n    TargetSite :\r\n        Name          : GetExportedTypes\r\n        DeclaringType : System.Reflection.RuntimeAssembly, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral,\r\nPublicKeyToken=7cec85d7bea7798e\r\n        MemberType    : Method\r\n        Module        : System.Private.CoreLib.dll\r\n    Message    : Operation is not supported on this platform. (0x80131539)\r\n    Source     : System.Private.CoreLib\r\n    HResult    : -2146233031\r\n    StackTrace :\r\n   at System.Reflection.RuntimeAssembly.GetExportedTypes()\r\n   at System.Reflection.Assembly.get_ExportedTypes()\r\n   at System.Management.Automation.Runspaces.PSSnapInHelpers.GetAssemblyTypes(Assembly assembly, String name)\r\n   at System.Management.Automation.Runspaces.PSSnapInHelpers.AnalyzeModuleAssemblyWithReflection(Assembly assembly,\r\nString name, PSSnapInInfo psSnapInInfo, PSModuleInfo moduleInfo, String helpFile, Dictionary`2& cmdlets, Dictionary`2&\r\naliases, Dictionary`2& providers)\r\n   at System.Management.Automation.Runspaces.PSSnapInHelpers.AnalyzePSSnapInAssembly(Assembly assembly, String name,\r\nPSSnapInInfo psSnapInInfo, PSModuleInfo moduleInfo, Dictionary`2& cmdlets, Dictionary`2& aliases, Dictionary`2&\r\nproviders, String& helpFile)\r\n   at System.Management.Automation.Runspaces.InitialSessionState.ImportCmdletsFromAssembly(Assembly assembly,\r\nPSModuleInfo module)\r\n   at Microsoft.PowerShell.Commands.ModuleCmdletBase.LoadBinaryModule(PSModuleInfo parentModule, String moduleName,\r\nString fileName, Assembly assemblyToLoad, String moduleBase, SessionState ss, ImportModuleOptions options,\r\nManifestProcessingFlags manifestProcessingFlags, String prefix, Boolean loadTypes, Boolean loadFormats, Boolean&\r\nfound, String shortModuleName, Boolean disableFormatUpdates)\r\n   at Microsoft.PowerShell.Commands.ModuleCmdletBase.LoadModuleNamedInManifest(PSModuleInfo parentModule,\r\nModuleSpecification moduleSpecification, String moduleBase, Boolean searchModulePath, String prefix, SessionState ss,\r\nImportModuleOptions options, ManifestProcessingFlags manifestProcessingFlags, Boolean loadTypes, Boolean loadFormats,\r\nObject privateData, Boolean& found, String shortModuleName, Nullable`1 manifestLanguageMode)\r\n   at Microsoft.PowerShell.Commands.ModuleCmdletBase.LoadModuleManifest(String moduleManifestPath, ExternalScriptInfo\r\nmanifestScriptInfo, Hashtable data, Hashtable localizedData, ManifestProcessingFlags manifestProcessingFlags, Version\r\nminimumVersion, Version maximumVersion, Version requiredVersion, Nullable`1 requiredModuleGuid, ImportModuleOptions&\r\noptions, Boolean& containedErrors)\r\n   at Microsoft.PowerShell.Commands.ModuleCmdletBase.LoadModule(PSModuleInfo parentModule, String fileName, String\r\nmoduleBase, String prefix, SessionState ss, Object privateData, ImportModuleOptions& options, ManifestProcessingFlags\r\nmanifestProcessingFlags, Boolean& found, Boolean& moduleFileFound)\r\n   at Microsoft.PowerShell.Commands.ModuleCmdletBase.LoadUsingExtensions(PSModuleInfo parentModule, String moduleName,\r\nString fileBaseName, String extension, String moduleBase, String prefix, SessionState ss, ImportModuleOptions options,\r\nManifestProcessingFlags manifestProcessingFlags, Boolean& found, Boolean& moduleFileFound)\r\n   at Microsoft.PowerShell.Commands.ModuleCmdletBase.LoadUsingModulePath(PSModuleInfo parentModule, Boolean found,\r\nIEnumerable`1 modulePath, String name, SessionState ss, ImportModuleOptions options, ManifestProcessingFlags\r\nmanifestProcessingFlags, PSModuleInfo& module)\r\n   at Microsoft.PowerShell.Commands.ImportModuleCommand.ImportModule_LocallyViaName(ImportModuleOptions\r\nimportModuleOptions, String name)\r\n   at Microsoft.PowerShell.Commands.ImportModuleCommand.ImportModule_LocallyViaName_WithTelemetry(ImportModuleOptions\r\nimportModuleOptions, String name)\r\n   at Microsoft.PowerShell.Commands.ImportModuleCommand.ProcessRecord()\r\n   at System.Management.Automation.CommandProcessor.ProcessRecord()\r\nCategoryInfo          : NotSpecified: (:) [Import-Module], PlatformNotSupportedException\r\nFullyQualifiedErrorId : System.PlatformNotSupportedException,Microsoft.PowerShell.Commands.ImportModuleCommand\r\nInvocationInfo        :\r\n    MyCommand        : Import-Module\r\n    ScriptLineNumber : 1\r\n    OffsetInLine     : 1\r\n    HistoryId        : 3\r\n    Line             : Import-Module Appx && get-error\r\n    PositionMessage  : At line:1 char:1\r\n                       + Import-Module Appx && get-error\r\n                       + ~~~~~~~~~~~~~~~~~~\r\n    InvocationName   : Import-Module\r\n    CommandOrigin    : Internal\r\nScriptStackTrace      : at <ScriptBlock>, <No file>: line 1\n```\n\n\n### Environment data\n\n```powershell\nName                           Value\r\n----                           -----\r\nPSVersion                      5.1.19041.1320\r\nPSEdition                      Desktop\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\r\nBuildVersion                   10.0.19041.1320\r\nCLRVersion                     4.0.30319.42000\r\nWSManStackVersion              3.0\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\n```\n\n\n### Visuals\n\n\r\nhttps://user-images.githubusercontent.com/74647769/156775345-357041ad-3b92-4e25-87a6-f41268eb4574.mp4\r\n\r\n",
  "closed_at": "2022-03-06T20:00:42Z",
  "comments": [
    {
      "author": "solomoncyj",
      "author_association": "NONE",
      "body": "\r\n\r\n\r\nhttps://github.com/PowerShell/PowerShell/issues/13138\r\n",
      "created_at": "2022-03-04T13:52:44Z",
      "updated_at": "2022-03-04T13:52:44Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Dup #13138",
      "created_at": "2022-03-05T18:54:24Z",
      "updated_at": "2022-03-05T18:54:24Z"
    },
    {
      "author": "msftbot[bot]",
      "author_association": "NONE",
      "body": "This issue has been marked as duplicate and has not had any activity for **1 day**. It has been closed for housekeeping purposes.",
      "created_at": "2022-03-06T20:00:41Z",
      "updated_at": "2022-03-06T20:00:41Z"
    }
  ],
  "created_at": "2022-03-04T13:52:32Z",
  "labels": [
    "Resolution-Duplicate",
    "Needs-Triage"
  ],
  "number": 16955,
  "state": "closed",
  "title": " Import-Module Appx does not work",
  "updated_at": "2022-03-06T20:00:42Z"
}
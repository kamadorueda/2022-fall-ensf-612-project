{
  "_url": "https://github.com/PowerShell/PowerShell/issues/7841",
  "author": "daxian-dbw",
  "body": "## PR Summary\r\n\r\nMake Start-PSPackage give a better message about how to fix files.wxs\r\nSome minor changes:\r\n1. Avoid relative paths as much as possible.\r\n1. Add a message about how to fix `files.wxs` when current files don't match the existing `files.wxs`.\r\n1. Fix a few script analyzer warnings since I'm on it.\r\n\r\n**The messages before this PR: (relative paths)**\r\n```\r\nPS:137> Start-PSPackage -Type msi\r\nPackaging RID: 'win7-x64'; Packaging Configuration: 'Release'\r\nPackaging Source: 'E:\\PowerShell\\src\\powershell-win-core\\bin\\Release\\netcoreapp2.1\\win7-x64\\publish'\r\nPackaging Type: msi\r\nverifying no new files have been added or removed...\r\nWARNING: {$(env.ProductSourcePath)\\sos_amd64_amd64_4.6.26814.04.dll} is no longer in product and should be removed from {E:\\PowerShell\\tools\\packaging\\..\\..\\assets\\Files.wxs}\r\nWARNING: new file in {$(env.ProductSourcePath)} with name {sos_amd64_amd64_4.6.26814.03.dll} in a {DirectoryRef} need to be added to {E:\\PowerShell\\tools\\packaging\\..\\..\\assets\\Files.wxs}\r\nUpdate xml saved to C:\\Users\\dongbow\\AppData\\Local\\Temp\\chov3oyp.3oi.xml\r\nCurrent files to not match  {E:\\PowerShell\\tools\\packaging\\..\\..\\assets\\Files.wxs}\r\nAt E:\\PowerShell\\tools\\packaging\\packaging.psm1:2721 char:9\r\n+         throw \"Current files to not match  {$FilesWxsPath}\"\r\n+         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+ CategoryInfo          : OperationStopped: (Current files t...sets\\Files.wxs}:String) [], RuntimeException\r\n+ FullyQualifiedErrorId : Current files to not match  {E:\\PowerShell\\tools\\packaging\\..\\..\\assets\\Files.wxs}\r\n```\r\n\r\n**The message with this PR: (resolved paths)**\r\n```\r\nPS:139> Start-PSPackage -Type msi\r\nPackaging RID: 'win7-x64'; Packaging Configuration: 'Release'\r\nPackaging Source: 'E:\\PowerShell\\src\\powershell-win-core\\bin\\Release\\netcoreapp2.1\\win7-x64\\publish'\r\nPackaging Type: msi\r\nverifying no new files have been added or removed...\r\nWARNING: {$(env.ProductSourcePath)\\sos_amd64_amd64_4.6.26814.04.dll} is no longer in product and should be removed from {E:\\PowerShell\\assets\\Files.wxs}\r\nWARNING: new file in {$(env.ProductSourcePath)} with name {sos_amd64_amd64_4.6.26814.03.dll} in a {DirectoryRef} need to be added to {E:\\PowerShell\\assets\\Files.wxs}\r\nUpdated xml saved to C:\\Users\\dongbow\\AppData\\Local\\Temp\\prumscbt.xax.wxs.\r\nIf component files were intentionally changed, such as due to moving to a newer .NET Core runtime, update 'E:\\PowerShell\\assets\\Files.wxs' with the content from 'C:\\Users\\dongbow\\AppData\\Local\\Temp\\prumscbt.xax.wxs'.\r\nCurrent files to not match  {E:\\PowerShell\\assets\\Files.wxs}\r\nAt E:\\PowerShell\\tools\\packaging\\packaging.psm1:2724 char:9\r\n+         throw \"Current files to not match  {$FilesWxsPath}\"\r\n+         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+ CategoryInfo          : OperationStopped: (Current files t...sets\\Files.wxs}:String) [], RuntimeException\r\n+ FullyQualifiedErrorId : Current files to not match  {E:\\PowerShell\\assets\\Files.wxs}\r\n```\r\n\r\n## PR Checklist\r\n\r\n- [x] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - Use the present tense and imperative mood when describing your changes\r\n- [x] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] [Change is not breaking](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)\r\n- [ ] [Make sure all `.h`, `.cpp`, `.cs`, `.ps1` and `.psm1` files have the correct copyright header](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - If the PR is work in progress, please add the prefix `WIP:` to the beginning of the title and remove the prefix when the PR is ready.\r\n- **User-facing changes**\r\n    - [x] Not Applicable\r\n    - **OR**\r\n    - [ ] User-facing [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n        - [ ] Issue filed - Issue link:\r\n- **Testing - New and feature**\r\n    - [ ] Not Applicable or can only be tested interactively\r\n    - **OR**\r\n    - [ ] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n        - [x] [Add `[feature]` if the change is significant or affects feature tests](https://github.com/PowerShell/PowerShell/blob/master/docs/testing-guidelines/testing-guidelines.md#requesting-additional-tests-for-a-pr)\r\n",
  "closed_at": "2018-09-25T16:53:42Z",
  "comments": [],
  "created_at": "2018-09-22T05:02:40Z",
  "number": 7841,
  "state": "closed",
  "title": "Make Start-PSPackage give better message about how to fix files.wxs",
  "updated_at": "2018-09-25T16:53:46Z"
}
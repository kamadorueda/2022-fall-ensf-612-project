{
  "_url": "https://github.com/PowerShell/PowerShell/issues/7282",
  "author": "bondarenkod",
  "body": "<!--\r\n\r\nFor Windows PowerShell 5.1 issues, suggestions, or feature requests please use the following link instead:\r\n- Windows PowerShell [UserVoice](https://windowsserver.uservoice.com/forums/301869-powershell)\r\n\r\nIf it is a bug report:\r\n- make sure you are able to repro it on the latest released version. \r\nYou can install the latest version from https://github.com/PowerShell/PowerShell/releases\r\n- Search the existing issues.\r\n- Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\r\n- Refer to the [known issues](https://docs.microsoft.com/powershell/scripting/whats-new/known-issues-ps6?view=powershell-6).\r\n- Fill out the following repro template:\r\n\r\nIf it's not a bug, please remove the template and elaborate the issue in your own words.\r\n-->\r\n\r\nSteps to reproduce\r\n------------------\r\n```powershell\r\n\r\n1. Install the latest version of PS onto the latest OSX OS version using the package manager\r\n2.1 Try to import the Microsoft.PowerShell.Archive using the next command:\r\nImport-Module Microsoft.PowerShell.Archive -Verbose\r\n2.2 Or try to use the Expand-Archive from VSTS PS script task, e.g.:\r\nExpand-Archive -Path $zipFile -DestinationPath $folder -Force\r\n```\r\n\r\nExpected behavior\r\n-----------------\r\n\r\n```none\r\nin 2.1: import operation should finish without errors\r\nin 2.2: unzipping operation should finish without errors\r\n```\r\n\r\nActual behavior\r\n---------------\r\nin 2.1: the next error message\r\n[screenshot](https://bdfss.blob.core.windows.net/shots/2018-07-13_00-16-52-10c79ac9-aeac-4b0f-b414-ab0db442a6c8.png)\r\n```none\r\nThe commad result is:\r\nImport-LocalizedData : Cannot find the PowerShell data file 'ArchiveResources.psd1' in directory '/usr/local/microsoft/powershell/6.0.2/Modules/Microsoft.PowerShell.Archive/1.1.0.0', or in any parent culture directories.\r\nAt /usr/local/microsoft/powershell/6.0.2/Modules/Microsoft.PowerShell.Archive/1.1.0.0/Microsoft.PowerShell.Archive.psm1:28 char:1\r\n+ Import-LocalizedData  LocalizedData -filename ArchiveResources\r\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+ CategoryInfo          : ObjectNotFound: (/usr/local/micr...eResources.psd1:String) [Import-LocalizedData], PSInvalidOperationException\r\n+ FullyQualifiedErrorId : ImportLocalizedData,Microsoft.PowerShell.Commands.ImportLocalizedData\r\n\r\n```\r\nin 2.2: the next error message\r\n[screenshot](https://bdfss.blob.core.windows.net/shots/2018-07-13_00-26-32-de5d024e-1fc6-4dee-bfce-64586fb054c9.png)\r\n```none\r\n2018-07-12T20:27:12.7355830Z PatchSimple-Dlls : The 'Expand-Archive' command was found in the module 'Microsoft.PowerShell.Archive', but the module could not be loaded. For more information, run 'Import-Module Microsoft.PowerShell.Archive'.\r\n```\r\n\r\n**There is no such issue using the Expand-Archive command either in console or using the latest VS-Code with the latest PS plugin.** \r\n\r\nEnvironment data\r\n----------------\r\nPSVersionTable \r\n<!-- provide the output of $PSVersionTable -->\r\n\r\n```powershell\r\nName                           Value                                           \r\n----                           -----                                           \r\nPSVersion                      6.0.2                                           \r\nPSEdition                      Core                                            \r\nGitCommitId                    v6.0.2                                          \r\nOS                             Darwin 17.6.0 Darwin Kernel Version 17.6.0: T...\r\nPlatform                       Unix                                            \r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}                         \r\nPSRemotingProtocolVersion      2.3                                             \r\nSerializationVersion           1.1.0.1                                         \r\nWSManStackVersion              3.0             \r\n\r\n```\r\n\r\nGet-Culture  (the same result from console and during the VSTS build)\r\n\r\n```powershell                              \r\n\r\nLCID             Name             DisplayName                                  \r\n----             ----             -----------                                  \r\n127      \r\n```\r\n\r\nContents of the **/usr/local/microsoft/powershell/6.0.2/Modules/Microsoft.PowerShell.Archive/1.1.0.0** directory\r\n\r\n```powershell                              \r\n\r\n\\---1.1.0.0\r\n    |   Microsoft.PowerShell.Archive.cat\r\n    |   Microsoft.PowerShell.Archive.psd1\r\n    |   Microsoft.PowerShell.Archive.psm1\r\n    |\r\n    \\---en-US\r\n            ArchiveResources.psd1   \r\n```\r\nWorkaround\r\n----------------\r\nCopying the **ArchiveResources.psd1** into the parent folder solving the problem.\r\n\r\n```\r\n\\---1.1.0.0\r\n    |   ArchiveResources.psd1 <-----------------------\r\n    |   Microsoft.PowerShell.Archive.cat\r\n    |   Microsoft.PowerShell.Archive.psd1\r\n    |   Microsoft.PowerShell.Archive.psm1\r\n    |\r\n    \\---en-US\r\n            ArchiveResources.psd1\r\n```\r\n\r\n",
  "closed_at": "2018-07-13T08:04:59Z",
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@bondarenkod Microsoft.PowerShell.Archive is not in the repo. Please move the issue in https://github.com/PowerShell/Microsoft.PowerShell.Archive\r\n",
      "created_at": "2018-07-13T07:29:35Z",
      "updated_at": "2018-07-13T07:29:35Z"
    },
    {
      "author": "bondarenkod",
      "author_association": "NONE",
      "body": "@iSazonov done",
      "created_at": "2018-07-13T08:04:55Z",
      "updated_at": "2018-07-13T08:04:55Z"
    }
  ],
  "created_at": "2018-07-12T21:46:26Z",
  "labels": [
    "Resolution-External"
  ],
  "number": 7282,
  "state": "closed",
  "title": "ArchiveResources file not found on mac-os for Archive module.",
  "updated_at": "2018-07-13T08:04:59Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/15899",
  "author": "xtqqczze",
  "body": "Specify a default value rather then allowing `_maximumRedirection.Value` to throw the exception.",
  "closed_at": "2021-08-24T09:55:41Z",
  "comments": [
    {
      "author": "xtqqczze",
      "author_association": "CONTRIBUTOR",
      "body": "> Actually, this doesn't look right to me. The private field `_maximumRedirected` is different than what the getter returns, and it is used internally:\r\n> \r\n> ```cs\r\n>             if (_maximumRedirection.HasValue)\r\n>             {\r\n>                 result.MaximumConnectionRedirectionCount = this.MaximumRedirection;\r\n>             }\r\n> ```\r\n> \r\n> This code is weird, but I don't think we need to change it, unless it is to remove the private field.\r\n\r\n@PaulHigin I don't think we can remove the private field. `PSSessionOption.MaximumConnectionRedirectionCount` is initialized to `WSManConnectionInfo.defaultMaximumConnectionRedirectionCount` (which is `5`). So unless we make breaking API change by making `MaximumRedirection` nullable, I think we need to keep `_maximumRedirection`. \r\n\r\nThe code is hard to understand, therefore unless you can recommend specific changes I think we should close this PR and accept the possible `InvalidOperationException`.",
      "created_at": "2021-08-20T20:22:53Z",
      "updated_at": "2021-08-20T20:22:53Z"
    }
  ],
  "created_at": "2021-08-09T23:04:29Z",
  "number": 15899,
  "state": "closed",
  "title": "Avoid possible `InvalidOperationException` in `NewPSSessionOptionCommand.MaximumRedirection`",
  "updated_at": "2021-08-24T09:55:41Z"
}
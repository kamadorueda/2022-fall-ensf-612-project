{
  "_url": "https://github.com/PowerShell/PowerShell/issues/4395",
  "author": "iSazonov",
  "body": "Adds a new non-terminating error \r\n\r\nFix #4390.\r\n\r\n### Problem ###\r\nIf a file is read only it is skipping silently.\r\n\r\n### Fix ###\r\nAnalize GetLastError() and throw if a file stream hasn't been removed.\r\n\r\nFirst commit only refactor tests to use `ShouldBeErrorId`.",
  "closed_at": "2017-08-14T15:49:39Z",
  "comments": [
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@iSazonov what is the error message the user sees now?",
      "created_at": "2017-08-01T04:42:08Z",
      "updated_at": "2017-08-01T04:42:08Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "[MSDN](https://msdn.microsoft.com/en-us/library/windows/desktop/aa363915(v=vs.85).aspx) says that `GetLastError` can return either \"Access denied\" or \"File not found\".\r\n```powershell\r\nUnblock-File : Access is denied\r\nAt line:1 char:1\r\n+ Unblock-File -Path $Testpath\r\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    + CategoryInfo          : NotSpecified: (:) [Unblock-File], Win32Exception\r\n    + FullyQualifiedErrorId : System.ComponentModel.Win32Exception,Microsoft.PowerShell.Commands.UnblockFileCommand\r\n```",
      "created_at": "2017-08-02T09:55:24Z",
      "updated_at": "2017-08-02T09:55:24Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@lzybkr @SteveL-MSFT Please continue the code review.",
      "created_at": "2017-08-11T14:10:48Z",
      "updated_at": "2017-08-11T14:10:48Z"
    }
  ],
  "created_at": "2017-07-31T06:52:01Z",
  "number": 4395,
  "state": "closed",
  "title": "Fix unblock read only file",
  "updated_at": "2017-08-15T09:22:00Z"
}
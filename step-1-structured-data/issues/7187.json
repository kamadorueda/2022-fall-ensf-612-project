{
  "_url": "https://github.com/PowerShell/PowerShell/issues/7187",
  "author": "SteveL-MSFT",
  "body": "This is a regression from 6.1-Preview.3.  Doesn't repro unless you have a module with a class that has hidden members.  Test module PSSysLog is such a module.\r\n\r\nSteps to reproduce\r\n------------------\r\n\r\n```powershell\r\nImport-Module build.psm1\r\nGet-Help -Category Class\r\n```\r\n\r\nExpected behavior\r\n-----------------\r\n\r\n```none\r\nNothing returned\r\n```\r\n\r\nActual behavior\r\n---------------\r\n\r\nRelease build\r\n```none\r\nget-help : Object reference not set to an instance of an object.\r\nAt line:1 char:1\r\n+ get-help -Category Class\r\n+ ~~~~~~~~~~~~~~~~~~~~~~~~\r\n+ CategoryInfo          : NotSpecified: (:) [Get-Help], NullReferenceException\r\n+ FullyQualifiedErrorId :System.NullReferenceException,Microsoft.PowerShell.Commands.GetHelpCommand\r\n```\r\n\r\nDebug build\r\n```none\r\nAssertion Failed                                                                                                                                                                                                                            PropertyType cannot be null                                                                                                                                                                                                                                                                                                                                                                                                                                                                at System.Management.Automation.Diagnostics.Assert(Boolean condition, String whyThisShouldNeverHappen, String detailMessage) in /Users/steve/repos/PowerShell/src/System.Management.Automation/utils/assert.cs:line 195                     at System.Management.Automation.Diagnostics.Assert(Boolean condition, String whyThisShouldNeverHappen) in /Users/steve/repos/PowerShell/src/System.Management.Automation/utils/assert.cs:line 130                                        \r\n   at System.Management.Automation.PSClassSearcher.ConvertToClassInfo(PSModuleInfo module, ScriptBlockAst ast, TypeDefinitionAst statement) in /Users/steve/repos/PowerShell/src/System.Management.Automation/engine/PSClassSearcher.cs:line 303\r\n   at System.Management.Automation.PSClassSearcher.CachedItemToPSClassInfo(WildcardPattern classNameMatcher, String modulePath) in /Users/steve/repos/PowerShell/src/System.Management.Automation/engine/PSClassSearcher.cs:line 238\r\n   at System.Management.Automation.PSClassSearcher.FindTypeByModulePath(WildcardPattern classNameMatcher) in /Users/steve/repos/PowerShell/src/System.Management.Automation/engine/PSClassSearcher.cs:line 188\r\n   at System.Management.Automation.PSClassSearcher.GetNextClass() in /Users/steve/repos/PowerShell/src/System.Management.Automation/engine/PSClassSearcher.cs:line 138\r\n   at System.Management.Automation.PSClassSearcher.MoveNext() in /Users/steve/repos/PowerShell/src/System.Management.Automation/engine/PSClassSearcher.cs:line 90\r\n   at System.Management.Automation.PSClassHelpProvider.GetHelpInfo(PSClassSearcher searcher)+MoveNext() in /Users/steve/repos/PowerShell/src/System.Management.Automation/help/PSClassHelpProvider.cs:line 132\r\n   at System.Management.Automation.PSClassHelpProvider.SearchHelp(HelpRequest helpRequest, Boolean searchOnlyContent)+MoveNext() in /Users/steve/repos/PowerShell/src/System.Management.Automation/help/PSClassHelpProvider.cs:line 89\r\n   at System.Management.Automation.HelpSystem.SearchHelp(HelpRequest helpRequest)+MoveNext() in /Users/steve/repos/PowerShell/src/System.Management.Automation/help/HelpSystem.cs:line 497\r\n   at System.Management.Automation.HelpSystem.DoGetHelp(HelpRequest helpRequest)+MoveNext() in /Users/steve/repos/PowerShell/src/System.Management.Automation/help/HelpSystem.cs:line 318\r\n   at Microsoft.PowerShell.Commands.GetHelpCommand.ProcessRecord() in /Users/steve/repos/PowerShell/src/System.Management.Automation/help/HelpCommands.cs:line 278\r\n   at System.Management.Automation.Cmdlet.DoProcessRecord() in /Users/steve/repos/PowerShell/src/System.Management.Automation/engine/cmdlet.cs:line 172\r\n   at System.Management.Automation.CommandProcessor.ProcessRecord() in /Users/steve/repos/PowerShell/src/System.Management.Automation/engine/CommandProcessor.cs:line 358\r\n   at System.Management.Automation.CommandProcessorBase.DoExecute() in /Users/steve/repos/PowerShell/src/System.Management.Automation/engine/CommandProcessorBase.cs:line 539\r\n   at System.Management.Automation.Internal.PipelineProcessor.Inject(Object input, Boolean enumerate) in /Users/steve/repos/PowerShell/src/System.Management.Automation/engine/pipeline.cs:line 1159\r\n   at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input) in /Users/steve/repos/PowerShell/src/System.Management.Automation/engine/pipeline.cs:line 499\r\n   at System.Management.Automation.PipelineOps.InvokePipeline(Object input, Boolean ignoreInput, CommandParameterInternal[][] pipeElements, CommandBaseAst[] pipeElementAsts, CommandRedirection[][] commandRedirections, FunctionContext funcContext) in /Users/steve/repos/PowerShell/src/System.Management.Automation/engine/runtime/Operations/MiscOps.cs:line 454\r\n   at System.Management.Automation.Interpreter.ActionCallInstruction`6.Run(InterpretedFrame frame) in /Users/steve/repos/PowerShell/src/System.Management.Automation/engine/interpreter/CallInstruction.Generated.cs:line 566\r\n   at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame) in /Users/steve/repos/PowerShell/src/System.Management.Automation/engine/interpreter/ControlFlowInstructions.cs:line 356\r\n   at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame) in /Users/steve/repos/PowerShell/src/System.Management.Automation/engine/interpreter/ControlFlowInstructions.cs:line 356\r\n   at System.Management.Automation.Interpreter.Interpreter.Run(InterpretedFrame frame) in /Users/steve/repos/PowerShell/src/System.Management.Automation/engine/interpreter/Interpreter.cs:line 111\r\n   at System.Management.Automation.Interpreter.LightLambda.RunVoid1[T0](T0 arg0) in /Users/steve/repos/PowerShell/src/System.Management.Automation/engine/interpreter/LightLambda.Generated.cs:line 77\r\n   at System.Management.Automation.DlrScriptCommandProcessor.RunClause(Action`1 clause, Object dollarUnderbar, Object inputToProcess) in /Users/steve/repos/PowerShell/src/System.Management.Automation/engine/ScriptCommandProcessor.cs:line 515\r\n   at System.Management.Automation.DlrScriptCommandProcessor.Complete() in /Users/steve/repos/PowerShell/src/System.Management.Automation/engine/ScriptCommandProcessor.cs:line 416\r\n   at System.Management.Automation.CommandProcessorBase.DoComplete() in /Users/steve/repos/PowerShell/src/System.Management.Automation/engine/CommandProcessorBase.cs:line 613\r\n   at System.Management.Automation.Internal.PipelineProcessor.DoCompleteCore(CommandProcessorBase commandRequestingUpstreamCommandsToStop) in /Users/steve/repos/PowerShell/src/System.Management.Automation/engine/pipeline.cs:line 606\r\n   at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input) in /Users/steve/repos/PowerShell/src/System.Management.Automation/engine/pipeline.cs:line 518\r\n   at System.Management.Automation.Runspaces.LocalPipeline.InvokeHelper() in /Users/steve/repos/PowerShell/src/System.Management.Automation/engine/hostifaces/LocalPipeline.cs:line 377\r\n   at System.Management.Automation.Runspaces.LocalPipeline.InvokeThreadProc() in /Users/steve/repos/PowerShell/src/System.Management.Automation/engine/hostifaces/LocalPipeline.cs:line 573\r\n   at System.Management.Automation.Runspaces.PipelineThread.WorkerProc() in /Users/steve/repos/PowerShell/src/System.Management.Automation/engine/hostifaces/LocalPipeline.cs:line 1254\r\n   at System.Threading.Thread.ThreadMain_ThreadStart()\r\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)\r\n```\r\n\r\nEnvironment data\r\n----------------\r\n\r\n<!-- provide the output of $PSVersionTable -->\r\n\r\n```powershell\r\nName                           Value\r\n----                           -----\r\nPSVersion                      6.1.0-preview.3\r\nPSEdition                      Core\r\nGitCommitId                    v6.1.0-preview.3-47-ge8d2a6b27827dd366f638468f96487ddf2de1db4\r\nOS                             Darwin 17.6.0 Darwin Kernel Version 17.6.0: Tue May  8 15:22:16 PDT 2018; root:xnu-4570.61.1~1/RELEASE_X86_64\r\nPlatform                       Unix\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n",
  "closed_at": "2018-06-29T06:29:12Z",
  "comments": [
    {
      "author": "adityapatwardhan",
      "author_association": "MEMBER",
      "body": "@SteveL-MSFT  I am not able to reproduce this on `6.1.0-preview.3` on Windows or macOS",
      "created_at": "2018-06-28T20:15:49Z",
      "updated_at": "2018-06-28T20:15:49Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@adityapatwardhan it repros if you have the test modules folder in PSModulePath as PSSysLog test module has a class with hidden members which exposed this",
      "created_at": "2018-06-28T21:15:14Z",
      "updated_at": "2018-06-28T21:15:14Z"
    }
  ],
  "created_at": "2018-06-26T20:09:39Z",
  "labels": [
    "Issue-Bug",
    "WG-Interactive-HelpSystem",
    "Resolution-Fixed"
  ],
  "number": 7187,
  "state": "closed",
  "title": "`Get-Help -Category Class` results in unhandled exception",
  "updated_at": "2018-06-29T06:33:54Z"
}
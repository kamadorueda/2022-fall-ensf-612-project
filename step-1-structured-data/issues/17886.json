{
  "_url": "https://github.com/PowerShell/PowerShell/issues/17886",
  "author": "harriott",
  "body": "### Prerequisites\r\n\r\n- [X] Write a descriptive title.\r\n- [X] Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\r\n- [X] Search the existing issues.\r\n- [X] Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\r\n- [X] Refer to [Differences between Windows PowerShell 5.1 and PowerShell](https://docs.microsoft.com/powershell/scripting/whats-new/differences-from-windows-powershell).\r\n\r\n### Steps to reproduce\r\n\r\n$host.privatedata.ErrorForegroundColor = 'DarkGray'  # works as in PowerShell v7.2.4\r\n$host.UI.RawUI.ForegroundColor = \"DarkGreen\"  # ineffective\r\n[System.Console]::ForegroundColor = 'DarkCyan'  # no longer effective\r\n\r\n### Expected behavior\r\n\r\n```console\r\nthose `ForegroundColor` methods should change the foreground colour, as they did in `PowerShell v7.2.4`\r\n```\r\n\r\n\r\n### Actual behavior\r\n\r\n```console\r\nno change in foreground colour\r\n```\r\n\r\n\r\n### Environment data\r\n\r\n```powershell\r\nName                           Value\r\n    ----                           -----\r\n    PSVersion                      7.2.6\r\n    PSEdition                      Core\r\n    GitCommitId                    7.2.6\r\n    OS                             Microsoft Windows 10.0.19044\r\n    Platform                       Win32NT\r\n    PSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\n    PSRemotingProtocolVersion      2.3\r\n    SerializationVersion           1.1.0.1\r\n    WSManStackVersion              3.0\r\n```\r\n\r\n\r\n### OS Data\r\n\r\n```powershell\r\nVersion    Caption\r\n    -------    -------\r\n    10.0.19044 Microsoft Windows 10 Pro\r\n```\r\n\r\n\r\n### Windows update log\r\n<details>\r\n```markdown\r\ntruncated for 65536 character limit\r\n\r\n    2022/08/12 21:09:57.9093371 3372  3484  Misc            ServiceManager uninit\r\n    2022/08/12 21:09:57.9095298 3372  3484  Misc            PersistentTimeoutScheduler uninit\r\n    2022/08/12 21:09:57.9095335 3372  3484  Misc            datastore uninit\r\n    2022/08/12 21:09:57.9516797 3372  3484  Misc            setting cache uninit\r\n    2022/08/12 21:09:57.9516819 3372  3484  Misc            security checker uninit\r\n    2022/08/12 21:09:57.9516850 3372  3484  Misc            Test Hook uninit\r\n    2022/08/12 21:09:57.9516858 3372  3484  Misc            IdleTimer uninit\r\n    2022/08/12 21:09:57.9520327 3372  3484  Shared          * END * Service exit Exit code = 0x240001\r\n    2022/08/12 21:19:23.6532954 4912  9848  Shared          InitializeSus\r\n    2022/08/12 21:19:23.6538195 4912  9848  IdleTimer       Non-AoAc machine.  Aoac operations will be ignored.\r\n    2022/08/12 21:19:23.6539557 4912  9848  Agent           WU client version 10.0.19041.1865\r\n    2022/08/12 21:19:23.6544223 4912  9848  Agent           SleepStudyTracker: Machine is non-AOAC. Sleep study tracker disabled.\r\n    2022/08/12 21:19:23.6545549 4912  9848  Agent           Base directory: C:\\WINDOWS\\SoftwareDistribution\r\n    2022/08/12 21:19:23.6552684 4912  9848  Agent           Datastore directory: C:\\WINDOWS\\SoftwareDistribution\\DataStore\\DataStore.edb\r\n    2022/08/12 21:19:23.6562088 4912  9848  DataStore       JetEnableMultiInstance succeeded - applicable param count: 5, applied param count: 5\r\n    2022/08/12 21:19:24.2221466 4912  9848  Shared          UpdateNetworkState Ipv6, cNetworkInterfaces = 0.\r\n    2022/08/12 21:19:24.2223490 4912  9848  Shared          UpdateNetworkState Ipv4, cNetworkInterfaces = 1.\r\n    2022/08/12 21:19:24.2242008 4912  9848  Shared          Network state: Connected\r\n    2022/08/12 21:19:24.3925481 4912  9848  Shared          UpdateNetworkState Ipv6, cNetworkInterfaces = 0.\r\n    2022/08/12 21:19:24.3925607 4912  9848  Shared          UpdateNetworkState Ipv4, cNetworkInterfaces = 1.\r\n    2022/08/12 21:19:24.3925754 4912  9848  Shared          Power status changed\r\n    2022/08/12 21:19:24.3966585 4912  9848  Agent           Initializing global settings cache\r\n    2022/08/12 21:19:24.3966606 4912  9848  Agent           WSUS server: (null)\r\n    2022/08/12 21:19:24.3966615 4912  9848  Agent           WSUS status server: (null)\r\n    2022/08/12 21:19:24.3966624 4912  9848  Agent           Alternate Download Server: (null)\r\n    2022/08/12 21:19:24.3966684 4912  9848  Agent           Fill Empty Content Urls: No\r\n    2022/08/12 21:19:24.3966704 4912  9848  Agent           Target group: (Unassigned Computers)\r\n    2022/08/12 21:19:24.3966717 4912  9848  Agent           Windows Update access disabled: No\r\n    2022/08/12 21:19:24.3966792 4912  9848  Agent           Do not connect to Windows Update Internet locations: No\r\n    2022/08/12 21:19:24.3984408 4912  9848  Agent               Timer: 29A863E7-8609-4D1E-B7CD-5668F857F1DB, Expires 2022-08-13 09:06:20, not idle-only, not network-only\r\n    2022/08/12 21:19:24.4046430 4912  9848  Agent           Initializing Windows Update Agent\r\n    2022/08/12 21:19:24.4047626 4912  9848  DownloadManager Download manager restoring 0 downloads\r\n    2022/08/12 21:19:24.4048320 4912  9848  Agent           CPersistentTimeoutScheduler | GetTimer, returned hr = 0x00000000\r\n    2022/08/12 21:19:24.4053127 4912  9848  IdleTimer       IdleTimer::NetworkStateChanged. Network connected? Yes\r\n    2022/08/12 21:19:24.4060254 4912  9464  IdleTimer       WU operation (SR.Update;ScanForUpdates ID 1) started; operation # 3; does use network; is not at background priority\r\n    2022/08/12 21:19:24.4159851 4912  11436 DownloadManager Received power state change notification: Old: <unknown>; New: AC.\r\n    2022/08/12 21:19:24.4159889 4912  11436 DownloadManager Power state changed from <unknown> to AC.\r\n    2022/08/12 21:19:24.4241730 4912  12840 SLS             Get response for service 855E8A7C-ECB4-4CA3-B045-1DFA50104289 - forceExpire[False] asyncRefreshOnExpiry[False]\r\n    2022/08/12 21:19:24.4241786 4912  12840 SLS             path used for cache lookup: /SLS/{855E8A7C-ECB4-4CA3-B045-1DFA50104289}/x64/10.0.19044.1889/0?CH=532&L=en-GB&P=&PT=0x30&WUA=10.0.19041.1865&MK=LENOVO&MD=23539WU\r\n    2022/08/12 21:19:24.4273639 4912  12840 SLS             Revision Check is on with Environment ID [StoreDCatProdPrereleasePublic-GradualRollout] Revision [9]...\r\n    2022/08/12 21:19:24.4273683 4912  12840 SLS             Retrieving SLS response from server using ETAG uIRgoYo2/q6DQpiIxjMrrNAXWjdzaFqRXFTMfZlvTtY=_1440\"...\"\r\n    2022/08/12 21:19:24.4295583 4912  12840 SLS             Making request with URL HTTPS://slscr.update.microsoft.com/SLS/{855E8A7C-ECB4-4CA3-B045-1DFA50104289}/x64/10.0.19044.1889/0?CH=532&L=en-GB&P=&PT=0x30&WUA=10.0.19041.1865&MK=LENOVO&MD=23539WU and send SLS events.\r\n    2022/08/12 21:19:25.0998405 4912  12840 Misc            StatusCode for transaction returned from WinHttpQueryHeaders is 304\r\n    2022/08/12 21:19:25.1194189 4912  12840 SLS             Complete the request URL HTTPS://slscr.update.microsoft.com/SLS/{855E8A7C-ECB4-4CA3-B045-1DFA50104289}/x64/10.0.19044.1889/0?CH=532&L=en-GB&P=&PT=0x30&WUA=10.0.19041.1865&MK=LENOVO&MD=23539WU with [00000000] and http status code[304] and send SLS events.\r\n    2022/08/12 21:19:25.1460624 4912  12840 IdleTimer       WU operation (SR.Update;ScanForUpdates ID 1, operation # 3) stopped; does use network; is not at background priority\r\n    2022/08/12 21:19:25.1563455 13348 484   ComApi          Federated Search: Starting search against 1 service(s) (cV = N+NC/IIFmEa2s+Zw.1.0.1.0)\r\n    2022/08/12 21:19:25.1565088 13348 484   ComApi          * START *   Search ClientId = Update;ScanForUpdates, ServiceId = 855E8A7C-ECB4-4CA3-B045-1DFA50104289, Flags: 0X8000000 (cV = N+NC/IIFmEa2s+Zw.1.0.1.0.0)\r\n    2022/08/12 21:19:25.1577957 4912  5324  IdleTimer       WU operation (CSearchCall::Init ID 2) started; operation # 6; does not use network; is at background priority\r\n    2022/08/12 21:19:25.1686947 4912  5324  Reporter        OS Product Type = 0x00000030\r\n    2022/08/12 21:19:25.1822608 4912  5324  Agent           * START * Queueing Finding updates [CallerId = Update;ScanForUpdates  Id = 2]\r\n    2022/08/12 21:19:25.1822712 4912  5324  Agent           Service 855E8A7C-ECB4-4CA3-B045-1DFA50104289 is not in sequential scan list\r\n    2022/08/12 21:19:25.1825638 4912  13884 Agent           Service 855E8A7C-ECB4-4CA3-B045-1DFA50104289 is not in sequential scan list\r\n    2022/08/12 21:19:25.1831021 4912  1216  Agent           * END * Queueing Finding updates [CallerId = Update;ScanForUpdates  Id = 2]\r\n    2022/08/12 21:19:25.1834693 4912  1216  Agent           * START * Finding updates CallerId = Update;ScanForUpdates  Id = 2 (cV = N+NC/IIFmEa2s+Zw.1.0.1.0.0.1)\r\n    2022/08/12 21:19:25.1834718 4912  1216  Agent           Online = No; Interactive = No; AllowCachedResults = No; Ignore download priority = No\r\n    2022/08/12 21:19:25.1834731 4912  1216  Agent           Criteria = IsInstalled=0 AND AppCategoryIDs contains '421ba874-f903-4965-9b82-d60f3ba3cae0'\"\"\r\n    2022/08/12 21:19:25.1834758 4912  1216  Agent           ServiceID = {855E8A7C-ECB4-4CA3-B045-1DFA50104289} Third party service\r\n    2022/08/12 21:19:25.1834767 4912  1216  Agent           Search Scope = {Machine & All Users}\r\n    2022/08/12 21:19:25.1834797 4912  1216  Agent           Caller SID for Applicability: S-1-5-18\r\n    2022/08/12 21:19:25.8577395 4912  1216  SLS             Get response for service 855E8A7C-ECB4-4CA3-B045-1DFA50104289 - forceExpire[False] asyncRefreshOnExpiry[False]\r\n    2022/08/12 21:19:25.8577447 4912  1216  SLS             path used for cache lookup: /SLS/{855E8A7C-ECB4-4CA3-B045-1DFA50104289}/x64/10.0.19044.1889/0?CH=532&L=en-GB&P=&PT=0x30&WUA=10.0.19041.1865&MK=LENOVO&MD=23539WU\r\n    2022/08/12 21:19:26.7268953 4912  1216  Handler         *FAILED* [80070032] Method failed [AppxPackage::Initialize:232]\r\n    2022/08/12 21:19:26.7269048 4912  1216  Handler         *FAILED* [80070032] Method failed [AppxApplicabilityData::Initialize:549]\r\n    2022/08/12 21:19:26.7269815 4912  1216  EEHandler       *FAILED* [80070032] EvaluateManifestBasedRule failed for update 7FAEA24D-3214-4252-A063-D0EEC2F61176.1, idExpr=57\r\n    2022/08/12 21:19:26.7269856 4912  1216  Agent           *FAILED* [80070032] Evaluate Installed rule, updateId = {{7FAEA24D-3214-4252-A063-D0EEC2F61176}.1}\r\n    2022/08/12 21:19:26.7281971 4912  1216  Handler         *FAILED* [80070032] Method failed [AppxPackage::Initialize:232]\r\n    2022/08/12 21:19:26.7282002 4912  1216  Handler         *FAILED* [80070032] Method failed [AppxApplicabilityData::Initialize:549]\r\n    2022/08/12 21:19:26.7282574 4912  1216  EEHandler       *FAILED* [80070032] EvaluateManifestBasedRule failed for update 7FAEA24D-3214-4252-A063-D0EEC2F61176.1, idExpr=56\r\n    2022/08/12 21:19:26.7282612 4912  1216  Agent           *FAILED* [80070032] Evaluate Installable rule, updateId = {{7FAEA24D-3214-4252-A063-D0EEC2F61176}.1}\r\n    2022/08/12 21:19:26.8292647 4912  1216  Agent           Added update 755634B9-311E-4763-9AD1-DFBCFD715915.1 to search result\r\n    2022/08/12 21:19:26.8292724 4912  1216  Agent           Added update E066C2CC-9C49-4345-8ECD-058D3DB06BC6.1 to search result\r\n    2022/08/12 21:19:26.8292787 4912  1216  Agent           Added update 885527E4-6919-4F0C-9B8E-93BE80D6CD8D.1 to search result\r\n    2022/08/12 21:19:26.8292849 4912  1216  Agent           Added update 78A23D20-7A4F-4E7B-9F60-75E43049B0CF.1 to search result\r\n    2022/08/12 21:19:26.8292914 4912  1216  Agent           Removing unreferenced framework update {78A23D20-7A4F-4E7B-9F60-75E43049B0CF}.1 from search result.\r\n    2022/08/12 21:19:26.8293103 4912  1216  Agent           Removing unreferenced framework update {885527E4-6919-4F0C-9B8E-93BE80D6CD8D}.1 from search result.\r\n    2022/08/12 21:19:26.8293181 4912  1216  Agent           Removing unreferenced framework update {E066C2CC-9C49-4345-8ECD-058D3DB06BC6}.1 from search result.\r\n    2022/08/12 21:19:26.8293327 4912  1216  Agent           Removing unreferenced framework update {755634B9-311E-4763-9AD1-DFBCFD715915}.1 from search result.\r\n    2022/08/12 21:19:26.8293558 4912  1216  Agent           Found 0 updates and 3 categories in search; evaluated appl. rules of 62 out of 105 deployed entities\r\n    2022/08/12 21:19:26.8324163 4912  1216  Agent           * END * Finding updates CallerId = Update;ScanForUpdates, Id = 2, Exit code = 0x00000000 (cV = N+NC/IIFmEa2s+Zw.1.0.1.0.0.1)\r\n    2022/08/12 21:19:26.8376304 4912  1216  IdleTimer       WU operation (CSearchCall::Init ID 2, operation # 6) stopped; does not use network; is at background priority\r\n    2022/08/12 21:19:26.8436921 13348 4836  ComApi          *RESUMED*   Search ClientId = Update;ScanForUpdates, ServiceId = 855E8A7C-ECB4-4CA3-B045-1DFA50104289 (cV = N+NC/IIFmEa2s+Zw.1.0.1.0.0)\r\n    2022/08/12 21:19:26.8474328 13348 4836  ComApi          * END *   Search ClientId = Update;ScanForUpdates, Updates found = 0, ServiceId = 855E8A7C-ECB4-4CA3-B045-1DFA50104289 (cV = N+NC/IIFmEa2s+Zw.1.0.1.0.0)\r\n    2022/08/12 21:19:26.8477809 13348 484   ComApi          * END *   All federated searches have completed. Jobs = 1, Succeeded = 1, ClientId = Update;ScanForUpdates (cV = N+NC/IIFmEa2s+Zw.1.0.1.1)\r\n    2022/08/12 21:19:26.8622483 13348 4628  ComApi          * START *   Federated Search ClientId = Update;ScanForUpdates (cV: N+NC/IIFmEa2s+Zw.1.0.1.0)\r\n    2022/08/12 21:19:26.8629940 4912  13188 IdleTimer       WU operation (SR.Update;ScanForUpdates ID 3) started; operation # 13; does use network; is not at background priority\r\n    2022/08/12 21:19:26.8741196 4912  12840 SLS             Get response for service 855E8A7C-ECB4-4CA3-B045-1DFA50104289 - forceExpire[False] asyncRefreshOnExpiry[False]\r\n    2022/08/12 21:19:26.8741357 4912  12840 SLS             path used for cache lookup: /SLS/{855E8A7C-ECB4-4CA3-B045-1DFA50104289}/x64/10.0.19044.1889/0?CH=532&L=en-GB&P=&PT=0x30&WUA=10.0.19041.1865&MK=LENOVO&MD=23539WU\r\n    2022/08/12 21:19:26.8752845 4912  12840 IdleTimer       WU operation (SR.Update;ScanForUpdates ID 3, operation # 13) stopped; does use network; is not at background priority\r\n    2022/08/12 21:19:26.8907257 13348 3216  ComApi          Federated Search: Starting search against 1 service(s) (cV = N+NC/IIFmEa2s+Zw.1.0.1.0)\r\n    2022/08/12 21:19:26.8908547 13348 3216  ComApi          * START *   Search ClientId = Update;ScanForUpdates, ServiceId = 855E8A7C-ECB4-4CA3-B045-1DFA50104289, Flags: 0X8000000 (cV = N+NC/IIFmEa2s+Zw.1.0.1.0.0)\r\n    2022/08/12 21:19:26.8920246 4912  13188 IdleTimer       WU operation (CSearchCall::Init ID 4) started; operation # 16; does not use network; is at background priority\r\n    2022/08/12 21:19:26.9010603 4912  13188 Agent           * START * Queueing Finding updates [CallerId = Update;ScanForUpdates  Id = 4]\r\n    2022/08/12 21:19:26.9010664 4912  13188 Agent           Service 855E8A7C-ECB4-4CA3-B045-1DFA50104289 is not in sequential scan list\r\n    2022/08/12 21:19:26.9012347 4912  13884 Agent           Service 855E8A7C-ECB4-4CA3-B045-1DFA50104289 is not in sequential scan list\r\n    2022/08/12 21:19:26.9017188 4912  1120  Agent           * END * Queueing Finding updates [CallerId = Update;ScanForUpdates  Id = 4]\r\n    2022/08/12 21:19:26.9020374 4912  1120  Agent           * START * Finding updates CallerId = Update;ScanForUpdates  Id = 4 (cV = N+NC/IIFmEa2s+Zw.1.0.1.0.0.1)\r\n    2022/08/12 21:19:26.9020400 4912  1120  Agent           Online = No; Interactive = No; AllowCachedResults = No; Ignore download priority = No\r\n    2022/08/12 21:19:26.9020410 4912  1120  Agent           Criteria = IsInstalled=0 AND AppCategoryIDs contains '579fc437-d398-411c-a6c5-d01fd4523b94'\"\"\r\n    2022/08/12 21:19:26.9020433 4912  1120  Agent           ServiceID = {855E8A7C-ECB4-4CA3-B045-1DFA50104289} Third party service\r\n    2022/08/12 21:19:26.9020442 4912  1120  Agent           Search Scope = {Machine & All Users}\r\n    2022/08/12 21:19:26.9020466 4912  1120  Agent           Caller SID for Applicability: S-1-5-18\r\n    2022/08/12 21:19:27.0891817 4912  1120  SLS             Get response for service 855E8A7C-ECB4-4CA3-B045-1DFA50104289 - forceExpire[False] asyncRefreshOnExpiry[False]\r\n    2022/08/12 21:19:27.0891874 4912  1120  SLS             path used for cache lookup: /SLS/{855E8A7C-ECB4-4CA3-B045-1DFA50104289}/x64/10.0.19044.1889/0?CH=532&L=en-GB&P=&PT=0x30&WUA=10.0.19041.1865&MK=LENOVO&MD=23539WU\r\n    2022/08/12 21:19:27.8670793 4912  1120  Agent           Found 0 updates and 3 categories in search; evaluated appl. rules of 50 out of 79 deployed entities\r\n    2022/08/12 21:19:27.8693228 4912  1120  Agent           * END * Finding updates CallerId = Update;ScanForUpdates, Id = 4, Exit code = 0x00000000 (cV = N+NC/IIFmEa2s+Zw.1.0.1.0.0.1)\r\n    2022/08/12 21:19:27.8741563 4912  1120  IdleTimer       WU operation (CSearchCall::Init ID 4, operation # 16) stopped; does not use network; is at background priority\r\n    2022/08/12 21:19:27.8881276 13348 4836  ComApi          *RESUMED*   Search ClientId = Update;ScanForUpdates, ServiceId = 855E8A7C-ECB4-4CA3-B045-1DFA50104289 (cV = N+NC/IIFmEa2s+Zw.1.0.1.0.0)\r\n    2022/08/12 21:19:27.8888420 13348 4836  ComApi          * END *   Search ClientId = Update;ScanForUpdates, Updates found = 0, ServiceId = 855E8A7C-ECB4-4CA3-B045-1DFA50104289 (cV = N+NC/IIFmEa2s+Zw.1.0.1.0.0)\r\n    2022/08/12 21:19:27.8890970 13348 3216  ComApi          * END *   All federated searches have completed. Jobs = 1, Succeeded = 1, ClientId = Update;ScanForUpdates (cV = N+NC/IIFmEa2s+Zw.1.0.1.1)\r\n    2022/08/12 21:19:27.8952747 13348 4628  ComApi          * START *   Federated Search ClientId = Update;ScanForUpdates (cV: JnDsVvBMREi17cE4.1.0.1.0)\r\n    2022/08/12 21:19:27.8960070 4912  13188 IdleTimer       WU operation (SR.Update;ScanForUpdates ID 5) started; operation # 23; does use network; is not at background priority\r\n    2022/08/12 21:19:27.9081813 4912  12840 SLS             Get response for service 855E8A7C-ECB4-4CA3-B045-1DFA50104289 - forceExpire[False] asyncRefreshOnExpiry[False]\r\n    2022/08/12 21:19:27.9081995 4912  12840 SLS             path used for cache lookup: /SLS/{855E8A7C-ECB4-4CA3-B045-1DFA50104289}/x64/10.0.19044.1889/0?CH=532&L=en-GB&P=&PT=0x30&WUA=10.0.19041.1865&MK=LENOVO&MD=23539WU\r\n    2022/08/12 21:19:27.9089026 4912  12840 IdleTimer       WU operation (SR.Update;ScanForUpdates ID 5, operation # 23) stopped; does use network; is not at background priority\r\n    2022/08/12 21:19:27.9206852 13348 13736 ComApi          Federated Search: Starting search against 1 service(s) (cV = JnDsVvBMREi17cE4.1.0.1.0)\r\n    2022/08/12 21:19:27.9208907 13348 13736 ComApi          * START *   Search ClientId = Update;ScanForUpdates, ServiceId = 855E8A7C-ECB4-4CA3-B045-1DFA50104289, Flags: 0X8000000 (cV = JnDsVvBMREi17cE4.1.0.1.0.0)\r\n    2022/08/12 21:19:27.9228829 4912  13188 IdleTimer       WU operation (CSearchCall::Init ID 6) started; operation # 26; does not use network; is at background priority\r\n    2022/08/12 21:19:27.9336348 4912  13188 Agent           * START * Queueing Finding updates [CallerId = Update;ScanForUpdates  Id = 6]\r\n    2022/08/12 21:19:27.9336419 4912  13188 Agent           Service 855E8A7C-ECB4-4CA3-B045-1DFA50104289 is not in sequential scan list\r\n    2022/08/12 21:19:27.9337753 4912  13884 Agent           Service 855E8A7C-ECB4-4CA3-B045-1DFA50104289 is not in sequential scan list\r\n    2022/08/12 21:19:27.9343367 4912  996   Agent           * END * Queueing Finding updates [CallerId = Update;ScanForUpdates  Id = 6]\r\n    2022/08/12 21:19:27.9346755 4912  996   Agent           * START * Finding updates CallerId = Update;ScanForUpdates  Id = 6 (cV = JnDsVvBMREi17cE4.1.0.1.0.0.1)\r\n    2022/08/12 21:19:27.9346777 4912  996   Agent           Online = No; Interactive = No; AllowCachedResults = No; Ignore download priority = No\r\n    2022/08/12 21:19:27.9346788 4912  996   Agent           Criteria = IsInstalled=0 AND AppCategoryIDs contains '64a79953-cf0b-44f9-b5c4-ee5df3a15c63'\"\"\r\n    2022/08/12 21:19:27.9346811 4912  996   Agent           ServiceID = {855E8A7C-ECB4-4CA3-B045-1DFA50104289} Third party service\r\n    2022/08/12 21:19:27.9346820 4912  996   Agent           Search Scope = {Machine & All Users}\r\n    2022/08/12 21:19:27.9346844 4912  996   Agent           Caller SID for Applicability: S-1-5-18\r\n    2022/08/12 21:19:28.1536065 4912  996   SLS             Get response for service 855E8A7C-ECB4-4CA3-B045-1DFA50104289 - forceExpire[False] asyncRefreshOnExpiry[False]\r\n    2022/08/12 21:19:28.1536121 4912  996   SLS             path used for cache lookup: /SLS/{855E8A7C-ECB4-4CA3-B045-1DFA50104289}/x64/10.0.19044.1889/0?CH=532&L=en-GB&P=&PT=0x30&WUA=10.0.19041.1865&MK=LENOVO&MD=23539WU\r\n    2022/08/12 21:19:28.5993830 4912  996   Agent           Added update E066C2CC-9C49-4345-8ECD-058D3DB06BC6.1 to search result\r\n    2022/08/12 21:19:28.5993945 4912  996   Agent           Added update 885527E4-6919-4F0C-9B8E-93BE80D6CD8D.1 to search result\r\n    2022/08/12 21:19:28.5994017 4912  996   Agent           Removing unreferenced framework update {885527E4-6919-4F0C-9B8E-93BE80D6CD8D}.1 from search result.\r\n    2022/08/12 21:19:28.5994107 4912  996   Agent           Removing unreferenced framework update {E066C2CC-9C49-4345-8ECD-058D3DB06BC6}.1 from search result.\r\n    2022/08/12 21:19:28.5994230 4912  996   Agent           Found 0 updates and 3 categories in search; evaluated appl. rules of 39 out of 64 deployed entities\r\n    2022/08/12 21:19:28.6012970 4912  996   Agent           * END * Finding updates CallerId = Update;ScanForUpdates, Id = 6, Exit code = 0x00000000 (cV = JnDsVvBMREi17cE4.1.0.1.0.0.1)\r\n    2022/08/12 21:19:28.6046606 4912  996   IdleTimer       WU operation (CSearchCall::Init ID 6, operation # 26) stopped; does not use network; is at background priority\r\n    2022/08/12 21:19:28.6069166 13348 4836  ComApi          *RESUMED*   Search ClientId = Update;ScanForUpdates, ServiceId = 855E8A7C-ECB4-4CA3-B045-1DFA50104289 (cV = JnDsVvBMREi17cE4.1.0.1.0.0)\r\n    2022/08/12 21:19:28.6075622 13348 4836  ComApi          * END *   Search ClientId = Update;ScanForUpdates, Updates found = 0, ServiceId = 855E8A7C-ECB4-4CA3-B045-1DFA50104289 (cV = JnDsVvBMREi17cE4.1.0.1.0.0)\r\n    2022/08/12 21:19:28.6077885 13348 13736 ComApi          * END *   All federated searches have completed. Jobs = 1, Succeeded = 1, ClientId = Update;ScanForUpdates (cV = JnDsVvBMREi17cE4.1.0.1.1)\r\n    2022/08/12 21:19:28.6137352 13348 4628  ComApi          * START *   Federated Search ClientId = Update;ScanForUpdates (cV: N+NC/IIFmEa2s+Zw.1.0.1.0)\r\n    2022/08/12 21:19:28.6145364 4912  13188 IdleTimer       WU operation (SR.Update;ScanForUpdates ID 7) started; operation # 33; does use network; is not at background priority\r\n    2022/08/12 21:19:28.6268789 4912  12840 SLS             Get response for service 855E8A7C-ECB4-4CA3-B045-1DFA50104289 - forceExpire[False] asyncRefreshOnExpiry[False]\r\n    2022/08/12 21:19:28.6268843 4912  12840 SLS             path used for cache lookup: /SLS/{855E8A7C-ECB4-4CA3-B045-1DFA50104289}/x64/10.0.19044.1889/0?CH=532&L=en-GB&P=&PT=0x30&WUA=10.0.19041.1865&MK=LENOVO&MD=23539WU\r\n    2022/08/12 21:19:28.6275692 4912  12840 IdleTimer       WU operation (SR.Update;ScanForUpdates ID 7, operation # 33) stopped; does use network; is not at background priority\r\n    2022/08/12 21:19:28.6382955 13348 14100 ComApi          Federated Search: Starting search against 1 service(s) (cV = N+NC/IIFmEa2s+Zw.1.0.1.0)\r\n    2022/08/12 21:19:28.6384474 13348 14100 ComApi          * START *   Search ClientId = Update;ScanForUpdates, ServiceId = 855E8A7C-ECB4-4CA3-B045-1DFA50104289, Flags: 0X8000000 (cV = N+NC/IIFmEa2s+Zw.1.0.1.0.0)\r\n    2022/08/12 21:19:28.6398495 4912  13188 IdleTimer       WU operation (CSearchCall::Init ID 8) started; operation # 36; does not use network; is at background priority\r\n    2022/08/12 21:19:28.6494807 4912  13188 Agent           * START * Queueing Finding updates [CallerId = Update;ScanForUpdates  Id = 8]\r\n    2022/08/12 21:19:28.6494871 4912  13188 Agent           Service 855E8A7C-ECB4-4CA3-B045-1DFA50104289 is not in sequential scan list\r\n    2022/08/12 21:19:28.6496251 4912  13884 Agent           Service 855E8A7C-ECB4-4CA3-B045-1DFA50104289 is not in sequential scan list\r\n    2022/08/12 21:19:28.6501479 4912  7988  Agent           * END * Queueing Finding updates [CallerId = Update;ScanForUpdates  Id = 8]\r\n    2022/08/12 21:19:28.6504905 4912  7988  Agent           * START * Finding updates CallerId = Update;ScanForUpdates  Id = 8 (cV = N+NC/IIFmEa2s+Zw.1.0.1.0.0.1)\r\n    2022/08/12 21:19:28.6504942 4912  7988  Agent           Online = No; Interactive = No; AllowCachedResults = No; Ignore download priority = No\r\n    2022/08/12 21:19:28.6504960 4912  7988  Agent           Criteria = IsInstalled=0 AND AppCategoryIDs contains '5c353b9c-7ac7-4d27-af07-923e7d9aa2e2'\"\"\r\n    2022/08/12 21:19:28.6504995 4912  7988  Agent           ServiceID = {855E8A7C-ECB4-4CA3-B045-1DFA50104289} Third party service\r\n    2022/08/12 21:19:28.6505008 4912  7988  Agent           Search Scope = {Machine & All Users}\r\n    2022/08/12 21:19:28.6505043 4912  7988  Agent           Caller SID for Applicability: S-1-5-18\r\n    2022/08/12 21:19:28.8911277 4912  7988  SLS             Get response for service 855E8A7C-ECB4-4CA3-B045-1DFA50104289 - forceExpire[False] asyncRefreshOnExpiry[False]\r\n    2022/08/12 21:19:28.8911359 4912  7988  SLS             path used for cache lookup: /SLS/{855E8A7C-ECB4-4CA3-B045-1DFA50104289}/x64/10.0.19044.1889/0?CH=532&L=en-GB&P=&PT=0x30&WUA=10.0.19041.1865&MK=LENOVO&MD=23539WU\r\n    2022/08/12 21:19:29.0803254 4912  7988  Agent           Found 0 updates and 3 categories in search; evaluated appl. rules of 8 out of 11 deployed entities\r\n    2022/08/12 21:19:29.0825343 4912  7988  Agent           * END * Finding updates CallerId = Update;ScanForUpdates, Id = 8, Exit code = 0x00000000 (cV = N+NC/IIFmEa2s+Zw.1.0.1.0.0.1)\r\n    2022/08/12 21:19:29.0884850 4912  7988  IdleTimer       WU operation (CSearchCall::Init ID 8, operation # 36) stopped; does not use network; is at background priority\r\n    2022/08/12 21:19:29.0915402 13348 4836  ComApi          *RESUMED*   Search ClientId = Update;ScanForUpdates, ServiceId = 855E8A7C-ECB4-4CA3-B045-1DFA50104289 (cV = N+NC/IIFmEa2s+Zw.1.0.1.0.0)\r\n    2022/08/12 21:19:29.0919989 13348 4836  ComApi          * END *   Search ClientId = Update;ScanForUpdates, Updates found = 0, ServiceId = 855E8A7C-ECB4-4CA3-B045-1DFA50104289 (cV = N+NC/IIFmEa2s+Zw.1.0.1.0.0)\r\n    2022/08/12 21:19:29.0922270 13348 14100 ComApi          * END *   All federated searches have completed. Jobs = 1, Succeeded = 1, ClientId = Update;ScanForUpdates (cV = N+NC/IIFmEa2s+Zw.1.0.1.1)\r\n    2022/08/12 21:19:29.0997229 13348 4628  ComApi          * START *   Federated Search ClientId = Update;ScanForUpdatesForUser (cV: dniDzGiJp0yYBl5G.1.0.1.0)\r\n    2022/08/12 21:19:29.1008217 4912  13188 IdleTimer       WU operation (SR.Update;ScanForUpdatesForUser ID 9) started; operation # 43; does use network; is not at background priority\r\n    2022/08/12 21:19:29.1135003 4912  12840 SLS             Get response for service 855E8A7C-ECB4-4CA3-B045-1DFA50104289 - forceExpire[False] asyncRefreshOnExpiry[True]\r\n    2022/08/12 21:19:29.1135057 4912  12840 SLS             path used for cache lookup: /SLS/{855E8A7C-ECB4-4CA3-B045-1DFA50104289}/x64/10.0.19044.1889/0?CH=532&L=en-GB&P=&PT=0x30&WUA=10.0.19041.1865&MK=LENOVO&MD=23539WU\r\n    2022/08/12 21:19:29.1145173 4912  12840 IdleTimer       WU operation (SR.Update;ScanForUpdatesForUser ID 9, operation # 43) stopped; does use network; is not at background priority\r\n    2022/08/12 21:19:29.1251691 13348 11068 ComApi          Federated Search: Starting search against 1 service(s) (cV = dniDzGiJp0yYBl5G.1.0.1.0)\r\n    2022/08/12 21:19:29.1253738 13348 11068 ComApi          * START *   Search ClientId = Update;ScanForUpdatesForUser, ServiceId = 855E8A7C-ECB4-4CA3-B045-1DFA50104289, Flags: 0X8000000 (cV = dniDzGiJp0yYBl5G.1.0.1.0.0)\r\n    2022/08/12 21:19:29.1275221 4912  13188 IdleTimer       WU operation (CSearchCall::Init ID 10) started; operation # 46; does not use network; is at background priority\r\n    2022/08/12 21:19:29.1380927 4912  13188 Agent           * START * Queueing Finding updates [CallerId = Update;ScanForUpdatesForUser  Id = 10]\r\n    2022/08/12 21:19:29.1381054 4912  13188 Agent           Service 855E8A7C-ECB4-4CA3-B045-1DFA50104289 is not in sequential scan list\r\n    2022/08/12 21:19:29.1382692 4912  13884 Agent           Service 855E8A7C-ECB4-4CA3-B045-1DFA50104289 is not in sequential scan list\r\n    2022/08/12 21:19:29.1392112 4912  4152  Agent           * END * Queueing Finding updates [CallerId = Update;ScanForUpdatesForUser  Id = 10]\r\n    2022/08/12 21:19:29.1398728 4912  4152  Agent           * START * Finding updates CallerId = Update;ScanForUpdatesForUser  Id = 10 (cV = dniDzGiJp0yYBl5G.1.0.1.0.0.1)\r\n    2022/08/12 21:19:29.1398767 4912  4152  Agent           Online = No; Interactive = No; AllowCachedResults = No; Ignore download priority = No\r\n    2022/08/12 21:19:29.1398802 4912  4152  Agent           Criteria = IsInstalled=0 AND AppCategoryIDs contains 'd63c16b5-90e0-4df5-83ae-8ca6f53997d5'\"\"\r\n    2022/08/12 21:19:29.1398861 4912  4152  Agent           ServiceID = {855E8A7C-ECB4-4CA3-B045-1DFA50104289} Third party service\r\n    2022/08/12 21:19:29.1398880 4912  4152  Agent           Search Scope = {Current User}\r\n    2022/08/12 21:19:29.1398929 4912  4152  Agent           Caller SID for Applicability: S-1-5-21-452354464-1319117197-3974845786-1006\r\n    2022/08/12 21:19:29.3511628 4912  4152  SLS             Get response for service 855E8A7C-ECB4-4CA3-B045-1DFA50104289 - forceExpire[False] asyncRefreshOnExpiry[False]\r\n    2022/08/12 21:19:29.3511685 4912  4152  SLS             path used for cache lookup: /SLS/{855E8A7C-ECB4-4CA3-B045-1DFA50104289}/x64/10.0.19044.1889/0?CH=532&L=en-GB&P=&PT=0x30&WUA=10.0.19041.1865&MK=LENOVO&MD=23539WU\r\n    2022/08/12 21:19:29.7863645 4912  4152  Agent           Added update 330B1FF8-C46A-4A44-96C2-BEB32B1D69FE.1 to search result\r\n    2022/08/12 21:19:29.7863732 4912  4152  Agent           Added update 17F0F05B-F9AE-4208-9ACC-6C2A5C816852.1 to search result\r\n    2022/08/12 21:19:29.7863803 4912  4152  Agent           Added update A69B11CA-3BDD-483E-AD8D-6F5AA54A36C0.1 to search result\r\n    2022/08/12 21:19:29.7863875 4912  4152  Agent           Added update FFAD346F-D93B-4276-A421-A2213EF70B71.1 to search result\r\n    2022/08/12 21:19:29.7863945 4912  4152  Agent           Removing unreferenced framework update {FFAD346F-D93B-4276-A421-A2213EF70B71}.1 from search result.\r\n    2022/08/12 21:19:29.7864056 4912  4152  Agent           Removing unreferenced framework update {A69B11CA-3BDD-483E-AD8D-6F5AA54A36C0}.1 from search result.\r\n    2022/08/12 21:19:29.7864136 4912  4152  Agent           Removing unreferenced framework update {17F0F05B-F9AE-4208-9ACC-6C2A5C816852}.1 from search result.\r\n    2022/08/12 21:19:29.7864210 4912  4152  Agent           Removing unreferenced framework update {330B1FF8-C46A-4A44-96C2-BEB32B1D69FE}.1 from search result.\r\n    2022/08/12 21:19:29.7864384 4912  4152  Agent           Found 0 updates and 3 categories in search; evaluated appl. rules of 54 out of 90 deployed entities\r\n    2022/08/12 21:19:29.7883660 4912  4152  Agent           * END * Finding updates CallerId = Update;ScanForUpdatesForUser, Id = 10, Exit code = 0x00000000 (cV = dniDzGiJp0yYBl5G.1.0.1.0.0.1)\r\n    2022/08/12 21:19:29.7914023 4912  4152  IdleTimer       WU operation (CSearchCall::Init ID 10, operation # 46) stopped; does not use network; is at background priority\r\n    2022/08/12 21:19:29.7968624 13348 4048  ComApi          *RESUMED*   Search ClientId = Update;ScanForUpdatesForUser, ServiceId = 855E8A7C-ECB4-4CA3-B045-1DFA50104289 (cV = dniDzGiJp0yYBl5G.1.0.1.0.0)\r\n    2022/08/12 21:19:29.7975052 13348 4048  ComApi          * END *   Search ClientId = Update;ScanForUpdatesForUser, Updates found = 0, ServiceId = 855E8A7C-ECB4-4CA3-B045-1DFA50104289 (cV = dniDzGiJp0yYBl5G.1.0.1.0.0)\r\n    2022/08/12 21:19:29.7977108 13348 11068 ComApi          * END *   All federated searches have completed. Jobs = 1, Succeeded = 1, ClientId = Update;ScanForUpdatesForUser (cV = dniDzGiJp0yYBl5G.1.0.1.1)\r\n    2022/08/12 21:19:29.8034768 13348 4628  ComApi          * START *   Federated Search ClientId = Update;ScanForUpdates (cV: N+NC/IIFmEa2s+Zw.1.0.1.0)\r\n    2022/08/12 21:19:29.8042214 4912  13188 IdleTimer       WU operation (SR.Update;ScanForUpdates ID 11) started; operation # 53; does use network; is not at background priority\r\n    2022/08/12 21:19:29.8145702 4912  12840 SLS             Get response for service 855E8A7C-ECB4-4CA3-B045-1DFA50104289 - forceExpire[False] asyncRefreshOnExpiry[False]\r\n    2022/08/12 21:19:29.8145758 4912  12840 SLS             path used for cache lookup: /SLS/{855E8A7C-ECB4-4CA3-B045-1DFA50104289}/x64/10.0.19044.1889/0?CH=532&L=en-GB&P=&PT=0x30&WUA=10.0.19041.1865&MK=LENOVO&MD=23539WU\r\n    2022/08/12 21:19:29.8154821 4912  12840 IdleTimer       WU operation (SR.Update;ScanForUpdates ID 11, operation # 53) stopped; does use network; is not at background priority\r\n    2022/08/12 21:19:29.8282113 13348 3520  ComApi          Federated Search: Starting search against 1 service(s) (cV = N+NC/IIFmEa2s+Zw.1.0.1.0)\r\n    2022/08/12 21:19:29.8283877 13348 3520  ComApi          * START *   Search ClientId = Update;ScanForUpdates, ServiceId = 855E8A7C-ECB4-4CA3-B045-1DFA50104289, Flags: 0X8000000 (cV = N+NC/IIFmEa2s+Zw.1.0.1.0.0)\r\n    2022/08/12 21:19:29.8298756 4912  13188 IdleTimer       WU operation (CSearchCall::Init ID 12) started; operation # 56; does not use network; is at background priority\r\n    2022/08/12 21:19:29.8387576 4912  13188 Agent           * START * Queueing Finding updates [CallerId = Update;ScanForUpdates  Id = 12]\r\n    2022/08/12 21:19:29.8387642 4912  13188 Agent           Service 855E8A7C-ECB4-4CA3-B045-1DFA50104289 is not in sequential scan list\r\n    2022/08/12 21:19:29.8388932 4912  13884 Agent           Service 855E8A7C-ECB4-4CA3-B045-1DFA50104289 is not in sequential scan list\r\n    2022/08/12 21:19:29.8394109 4912  11340 Agent           * END * Queueing Finding updates [CallerId = Update;ScanForUpdates  Id = 12]\r\n    2022/08/12 21:19:29.8397355 4912  11340 Agent           * START * Finding updates CallerId = Update;ScanForUpdates  Id = 12 (cV = N+NC/IIFmEa2s+Zw.1.0.1.0.0.1)\r\n    2022/08/12 21:19:29.8397375 4912  11340 Agent           Online = No; Interactive = No; AllowCachedResults = No; Ignore download priority = No\r\n    2022/08/12 21:19:29.8397385 4912  11340 Agent           Criteria = IsInstalled=0 AND AppCategoryIDs contains '733893b8-533d-4292-bf27-23d218b39a95'\"\"\r\n    2022/08/12 21:19:29.8397408 4912  11340 Agent           ServiceID = {855E8A7C-ECB4-4CA3-B045-1DFA50104289} Third party service\r\n    2022/08/12 21:19:29.8397417 4912  11340 Agent           Search Scope = {Machine & All Users}\r\n    2022/08/12 21:19:29.8397438 4912  11340 Agent           Caller SID for Applicability: S-1-5-18\r\n    2022/08/12 21:19:30.0204544 4912  11340 SLS             Get response for service 855E8A7C-ECB4-4CA3-B045-1DFA50104289 - forceExpire[False] asyncRefreshOnExpiry[False]\r\n    2022/08/12 21:19:30.0204660 4912  11340 SLS             path used for cache lookup: /SLS/{855E8A7C-ECB4-4CA3-B045-1DFA50104289}/x64/10.0.19044.1889/0?CH=532&L=en-GB&P=&PT=0x30&WUA=10.0.19041.1865&MK=LENOVO&MD=23539WU\r\n    2022/08/12 21:19:30.6546318 4912  11340 Agent           Added update 6BD0DC6A-F25C-4F5A-86B8-C2E8FBB3D22A.1 to search result\r\n    2022/08/12 21:19:30.6546440 4912  11340 Agent           Added update 41A84959-CDFB-44D6-BEE3-F11CF65A95C7.1 to search result\r\n    2022/08/12 21:19:30.6546514 4912  11340 Agent           Added update A69B11CA-3BDD-483E-AD8D-6F5AA54A36C0.1 to search result\r\n    2022/08/12 21:19:30.6546581 4912  11340 Agent           Added update 43A24855-45D6-4AFA-843E-92A505E6F9A4.1 to search result\r\n    2022/08/12 21:19:30.6546650 4912  11340 Agent           Removing unreferenced framework update {43A24855-45D6-4AFA-843E-92A505E6F9A4}.1 from search result.\r\n    2022/08/12 21:19:30.6546739 4912  11340 Agent           Removing unreferenced framework update {A69B11CA-3BDD-483E-AD8D-6F5AA54A36C0}.1 from search result.\r\n    2022/08/12 21:19:30.6546815 4912  11340 Agent           Removing unreferenced framework update {41A84959-CDFB-44D6-BEE3-F11CF65A95C7}.1 from search result.\r\n    2022/08/12 21:19:30.6546890 4912  11340 Agent           Removing unreferenced framework update {6BD0DC6A-F25C-4F5A-86B8-C2E8FBB3D22A}.1 from search result.\r\n    2022/08/12 21:19:30.6547077 4912  11340 Agent           Found 0 updates and 3 categories in search; evaluated appl. rules of 64 out of 104 deployed entities\r\n    2022/08/12 21:19:30.6564393 4912  11340 Agent           * END * Finding updates CallerId = Update;ScanForUpdates, Id = 12, Exit code = 0x00000000 (cV = N+NC/IIFmEa2s+Zw.1.0.1.0.0.1)\r\n    2022/08/12 21:19:30.6608765 4912  11340 IdleTimer       WU operation (CSearchCall::Init ID 12, operation # 56) stopped; does not use network; is at background priority\r\n    2022/08/12 21:19:30.6683298 13348 4048  ComApi          *RESUMED*   Search ClientId = Update;ScanForUpdates, ServiceId = 855E8A7C-ECB4-4CA3-B045-1DFA50104289 (cV = N+NC/IIFmEa2s+Zw.1.0.1.0.0)\r\n    2022/08/12 21:19:30.6688250 13348 4048  ComApi          * END *   Search ClientId = Update;ScanForUpdates, Updates found = 0, ServiceId = 855E8A7C-ECB4-4CA3-B045-1DFA50104289 (cV = N+NC/IIFmEa2s+Zw.1.0.1.0.0)\r\n    2022/08/12 21:19:30.6690543 13348 3520  ComApi          * END *   All federated searches have completed. Jobs = 1, Succeeded = 1, ClientId = Update;ScanForUpdates (cV = N+NC/IIFmEa2s+Zw.1.0.1.1)\r\n    2022/08/12 21:19:30.6747922 13348 4628  ComApi          * START *   Federated Search ClientId = Update;ScanForUpdates (cV: kmcJqMxQjUmO1et2.1.0.1.0)\r\n    2022/08/12 21:19:30.6755178 4912  13188 IdleTimer       WU operation (SR.Update;ScanForUpdates ID 13) started; operation # 63; does use network; is not at background priority\r\n    2022/08/12 21:19:30.6860673 4912  12840 SLS             Get response for service 855E8A7C-ECB4-4CA3-B045-1DFA50104289 - forceExpire[False] asyncRefreshOnExpiry[False]\r\n    2022/08/12 21:19:30.6860729 4912  12840 SLS             path used for cache lookup: /SLS/{855E8A7C-ECB4-4CA3-B045-1DFA50104289}/x64/10.0.19044.1889/0?CH=532&L=en-GB&P=&PT=0x30&WUA=10.0.19041.1865&MK=LENOVO&MD=23539WU\r\n    2022/08/12 21:19:30.6868293 4912  12840 IdleTimer       WU operation (SR.Update;ScanForUpdates ID 13, operation # 63) stopped; does use network; is not at background priority\r\n    2022/08/12 21:19:30.6997652 13348 10828 ComApi          Federated Search: Starting search against 1 service(s) (cV = kmcJqMxQjUmO1et2.1.0.1.0)\r\n    2022/08/12 21:19:30.6998923 13348 10828 ComApi          * START *   Search ClientId = Update;ScanForUpdates, ServiceId = 855E8A7C-ECB4-4CA3-B045-1DFA50104289, Flags: 0X8000000 (cV = kmcJqMxQjUmO1et2.1.0.1.0.0)\r\n    2022/08/12 21:19:30.7011164 4912  13188 IdleTimer       WU operation (CSearchCall::Init ID 14) started; operation # 66; does not use network; is at background priority\r\n    2022/08/12 21:19:30.7100817 4912  13188 Agent           * START * Queueing Finding updates [CallerId = Update;ScanForUpdates  Id = 14]\r\n    2022/08/12 21:19:30.7100885 4912  13188 Agent           Service 855E8A7C-ECB4-4CA3-B045-1DFA50104289 is not in sequential scan list\r\n    2022/08/12 21:19:30.7102133 4912  13884 Agent           Service 855E8A7C-ECB4-4CA3-B045-1DFA50104289 is not in sequential scan list\r\n    2022/08/12 21:19:30.7107186 4912  11052 Agent           * END * Queueing Finding updates [CallerId = Update;ScanForUpdates  Id = 14]\r\n    2022/08/12 21:19:30.7110433 4912  11052 Agent           * START * Finding updates CallerId = Update;ScanForUpdates  Id = 14 (cV = kmcJqMxQjUmO1et2.1.0.1.0.0.1)\r\n    2022/08/12 21:19:30.7110453 4912  11052 Agent           Online = No; Interactive = No; AllowCachedResults = No; Ignore download priority = No\r\n    2022/08/12 21:19:30.7110464 4912  11052 Agent           Criteria = IsInstalled=0 AND AppCategoryIDs contains 'f4ccc4c1-6e9a-49a0-8f19-46f1717c7ba3'\"\"\r\n    2022/08/12 21:19:30.7110487 4912  11052 Agent           ServiceID = {855E8A7C-ECB4-4CA3-B045-1DFA50104289} Third party service\r\n    2022/08/12 21:19:30.7110495 4912  11052 Agent           Search Scope = {Machine & All Users}\r\n    2022/08/12 21:19:30.7110518 4912  11052 Agent           Caller SID for Applicability: S-1-5-18\r\n    2022/08/12 21:19:30.8971984 4912  11052 SLS             Get response for service 855E8A7C-ECB4-4CA3-B045-1DFA50104289 - forceExpire[False] asyncRefreshOnExpiry[False]\r\n    2022/08/12 21:19:30.8972043 4912  11052 SLS             path used for cache lookup: /SLS/{855E8A7C-ECB4-4CA3-B045-1DFA50104289}/x64/10.0.19044.1889/0?CH=532&L=en-GB&P=&PT=0x30&WUA=10.0.19041.1865&MK=LENOVO&MD=23539WU\r\n    2022/08/12 21:19:31.0479102 4912  11052 Agent           Found 0 updates and 3 categories in search; evaluated appl. rules of 11 out of 14 deployed entities\r\n```\r\n</details>\r\n\r\n\r\n### Visuals\r\n\r\n_No response_",
  "closed_at": null,
  "comments": [
    {
      "author": "jhoneill",
      "author_association": "NONE",
      "body": "All 3 of the above appear to work as expected in both Windows Terminal and the legacy host for me \r\n<img width=\"833\" alt=\"image\" src=\"https://user-images.githubusercontent.com/16209593/184450643-e7cc2b3e-0b0d-4a74-954d-17427ccd4d3e.png\">\r\n\r\nBut if I change the output rendering it turns the colours off \r\n<img width=\"822\" alt=\"image\" src=\"https://user-images.githubusercontent.com/16209593/184451412-a944e32f-1e4d-4bf5-9fb3-7cbe9cf74724.png\">\r\n\r\n\r\nare you setting that or using a different host ? \r\n\r\n",
      "created_at": "2022-08-12T22:14:26Z",
      "updated_at": "2022-08-12T22:14:26Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "/cc @SteveL-MSFT for information.",
      "created_at": "2022-08-13T19:26:26Z",
      "updated_at": "2022-08-13T19:26:26Z"
    },
    {
      "author": "harriott",
      "author_association": "NONE",
      "body": "@jhoneill, yes, if I set `$PSStyle.OutputRendering = 'PlainText'`, it turns off my default colouring, but then, in that state, if I `$host.UI.RawUI.ForegroundColor = \"DarkGreen\"`, all output is DarkGreen - did you actually test the latter having set the former? In any case, with the default setting of `$PSStyle.OutputRendering = 'Host'`, I still have the bug that I reported, still no clue why.",
      "created_at": "2022-08-15T13:12:43Z",
      "updated_at": "2022-08-15T13:12:43Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@harriott this also seems to be working fine for me in 7.2.6:\r\n\r\n![image](https://user-images.githubusercontent.com/11859881/184691442-c1e0473d-259b-4ba3-b650-a303b4905ca0.png)\r\n\r\nLooks like GitHub upload of image not working, but it seems to be working for me.  Errors not using `$host.privatedata.ErrorForegroundColor` for ConciseView is by-design.  If you use one of the legacy error views, a bug was fixed to respect privatedata.",
      "created_at": "2022-08-15T16:36:06Z",
      "updated_at": "2022-08-15T18:12:55Z"
    },
    {
      "author": "harriott",
      "author_association": "NONE",
      "body": "(@SteveL-MSFT unfortunately your image won't display in Edge, Firefox, or Google Chrome.)\r\n\r\n`PowerShell -NoProfile` reveals that all is well here, so my glitches are caused by something in my `PSProfile.ps1`. My apologies.",
      "created_at": "2022-08-15T20:53:56Z",
      "updated_at": "2022-08-15T20:53:56Z"
    },
    {
      "author": "dkaszews",
      "author_association": "CONTRIBUTOR",
      "body": "I can see some really weird results: the only setting that works is `ErrorForegroundColor`. `ErrorBackgroundColor` is ignored, as are colors of `Warning`, `Verbose` and `Debug`. This is quite annoying on white background, as the default light yellow is not very visible.\r\n\r\nTested on latest master, without profile. My machine is Raspberry Pi 4B running Ubuntu 22.04, ARM 64-bit.\r\n\r\n![image](https://user-images.githubusercontent.com/26599495/184878308-dbb744cc-b05f-4cde-aeef-d6cb95b9ced8.png)\r\n",
      "created_at": "2022-08-16T12:30:42Z",
      "updated_at": "2022-08-16T12:30:42Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "> Errors not using `$host.privatedata.ErrorForegroundColor` for ConciseView is by-design.\r\n\r\n@SteveL-MSFT Can you please clarify this some more? The behavior I observed on 7.2.6 is the opposite -- the `ConciseView` error does use `$host.privatedata.ErrorForegroundColor`:\r\n\r\n![image](https://user-images.githubusercontent.com/127450/185474778-b84b1ca5-f11b-463b-abbc-3846e3747e84.png)\r\n\r\n-----\r\n\r\n[The doc says about `$PSStyle.Formatting`](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_ansi_terminals#:~:text=FromRgb(0xf5f5dc)-,%24PSStyle.,It%20replaces%20%24Host.):\r\n> It replaces $Host.PrivateData as the way to manage colors for formatting rendering.\r\n\r\nSo, it sounds to me the formatting color definitions in `$Host.PrivateData` should not be used anymore as long as VT is supported by the host. Is that not the case?",
      "created_at": "2022-08-18T19:24:12Z",
      "updated_at": "2022-08-18T19:29:59Z"
    },
    {
      "author": "dkaszews",
      "author_association": "CONTRIBUTOR",
      "body": "Can confirm setting `$PSStyle.Formatting` does work. So why do we have three separate settings for colors? There is `(Get-PSReadLineOptions).Colors` which controls syntax highlight, `$PSStyle.Formatting` which controls messages and `$Host.PrivateData` which apparently does nothing. Why not just put everything in a single place?\r\n\r\nAt minimum, the settings which are deprecated should have a warning when setting them. ",
      "created_at": "2022-08-19T14:06:56Z",
      "updated_at": "2022-08-19T14:06:56Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "PSReadLine is a separate module, so we can leave that aside.\r\n\r\nBetween `$PSStyle.Formatting` and `$Host.Private`, my understanding based on the documentation is that it's a replacement of `$Host.PrivateData`, however, the behavior in 7.3-preview.7 is that:\r\n1. `$Host.PrivateData.ErrorForegroundColor` controls the color used in error formatting, while `$PSStyle.Formatting.Error` does nothing.\r\n2. Color settings regarding `debug`, `verbose`, and `warning` in `$Host.PrivateData` do nothing, while `$PSStyle.Formatting.Debug/Verbose/Warning` controls the color used in Debug/Verbose/Warning formatting.\r\n3. `$Host.PrivateData.ProgressXXXColor` does nothing, while `$PSStyle.Progress.Style` controls the color used in progress formatting.\r\n\r\nIt looks to me the formatting color settings are scattered around. They should all be in `$PSStyle.Formatting` as described in the documentation.",
      "created_at": "2022-08-19T16:52:04Z",
      "updated_at": "2022-08-19T16:52:37Z"
    },
    {
      "author": "dkaszews",
      "author_association": "CONTRIBUTOR",
      "body": "@daxian-dbw Agreed that moving `$Host.PrivateData` into `$PSStyle.Formatting` makes most sense, especially since `$Host.PrivateData` is the only setting to use separate color enums for foreground and background, while everything else uses ANSI escapes which allow additional effects.\r\n\r\nIn my screenshot you can see the `Write-Error` produces messages with prefix `Write-Error:`, while `Write-Warning/Verbose/Debug` has prefixes `WARNING/VERBOSE/DEBUG: `, is that a hint to them being implemented in different places and why they use different settings? It would be nice to unify it, but I am afraid it could be a breaking change for someone who redirects everything into single stream, then greps for specific markers. ",
      "created_at": "2022-08-19T17:49:41Z",
      "updated_at": "2022-08-19T17:49:41Z"
    },
    {
      "author": "jhoneill",
      "author_association": "NONE",
      "body": "> PSReadLine is a separate module, so we can leave that aside.\r\n> \r\n> Between `$PSStyle.Formatting` and `$Host.Private`, my understanding based on the documentation is that it's a replacement of `$Host.PrivateData`, however, the behavior in 7.3-preview.7 is that:\r\n> \r\n> 1. `$Host.PrivateData.ErrorForegroundColor` controls the color used in error formatting, while `$PSStyle.Formatting.Error` does nothing.\r\n\r\nThis  appears to be correct \r\n<img width=\"469\" alt=\"image\" src=\"https://user-images.githubusercontent.com/16209593/185746905-b62d32c7-1f4a-47aa-af55-7c6d6d11b200.png\">\r\n\r\nIt seems that  \r\n- `Host` settings \"beat\" `$pstyle`  ones for **error**\r\n- Of the 4 `ErrorView` settings only `ConciseView` resets the format at the end. **This looks like a bug** in the other error views \r\n- Also it seems when Windows PowerShell introduced `errorview` it started writing errors **twice in transcript files** \r\n- Writing to error via the method in `host.ui` writes text with no formatting (@dkaszews the text \"Write-error\" seems to be inserted differently.).   This makes sense as there may be multiple formats depending on the view. \r\n\r\n> 2. Color settings regarding `debug`, `verbose`, and `warning` in `$Host.PrivateData` do nothing, while `$PSStyle.Formatting.Debug/Verbose/Warning` controls the color used in Debug/Verbose/Warning formatting.\r\n\r\nYes  \r\n<img width=\"448\" alt=\"image\" src=\"https://user-images.githubusercontent.com/16209593/185747176-3e18953c-b7a0-4966-894d-bab5303f1f31.png\">\r\n\r\nIt seems that  \r\n- `$pstyle`  settings \"beat\" `Host` ones for **verbose , warning and debug** - it is also possible to specify (e.g.) underline as part of these formats. \r\n- Writing to verbose / warning / debug via the method in `host.ui` writes formatted text with a prefix   \r\n- Style is reset after a verbose message is sent  - see below \r\n\r\n<img width=\"395\" alt=\"image\" src=\"https://user-images.githubusercontent.com/16209593/185747404-17b4c251-4b9d-43be-93f6-6cf6a71a204e.png\">\r\n\r\n> 3. $Host.PrivateData.ProgressXXXColor does nothing, while $PSStyle.Progress.Style controls the color used in progress formatting.\r\n\r\n`$Host` controls it if the `classic` view is selected, `$pstyle` controls it if `compact` is selected.  (Oddly, the host settings don't seem to work on 5.1)    \r\n\r\n> It looks to me the formatting color settings are scattered around. They should all be in `$PSStyle.Formatting` as described in the documentation.\r\n\r\n**YES**  \r\nI think the _unformatted_ foreground and background are logically part of the host, that's where we find other things about the state of the console. \r\nWhere it is a question of applying formatting, it should be in `$psStyle`\r\n\r\n **However,** \r\n In an ideal world, changing the setting via Host would propagate a change to $psstyle, otherwise it breaks compatibility \r\n`$PSstyle.Progress.style = <whatever>` will fail on Windows PowerShell. `$host`. changes run in 7.3 but do nothing. \r\nHaving `If version ... ` code is ugly, and ideally we'd want old code to work without modification.  \r\n \r\nGetting it right and compatible is the challenge, I think\r\n ",
      "created_at": "2022-08-20T14:49:40Z",
      "updated_at": "2022-08-20T14:49:40Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "My expectation is that `$PSStyle.Formatting` controls the coloring in ConsoleHost and if that's not the case, that's a bug.  `PrivateData` should have been private (hence the name) although it was widely adopted since there wasn't another option.  I think what the WG-Interactive-Console group should decide is what to do about PSStyle vs PrivateData.",
      "created_at": "2022-08-22T22:53:12Z",
      "updated_at": "2022-08-22T22:53:12Z"
    },
    {
      "author": "theJasonHelmick",
      "author_association": "CONTRIBUTOR",
      "body": "The WG has reviewed this issue and recommends the following:\r\n\r\nShort term for 7.3 (consider back port to 7.2)\r\n\r\n- Fix: Error record should use $PSStyle instead of $host.\r\n- Fix: PSStyle variable is currently removable.\r\n\r\nLong term the WG recommends reviewing the object model of `$PSStyle` for future features and considerations.\r\n- We believe backwards compatibility can be maintained by using ETS to elevate any relocated properties\r\n- We recommend that Progress, `$ErrorView`, `$Host.PrivateData` be included in the object model.\r\n- Warnings should be added to the setter in the `$Host.PrivateData` code.  This warning should link to the docs that explains `$PSStyle`.\r\n  - The setter should be marked obsolete \r\n- A PSSA rule should be considered\r\n\r\nRelated: #17917",
      "created_at": "2022-08-26T22:33:30Z",
      "updated_at": "2022-08-29T17:34:15Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "> Fix: PSStyle variable is currently removable.\r\n\r\n@SteveL-MSFT, about this one, did you have that variable removable intentionally? If that was intentional, I found the formatting decoration to table headers is still applied after removing `$PSStyle`, so it's inconsistent. It's probably better to have it a constant variable.",
      "created_at": "2022-08-26T23:12:24Z",
      "updated_at": "2022-08-26T23:12:24Z"
    },
    {
      "author": "jhoneill",
      "author_association": "NONE",
      "body": "LGTM in particular. \r\n\r\n> * We believe backwards compatibility can be maintained by using ETS to elevate any relocated properties\r\n\r\nThat would address my main worry \r\n\r\nWarnings on set would meant scripts written to work on both Windows PowerShell and PowerShell core would get a message that it isn't optimized for 7 but wouldn't drown in those messages (which might be the case if there were messages on get). So that seems like the ideal way to go. \r\n\r\n  ",
      "created_at": "2022-08-27T10:59:17Z",
      "updated_at": "2022-08-27T10:59:17Z"
    },
    {
      "author": "simonsabin",
      "author_association": "NONE",
      "body": "What defines the color used when pwsh is run and the -command has errors. I'm trying to get pure plaintext output when pwsh is run but can't use $psstyle because that only works if the code runs. ",
      "created_at": "2022-09-07T15:41:58Z",
      "updated_at": "2022-09-07T15:41:58Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@simonsabin see https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_ansi_terminals?view=powershell-7.2#disabling-ansi-output\n\n<blockquote><img src=\"https://docs.microsoft.com/media/logos/logo-powershell-social.png\" width=\"48\" align=\"right\"><div><strong><a href=\"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_ansi_terminals\">about ANSI terminals - PowerShell</a></strong></div><div>Describes the features of PowerShell that use ANSI escape sequences and the terminal hosts that support them.</div></blockquote>",
      "created_at": "2022-09-12T20:32:27Z",
      "updated_at": "2022-09-12T20:32:30Z"
    },
    {
      "author": "simonsabin",
      "author_association": "NONE",
      "body": "Thanks @SteveL-MSFT , That wasn\u2019t working, realise I need to wait for #17987 to be released. \r\nWhy is $env:__SuppressAnsiEscapeSequences not documented? Seems way more obvious. And consistent across other tooling",
      "created_at": "2022-09-12T21:25:05Z",
      "updated_at": "2022-09-12T21:30:10Z"
    },
    {
      "author": "dkaszews",
      "author_association": "CONTRIBUTOR",
      "body": "Is this fixed by #17987 ? ",
      "created_at": "2022-09-13T05:12:25Z",
      "updated_at": "2022-09-13T05:12:25Z"
    },
    {
      "author": "simonsabin",
      "author_association": "NONE",
      "body": "@dkaszews On reviewing the test that was changed, it is formatting the output to plaintext, rather that checking that it is plaintext. I can't see in the code thats changed that error output is honoring the \"plaintext\" style, rather its looking at `$Host.UI.SupportsVirtualTerminal -and ([string]::IsNullOrEmpty($env:__SuppressAnsiEscapeSequences`\r\n",
      "created_at": "2022-09-13T10:06:40Z",
      "updated_at": "2022-09-13T10:06:40Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@dkaszews #17987 only addressed the short-term goal (target 7.3) listed in https://github.com/PowerShell/PowerShell/issues/17886#issuecomment-1229015174. The long-term goals are still to be addressed.",
      "created_at": "2022-09-13T16:34:23Z",
      "updated_at": "2022-09-13T16:34:23Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@simonsabin `$PSStyle.OutputRendering` applies to error output. Also, setting `NO_COLOR` env variable can also suppress the color in error output:\r\n\r\n![image](https://user-images.githubusercontent.com/127450/189959515-b164771a-5c2d-421a-ab4f-88ec79564eef.png)\r\n\r\n",
      "created_at": "2022-09-13T16:45:32Z",
      "updated_at": "2022-09-13T16:45:32Z"
    },
    {
      "author": "theJasonHelmick",
      "author_association": "CONTRIBUTOR",
      "body": "#17987 -- The fix in this will be back ported and shipped in 7.2.7",
      "created_at": "2022-10-12T20:16:47Z",
      "updated_at": "2022-10-12T20:16:47Z"
    }
  ],
  "created_at": "2022-08-12T19:39:37Z",
  "number": 17886,
  "state": "open",
  "title": "ForegroundColor methods no longer effective in PowerShell v7.2.6",
  "updated_at": "2022-10-12T20:16:47Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/3104",
  "author": "1RedOne",
  "body": "### PowerShell Version\r\n\r\n\r\n```\r\n\r\nName                           Value                                                                                                                                                                                            \r\n----                           -----                                                                                                                                                                                            \r\nPSVersion                      5.1.14986.1000                                                                                                                                                                                   \r\nPSEdition                      Desktop                                                                                                                                                                                          \r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}                                                                                                                                                                          \r\nBuildVersion                   10.0.14986.1000                                                                                                                                                                                  \r\nCLRVersion                     4.0.30319.42000                                                                                                                                                                                  \r\nWSManStackVersion              3.0                                                                                                                                                                                              \r\nPSRemotingProtocolVersion      2.3                                                                                                                                                                                              \r\nSerializationVersion           1.1.0.1                                                                                                                                                                                          \r\n\r\n```\r\n\r\n### OS Version\r\n\r\nWindows 10.0.14986 with newest PowerShell \r\n\r\n### Description\r\n\r\nAssume someone wants to confirm what will happen when removing a WSman listener, as seen here.\r\n```\r\n\r\nPS WSMan:\\localhost\\Listener> get-item .\\Listener_1084132640\\\r\n\r\n\r\n   WSManConfig: Microsoft.WSMan.Management\\WSMan::localhost\\Listener\r\n\r\nType            Keys                                Name\r\n----            ----                                ----\r\nContainer       {Transport=HTTP, Address=*}         Listener_1084132640\r\n```\r\n\r\nPowerShell has taught us that -WhatIfs are free but a Remove can cost you, so we then try to confirm we've got the right listener selected.\r\n\r\nVery strangely, we're prompted to see if we meant to append `-Recurse` to this command.  Being a newb user, we select `Y` to continue.\r\n\r\n```\r\nPS WSMan:\\localhost\\Listener> get-item .\\Listener_1084132640\\ | remove-item -WhatIf\r\n\r\nConfirm\r\nThe item at Microsoft.WSMan.Management\\WSMan::localhost\\Listener\\Listener_1084132640 has children and the Recurse\r\nparameter was not specified. If you continue, all children will be removed with the item. Are you sure you want to\r\ncontinue?\r\n[Y] Yes  [A] Yes to All  [N] No  [L] No to All  [S] Suspend  [?] Help (default is \"Y\"): y\r\n\r\n\r\n```\r\n\r\nThen I run `Get-ChildItem` again and... \r\n```\r\n\r\nPS WSMan:\\localhost\\Listener> dir\r\nPS WSMan:\\localhost\\Listener>\r\n```\r\n\r\noh no.  `-WhatIf` isn't recognized for this provider!  As we say down here in Georgia, that ain't no good.\r\n\r\n### Script/Steps for Reproduction\r\n\r\n* Switch to the unloved `WSMan:` provider\r\n* Try doing some `Remove-` commands and provide `-WhatIf`\r\n* Update your resume as you find that `-WhatIf` doesn't work with this provider for some reason",
  "closed_at": null,
  "comments": [],
  "created_at": "2017-02-06T21:02:06Z",
  "number": 3104,
  "state": "open",
  "title": "The -WhatIf common param doesn't work with Remove-Item in WSMan",
  "updated_at": "2021-11-29T17:55:41Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/17501",
  "author": "krzydoug",
  "body": "### Prerequisites\r\n\r\n- [X] Write a descriptive title.\r\n- [X] Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\r\n- [X] Search the existing issues.\r\n- [X] Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\r\n- [X] Refer to [Differences between Windows PowerShell 5.1 and PowerShell](https://docs.microsoft.com/powershell/scripting/whats-new/differences-from-windows-powershell).\r\n\r\n### Steps to reproduce\r\n\r\nI'm trying to split a registry path to get the name of the key or property. When that path contains sequential colon characters, Split-Path is incorrectly assuming it's a provider. This is true for both Path and LiteralPath parameters. It works fine if it's only one colon, but 2 or more encounter the bug. \r\n\r\n### Expected behavior\r\n\r\n```powershell\r\nPS> Split-Path -Path 'HKEY_CURRENT_USER\\software\\TightVNC\\Viewer\\History\\ComputerName::5901' -Leaf\r\n\r\nComputerName::5901\r\n```\r\n\r\n\r\n### Actual behavior\r\n\r\n```powershell\r\nPS> Split-Path -Path 'HKEY_CURRENT_USER\\software\\TightVNC\\Viewer\\History\\ComputerName::5901' -Leaf\r\n\r\nSplit-Path: Cannot find a provider with the name 'HKEY_CURRENT_USER\\software\\TightVNC\\Viewer\\History\\ComputerName'. The name is not in the proper format. A provider name can only be alphanumeric characters, or a PowerShell snap-in name that is followed by a single '\\', followed by alphanumeric characters\r\n```\r\n\r\n\r\n### Error details\r\n\r\n```powershell\r\nException             :\r\n    Type                 : System.Management.Automation.ProviderNotFoundException\r\n    ErrorRecord          :\r\n        Exception             :\r\n            Type    : System.Management.Automation.ParentContainsErrorRecordException\r\n            Message : Cannot find a provider with the name\r\n'HKEY_CURRENT_USER\\software\\TightVNC\\Viewer\\History\\ComputerName'. The name is not in the proper\r\nformat. A provider name can only be alphanumeric characters, or a PowerShell snap-in name that\r\nis followed by a single '\\', followed by alphanumeric characters.\r\n            HResult : -2146233087\r\n        TargetObject          : HKEY_CURRENT_USER\\software\\TightVNC\\Viewer\\History\\ComputerName\r\n        CategoryInfo          : ObjectNotFound:\r\n(HKEY_CURRENT_USER\\s\u2026\\History\\ComputerName:String) [], ParentContainsErrorRecordException\r\n        FullyQualifiedErrorId : ProviderNotFoundBadFormat\r\n    ItemName             : HKEY_CURRENT_USER\\software\\TightVNC\\Viewer\\History\\ComputerName\r\n    SessionStateCategory : CmdletProvider\r\n    TargetSite           :\r\n        Name          : GetProvider\r\n        DeclaringType : System.Management.Automation.SessionStateInternal,\r\nSystem.Management.Automation, Version=7.2.4.500, Culture=neutral,\r\nPublicKeyToken=31bf3856ad364e35\r\n        MemberType    : Method\r\n        Module        : System.Management.Automation.dll\r\n    Message              : Cannot find a provider with the name\r\n'HKEY_CURRENT_USER\\software\\TightVNC\\Viewer\\History\\ComputerName'. The name is not in the proper\r\nformat. A provider name can only be alphanumeric characters, or a PowerShell snap-in name that\r\nis followed by a single '\\', followed by alphanumeric characters.\r\n    Source               : System.Management.Automation\r\n    HResult              : -2146233087\r\n    StackTrace           :\r\n   at System.Management.Automation.SessionStateInternal.GetProvider(String name)\r\n   at System.Management.Automation.SessionStateInternal.GetSingleProvider(String name)\r\n   at System.Management.Automation.LocationGlobber.GetProviderPath(String path,\r\nCmdletProviderContext context, Boolean isTrusted, ProviderInfo& provider, PSDriveInfo& drive)\r\n   at System.Management.Automation.SessionStateInternal.GetChildName(String path,\r\nCmdletProviderContext context, Boolean useDefaultProvider)\r\n   at System.Management.Automation.PathIntrinsics.ParseChildName(String path,\r\nCmdletProviderContext context, Boolean useDefaultProvider)\r\n   at Microsoft.PowerShell.Commands.SplitPathCommand.ProcessRecord()\r\nTargetObject          : HKEY_CURRENT_USER\\software\\TightVNC\\Viewer\\History\\ComputerName\r\nCategoryInfo          : ObjectNotFound: (HKEY_CURRENT_USER\\s\u2026\\History\\ComputerName:String)\r\n[Split-Path], ProviderNotFoundException\r\nFullyQualifiedErrorId : ProviderNotFoundBadFormat,Microsoft.PowerShell.Commands.SplitPathCommand\r\nInvocationInfo        :\r\n    MyCommand        : Split-Path\r\n    ScriptLineNumber : 1\r\n    OffsetInLine     : 1\r\n    HistoryId        : 20\r\n    Line             : split-path -Path\r\n'HKEY_CURRENT_USER\\software\\TightVNC\\Viewer\\History\\ComputerName::5901' -Leaf\r\n    PositionMessage  : At line:1 char:1\r\n                       + split-path -Path 'HKEY_CURRENT_USER\\software\\TightVNC\\Viewer\\History\\ \u2026\r\n                       + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    InvocationName   : split-path\r\n    CommandOrigin    : Internal\r\nScriptStackTrace      : at <ScriptBlock>, <No file>: line 1\r\nPipelineIterationInfo :\r\n```\r\n\r\n\r\n### Environment data\r\n\r\n```powershell\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.2.4\r\nPSEdition                      Core\r\nGitCommitId                    7.2.4\r\nOS                             Microsoft Windows 10.0.19044\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n\r\n\r\n### Visuals\r\n\r\n_No response_",
  "closed_at": "2022-06-11T00:01:10Z",
  "comments": [
    {
      "author": "jhoneill",
      "author_association": "NONE",
      "body": "`::` designates a PowerShell provider in the path ,if you specify the provider for the path you are trying to split \r\n\r\n`split-path -path 'Microsoft.PowerShell.Core\\Registry::HKEY_CURRENT_USER\\software\\TightVNC\\Viewer\\History\\ComputerName::5901'  -leaf`\r\n\r\nIt works so does a drive.   \r\n`split-path -path 'HKCU:software\\TightVNC\\Viewer\\History\\ComputerName::5901'  -leaf`\r\n\r\nBut \"HKEY_CURRENT_USER\" isn't a valid start to a PowerShell path, it's either the `Microsoft.PowerShell.Core\\Registry::` provider.  \r\n or the `HKCU:` _drive_ (and if that is the current drive the path can begin `\\Software`  but `::` in the name will make that an invalid path) \r\n\r\n",
      "created_at": "2022-06-09T12:08:08Z",
      "updated_at": "2022-06-09T12:08:08Z"
    },
    {
      "author": "msftbot[bot]",
      "author_association": "NONE",
      "body": "This issue has been marked as answered and has not had any activity for **1 day**. It has been closed for housekeeping purposes.",
      "created_at": "2022-06-11T00:01:09Z",
      "updated_at": "2022-06-11T00:01:09Z"
    }
  ],
  "created_at": "2022-06-08T16:11:11Z",
  "labels": [
    "Resolution-Answered",
    "WG-Engine-Providers",
    "Needs-Triage",
    "Area-FileSystem-Provider"
  ],
  "number": 17501,
  "state": "closed",
  "title": "Split-Path cannot handle sequential colons in the path",
  "updated_at": "2022-06-11T00:01:10Z"
}
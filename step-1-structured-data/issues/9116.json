{
  "_url": "https://github.com/PowerShell/PowerShell/issues/9116",
  "author": "PaulHigin",
  "body": "<!-- Anything that looks like this is a comment and can't be seen after the Pull Request is created. -->\r\n\r\nA recent accessibility change has caused a regression in PowerShell remoting between machines with and without the change.  The change is a new `RepeatHeader` property added to the TableHeaderInfo class.  When formatting objects are returned through the remoting channel, the client expects to see `RepeatHeader` property in the serialized TableHeaderInfo object and throws when it is missing.\r\n\r\nFix is to allow this serialized property to be null and use 'false' as the default value for the property.\r\n\r\nRepro:\r\n```powershell\r\n$s = New-PSSession -cn <oldVersionMachine>    # Create remote connection to machine running older version of PowerShell 5 or 6\r\nInvoke-Command -Session $s - Script { Get-Process pwsh | Format-Table }\r\n\r\n# Expected\r\n# Formatted process information\r\n\r\n# Result\r\n# TerminatingError(out-lineoutput): \"The value of the repeatHeader data member cannot be null.\"\r\n```\r\n\r\n## PR Context\r\n\r\nThis breaks down level system remoting compatibility, and throws a terminating error whenever formatting objects are returned through the remoting layer.\r\n\r\n## PR Checklist\r\n\r\n- [x] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - Use the present tense and imperative mood when describing your changes\r\n- [x] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] [Change is not breaking](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)\r\n- [x] [Make sure all `.h`, `.cpp`, `.cs`, `.ps1` and `.psm1` files have the correct copyright header](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - If the PR is work in progress, please add the prefix `WIP:` or `[ WIP ]` to the beginning of the title (the `WIP` bot will keep its status check at `Pending` while the prefix is present) and remove the prefix when the PR is ready.\r\n- **User-facing changes**\r\n    - [x] Not Applicable\r\n    - **OR**\r\n    - [ ] [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n        - [ ] Issue filed: <!-- Number/link of that issue here -->\r\n- **Testing - New and feature**\r\n    - [x] N/A or can only be tested interactively\r\n    - **OR**\r\n    - [ ] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n        - [ ] [Add `[feature]` to your commit messages if the change is significant or affects feature tests](https://github.com/PowerShell/PowerShell/blob/master/docs/testing-guidelines/testing-guidelines.md#requesting-additional-tests-for-a-pr)\r\n",
  "closed_at": "2019-03-18T16:59:34Z",
  "comments": [
    {
      "author": "PaulHigin",
      "author_association": "COLLABORATOR",
      "body": "@adityapatwardhan  Can this PR be merged?",
      "created_at": "2019-03-18T16:26:05Z",
      "updated_at": "2019-03-18T16:26:05Z"
    },
    {
      "author": "Amir-Mir",
      "author_association": "NONE",
      "body": "Hello, so is this fixed for the PS version 5.1? Or will this be something that we will have to the Core or PS 7 to get it working? How do I patch or update my desktop so that this issue is fixed and I can continue using my scripts on PS 5.1? Thanks",
      "created_at": "2019-10-29T21:38:58Z",
      "updated_at": "2019-10-29T21:38:58Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "This was also fixed in PS v5.1 in Win 10 1903.  There's a separate issue with ISE that's being fixed.",
      "created_at": "2019-10-30T00:22:59Z",
      "updated_at": "2019-10-30T00:22:59Z"
    },
    {
      "author": "Amir-Mir",
      "author_association": "NONE",
      "body": "> This was also fixed in PS v5.1 in Win 10 1903.  There's a separate issue with ISE that's being fixed.\r\n\r\nI am currently seeing the issue in PS v5.1 running Win 10 1903 and I still see this issue. \r\n![image](https://user-images.githubusercontent.com/40069660/67869946-291d4f00-fafc-11e9-8b68-0ac50e0fe134.png)\r\n\r\nProviding you with some details of my PS version and OS version. \r\n\r\n![image](https://user-images.githubusercontent.com/40069660/67869399-5fa69a00-fafb-11e9-963d-8d87f26ca940.png)\r\n![image](https://user-images.githubusercontent.com/40069660/67869477-7cdb6880-fafb-11e9-9cd0-660a86e58262.png)\r\n",
      "created_at": "2019-10-30T15:00:40Z",
      "updated_at": "2019-10-30T15:01:04Z"
    },
    {
      "author": "Amir-Mir",
      "author_association": "NONE",
      "body": "> This was also fixed in PS v5.1 in Win 10 1903. There's a separate issue with ISE that's being fixed.\r\n\r\nHello @SteveL-MSFT , you mentioned that the fix was provided in PS v5.1 in Win 1903 and I provided you with a proof that I am experiencing the same issue running the version it should be fixed in. Can you please point me in a direction where I can look up what update I need to apply to either the PS or Win to get this issue resolved?\r\n\r\n",
      "created_at": "2019-10-31T15:12:01Z",
      "updated_at": "2019-10-31T15:12:01Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@BadSqlPro looks like this is in build 18892 or newer.  You can workaround the issue by explicitly using `Format-List` or `Format-Wide`, just not `Format-Table` (which is default for many things unfortunately)",
      "created_at": "2019-10-31T16:05:32Z",
      "updated_at": "2019-10-31T16:05:32Z"
    }
  ],
  "created_at": "2019-03-11T17:23:41Z",
  "number": 9116,
  "state": "closed",
  "title": "Fix for FormatTable remote deserialization regression",
  "updated_at": "2019-10-31T16:05:32Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/8859",
  "author": "ThreeFive-O",
  "body": "## PR Summary\r\n\r\nFixes #3950\r\n\r\nThis PR contains a cross-platform SMTP server mockup which allows to run the Send-MailMessage tests on the PowerShell CI system (Azure DevOps pipeline) as well as on local development machines for all supported platforms.\r\n\r\nThis PR includes:\r\n- Use of netDumbster (see PR Context for more information) as a cross-platform SMTP server mockup\r\n- Refactoring of Send-MailMessage tests with new Pester syntax\r\n- Easier extensibility for further tests (Send-MailMessage cmdlets requires further test coverage)\r\n- Added `RequireSudoOnUnix` tag as Linux and macOS on CI requires sudo for privileged port 25 (SMTP)\r\n- Marked tests for named piping of objects into Send-MailMessage cmdlet as skipped, since this behaviour is not supported as of yet (see issue #7591)\r\n\r\n## PR Context  \r\n\r\nBefore this PR the Send-MailMessage tests run only on local Linux development machines when a local SMTP server is set up and running.\r\n\r\nThis is rather inconvenient for testing because:\r\n- Test code is only meant to be run under Linux\r\n- One has to set up its own SMTP server\r\n- Tests are not supported on CI system (Azure DevOps pipeline) for PowerShell\r\n\r\nThe Azure DevOps pipeline VMs don't have any local SMTP server set up. Therefore the tests for Send-MailMessage are skipped during CI checks.\r\n\r\nThis PR will provide a way to run the tests on the Azure DevOps pipeline for Windows, Linux and macOS as well on local development machines.\r\n\r\n## PR Checklist\r\n\r\n- [x] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - Use the present tense and imperative mood when describing your changes\r\n- [x] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] [Change is not breaking](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)\r\n- [x] [Make sure all `.h`, `.cpp`, `.cs`, `.ps1` and `.psm1` files have the correct copyright header](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - If the PR is work in progress, please add the prefix `WIP:` or `[ WIP ]` to the beginning of the title (the `WIP` bot will keep its status check at `Pending` while the prefix is present) and remove the prefix when the PR is ready.  \r\n- **User-facing changes**\r\n    - [x] Not Applicable\r\n    - **OR**  \r\n    - [ ] [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n        - [ ] Issue filed: <!-- Number/link of that issue here -->\r\n- **Testing - New and feature**\r\n    - [x] N/A or can only be tested interactively\r\n    - **OR**\r\n    - [ ] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n        - [ ] [Add `[feature]` to your commit messages if the change is significant or affects feature tests](https://github.com/PowerShell/PowerShell/blob/master/docs/testing-guidelines/testing-guidelines.md#requesting-additional-tests-for-a-pr)\r\n",
  "closed_at": "2019-03-05T22:29:49Z",
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@adityapatwardhan Please look the PR.",
      "created_at": "2019-02-24T19:08:42Z",
      "updated_at": "2019-02-24T19:08:42Z"
    },
    {
      "author": "adityapatwardhan",
      "author_association": "MEMBER",
      "body": "@ThreeFive-O The changes looks great, just added a comment for improving performance slightly. Everything else looks good. ",
      "created_at": "2019-03-01T21:32:48Z",
      "updated_at": "2019-03-01T21:32:48Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "@adityapatwardhan \tPlease review #9031 \t.  I think we should still take this PR",
      "created_at": "2019-03-02T18:14:27Z",
      "updated_at": "2019-03-02T18:14:27Z"
    },
    {
      "author": "ThreeFive-O",
      "author_association": "CONTRIBUTOR",
      "body": "@adityapatwardhan and @TravisEz13 Not sure why my CLA status is still not reported, but all other checks have passed.",
      "created_at": "2019-03-03T09:12:07Z",
      "updated_at": "2019-03-03T09:12:07Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "@ThreeFive-O \tNo worries, we got status on this commit:  https://github.com/PowerShell/PowerShell/pull/8859/commits/0686809365084dee1336b9cf07accedbbf7d3626",
      "created_at": "2019-03-03T23:28:26Z",
      "updated_at": "2019-03-03T23:28:26Z"
    }
  ],
  "created_at": "2019-02-10T20:14:09Z",
  "number": 8859,
  "state": "closed",
  "title": "Enable cross-platform Send-MailMessage tests for CI",
  "updated_at": "2019-03-05T23:45:42Z"
}
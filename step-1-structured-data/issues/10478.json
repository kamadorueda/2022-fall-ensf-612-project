{
  "_url": "https://github.com/PowerShell/PowerShell/issues/10478",
  "author": "vexx32",
  "body": "<!-- Anything that looks like this is a comment and can't be seen after the Pull Request is created. -->\r\n\r\n# PR Summary\r\n\r\n1. ~~Replaces all `WriteInformation()` calls with `WriteVerbose()`~~ **Removes** all verbose and progress output. We will revisit verbose output in a later PR.\r\n2. Refactors ping implementation to create only a single `Ping` object which is reused for all `Send()` calls.\r\n3. Implements `IDisposable` for `Test-Connection` so that it can dispose of the `Ping` object when it is no longer needed.\r\n\r\n## PR Context\r\n\r\nPart 2 of #10044, refactor of `Test-Connection` cmdlet.\r\nFixes #6768\r\n\r\n## PR Checklist\r\n\r\n- [x] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - Use the present tense and imperative mood when describing your changes\r\n- [x] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] [Make sure all `.h`, `.cpp`, `.cs`, `.ps1` and `.psm1` files have the correct copyright header](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - If the PR is work in progress, please add the prefix `WIP:` or `[ WIP ]` to the beginning of the title (the `WIP` bot will keep its status check at `Pending` while the prefix is present) and remove the prefix when the PR is ready.\r\n- **[Breaking changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)**\r\n    - [x] None\r\n    - **OR**\r\n    - [ ] [Experimental feature(s) needed](https://github.com/MicrosoftDocs/PowerShell-Docs/blob/staging/reference/6/Microsoft.PowerShell.Core/About/about_Experimental_Features.md)\r\n        - [ ] Experimental feature name(s): <!-- Experimental feature name(s) here -->\r\n- **User-facing changes**\r\n    - [ ] Not Applicable\r\n    - **OR**\r\n    - [x] [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n        - [ ] Issue filed: <!-- Number/link of that issue here -->\r\n- **Testing - New and feature**\r\n    - [x] N/A or can only be tested interactively\r\n    - **OR**\r\n    - [ ] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n- **Tooling**\r\n    - [x] I have considered the user experience from a tooling perspective and don't believe tooling will be impacted.\r\n    - **OR**\r\n    - [ ] I have considered the user experience from a tooling perspective and enumerated concerns in the summary. This may include:\r\n        - Impact on [PowerShell Editor Services](https://github.com/PowerShell/PowerShellEditorServices) which is used in the [PowerShell extension](https://github.com/PowerShell/vscode-powershell) for VSCode (which runs in a different PS Host).\r\n        - Impact on Completions (both in the console and in editors) - one of PowerShell's most powerful features.\r\n        - Impact on [PSScriptAnalyzer](https://github.com/PowerShell/PSScriptAnalyzer) (which provides linting & formatting in the editor extensions).\r\n        - Impact on [EditorSyntax](https://github.com/PowerShell/EditorSyntax) (which provides syntax highlighting with in VSCode, GitHub, and many other editors).\r\n",
  "closed_at": "2019-10-03T19:04:55Z",
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "> Replaces all WriteInformation() calls with WriteVerbose()\r\n\r\nIntention was to write to Host. PowerShell implements this over information stream. \r\nA conclusion was to be close to Windows PowerShell so I see no reason to write to verbose stream in the same way. I believe we need to remove this.\r\n",
      "created_at": "2019-09-05T10:37:34Z",
      "updated_at": "2019-09-05T10:37:34Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "That is true...\r\n\r\nI was thinking of a use case where `-Quiet` may be used in the code, but during development the `-Verbose` parameter could be added to show the otherwise hidden/ignored information.\r\n\r\nThough I suppose the verbose output probably should just be something along the lines of: `VERBOSE: Testing connection to <target>`?",
      "created_at": "2019-09-05T12:20:37Z",
      "updated_at": "2019-09-05T12:20:45Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Yes, verbose output should has another form and probably be in other places because it serves other purposes. We could implement this later if this will be needed.",
      "created_at": "2019-09-05T12:41:57Z",
      "updated_at": "2019-09-05T12:41:57Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "I'll do a revision of the verbose output today, keeping it pretty simple. We can expand on it more at a later date if we need more. :)",
      "created_at": "2019-09-05T13:00:19Z",
      "updated_at": "2019-09-05T13:00:34Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "You could simply remove the extra output in the PR and add verbose in follow PR to speed up code review.",
      "created_at": "2019-09-05T13:05:24Z",
      "updated_at": "2019-09-05T13:05:24Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "@iSazonov would it be better to also remove progress bars in this PR or following PR?\r\n\r\nEDIT: It seems that change is a bit simpler at least from looking at the diffs, since we can just remove entirely the methods that handle the information/progress data. If you'd rather I leave the progress in for now, just ping me and I'll make the change. \ud83d\ude42 ",
      "created_at": "2019-09-05T16:31:57Z",
      "updated_at": "2019-09-05T18:47:07Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "@TravisEz13 is there anything more you guys need from me on this one? I have a couple more PRs lined up and ready for this cmdlet that I'd love to get in for PSv7 to more fully cover the scope of the approved RFC. \ud83d\udc96 ",
      "created_at": "2019-09-26T20:12:56Z",
      "updated_at": "2019-09-26T20:13:08Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT @TravisEz13 I know you guys are pretty busy at this point in the release cycle, but can't hurt to ask I hope:\r\n\r\nCan I ask to get this one merged in and move forward with implementing the remainder of the changes already approved in the RFC for v7 timeframe? I have the code for it all written (at least one or maybe two more PR's worth) and the RFC is already approved, so I would like to have all the Test-Connection changes I plan on making merged in for v7 GA if at all possible.\r\n\r\nThank you! You guys are awesome! \ud83d\ude0a \ud83d\udc96 ",
      "created_at": "2019-10-03T16:23:02Z",
      "updated_at": "2019-10-03T16:26:31Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "Did the output of the Cmdlet change in this PR?",
      "created_at": "2019-10-03T18:04:11Z",
      "updated_at": "2019-10-03T18:04:11Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "@TravisEz13 The success output of this cmdlet has not changed. That is what I plan to change in a follow-up PR. \ud83d\ude42 \r\n\r\nOr, if you'd prefer, I can merge the changes from that branch into here directly, but that does make the diffs unfortunately difficult to work through, which is why I subdivided my PRs on this one. \ud83d\ude42 ",
      "created_at": "2019-10-03T18:08:17Z",
      "updated_at": "2019-10-03T18:08:17Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "No... I prefer it like this.  I'm just trying to clarify.",
      "created_at": "2019-10-03T19:04:29Z",
      "updated_at": "2019-10-03T19:04:29Z"
    },
    {
      "author": "msftbot[bot]",
      "author_association": "NONE",
      "body": ":tada:`v7.0.0-preview.5` has been released which incorporates this pull request.:tada:\n\nHandy links:\n* [Release Notes](https://github.com/PowerShell/PowerShell/releases/tag/v7.0.0-preview.5)\n",
      "created_at": "2019-10-23T19:07:28Z",
      "updated_at": "2019-10-23T19:07:28Z"
    }
  ],
  "created_at": "2019-09-03T20:24:12Z",
  "number": 10478,
  "state": "closed",
  "title": "Test-Connection - Remove informational output, consolidate Ping usage",
  "updated_at": "2019-10-23T19:07:29Z"
}
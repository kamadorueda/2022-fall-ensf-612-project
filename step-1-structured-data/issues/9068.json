{
  "_url": "https://github.com/PowerShell/PowerShell/issues/9068",
  "author": "RDIL",
  "body": "<!-- Anything that looks like this is a comment and can't be seen after the Pull Request is created. -->\r\n\r\n# PR Summary\r\nfixes #8078 \r\ntodo:\r\nupdate contributing md\r\n\r\n<!-- Summarize your PR between here and the checklist. -->\r\n\r\n## PR Context\r\n\r\n<!-- Provide a little reasoning as to why this Pull Request helps and why you have opened it. -->\r\n\r\n## PR Checklist\r\n\r\n- [x] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - Use the present tense and imperative mood when describing your changes\r\n- [x] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] [Change is not breaking](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)\r\n- [x] [Make sure all `.h`, `.cpp`, `.cs`, `.ps1` and `.psm1` files have the correct copyright header](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - If the PR is work in progress, please add the prefix `WIP:` or `[ WIP ]` to the beginning of the title (the `WIP` bot will keep its status check at `Pending` while the prefix is present) and remove the prefix when the PR is ready.\r\n- **User-facing changes**\r\n    - [ ] Not Applicable\r\n    - **OR**\r\n    - [X] [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n        - [X] Issue filed: <!-- Number/link of that issue here --> #8078 \r\n- **Testing - New and feature**\r\n    - [ ] N/A or can only be tested interactively\r\n    - **OR**\r\n    - [X] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n        - [x] [Add `[feature]` to your commit messages if the change is significant or affects feature tests](https://github.com/PowerShell/PowerShell/blob/master/docs/testing-guidelines/testing-guidelines.md#requesting-additional-tests-for-a-pr)\r\n",
  "closed_at": "2020-05-14T01:15:50Z",
  "comments": [
    {
      "author": "RDIL",
      "author_association": "CONTRIBUTOR",
      "body": "@iSazonov @vexx32 can you two please take a look?  Need a second eye as I can't find my mistake.  ",
      "created_at": "2019-03-07T13:43:38Z",
      "updated_at": "2019-03-07T13:43:38Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "First we need confirmation from @TravisEz13 - I am not sure that it is right direction for spelling.",
      "created_at": "2019-03-07T14:25:50Z",
      "updated_at": "2019-03-07T14:25:50Z"
    },
    {
      "author": "RDIL",
      "author_association": "CONTRIBUTOR",
      "body": "@iSazonov see issue #8078 ",
      "created_at": "2019-03-07T14:44:03Z",
      "updated_at": "2019-03-07T14:44:03Z"
    },
    {
      "author": "RDIL",
      "author_association": "CONTRIBUTOR",
      "body": "I love pester \ud83e\udd23 \r\n```\r\nContext Verify spelling in /home/vsts/work/1/s/tools/performance/README.md\r\n      [-] >> 8 spelling errors found in 1 file should work 2ms\r\n        RuntimeException: Tool reported spelling as wrong.\r\n```",
      "created_at": "2019-03-07T17:46:55Z",
      "updated_at": "2019-03-07T17:46:55Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "Does `mdspell` allow us to see each spelling error @RDIL?\r\n\r\nMight need to rethink how you're categorising and parsing the output \ud83d\ude09 ",
      "created_at": "2019-03-07T18:06:01Z",
      "updated_at": "2019-03-07T18:06:01Z"
    },
    {
      "author": "RDIL",
      "author_association": "CONTRIBUTOR",
      "body": "Yeah it does but I sadly don't have that level of expertise in powershell :(",
      "created_at": "2019-03-07T18:07:24Z",
      "updated_at": "2019-03-07T18:07:24Z"
    },
    {
      "author": "RDIL",
      "author_association": "CONTRIBUTOR",
      "body": "Thank you for all your help @vexx32!",
      "created_at": "2019-03-07T18:15:06Z",
      "updated_at": "2019-03-07T18:15:06Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "@rdil can you show me some example output from mdspell? I can probably figure out a regex to get the misspelled words.",
      "created_at": "2019-03-07T18:37:02Z",
      "updated_at": "2019-03-07T18:37:02Z"
    },
    {
      "author": "RDIL",
      "author_association": "CONTRIBUTOR",
      "body": "@vexx32 here:\r\nhttps://cirrus-ci.com/task/5949319808024576\r\nmake sure to click on main to open the logs\r\nalso its at the very bottom of logs",
      "created_at": "2019-03-07T18:39:36Z",
      "updated_at": "2019-03-07T18:39:36Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "Ah, I see. So currently you're checking your final output line, the summary. OK... OK... hm. Can you mock up an example where there's spelling errors in at least two files for me? I can definitely regex that, just don't wanna miss anything. \u2764\ufe0f \r\n\r\nI'm guessing that you can safely assume that if there's more than one line of output there were spelling errors. The rest would just be getting the file name and misspelled word(s).",
      "created_at": "2019-03-07T18:42:13Z",
      "updated_at": "2019-03-07T18:43:01Z"
    },
    {
      "author": "RDIL",
      "author_association": "CONTRIBUTOR",
      "body": "sure one min",
      "created_at": "2019-03-07T18:43:46Z",
      "updated_at": "2019-03-07T18:43:46Z"
    },
    {
      "author": "RDIL",
      "author_association": "CONTRIBUTOR",
      "body": "@vexx32 here is with 2 files:\r\nhttps://cirrus-ci.com/task/5078643473645568",
      "created_at": "2019-03-07T18:49:10Z",
      "updated_at": "2019-03-07T18:49:10Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "@RDIL this is what I have so far\r\n![image](https://user-images.githubusercontent.com/32407840/53983065-6869dc00-40e4-11e9-9f9f-898bf1915d62.png)\r\n\r\nThe code, cleaned and refactored:\r\n\r\n```powershell\r\n<#\r\n    This assumes $Output is an array of output lines.\r\n    If you encounter issues, try splitting first with -split '\\r?\\n'\r\n#>\r\nif (@($Output).Count -gt 1) {\r\n    # Trim last line containing only success/failure message and split into one block per file\r\n    $ErrorList = $Output[0..($Output.Length - 2)] -join '\\n' -split '(\\n[^|]+\\n)'\r\n\r\n    foreach ($Entry in ($ErrorList )) {\r\n        $Lines = $Entry -split '\\n'\r\n        $File = $Lines[0].Trim()\r\n        $MistakeList = $Lines | Select-Object -Skip 1\r\n\r\n        foreach ($Mistake in $MistakeList) {\r\n            if ($Mistake -match '(?<Line>[0-9]+) \\| (?<Mistake>[\\w ]+)') {\r\n                $Matches.Remove(0)\r\n                $Matches.Add('Filename', $File)\r\n\r\n                # Output the object from the regex match with filename\r\n                [PSCustomObject]$Matches\r\n            }\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nIf you run this on the `mdspell` output sequence you should get usable PSCustomObjects listing file, line number, and the text that it detects containing a misspelling. These you can put into your pester test and output how you wish to show exactly which files and where the problems are. \ud83d\ude04 ",
      "created_at": "2019-03-07T19:31:46Z",
      "updated_at": "2019-03-07T20:17:41Z"
    },
    {
      "author": "RDIL",
      "author_association": "CONTRIBUTOR",
      "body": "@vexx32 nice.  I'll try to add it whenever I have time.  ",
      "created_at": "2019-03-07T19:52:31Z",
      "updated_at": "2019-03-07T19:52:31Z"
    },
    {
      "author": "RDIL",
      "author_association": "CONTRIBUTOR",
      "body": "i give up these spelling errors cannot be fixed",
      "created_at": "2019-03-08T15:39:32Z",
      "updated_at": "2019-03-08T15:39:32Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "@RDIL if you work in the code to parse the output more granularly it should point you right to each error, instead of you having to scan through each file to figure out what's going wrong \ud83d\ude04 ",
      "created_at": "2019-03-08T16:25:56Z",
      "updated_at": "2019-03-08T16:25:56Z"
    },
    {
      "author": "RDIL",
      "author_association": "CONTRIBUTOR",
      "body": "@vexx32 I'm aware of which sentence the errors are in, but I don't know which word.   ",
      "created_at": "2019-03-08T16:27:04Z",
      "updated_at": "2019-03-08T16:27:04Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "List the remaining lines here, then, I guess? \r\n\r\n",
      "created_at": "2019-03-08T16:45:08Z",
      "updated_at": "2019-03-08T16:45:08Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "This looks like a good start.  It would be nice if we could use this version of the tool (https://github.com/lukeapage/node-markdown-spellcheck/pull/114) so that pester could parse the results and report the actual line and word that failed.",
      "created_at": "2019-03-08T21:44:28Z",
      "updated_at": "2019-03-08T21:44:28Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "Sorry, I didn't read @vexx32 \t's comments. Before posting that, just consider it as one idea.",
      "created_at": "2019-03-08T21:45:55Z",
      "updated_at": "2019-03-08T21:45:55Z"
    },
    {
      "author": "RDIL",
      "author_association": "CONTRIBUTOR",
      "body": "I'm going to close this until I am in a better mental state and can work on this.",
      "created_at": "2019-03-11T12:45:31Z",
      "updated_at": "2019-03-11T12:45:31Z"
    },
    {
      "author": "PoshChan-Staging",
      "author_association": "COLLABORATOR",
      "body": "@web-flow, your last commit had 3 failures in `PowerShell-CI-static-analysis`\r\n### Verify Markdown Spelling.Verify spelling in /home/vsts/work/1/s/tools/performance/README.md.>> 8 spelling errors found in 1 file!\r\n  Error: Tool reported spelling as wrong.\r\n```stacktrace\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/common/markdown/markdown-spell.tests.ps1: line 64\r\n64:                         throw \"Tool reported spelling as wrong.\"\r\n\r\n```\r\n### Verify Markdown Spelling.Verify spelling in /home/vsts/work/1/s/docs/cmdlet-example/command-line-simple-example.md.>> 5 spelling errors found in 1 file!\r\n  Error: Tool reported spelling as wrong.\r\n```stacktrace\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/common/markdown/markdown-spell.tests.ps1: line 64\r\n64:                         throw \"Tool reported spelling as wrong.\"\r\n\r\n```\r\n### Verify Markdown Spelling.Verify spelling in /home/vsts/work/1/s/CHANGELOG.md.>> 32 spelling errors found in 1 file!\r\n  Error: Tool reported spelling as wrong.\r\n```stacktrace\r\nat <ScriptBlock>, /home/vsts/work/1/s/test/common/markdown/markdown-spell.tests.ps1: line 64\r\n64:                         throw \"Tool reported spelling as wrong.\"\r\n\r\n```\r\n",
      "created_at": "2019-03-27T14:11:35Z",
      "updated_at": "2019-06-19T15:41:38Z"
    },
    {
      "author": "RDIL",
      "author_association": "CONTRIBUTOR",
      "body": "thanks poshchan I had absolutely no idea the check I wrote is failing",
      "created_at": "2019-03-27T14:43:07Z",
      "updated_at": "2019-03-27T14:43:07Z"
    },
    {
      "author": "stale[bot]",
      "author_association": "NONE",
      "body": "This PR has been automatically marked as stale because it has not had activity in the last 30 days. It will be closed if no further activity occurs within 10 days.\nThank you for your contributions.\nCommunity members are welcome to grab these works.\n",
      "created_at": "2019-04-26T14:44:06Z",
      "updated_at": "2019-04-26T14:44:06Z"
    },
    {
      "author": "stale[bot]",
      "author_association": "NONE",
      "body": "This PR has been automatically marked as stale because it has not had activity in the last 30 days. It will be closed if no further activity occurs within 10 days.\nThank you for your contributions.\nCommunity members are welcome to grab these works.\n",
      "created_at": "2019-05-26T15:07:36Z",
      "updated_at": "2019-05-26T15:07:36Z"
    },
    {
      "author": "RDIL",
      "author_association": "CONTRIBUTOR",
      "body": "This makes me so mad because this code works but this one file has a spelling mistake and I don't know what word it is :[",
      "created_at": "2019-06-19T15:48:41Z",
      "updated_at": "2019-06-19T15:48:41Z"
    },
    {
      "author": "ghvanderweg",
      "author_association": "NONE",
      "body": "@RDIL which file and line number?",
      "created_at": "2019-06-19T15:54:55Z",
      "updated_at": "2019-06-19T15:54:55Z"
    },
    {
      "author": "RDIL",
      "author_association": "CONTRIBUTOR",
      "body": "It says it somewhere in the static analysis results",
      "created_at": "2019-06-19T15:57:32Z",
      "updated_at": "2019-06-19T15:57:32Z"
    },
    {
      "author": "ghvanderweg",
      "author_association": "NONE",
      "body": "3 files with a total of 57 errors.. but nothing jumps out at me either. I'll take a closer look.\r\n```\r\n    Context Verify spelling in /home/vsts/work/1/s/docs/cmdlet-example/command-line-simple-example.md\r\nWARNING: >> 5 spelling errors found in 1 file\r\n      [-] >> 5 spelling errors found in 1 file! 81ms\r\n        RuntimeException: Tool reported spelling as wrong.\r\n        at <ScriptBlock>, /home/vsts/work/1/s/test/common/markdown/markdown-spell.tests.ps1: line 65\r\n\r\n    Context Verify spelling in /home/vsts/work/1/s/CHANGELOG.md\r\nWARNING: >> 44 spelling errors found in 1 file\r\n      [-] >> 44 spelling errors found in 1 file! 25ms\r\n        RuntimeException: Tool reported spelling as wrong.\r\n        at <ScriptBlock>, /home/vsts/work/1/s/test/common/markdown/markdown-spell.tests.ps1: line 65\r\n\r\n    Context Verify spelling in /home/vsts/work/1/s/tools/performance/README.md\r\nWARNING: >> 8 spelling errors found in 1 file\r\n      [-] >> 8 spelling errors found in 1 file! 2ms\r\n        RuntimeException: Tool reported spelling as wrong.\r\n        at <ScriptBlock>, /home/vsts/work/1/s/test/common/markdown/markdown-spell.tests.ps1: line 65\r\n```",
      "created_at": "2019-06-19T16:02:06Z",
      "updated_at": "2019-06-19T16:02:06Z"
    },
    {
      "author": "ghvanderweg",
      "author_association": "NONE",
      "body": "It looks like the file overrides in .spelling don't work like they're supposed to. If I remove the file override lines and just put everything in the global dictionary, it works fine.",
      "created_at": "2019-06-19T17:16:58Z",
      "updated_at": "2019-06-19T17:16:58Z"
    },
    {
      "author": "RDIL",
      "author_association": "CONTRIBUTOR",
      "body": "Interesting, I\u2019ll give it a look. ",
      "created_at": "2019-06-19T17:32:58Z",
      "updated_at": "2019-06-19T17:32:58Z"
    },
    {
      "author": "RDIL",
      "author_association": "CONTRIBUTOR",
      "body": "Umm it didn\u2019t work \ud83d\ude22 ",
      "created_at": "2019-06-19T17:42:18Z",
      "updated_at": "2019-06-19T17:42:18Z"
    },
    {
      "author": "RDIL",
      "author_association": "CONTRIBUTOR",
      "body": "Next to the line number there should be a clickable space which gives you the ability to type in a message",
      "created_at": "2019-06-19T18:37:17Z",
      "updated_at": "2019-06-19T18:37:17Z"
    },
    {
      "author": "RDIL",
      "author_association": "CONTRIBUTOR",
      "body": "Holy cow it worked",
      "created_at": "2019-06-19T18:43:52Z",
      "updated_at": "2019-06-19T18:43:52Z"
    },
    {
      "author": "RDIL",
      "author_association": "CONTRIBUTOR",
      "body": "@iSazonov are you sure removing the throw is the right thing? That would make the tests pass...",
      "created_at": "2019-06-20T12:13:45Z",
      "updated_at": "2019-06-20T12:13:45Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@RDIL My request is not remove throw but replace with Should - I'd expect more friendly output. I can wrong but you could make tests and compare the output.",
      "created_at": "2019-06-20T12:42:35Z",
      "updated_at": "2019-06-20T12:42:35Z"
    },
    {
      "author": "RDIL",
      "author_association": "CONTRIBUTOR",
      "body": "I'm sorry, but I don't really understand what you mean by that.",
      "created_at": "2019-06-20T12:46:55Z",
      "updated_at": "2019-06-20T12:46:55Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@RDIL I haven't experience to review this in depth. And MSFT team is busy in the days :-( So waiting...",
      "created_at": "2019-09-26T04:50:40Z",
      "updated_at": "2019-09-26T04:50:40Z"
    }
  ],
  "created_at": "2019-03-06T02:36:05Z",
  "number": 9068,
  "state": "closed",
  "title": "Make markdown spell-checking a Pester test",
  "updated_at": "2020-05-14T01:15:50Z"
}
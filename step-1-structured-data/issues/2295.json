{
  "_url": "https://github.com/PowerShell/PowerShell/issues/2295",
  "author": "vors",
  "body": "## Steps to reproduce\n\nThere are few issues with casting to [System.Management.Automation.PSCustomObject]. Note the full name! The short name [PSCustomObject] works just fine, I guess it uses a different (type accelerator) code path.\n## First part\n\nTry to create a [PSCustomObject] as described in a numerous of blog posts ([example](https://powershell.org/2013/04/24/pscustomobject-save-puppies-and-avoid-dead-ends/))\n\n```\n> $a = [PSCustomObject]@{a = 'a'; b = 'b'}       \n> $a      \na b                                                                                                                                         \n- -                                                                                                                     \na b \n\n> $a.GetType().FullName            \nSystem.Management.Automation.PSCustomObject                                                         \n```\n\nSo far so good.\nNow, try to do it with the full name\n\n```\n> [System.Management.Automation.PSCustomObject]@{a = 'a'; b = 'b'}\nCannot convert the \"System.Collections.Hashtable\" value of type \"System.Collections.Hashtable\" to type                                       \n\"System.Management.Automation.PSCustomObject\".\nAt line:1 char:2\n+  [System.Management.Automation.PSCustomObject]@{a = 'a'; b = 'b'}\n+  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : InvalidArgument: (:) [], RuntimeException\n    + FullyQualifiedErrorId : ConvertToFinalInvalidCastException\n```\n## Expected behavior\n\nConversion succeed.\n## Actual behavior\n\n```\n> [System.Management.Automation.PSCustomObject]@{a = 'a'; b = 'b'}\nCannot convert the \"System.Collections.Hashtable\" value of type \"System.Collections.Hashtable\" to type                                       \n\"System.Management.Automation.PSCustomObject\".\nAt line:1 char:2\n+  [System.Management.Automation.PSCustomObject]@{a = 'a'; b = 'b'}\n+  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : InvalidArgument: (:) [], RuntimeException\n    + FullyQualifiedErrorId : ConvertToFinalInvalidCastException\n```\n## Second part\n\nNow try to cast the original object `$a`\n\n```\n> [System.Management.Automation.PSCustomObject]$a                    \nCannot convert the \"@{a=a; b=b}\" value of type \"System.Management.Automation.PSCustomObject\" to type \n\"System.Management.Automation.PSCustomObject\".\nAt line:1 char:2\n+  [System.Management.Automation.PSCustomObject]$a\n+  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : InvalidArgument: (:) [], RuntimeException\n    + FullyQualifiedErrorId : ConvertToFinalInvalidCastException\n\n```\n\nThe error message is pretty weird, since no actual conversion should be required.\n\n**Note:** this affects UX, because auto-completion on `[pscu` will expend it into `[System.Management.Automation.PSCustomObject` and not `[PSCustomObject`.\nThis is also inconsistent with `[pso` that expends into `[psobject` and not `[System.Management.Automation.PSObject]`\n\nAlso, note that this works fine\n\n```\n> [System.Management.Automation.PSObject]@{a = 'a'; b = 'b'}\n```\n## Environment data\n\n<!-- provide the output of $PSVersionTable -->\n\n``` powershell\n> $PSVersionTable\nName                           Value                                                                                                        \n----                           -----                                                                                                        \nPSVersion                      6.0.0-alpha                                                                                                  \nPSEdition                      Core                                                                                                         \nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}                                                                                      \nBuildVersion                   3.0.0.0                                                                                                      \nGitCommitId                    v6.0.0-alpha.10                                                                                              \nCLRVersion                                                                                                                                  \nWSManStackVersion              3.0                                                                                                          \nPSRemotingProtocolVersion      2.3                                                                                                          \nSerializationVersion           1.1.0.1 \n```\n\ncc @jpsnover \n",
  "closed_at": "2016-12-21T23:33:10Z",
  "comments": [
    {
      "author": "vors",
      "author_association": "COLLABORATOR",
      "body": "@JamesWTruher found a part that may explain some:\n\n```\n> [pscustomobject].FullName\nSystem.Management.Automation.PSObject\n```\n\nSo looks like both `[pscustomobject]` and `[psobject]` type accelerators point to the same PSObject type.\n",
      "created_at": "2016-09-20T00:17:59Z",
      "updated_at": "2016-09-20T00:17:59Z"
    }
  ],
  "created_at": "2016-09-17T21:41:39Z",
  "number": 2295,
  "state": "closed",
  "title": "[System.Management.Automation.PSCustomObject] weirdness",
  "updated_at": "2016-12-21T23:33:28Z"
}
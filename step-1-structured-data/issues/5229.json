{
  "_url": "https://github.com/PowerShell/PowerShell/issues/5229",
  "author": "iSazonov",
  "body": "Resolve #4220.\r\n\r\nThe cmdlet is based on [NJsonSchema](https://github.com/RSuter/NJsonSchema).\r\nIt allow to check:\r\n- Json by only parsing\r\n- Json against Schema\r\n- implicitly check Schema by parsing (based on previous line check)\r\n\r\nNJsonSchema is under MIT - please approve using the package.\r\n /cc @joeyaiello @SteveL-MSFT ",
  "closed_at": "2018-03-26T18:52:49Z",
  "comments": [
    {
      "author": "bergmeister",
      "author_association": "CONTRIBUTOR",
      "body": "An interesting question will be what `Test-Json '{ \"key\":\"value1\", \"key\":\"value2\" }'` should return? Should it just mirror the current questionable behaviour of `ConvertFrom-Json` or rather alert about duplicate entries?",
      "created_at": "2017-10-25T19:54:02Z",
      "updated_at": "2017-10-25T19:54:45Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Here we also are based on Newton.Json library. @bergmeister Could you please extend #5199 with Test-Json too if the PR will be merged?",
      "created_at": "2017-10-26T05:04:44Z",
      "updated_at": "2017-10-26T05:04:44Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@iSazonov I'm in Singapore this week for PSConfAsia, so I'll follow-up on getting approval next week.  MIT License should be fine, but I'll make this official.  Thanks!",
      "created_at": "2017-10-26T10:22:46Z",
      "updated_at": "2017-10-26T10:22:46Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@iSazonov I've registered use of NJsonSchema, the only requirement is adding them to our [ThirdPartyNotices](https://github.com/PowerShell/PowerShell/blob/master/ThirdPartyNotices.txt) file using this template:\r\n\r\n```none\r\nNJsonSchema\r\n\r\n// [INSERT ORIGINAL COPYRIGHT NOTICE FOR OSS]\r\nProvided for Informational Purposes Only\r\n\r\nMIT License\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the Software), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n```",
      "created_at": "2017-11-08T22:31:42Z",
      "updated_at": "2017-11-08T22:31:42Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT I added NJsonSchema license.",
      "created_at": "2017-11-09T03:10:31Z",
      "updated_at": "2017-11-09T03:10:31Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@TravisEz13 Please help me to fix CI test with `Files.wxs`. Locally the script returns warnings about multiple files and not one as expected.",
      "created_at": "2018-03-16T13:57:17Z",
      "updated_at": "2018-03-16T13:57:17Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@iSazonov I believe you need to add NJsonSchema dll to Files.wxs since it's being included in the package",
      "created_at": "2018-03-16T21:05:44Z",
      "updated_at": "2018-03-16T21:05:44Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT The file is auto-generated - I can not add GUIDs manually. Locally `New-MSIPackage` returns errors for many files.",
      "created_at": "2018-03-19T04:54:07Z",
      "updated_at": "2018-03-19T04:54:07Z"
    },
    {
      "author": "bergmeister",
      "author_association": "CONTRIBUTOR",
      "body": "I have not kept up with the latest MSI changes that happened recently but heat.exe (the harvester) should generate the Files.wxs file (that also seems to be checked in now) but I can briefly look into it @iSazonov this evening to see if I can maybe help you resolve the error.",
      "created_at": "2018-03-19T06:51:43Z",
      "updated_at": "2018-03-19T06:51:58Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@bergmeister Thanks for help! The `New-MSIPackage` uses `heat.exe` and returns many errors \ud83d\ude15 ",
      "created_at": "2018-03-19T10:45:07Z",
      "updated_at": "2018-03-19T10:45:07Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "There is only one error\r\n```\r\nnew file {$(env.ProductSourcePath)\\NJsonSchema.dll} need to be added to {C:\\projects\\powershell\\tools\\packaging\\..\\..\\assets\\Files.wxs}\r\n```\r\nI think this is self explanitory",
      "created_at": "2018-03-19T20:49:58Z",
      "updated_at": "2018-03-19T20:50:15Z"
    },
    {
      "author": "bergmeister",
      "author_association": "CONTRIBUTOR",
      "body": "@iSazonov I pulled your branch into my fork, just use my commit [here](https://github.com/bergmeister/PowerShell/commit/cd979b72154dd61daeb5e2d323941592e3c96d3f) to fix the build in your branch.\r\nI think you could cherry-pick it as follows (if it does not work, then just copy-paste the diff)\r\n```sh\r\ngit remote add bergmeister https://github.com/bergmeister/PowerShell.git\r\ngit fetch bergmeister\r\ngit cherry-pick cd979b72154dd61daeb5e2d323941592e3c96d3f\r\n````\r\nI do have to say though that I cannot build the MSI in master locally any more using `New-MsiPackage` as well since the recent compliance work, so I can totally understand your confusion (I had the same errors that you described)",
      "created_at": "2018-03-19T22:17:53Z",
      "updated_at": "2018-03-19T22:23:11Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "Docs are here:  https://github.com/PowerShell/PowerShell/blob/a53547ce7869228407e17a678124b6a4a738d040/docs/maintainers/releasing.md#build-and-packaging-examples\r\n\r\nHere are modified instructions for skipping some of the checks for release to make it a little easier ( `-SkipReleaseChecks` should probably allow a non-release configuration as well):\r\n```\r\nimport-module ./tools/packaging \r\nStart-PSBuild -Clean -CrossGen -PSModuleRestore -Configuration Release -Runtime win7-x86\r\nStart-PSPackage -Type msi -SkipReleaseChecks\r\n```\r\n",
      "created_at": "2018-03-19T22:50:16Z",
      "updated_at": "2018-03-19T22:50:16Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@bergmeister @TravisEz13 Thanks for help - Files.wxs was fixed.",
      "created_at": "2018-03-20T08:42:03Z",
      "updated_at": "2018-03-20T08:42:03Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "@dantraMSFT  Can you review?",
      "created_at": "2018-03-20T18:34:58Z",
      "updated_at": "2018-03-20T18:34:58Z"
    }
  ],
  "created_at": "2017-10-25T14:47:46Z",
  "number": 5229,
  "state": "closed",
  "title": "Add Test-Json cmdlet (NJsonSchema)",
  "updated_at": "2018-03-27T03:24:48Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/6706",
  "author": "dantraMSFT",
  "body": "## PR Summary\r\n\r\nThis changes ensure WSMAN_OPTION_UNENCRYPTED_MESSAGES is set when using Basic auth over HTTP.  On Linux and macOS, not setting this option explicitly fails the connection request.\r\n\r\n## PR Checklist\r\n\r\n- [X] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - Use the present tense and imperative mood when describing your changes\r\n- [X] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [X] [Change is not breaking](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)\r\n- [X] [Make sure all `.h`, `.cpp`, `.cs`, `.ps1` and `.psm1` files have the correct copyright header](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [X] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - If the PR is work in progress, please add the prefix `WIP:` to the beginning of the title and remove the prefix when the PR is ready.\r\n- **User-facing changes**\r\n    - [X] Not Applicable\r\n    - **OR**\r\n    - [ ] User-facing [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n        - [ ] Issue filed - Issue link:https://github.com/PowerShell/psl-omi-provider/issues/114\r\n- **Testing - New and feature**\r\n    - [ ] Not Applicable or can only be tested interactively\r\n    - **OR**\r\n    - [X] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n        - [ ] [Add `[feature]` if the change is significant or affects feature tests](https://github.com/PowerShell/PowerShell/blob/master/docs/testing-guidelines/testing-guidelines.md#requesting-additional-tests-for-a-pr)\r\n",
  "closed_at": "2018-05-03T17:21:37Z",
  "comments": [
    {
      "author": "dantraMSFT",
      "author_association": "CONTRIBUTOR",
      "body": "FYI: The -workingdirectory test failure is being addressed with PR https://github.com/PowerShell/PowerShell/pull/6723",
      "created_at": "2018-04-24T21:55:53Z",
      "updated_at": "2018-04-24T21:55:53Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "I'm concerned about this being enabled by default on Unix.  On Windows, the user needs to enable `AllowUnencrypted` for both the client and server to work and is only intended for developer use.  Basic auth over unencrypted HTTP means the creds are in plain text over the wire.  Seems like we should make the user specify explicitly they are ok with this somehow.",
      "created_at": "2018-04-24T23:54:59Z",
      "updated_at": "2018-04-24T23:54:59Z"
    },
    {
      "author": "dantraMSFT",
      "author_association": "CONTRIBUTOR",
      "body": "@SteveL-MSFT : What do you mean by explicitly opt-in?  Right now, it's not possible at all from Linux because flags are not set appropriately.  of course, it's till not possible from Linux to Windows without configuring the WSMan settings appropriately.\r\n\r\nAre you suggesting that we replace the -UseSLL and have -AllowUnencrypted?",
      "created_at": "2018-04-25T00:21:18Z",
      "updated_at": "2018-04-25T00:21:18Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@dantraMSFT not replace, but perhaps add that switch",
      "created_at": "2018-04-25T01:04:47Z",
      "updated_at": "2018-04-25T01:04:47Z"
    },
    {
      "author": "dantraMSFT",
      "author_association": "CONTRIBUTOR",
      "body": "On Linux, encryption over HTTP is simply not supported and we would need to introduce a breaking change to require an explicit opt-in.  I think there's one of three approaches\r\n\r\n1: The user would have to explicitly select -UseSSL or -AllowUnencrypted since selecting need is an unsupported state.\r\n\r\n2: -UseSSL would need to be the default behavior.\r\n\r\n3: Change OMI to have a policy that needs to be explicitly enabled, such as we have with WSMan::localhost\\Service\\AllowUnencrypted.\r\n",
      "created_at": "2018-04-25T17:19:47Z",
      "updated_at": "2018-04-25T17:19:47Z"
    },
    {
      "author": "paulcallen",
      "author_association": "MEMBER",
      "body": "encryption over HTTP is only supported with Kerberos, NTML and CredSSP (the last one not supported on Linux)",
      "created_at": "2018-04-25T19:47:59Z",
      "updated_at": "2018-04-25T19:47:59Z"
    },
    {
      "author": "dantraMSFT",
      "author_association": "CONTRIBUTOR",
      "body": "Closing due to https://github.com/PowerShell/PowerShell/pull/6787 (Disallow Basic Auth over HTTP on Unix)",
      "created_at": "2018-05-03T17:21:37Z",
      "updated_at": "2018-05-03T17:21:37Z"
    }
  ],
  "created_at": "2018-04-23T21:50:02Z",
  "number": 6706,
  "state": "closed",
  "title": "Set WSMAN_OPTION_UNENCRYPTED_MESSAGES when Basic auth is used over HTTP",
  "updated_at": "2018-05-03T17:21:37Z"
}
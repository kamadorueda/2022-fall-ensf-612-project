{
  "_url": "https://github.com/PowerShell/PowerShell/issues/16116",
  "author": "mklement0",
  "body": "### Prerequisites\r\n\r\n- [X] Write a descriptive title.\r\n- [X] Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\r\n- [X] Search the existing issues.\r\n- [X] Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\r\n- [X] Refer to [Differences between Windows PowerShell 5.1 and PowerShell](https://docs.microsoft.com/powershell/scripting/whats-new/differences-from-windows-powershell).\r\n\r\n### Steps to reproduce\r\n\r\nPossibly related: #8931\r\n\r\nThe purpose of `Get-Command -All` is to allow discovery of _shadowed_ commands, i.e. those available in principle, but preempted by a different command of the same name with higher precedence.\r\n\r\nWhile `Get-Command` without `-All` includes commands from modules that are _available via module auto-loading_, even if those modules are not _currently loaded_ (imported), using `-All` unexpectedly excludes commands from non-loaded modules.\r\n\r\n\r\n\r\n```powershell\r\n# Make sure that module  Microsoft.PowerShell.Archive isn't loaded.\r\nRemove-Module -ErrorAction Ignore Microsoft.PowerShell.Archive\r\n\r\n# OK, without -All: the Expand-Archive function is discovered even without its module being loaded.\r\n' -- Without -All'\r\nGet-Command Expand-Archive | Out-Host\r\n\r\n# Define a dummy function that shadows the one from the Microsoft.PowerShell.Archive module.\r\nfunction Expand-Archive { 'psych!' }\r\n\r\n' -- With -All'\r\n# Now try to discover *both* functions, using -All\r\nGet-Command -All Expand-Archive | Out-Host\r\n```\r\n\r\n\r\n### Expected behavior\r\n\r\n```console\r\n-- Without -All\r\n\r\nCommandType     Name                                               Version    Source\r\n-----------     ----                                               -------    ------\r\nFunction        Expand-Archive                                     1.2.5      Microsoft.PowerShell.Archive\r\n\r\n -- With -All\r\n\r\nCommandType     Name                                               Version    Source\r\n-----------     ----                                               -------    ------\r\nFunction        Expand-Archive\r\nFunction        Expand-Archive                                     1.2.5      Microsoft.PowerShell.Archive\r\n```\r\n\r\n\r\n### Actual behavior\r\n\r\n```console\r\n-- Without -All\r\n\r\nCommandType     Name                                               Version    Source\r\n-----------     ----                                               -------    ------\r\nFunction        Expand-Archive                                     1.2.5      Microsoft.PowerShell.Archive\r\n\r\n -- With -All\r\n\r\nCommandType     Name                                               Version    Source\r\n-----------     ----                                               -------    ------\r\nFunction        Expand-Archive\r\n```\r\n\r\nNote how the _available_ - but not loaded - `Export-Archive` function from the `Microsoft.PowerShell.Archive` module is now missing.\r\n\r\n### Error details\r\n\r\n_No response_\r\n\r\n### Environment data\r\n\r\n```powershell\r\nPowerShell Core 7.2.0-preview.9\r\n```\r\n\r\n\r\n### Visuals\r\n\r\n_No response_",
  "closed_at": null,
  "comments": [],
  "created_at": "2021-09-16T20:17:04Z",
  "number": 16116,
  "state": "open",
  "title": "Get-Command -All only considers loaded commands, not also available ones",
  "updated_at": "2021-09-17T05:44:40Z"
}
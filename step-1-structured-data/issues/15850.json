{
  "_url": "https://github.com/PowerShell/PowerShell/issues/15850",
  "author": "amonzerol",
  "body": "### Prerequisites\n\n- [X] Write a descriptive title.\n- [X] Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\n- [X] Search the existing issues.\n- [X] Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\n- [X] Refer to [Differences between Windows PowerShell 5.1 and PowerShell](https://docs.microsoft.com/powershell/scripting/whats-new/differences-from-windows-powershell).\n\n### Steps to reproduce\n\nWe are currently running Linux Powershell with Snap on LTS (7.0.6), but I've been able to reproduce this issue on 7.1.3.\r\n\r\nWe used to be able to run `Get-CsOnlineUser` with filters on boolean values so it doesn't return the whole directory, but that **sporadically** doesn't work anymore. Sometimes when we kill the Powershell process and restart it + connect to Microsoft Teams it works, sometimes it doesn't.\r\n\r\nThis is what we've been running:\r\n\r\n```\r\nPS /home/antoine/dev/projects/smacs> Get-CsOnlineUser -Filter {Enabled -eq $True}\r\nGet-CsOnlineUser: Cannot bind parameter 'Filter' to the target. Exception setting \"Filter\": \"Unable to cast object of type 'System.Boolean' to type 'System.String'.\"\r\n```\r\nor\r\n\r\n```\r\nPS /home/antoine/dev/projects/smacs> Get-CsOnlineUser -Filter {EnterpriseVoiceEnabled -eq $True}                              \r\nGet-CsOnlineUser: Cannot bind parameter 'Filter' to the target. Exception setting \"Filter\": \"Unable to cast object of type 'System.Boolean' to type 'System.String'.\"\r\n```\n\n### Expected behavior\n\n```console\nPS /home/antoine/dev/projects/smacs> Get-CsOnlineUser -Filter {Enabled -eq $True}\r\n\r\nReturns a list of Enabled SfB users.\n```\n\n\n### Actual behavior\n\n```console\nPS /home/antoine/dev/projects/smacs> Get-CsOnlineUser -Filter {Enabled -eq $True}\r\nGet-CsOnlineUser: Cannot bind parameter 'Filter' to the target. Exception setting \"Filter\": \"Unable to cast object of type 'System.Boolean' to type 'System.String'.\"\n```\n\n\n### Error details\n\n```console\nPS /home/antoine/dev/projects/smacs> Get-Error\r\n\r\nOriginInfo            : api.interfaces.records.teams.microsoft.com\r\nException             : \r\n    Type                           : System.Management.Automation.RemoteException\r\n    SerializedRemoteException      : System.Management.Automation.ParameterBindingException: Cannot bind parameter 'Filter' to the target. Exception setting \"Filter\": \"Unable to cast object of type 'System.Boolean' to type 'System.String'.\" ---> \r\nSystem.Management.Automation.SetValueInvocationException: Exception setting \"Filter\": \"Unable to cast object of type 'System.Boolean' to type 'System.String'.\" ---> System.InvalidCastException: Unable to cast object of type 'System.Boolean' to type 'System.String'.\r\n                                     at Microsoft.Rtc.Management.AD.GetADObjectWithIdentityTask`2.<>c__DisplayClass17_0.<CreateFilter>b__0(ComparisonOperator op, PropertyDefinition propDef, Object val, Boolean useWildchars)\r\n                                     at Microsoft.Rtc.Management.ADConnect.Filter.QueryParser.CreateRelationalExpression(ComparisonOperator op, String prop, Object val, Boolean useWildchars)\r\n                                     at Microsoft.Rtc.Management.ADConnect.Filter.QueryParser.yyparse()\r\n                                     at Microsoft.Rtc.Management.ADConnect.Filter.MonadFilter..ctor(String filterText, PSCmdlet cmdlet, ObjectSchema schema, CreateRelationalExpressionDelegate expressionDelegate, Capabilities capabilities)\r\n                                     at Microsoft.Rtc.Management.AD.GetADObjectWithIdentityTask`2.CreateFilter(String filterText, PSCmdlet cmdlet, ObjectSchema schema, HashSet`1& returnMentionedTenants)\r\n                                     at Microsoft.Rtc.Management.AD.Cmdlets.GetOcsUserCmdlet.set_Filter(String value)\r\n                                     at System.Management.Automation.ReflectionParameterBinder.BindParameter(String name, Object value, CompiledCommandParameter parameterMetadata)\r\n                                     --- End of inner exception stack trace ---\r\n                                     at System.Management.Automation.ReflectionParameterBinder.BindParameter(String name, Object value, CompiledCommandParameter parameterMetadata)\r\n                                     at System.Management.Automation.ParameterBinderBase.BindParameter(CommandParameterInternal parameter, CompiledCommandParameter parameterMetadata, ParameterBindingFlags flags)\r\n                                     --- End of inner exception stack trace ---\r\n                                     at System.Management.Automation.ParameterBinderBase.BindParameter(CommandParameterInternal parameter, CompiledCommandParameter parameterMetadata, ParameterBindingFlags flags)\r\n                                     at System.Management.Automation.CmdletParameterBinderController.BindParameter(CommandParameterInternal argument, MergedCompiledCommandParameter parameter, ParameterBindingFlags flags)\r\n                                     at System.Management.Automation.CmdletParameterBinderController.BindParameter(UInt32 parameterSets, CommandParameterInternal argument, MergedCompiledCommandParameter parameter, ParameterBindingFlags flags)\r\n                                     at System.Management.Automation.CmdletParameterBinderController.BindParameters(UInt32 parameterSets, Collection`1 arguments)\r\n                                     at System.Management.Automation.CmdletParameterBinderController.BindCommandLineParametersNoValidation(Collection`1 arguments)\r\n                                     at System.Management.Automation.CmdletParameterBinderController.BindCommandLineParameters(Collection`1 arguments)\r\n                                     at System.Management.Automation.CommandProcessor.BindCommandLineParameters()\r\n                                     at System.Management.Automation.CommandProcessorBase.DoPrepare(IDictionary psDefaultParameterValues)\r\n                                     at System.Management.Automation.Internal.PipelineProcessor.Start(Boolean incomingStream)\r\n                                     at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)\r\n                                     --- End of stack trace from previous location where exception was thrown ---\r\n                                     at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n                                     at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)\r\n                                     at System.Management.Automation.Runspaces.LocalPipeline.InvokeHelper()\r\n                                     at System.Management.Automation.Runspaces.LocalPipeline.InvokeThreadProc()\r\n    SerializedRemoteInvocationInfo : System.Management.Automation.InvocationInfo\r\n    ErrorRecord                    : \r\n        Exception             : \r\n            Type                           : System.Management.Automation.RemoteException\r\n            SerializedRemoteException      : System.Management.Automation.ParameterBindingException: Cannot bind parameter 'Filter' to the target. Exception setting \"Filter\": \"Unable to cast object of type 'System.Boolean' to type 'System.String'.\" ---> \r\nSystem.Management.Automation.SetValueInvocationException: Exception setting \"Filter\": \"Unable to cast object of type 'System.Boolean' to type 'System.String'.\" ---> System.InvalidCastException: Unable to cast object of type 'System.Boolean' to type 'System.String'.\r\n                                             at Microsoft.Rtc.Management.AD.GetADObjectWithIdentityTask`2.<>c__DisplayClass17_0.<CreateFilter>b__0(ComparisonOperator op, PropertyDefinition propDef, Object val, Boolean useWildchars)\r\n                                             at Microsoft.Rtc.Management.ADConnect.Filter.QueryParser.CreateRelationalExpression(ComparisonOperator op, String prop, Object val, Boolean useWildchars)\r\n                                             at Microsoft.Rtc.Management.ADConnect.Filter.QueryParser.yyparse()\r\n                                             at Microsoft.Rtc.Management.ADConnect.Filter.MonadFilter..ctor(String filterText, PSCmdlet cmdlet, ObjectSchema schema, CreateRelationalExpressionDelegate expressionDelegate, Capabilities capabilities)\r\n                                             at Microsoft.Rtc.Management.AD.GetADObjectWithIdentityTask`2.CreateFilter(String filterText, PSCmdlet cmdlet, ObjectSchema schema, HashSet`1& returnMentionedTenants)\r\n                                             at Microsoft.Rtc.Management.AD.Cmdlets.GetOcsUserCmdlet.set_Filter(String value)\r\n                                             at System.Management.Automation.ReflectionParameterBinder.BindParameter(String name, Object value, CompiledCommandParameter parameterMetadata)\r\n                                             --- End of inner exception stack trace ---\r\n                                             at System.Management.Automation.ReflectionParameterBinder.BindParameter(String name, Object value, CompiledCommandParameter parameterMetadata)\r\n                                             at System.Management.Automation.ParameterBinderBase.BindParameter(CommandParameterInternal parameter, CompiledCommandParameter parameterMetadata, ParameterBindingFlags flags)\r\n                                             --- End of inner exception stack trace ---\r\n                                             at System.Management.Automation.ParameterBinderBase.BindParameter(CommandParameterInternal parameter, CompiledCommandParameter parameterMetadata, ParameterBindingFlags flags)\r\n                                             at System.Management.Automation.CmdletParameterBinderController.BindParameter(CommandParameterInternal argument, MergedCompiledCommandParameter parameter, ParameterBindingFlags flags)\r\n                                             at System.Management.Automation.CmdletParameterBinderController.BindParameter(UInt32 parameterSets, CommandParameterInternal argument, MergedCompiledCommandParameter parameter, ParameterBindingFlags flags)\r\n                                             at System.Management.Automation.CmdletParameterBinderController.BindParameters(UInt32 parameterSets, Collection`1 arguments)\r\n                                             at System.Management.Automation.CmdletParameterBinderController.BindCommandLineParametersNoValidation(Collection`1 arguments)\r\n                                             at System.Management.Automation.CmdletParameterBinderController.BindCommandLineParameters(Collection`1 arguments)\r\n                                             at System.Management.Automation.CommandProcessor.BindCommandLineParameters()\r\n                                             at System.Management.Automation.CommandProcessorBase.DoPrepare(IDictionary psDefaultParameterValues)\r\n                                             at System.Management.Automation.Internal.PipelineProcessor.Start(Boolean incomingStream)\r\n                                             at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)\r\n                                             --- End of stack trace from previous location where exception was thrown ---\r\n                                             at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n                                             at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)\r\n                                             at System.Management.Automation.Runspaces.LocalPipeline.InvokeHelper()\r\n                                             at System.Management.Automation.Runspaces.LocalPipeline.InvokeThreadProc()\r\n            SerializedRemoteInvocationInfo : System.Management.Automation.InvocationInfo\r\n            ErrorRecord                    : \r\n                Exception             : \r\n                    Type                           : System.Management.Automation.RemoteException\r\n                    SerializedRemoteException      : System.Management.Automation.ParameterBindingException: Cannot bind parameter 'Filter' to the target. Exception setting \"Filter\": \"Unable to cast object of type 'System.Boolean' to type 'System.String'.\" ---> \r\nSystem.Management.Automation.SetValueInvocationException: Exception setting \"Filter\": \"Unable to cast object of type 'System.Boolean' to type 'System.String'.\" ---> System.InvalidCastException: Unable to cast object of type 'System.Boolean' to type 'System.String'.\r\n                                                     at Microsoft.Rtc.Management.AD.GetADObjectWithIdentityTask`2.<>c__DisplayClass17_0.<CreateFilter>b__0(ComparisonOperator op, PropertyDefinition propDef, Object val, Boolean useWildchars)\r\n                                                     at Microsoft.Rtc.Management.ADConnect.Filter.QueryParser.CreateRelationalExpression(ComparisonOperator op, String prop, Object val, Boolean useWildchars)\r\n                                                     at Microsoft.Rtc.Management.ADConnect.Filter.QueryParser.yyparse()\r\n                                                     at Microsoft.Rtc.Management.ADConnect.Filter.MonadFilter..ctor(String filterText, PSCmdlet cmdlet, ObjectSchema schema, CreateRelationalExpressionDelegate expressionDelegate, Capabilities capabilities)\r\n                                                     at Microsoft.Rtc.Management.AD.GetADObjectWithIdentityTask`2.CreateFilter(String filterText, PSCmdlet cmdlet, ObjectSchema schema, HashSet`1& returnMentionedTenants)\r\n                                                     at Microsoft.Rtc.Management.AD.Cmdlets.GetOcsUserCmdlet.set_Filter(String value)\r\n                                                     at System.Management.Automation.ReflectionParameterBinder.BindParameter(String name, Object value, CompiledCommandParameter parameterMetadata)\r\n                                                     --- End of inner exception stack trace ---\r\n                                                     at System.Management.Automation.ReflectionParameterBinder.BindParameter(String name, Object value, CompiledCommandParameter parameterMetadata)\r\n                                                     at System.Management.Automation.ParameterBinderBase.BindParameter(CommandParameterInternal parameter, CompiledCommandParameter parameterMetadata, ParameterBindingFlags flags)\r\n                                                     --- End of inner exception stack trace ---\r\n                                                     at System.Management.Automation.ParameterBinderBase.BindParameter(CommandParameterInternal parameter, CompiledCommandParameter parameterMetadata, ParameterBindingFlags flags)\r\n                                                     at System.Management.Automation.CmdletParameterBinderController.BindParameter(CommandParameterInternal argument, MergedCompiledCommandParameter parameter, ParameterBindingFlags flags)\r\n                                                     at System.Management.Automation.CmdletParameterBinderController.BindParameter(UInt32 parameterSets, CommandParameterInternal argument, MergedCompiledCommandParameter parameter, ParameterBindingFlags flags)\r\n                                                     at System.Management.Automation.CmdletParameterBinderController.BindParameters(UInt32 parameterSets, Collection`1 arguments)\r\n                                                     at System.Management.Automation.CmdletParameterBinderController.BindCommandLineParametersNoValidation(Collection`1 arguments)\r\n                                                     at System.Management.Automation.CmdletParameterBinderController.BindCommandLineParameters(Collection`1 arguments)\r\n                                                     at System.Management.Automation.CommandProcessor.BindCommandLineParameters()\r\n                                                     at System.Management.Automation.CommandProcessorBase.DoPrepare(IDictionary psDefaultParameterValues)\r\n                                                     at System.Management.Automation.Internal.PipelineProcessor.Start(Boolean incomingStream)\r\n                                                     at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)\r\n                                                     --- End of stack trace from previous location where exception was thrown ---\r\n                                                     at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n                                                     at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)\r\n                                                     at System.Management.Automation.Runspaces.LocalPipeline.InvokeHelper()\r\n                                                     at System.Management.Automation.Runspaces.LocalPipeline.InvokeThreadProc()\r\n                    SerializedRemoteInvocationInfo : System.Management.Automation.InvocationInfo\r\n                    ErrorRecord                    : \r\n                        Exception             : \r\n                            Type                           : System.Management.Automation.RemoteException\r\n                            SerializedRemoteException      : System.Management.Automation.ParameterBindingException: Cannot bind parameter 'Filter' to the target. Exception setting \"Filter\": \"Unable to cast object of type 'System.Boolean' to type 'System.String'.\" ---> \r\nSystem.Management.Automation.SetValueInvocationException: Exception setting \"Filter\": \"Unable to cast object of type 'System.Boolean' to type 'System.String'.\" ---> System.InvalidCastException: Unable to cast object of type 'System.Boolean' to type 'System.String'.\r\n                                                             at Microsoft.Rtc.Management.AD.GetADObjectWithIdentityTask`2.<>c__DisplayClass17_0.<CreateFilter>b__0(ComparisonOperator op, PropertyDefinition propDef, Object val, Boolean useWildchars)\r\n                                                             at Microsoft.Rtc.Management.ADConnect.Filter.QueryParser.CreateRelationalExpression(ComparisonOperator op, String prop, Object val, Boolean useWildchars)\r\n                                                             at Microsoft.Rtc.Management.ADConnect.Filter.QueryParser.yyparse()\r\n                                                             at Microsoft.Rtc.Management.ADConnect.Filter.MonadFilter..ctor(String filterText, PSCmdlet cmdlet, ObjectSchema schema, CreateRelationalExpressionDelegate expressionDelegate, Capabilities capabilities)\r\n                                                             at Microsoft.Rtc.Management.AD.GetADObjectWithIdentityTask`2.CreateFilter(String filterText, PSCmdlet cmdlet, ObjectSchema schema, HashSet`1& returnMentionedTenants)\r\n                                                             at Microsoft.Rtc.Management.AD.Cmdlets.GetOcsUserCmdlet.set_Filter(String value)\r\n                                                             at System.Management.Automation.ReflectionParameterBinder.BindParameter(String name, Object value, CompiledCommandParameter parameterMetadata)\r\n                                                             --- End of inner exception stack trace ---\r\n                                                             at System.Management.Automation.ReflectionParameterBinder.BindParameter(String name, Object value, CompiledCommandParameter parameterMetadata)\r\n                                                             at System.Management.Automation.ParameterBinderBase.BindParameter(CommandParameterInternal parameter, CompiledCommandParameter parameterMetadata, ParameterBindingFlags flags)\r\n                                                             --- End of inner exception stack trace ---\r\n                                                             at System.Management.Automation.ParameterBinderBase.BindParameter(CommandParameterInternal parameter, CompiledCommandParameter parameterMetadata, ParameterBindingFlags flags)\r\n                                                             at System.Management.Automation.CmdletParameterBinderController.BindParameter(CommandParameterInternal argument, MergedCompiledCommandParameter parameter, ParameterBindingFlags flags)\r\n                                                             at System.Management.Automation.CmdletParameterBinderController.BindParameter(UInt32 parameterSets, CommandParameterInternal argument, MergedCompiledCommandParameter parameter, ParameterBindingFlags flags)\r\n                                                             at System.Management.Automation.CmdletParameterBinderController.BindParameters(UInt32 parameterSets, Collection`1 arguments)\r\n                                                             at System.Management.Automation.CmdletParameterBinderController.BindCommandLineParametersNoValidation(Collection`1 arguments)\r\n                                                             at System.Management.Automation.CmdletParameterBinderController.BindCommandLineParameters(Collection`1 arguments)\r\n                                                             at System.Management.Automation.CommandProcessor.BindCommandLineParameters()\r\n                                                             at System.Management.Automation.CommandProcessorBase.DoPrepare(IDictionary psDefaultParameterValues)\r\n                                                             at System.Management.Automation.Internal.PipelineProcessor.Start(Boolean incomingStream)\r\n                                                             at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)\r\n                                                             --- End of stack trace from previous location where exception was thrown ---\r\n                                                             at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n                                                             at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)\r\n                                                             at System.Management.Automation.Runspaces.LocalPipeline.InvokeHelper()\r\n                                                             at System.Management.Automation.Runspaces.LocalPipeline.InvokeThreadProc()\r\n                            SerializedRemoteInvocationInfo : System.Management.Automation.InvocationInfo\r\n                            ErrorRecord                    : \r\n                                Exception             : \r\n                                    Type                           : System.Management.Automation.RemoteException\r\n                                    SerializedRemoteException      : System.Management.Automation.ParameterBindingException: Cannot bind parameter 'Filter' to the target. Exception setting \"Filter\": \"Unable to cast object of type 'System.Boolean' to type 'System.String'.\" \r\n---> System.Management.Automation.SetValueInvocationException: Exception setting \"Filter\": \"Unable to cast object of type 'System.Boolean' to type 'System.String'.\" ---> System.InvalidCastException: Unable to cast object of type 'System.Boolean' to type 'System.String'.\r\n                                                                     at Microsoft.Rtc.Management.AD.GetADObjectWithIdentityTask`2.<>c__DisplayClass17_0.<CreateFilter>b__0(ComparisonOperator op, PropertyDefinition propDef, Object val, Boolean useWildchars)\r\n                                                                     at Microsoft.Rtc.Management.ADConnect.Filter.QueryParser.CreateRelationalExpression(ComparisonOperator op, String prop, Object val, Boolean useWildchars)\r\n                                                                     at Microsoft.Rtc.Management.ADConnect.Filter.QueryParser.yyparse()\r\n                                                                     at Microsoft.Rtc.Management.ADConnect.Filter.MonadFilter..ctor(String filterText, PSCmdlet cmdlet, ObjectSchema schema, CreateRelationalExpressionDelegate expressionDelegate, Capabilities capabilities)\r\n                                                                     at Microsoft.Rtc.Management.AD.GetADObjectWithIdentityTask`2.CreateFilter(String filterText, PSCmdlet cmdlet, ObjectSchema schema, HashSet`1& returnMentionedTenants)\r\n                                                                     at Microsoft.Rtc.Management.AD.Cmdlets.GetOcsUserCmdlet.set_Filter(String value)\r\n                                                                     at System.Management.Automation.ReflectionParameterBinder.BindParameter(String name, Object value, CompiledCommandParameter parameterMetadata)\r\n                                                                     --- End of inner exception stack trace ---\r\n                                                                     at System.Management.Automation.ReflectionParameterBinder.BindParameter(String name, Object value, CompiledCommandParameter parameterMetadata)\r\n                                                                     at System.Management.Automation.ParameterBinderBase.BindParameter(CommandParameterInternal parameter, CompiledCommandParameter parameterMetadata, ParameterBindingFlags flags)\r\n                                                                     --- End of inner exception stack trace ---\r\n                                                                     at System.Management.Automation.ParameterBinderBase.BindParameter(CommandParameterInternal parameter, CompiledCommandParameter parameterMetadata, ParameterBindingFlags flags)\r\n                                                                     at System.Management.Automation.CmdletParameterBinderController.BindParameter(CommandParameterInternal argument, MergedCompiledCommandParameter parameter, ParameterBindingFlags flags)\r\n                                                                     at System.Management.Automation.CmdletParameterBinderController.BindParameter(UInt32 parameterSets, CommandParameterInternal argument, MergedCompiledCommandParameter parameter, ParameterBindingFlags flags)\r\n                                                                     at System.Management.Automation.CmdletParameterBinderController.BindParameters(UInt32 parameterSets, Collection`1 arguments)\r\n                                                                     at System.Management.Automation.CmdletParameterBinderController.BindCommandLineParametersNoValidation(Collection`1 arguments)\r\n                                                                     at System.Management.Automation.CmdletParameterBinderController.BindCommandLineParameters(Collection`1 arguments)\r\n                                                                     at System.Management.Automation.CommandProcessor.BindCommandLineParameters()\r\n                                                                     at System.Management.Automation.CommandProcessorBase.DoPrepare(IDictionary psDefaultParameterValues)\r\n                                                                     at System.Management.Automation.Internal.PipelineProcessor.Start(Boolean incomingStream)\r\n                                                                     at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)\r\n                                                                     --- End of stack trace from previous location where exception was thrown ---\r\n                                                                     at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n                                                                     at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)\r\n                                                                     at System.Management.Automation.Runspaces.LocalPipeline.InvokeHelper()\r\n                                                                     at System.Management.Automation.Runspaces.LocalPipeline.InvokeThreadProc()\r\n                                    SerializedRemoteInvocationInfo : System.Management.Automation.InvocationInfo\r\n                                    ErrorRecord                    : \u2026\r\n                                    Message                        : Cannot bind parameter 'Filter' to the target. Exception setting \"Filter\": \"Unable to cast object of type 'System.Boolean' to type 'System.String'.\"\r\n                                    HResult                        : -2146233087\r\n                                CategoryInfo          : WriteError: (:) [Get-CsOnlineUser], ParameterBindingException\r\n                                FullyQualifiedErrorId : ParameterBindingFailed,Microsoft.Rtc.Management.AD.Cmdlets.GetOcsUserCmdlet\r\n                            Message                        : Cannot bind parameter 'Filter' to the target. Exception setting \"Filter\": \"Unable to cast object of type 'System.Boolean' to type 'System.String'.\"\r\n                            HResult                        : -2146233087\r\n                        CategoryInfo          : WriteError: (:) [Get-CsOnlineUser], ParameterBindingException\r\n                        FullyQualifiedErrorId : ParameterBindingFailed,Microsoft.Rtc.Management.AD.Cmdlets.GetOcsUserCmdlet\r\n                    Message                        : Cannot bind parameter 'Filter' to the target. Exception setting \"Filter\": \"Unable to cast object of type 'System.Boolean' to type 'System.String'.\"\r\n                    HResult                        : -2146233087\r\n                CategoryInfo          : WriteError: (:) [Get-CsOnlineUser], ParameterBindingException\r\n                FullyQualifiedErrorId : ParameterBindingFailed,Microsoft.Rtc.Management.AD.Cmdlets.GetOcsUserCmdlet\r\n            Message                        : Cannot bind parameter 'Filter' to the target. Exception setting \"Filter\": \"Unable to cast object of type 'System.Boolean' to type 'System.String'.\"\r\n            HResult                        : -2146233087\r\n        CategoryInfo          : WriteError: (:) [Get-CsOnlineUser], ParameterBindingException\r\n        FullyQualifiedErrorId : ParameterBindingFailed,Microsoft.Rtc.Management.AD.Cmdlets.GetOcsUserCmdlet\r\n    Message                        : Cannot bind parameter 'Filter' to the target. Exception setting \"Filter\": \"Unable to cast object of type 'System.Boolean' to type 'System.String'.\"\r\n    HResult                        : -2146233087\r\nCategoryInfo          : WriteError: (:) [Get-CsOnlineUser], ParameterBindingException\r\nFullyQualifiedErrorId : ParameterBindingFailed,Microsoft.Rtc.Management.AD.Cmdlets.GetOcsUserCmdlet\n```\n\n\n### Environment data\n\n```powershell\nPS /home/antoine/dev/projects/smacs> $PSVersionTable                             \r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.0.6\r\nPSEdition                      Core\r\nGitCommitId                    7.0.6\r\nOS                             Linux 5.4.0-80-generic #90~18.04.1-Ubuntu SMP Tue Jul 13 19:40:02 UTC 2021\r\nPlatform                       Unix\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\n```\n\n\n### Visuals\n\n```\r\n**********************\r\nPowerShell transcript start\r\nStart time: 20210730155116\r\nUsername: antoine-ThinkPad-T480s\\antoine\r\nRunAs User: antoine-ThinkPad-T480s\\antoine\r\nConfiguration Name: \r\nMachine: antoine-ThinkPad-T480s (Unix 5.4.0.80)\r\nHost Application: /snap/powershell/161/opt/powershell/pwsh.dll\r\nProcess ID: 23116\r\nPSVersion: 7.0.6\r\nPSEdition: Core\r\nGitCommitId: 7.0.6\r\nOS: Linux 5.4.0-80-generic #90~18.04.1-Ubuntu SMP Tue Jul 13 19:40:02 UTC 2021\r\nPlatform: Unix\r\nPSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.10032.0, 6.0.0, 6.1.0, 6.2.0, 7.0.6\r\nPSRemotingProtocolVersion: 2.3\r\nSerializationVersion: 1.1.0.1\r\nWSManStackVersion: 3.0\r\n**********************\r\nTranscript started, output file is /home/antoine/PowerShell_transcript.antoine-ThinkPad-T480s.GKliE+qs.20210730155116.txt\r\nPS /home/antoine/dev/projects/smacs> $creds = Get-Credential\r\nPS /home/antoine/dev/projects/smacs> Connect-MicrosoftTeams -Credential $creds\r\n\r\nAccount                  Environment Tenant                               TenantId\r\n-------                  ----------- ------                               --------\r\namonzerol@dev-stack8.com AzureCloud  0d64725c-6eea-4ee0-a981-538ef9a5a0b4 0d64725c-6eea-4ee0-a981-538ef9a5a0b4\r\n\r\nPS /home/antoine/dev/projects/smacs> Get-CsOnlineUser -Filter {Enabled -eq $True}\r\n\r\nGet-CsOnlineUser: Cannot bind parameter 'Filter' to the target. Exception setting \"Filter\": \"Unable to cast object of type 'System.Boolean' to type 'System.String'.\"\r\n\r\n\u001b[91mGet-CsOnlineUser: \u001b[91mCannot bind parameter 'Filter' to the target. Exception setting \"Filter\": \"Unable to cast object of type 'System.Boolean' to type 'System.String'.\"\u001b[0m\r\nPS /home/antoine/dev/projects/smacs> Stop-Transcript\r\n**********************\r\nPowerShell transcript end\r\nEnd time: 20210730155153\r\n**********************\r\n```",
  "closed_at": "2021-08-01T13:00:34Z",
  "comments": [
    {
      "author": "amonzerol",
      "author_association": "NONE",
      "body": "It seems like the filter does work on some booleans and some dosen't:\r\n\r\n![image](https://user-images.githubusercontent.com/39344707/127709151-19ea871a-fac8-48ef-bbde-6879a5d161c2.png)\r\n",
      "created_at": "2021-07-30T20:18:50Z",
      "updated_at": "2021-07-30T20:37:36Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "The cmdlet is not in the repository and we can do nothing here.\r\n\r\nPlease use Teams feedback channels to report the issue.",
      "created_at": "2021-07-31T12:18:53Z",
      "updated_at": "2021-07-31T12:18:53Z"
    },
    {
      "author": "msftbot[bot]",
      "author_association": "NONE",
      "body": "This issue has been marked as external and has not had any activity for **1 day**. It has been be closed for housekeeping purposes.",
      "created_at": "2021-08-01T13:00:33Z",
      "updated_at": "2021-08-01T13:00:33Z"
    }
  ],
  "created_at": "2021-07-30T20:15:58Z",
  "number": 15850,
  "state": "closed",
  "title": "Get-CsOnlineUser with -Filter on boolean sporadically fails",
  "updated_at": "2021-08-01T13:00:34Z"
}
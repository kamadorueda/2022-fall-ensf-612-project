{
  "_url": "https://github.com/PowerShell/PowerShell/issues/4259",
  "author": "SteveL-MSFT",
  "body": "MSI only works against A.B.C type version strings.  So to enable beta.X to beta.X+1 upgrades, we have to use the `AllowSameVersionUpgrades` as they are all effectively 6.0.0 from MSI point of view.\r\n\r\nNote that to get Wix toolset working on Win10, you may have to pass `-sval` to light.exe.\r\n\r\nFix https://github.com/PowerShell/PowerShell/issues/3946",
  "closed_at": "2017-07-17T18:12:37Z",
  "comments": [
    {
      "author": "raghushantha",
      "author_association": "MEMBER",
      "body": "@SteveL-MSFT Changes look good. The only thing is to watch out for is that the 'ProductGuid' needs to be the same if you need upgrade to be supported.\r\n\r\nFor major version changes, ProductGuid can be changed",
      "created_at": "2017-07-17T16:23:42Z",
      "updated_at": "2017-07-17T16:23:42Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@raghushantha currently, `Start-PSPackage` has a default static `ProductGuid` so we should be good there.",
      "created_at": "2017-07-17T17:23:58Z",
      "updated_at": "2017-07-17T17:23:58Z"
    },
    {
      "author": "ChristophB125",
      "author_association": "NONE",
      "body": "@SteveL-MSFT or @raghushantha  It's great to have upgradability support but does this mean that we lose the ability of having multiple version installed side-by-side? We use older versions of PowerShell Core in our CI system (that is locked down and therefore not updated unless needed) and I always found it handy being able to repro on my local machine using the same version that is being used in CI in order to replicate the exact same behaviour.",
      "created_at": "2017-07-18T12:17:17Z",
      "updated_at": "2017-07-18T12:17:17Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@ChristophB125 You can still have side-by-side by downloading the zip and extracting the contents in a secure location (this will always be supported).  ",
      "created_at": "2017-07-18T16:34:36Z",
      "updated_at": "2017-07-18T16:34:36Z"
    },
    {
      "author": "ChristophB125",
      "author_association": "NONE",
      "body": "Thanks for the info. The self contained version in a zip file should be sufficient for our use case.",
      "created_at": "2017-07-20T15:42:14Z",
      "updated_at": "2017-07-20T15:42:14Z"
    }
  ],
  "created_at": "2017-07-14T21:29:59Z",
  "number": 4259,
  "state": "closed",
  "title": "Enable MSI upgrades rather than side-by-side install",
  "updated_at": "2017-07-20T15:42:14Z"
}
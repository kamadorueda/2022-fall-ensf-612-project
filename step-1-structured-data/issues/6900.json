{
  "_url": "https://github.com/PowerShell/PowerShell/issues/6900",
  "author": "austin987",
  "body": "I'm trying to extract the 32-bit windows build of powershell to use under Wine. Extracting with unzip gives an exit code of 1, with no errors and only one warning:\r\n`warning:  /home/austin/.cache/winetricks/powershell/PowerShell-6.1.0-preview.2-win-x86.zip appears to use backslashes as path separators`\r\n\r\nTrying with Windows 7zip  (under Wine), gives a more helpful error:\r\n```\r\nExecuting wine C:\\Program Files\\7-Zip\\7z.exe x Y:\\powershell\\PowerShell-6.1.0-preview.2-win-x86.zip -oC:\\Program Files\\Powershell\r\n\r\n7-Zip [32] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21\r\n\r\nScanning the drive for archives:\r\n1 file, 48691462 bytes (47 MiB)\r\n\r\nExtracting archive: Y:\\powershell\\PowerShell-6.1.0-preview.2-win-x86.zip\r\n--\r\nPath = Y:\\powershell\\PowerShell-6.1.0-preview.2-win-x86.zip\r\nType = zip\r\nPhysical Size = 48691462\r\n\r\n    \r\nWould you like to replace the existing file:\r\n  Path:     C:\\Program Files\\Powershell\\assets\\Powershell_av_colors.ico\r\n  Size:     120737 bytes (118 KiB)\r\n  Modified: 2018-04-25 17:10:52\r\nwith the file from archive:\r\n  Path:     assets\\Powershell_av_colors.ico\r\n  Size:     120737 bytes (118 KiB)\r\n  Modified: 2018-04-25 17:10:52\r\n? (Y)es / (N)o / (A)lways / (S)kip all / A(u)to rename all / (Q)uit? a    \r\n\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\Microsoft.PowerShell.Archive\\1.1.0.0\\Microsoft.PowerShell.Archive.cat\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\Microsoft.PowerShell.Archive\\1.1.0.0\\Microsoft.PowerShell.Archive.psd1\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\Microsoft.PowerShell.Archive\\1.1.0.0\\Microsoft.PowerShell.Archive.psm1\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\Microsoft.PowerShell.Archive\\1.1.0.0\\en-US\\ArchiveResources.psd1\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\PackageManagement.cat\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\PackageManagement.format.ps1xml\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\PackageManagement.psd1\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\PackageManagement.psm1\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\PackageManagement.Resources.psd1\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\PackageProviderFunctions.psm1\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\coreclr\\netcoreapp2.0\\Microsoft.PackageManagement.ArchiverProviders.dll\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\coreclr\\netcoreapp2.0\\Microsoft.PackageManagement.CoreProviders.dll\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\coreclr\\netcoreapp2.0\\Microsoft.PackageManagement.dll\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\coreclr\\netcoreapp2.0\\Microsoft.PackageManagement.MetaProvider.PowerShell.dll\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\coreclr\\netcoreapp2.0\\Microsoft.PackageManagement.NuGetProvider.dll\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\coreclr\\netcoreapp2.0\\Microsoft.PowerShell.PackageManagement.dll\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\coreclr\\netstandard1.6\\Microsoft.PackageManagement.ArchiverProviders.dll\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\coreclr\\netstandard1.6\\Microsoft.PackageManagement.CoreProviders.dll\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\coreclr\\netstandard1.6\\Microsoft.PackageManagement.dll\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\coreclr\\netstandard1.6\\Microsoft.PackageManagement.MetaProvider.PowerShell.dll\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\coreclr\\netstandard1.6\\Microsoft.PackageManagement.NuGetProvider.dll\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\coreclr\\netstandard1.6\\Microsoft.PowerShell.PackageManagement.dll\r\nERROR: Can not open output file : Path not found. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\DSCResources\\PackageManagementDscUtilities.psm1\r\nERROR: Can not open output file : Path not found. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\DSCResources\\PackageManagementDscUtilities.strings.psd1\r\nERROR: Can not open output file : Path not found. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\DSCResources\\MSFT_PackageManagement\\MSFT_PackageManagement.psm1\r\nERROR: Can not open output file : Path not found. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\DSCResources\\MSFT_PackageManagement\\MSFT_PackageManagement.schema.mfl\r\nERROR: Can not open output file : Path not found. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\DSCResources\\MSFT_PackageManagement\\MSFT_PackageManagement.schema.mof\r\nERROR: Can not open output file : Path not found. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\DSCResources\\MSFT_PackageManagement\\MSFT_PackageManagement.strings.psd1\r\nERROR: Can not open output file : Path not found. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\DSCResources\\MSFT_PackageManagementSource\\MSFT_PackageManagementSource.psm1\r\nERROR: Can not open output file : Path not found. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\DSCResources\\MSFT_PackageManagementSource\\MSFT_PackageManagementSource.schema.mfl\r\nERROR: Can not open output file : Path not found. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\DSCResources\\MSFT_PackageManagementSource\\MSFT_PackageManagementSource.schema.mof\r\nERROR: Can not open output file : Path not found. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\DSCResources\\MSFT_PackageManagementSource\\MSFT_PackageManagementSource.strings.psd1\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\fullclr\\Microsoft.PackageManagement.ArchiverProviders.dll\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\fullclr\\Microsoft.PackageManagement.CoreProviders.dll\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\fullclr\\Microsoft.PackageManagement.dll\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\fullclr\\Microsoft.PackageManagement.MetaProvider.PowerShell.dll\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\fullclr\\Microsoft.PackageManagement.MsiProvider.dll\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\fullclr\\Microsoft.PackageManagement.MsuProvider.dll\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\fullclr\\Microsoft.PackageManagement.NuGetProvider.dll\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PackageManagement\\1.1.7.0\\fullclr\\Microsoft.PowerShell.PackageManagement.dll\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PowerShellGet\\1.6.0\\PowerShellGet.cat\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PowerShellGet\\1.6.0\\PowerShellGet.psd1\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PowerShellGet\\1.6.0\\PSGet.Format.ps1xml\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PowerShellGet\\1.6.0\\PSGet.Resource.psd1\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PowerShellGet\\1.6.0\\PSModule.psm1\r\nERROR: Can not open output file : Access denied. : C:\\Program Files\\Powershell\\Modules\\PowerShellGet\\1.6.0\\en-US\\PSGet.Resource.psd1\r\n                                                \r\nSub items Errors: 46\r\n\r\nArchives with Errors: 1\r\n\r\nSub items Errors: 46\r\n```\r\n\r\nThose permissions errors seem to be a few folders lacking the executable bit:\r\n```\r\naustin@austin2:~/.wine/drive_c/Program Files/Powershell/Modules$ ls -al\r\ntotal 48\r\ndrwxr-xr-x 5 austin austin  4096 May 18 13:40 .\r\ndrwxr-xr-x 3 austin austin 28672 May 18 13:40 ..\r\ndrw-r--r-- 3 austin austin  4096 Apr 25 19:18 Microsoft.PowerShell.Archive\r\ndrw-r--r-- 3 austin austin  4096 Apr 25 19:18 PackageManagement\r\ndrw-r--r-- 3 austin austin  4096 Apr 25 19:18 PowerShellGet\r\n```\r\n\r\nIn fact, this prevents removing the folder:\r\n```\r\nrm: cannot remove '/home/austin/.wine/drive_c/Program Files/Powershell/Modules/PowerShellGet/1.6.0': Permission denied\r\nrm: cannot remove '/home/austin/.wine/drive_c/Program Files/Powershell/Modules/PackageManagement/1.1.7.0': Permission denied\r\nrm: cannot remove '/home/austin/.wine/drive_c/Program Files/Powershell/Modules/Microsoft.PowerShell.Archive/1.1.0.0': Permission denied\r\n```\r\n\r\nworkaround is to either use root/sudo to remove the folder, or fix the permissions, THEN remove:\r\n```\r\nchmod +x \"$HOME/.wine/drive_c/Program Files/Powershell/Modules/\"{Microsoft.PowerShell.Archive,PackageManagement,PowerShellGet}\r\nchmod +x \"$HOME/.wine/drive_c/Program Files/Powershell/Modules/PackageManagement/1.1.7.0/coreclr\"\r\n```\r\n\r\nI would expect the zipfile to be extractable using these common tools.",
  "closed_at": "2018-10-21T12:58:32Z",
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "I don't think we can create a special zip file for wine. This problem looks like wine specific. \r\nYou could try to use latest 7zip release build.",
      "created_at": "2018-05-21T14:55:20Z",
      "updated_at": "2018-05-21T14:55:20Z"
    },
    {
      "author": "austin987",
      "author_association": "NONE",
      "body": "@iSazonov as I stated, it's not a Wine problem, per se. It fails with Linux unzip (without Wine), 7-zip under Wine (both 16.02 and 18.05) and native 7-zip under Linux (again, without Wine).\r\n\r\nIt does work under 7-zip 16.02 on windows 7, so it doesn't appear to be a 7-zip bug though. My guess is that there's something uncommon or non-standard about this zip (my guess is related to permissions or ACLs).",
      "created_at": "2018-05-21T17:11:37Z",
      "updated_at": "2018-05-21T17:11:37Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "We don't get new confirmations from community a long time.",
      "created_at": "2018-10-21T12:58:32Z",
      "updated_at": "2018-10-21T12:58:32Z"
    }
  ],
  "created_at": "2018-05-18T18:55:26Z",
  "number": 6900,
  "state": "closed",
  "title": "zipfile is not extractable with unzip or 7zip",
  "updated_at": "2018-10-21T12:58:32Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/13766",
  "author": "kyanha",
  "body": "(This was found when I was testing my PR #13650 written to address bug #10570. It had not been found before because there are no unit tests for alternate data stream handling on filesystems which do not support alternate data streams.)\r\n\r\nThe issue: The cmdlets in System.Management.Automation/`Microsoft.Powershell.Commands.FileSystemProvider` have the parameter `-Path` which takes an array of directories to process.  The `-Stream` parameter can throw terminating errors which terminate the processing of the remainder of the -Path array.\r\n\r\nThis makes script authors need to manually loop over candidate arrays they might wish to pass to the FileSystemProvider cmdlets, which ignores the reason non-terminating errors exist in the first place.\r\n\r\nThe correct action is to change the thrown terminating errors to WriteError() non-terminating errors in all places GetStreams() is called.  (It cannot be fixed within GetStreams itself, because it's not in a cmdlet implementation object and so doesn't have a WriteError implementation available.)\r\n\r\n```\r\nPS D:\\test> get-item m:\\*,d:\\test\\* -Stream *\r\nGet-Item: Alternate data streams are not supported for the specified path.\r\nPS D:\\test> get-item d:\\test\\*,m:\\* -Stream *\r\n\r\nPSPath        : Microsoft.PowerShell.Core\\FileSystem::D:\\test\\testfile::$DATA\r\nPSParentPath  : Microsoft.PowerShell.Core\\FileSystem::D:\\test\r\nPSChildName   : testfile::$DATA\r\nPSDrive       : D\r\nPSProvider    : Microsoft.PowerShell.Core\\FileSystem\r\nPSIsContainer : False\r\nFileName      : D:\\test\\testfile\r\nStream        : :$DATA\r\nLength        : 0\r\n\r\nPSPath        : Microsoft.PowerShell.Core\\FileSystem::D:\\test\\testfile:teststream\r\nPSParentPath  : Microsoft.PowerShell.Core\\FileSystem::D:\\test\r\nPSChildName   : testfile:teststream\r\nPSDrive       : D\r\nPSProvider    : Microsoft.PowerShell.Core\\FileSystem\r\nPSIsContainer : False\r\nFileName      : D:\\test\\testfile\r\nStream        : teststream\r\nLength        : 0\r\n\r\nPSPath        : Microsoft.PowerShell.Core\\FileSystem::D:\\test\\whatever.txt::$DATA\r\nPSParentPath  : Microsoft.PowerShell.Core\\FileSystem::D:\\test\r\nPSChildName   : whatever.txt::$DATA\r\nPSDrive       : D\r\nPSProvider    : Microsoft.PowerShell.Core\\FileSystem\r\nPSIsContainer : False\r\nFileName      : D:\\test\\whatever.txt\r\nStream        : :$DATA\r\nLength        : 28\r\n\r\nPSPath        : Microsoft.PowerShell.Core\\FileSystem::D:\\test\\whatever.txt:$DATA\r\nPSParentPath  : Microsoft.PowerShell.Core\\FileSystem::D:\\test\r\nPSChildName   : whatever.txt:$DATA\r\nPSDrive       : D\r\nPSProvider    : Microsoft.PowerShell.Core\\FileSystem\r\nPSIsContainer : False\r\nFileName      : D:\\test\\whatever.txt\r\nStream        : $DATA\r\nLength        : 36\r\n\r\nGet-Item: Alternate data streams are not supported for the specified path.\r\n\r\nPS D:\\test>\r\n```",
  "closed_at": null,
  "comments": [],
  "created_at": "2020-10-10T06:22:35Z",
  "number": 13766,
  "state": "open",
  "title": "Alternate Data Stream implementation can throw terminating error while processing -Path array",
  "updated_at": "2020-10-10T17:08:31Z"
}
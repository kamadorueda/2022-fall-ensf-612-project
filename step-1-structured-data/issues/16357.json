{
  "_url": "https://github.com/PowerShell/PowerShell/issues/16357",
  "author": "mattifestation",
  "body": "### Prerequisites\n\n- [X] Write a descriptive title.\n- [X] Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\n- [X] Search the existing issues.\n- [X] Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\n- [X] Refer to [Differences between Windows PowerShell 5.1 and PowerShell](https://docs.microsoft.com/powershell/scripting/whats-new/differences-from-windows-powershell).\n\n### Steps to reproduce\n\nOn a system that has support for Windowd Defender Application Control (WDAC), `Get-ComputerInfo` will return available Virtualization-Based Security (VBS) features via the `DeviceGuardAvailableSecurityProperties` property. The [DeviceGuardHardwareSecure](https://github.com/PowerShell/PowerShell/blob/0f2f23f67a2c3ec53cf82c8d1a67b479f62934e4/src/Microsoft.PowerShell.Commands.Management/commands/management/GetComputerInfoCommand.cs#L3670-L3691) enum does not support the latest features, however.\r\n\r\nTo reproduce, run the following:\r\n\r\n```powershell\r\nGet-ComputerInfo | Select-Object -ExpandProperty DeviceGuardAvailableSecurityProperties\r\n```\r\n\r\nThe issue is surfaced when returned values are output as numbers instead of human-readable strings.\r\n\r\nTo fix the issue, all that is needed is to add the following enum values to [DeviceGuardHardwareSecure](https://github.com/PowerShell/PowerShell/blob/0f2f23f67a2c3ec53cf82c8d1a67b479f62934e4/src/Microsoft.PowerShell.Commands.Management/commands/management/GetComputerInfoCommand.cs#L3670-L3691):\r\n\r\n```csharp\r\n        /// <summary>\r\n        /// UEFI Code Readonly.\r\n        /// </summary>\r\n        UEFICodeReadonly = 5,\r\n\r\n        /// <summary>\r\n        /// SMM Security Mitigations 1.0.\r\n        /// </summary>\r\n        SMMSecurityMitigations = 6,\r\n\r\n        /// <summary>\r\n        /// Mode Based Execution Control.\r\n        /// </summary>\r\n        ModeBasedExecutionControl = 7\r\n```\r\n\r\nThese human-readable values were obtained from `msinfo32.exe` (System Summary->Virtualization-based security Available Security Properties)\r\n\r\nThe `Get-ComputerInfo` cmdlet obtains this information from the `Win32_DeviceGuard` class which was updated to support additional enum values:\r\n\r\n```\r\nPS> ([WmiClass] 'root\\Microsoft\\Windows\\DeviceGuard:Win32_DeviceGuard').GetText('mof')\r\n[dynamic: ToInstance, provider(\"Win32_DeviceGuard\"): ToInstance, locale(1033)]\r\nclass Win32_DeviceGuard\r\n{\r\n        [key] string InstanceIdentifier;\r\n        string Version;\r\n        [ValueMap{\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\"}: ToSubClass, ArrayType(\"Indexed\"): DisableOverride ToSubClass] uint32 RequiredSecurityProperties[];\r\n        [ValueMap{\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\"}: ToSubClass, ArrayType(\"Indexed\"): DisableOverride ToSubClass] uint32 AvailableSecurityProperties[];\r\n        [ValueMap{\"0\", \"1\", \"2\"}: ToSubClass] uint32 VirtualizationBasedSecurityStatus;\r\n        [ValueMap{\"1\", \"2\", \"3\", \"4\"}: ToSubClass, ArrayType(\"Indexed\"): DisableOverride ToSubClass] uint32 SecurityServicesConfigured[];\r\n        [ValueMap{\"1\", \"2\", \"3\", \"4\", \"5\"}: ToSubClass, ArrayType(\"Indexed\"): DisableOverride ToSubClass] uint32 SecurityServicesRunning[];\r\n        [ValueMap{\"0\", \"1\", \"2\"}: ToSubClass] uint32 CodeIntegrityPolicyEnforcementStatus;\r\n        [ValueMap{\"0\", \"1\", \"2\"}: ToSubClass] uint32 UsermodeCodeIntegrityPolicyEnforcementStatus;\r\n        boolean VirtualMachineIsolation;\r\n        [ValueMap{\"1\", \"2\"}: ToSubClass, ArrayType(\"Indexed\"): DisableOverride ToSubClass] uint32 VirtualMachineIsolationProperties[];\r\n};\r\n```\r\n\r\nThis issue is also applicable to Windows PowerShell.\n\n### Expected behavior\n\n```console\nPS> Get-ComputerInfo | Select-Object -ExpandProperty DeviceGuardAvailableSecurityProperties\r\n\r\nBaseVirtualizationSupport\r\nSecureBoot\r\nDMAProtection\r\nSecureMemoryOverwrite\r\nUEFICodeReadonly\r\nSMMSecurityMitigations\r\nModeBasedExecutionControl\n```\n\n\n### Actual behavior\n\n```console\nPS> Get-ComputerInfo | Select-Object -ExpandProperty DeviceGuardAvailableSecurityProperties\r\n\r\nBaseVirtualizationSupport\r\nSecureBoot\r\nDMAProtection\r\nSecureMemoryOverwrite\r\n5\r\n6\r\n7\n```\n\n\n### Error details\n\n_No response_\n\n### Environment data\n\n```powershell\nPS> $PSVersionTable\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.1.5\r\nPSEdition                      Core\r\nGitCommitId                    7.1.5\r\nOS                             Microsoft Windows 10.0.22000\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u00e2\u20ac\u00a6}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\n```\n\n\n### Visuals\n\n_No response_",
  "closed_at": "2022-07-26T05:13:15Z",
  "comments": [],
  "created_at": "2021-11-02T10:43:42Z",
  "number": 16357,
  "state": "closed",
  "title": "Get-ComputerInfo is not updated to reflect current DeviceGuardAvailableSecurityProperties",
  "updated_at": "2022-07-26T05:13:27Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/4523",
  "author": "daxian-dbw",
  "body": "Fix #4499 \r\n\r\nThis PR includes following major changes:\r\n1. `ProcessStartInfo.UseShellExecute` is now supported in .NET Core on Windows. So we need to remove our implementation of `ShellExecute` and use the .NET Core API directly.\r\n2. Enable `NativeCommandProcessor` to open files using default program associated with the shell.\r\n3. Fix `NativeCommandProcessor` to properly clean up in case an exception is thrown in `Prepare` and `ProcessRecord`.\r\n\r\nNote that, `UseShellExecute` works as full .NET on windows desktop, but it doesn't work properly on Unix and the improvement work is tracked by dotnet/corefx#19956. So on Linux/OSX, we still need to rely on `xdg-open`/`open`",
  "closed_at": "2017-08-10T20:32:58Z",
  "comments": [
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "There are 2 failures in AppVeyor feature test run and both are related to `Invoke-RestMethod`, not related to the changes made in this PR. So the feature test run is good.",
      "created_at": "2017-08-08T15:31:25Z",
      "updated_at": "2017-08-08T15:31:25Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@adityapatwardhan @iSazonov Your comments have been addressed. Please take another look. Thanks!",
      "created_at": "2017-08-08T15:42:33Z",
      "updated_at": "2017-08-08T15:42:33Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "The \"Default\" constant string is used in 9 places and should be cleaned too (change to const variable, instead of static). But I think they should be in separate PRs as they will introduce too many diffs and make it hard to see the focus of this PR.",
      "created_at": "2017-08-09T16:25:41Z",
      "updated_at": "2017-08-09T16:25:41Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "LGTM.",
      "created_at": "2017-08-10T03:10:09Z",
      "updated_at": "2017-08-10T03:10:09Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@iSazonov @adityapatwardhan Thanks for the review! Aditya, can you please merge this PR? My follow-up work on the file watcher test helper needs to update the tests in this PR (#4524).",
      "created_at": "2017-08-10T18:52:52Z",
      "updated_at": "2017-08-10T18:52:52Z"
    }
  ],
  "created_at": "2017-08-07T23:25:13Z",
  "number": 4523,
  "state": "closed",
  "title": "Clean up ShellExecute code to use the .NET Core implementation",
  "updated_at": "2017-08-10T20:47:30Z"
}
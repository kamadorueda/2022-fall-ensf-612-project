{
  "_url": "https://github.com/PowerShell/PowerShell/issues/761",
  "author": "andschwa",
  "body": "In light of the PowerShell team switching this week, this PR includes several breaking changes that needed to be done sooner rather than later.\n\n**This PR has breaking changes that you absolutely must review.**\n\nPlease refrain from working within affected projects until this is merged (consider it a code freeze).\n\nUnfortunately, due to required rearrangement of submodules and the addition of a subtree, this _cannot_ be rebased, which leaves me with an odd history, and a few commits that could certainly have better messages.\n\nYou _must_ review this by looking at the actual `git log`, not what GitHub sees, at it includes the commits merged in the subtree import of `libpsl-native` (which need to be included because the history is very important).\n\nSummary:\n- `src/libpsl-native` submodule replaced with subtree import\n- `src/libpsl-native/test/googletest` submodule added; **must** initialize submodule\n- Microsoft.PowerShell.Linux.Host renamed to Microsoft.PowerShell.Host\n- \"Modules\" manifests added to `mapping.json` and imported correctly\n- Modules split between `src/Modules`, `src/Microsoft.PowerShell.Host`, and `src/Microsoft.PowerShell.ConsoleHost` in order to merge shared manifests and Core/Full specific manifests\n- Pester submodules moved to `src/Modules`; **must** reinitialize submodule\n- .NET CLI **must** be updated to a version which supports `--info`\n- `runtimes` section added back to `project.json` files; required by latest NuGet in latest CLI\n- `bootstrap.sh` script added to install all dependencies on Linux; this is due to the `dotnet` feed being deprecated\n- `PowerShellGitHubDev.psm` refactored\n- `xunit.sh` deprecated and removed; **must** use `Start-PSxUnit`\n- `pester.sh` deprecated and removed; **must** use `Start-PSPester`\n- `build.sh` still deprecated ~~and not updated (TODO)~~; **must** use `Start-PSBuild`\n- ~~`Add-Type` tests disabled; _must_ get fixed (TODO)~~\n- ~~Documentation is _not yet_ updated (TODO)~~\n- Resolves #678, #685, #529\n\n/cc @PowerShell/PowerShell\n\n<!-- Reviewable:start -->\n\n---\n\nThis change is [<img src=\"https://reviewable.io/review_button.svg\" height=\"35\" align=\"absmiddle\" alt=\"Reviewable\"/>](https://reviewable.io/reviews/powershell/powershell/761)\n\n<!-- Reviewable:end -->\n",
  "closed_at": "2016-04-04T19:33:23Z",
  "comments": [
    {
      "author": "andschwa",
      "author_association": "MEMBER",
      "body": "@vors I'm AFK but the AppVeyor build is failing because of the cached copy of CLI. Can you clear it and/or disable it please?\n",
      "created_at": "2016-04-04T18:14:35Z",
      "updated_at": "2016-04-04T18:14:35Z"
    },
    {
      "author": "vors",
      "author_association": "COLLABORATOR",
      "body": "@andschwa looks like there is no way to purge cache on-demand. I disabled it for now\n",
      "created_at": "2016-04-04T18:26:11Z",
      "updated_at": "2016-04-04T18:26:11Z"
    },
    {
      "author": "vors",
      "author_association": "COLLABORATOR",
      "body": "Well indeed: `%LocalAppData%\\Microsoft\\dotnet` includes the old version of `dotnet` tool. We need to point the cache just to nuget packages feed.\n",
      "created_at": "2016-04-04T18:32:35Z",
      "updated_at": "2016-04-04T18:32:35Z"
    },
    {
      "author": "vors",
      "author_association": "COLLABORATOR",
      "body": "Reviewed 125 of 126 files at r1, 1 of 1 files at r2.\nReview status: all files reviewed at latest revision, 2 unresolved discussions.\n\n---\n\n_[appveyor.yml, line 45 [r2]](https://reviewable.io:443/reviews/powershell/powershell/761#-KEXgtwP7v_hEj5lqv1P:-KEXgtwQz5BRoSn4byjp:-185521019) ([raw file](https://github.com/powershell/powershell/blob/2275048791cf037fe6e08dcb610df712841b9513/appveyor.yml#L45)):_\nIt doesn't have to be `$env:`, just `$FullOutput` would be fine\n\n---\n\n_[mapping.json, line 1195 [r2]](https://reviewable.io:443/reviews/powershell/powershell/761#-KEXh6jEJf5ZyMyWE5Ve:-KEXh6jF-n_c32e6te2z:-301591221) ([raw file](https://github.com/powershell/powershell/blob/2275048791cf037fe6e08dcb610df712841b9513/mapping.json#L1195)):_\nWe need a doc that explains what this mean (we can do it post-move)\n\n---\n\n_Comments from [Reviewable](https://reviewable.io:443/reviews/powershell/powershell/761)_\n\n<!-- Sent from Reviewable.io -->\n",
      "created_at": "2016-04-04T19:19:40Z",
      "updated_at": "2016-04-04T19:19:40Z"
    },
    {
      "author": "vors",
      "author_association": "COLLABORATOR",
      "body": "LGTM\n",
      "created_at": "2016-04-04T19:20:03Z",
      "updated_at": "2016-04-04T19:20:03Z"
    },
    {
      "author": "andschwa",
      "author_association": "MEMBER",
      "body": "Thanks @vors. The $env was needed to make the variable available in the post build section of the AppVeyor session, as it's a new script that gets run.\n",
      "created_at": "2016-04-04T19:30:12Z",
      "updated_at": "2016-04-04T19:30:12Z"
    }
  ],
  "created_at": "2016-04-04T06:14:01Z",
  "number": 761,
  "state": "closed",
  "title": "Switch dotnet publish for dotnet build (and more)",
  "updated_at": "2016-04-11T22:06:31Z"
}
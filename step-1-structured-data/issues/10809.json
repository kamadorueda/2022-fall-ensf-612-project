{
  "_url": "https://github.com/PowerShell/PowerShell/issues/10809",
  "author": "TravisEz13",
  "body": "<!--\r\n\r\nFor Windows PowerShell 5.1 issues, suggestions, or feature requests please use the following link instead:\r\nWindows PowerShell [UserVoice](https://windowsserver.uservoice.com/forums/301869-powershell)\r\n\r\nThis repository is **ONLY** for PowerShell Core 6 issues.\r\n\r\n- Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\r\n- Search the existing issues.\r\n- Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\r\n- Refer to the [known issues](https://docs.microsoft.com/powershell/scripting/whats-new/known-issues-ps6?view=powershell-6).\r\n\r\n-->\r\n\r\n# Steps to reproduce\r\n\r\ncc @SteveL-MSFT \r\n\r\nhttps://powershell.visualstudio.com/PowerShell/_build/results?buildId=35225&view=ms.vss-test-web.build-test-results-tab\r\n\r\n# Expected behavior\r\n\r\nPester logs should be generated\r\n\r\n# Actual behavior\r\n\r\n```none\r\nException             : System.Management.Automation.MethodInvocationException:\r\n                         Exception calling \"WriteElementString\" with \"2\" \r\n                        argument(s): \"'\u001b', hexadecimal value 0x1B, is an \r\n                        invalid character.\"\r\n                         ---> System.ArgumentException: '\u001b', hexadecimal value \r\n                        0x1B, is an invalid character.\r\n                           at \r\n                        System.Xml.XmlUtf8RawTextWriter.InvalidXmlChar(Int32 \r\n                        ch, Byte* pDst, Boolean entitize)\r\n                           at System.Xml.XmlUtf8RawTextWriter.WriteElementTextB\r\n                        lock(Char* pSrc, Char* pSrcEnd)\r\n                           at \r\n                        System.Xml.XmlUtf8RawTextWriter.WriteString(String \r\n                        text)\r\n                           at \r\n                        System.Xml.XmlWellFormedWriter.WriteString(String text)\r\n                           at CallSite.Target(Closure , CallSite , XmlWriter , \r\n                        String , Object )\r\n                           --- End of inner exception stack trace ---\r\n                           at System.Management.Automation.ExceptionHandlingOps\r\n                        .CheckActionPreference(FunctionContext funcContext, \r\n                        Exception exception)\r\n                           at System.Management.Automation.Interpreter.ActionCa\r\n                        llInstruction`2.Run(InterpretedFrame frame)\r\n                           at System.Management.Automation.Interpreter.EnterTry\r\n                        CatchFinallyInstruction.Run(InterpretedFrame frame)\r\n                           at System.Management.Automation.Interpreter.EnterTry\r\n                        CatchFinallyInstruction.Run(InterpretedFrame frame)\r\n                           at System.Management.Automation.Interpreter.EnterTry\r\n                        CatchFinallyInstruction.Run(InterpretedFrame frame)\r\nTargetObject          : \r\nCategoryInfo          : NotSpecified: (:) [], MethodInvocationException\r\nFullyQualifiedErrorId : ArgumentException\r\nErrorDetails          : \r\nInvocationInfo        : System.Management.Automation.InvocationInfo\r\nScriptStackTrace      : at Write-NUnitTestCaseAttributes, /Users/vsts/agent/2.1\r\n                        58.0/work/1/a/bins/publish/Modules/Pester/4.8.0/Functio\r\n                        ns/TestResults.ps1: line 423\r\n                        at Write-NUnitTestCaseElement, /Users/vsts/agent/2.158.\r\n                        0/work/1/a/bins/publish/Modules/Pester/4.8.0/Functions/\r\n                        TestResults.ps1: line 342\r\n                        at Write-NUnitTestSuiteElements, /Users/vsts/agent/2.15\r\n                        8.0/work/1/a/bins/publish/Modules/Pester/4.8.0/Function\r\n                        s/TestResults.ps1: line 212\r\n                        at Write-NUnitTestSuiteElements, /Users/vsts/agent/2.15\r\n                        8.0/work/1/a/bins/publish/Modules/Pester/4.8.0/Function\r\n                        s/TestResults.ps1: line 190\r\n                        at Write-NUnitTestResultChildNodes, /Users/vsts/agent/2\r\n                        .158.0/work/1/a/bins/publish/Modules/Pester/4.8.0/Funct\r\n                        ions/TestResults.ps1: line 138\r\n                        at Write-NUnitReport, /Users/vsts/agent/2.158.0/work/1/\r\n                        a/bins/publish/Modules/Pester/4.8.0/Functions/TestResul\r\n                        ts.ps1: line 103\r\n\r\n                        at Export-NUnitReport, /Users/vsts/agent/2.158.0/work/1\r\n                        /a/bins/publish/Modules/Pester/4.8.0/Functions/TestResu\r\n                        lts.ps1: line 72\r\n                        at Export-PesterResults, /Users/vsts/agent/2.158.0/work\r\n                        /1/a/bins/publish/Modules/Pester/4.8.0/Functions/TestRe\r\n                        sults.ps1: line 38\r\n                        at Invoke-Pester<End>, /Users/vsts/agent/2.158.0/work/1\r\n                        /a/bins/publish/Modules/Pester/4.8.0/Pester.psm1: line \r\n                        1163\r\n                        at <ScriptBlock>, <No file>: line 1\r\nPipelineIterationInfo : {}\r\nPSMessageDetails      : \r\n\r\n```\r\n\r\n# Environment data\r\n\r\n<!-- provide the output of $PSVersionTable -->\r\n\r\n```none\r\n\r\n```\r\n",
  "closed_at": "2019-11-26T22:54:10Z",
  "comments": [
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "I expect https://github.com/PowerShell/PowerShell/pull/10814 to workaround this for now.  The problem is that Pester isn't escaping the ESC character being used by VT escape sequences.",
      "created_at": "2019-10-21T21:27:51Z",
      "updated_at": "2019-10-21T21:27:51Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Can we close this?",
      "created_at": "2019-11-26T10:19:45Z",
      "updated_at": "2019-11-26T10:19:45Z"
    }
  ],
  "created_at": "2019-10-16T19:34:41Z",
  "number": 10809,
  "state": "closed",
  "title": "Pester fails to generate logs after changes to error format",
  "updated_at": "2019-11-26T22:54:10Z"
}
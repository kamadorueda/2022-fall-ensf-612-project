{
  "_url": "https://github.com/PowerShell/PowerShell/issues/5284",
  "author": "MaximoTrinidad",
  "body": "<!--\r\n\r\nFor Windows PowerShell 5.1 issues, suggestions, or feature requests please use the following link instead:\r\n- Windows PowerShell [UserVoice](https://windowsserver.uservoice.com/forums/301869-powershell)\r\n\r\nIf it is a bug report:\r\n- make sure you are able to repro it on the latest released version. \r\nYou can install the latest version from https://github.com/PowerShell/PowerShell/releases\r\n- Search the existing issues.\r\n- Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\r\n- Refer to the [known issues](https://github.com/PowerShell/PowerShell/blob/master/docs/KNOWNISSUES.md).\r\n- Fill out the following repro template:\r\n\r\nIf it's not a bug, please remove the template and elaborate the issue in your own words.\r\n-->\r\nCompare execution of downloading a file using Invoke-WebRequest in both Windows PowerShell and PowerShell Core Beta.9.  Beta.9 seems slower than Windows but is not.  The progress bar in PowerShell Core is refreshing slower but in fact the process runs faster in Beta.9.\r\n\r\nSteps to reproduce\r\n------------------\r\nExecute following command below in both Windows and PowerShell Beta.9:\r\n\r\n```powershell\r\nMeasure-Command {Invoke-WebRequest -Uri \"https://github.com/PowerShell/PowerShell/releases/download/v6.0.0-beta.9/PowerShell-6.0.0-beta.9-win-x86.msi\" -OutFile C:\\Users\\max_t\\Downloads\\PowerShell-6.0.0-beta.9-win-x86.msi}\r\n```\r\n\r\nExpected behavior\r\n-----------------\r\nVisually seems processing speed should be the same if executing the command on  the same system.\r\n```none\r\n```\r\n\r\nActual behavior\r\n---------------\r\nPowerShell Core Beta,9 progress bar refresh is a bit slower then Windows PowerShell.\r\nBut, the end results is that PowerShell Core Beta.9 runs a bit faster than Windows PowerShell.\r\n```\r\n## - Windows PowerShell 5.1 resutls:\r\nPS C:\\Users\\max_t> Measure-Command {Invoke-WebRequest -Uri \"https://github.com/PowerShell/PowerShell/releases/download/v\r\n6.0.0-beta.9/PowerShell-6.0.0-beta.9-win-x86.msi\" -OutFile C:\\Users\\max_t\\Downloads\\PowerShell-6.0.0-beta.9-win-x86.msi}\r\n\r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 34\r\nMilliseconds      : 777\r\nTicks             : 347771486\r\nTotalDays         : 0.000402513293981481\r\nTotalHours        : 0.00966031905555556\r\nTotalMinutes      : 0.579619143333333\r\nTotalSeconds      : 34.7771486\r\nTotalMilliseconds : 34777.1486\r\n\r\n## - PowerShell Core Beta.9 results:\r\nPS C:\\Program Files\\PowerShell\\6.0.0-beta.9> Measure-Command {Invoke-WebRequest -Uri \"https://github.com/PowerShell/PowerShell/releases/download/v\r\n6.0.0-beta.9/PowerShell-6.0.0-beta.9-win-x86.msi\" -OutFile C:\\Users\\max_t\\Downloads\\PowerShell-6.0.0-beta.9-win-x86.msi}\r\n\r\nDays              : 0\r\nHours             : 0\r\nMinutes           : 0\r\nSeconds           : 7\r\nMilliseconds      : 942\r\nTicks             : 79426444\r\nTotalDays         : 9.19287546296296E-05\r\nTotalHours        : 0.00220629011111111\r\nTotalMinutes      : 0.132377406666667\r\nTotalSeconds      : 7.9426444\r\nTotalMilliseconds : 7942.6444\r\n```\r\n\r\nEnvironment data\r\n----------------\r\n\r\n<!-- provide the output of $PSVersionTable -->\r\n\r\n```powershell\r\nPS C:\\Program Files\\PowerShell\\6.0.0-beta.9> $PSVersionTable\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      6.0.0-beta.9\r\nPSEdition                      Core\r\nGitCommitId                    v6.0.0-beta.9\r\nOS                             Microsoft Windows 10.0.16299\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n\r\nPS C:\\Users\\max_t> $PSVersionTable\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      5.1.16299.15\r\nPSEdition                      Desktop\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\r\nBuildVersion                   10.0.16299.15\r\nCLRVersion                     4.0.30319.42000\r\nWSManStackVersion              3.0\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\n\r\n```\r\n![webrequest_05_2017-11-01_0-54-18](https://user-images.githubusercontent.com/19892435/32240163-895fbb8e-bea7-11e7-89f8-21d036d54f74.png)\r\n\r\n![webrequest_04_2017-11-01_0-54-18](https://user-images.githubusercontent.com/19892435/32240083-4bc28428-bea7-11e7-8792-79a502d43853.png)\r\n",
  "closed_at": "2017-10-31T18:19:01Z",
  "comments": [
    {
      "author": "MaximoTrinidad",
      "author_association": "NONE",
      "body": "Seems like it's OK, but this one could be address in UserVoice for Windows PowerShell. Seems like a low priority the more I look at this one. \r\n\r\nAt least is posted.\r\n:)\r\n\r\nLet know that you think.\r\n\r\nThanks!",
      "created_at": "2017-10-31T17:57:10Z",
      "updated_at": "2017-10-31T17:57:10Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "Progress bar updates on PSCore6 happens less frequently and is by-design to improve cmdlet performance.  In Windows PowerShell, the progress bar was updated pretty much all the time and this had a significant impact on cmdlets (not just the web cmdlets but any that updated progress).  With PSCore6, we have a timer to only update the progress bar every 200ms on a single thread so that the CPU spends more time in the cmdlet and less time updating the screen.  This was https://github.com/PowerShell/PowerShell/pull/2822",
      "created_at": "2017-10-31T18:19:01Z",
      "updated_at": "2017-10-31T18:19:01Z"
    }
  ],
  "created_at": "2017-10-31T17:55:05Z",
  "number": 5284,
  "state": "closed",
  "title": "Beta.9 - Invoke-WebRequest speed seems slow compare to Windows version but is not.",
  "updated_at": "2017-10-31T18:19:01Z"
}
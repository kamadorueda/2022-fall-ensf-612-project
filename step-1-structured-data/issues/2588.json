{
  "_url": "https://github.com/PowerShell/PowerShell/issues/2588",
  "author": "powercode",
  "body": "Fixes #2578 \r\nWhen group policies are in effect for execution policy, a check is made to determine if the current process has been launched by gpscript.exe, and in that case, ignore the execution policy.\r\nThis is expensive to determine, is done over and over again, and has resulted in very long load times for scripts and modules.\r\n\r\nOne of the things that is checked (in an expensive way) is the parent id of the current process. That never changes, and is now cached.\r\n\r\nThe other change is to check once if we are launched by gpscript.exe or not and save that value.\r\nThis results in speedups in the order of a magnitude for module loads.",
  "closed_at": "2017-04-26T01:07:55Z",
  "comments": [
    {
      "author": "msftclas",
      "author_association": "NONE",
      "body": "Hi **@powercode**, I'm your friendly neighborhood Microsoft Pull Request Bot (You can call me MSBOT). Thanks for your contribution!\n    <span>You've already signed the contribution license agreement. Thanks!</span>\n        <p>The agreement was validated by Microsoft and real humans are currently evaluating your PR.</p>\n\nTTYL, MSBOT;\n",
      "created_at": "2016-11-02T11:53:31Z",
      "updated_at": "2016-11-02T11:53:31Z"
    },
    {
      "author": "lzybkr",
      "author_association": "MEMBER",
      "body": "@powercode - it looks like these changes cause the test failures.\n\n@LeeHolmes - can you review these changes?\n",
      "created_at": "2016-11-02T20:26:06Z",
      "updated_at": "2016-11-02T20:26:06Z"
    },
    {
      "author": "powercode",
      "author_association": "COLLABORATOR",
      "body": "It is my bad. Fixing now.\n",
      "created_at": "2016-11-02T21:26:26Z",
      "updated_at": "2016-11-02T21:26:26Z"
    },
    {
      "author": "powercode",
      "author_association": "COLLABORATOR",
      "body": "Fixing\n",
      "created_at": "2016-11-14T21:34:40Z",
      "updated_at": "2016-11-14T21:34:40Z"
    },
    {
      "author": "powercode",
      "author_association": "COLLABORATOR",
      "body": "Pushed new version with \n`private static int GetParentProcessIdCandidate` \ninstead of \n`internal static int GetParentProcessId`\n",
      "created_at": "2016-11-15T08:10:55Z",
      "updated_at": "2016-11-15T08:10:55Z"
    },
    {
      "author": "mirichmo",
      "author_association": "MEMBER",
      "body": "@powercode Can you please rebase this PR to the latest from master and push an update? It looks like it is ready to merge and just needs final code review sign off.\r\n\r\n@LeeHolmes - Please take another look at this PR and provide feedback as appropriate.\r\n@PaulHigin - I am adding you as Lee's backup if he is too busy or if you are curious",
      "created_at": "2017-03-30T01:07:15Z",
      "updated_at": "2017-03-30T01:07:15Z"
    },
    {
      "author": "powercode",
      "author_association": "COLLABORATOR",
      "body": "@PaulHigin We now have an implementation of GetParentPid available. Using it instead, and inlining the caching as suggested.",
      "created_at": "2017-04-19T07:10:16Z",
      "updated_at": "2017-04-19T07:10:16Z"
    }
  ],
  "created_at": "2016-11-02T11:53:25Z",
  "number": 2588,
  "state": "closed",
  "title": "Performance improvements to security checks when group policies are in effect for ExecutionPolicy",
  "updated_at": "2017-04-26T01:07:55Z"
}
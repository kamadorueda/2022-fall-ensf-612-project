{
  "_url": "https://github.com/PowerShell/PowerShell/issues/7085",
  "author": "SteveL-MSFT",
  "body": "## PR Summary\r\n\r\nNow that we include Microsoft.Windows.Compatibility assemblies with PowerShell Core 6.1, we can add back the [adsi], [adsisearcher], [wmi], [wmiclass], and [wmisearcher] accelerators putting back code that already exists.\r\n\r\nFix https://github.com/PowerShell/PowerShell/issues/3266\r\n\r\n## PR Checklist\r\n\r\n- [x] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - Use the present tense and imperative mood when describing your changes\r\n- [x] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] [Change is not breaking](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)\r\n- [x] [Make sure all `.h`, `.cpp`, `.cs`, `.ps1` and `.psm1` files have the correct copyright header](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - If the PR is work in progress, please add the prefix `WIP:` to the beginning of the title and remove the prefix when the PR is ready.\r\n- **User-facing changes**\r\n    - [ ] Not Applicable\r\n    - **OR**\r\n    - [ ] User-facing [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n        - [ ] Issue filed - Issue link:\r\n- **Testing - New and feature**\r\n    - [ ] Not Applicable or can only be tested interactively\r\n    - **OR**\r\n    - [x] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n        - [ ] [Add `[feature]` if the change is significant or affects feature tests](https://github.com/PowerShell/PowerShell/blob/master/docs/testing-guidelines/testing-guidelines.md#requesting-additional-tests-for-a-pr)\r\n",
  "closed_at": "2018-06-21T16:57:15Z",
  "comments": [
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "I believe the problem is we haven't published an updated pwrshplugin.dll yet so System.Management.dll and System.DirectoryServices.dll aren't in the trusted list and thus fails to initialize on the remote side.  I'll work on getting pwrshplugin.dll published.",
      "created_at": "2018-06-16T01:38:54Z",
      "updated_at": "2018-06-16T01:38:54Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Seems we add back 5 type accelerators - please update the PR description.",
      "created_at": "2018-06-16T18:34:30Z",
      "updated_at": "2018-06-16T18:34:30Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@iSazonov can you formally review and signoff?",
      "created_at": "2018-06-20T16:12:29Z",
      "updated_at": "2018-06-20T16:12:29Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "I still have a concern about my [comment](https://github.com/PowerShell/PowerShell/pull/7085#discussion_r196638842)\r\n> Seems we add 5 accelerators on Windows. I wonder why the count is increased only +1",
      "created_at": "2018-06-21T03:39:01Z",
      "updated_at": "2018-06-21T03:39:01Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@iSazonov the count didn't increase by +1, if you look at line [381](https://github.com/PowerShell/PowerShell/pull/7085/files#diff-aab75a5e4bb54c576f1c77aa19b85b86R381), the number w/o the Windows specific ones is 91.  I added 5, so the total with the new ones is 96 on line [385](https://github.com/PowerShell/PowerShell/pull/7085/files#diff-aab75a5e4bb54c576f1c77aa19b85b86R385).  The original code was wrong as it only did +4 and should have been +5.",
      "created_at": "2018-06-21T15:45:02Z",
      "updated_at": "2018-06-21T15:45:02Z"
    }
  ],
  "created_at": "2018-06-15T21:14:36Z",
  "number": 7085,
  "state": "closed",
  "title": "Add back ADSI and WMI type accelerators",
  "updated_at": "2018-06-21T18:00:44Z"
}
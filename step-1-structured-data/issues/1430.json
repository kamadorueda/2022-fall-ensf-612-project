{
  "_url": "https://github.com/PowerShell/PowerShell/issues/1430",
  "author": "TingLiu6",
  "body": "when converting file [TestGetCommand.cs](https://github.com/PowerShell/psl-monad/blob/source-depot/monad/tests/monad/src/engine/core/TestGetCommand.cs) in line 849, function 'TestGetCommand-DynamicParametersDCR':\n\n```\nfunction TestGetCommand-DynamicParametersDCR \n{\n[CmdletBinding()]\n    param (\n    [Parameter(Mandatory = $true, Position = 0)]\n    [ValidateSet(\"ReturnNull\", \"ReturnThis\", \"Return1\", \"Return2\",\"Return3\", \"ReturnDuplicateParameter\", \"ReturnAlias\", \"ReturnDuplicateAlias\",\"ReturnObjectNoParameters\", \"ReturnGenericParameter\", \"ThrowException\")]\n    [string] $TestToRun,\n\n    [Parameter()]\n    [Type]$ParameterType\n    )\n\n    DynamicParam {\n        if ( ! $testToRun ) {\n            $testToRun = $defaultAction\n        }\n        $dynamicParamDictionary = [System.Management.Automation.RuntimeDefinedParameterDictionary]::new()\n        switch ( $testToRun )\n        {                   \n            \"returngenericparameter\" {\n                Write-Host \"type is: $ParameterType\"\n                $attr1 = [System.Management.Automation.ParameterAttribute]::new()\n                $attr1.ParameterSetName = \"__AllParameterSets\"\n                $ac1 = [Collections.ObjectModel.Collection[Attribute]]::new()\n                $ac1.Add($attr1)\n                $p1 = [System.Management.Automation.RuntimeDefinedParameter]::new(\"TypedValue\",$ParameterType,$ac1)                       \n                $dynamicParamDictionary.Add(\"TypedValue\",$p1)              \n                break                         \n            }\n            default { \n                throw ([invalidoperationexception]::new(\"unable to determine which dynamic parameters to return!\"))\n                break\n            }\n        }\n        return $dynamicParamDictionary\n    }\n\n    BEGIN {\n        $ReturnNull = \"ReturnNull\"\n        $ReturnThis = \"ReturnThis\"\n        $ReturnAlias = \"ReturnAlias\"\n        $ReturnDuplicateAlias = \"ReturnDuplicateAlias\"\n        $Return1 = \"Return1\"\n        $Return2 = \"Return2\"\n        $Return3 = \"Return3\"\n        $ReturnDuplicateParameter = \"ReturnDuplicateParameter\"\n        $ReturnObjectNoParameters = \"ReturnObjectNoParameters\"\n        $ReturnGenericParameter = \"ReturnGenericParameter\"\n        $ThrowException = \"ThrowException\"\n        $DefaultAction = \"returnnull\"\n        return $dynamicParamDictionary\n    }\n}\n```\n\nRun command:\n\n```\n$res1 = Get-Command testgetcommand-dynamicparametersdcr -ParameterType System.Diagnostics.Process -TestToRun ReturnGenericParameter \n\n$res2 = Get-command testgetcommand-dynamicparametersdcr -args '-testtorun','returngenericparameter','-parametertype','System.Diagnostics.Process'\n```\n\n**$ParameterType returns null when run the first command**, but for the second, it returns the correct value 'System.Diagnostics.Process'\n",
  "closed_at": null,
  "comments": [],
  "created_at": "2016-07-19T03:20:40Z",
  "number": 1430,
  "state": "open",
  "title": "[Get-Command] Fail to get parameter value ",
  "updated_at": "2017-03-04T19:20:11Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/14340",
  "author": "dingmeng-xue",
  "body": "<!--\r\n\r\nFor Windows PowerShell 5.1 issues, suggestions, or feature requests please use the following link instead:\r\nWindows PowerShell [UserVoice](https://windowsserver.uservoice.com/forums/301869-powershell)\r\n\r\nThis repository is **ONLY** for PowerShell Core 6 and PowerShell 7+ issues.\r\n\r\n- Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\r\n- Search the existing issues.\r\n- Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\r\n- Refer to the [known issues](https://docs.microsoft.com/powershell/scripting/whats-new/known-issues-ps6).\r\n\r\n-->\r\n\r\nThe issue is due to https://github.com/Azure/azure-powershell/issues/13653\r\n\r\n> I am using powershell script in ubuntu, when downloading a file like using \"Export-AzDataLakeStoreItem\", it shows a progress bar. If stdout is redirected to a file (it is necessary for recording the log), then use \"tail -f \" to check output, progress bar becomes totally messy.\r\n> I know there are some progress bar tools can work in both screen printout and redirected stdout file, like [tqdm](https://github.com/tqdm/tqdm). You may consider it to improve.\r\n\r\n## Steps to reproduce\r\n\r\n```powershell\r\nroot@4becd3631c05:~# echo 'pwsh -Command \"Install-Module AzureAd\"' > pwsh.sh\r\nroot@4becd3631c05:~# bash pwsh.sh > pwsh.log 2>&1 &\r\n[3] 358\r\n                                                                                                                                                                                                                                                                                                                                                                                                                root@4becd3631c05:~# cat pwsh.log\r\n                                                                                                                                                                                                                                                                                                                                                                         \r\n```\r\n\r\n## Expected behavior\r\n\r\n```none\r\n\r\n```\r\n\r\n## Actual behavior\r\n\r\n```none\r\nInstalling package 'AzureAD'                                                       Downloaded 0.00 MB out of 7.52 MB.                                              [                                                                    ]                                                                                                                                                                       \r\nInstalling package 'AzureAD'                                                       Downloaded 0.77 MB out of 7.52 MB.                                              [oooo                                                                ]                                                                                                                                                                       \r\nInstalling package 'AzureAD'                                                       Downloaded 3.06 MB out of 7.52 MB.                                              [ooooooooooooooooooo                                                 ]                                                                                                                                                                       \r\nInstalling package 'AzureAD'                                                       Downloaded 6.12 MB out of 7.52 MB.                                              [oooooooooooooooooooooooooooooooooooooo                              ]                                                                                                                                                                       \r\nInstalling package 'AzureAD'                                                       Copying unzipped package to '/tmp/145796501/AzureAD.2.0.2.128'                  [ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo       ]                                                                                                                                                                       \r\nInstalling package 'AzureAD'                                                       Process Package Manifest                                                        [oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo    ]                                                                                                                                                                                                                                                                                                             \r\n\r\n[3]+  Stopped                 bash pwsh.sh > pwsh.log 2>&1\r\n```\r\n\r\n## Environment data\r\n\r\n<!-- provide the output of $PSVersionTable -->\r\n\r\n```none\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.1.0\r\nPSEdition                      Core\r\nGitCommitId                    7.1.0\r\nOS                             Linux 4.19.76-linuxkit #1 SMP Tue May 26 11:42:35 UTC 2020\r\nPlatform                       Unix\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n",
  "closed_at": "2020-12-07T20:57:02Z",
  "comments": [
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "Progress information is written to stderr which is intended for anything that is not stdout.  So this behavior is expected.  If you only want the output information, then only redirect stdout to a file.  Otherwise if you need other stderr info, you can set `$ProgressPreference = 'SilentlyContinue'` to not output any progress information at all.",
      "created_at": "2020-12-07T20:57:02Z",
      "updated_at": "2020-12-07T20:57:02Z"
    }
  ],
  "created_at": "2020-12-07T06:50:59Z",
  "labels": [
    "Issue-Question",
    "Resolution-By Design"
  ],
  "number": 14340,
  "state": "closed",
  "title": "Progress bar format messed up when redirecting stdout",
  "updated_at": "2020-12-07T20:57:08Z"
}
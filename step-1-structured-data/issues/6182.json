{
  "_url": "https://github.com/PowerShell/PowerShell/issues/6182",
  "author": "bergmeister",
  "body": "## PR Summary\r\n\r\n- Fixes #4634 by throwing a terminating error as agreed\r\n- Makes the command not rely on the presence of the `TEMP` environment variable to get path to temp directory and use the .Net method `Path.GetTempPath()` instead\r\n- Catch exception more specific as given by the documentation\r\n- Improve existing test\r\n\r\n## PR Checklist\r\n\r\nNote: Please mark anything not applicable to this PR `NA`.\r\n\r\n- [x] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - [x] Use the present tense and imperative mood when describing your changes\r\n- [x] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [ ] User facing [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - [ ] Issue filed - Issue link:\r\n- [ ] [Change is not breaking](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes) Calls to `New-TemporaryFile` that are in a pipeline will abort (by design)\r\n- [ ] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting) I have tested it locally but we would be rather testing .Net and test setup would be expensive because one needs to first create 65535  temp files\r\n    - [ ] [Add `[feature]` if the change is significant or affects feature tests](https://github.com/PowerShell/PowerShell/blob/master/docs/testing-guidelines/testing-guidelines.md#requesting-additional-tests-for-a-pr)\r\n- [x] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - If the PR is work in progress, please add the prefix `WIP:` to the beginning of the title and remove the prefix when the PR is ready.\r\n",
  "closed_at": "2018-02-22T19:32:02Z",
  "comments": [
    {
      "author": "bergmeister",
      "author_association": "CONTRIBUTOR",
      "body": "@iSazonov I addressed your comments and opened an issue for the help link [here](https://github.com/PowerShell/PowerShell/issues/6186).",
      "created_at": "2018-02-18T18:06:54Z",
      "updated_at": "2018-02-18T18:06:54Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@bergmeister Please update PR summary and title.",
      "created_at": "2018-02-21T16:10:32Z",
      "updated_at": "2018-02-21T16:10:32Z"
    },
    {
      "author": "bergmeister",
      "author_association": "CONTRIBUTOR",
      "body": "@iSazonov Ok. Done.",
      "created_at": "2018-02-21T19:30:17Z",
      "updated_at": "2018-02-21T19:30:17Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@iSazonov The `[breaking-change]` tag should be added to the body of the commit message instead of the title of it. Sorry that I didn't point out that specifically.\r\n\r\nWhen squash-merging a breaking change PR in future, please do like the following:\r\n![image](https://user-images.githubusercontent.com/127450/36620654-ebcd4e66-18a8-11e8-8689-229712d9b6c4.png)",
      "created_at": "2018-02-23T22:50:54Z",
      "updated_at": "2018-02-23T22:50:54Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@daxian-dbw Thanks! Clear! Please re-check last commits which I merged.",
      "created_at": "2018-02-24T05:38:59Z",
      "updated_at": "2018-02-24T05:38:59Z"
    }
  ],
  "created_at": "2018-02-18T12:30:31Z",
  "number": 6182,
  "state": "closed",
  "title": "Throw terminating error in New-TemporaryFile and make it not rely on the presence of the 'TEMP' environment variable",
  "updated_at": "2018-02-24T05:39:00Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/7180",
  "author": "wstaelens",
  "body": "I'm not sure if it is a bug, I guess so\u2026\r\n\r\n> Windows 10 Pro x64 v1803 build 17134.112\r\n> PS version 5.1.17134.112\r\n\r\nIf I start Windows PowerShell, I'm at:\r\n`PS C:\\Users\\foo>`\r\n\r\n\r\nI type this:\r\n\r\n`cd .\\Desktop\\`\r\n\r\nto get to:\r\n\r\n`PS C:\\Users\\foo\\Desktop>`\r\n\r\nNow when I execute this piece of code:\r\n\r\n\r\n```\r\nGet-Module -ListAvailable |\r\nforeach { gcm -Module $_.Name -CommandType cmdlet, function | select Name}\r\n```\r\n\r\nit ends at\r\n\r\n`PS SQLSERVER:\\>`\r\n\r\ninstead of at the original working directory where the script started:\r\n\r\n`PS C:\\Users\\foo\\Desktop>`\r\n\r\n![powershell issue](https://user-images.githubusercontent.com/7447285/41917788-62259b78-795b-11e8-95c1-74c13fd7ff04.png)\r\n\r\n\r\nRemark: If I use Get-Module -All instead of -ListAvailable it works as expected. It only happens with the -ListAvailable.",
  "closed_at": "2018-06-26T15:39:18Z",
  "comments": [
    {
      "author": "MaximoTrinidad",
      "author_association": "NONE",
      "body": "Please, to post Windows PowerShell issues use the UserVoice forum: https://windowsserver.uservoice.com/forums/301869-powershell\r\n\r\nAs stated in the PowerShell Core landing page: https://github.com/PowerShell/PowerShell#windows-powershell-vs-powershell-core\r\n\r\nThis is only for posting PowerShell Core issues.  \r\n\r\nThis issue doesn't repo in PowerShell Core.\r\n\r\nThanks\r\n\r\n![pscoremodule_ok_2018-06-26_10-21-36](https://user-images.githubusercontent.com/19892435/41918691-d8694888-792a-11e8-9e58-6a93a20cf03c.jpg)\r\n",
      "created_at": "2018-06-26T14:18:18Z",
      "updated_at": "2018-06-26T14:22:38Z"
    },
    {
      "author": "wstaelens",
      "author_association": "NONE",
      "body": "https://windowsserver.uservoice.com/forums/301869-powershell/suggestions/34668142-bug-powershell-does-not-return-to-current-working ",
      "created_at": "2018-06-26T14:22:45Z",
      "updated_at": "2018-06-26T14:22:45Z"
    },
    {
      "author": "MaximoTrinidad",
      "author_association": "NONE",
      "body": "Please understand!  This is issue will not remain open in Github as it is a different line of product.\r\nThis will be close as it doesn't replicate in PowerShell Core.\r\n\r\nYou need to copy the information over to the UserVoice link you provided.  \r\n\r\nThanks\r\n",
      "created_at": "2018-06-26T14:31:32Z",
      "updated_at": "2018-06-26T14:31:32Z"
    },
    {
      "author": "MaximoTrinidad",
      "author_association": "NONE",
      "body": "BTW!!\r\n\r\nJust an FYI\r\n\r\nIn Windows Insider build 17686, it doesn't replicate neither.\r\n\r\n```\r\nUnpublish-QADCerti...\r\nUnpublish-QADCerti...\r\nUnpublish-QARSGroup\r\nWhere-QADCertificate\r\n\r\n\r\nPS [2999] > pwd\r\n\r\nPath\r\n----\r\nC:\\Users\\max_t\r\n\r\n\r\nPS [2999] > $PSVersionTable\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      5.1.17686.1003\r\nPSEdition                      Desktop\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\r\nBuildVersion                   10.0.17686.1003\r\nCLRVersion                     4.0.30319.42000\r\nWSManStackVersion              3.0\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\n```\r\n",
      "created_at": "2018-06-26T14:33:02Z",
      "updated_at": "2018-06-26T14:33:02Z"
    },
    {
      "author": "wstaelens",
      "author_association": "NONE",
      "body": "```\r\n$psversiontable\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      5.1.17134.112\r\nPSEdition                      Desktop\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\r\nBuildVersion                   10.0.17134.112\r\nCLRVersion                     4.0.30319.42000\r\nWSManStackVersion              3.0\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\n\r\n```\r\nI have these modules\r\n```\r\n\r\n Get-Module -ListAvailable\r\n\r\n\r\n    Directory: C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\Modules\r\n\r\n\r\nModuleType Version    Name                                ExportedCommands\r\n---------- -------    ----                                ----------------\r\nManifest   1.0.0.0    AppBackgroundTask                   {Disable-AppBackgroundTaskDiagnosticLog, Enable-AppBackgro...\r\nManifest   2.0.0.0    AppLocker                           {Get-AppLockerFileInformation, Get-AppLockerPolicy, New-Ap...\r\nManifest   1.0.0.0    AppvClient                          {Add-AppvClientConnectionGroup, Add-AppvClientPackage, Add...\r\nManifest   2.0.0.0    Appx                                {Add-AppxPackage, Get-AppxPackage, Get-AppxPackageManifest...\r\nScript     1.0.0.0    AssignedAccess                      {Clear-AssignedAccess, Get-AssignedAccess, Set-AssignedAcc...\r\nManifest   1.0.0.0    BitLocker                           {Unlock-BitLocker, Suspend-BitLocker, Resume-BitLocker, Re...\r\nManifest   2.0.0.0    BitsTransfer                        {Add-BitsFile, Complete-BitsTransfer, Get-BitsTransfer, Re...\r\nManifest   1.0.0.0    BranchCache                         {Add-BCDataCacheExtension, Clear-BCCache, Disable-BC, Disa...\r\nManifest   1.0.0.0    CimCmdlets                          {Get-CimAssociatedInstance, Get-CimClass, Get-CimInstance,...\r\nManifest   1.0        ConfigCI                            {Get-SystemDriver, New-CIPolicyRule, New-CIPolicy, Get-CIP...\r\nManifest   1.0        Defender                            {Get-MpPreference, Set-MpPreference, Add-MpPreference, Rem...\r\nManifest   1.0.0.0    DeliveryOptimization                {Get-DeliveryOptimizationStatus, Get-DeliveryOptimizationP...\r\nManifest   1.0.0.0    DirectAccessClientComponents        {Disable-DAManualEntryPointSelection, Enable-DAManualEntry...\r\nScript     3.0        Dism                                {Add-AppxProvisionedPackage, Add-WindowsDriver, Add-Window...\r\nManifest   1.0.0.0    DnsClient                           {Resolve-DnsName, Clear-DnsClientCache, Get-DnsClient, Get...\r\nManifest   1.0.0.0    EventTracingManagement              {Start-EtwTraceSession, New-EtwTraceSession, Get-EtwTraceS...\r\nScript     1.1.0.0    IISAdministration                   {Enable-IISCentralCertProvider, Reset-IISServerManager, St...\r\nManifest   2.0.0.0    International                       {Get-WinDefaultInputMethodOverride, Set-WinDefaultInputMet...\r\nManifest   1.0.0.0    iSCSI                               {Get-IscsiTargetPortal, New-IscsiTargetPortal, Remove-Iscs...\r\nScript     1.0.0.0    ISE                                 {New-IseSnippet, Import-IseSnippet, Get-IseSnippet}\r\nManifest   1.0.0.0    Kds                                 {Add-KdsRootKey, Get-KdsRootKey, Test-KdsRootKey, Set-KdsC...\r\nManifest   1.0.1.0    Microsoft.PowerShell.Archive        {Compress-Archive, Expand-Archive}\r\nManifest   3.0.0.0    Microsoft.PowerShell.Diagnostics    {Get-WinEvent, Get-Counter, Import-Counter, Export-Counter...\r\nManifest   3.0.0.0    Microsoft.PowerShell.Host           {Start-Transcript, Stop-Transcript}\r\nManifest   1.0.0.0    Microsoft.PowerShell.LocalAccounts  {Add-LocalGroupMember, Disable-LocalUser, Enable-LocalUser...\r\nManifest   3.1.0.0    Microsoft.PowerShell.Management     {Add-Content, Clear-Content, Clear-ItemProperty, Join-Path...\r\nScript     1.0        Microsoft.PowerShell.ODataUtils     Export-ODataEndpointProxy\r\nManifest   3.0.0.0    Microsoft.PowerShell.Security       {Get-Acl, Set-Acl, Get-PfxCertificate, Get-Credential...}\r\nManifest   3.1.0.0    Microsoft.PowerShell.Utility        {Format-List, Format-Custom, Format-Table, Format-Wide...}\r\nManifest   3.0.0.0    Microsoft.WSMan.Management          {Disable-WSManCredSSP, Enable-WSManCredSSP, Get-WSManCredS...\r\nManifest   1.0        MMAgent                             {Disable-MMAgent, Enable-MMAgent, Set-MMAgent, Get-MMAgent...\r\nManifest   1.0.0.0    MsDtc                               {New-DtcDiagnosticTransaction, Complete-DtcDiagnosticTrans...\r\nManifest   2.0.0.0    NetAdapter                          {Disable-NetAdapter, Disable-NetAdapterBinding, Disable-Ne...\r\nManifest   1.0.0.0    NetConnection                       {Get-NetConnectionProfile, Set-NetConnectionProfile}\r\nManifest   1.0.0.0    NetEventPacketCapture               {New-NetEventSession, Remove-NetEventSession, Get-NetEvent...\r\nManifest   2.0.0.0    NetLbfo                             {Add-NetLbfoTeamMember, Add-NetLbfoTeamNic, Get-NetLbfoTea...\r\nManifest   1.0.0.0    NetNat                              {Get-NetNat, Get-NetNatExternalAddress, Get-NetNatStaticMa...\r\nManifest   2.0.0.0    NetQos                              {Get-NetQosPolicy, Set-NetQosPolicy, Remove-NetQosPolicy, ...\r\nManifest   2.0.0.0    NetSecurity                         {Get-DAPolicyChange, New-NetIPsecAuthProposal, New-NetIPse...\r\nManifest   1.0.0.0    NetSwitchTeam                       {New-NetSwitchTeam, Remove-NetSwitchTeam, Get-NetSwitchTea...\r\nManifest   1.0.0.0    NetTCPIP                            {Get-NetIPAddress, Get-NetIPInterface, Get-NetIPv4Protocol...\r\nManifest   1.0.0.0    NetworkConnectivityStatus           {Get-DAConnectionStatus, Get-NCSIPolicyConfiguration, Rese...\r\nManifest   1.0.0.0    NetworkSwitchManager                {Disable-NetworkSwitchEthernetPort, Enable-NetworkSwitchEt...\r\nManifest   1.0.0.0    NetworkTransition                   {Add-NetIPHttpsCertBinding, Disable-NetDnsTransitionConfig...\r\nManifest   1.0.0.0    PcsvDevice                          {Get-PcsvDevice, Start-PcsvDevice, Stop-PcsvDevice, Restar...\r\nBinary     1.0.0.0    PersistentMemory                    {Get-PmemDisk, Get-PmemPhysicalDevice, Get-PmemUnusedRegio...\r\nManifest   1.0.0.0    PKI                                 {Add-CertificateEnrollmentPolicyServer, Export-Certificate...\r\nManifest   1.0.0.0    PnpDevice                           {Get-PnpDevice, Get-PnpDeviceProperty, Enable-PnpDevice, D...\r\nManifest   1.1        PrintManagement                     {Add-Printer, Add-PrinterDriver, Add-PrinterPort, Get-Prin...\r\nBinary     1.0.11     ProcessMitigations                  {Get-ProcessMitigation, Set-ProcessMitigation, ConvertTo-P...\r\nScript     3.0        Provisioning                        {Install-ProvisioningPackage, Export-ProvisioningPackage, ...\r\nManifest   1.1        PSDesiredStateConfiguration         {Set-DscLocalConfigurationManager, Start-DscConfiguration,...\r\nScript     1.0.0.0    PSDiagnostics                       {Disable-PSTrace, Disable-PSWSManCombinedTrace, Disable-WS...\r\nBinary     1.1.0.0    PSScheduledJob                      {New-JobTrigger, Add-JobTrigger, Remove-JobTrigger, Get-Jo...\r\nManifest   2.0.0.0    PSWorkflow                          {New-PSWorkflowExecutionOption, New-PSWorkflowSession, nwsn}\r\nManifest   1.0.0.0    PSWorkflowUtility                   Invoke-AsWorkflow\r\nManifest   1.0.0.0    ScheduledTasks                      {Get-ScheduledTask, Set-ScheduledTask, Register-ScheduledT...\r\nManifest   2.0.0.0    SecureBoot                          {Confirm-SecureBootUEFI, Set-SecureBootUEFI, Get-SecureBoo...\r\nManifest   2.0.0.0    SmbShare                            {Get-SmbShare, Remove-SmbShare, Set-SmbShare, Block-SmbSha...\r\nManifest   2.0.0.0    SmbWitness                          {Get-SmbWitnessClient, Move-SmbWitnessClient, gsmbw, msmbw...\r\nManifest   1.0.0.0    StartLayout                         {Export-StartLayout, Import-StartLayout, Export-StartLayou...\r\nManifest   2.0.0.0    Storage                             {Add-InitiatorIdToMaskingSet, Add-PartitionAccessPath, Add...\r\nManifest   2.0.0.0    TLS                                 {New-TlsSessionTicketKey, Enable-TlsSessionTicketKey, Disa...\r\nManifest   1.0.0.0    TroubleshootingPack                 {Get-TroubleshootingPack, Invoke-TroubleshootingPack}\r\nManifest   2.0.0.0    TrustedPlatformModule               {Get-Tpm, Initialize-Tpm, Clear-Tpm, Unblock-Tpm...}\r\nBinary     2.1.639.0  UEV                                 {Clear-UevConfiguration, Clear-UevAppxPackage, Restore-Uev...\r\nManifest   2.0.0.0    VpnClient                           {Add-VpnConnection, Set-VpnConnection, Remove-VpnConnectio...\r\nManifest   1.0.0.0    Wdac                                {Get-OdbcDriver, Set-OdbcDriver, Get-OdbcDsn, Add-OdbcDsn...}\r\nManifest   1.0.0.0    WebAdministration                   {Start-WebCommitDelay, Stop-WebCommitDelay, Get-WebConfigu...\r\nManifest   1.0.0.0    WindowsDeveloperLicense             {Get-WindowsDeveloperLicense, Unregister-WindowsDeveloperL...\r\nScript     1.0        WindowsErrorReporting               {Enable-WindowsErrorReporting, Disable-WindowsErrorReporti...\r\nManifest   1.0.0.0    WindowsSearch                       {Get-WindowsSearchSetting, Set-WindowsSearchSetting}\r\nManifest   1.0.0.0    WindowsUpdate                       Get-WindowsUpdateLog\r\nManifest   1.0.0.2    WindowsUpdateProvider               {Get-WUAVersion, Get-WULastInstallationDate, Get-WULastSca...\r\n\r\n\r\n    Directory: C:\\Program Files (x86)\\Microsoft SQL Server\\120\\Tools\\PowerShell\\Modules\r\n\r\n\r\nModuleType Version    Name                                ExportedCommands\r\n---------- -------    ----                                ----------------\r\nManifest   1.0        SQLASCMDLETS                        {Add-RoleMember, Backup-ASDatabase, Invoke-ASCmd, Invoke-P...\r\nManifest   1.0        SQLPS                               {Backup-SqlDatabase, Add-SqlAvailabilityDatabase, Add-SqlA...\r\n\r\n\r\n    Directory: C:\\Program Files\\WindowsPowerShell\\Modules\r\n\r\n\r\nModuleType Version    Name                                ExportedCommands\r\n---------- -------    ----                                ----------------\r\nScript     1.0.1      Microsoft.PowerShell.Operation.V... {Get-OperationValidation, Invoke-OperationValidation}\r\nBinary     1.0.0.1    PackageManagement                   {Find-Package, Get-Package, Get-PackageProvider, Get-Packa...\r\nBinary     1.0.0.0    PackageManagement                   {Find-Package, Get-Package, Get-PackageProvider, Get-Packa...\r\nScript     3.4.0      Pester                              {Describe, Context, It, Should...}\r\nScript     1.0.0.1    PowerShellGet                       {Install-Module, Find-Module, Save-Module, Update-Module...}\r\nScript     1.2        PSReadline                          {Get-PSReadlineKeyHandler, Set-PSReadlineKeyHandler, Remov...\r\n\r\n\r\n    Directory: C:\\Program Files (x86)\\Microsoft SDKs\\Azure\\PowerShell\\ResourceManager\\AzureResourceManager\r\n\r\n\r\nModuleType Version    Name                                ExportedCommands\r\n---------- -------    ----                                ----------------\r\nManifest   1.0.4      Azure.Storage                       {Get-AzureStorageBlob, Get-AzureStorageBlobContent, Get-Az...\r\nManifest   1.0.4      AzureRM.ApiManagement               {Add-AzureRmApiManagementRegion, Get-AzureRmApiManagementS...\r\nManifest   1.0.4      AzureRM.Automation                  {Get-AzureRmAutomationJobOutputRecord, Import-AzureRmAutom...\r\nBinary     0.9.1      AzureRm.AzureStackAdmin             {Get-AzureRMManagedLocation, New-AzureRMManagedLocation, R...\r\nManifest   0.9.2      AzureRM.AzureStackStorage           {Add-ACSFarm, Get-ACSEvent, Get-ACSEventQuery, Get-ACSFarm...\r\nManifest   1.0.4      AzureRM.Backup                      {Backup-AzureRmBackupItem, Enable-AzureRmBackupContainerRe...\r\nManifest   1.0.4      AzureRM.Batch                       {Remove-AzureRmBatchAccount, Get-AzureRmBatchAccount, Get-...\r\nManifest   1.2.2      AzureRM.Compute                     {Remove-AzureRmAvailabilitySet, Get-AzureRmAvailabilitySet...\r\nManifest   1.0.4      AzureRM.DataFactories               {Remove-AzureRmDataFactory, Get-AzureRmDataFactoryRun, Get...\r\nManifest   1.0.4      AzureRM.DataLakeAnalytics           {Remove-AzureRmDataLakeAnalyticsCatalogSecret, Set-AzureRm...\r\nManifest   1.0.4      AzureRM.DataLakeStore               {Add-AzureRmDataLakeStoreItemContent, Export-AzureRmDataLa...\r\nManifest   1.0.4      AzureRM.Dns                         {Get-AzureRmDnsRecordSet, Remove-AzureRmDnsRecordSet, Set-...\r\nManifest   1.0.5      AzureRM.HDInsight                   {Get-AzureRmHDInsightJob, New-AzureRmHDInsightSqoopJobDefi...\r\nManifest   1.0.4      AzureRM.Insights                    {Add-AlertRule, Get-AlertHistory, Get-AlertRule, Remove-Al...\r\nManifest   1.1.3      AzureRM.KeyVault                    {Get-AzureRmKeyVault, New-AzureRmKeyVault, Remove-AzureRmK...\r\nManifest   1.0.4      AzureRM.Network                     {Add-AzureRmApplicationGatewayBackendAddressPool, Get-Azur...\r\nManifest   1.0.4      AzureRM.NotificationHubs            {Get-AzureRmNotificationHubsNamespaceAuthorizationRules, G...\r\nManifest   1.0.4      AzureRM.OperationalInsights         {Get-AzureRmOperationalInsightsSavedSearch, Get-AzureRmOpe...\r\nManifest   1.0.4      AzureRM.Profile                     {Enable-AzureRmDataCollection, Disable-AzureRmDataCollecti...\r\nManifest   1.0.5      AzureRM.RecoveryServices            {Get-AzureRmRecoveryServicesVault, Get-AzureRmRecoveryServ...\r\nManifest   1.1.2      AzureRM.RedisCache                  {Remove-AzureRmRedisCacheDiagnostics, Set-AzureRmRedisCach...\r\nManifest   1.0.4      AzureRM.Resources                   {Get-AzureRmADApplication, Get-AzureRmADGroupMember, Get-A...\r\nManifest   1.1.3      AzureRM.SiteRecovery                {Stop-AzureRmSiteRecoveryJob, Get-AzureRmSiteRecoveryNetwo...\r\nManifest   1.0.4      AzureRM.Sql                         {Get-AzureRmSqlDatabaseThreatDetectionPolicy, Set-AzureRmS...\r\nManifest   1.0.4      AzureRM.Storage                     {Get-AzureRmStorageAccount, Get-AzureRmStorageAccountKey, ...\r\nManifest   1.0.4      AzureRM.StreamAnalytics             {Get-AzureRmStreamAnalyticsFunction, Get-AzureRmStreamAnal...\r\nManifest   1.0.4      AzureRM.Tags                        {Remove-AzureRmTag, Get-AzureRmTag, New-AzureRmTag}\r\nManifest   1.0.4      AzureRM.TrafficManager              {Disable-AzureRmTrafficManagerEndpoint, Enable-AzureRmTraf...\r\nManifest   1.0.4      AzureRM.UsageAggregates             Get-UsageAggregates\r\nManifest   1.0.4      AzureRM.Websites                    {Get-AzureRmAppServicePlanMetrics, Get-AzureRmWebAppCertif...\r\n\r\n\r\n    Directory: C:\\Program Files (x86)\\Microsoft SDKs\\Azure\\PowerShell\\ServiceManagement\r\n\r\n\r\nModuleType Version    Name                                ExportedCommands\r\n---------- -------    ----                                ----------------\r\nManifest   1.0.4      Azure                               {Disable-AzureServiceProjectRemoteDesktop, Enable-AzureSer...\r\n```\r\n",
      "created_at": "2018-06-26T14:36:50Z",
      "updated_at": "2018-06-26T14:39:07Z"
    },
    {
      "author": "MaximoTrinidad",
      "author_association": "NONE",
      "body": "Then again, this is not the place for Windows PowerShell.  Only for PowerShell Core!\r\n\r\nIf you're experiencing issues with PowerShell Core, then which version you're having issues with.\r\n\r\nBy the way, did you know you can install SQLServer Module on PowerShell Core?  Give it a try!\r\n",
      "created_at": "2018-06-26T15:12:50Z",
      "updated_at": "2018-06-26T15:12:50Z"
    },
    {
      "author": "fMichaleczek",
      "author_association": "NONE",
      "body": "@MaximoTrinidad  I give a workaround in uservoice, you can close this issue.",
      "created_at": "2018-06-26T15:16:20Z",
      "updated_at": "2018-06-26T15:16:20Z"
    },
    {
      "author": "MaximoTrinidad",
      "author_association": "NONE",
      "body": "Awesome @fmichaleczek!\r\n\r\nBTW... Someone on the team needs to close this issue.  I can't!\r\n:)\r\n\r\nThanks",
      "created_at": "2018-06-26T15:17:47Z",
      "updated_at": "2018-06-26T15:19:01Z"
    }
  ],
  "created_at": "2018-06-26T14:11:33Z",
  "labels": [
    "Issue-Question",
    "Resolution-Answered"
  ],
  "number": 7180,
  "state": "closed",
  "title": "PowerShell does not return to current working location",
  "updated_at": "2018-06-29T14:56:37Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/12005",
  "author": "techvslife",
  "body": "Using powershell 7, the most recent preview 3 and the 64-bit version of MS Access:\r\n(note I also tried this solution (because Powershell may be confused by the optional arguments in the Run signature):\r\n$runArgs = @([System.Reflection.Missing]::Value) * 30\r\n$runArgs[0] = 'MyVBAFunction'\r\n$appAccess.Run($runArgs)\r\nbut that fails also. \r\nHow do I unpack $runArgs and pass it as 31 parameters to Application.Run (in Automation)?)\r\n\r\nThanks.\r\n\r\nThis may be a long-standing problem,\r\nhttps://social.technet.microsoft.com/Forums/en-US/654e81a7-e998-4575-9261-ad4d2507117a/how-to-invoke-ms-access-vba-function?forum=winserverpowershell\r\nand also see last comment by Kent Morstain here:\r\nhttps://www.excell-en.com/blog/2018/8/20/powershell-run-macros-copy-files-do-cool-stuff-with-power\r\n\r\nbut in general Powershell seems to be quirky with Access, unless I'm overlooking something obvious.  For example, it also seems to lose track of some functions:\r\n$appAccess.CloseCurrentDatabase()\r\nInvalidOperation: Method invocation failed because [System.__ComObject] does not contain a method named 'CloseCurrentDatabase'.\r\nBut it sees it this way:\r\n$appAccess.CloseCurrentDatabase\r\nOverloadDefinitions\r\n-------------------\r\nvoid CloseCurrentDatabase ()\r\n\r\n\r\n# Steps to reproduce\r\n\r\n```\r\n$appAccess = New-Object -ComObject Access.Application\r\n$appAccess.OpenCurrentDatabase(\"C:\\MyAccessDbs.accdb\")\r\n$appAccess.Run('MyVBAFunction')\r\n\r\n```\r\n\r\n# Expected behavior\r\n\r\n```\r\nNo error: run the VBA function in Access.\r\n\r\n```\r\n\r\n# Actual behavior\r\n\r\n```\r\nMethodInvocationException:\r\nLine |\r\n   3 |  $appAccess.Run('MyVBAFunction')\r\n     |  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n     | Exception calling \"Run\" with \"1\" argument(s): \"Number of parameters specified does not match the expected number.\"\r\n\r\n\r\n```\r\n\r\n# Environment data\r\n\r\n```\r\nName                           Value                                                     \r\n ----                           ----- \r\nPSVersion                      7.0.0-rc.3\r\nPSEdition                      Core                                                       \r\nGitCommitId                    7.0.0-rc.3\r\nOS                             Microsoft Windows 10.0.18363                             \r\nPlatform                       Win32NT                                                    \r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026} \r\nPSRemotingProtocolVersion      2.3                \r\nSerializationVersion           1.1.0.1               \r\nWSManStackVersion              3.0           \r\n\r\n```\r\n",
  "closed_at": null,
  "comments": [],
  "created_at": "2020-03-04T19:10:32Z",
  "labels": [
    "Issue-Question",
    "WG-Engine"
  ],
  "number": 12005,
  "state": "open",
  "title": "Automation of MS Access failing: may need 30 missing optional parameters passed...",
  "updated_at": "2021-01-16T05:21:07Z"
}
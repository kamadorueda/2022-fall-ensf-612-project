{
  "_url": "https://github.com/PowerShell/PowerShell/issues/7308",
  "author": "adamgauthier",
  "body": "## PR Summary\r\nUse `MetadataPropertyHandling.Ignore` in `JsonSerializerSettings` when Deserializing instead of the default (`MetadataPropertyHandling.Default`). Documentation on this option can be found [here](https://www.newtonsoft.com/json/help/html/P_Newtonsoft_Json_JsonSerializerSettings_MetadataPropertyHandling.htm) and [here](https://www.newtonsoft.com/json/help/html/T_Newtonsoft_Json_MetadataPropertyHandling.htm). Basically `Newtonsoft.Json` specific metadata properties like `$id`/`$type`/`$ref` are by default read and used by `Newtonsoft.Json` to deserialize into types, use the same instance for different properties, etc.\r\n\r\n`ConvertFrom-Json` deserializes into the generic type `PSCustomObject`, I *think* it doesn't make sense that these specific properties would not be converted as they are part of the json object. This restrict people from using these properties if they are not using `Newtonsoft.Json`, but even more likely, it restrict them from manipulating the entire raw json data of an object serialized with the library (which is probably what they want to do, otherwise they would be using the library directly to deserialize).\r\n\r\nI don't know how \"breaking\" of a change this is considered to be, I would assume not many people rely on the current behavior, but it is changing with this PR.\r\n\r\nFixes #7307\r\n\r\n## PR Checklist\r\n\r\n- [x] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - Use the present tense and imperative mood when describing your changes\r\n- [x] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [ ] [Change is not breaking](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)\r\n- [x] [Make sure all `.h`, `.cpp`, `.cs`, `.ps1` and `.psm1` files have the correct copyright header](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - If the PR is work in progress, please add the prefix `WIP:` to the beginning of the title and remove the prefix when the PR is ready.\r\n- **User-facing changes**\r\n    - [ ] Not Applicable\r\n    - **OR**\r\n    - [ ] User-facing [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n        - [ ] Issue filed - Issue link:\r\n- **Testing - New and feature**\r\n    - [ ] Not Applicable or can only be tested interactively\r\n    - **OR**\r\n    - [x] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n        - [ ] [Add `[feature]` if the change is significant or affects feature tests](https://github.com/PowerShell/PowerShell/blob/master/docs/testing-guidelines/testing-guidelines.md#requesting-additional-tests-for-a-pr)\r\n",
  "closed_at": "2018-07-25T03:56:50Z",
  "comments": [
    {
      "author": "dantraMSFT",
      "author_association": "CONTRIBUTOR",
      "body": "@louistio Would you mind rewording the title and the description for this PR.  The associated issue states that the metaproperties are not being converted yet the PR title appears to state that they should be ignored.\r\n\r\nThanks,",
      "created_at": "2018-07-18T17:31:37Z",
      "updated_at": "2018-07-18T17:31:37Z"
    },
    {
      "author": "adamgauthier",
      "author_association": "CONTRIBUTOR",
      "body": "@dantraMSFT Yes my bad, it is confusing, this PR stated to ignore them as in to tell the serializer not to do anything special with them, not to ignore them as in not convert them. I changed the title now. (I would also amend the commit message but I know you guys don't like rewriting history while a review is active)",
      "created_at": "2018-07-18T21:05:17Z",
      "updated_at": "2018-07-18T21:07:02Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@louistio Seems the header should be \"Don't convert ...\"",
      "created_at": "2018-07-20T03:55:00Z",
      "updated_at": "2018-07-20T03:55:00Z"
    },
    {
      "author": "markekraus",
      "author_association": "CONTRIBUTOR",
      "body": "Upon reviewing the issue, I do not believe this to be a breaking change as this appears to be a regression from 5.1. The behavior in 5.1 was to serialize the meta properties as object properties which is now broekn in 6.0. This PR corrects that regression and IMO is not a breaking change.",
      "created_at": "2018-07-20T10:03:00Z",
      "updated_at": "2018-07-20T10:03:00Z"
    },
    {
      "author": "adamgauthier",
      "author_association": "CONTRIBUTOR",
      "body": "@iSazonov I think there is confusion about the naming. The issue is that some values are not converted from `json` to `PSCustomObject`, because `Newtonsoft.Json` reads them and thinks they are metadata properties only useful for deserialization. This change makes `Newtonsoft.Json` \"ignore\" those properties so they are **converted** correctly from `json` to `PSCustomObject`. I'm not sure how naming this PR \"Don't convert\" would make much sense.",
      "created_at": "2018-07-20T20:42:51Z",
      "updated_at": "2018-07-20T20:42:51Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@dantraMSFT Do you have any comments?",
      "created_at": "2018-07-24T05:53:21Z",
      "updated_at": "2018-07-24T05:53:21Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@louistio Thanks for your contribution!",
      "created_at": "2018-07-25T03:57:08Z",
      "updated_at": "2018-07-25T03:57:08Z"
    }
  ],
  "created_at": "2018-07-18T01:31:25Z",
  "number": 7308,
  "state": "closed",
  "title": "Convert Newtonsoft.Json metadata properties in ConvertFrom-Json",
  "updated_at": "2018-07-25T03:57:08Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/14428",
  "author": "xtqqczze",
  "body": "Operator is available since .NET Framework 4.0.\r\n\r\nAlso, remove suppression of: \"PREfast 56515: converting to int32 and converting back into intptr.\"\r\n\r\nhttps://docs.microsoft.com/dotnet/api/system.intptr.op_addition",
  "closed_at": "2021-05-05T18:00:04Z",
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@xtqqczze Could you check the code is covered by tests from COM.Basic.Tests.ps1 ?",
      "created_at": "2020-12-16T07:34:30Z",
      "updated_at": "2020-12-16T07:34:30Z"
    },
    {
      "author": "xtqqczze",
      "author_association": "CONTRIBUTOR",
      "body": "> @xtqqczze Could you check the code is covered by tests from COM.Basic.Tests.ps1 ?\r\n\r\n`ComMethod.InvokeMethod`, `ComMethod.GetValue`, `ComMethod.SetValue` all have `ComUtil.GetParameterInformation` in call chain",
      "created_at": "2020-12-16T14:21:31Z",
      "updated_at": "2020-12-16T14:21:31Z"
    },
    {
      "author": "xtqqczze",
      "author_association": "CONTRIBUTOR",
      "body": "@iSazonov Breakpoint in `ComUtil.GetMethodSignatureFromFuncDesc` is hit from \"Should be able to enumerate 'IADsMembers' object\" test, while breakpoint in `ComUtil.GetParameterInformation` is not hit at all.",
      "created_at": "2020-12-16T14:33:54Z",
      "updated_at": "2020-12-16T14:33:54Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "> while breakpoint in `ComUtil.GetParameterInformation` is not hit at all.\r\n\r\nNot covered by tests? \r\n@SeeminglyScience Could please suggest how we could test this?",
      "created_at": "2020-12-16T16:00:58Z",
      "updated_at": "2020-12-16T16:00:58Z"
    },
    {
      "author": "SeeminglyScience",
      "author_association": "COLLABORATOR",
      "body": "> > while breakpoint in `ComUtil.GetParameterInformation` is not hit at all.\r\n> \r\n> Not covered by tests?\r\n> @SeeminglyScience Could please suggest how we could test this?\r\n\r\nAt a glance I'd say try something like:\r\n\r\n```powershell\r\n$shell = New-Object -ComObject Shell.Application\r\n$shell.NameSpace.OverloadDefinitions[0] -eq 'Folder NameSpace (Variant vDir)'\r\n```\r\n\r\nIf that doesn't work let me know I'll take a closer look.",
      "created_at": "2020-12-16T17:14:14Z",
      "updated_at": "2020-12-16T17:14:14Z"
    },
    {
      "author": "xtqqczze",
      "author_association": "CONTRIBUTOR",
      "body": "> ```powershell\r\n> $shell = New-Object -ComObject Shell.Application\r\n> $shell.NameSpace.OverloadDefinitions[0] -eq 'Folder NameSpace (Variant vDir)'\r\n> ```\r\n\r\n@SeeminglyScience This is not hitting my breakpoint in `ComUtil.GetParameterInformation` either.\r\n",
      "created_at": "2020-12-19T17:51:30Z",
      "updated_at": "2020-12-19T17:51:30Z"
    },
    {
      "author": "msftbot[bot]",
      "author_association": "NONE",
      "body": "This pull request has been automatically marked as Review Needed because it has been there has not been any activity for **7 days**.\nMaintainer, please provide feedback and/or mark it as `Waiting on Author`",
      "created_at": "2020-12-31T02:00:13Z",
      "updated_at": "2020-12-31T02:00:13Z"
    },
    {
      "author": "SeeminglyScience",
      "author_association": "COLLABORATOR",
      "body": "> @SeeminglyScience This is not hitting my breakpoint in `ComUtil.GetParameterInformation` either.\r\n\r\nLooks like it does get hit from that snippet, but only on the first invocation due to caching.",
      "created_at": "2020-12-31T14:56:23Z",
      "updated_at": "2020-12-31T14:56:23Z"
    },
    {
      "author": "SeeminglyScience",
      "author_association": "COLLABORATOR",
      "body": "> > @SeeminglyScience This is not hitting my breakpoint in `ComUtil.GetParameterInformation` either.\r\n> \r\n> Looks like it does get hit from that snippet, but only on the first invocation due to caching.\r\n\r\nLooks like `$shell.Namespace.Invoke('test')` will trigger it every invocation though.",
      "created_at": "2020-12-31T15:02:07Z",
      "updated_at": "2020-12-31T15:02:07Z"
    },
    {
      "author": "xtqqczze",
      "author_association": "CONTRIBUTOR",
      "body": "> > > @SeeminglyScience This is not hitting my breakpoint in `ComUtil.GetParameterInformation` either.\r\n> > \r\n> > \r\n> > Looks like it does get hit from that snippet, but only on the first invocation due to caching.\r\n> \r\n> Looks like `$shell.Namespace.Invoke('test')` will trigger it every invocation though.\r\n\r\n@iSazonov @SeeminglyScience  I am not sure if I can add any reasonable test for this. I can confirm that `ComUtil.GetParameterInformation` is hit on first invocation though.",
      "created_at": "2021-04-04T10:09:23Z",
      "updated_at": "2021-04-04T10:09:23Z"
    },
    {
      "author": "xtqqczze",
      "author_association": "CONTRIBUTOR",
      "body": "rebased",
      "created_at": "2021-04-04T10:21:27Z",
      "updated_at": "2021-04-04T10:21:27Z"
    },
    {
      "author": "msftbot[bot]",
      "author_association": "NONE",
      "body": "This pull request has been automatically marked as stale because it has been marked as requiring author feedback but has not had any activity for **15 days**. It will be closed if no further activity occurs **within 10 days of this comment**.",
      "created_at": "2021-04-25T17:00:06Z",
      "updated_at": "2021-04-25T17:00:06Z"
    }
  ],
  "created_at": "2020-12-15T14:47:38Z",
  "number": 14428,
  "state": "closed",
  "title": " Use IntPtr.Addition(IntPtr, Int32) Operator",
  "updated_at": "2021-05-05T18:00:04Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/16188",
  "author": "cfuendesign",
  "body": "### Prerequisites\n\n- [X] Write a descriptive title.\n- [X] Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\n- [X] Search the existing issues.\n- [X] Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\n- [X] Refer to [Differences between Windows PowerShell 5.1 and PowerShell](https://docs.microsoft.com/powershell/scripting/whats-new/differences-from-windows-powershell).\n\n### Steps to reproduce\n\n```\r\nPS C:\\Users\\cfuen\\Desktop> cd \"C:\\Program Files\\WindowsApps\\Microsoft.MicrosoftStickyNotes_4.1.6.0_x64__8wekyb3d8bbwe\"\r\nPS C:\\Program Files\\WindowsApps\\Microsoft.MicrosoftStickyNotes_4.1.6.0_x64__8wekyb3d8bbwe> .\\Microsoft.Notes.exe\r\n```\n\n### Expected behavior\n\n```console\nMS Sticky Notes should launch\n```\n\n\n### Actual behavior\n\n```console\nResourceUnavailable: Program 'Microsoft.Notes.exe' failed to run: Acceso denegado.At line:1 char:1\r\n+ .\\Microsoft.Notes.exe\r\n+ ~~~~~~~~~~~~~~~~~~~~~.\n```\n\n\n### Error details\n\n```console\nException             :\r\n    Type           : System.Management.Automation.ApplicationFailedException\r\n    ErrorRecord    :\r\n        Exception             :\r\n            Type    : System.Management.Automation.ParentContainsErrorRecordException\r\n            Message : Program 'Microsoft.Notes.exe' failed to run: Acceso denegado.At line:1 char:1\r\n                      + .\\Microsoft.Notes.exe\r\n                      + ~~~~~~~~~~~~~~~~~~~~~.\r\n            HResult : -2146233087\r\n        CategoryInfo          : ResourceUnavailable: (:) [], ParentContainsErrorRecordException\r\n        FullyQualifiedErrorId : NativeCommandFailed\r\n        InvocationInfo        :\r\n            ScriptLineNumber : 1\r\n            OffsetInLine     : 1\r\n            HistoryId        : -1\r\n            Line             : .\\Microsoft.Notes.exe\r\n            PositionMessage  : At line:1 char:1\r\n                               + .\\Microsoft.Notes.exe\r\n                               + ~~~~~~~~~~~~~~~~~~~~~\r\n            CommandOrigin    : Internal\r\n        ScriptStackTrace      : at <ScriptBlock>, <No file>: line 1\r\n    TargetSite     :\r\n        Name          : InitNativeProcess\r\n        DeclaringType : System.Management.Automation.NativeCommandProcessor, System.Management.Automation, Version=7.1.4.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\r\n        MemberType    : Method\r\n        Module        : System.Management.Automation.dll\r\n    StackTrace     :\r\n   at System.Management.Automation.NativeCommandProcessor.InitNativeProcess()\r\n   at System.Management.Automation.NativeCommandProcessor.Prepare(IDictionary psDefaultParameterValues)\r\n   at System.Management.Automation.CommandProcessorBase.DoPrepare(IDictionary psDefaultParameterValues)\r\n   at System.Management.Automation.Internal.PipelineProcessor.Start(Boolean incomingStream)\r\n   at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)\r\n--- End of stack trace from previous location ---\r\n   at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)\r\n   at System.Management.Automation.PipelineOps.InvokePipeline(Object input, Boolean ignoreInput, CommandParameterInternal[][] pipeElements, CommandBaseAst[] pipeElementAsts,\r\nCommandRedirection[][] commandRedirections, FunctionContext funcContext)\r\n   at System.Management.Automation.Interpreter.ActionCallInstruction`6.Run(InterpretedFrame frame)\r\n   at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame)\r\n    Message        : Program 'Microsoft.Notes.exe' failed to run: Acceso denegado.At line:1 char:1\r\n                     + .\\Microsoft.Notes.exe\r\n                     + ~~~~~~~~~~~~~~~~~~~~~.\r\n    Data           : System.Collections.ListDictionaryInternal\r\n    InnerException :\r\n        Type            : System.ComponentModel.Win32Exception\r\n        NativeErrorCode : 5\r\n        ErrorCode       : -2147467259\r\n        TargetSite      :\r\n            Name          : StartWithShellExecuteEx\r\n            DeclaringType : System.Diagnostics.Process\r\n            MemberType    : Method\r\n            Module        : System.Diagnostics.Process.dll\r\n        StackTrace      :\r\n   at System.Diagnostics.Process.StartWithShellExecuteEx(ProcessStartInfo startInfo)\r\n   at System.Diagnostics.Process.Start()\r\n   at System.Management.Automation.NativeCommandProcessor.InitNativeProcess()\r\n        Message         : Acceso denegado.\r\n        Source          : System.Diagnostics.Process\r\n        HResult         : -2147467259\r\n    Source         : System.Management.Automation\r\n    HResult        : -2146233087\r\nCategoryInfo          : ResourceUnavailable: (:) [], ApplicationFailedException\r\nFullyQualifiedErrorId : NativeCommandFailed\r\nInvocationInfo        :\r\n    ScriptLineNumber : 1\r\n    OffsetInLine     : 1\r\n    HistoryId        : -1\r\n    Line             : .\\Microsoft.Notes.exe\r\n    PositionMessage  : At line:1 char:1\r\n                       + .\\Microsoft.Notes.exe\r\n                       + ~~~~~~~~~~~~~~~~~~~~~\r\n    CommandOrigin    : Internal\r\nScriptStackTrace      : at <ScriptBlock>, <No file>: line 1\n```\n\n\n### Environment data\n\n```powershell\nName                           Value\r\n----                           -----\r\nPSVersion                      7.1.4\r\nPSEdition                      Core\r\nGitCommitId                    7.1.4\r\nOS                             Microsoft Windows 10.0.19043\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\n```\n\n\n### Visuals\n\n![image](https://user-images.githubusercontent.com/65634520/135739564-2057b321-ef3c-4296-aa54-c367b8d1ffef.png)\r\n",
  "closed_at": "2021-10-05T00:00:36Z",
  "comments": [
    {
      "author": "jborean93",
      "author_association": "COLLABORATOR",
      "body": "AFAIK you\u2019re not meant to be running executables from `C:\\Program Files\\WindowsApps` directly but rather through an AppExecLink usually stored in your user profile. The reason the link is required is because Windows applies special logic to the user token to allow it to run sandboxed applications.",
      "created_at": "2021-10-03T05:25:56Z",
      "updated_at": "2021-10-03T05:26:14Z"
    },
    {
      "author": "rkeithhill",
      "author_association": "COLLABORATOR",
      "body": "I was able to open the Sticky Notes app using:\r\n```\r\nexplorer.exe shell:AppsFolder\\Microsoft.MicrosoftStickyNotes_8wekyb3d8bbwe!App\r\n```\r\nSee this post on how to open store apps from the command line: https://answers.microsoft.com/en-us/windows/forum/windows_10-windows_store/starting-windows-10-store-app-from-the-command/836354c5-b5af-4d6c-b414-80e40ed14675\r\n\r\nAnd due to an issue with the Appx module (#13138), you'll need to import it like so:\r\n```\r\nimport-module appx -usewindowspowershell\r\n```",
      "created_at": "2021-10-03T18:14:35Z",
      "updated_at": "2021-10-03T18:24:00Z"
    },
    {
      "author": "msftbot[bot]",
      "author_association": "NONE",
      "body": "This issue has been marked as answered and has not had any activity for **1 day**. It has been closed for housekeeping purposes.",
      "created_at": "2021-10-05T00:00:35Z",
      "updated_at": "2021-10-05T00:00:35Z"
    }
  ],
  "created_at": "2021-10-03T04:20:48Z",
  "labels": [
    "Issue-Question",
    "Resolution-Answered"
  ],
  "number": 16188,
  "state": "closed",
  "title": "Trouble opening MS Sticky Notes from Powershell",
  "updated_at": "2021-10-05T00:00:36Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/3487",
  "author": "iSazonov",
  "body": "GetEncodingFromEnum and TextEncodingType is not used.\r\nGetEncodingFromEnum duplicate a code\r\n- in [FileSystemProvider.cs\r\n](https://github.com/PowerShell/PowerShell/blob/master/src/System.Management.Automation/namespaces/FileSystemProvider.cs#L7528)\r\n- in [Utils.cs](https://github.com/PowerShell/PowerShell/blob/master/src/System.Management.Automation/engine/Utils.cs#L1375)\r\n",
  "closed_at": "2017-04-22T01:07:54Z",
  "comments": [
    {
      "author": "dantraMSFT",
      "author_association": "CONTRIBUTOR",
      "body": "Even though the code is not referenced in PowerShell; the change should probably be reviewed See https://msdn.microsoft.com/en-us/library/microsoft.powershell.commands.textencodingtype(v=vs.85).aspx\r\n",
      "created_at": "2017-04-10T19:31:56Z",
      "updated_at": "2017-04-10T19:31:56Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@dantraMSFT Good catch! Thanks!  From the docs:\r\n>The members of this class cannot be used directly, nor should this class be used to derive other classes\r\n\r\nSo it is breaking change but formally.\r\n\r\nWe have another place with the same duplication:\r\nhttps://github.com/PowerShell/PowerShell/blob/master/src/System.Management.Automation/engine/Utils.cs#L1375\r\nand this is only used in one place:\r\nhttps://github.com/PowerShell/PowerShell/blob/master/src/System.Management.Automation/engine/hostifaces/MshHostUserInterface.cs#L1077\r\nWe should remove this one too.\r\n\r\n(It will be easier for us to implement our Encoding RFC if we do this cleanup code.)\r\n\r\n",
      "created_at": "2017-04-11T05:47:34Z",
      "updated_at": "2017-04-11T05:47:34Z"
    },
    {
      "author": "dantraMSFT",
      "author_association": "CONTRIBUTOR",
      "body": "@iSazonov without understanding why these types are causing you issues; my suggestion is for both FileSystemProvider and TranscriptionOption depend on Utils.GetEncodingFromEnum. It doesn't make sense to me to have TranscriptionOption depend on FileSystemProvider.",
      "created_at": "2017-04-11T23:33:37Z",
      "updated_at": "2017-04-11T23:33:37Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@dantraMSFT Thanks! I agree and I've added the appropriate commit.",
      "created_at": "2017-04-12T10:04:06Z",
      "updated_at": "2017-04-12T10:04:06Z"
    },
    {
      "author": "HemantMahawar",
      "author_association": "CONTRIBUTOR",
      "body": "@PowerShell/powershell-committee reviewed and agreed that we should NOT be removing public api without any good reason.",
      "created_at": "2017-04-12T23:35:33Z",
      "updated_at": "2017-04-12T23:35:33Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@HemantMahawar Thanks! Whether the committee had considered the causes: \r\n1. The API don't used internal.\r\n2. The API is duplicated in another two places with non-public API.\r\n3. Docs says that the API not really public \"The members of this class cannot be used directly, nor should this class be used to derive other classes\".\r\n4. The API looks as temporary, PowerShell engine is not \"encoding library\" and adds no benefits - anyone can use directly similar encoding APIs from .Net Core.  \r\n5. To implement our future encoding RFC we have to fix all encoding API (it is already obvious that we will have to make any changes) including the \"public\" API or leave it \"as is\" with legacy behavior (for what?). It makes sense to minimize the places where changes are needed. After this PR, we'll have only two such API's - in Util.cs and PathUtils.cs - later we can merge them into one and get common encoding behavior throughout all code. Otherwise, the RFC will add another layer of complexity.",
      "created_at": "2017-04-13T10:59:12Z",
      "updated_at": "2017-04-13T11:00:28Z"
    },
    {
      "author": "lzybkr",
      "author_association": "MEMBER",
      "body": "The internal api is fine to remove.\r\n\r\nThe public api should not be removed. It's unfortunate, but removing a public api is a breaking change with existing binaries and scripts, so it's not safe to remove. Despite our intentions and documentation, third party code can still depend on the api and removing it should have a strong justification, which I don't see here.\r\n\r\nI suggest:\r\n\r\n* Remove the unnecessary public api from our reference assemblies if that is appropriate - then no new code binary code can depend on it\r\n* Mark the api as obsolete.\r\n* Not sure which docs you're referring to - but a public enum is very usable anywhere, so we should fix the docs that say the members cannot be used...",
      "created_at": "2017-04-17T17:24:53Z",
      "updated_at": "2017-04-17T17:24:53Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@lzybkr Thanks! I'd revert the API.\r\n>\u2022Remove the unnecessary public api from our reference assemblies\r\n\r\nI don't know how?\r\n\r\n>\u2022Mark the api as obsolete\r\n\r\n~Place a comment in code?~ Fixed.\r\n\r\n>\u2022Not sure which docs you're referring to - but a public enum is very usable anywhere, so we should fix the docs that say the members cannot be used\r\n\r\nThe docs is ready https://msdn.microsoft.com/en-us/library/microsoft.powershell.commands.textencodingtype%28v=vs.85%29.aspx \r\n",
      "created_at": "2017-04-17T17:57:53Z",
      "updated_at": "2017-04-20T13:16:54Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Default path is fixed.",
      "created_at": "2017-04-21T07:46:55Z",
      "updated_at": "2017-04-21T07:46:55Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@dantraMSFT @lzybkr Thanks for the review and useful comments. \ud83d\udc4d ",
      "created_at": "2017-04-22T11:02:38Z",
      "updated_at": "2017-04-22T11:02:38Z"
    }
  ],
  "created_at": "2017-04-05T11:53:48Z",
  "number": 3487,
  "state": "closed",
  "title": "Remove unused and duplicated GetEncodingFromEnum",
  "updated_at": "2018-09-28T12:34:00Z"
}
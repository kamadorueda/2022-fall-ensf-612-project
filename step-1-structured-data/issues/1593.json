{
  "_url": "https://github.com/PowerShell/PowerShell/issues/1593",
  "author": "ealexjordan",
  "body": "- [X] Resolves issue #291 \n- [X] Code is [rebased](https://github.com/PowerShell/PowerShell/blob/master/docs/git/README.md#sync-your-local-repo) on `origin/master`.\n- [NA] Add tests that fail without your changes.\n- [NA] Update all relevant [documentation](https://github.com/PowerShell/PowerShell/tree/master/docs).\n",
  "closed_at": "2016-08-03T17:37:20Z",
  "comments": [
    {
      "author": "lzybkr",
      "author_association": "MEMBER",
      "body": "Why are there binary files added?\nCan you also rebase to get rid of the merge commits?\n",
      "created_at": "2016-08-01T21:41:49Z",
      "updated_at": "2016-08-01T21:41:49Z"
    },
    {
      "author": "lzybkr",
      "author_association": "MEMBER",
      "body": "LGTM - but I'll let @andschwa sign off before merging.\n",
      "created_at": "2016-08-02T21:52:32Z",
      "updated_at": "2016-08-02T21:52:32Z"
    },
    {
      "author": "andschwa",
      "author_association": "MEMBER",
      "body": "I was previously confused thinking we would need to use `ResetColors()` to get back to default colors, but I've been corrected. Indeed if you set `Console.BackgroundColor` in C# to `-1` aka `UnknownColor` (as defined internally in `System.Console`, and returned by `Console.BackgroundColor` if it's not been set), .NET Core does the right thing and uses the system's set background color. So with these changes (to remove my guard around `$host.UI.RawUI.BackgroundColor`, error reporting etc. can freely change the background color, and then have it change back correctly.\n\nThis means that `$host.UI.RawUI.BackgroundColor` is very likely to report `-1`, but that is the valid value from .NET, and attempting to guard it breaks the ability to go back to default colors. Unfortunately, PowerShell does not allow `-1` to be used as it is not in the public enum declaration; so `[Console]::BackgroundColor = -1 -as [ConsoleColor]` fails. @lzybkr, @vors, I'm not sure if anything can be done about this, but it's valid to do in C#.\n\nAnyway, I sign off.\n",
      "created_at": "2016-08-02T23:13:12Z",
      "updated_at": "2016-08-02T23:13:12Z"
    }
  ],
  "created_at": "2016-08-01T19:26:50Z",
  "number": 1593,
  "state": "closed",
  "title": "Ealexjordan/pscolors",
  "updated_at": "2020-05-27T20:44:59Z"
}
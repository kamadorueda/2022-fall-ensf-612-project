{
  "_url": "https://github.com/PowerShell/PowerShell/issues/3556",
  "author": "daxian-dbw",
  "body": "This change moves powershell to .NET Core 2.0. Major changes are:\r\n1. PowerShell assemblies are now targeting `netcoreapp2.0`. We are using `microsoft.netcore.app-2.0.0-preview1-001913-00`, which is from dotnet-core build 4/4/17. We cannot target `netstandard2.0` because the packages `System.Reflection.Emit` and `System.Reflection.Emit.Lightweight`, which are needed for powershell class, cannot be referenced when targeting `netstandard2.0`.\r\n2. Refactor code to remove most CLR stub types and extension types.\r\n3. Update build scripts to enable CI builds. ~~Note that the `-cache` option is removed from `appveyor.yml`, but it probably should be added back after this PR is merged.~~ The `-cache` section is added back and specified to depend on `appveyor.yml`, so the cache will be invalidated if `appveyor.yml` is changed. Thanks to @TravisEz13 \r\n4. Ship `netcoreapp` reference assemblies with powershell to fix the issues in `Add-Type` (#2764). By default `Add-Type` will reference all those reference assemblies when compiling C# code. If `-ReferenceAssembly` is specified, then we search reference assemblies first, then the framework runtime assemblies, and lastly the loaded assemblies (possibly a third-party one that was already loaded).\r\n5. `dotnet publish` generates executable on Unix platforms, but doesn't set \"x\" permission and thus it cannot execute. Currently, the \"x\" permission is set in the build script, `dotnet/cli` issue [#6286](https://github.com/dotnet/cli/issues/6286) is tracking this.\r\n6. Replace the use of some APIs with the ones that take `SecureString`.\r\n7. osx.10.12 is required to update to `netcoreapp2.0` because `dotnet-cli` 2.0.0-preview only works on osx.10.12.\r\n8. Add dependency to `System.ValueTuple` to work around a ambiguous type identity issue in coreclr. The issue is tracked by `dotnet/corefx` [#17797](https://github.com/dotnet/corefx/issues/17797). When moving to newer version of `netcoreapp2.0`, we need to verify if this dependency is still needed.",
  "closed_at": "2017-04-17T18:52:38Z",
  "comments": [
    {
      "author": "lzybkr",
      "author_association": "MEMBER",
      "body": "@vors - can you review AddType.cs?",
      "created_at": "2017-04-14T02:16:59Z",
      "updated_at": "2017-04-14T02:16:59Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@TravisEz13 @lzybkr @vors comments have been addressed, could you please continue the review? Thanks!",
      "created_at": "2017-04-14T20:23:34Z",
      "updated_at": "2017-04-14T20:23:34Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@TravisEz13 @vors @lzybkr Thanks for the review!",
      "created_at": "2017-04-17T18:53:22Z",
      "updated_at": "2017-04-17T18:53:22Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@daxian-dbw Great work! Thanks!",
      "created_at": "2017-04-18T02:59:45Z",
      "updated_at": "2017-04-18T02:59:45Z"
    }
  ],
  "created_at": "2017-04-13T21:33:37Z",
  "number": 3556,
  "state": "closed",
  "title": "Move powershell to .NET Core 2.0",
  "updated_at": "2017-04-18T02:59:46Z"
}
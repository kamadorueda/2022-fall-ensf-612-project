{
  "_url": "https://github.com/PowerShell/PowerShell/issues/3778",
  "author": "SteveL-MSFT",
  "body": "Base for HttpListener module needed for my upcoming changes to web cmdlets to add Link Header traversal.  We should also be able to build upon this to remove dependency on some of the external web sites we use to test the web cmdlets and bring them back to CI instead of Feature.",
  "closed_at": "2017-05-18T22:02:20Z",
  "comments": [
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@iSazonov \r\n\r\n1. usage should be via local loopback so firewall shouldn't be issue (worked when tested on win10 and ubuntu16)\r\n\r\n2. I'll add HTTPS when I remove usage of badssl.com tests\r\n\r\n3. Port is settable\r\n\r\n4. HttpListener I believe uses http.sys on Windows which requires elevation to reserve URL\r\n\r\n5. This should allow for pretty fine control for testing without need for full webserver that is cross platform and not needing install",
      "created_at": "2017-05-13T22:40:14Z",
      "updated_at": "2017-05-13T22:42:14Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "Looks like you no longer have to be elevated with corefx, so removed that check",
      "created_at": "2017-05-14T04:37:42Z",
      "updated_at": "2017-05-14T04:37:42Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Could you add HTTPS now to avoid wasting time then?",
      "created_at": "2017-05-14T16:32:39Z",
      "updated_at": "2017-05-14T16:32:39Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "HTTPS will require more work as I'll need to figure out how to generate certs for each platform.  For my LinkHeader feature, I don't need HTTPS",
      "created_at": "2017-05-14T21:05:05Z",
      "updated_at": "2017-05-14T21:05:05Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "We can generate the client and server certificates in advance and put it in the repo in asserts folder.",
      "created_at": "2017-05-15T09:03:24Z",
      "updated_at": "2017-05-15T09:03:24Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@iSazonov good idea, I'll work on that",
      "created_at": "2017-05-15T17:21:35Z",
      "updated_at": "2017-05-15T17:21:35Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Sample https://github.com/PowerShell/PowerShell/blob/76de340e790171c16193f3a19ce33410e495c319/test/powershell/Modules/Microsoft.PowerShell.Security/CmsMessage.Tests.ps1",
      "created_at": "2017-05-15T17:46:58Z",
      "updated_at": "2017-05-15T17:46:58Z"
    },
    {
      "author": "anmenaga",
      "author_association": "CONTRIBUTOR",
      "body": "@SteveL-MSFT As we are using this in test automation, we should ensure that both tests and this server side are following HTTP spec (specifically, response headers).",
      "created_at": "2017-05-15T21:15:17Z",
      "updated_at": "2017-05-15T21:15:17Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@anmenaga httplistener class itself should be returning appropriate response headers for basic payloads, it will be up to the tests to add specific response headers depending on the test",
      "created_at": "2017-05-16T18:13:37Z",
      "updated_at": "2017-05-16T18:13:37Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@iSazonov looks like I have to use httpcfg.exe on Windows to configure use of SSL cert.  Let's defer HTTPS support for now.  I primarily need this in to test my upcoming linkheader traversal change to the webcmdlets as I need to be able to control exactly what is returned in the link header.",
      "created_at": "2017-05-16T18:20:49Z",
      "updated_at": "2017-05-16T18:20:49Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Yes, I agree.\r\nhttps://blogs.msdn.microsoft.com/jpsanders/2009/09/29/how-to-walkthrough-using-httplistener-or-http-server-unmanaged-code-c-as-an-ssl-simple-server/",
      "created_at": "2017-05-16T18:34:10Z",
      "updated_at": "2017-05-16T18:34:10Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@iSazonov are you ok with the current changes?  if so, can you approve?",
      "created_at": "2017-05-17T17:20:31Z",
      "updated_at": "2017-05-17T17:20:31Z"
    }
  ],
  "created_at": "2017-05-12T23:38:34Z",
  "number": 3778,
  "state": "closed",
  "title": "Test HttpListener so that PowerShell Core tests don't have to rely on an internet web service",
  "updated_at": "2017-06-19T21:16:14Z"
}
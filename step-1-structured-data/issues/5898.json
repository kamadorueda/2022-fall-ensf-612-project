{
  "_url": "https://github.com/PowerShell/PowerShell/issues/5898",
  "author": "p0w3rsh3ll",
  "body": "\r\n\r\n\r\n<!--\r\n\r\nFor Windows PowerShell 5.1 issues, suggestions, or feature requests please use the following link instead:\r\n- Windows PowerShell [UserVoice](https://windowsserver.uservoice.com/forums/301869-powershell)\r\n\r\nIf it is a bug report:\r\n- make sure you are able to repro it on the latest released version. \r\nYou can install the latest version from https://github.com/PowerShell/PowerShell/releases\r\n- Search the existing issues.\r\n- Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\r\n- Refer to the [known issues](https://github.com/PowerShell/PowerShell/blob/master/docs/KNOWNISSUES.md).\r\n- Fill out the following repro template:\r\n\r\nIf it's not a bug, please remove the template and elaborate the issue in your own words.\r\n-->\r\n\r\nThere's already an opened issue for the content of the zip package  https://github.com/PowerShell/PowerShell/issues/3753 but I want to mention that the the zip packages (x86 and x64) as well as the content of the msi packages (x64 at least, that I tested) contain [UnSigned dll files](https://p0w3rsh3ll.files.wordpress.com/2018/01/pwsh-600-notsigned-files.jpg).\r\n\r\nSteps to reproduce\r\n------------------\r\n\r\n\r\n```powershell\r\n#region x64 zip\r\nInvoke-WebRequest -Uri 'https://github.com/PowerShell/PowerShell/releases/download/v6.0.0/PowerShell-6.0.0-win-x64.zip' -OutFile ~/Downloads/PowerShell-6.0.0-win-x64.zip\r\n\r\n(Get-FileHash -Path ~/Downloads/PowerShell-6.0.0-win-x64.zip -Algorithm SHA256).Hash -eq 'FE6C17E9829FFD0503917A1A4ACC3E75A203A80B28E2D9EFFDD7F0AB576F7D5D'\r\n\r\nExpand-Archive -Path  ~/Downloads/PowerShell-6.0.0-win-x64.zip -DestinationPath ~/Downloads/PowerShell-6.0.0-win-x64\r\n\r\nGet-AuthenticodeSignature -FilePath ~/Downloads/PowerShell-6.0.0-win-x64/* | Where Status -eq 'NotSigned'\r\n#endregion\r\n\r\n#region x86 zip\r\nInvoke-WebRequest -Uri 'https://github.com/PowerShell/PowerShell/releases/download/v6.0.0/PowerShell-6.0.0-win-x86.zip' -OutFile ~/Downloads/PowerShell-6.0.0-win-x86.zip\r\n\r\n(Get-FileHash -Path ~/Downloads/PowerShell-6.0.0-win-x86.zip -Algorithm SHA256).Hash -eq '8E32785547FDD90412FA3A8FA4703D272933999F3D29CAE9FEDA19119B3A2D46'\r\n\r\nExpand-Archive -Path ~/Downloads/PowerShell-6.0.0-win-x86.zip -DestinationPath ~/Downloads/PowerShell-6.0.0-win-x86\r\n\r\nGet-AuthenticodeSignature -FilePath ~/Downloads/PowerShell-6.0.0-win-x86/* | Where Status -eq 'NotSigned'\r\n\r\n#endregion\r\n\r\n#region x64 msi\r\nInvoke-WebRequest -Uri 'https://github.com/PowerShell/PowerShell/releases/download/v6.0.0/PowerShell-6.0.0-win-x64.msi'  -OutFile ~/Downloads/PowerShell-6.0.0-win-x64.msi\r\n\r\n(Get-FileHash -Path ~/Downloads/PowerShell-6.0.0-win-x64.msi -Algorithm SHA256).Hash -eq 'A1155D0F9D697B3EBF51C03D328886F9000709C1C4688DA42FF9C234AF02A63F'\r\n\r\nGet-AuthenticodeSignature -FilePath ~/Downloads/PowerShell-6.0.0-win-x64.msi\r\n\r\nmsiexec.exe /i  ~/Downloads/PowerShell-6.0.0-win-x64.msi\r\n\r\n$null -ne @(Get-AuthenticodeSignature -FilePath \"C:\\Program Files\\PowerShell\\6.0.0\\*\" | Where Status -eq 'NotSigned')\r\n#endregion\r\n\r\n```\r\n\r\n\r\n\r\nExpected behavior\r\n-----------------\r\n\r\n```powershell\r\n$null -eq @(Get-AuthenticodeSignature -FilePath \"C:\\Program Files\\PowerShell\\6.0.0\\*\" | `\r\nWhere Status -eq 'NotSigned')\r\n```\r\n\r\nActual behavior\r\n---------------\r\n\r\n```powershell\r\n$null -ne @(Get-AuthenticodeSignature -FilePath \"C:\\Program Files\\PowerShell\\6.0.0\\*\" | `\r\nWhere Status -eq 'NotSigned')\r\n```\r\n\r\nEnvironment data\r\n----------------\r\n\r\n<!-- provide the output of $PSVersionTable -->\r\n\r\n```powershell\r\n> $PSVersionTable\r\nName                           Value\r\n----                           -----\r\nPSVersion                      6.0.0\r\nPSEdition                      Core\r\nGitCommitId                    v6.0.0\r\nOS                             Microsoft Windows 10.0.16299\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n",
  "closed_at": "2018-05-26T17:48:41Z",
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "/cc @daxian-dbw ",
      "created_at": "2018-01-13T17:46:58Z",
      "updated_at": "2018-01-13T17:46:58Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "We sign all the PowerShell assemblies and scripts (including `.ps1xml` files). The .NET Core assemblies are not produced by powershell, and thus we don't sign them. /cc @TravisEz13 \r\n\r\nSome .NET Core assemblies are not signed by their owners:\r\n```\r\n[F:\\tmp\\PowerShell-6.0.0-win-x64]\r\nPS:48> Get-AuthenticodeSignature * | Where Status -eq 'NotSigned' | select -Property Status, Path\r\n\r\n   Status Path\r\n   ------ ----\r\nNotSigned F:\\tmp\\PowerShell-6.0.0-win-x64\\Microsoft.CodeAnalysis.CSharp.dll\r\nNotSigned F:\\tmp\\PowerShell-6.0.0-win-x64\\Microsoft.CodeAnalysis.dll\r\nNotSigned F:\\tmp\\PowerShell-6.0.0-win-x64\\Microsoft.CSharp.dll\r\nNotSigned F:\\tmp\\PowerShell-6.0.0-win-x64\\Microsoft.PowerShell.PSReadLine.dll\r\nNotSigned F:\\tmp\\PowerShell-6.0.0-win-x64\\Microsoft.PowerShell.SDK.dll\r\nNotSigned F:\\tmp\\PowerShell-6.0.0-win-x64\\Microsoft.Win32.Registry.dll\r\nNotSigned F:\\tmp\\PowerShell-6.0.0-win-x64\\Newtonsoft.Json.dll\r\nNotSigned F:\\tmp\\PowerShell-6.0.0-win-x64\\System.Collections.Concurrent.dll\r\nNotSigned F:\\tmp\\PowerShell-6.0.0-win-x64\\System.Collections.dll\r\nNotSigned F:\\tmp\\PowerShell-6.0.0-win-x64\\System.Collections.Specialized.dll\r\nNotSigned F:\\tmp\\PowerShell-6.0.0-win-x64\\System.Console.dll\r\nNotSigned F:\\tmp\\PowerShell-6.0.0-win-x64\\System.Diagnostics.FileVersionIn...\r\nNotSigned F:\\tmp\\PowerShell-6.0.0-win-x64\\System.Diagnostics.Process.dll\r\nNotSigned F:\\tmp\\PowerShell-6.0.0-win-x64\\System.IO.FileSystem.dll\r\nNotSigned F:\\tmp\\PowerShell-6.0.0-win-x64\\System.IO.Pipes.dll\r\nNotSigned F:\\tmp\\PowerShell-6.0.0-win-x64\\System.Linq.dll\r\nNotSigned F:\\tmp\\PowerShell-6.0.0-win-x64\\System.Linq.Expressions.dll\r\nNotSigned F:\\tmp\\PowerShell-6.0.0-win-x64\\System.Private.Uri.dll\r\nNotSigned F:\\tmp\\PowerShell-6.0.0-win-x64\\System.Runtime.Extensions.dll\r\nNotSigned F:\\tmp\\PowerShell-6.0.0-win-x64\\System.Security.AccessControl.dll\r\nNotSigned F:\\tmp\\PowerShell-6.0.0-win-x64\\System.Security.Principal.Window...\r\nNotSigned F:\\tmp\\PowerShell-6.0.0-win-x64\\System.Text.Encoding.CodePages.dll\r\nNotSigned F:\\tmp\\PowerShell-6.0.0-win-x64\\System.Threading.dll\r\nNotSigned F:\\tmp\\PowerShell-6.0.0-win-x64\\System.Threading.Tasks.Parallel.dll\r\n```\r\nJust to clarify\r\n- the `Microsoft.PowerShell.PSReadLine.dll` is a third-party assembly, and thus we don't sign it.\r\n- the `Microsoft.PowerShell.SDK.dll` is a build artifact and it's empty, and thus we don't sign it.",
      "created_at": "2018-01-16T19:05:46Z",
      "updated_at": "2018-01-16T19:10:36Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "Our current process is set up to ensure that PowerShell does not sign any file that is not built by PowerShell.  Except for the following two files, it would be difficult for us to start signing most of these files.\r\n\r\nThese two files we don't sign for special reasons:\r\n- the `Microsoft.PowerShell.PSReadLine.dll` is a third-party assembly, and thus we don't sign it and will be removed from our repo in the future.\r\n- the `Microsoft.PowerShell.SDK.dll` is a build artifact and it's empty, and thus we don't sign it and hopefully will be removed from the build when the bug that causes it is fixed.",
      "created_at": "2018-01-16T22:38:30Z",
      "updated_at": "2018-01-16T22:38:30Z"
    }
  ],
  "created_at": "2018-01-13T17:11:41Z",
  "labels": [
    "Issue-Question",
    "Area-Maintainers-Build",
    "Resolution-Answered"
  ],
  "number": 5898,
  "state": "closed",
  "title": "zip and msi content digital signature of release 6.0.0",
  "updated_at": "2018-05-26T17:48:41Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/6774",
  "author": "mcbobke",
  "body": "## PR Summary\r\n\r\n#5228 was originally fixed by #6600, however this caused a regression as noted in #6749. Using `Set-Location` to change to a different drive such as `Set-Location D:` will fail to restore the current working directory of that drive as a result of the changes in #6600. This PR contains the changes from #6600 as well as a new check in `SessionStateLocationAPIs.cs` that determines if the path given to `Set-Location` is simply a drive name terminated by a colon. If so, it changes the desired path to be the new drive's current working directory.\r\n\r\nThis fixes #6749 and fixes #5228.\r\n\r\n## PR Checklist\r\n\r\n- [x] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - Use the present tense and imperative mood when describing your changes\r\n- [x] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] [Change is not breaking](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)\r\n- [x] [Make sure all `.h`, `.cpp`, `.cs`, `.ps1` and `.psm1` files have the correct copyright header](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - If the PR is work in progress, please add the prefix `WIP:` to the beginning of the title and remove the prefix when the PR is ready.\r\n- **User-facing changes**\r\n    - [x] Not Applicable\r\n    - **OR**\r\n    - [ ] User-facing [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n        - [x] Issue filed - Issue link: #6749\r\n- **Testing - New and feature**\r\n    - [ ] Not Applicable or can only be tested interactively\r\n    - **OR**\r\n    - [x] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n        - [x] [Add `[feature]` if the change is significant or affects feature tests](https://github.com/PowerShell/PowerShell/blob/master/docs/testing-guidelines/testing-guidelines.md#requesting-additional-tests-for-a-pr)\r\n",
  "closed_at": "2018-05-17T00:13:23Z",
  "comments": [
    {
      "author": "mcbobke",
      "author_association": "CONTRIBUTOR",
      "body": "Tests still need to be written, creating PR for tracking.",
      "created_at": "2018-04-30T04:57:44Z",
      "updated_at": "2018-04-30T04:57:44Z"
    },
    {
      "author": "rjmholt",
      "author_association": "COLLABORATOR",
      "body": "~~I just cloned and built this branch, and I think I'm still getting a repro of https://github.com/PowerShell/PowerShell/issues/5228.~~\r\n\r\nScratch that, I did something wrong. Rebuilt and it works!",
      "created_at": "2018-05-11T20:41:48Z",
      "updated_at": "2018-05-11T20:49:11Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT The PR is a good place to understand whether we will address CodeFactor issues and how we will do it.\r\nThe factor does not evaluate changes but only the entire files. Current policy don't allow PR unrelated style changes.",
      "created_at": "2018-05-12T11:42:16Z",
      "updated_at": "2018-05-12T11:42:16Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "I think a PR doesn't need to address CodeFactor issues that are not introduced by the PR itself.\r\nWe need to review the CodeFactor rules, not all of them make sense to keep, then we can see if it's possible to bulk update the code base.",
      "created_at": "2018-05-14T18:21:22Z",
      "updated_at": "2018-05-14T18:21:22Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@mcbobke Thanks for your contribution! ",
      "created_at": "2018-05-17T03:08:17Z",
      "updated_at": "2018-05-17T03:08:17Z"
    },
    {
      "author": "mcbobke",
      "author_association": "CONTRIBUTOR",
      "body": "Thank you all!",
      "created_at": "2018-05-17T07:17:19Z",
      "updated_at": "2018-05-17T07:17:19Z"
    }
  ],
  "created_at": "2018-04-30T04:56:54Z",
  "number": 6774,
  "state": "closed",
  "title": "Fix for Set-Location failing to restore current working directory (#6749)",
  "updated_at": "2018-05-17T07:17:19Z"
}
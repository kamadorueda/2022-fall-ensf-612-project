{
  "_url": "https://github.com/PowerShell/PowerShell/issues/5499",
  "author": "bergmeister",
  "body": "Issue #5012 has highlighted that it is not easy to get started with development work on the Windows installer.\r\n\r\nThis PR documents for the first time how to build an installable package locally and simplifies the process by moving `New-MSIPackage` to the  `packaging` module where it better belongs to and more defaults/validation are added as well.\r\n\r\nSince `New-MSIPackage` throws a very nice error with a download link to the required WiX toolset, I decided to not duplicate this in the documentation about having to install the WiX toolset.\r\n\r\nI guess the best reviewer is @SteveL-MSFT who recently did a lot of installer work.",
  "closed_at": "2018-01-11T21:47:34Z",
  "comments": [
    {
      "author": "codecov-io",
      "author_association": "NONE",
      "body": "# [Codecov](https://codecov.io/gh/PowerShell/PowerShell/pull/5499?src=pr&el=h1) Report\n> Merging [#5499](https://codecov.io/gh/PowerShell/PowerShell/pull/5499?src=pr&el=desc) into [master](https://codecov.io/gh/PowerShell/PowerShell/commit/79ae396917b18e467623c161587e937fbba0fea8?src=pr&el=desc) will **increase** coverage by `0.01%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/PowerShell/PowerShell/pull/5499/graphs/tree.svg?token=5nnX905GwP&src=pr&width=650&height=150)](https://codecov.io/gh/PowerShell/PowerShell/pull/5499?src=pr&el=tree)\n\n```diff\n@@            Coverage Diff             @@\n##           master    #5499      +/-   ##\n==========================================\n+ Coverage   60.83%   60.84%   +0.01%     \n==========================================\n  Files         924      929       +5     \n  Lines      274195   273880     -315     \n==========================================\n- Hits       166793   166642     -151     \n+ Misses     107402   107238     -164\n```\n\n\n| [Impacted Files](https://codecov.io/gh/PowerShell/PowerShell/pull/5499?src=pr&el=tree) | Coverage \u0394 | |\n|---|---|---|\n| [....Management.Automation/security/SecurityManager.cs](https://codecov.io/gh/PowerShell/PowerShell/pull/5499/diff?src=pr&el=tree#diff-c3JjL1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24vc2VjdXJpdHkvU2VjdXJpdHlNYW5hZ2VyLmNz) | `30.51% <0%> (-7.56%)` | :arrow_down: |\n| [....PowerShell.Security/security/SignatureCommands.cs](https://codecov.io/gh/PowerShell/PowerShell/pull/5499/diff?src=pr&el=tree#diff-c3JjL01pY3Jvc29mdC5Qb3dlclNoZWxsLlNlY3VyaXR5L3NlY3VyaXR5L1NpZ25hdHVyZUNvbW1hbmRzLmNz) | `24.77% <0%> (-5.97%)` | :arrow_down: |\n| [...ft.PowerShell.Security/security/CatalogCommands.cs](https://codecov.io/gh/PowerShell/PowerShell/pull/5499/diff?src=pr&el=tree#diff-c3JjL01pY3Jvc29mdC5Qb3dlclNoZWxsLlNlY3VyaXR5L3NlY3VyaXR5L0NhdGFsb2dDb21tYW5kcy5jcw==) | `80.19% <0%> (-5.95%)` | :arrow_down: |\n| [...Cmdlet/Common/BasicHtmlWebResponseObject.Common.cs](https://codecov.io/gh/PowerShell/PowerShell/pull/5499/diff?src=pr&el=tree#diff-c3JjL01pY3Jvc29mdC5Qb3dlclNoZWxsLkNvbW1hbmRzLlV0aWxpdHkvY29tbWFuZHMvdXRpbGl0eS9XZWJDbWRsZXQvQ29tbW9uL0Jhc2ljSHRtbFdlYlJlc3BvbnNlT2JqZWN0LkNvbW1vbi5jcw==) | `32.75% <0%> (-5.23%)` | :arrow_down: |\n| [...s/utility/WebCmdlet/Common/ContentHelper.Common.cs](https://codecov.io/gh/PowerShell/PowerShell/pull/5499/diff?src=pr&el=tree#diff-c3JjL01pY3Jvc29mdC5Qb3dlclNoZWxsLkNvbW1hbmRzLlV0aWxpdHkvY29tbWFuZHMvdXRpbGl0eS9XZWJDbWRsZXQvQ29tbW9uL0NvbnRlbnRIZWxwZXIuQ29tbW9uLmNz) | `57.33% <0%> (-5.17%)` | :arrow_down: |\n| [....Management/commands/management/PingPathCommand.cs](https://codecov.io/gh/PowerShell/PowerShell/pull/5499/diff?src=pr&el=tree#diff-c3JjL01pY3Jvc29mdC5Qb3dlclNoZWxsLkNvbW1hbmRzLk1hbmFnZW1lbnQvY29tbWFuZHMvbWFuYWdlbWVudC9QaW5nUGF0aENvbW1hbmQuY3M=) | `77.94% <0%> (-4.42%)` | :arrow_down: |\n| [.../System.Management.Automation/engine/Attributes.cs](https://codecov.io/gh/PowerShell/PowerShell/pull/5499/diff?src=pr&el=tree#diff-c3JjL1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24vZW5naW5lL0F0dHJpYnV0ZXMuY3M=) | `69.23% <0%> (-3.71%)` | :arrow_down: |\n| [...agement.Automation/engine/interpreter/Utilities.cs](https://codecov.io/gh/PowerShell/PowerShell/pull/5499/diff?src=pr&el=tree#diff-c3JjL1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24vZW5naW5lL2ludGVycHJldGVyL1V0aWxpdGllcy5jcw==) | `50.8% <0%> (-2.5%)` | :arrow_down: |\n| [...nagement.Automation/engine/runtime/MutableTuple.cs](https://codecov.io/gh/PowerShell/PowerShell/pull/5499/diff?src=pr&el=tree#diff-c3JjL1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24vZW5naW5lL3J1bnRpbWUvTXV0YWJsZVR1cGxlLmNz) | `38.51% <0%> (-2.1%)` | :arrow_down: |\n| [...ment.Automation/engine/CompiledCommandParameter.cs](https://codecov.io/gh/PowerShell/PowerShell/pull/5499/diff?src=pr&el=tree#diff-c3JjL1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24vZW5naW5lL0NvbXBpbGVkQ29tbWFuZFBhcmFtZXRlci5jcw==) | `90.8% <0%> (-1.92%)` | :arrow_down: |\n| ... and [35 more](https://codecov.io/gh/PowerShell/PowerShell/pull/5499/diff?src=pr&el=tree-more) | |\n\n------\n\n[Continue to review full report at Codecov](https://codecov.io/gh/PowerShell/PowerShell/pull/5499?src=pr&el=continue).\n> **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n> `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n> Powered by [Codecov](https://codecov.io/gh/PowerShell/PowerShell/pull/5499?src=pr&el=footer). Last update [79ae396...8f956f3](https://codecov.io/gh/PowerShell/PowerShell/pull/5499?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n",
      "created_at": "2017-11-18T19:51:31Z",
      "updated_at": "2017-12-19T18:56:42Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@bergmeister Could you please correct the PR title and description?",
      "created_at": "2017-11-19T17:41:34Z",
      "updated_at": "2017-11-19T17:41:34Z"
    },
    {
      "author": "bergmeister",
      "author_association": "CONTRIBUTOR",
      "body": "@iSazonov OK. I've adapted the title and description now to make it clearer that it is about WiX development where one does care too much what exactly lands in the package.",
      "created_at": "2017-11-19T19:07:20Z",
      "updated_at": "2017-11-19T19:08:59Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "Thinking further about this, I think I prefer not exposing `New-MSIPackage` and treat that as an internal function.  Have users use `Start-PSPackage` (so a single way to create msi packages rather than two ways).  However, we can update `Start-PSPackage` to automatically create a PSDrive to resolve the \"root folder\" requirement (to not expose \"private\" folder path information) and use that.",
      "created_at": "2017-11-19T19:18:12Z",
      "updated_at": "2017-11-19T19:18:12Z"
    },
    {
      "author": "bergmeister",
      "author_association": "CONTRIBUTOR",
      "body": "@SteveL-MSFT If you do not want to expose `New-MSIPackage` any more, then an alternative would be to remove it from the manifest in `CmdletsToExport` and then only insiders would import the psm1 instead of the psd1 instead. WDYT?",
      "created_at": "2017-11-19T19:24:53Z",
      "updated_at": "2017-11-19T19:24:53Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "I think we should remove `New-MSIPackage` from exported cmdlets",
      "created_at": "2017-11-20T22:22:53Z",
      "updated_at": "2017-11-20T22:22:53Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@bergmeister Please resolve merge conflicts.",
      "created_at": "2018-01-10T09:18:58Z",
      "updated_at": "2018-01-10T09:18:58Z"
    },
    {
      "author": "bergmeister",
      "author_association": "CONTRIBUTOR",
      "body": "Ok, thanks for letting me know. I will come back to it soon (but not today) since it needs more time carefully extracting the diff because the conflict is quite horrible due to the move of a function that has received updates in the meantime. Maybe even a new PR with 2 separate commits (one with the improvements and one with the move) might be better to avoid accidentally reverting code changes. What do you think?\r\n  ",
      "created_at": "2018-01-10T10:03:56Z",
      "updated_at": "2018-01-10T10:08:02Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@bergmeister  Perhaps easy make new PR.",
      "created_at": "2018-01-10T12:37:19Z",
      "updated_at": "2018-01-10T12:37:19Z"
    }
  ],
  "created_at": "2017-11-18T12:32:00Z",
  "number": 5499,
  "state": "closed",
  "title": "WIP Make it easier to build an installable package locally for WiX development and document it",
  "updated_at": "2018-01-11T21:47:34Z"
}
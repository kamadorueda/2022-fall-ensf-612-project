{
  "_url": "https://github.com/PowerShell/PowerShell/issues/8162",
  "author": "frjol",
  "body": "## PR Summary\r\n\r\nSet-PSDebug -Trace 1 now prints multiline command #8113\r\n\r\n## PR Checklist\r\n\r\n- [x] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - Use the present tense and imperative mood when describing your changes\r\n- [x] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] [Change is not breaking](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)\r\n- [x] [Make sure all `.h`, `.cpp`, `.cs`, `.ps1` and `.psm1` files have the correct copyright header](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - If the PR is work in progress, please add the prefix `WIP:` to the beginning of the title and remove the prefix when the PR is ready.\r\n- **User-facing changes**\r\n    - [x] Not Applicable\r\n    - **OR**\r\n    - [x] User-facing [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n        - [x] Issue filed - Issue link:#8113\r\n- **Testing - New and feature**\r\n    - [ ] Not Applicable or can only be tested interactively\r\n    - **OR**\r\n    - [ ] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n        - [ ] [Add `[feature]` if the change is significant or affects feature tests](https://github.com/PowerShell/PowerShell/blob/master/docs/testing-guidelines/testing-guidelines.md#requesting-additional-tests-for-a-pr)\r\n",
  "closed_at": "2018-11-01T16:21:12Z",
  "comments": [
    {
      "author": "msftclas",
      "author_association": "NONE",
      "body": "[![CLA assistant check](https://cla.opensource.microsoft.com/pull/badge/not_signed)](https://cla.opensource.microsoft.com/PowerShell/PowerShell?pullRequest=8162) <br/>Thank you for your submission, we really appreciate it. Like many open source projects, we ask that you sign our [Contributor License Agreement](https://cla.opensource.microsoft.com/PowerShell/PowerShell?pullRequest=8162) before we can accept your contribution.<br/><br/>:x: frjol [sign now](https://cla.opensource.microsoft.com/PowerShell/PowerShell?pullRequest=8162)<br/><sub>You have signed the CLA already but the status is still pending? Let us [recheck](https://cla.opensource.microsoft.com/check/PowerShell/PowerShell?pullRequest=8162) it.</sub>",
      "created_at": "2018-10-31T19:58:03Z",
      "updated_at": "2020-08-04T19:00:08Z"
    },
    {
      "author": "vexx32",
      "author_association": "COLLABORATOR",
      "body": "@frjol You can add a line to the PR description with `Fixes #8113` (or `Resolves`, or probably a few other keywords) to ensure the linked issue is closed when the PR is accepted and merged. \ud83d\ude04 ",
      "created_at": "2018-11-01T00:39:16Z",
      "updated_at": "2018-11-01T00:39:16Z"
    },
    {
      "author": "lzybkr",
      "author_association": "MEMBER",
      "body": "This PR seriously degrades the quality of the tracing IMO. Taking my example in the linked issue\r\n\r\nThis PR prints:\r\n\r\n```\r\nDEBUG:    1+   >>>> dir $env:TEMP | ForEach-Object {\r\n    if ((Get-Random -Maximum 15) -lt 1) {\r\n        \"Lucky file is $_\"\r\n        break\r\n    }\r\n}\r\n\r\nDEBUG:    1+  dir $env:TEMP | ForEach-Object  >>>> {\r\n    if ((Get-Random -Maximum 15) -lt 1) {\r\n        \"Lucky file is $_\"\r\n        break\r\n    }\r\n}\r\n\r\nDEBUG:\r\nDEBUG:\r\nDEBUG:    1+  dir $env:TEMP | ForEach-Object  >>>> {\r\n    if ((Get-Random -Maximum 15) -lt 1) {\r\n        \"Lucky file is $_\"\r\n        break\r\n    }\r\n}\r\n\r\nDEBUG:\r\nDEBUG:\r\nLucky file is C:\\Users\\jason\\AppData\\Local\\Temp\\38909067-9dd7-4538-ab8b-17c890f8c69c\r\nDEBUG:\r\n```\r\n\r\nPowerShell Core pre-this PR:\r\n\r\n```\r\nDEBUG:    1+   >>>> dir $env:TEMP | ForEach-Object {\r\n\r\nDEBUG:    1+  dir $env:TEMP | ForEach-Object  >>>> {\r\n\r\nDEBUG:    2+     if ( >>>> (Get-Random -Maximum 15) -lt 1) {\r\n\r\nDEBUG:    6+  >>>> }\r\nDEBUG:    1+  dir $env:TEMP | ForEach-Object  >>>> {\r\n\r\nDEBUG:    2+     if ( >>>> (Get-Random -Maximum 15) -lt 1) {\r\n\r\nDEBUG:    3+          >>>> \"Lucky file is $_\"\r\n\r\nLucky file is C:\\Users\\jason\\AppData\\Local\\Temp\\418061a8-a7ad-4ed2-96dd-c55b3efca2de\r\nDEBUG:    4+          >>>> break\r\n```\r\n\r\nWindows PowerShell 5.1 prints:\r\n\r\n```\r\nDEBUG:    1+  >>>> dir $env:TEMP | ForEach-Object {\r\nDEBUG:    1+ dir $env:TEMP | ForEach-Object  >>>> {\r\nDEBUG:    2+     if ( >>>> (Get-Random -Maximum 15) -lt 1) {\r\nDEBUG:    6+  >>>> }\r\nDEBUG:    1+ dir $env:TEMP | ForEach-Object  >>>> {\r\nDEBUG:    2+     if ( >>>> (Get-Random -Maximum 15) -lt 1) {\r\nDEBUG:    6+  >>>> }\r\nDEBUG:    1+ dir $env:TEMP | ForEach-Object  >>>> {\r\nDEBUG:    2+     if ( >>>> (Get-Random -Maximum 15) -lt 1) {\r\nDEBUG:    3+          >>>> \"Lucky file is $_\"\r\nLucky file is 2f5d95a5-a611-4ec9-87c5-6db7eb198485\r\nDEBUG:    4+          >>>> break\r\n```\r\nOf note - the proposed change never traces hitting line 2, 3, or 4 - it only traces hitting line 1.\r\n\r\nIt is also worth noting that PowerShell Core tracing (pre this PR) is more verbose (and worse in my opinion) with many blank lines that are not present in Windows PowerShell.\r\n\r\nThere are some performance concerns as well - splitting the entire script on `Environment.NewLine` will be very expensive for large scripts (and may not work as expected when a script uses CRLF when running on Mac/Linux).",
      "created_at": "2018-11-01T15:56:09Z",
      "updated_at": "2018-11-01T15:56:09Z"
    }
  ],
  "created_at": "2018-10-31T19:57:43Z",
  "number": 8162,
  "state": "closed",
  "title": "Set-PSDebug -Trace 1 prints only first line of a multiline command #8113",
  "updated_at": "2020-08-04T19:00:08Z"
}
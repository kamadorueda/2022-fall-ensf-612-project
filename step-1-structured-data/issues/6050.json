{
  "_url": "https://github.com/PowerShell/PowerShell/issues/6050",
  "author": "elijahgagne",
  "body": "Goal\r\n------------------\r\nUse SQLite with PowerShell 6. I have used SQLite with .NET Core so it seems like this should be possible. I have been using SQLite with PowerShell 5 for quite some time.\r\n\r\nAttempt 1\r\n-----------------\r\nInstall [SQLite package from nuget](https://dotnet.myget.org/feed/dotnet-core/package/nuget/Microsoft.Data.SQLite).\r\n\r\n```powershell\r\nPS C:\\Users\\egagn\\Desktop> Install-Package Microsoft.Data.Sqlite -Version 2.1.0-preview1-28181 -Source https://dotnet.myget.org/F/dotnet-core/api/v3/index.json\r\nInstall-Package : Unable to find package source 'https://dotnet.myget.org/F/dotnet-core/api/v3/index.json'. Use Get-PackageSource to see all available package sources.\r\nAt line:1 char:1\r\n+ Install-Package Microsoft.Data.Sqlite -Version 2.1.0-preview1-28181 - ...\r\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+ CategoryInfo          : ObjectNotFound: (Microsoft.Power....InstallPackage:InstallPackage) [Install-Package], Exception\r\n+ FullyQualifiedErrorId : SourceNotFound,Microsoft.PowerShell.PackageManagement.Cmdlets.InstallPackage\r\n```\r\n\r\nAttempt 2\r\n-----------------\r\nBuild Microsoft.Data.Sqlite from source.\r\n\r\n```powershell\r\nC:\\Users\\egagn\\Desktop> git clone https://github.com/aspnet/Microsoft.Data.Sqlite\r\nCloning into 'Microsoft.Data.Sqlite'...\r\nremote: Counting objects: 4080, done.\r\nremote: Compressing objects: 100% (18/18), done.\r\nremote: Total 4080 (delta 4), reused 11 (delta 3), pack-reused 4059\r\nReceiving objects: 100% (4080/4080), 981.42 KiB | 1.18 MiB/s, done.\r\nResolving deltas: 100% (2576/2576), done.\r\nC:\\Users\\egagn\\Desktop> cd Microsoft.Data.Sqlite\r\nC:\\Users\\egagn\\Desktop> build.cmd\r\nDownloading KoreBuild 2.1.0-preview1-15670\r\nUsing KoreBuild 2.1.0-preview1-15670\r\n...\r\nBuild succeeded.\r\n    0 Warning(s)\r\n    0 Error(s)\r\n\r\nTime Elapsed 00:03:07.61\r\nC:\\Users\\egagn\\Desktop> $SQLiteDLL = \"C:\\Users\\egagn\\Desktop\\Microsoft.Data.Sqlite\\src\\Microsoft.Data.Sqlite\\bin\\Debug\\netstandard2.0\\Microsoft.Data.Sqlite.dll\"\r\nC:\\Users\\egagn\\Desktop> [Reflection.Assembly]::LoadFile($SQLiteDLL)\r\n\r\n\r\nGAC    Version        Location\r\n---    -------        --------\r\nFalse  v4.0.30319     C:\\Users\\egagn\\Desktop\\Microsoft.Data.Sqlite\\src\\Microsoft.Data.Sqlite\\bin\\Debug\\netstandard2.0\\Microsoft.Data.Sqlite.dll\r\n\r\n\r\nPS C:\\Users\\egagn\\Desktop> $Connection = New-Object -TypeName Microsoft.Data.Sqlite.SqliteConnection(\"Data Source=Sample.db\")\r\nNew-Object : Cannot find type [Microsoft.Data.Sqlite.SqliteConnection]: verify that the assembly containing this type is loaded.\r\nAt line:1 char:15\r\n+ ... onnection = New-Object -TypeName Microsoft.Data.Sqlite.SqliteConnecti ...\r\n+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+ CategoryInfo          : InvalidType: (:) [New-Object], PSArgumentException\r\n+ FullyQualifiedErrorId : TypeNotFound,Microsoft.PowerShell.Commands.NewObjectCommand\r\n\r\nPS C:\\Users\\egagn\\Desktop> [appdomain]::CurrentDomain.GetAssemblies() | ? fullname -match 'Microsoft.Data.Sqlite' | % { $_.GetExportedTypes() }\r\nPS C:\\Users\\egagn\\Desktop>\r\n```\r\n\r\nAttempt 3\r\n-----------------\r\nUse .NET Framework (.NET v4) DLL.\r\n\r\n```powershell\r\nPS C:\\Users\\egagn\\Desktop> [Reflection.Assembly]::LoadFile(\"C:\\dartbox\\Utilities\\DLL_Library\\SQLite\\System.Data.SQLite.dll\")\r\n\r\nGAC    Version        Location\r\n---    -------        --------\r\nFalse  v4.0.30319     C:\\dartbox\\Utilities\\DLL_Library\\SQLite\\System.Data.SQLite.dll\r\n\r\n\r\nPS C:\\Users\\egagn\\Desktop> $Connection = New-Object -TypeName System.Data.SQLite.SQLiteConnection\r\nPS C:\\Users\\egagn\\Desktop> $Connection.ConnectionString = \"Data Source=C:\\dartbox\\Documents\\Configuration\\PSConfig\\Data\\vault.db\"\r\nPS C:\\Users\\egagn\\Desktop> $Connection.Open()\r\n\r\n# CRASH! PowerShell Core 6 has stopped working\r\n```\r\n\r\nEnvironment data\r\n----------------\r\n\r\n```powershell\r\n> $PSVersionTable\r\nName                           Value\r\n----                           -----\r\nPSVersion                      6.0.1\r\nPSEdition                      Core\r\nGitCommitId                    v6.0.1\r\nOS                             Microsoft Windows 10.0.16299\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n",
  "closed_at": "2018-02-01T02:58:58Z",
  "comments": [
    {
      "author": "MaximoTrinidad",
      "author_association": "NONE",
      "body": "More like this issue has been mention before that NuGet mostly are for Windows full .NET.  But, while writing this comment,  I found the .NETCore version:\r\nhttps://www.nuget.org/packages/Microsoft.Data.Sqlite.Core/\r\n\r\nTry it an see if it works with the Microsoft.Data.Sqlite.Core v2.0.0.  The one previously use is only for Windows. \r\n\r\nNuGet site need to start providing more information and tag properly their packages: OS Type, .Net Full, and/or .NET Core.\r\n\r\n:)\r\n",
      "created_at": "2018-01-28T21:51:53Z",
      "updated_at": "2018-01-28T21:52:16Z"
    },
    {
      "author": "elijahgagne",
      "author_association": "NONE",
      "body": "Thanks. Here's how things are going:\r\n```\r\nPS C:\\Users\\egagn> Install-Package Microsoft.Data.Sqlite.Core -Version 2.0.0\r\nInstall-Package : A parameter cannot be found that matches parameter name 'Version'.\r\nAt line:1 char:44\r\n+ Install-Package Microsoft.Data.Sqlite.Core -Version 2.0.0\r\n+                                            ~~~~~~~~\r\n+ CategoryInfo          : InvalidArgument: (:) [Install-Package], ParameterBindingException\r\n+ FullyQualifiedErrorId : NamedParameterNotFound,Microsoft.PowerShell.PackageManagement.Cmdlets.InstallPackage\r\n```\r\n```\r\nPS C:\\Users\\egagn> Install-Package Microsoft.Data.Sqlite.Core\r\nInstall-Package : No match was found for the specified search criteria and package name 'Microsoft.Data.Sqlite.Core'. Try Get-PackageSource to see all available registered package sources.\r\nAt line:1 char:1\r\n+ Install-Package Microsoft.Data.Sqlite.Core\r\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+ CategoryInfo          : ObjectNotFound: (Microsoft.Power....InstallPackage:InstallPackage) [Install-Package], Exception\r\n+ FullyQualifiedErrorId : NoMatchFoundForCriteria,Microsoft.PowerShell.PackageManagement.Cmdlets.InstallPackage\r\n```\r\n```\r\nPS C:\\Users\\egagn> Install-Package Microsoft.Data.Sqlite\r\nInstall-Package : No match was found for the specified search criteria and package name 'Microsoft.Data.Sqlite'. Try Get-PackageSource to see all available registered package sources.\r\nAt line:1 char:1\r\n+ Install-Package Microsoft.Data.Sqlite\r\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+ CategoryInfo          : ObjectNotFound: (Microsoft.Power....InstallPackage:InstallPackage) [Install-Package], Exception\r\n+ FullyQualifiedErrorId : NoMatchFoundForCriteria,Microsoft.PowerShell.PackageManagement.Cmdlets.InstallPackage\r\n```\r\n\r\nI was able to run `Install-Package Sqlite -Scope CurrentUser` but it looks like I ended up with System.Data.SQLite when I did that.\r\n```\r\nPS C:\\Users\\egagn> Import-Module SQLite\r\nipmo : Could not load file or assembly 'C:\\Users\\egagn\\OneDrive\\Documents\\PowerShell\\Modules\\SQLite\\2.0\\bin\\System.Data.SQLite.dll'. Format of the executable (.exe) or library (.dll) is invalid.\r\nAt C:\\Users\\egagn\\OneDrive\\Documents\\PowerShell\\Modules\\SQLite\\2.0\\start-sqlite.psm1:89 char:30\r\n+ ls $PSScriptRoot/bin/*.dll | ipmo;\r\n+                              ~~~~\r\n+ CategoryInfo          : NotSpecified: (:) [Import-Module], BadImageFormatException\r\n+ FullyQualifiedErrorId : System.BadImageFormatException,Microsoft.PowerShell.Commands.ImportModuleCommand\r\n```",
      "created_at": "2018-01-28T23:47:22Z",
      "updated_at": "2018-01-28T23:47:22Z"
    },
    {
      "author": "MaximoTrinidad",
      "author_association": "NONE",
      "body": "@elijahgagne,\r\n\r\nWrong command line as parameter -Version doesn't exist. Use the following:\r\n```\r\nInstall-Package Microsoft.Data.Sqlite.Core -RequiredVersion 2.0.0\r\n```\r\n\r\nAlso, make use to Open PSCore6 \"as an Administrator\" before installing Module(s)/Package(s).\r\n\r\nHope this helps!",
      "created_at": "2018-01-29T13:23:57Z",
      "updated_at": "2018-01-29T13:23:57Z"
    },
    {
      "author": "elijahgagne",
      "author_association": "NONE",
      "body": "Thanks for the continued help. No luck so far:\r\n\r\n```\r\nPS C:\\Users\\egagn> Install-Package Microsoft.Data.Sqlite.Core -RequiredVersion 2.0.0 -Verbose\r\nVERBOSE: Using the provider 'NuGet' for searching packages.\r\nVERBOSE: Using the provider 'PowerShellGet' for searching packages.\r\nVERBOSE: Searching repository 'https://api.nuget.org/v3/index.json/FindPackagesById()?id='Microsoft.Data.Sqlite.Core'' for ''.\r\nVERBOSE: The -Repository parameter was not specified.  PowerShellGet will use all of the registered repositories.\r\nVERBOSE: Getting the provider object for the PackageManagement Provider 'NuGet'.\r\nVERBOSE: The specified Location is 'https://dartmouth.myget.org/F/aig/auth/0bc6ec80-5fcf-42e3-9a3a-c862e1a70b65/api/v2' and PackageManagementProvider is 'NuGet'.\r\nVERBOSE: Searching repository 'https://dartmouth.myget.org/F/aig/auth/0bc6ec80-5fcf-42e3-9a3a-c862e1a70b65/api/v2/FindPackagesById()?id='Microsoft.Data.Sqlite.Core'' for ''.\r\nVERBOSE: Total package yield:'0' for the specified package 'Microsoft.Data.Sqlite.Core'.\r\nVERBOSE: Getting the provider object for the PackageManagement Provider 'NuGet'.\r\nVERBOSE: The specified Location is 'https://www.powershellgallery.com/api/v2/' and PackageManagementProvider is 'NuGet'.\r\nVERBOSE: Searching repository 'https://www.powershellgallery.com/api/v2/FindPackagesById()?id='Microsoft.Data.Sqlite.Core'' for ''.\r\nVERBOSE: Total package yield:'0' for the specified package 'Microsoft.Data.Sqlite.Core'.\r\nVERBOSE: Getting the provider object for the PackageManagement Provider 'NuGet'.\r\nVERBOSE: The specified Location is 'https://dartmouth.myget.org/F/dba/auth/0bc6ec80-5fcf-42e3-9a3a-c862e1a70b65/api/v2' and PackageManagementProvider is 'NuGet'.\r\nVERBOSE: Searching repository 'https://dartmouth.myget.org/F/dba/auth/0bc6ec80-5fcf-42e3-9a3a-c862e1a70b65/api/v2/FindPackagesById()?id='Microsoft.Data.Sqlite.Core'' for ''.\r\nVERBOSE: Total package yield:'0' for the specified package 'Microsoft.Data.Sqlite.Core'.\r\nInstall-Package : No match was found for the specified search criteria and package name 'Microsoft.Data.Sqlite.Core'. Try Get-PackageSource to see all available registered package sources.\r\nAt line:1 char:1\r\n+ Install-Package Microsoft.Data.Sqlite.Core -RequiredVersion 2.0.0 -Ve ...\r\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+ CategoryInfo          : ObjectNotFound: (Microsoft.Power....InstallPackage:InstallPackage) [Install-Package], Exception\r\n+ FullyQualifiedErrorId : NoMatchFoundForCriteria,Microsoft.PowerShell.PackageManagement.Cmdlets.InstallPackage\r\n\r\nPS C:\\Users\\egagn>\r\n```",
      "created_at": "2018-01-29T14:39:31Z",
      "updated_at": "2018-01-29T14:39:31Z"
    },
    {
      "author": "MaximoTrinidad",
      "author_association": "NONE",
      "body": "Hum! OK... I just duplicated the error on a VM that I'm using for testing fresh PSCore install/uninstall.\r\nI got one machine good but the VM fails.\r\n\r\nLet get back to you!",
      "created_at": "2018-01-29T15:05:19Z",
      "updated_at": "2018-01-29T15:05:19Z"
    },
    {
      "author": "MaximoTrinidad",
      "author_association": "NONE",
      "body": "@elijahgagne \r\n\r\nGot it!!  As I mention I've been testing clean install/uninstall of PSCore then I caught the following issue.  \r\nI had NuGet previously registered, but if I uninstalled PSCore then I have to remember to register NuGet again.\r\n\r\nPlease, try executing code function \"**Verify-NuGetRegistered**\" to verify that you got NuGet registered before doing any package installation(s):\r\n```\r\nfunction Verify-NugetRegistered\r\n{\r\n\t[CmdletBinding()]\r\n\tParam ()\r\n\t# Microsoft provided code:\r\n\t# Register NuGet package source, if needed\r\n\t# The package source may not be available on some systems (e.g. Linux/Windows)\r\n\tif (-not (Get-PackageSource | Where-Object{ $_.Name -eq 'Nuget' }))\r\n\t{\r\n\t\tRegister-PackageSource -Name Nuget -ProviderName NuGet -Location https://www.nuget.org/api/v2\r\n\t}\r\n\telse\r\n\t{\r\n\t\tWrite-Host \"NuGet Already Exist! No Need to install.\"\r\n\t};\r\n};\r\n\r\n## - Execute:\r\nVerify-NugetRegistered\r\n```\r\nI got it working again on my VM test.\r\n\r\n![nuget_register_01_2018-01-29_10-09-22](https://user-images.githubusercontent.com/19892435/35518481-b358e630-04df-11e8-9778-987ba93a1470.jpg)\r\n",
      "created_at": "2018-01-29T15:32:42Z",
      "updated_at": "2018-01-29T15:32:42Z"
    },
    {
      "author": "elijahgagne",
      "author_association": "NONE",
      "body": "Very nice! But for some reason I'm still having trouble:\r\n```\r\nPowerShell v6.0.1\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\n\r\nhttps://aka.ms/pscore6-docs\r\nType 'help' to get help.\r\n\r\nPS C:\\Users\\egagn> function Verify-NugetRegistered\r\n>> {\r\n>> [CmdletBinding()]\r\n>> Param ()\r\n>> # Microsoft provided code:\r\n>> # Register NuGet package source, if needed\r\n>> # The package source may not be available on some systems (e.g. Linux/Windows)\r\n>> if (-not (Get-PackageSource | Where-Object{ $_.Name -eq 'Nuget' }))\r\n>> {\r\n>> Register-PackageSource -Name Nuget -ProviderName NuGet -Location https://www.nuget.org/api/v2\r\n>> }\r\n>> else\r\n>> {\r\n>> Write-Host \"NuGet Already Exist! No Need to install.\"\r\n>> };\r\n>> };\r\nPS C:\\Users\\egagn>\r\nPS C:\\Users\\egagn> ## - Execute:\r\nPS C:\\Users\\egagn> Verify-NugetRegistered\r\nNuGet Already Exist! No Need to install.\r\nPS C:\\Users\\egagn> Register-PackageSource -Name Nuget -ProviderName NuGet -Location https://www.nuget.org/api/v2\r\nRegister-PackageSource : Package Source 'Nuget' exists.\r\nAt line:1 char:1\r\n+ Register-PackageSource -Name Nuget -ProviderName NuGet -Location http ...\r\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+ CategoryInfo          : ResourceExists: (Microsoft.Power...erPackageSource:RegisterPackageSource) [Register-PackageSource], Exception\r\n+ FullyQualifiedErrorId : PackageSourceExists,Microsoft.PowerShell.PackageManagement.Cmdlets.RegisterPackageSource\r\n\r\nPS C:\\Users\\egagn> Install-Package Microsoft.Data.Sqlite.Core -RequiredVersion 2.0.0 -Verbose\r\nVERBOSE: Using the provider 'NuGet' for searching packages.\r\nVERBOSE: Using the provider 'PowerShellGet' for searching packages.\r\nVERBOSE: The -Repository parameter was not specified.  PowerShellGet will use all of the registered repositories.\r\nVERBOSE: Getting the provider object for the PackageManagement Provider 'NuGet'.\r\nVERBOSE: The specified Location is 'https://dartmouth.myget.org/F/aig/auth/0bc6ec80-5fcf-42e3-9a3a-c862e1a70b65/api/v2' and PackageManagementProvider is 'NuGet'.\r\nVERBOSE: Searching repository 'https://api.nuget.org/v3/index.json/FindPackagesById()?id='Microsoft.Data.Sqlite.Core'' for ''.\r\nVERBOSE: Searching repository 'https://www.nuget.org/api/v2/FindPackagesById()?id='Microsoft.Data.Sqlite.Core'' for ''.\r\nVERBOSE: Searching repository 'https://dartmouth.myget.org/F/aig/auth/0bc6ec80-5fcf-42e3-9a3a-c862e1a70b65/api/v2/FindPackagesById()?id='Microsoft.Data.Sqlite.Core'' for ''.\r\nVERBOSE: Total package yield:'0' for the specified package 'Microsoft.Data.Sqlite.Core'.\r\nVERBOSE: Getting the provider object for the PackageManagement Provider 'NuGet'.\r\nVERBOSE: The specified Location is 'https://www.powershellgallery.com/api/v2/' and PackageManagementProvider is 'NuGet'.\r\nVERBOSE: Searching repository 'https://www.powershellgallery.com/api/v2/FindPackagesById()?id='Microsoft.Data.Sqlite.Core'' for ''.\r\nVERBOSE: Total package yield:'0' for the specified package 'Microsoft.Data.Sqlite.Core'.\r\nVERBOSE: Getting the provider object for the PackageManagement Provider 'NuGet'.\r\nVERBOSE: The specified Location is 'https://dartmouth.myget.org/F/dba/auth/0bc6ec80-5fcf-42e3-9a3a-c862e1a70b65/api/v2' and PackageManagementProvider is 'NuGet'.\r\nVERBOSE: Searching repository 'https://dartmouth.myget.org/F/dba/auth/0bc6ec80-5fcf-42e3-9a3a-c862e1a70b65/api/v2/FindPackagesById()?id='Microsoft.Data.Sqlite.Core'' for ''.\r\nVERBOSE: Total package yield:'0' for the specified package 'Microsoft.Data.Sqlite.Core'.\r\nInstall-Package : No match was found for the specified search criteria and package name 'Microsoft.Data.Sqlite.Core'. Try Get-PackageSource to see all available registered package sources.\r\nAt line:1 char:1\r\n+ Install-Package Microsoft.Data.Sqlite.Core -RequiredVersion 2.0.0 -Ve ...\r\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+ CategoryInfo          : ObjectNotFound: (Microsoft.Power....InstallPackage:InstallPackage) [Install-Package], Exception\r\n+ FullyQualifiedErrorId : NoMatchFoundForCriteria,Microsoft.PowerShell.PackageManagement.Cmdlets.InstallPackage\r\n\r\nPS C:\\Users\\egagn>\r\n```\r\n\r\nI also tried the following\r\n```\r\nPS C:\\Users\\egagn> Unregister-PackageSource dba\r\nPS C:\\Users\\egagn> Unregister-PackageSource aig\r\nPS C:\\Users\\egagn> Unregister-PackageSource PowerShellGet\r\nUnregister-PackageSource : Unable to find package source 'PowerShellGet'. Use Get-PackageSource to see all available package sources.\r\nAt line:1 char:1\r\n+ Unregister-PackageSource PowerShellGet\r\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+ CategoryInfo          : ObjectNotFound: (Microsoft.Power...erPackageSource:UnregisterPackageSource) [Unregister-PackageSource], Exception\r\n+ FullyQualifiedErrorId : SourceNotFound,Microsoft.PowerShell.PackageManagement.Cmdlets.UnregisterPackageSource\r\n\r\nPS C:\\Users\\egagn> Unregister-PackageSource NuGet\r\nPS C:\\Users\\egagn> Register-PackageSource -Name Nuget -ProviderName NuGet -Location https://www.nuget.org/api/v2\r\n\r\nName                             ProviderName     IsTrusted  Location\r\n----                             ------------     ---------  --------\r\nNuget                            NuGet            False      https://www.nuget.org/api/v2\r\n\r\n\r\nPS C:\\Users\\egagn> Install-Package Microsoft.Data.Sqlite.Core -RequiredVersion 2.0.0 -Verbose\r\nVERBOSE: Using the provider 'NuGet' for searching packages.\r\nVERBOSE: Using the provider 'PowerShellGet' for searching packages.\r\nVERBOSE: Searching repository 'https://api.nuget.org/v3/index.json/FindPackagesById()?id='Microsoft.Data.Sqlite.Core'' for ''.\r\nVERBOSE: The -Repository parameter was not specified.  PowerShellGet will use all of the registered repositories.\r\nVERBOSE: Getting the provider object for the PackageManagement Provider 'NuGet'.\r\nVERBOSE: The specified Location is 'https://www.powershellgallery.com/api/v2/' and PackageManagementProvider is 'NuGet'.\r\nVERBOSE: Searching repository 'https://www.nuget.org/api/v2/FindPackagesById()?id='Microsoft.Data.Sqlite.Core'' for ''.\r\nVERBOSE: Searching repository 'https://www.powershellgallery.com/api/v2/FindPackagesById()?id='Microsoft.Data.Sqlite.Core'' for ''.\r\nVERBOSE: Total package yield:'0' for the specified package 'Microsoft.Data.Sqlite.Core'.\r\nInstall-Package : No match was found for the specified search criteria and package name 'Microsoft.Data.Sqlite.Core'. Try Get-PackageSource to see all available registered package sources.\r\nAt line:1 char:1\r\n+ Install-Package Microsoft.Data.Sqlite.Core -RequiredVersion 2.0.0 -Ve ...\r\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+ CategoryInfo          : ObjectNotFound: (Microsoft.Power....InstallPackage:InstallPackage) [Install-Package], Exception\r\n+ FullyQualifiedErrorId : NoMatchFoundForCriteria,Microsoft.PowerShell.PackageManagement.Cmdlets.InstallPackage\r\n```",
      "created_at": "2018-01-29T16:32:35Z",
      "updated_at": "2018-01-29T16:32:35Z"
    },
    {
      "author": "MaximoTrinidad",
      "author_association": "NONE",
      "body": "Hum!!  \r\n\r\nOK! Drastic measure. If you want...\r\n\r\nUninstall PSCore6, and remove everything.  I mean everything. \r\n\r\nBefore uninstalling Pwsh, make a list of all NuGet/PowerShellGalley module(s)/Package(s) then uninstall them all.  Then, proceed to uninstall PSCore6.  Please include all left over folders.\r\n\r\nThen, do a clean installation of PSCore6, follow by registering Nuget, follow by the SQLLite package installation.\r\n\r\nIf you can, post the if it works.\r\n\r\n:)",
      "created_at": "2018-01-29T16:48:15Z",
      "updated_at": "2018-01-29T16:48:15Z"
    },
    {
      "author": "elijahgagne",
      "author_association": "NONE",
      "body": "I was able to get it working. First I tried a fresh VM and it worked the first time. Had to run `Register-PackageSource -Name Nuget -ProviderName NuGet -Location https://www.nuget.org/api/v2`)\r\n\r\nThen I went back to my laptop. I was able to get it working by simply doing:\r\n```\r\nUnregister-PackageSource Nuget\r\nUnregister-PackageSource Nuget.org\r\nRegister-PackageSource -Name Nuget -ProviderName NuGet -Location https://www.nuget.org/api/v2\r\n\r\n# Close PowerShell, re-open PowerShell\r\n\r\nInstall-Package Microsoft.Data.Sqlite.Core -RequiredVersion 2.0.0 -Scope CurrentUser -Verbose\r\n```\r\nAfter that, I found all the packages under `C:\\Users\\egagn\\AppData\\Local\\PackageManagement\\NuGet\\Packages`. \r\n\r\nNow I'd like to import the package and use it. Here's my attempt:\r\n\r\n```\r\nPS C:\\Users\\egagn> $Packages = \"C:\\Users\\egagn\\AppData\\Local\\PackageManagement\\NuGet\\Packages\"                                                                                                  \r\nPS C:\\Users\\egagn> [Reflection.Assembly]::LoadFile(\"$Packages\\Microsoft.Data.Sqlite.Core.2.0.0\\lib\\netstandard2.0\\Microsoft.Data.Sqlite.dll\")                                                   \r\n                                                                                                                                                                                                \r\nGAC    Version        Location                                                                                                                                                                  \r\n---    -------        --------                                                                                                                                                                  \r\nFalse  v4.0.30319     C:\\Users\\egagn\\AppData\\Local\\PackageManagement\\NuGet\\Packages\\Microsoft.Data.Sqlite.Core.2.0.0\\lib\\netstandard2.0\\Microsoft.Data.Sqlite.dll                               \r\n                                                                                                                                                                                                \r\n                                                                                                                                                                                                \r\nPS C:\\Users\\egagn>                                                                                                                                                                              \r\nPS C:\\Users\\egagn> # Not sure which one is needed, just import them all                                                                                                                         \r\nPS C:\\Users\\egagn> $Targets = @(\"MonoAndroid\",\"net35\",\"net40\",\"net45\",\"netstandard1.0\",\"netstandard1.1\",\"portable-net40+sl5+netcore45+wp8+MonoAndroid10+MonoTouch10+Xamarin.iOS10\",\"portable-net\r\n45+netcore45+wpa81+MonoAndroid10+MonoTouch10+Xamarin.iOS10\",\"portable-net45+netcore45+wpa81+wp8+MonoAndroid10+MonoTouch10+Xamarin.iOS10\",\"uap10.0\",\"win8\",\"win81\",\"wpa81\",\"Xamarin.iOS10\",\"Xamar\r\nin.Mac20\")                                                                                                                                                                                      \r\nPS C:\\Users\\egagn> foreach($t in $Targets) {                                                                                                                                                    \r\n>>     [Reflection.Assembly]::LoadFile(\"$Packages\\SQLitePCLRaw.core.1.1.9\\lib\\$t\\SQLitePCLRaw.core.dll\")                                                                                        \r\n>> }                                                                                                                                                                                            \r\n                                                                                                                                                                                                \r\nGAC    Version        Location                                                                                                                                                                  \r\n---    -------        --------                                                                                                                                                                  \r\nFalse  v4.0.30319     C:\\Users\\egagn\\AppData\\Local\\PackageManagement\\NuGet\\Packages\\SQLitePCLRaw.core.1.1.9\\lib\\MonoAndroid\\SQLitePCLRaw.core.dll                                               \r\nFalse  v2.0.50727     C:\\Users\\egagn\\AppData\\Local\\PackageManagement\\NuGet\\Packages\\SQLitePCLRaw.core.1.1.9\\lib\\net35\\SQLitePCLRaw.core.dll                                                     \r\nFalse  v4.0.30319     C:\\Users\\egagn\\AppData\\Local\\PackageManagement\\NuGet\\Packages\\SQLitePCLRaw.core.1.1.9\\lib\\net40\\SQLitePCLRaw.core.dll                                                     \r\nFalse  v4.0.30319     C:\\Users\\egagn\\AppData\\Local\\PackageManagement\\NuGet\\Packages\\SQLitePCLRaw.core.1.1.9\\lib\\net45\\SQLitePCLRaw.core.dll                                                     \r\nFalse  v4.0.30319     C:\\Users\\egagn\\AppData\\Local\\PackageManagement\\NuGet\\Packages\\SQLitePCLRaw.core.1.1.9\\lib\\netstandard1.0\\SQLitePCLRaw.core.dll                                            \r\nFalse  v4.0.30319     C:\\Users\\egagn\\AppData\\Local\\PackageManagement\\NuGet\\Packages\\SQLitePCLRaw.core.1.1.9\\lib\\netstandard1.1\\SQLitePCLRaw.core.dll                                            \r\nFalse  v4.0.30319     C:\\Users\\egagn\\AppData\\Local\\PackageManagement\\NuGet\\Packages\\SQLitePCLRaw.core.1.1.9\\lib\\portable-net40+sl5+netcore45+wp8+MonoAndroid10+MonoTouch10+Xamarin.iOS10\\SQL... \r\nFalse  v4.0.30319     C:\\Users\\egagn\\AppData\\Local\\PackageManagement\\NuGet\\Packages\\SQLitePCLRaw.core.1.1.9\\lib\\portable-net45+netcore45+wpa81+MonoAndroid10+MonoTouch10+Xamarin.iOS10\\SQLit... \r\nFalse  v4.0.30319     C:\\Users\\egagn\\AppData\\Local\\PackageManagement\\NuGet\\Packages\\SQLitePCLRaw.core.1.1.9\\lib\\portable-net45+netcore45+wpa81+wp8+MonoAndroid10+MonoTouch10+Xamarin.iOS10\\S... \r\nFalse  v4.0.30319     C:\\Users\\egagn\\AppData\\Local\\PackageManagement\\NuGet\\Packages\\SQLitePCLRaw.core.1.1.9\\lib\\uap10.0\\SQLitePCLRaw.core.dll                                                   \r\nFalse  v4.0.30319     C:\\Users\\egagn\\AppData\\Local\\PackageManagement\\NuGet\\Packages\\SQLitePCLRaw.core.1.1.9\\lib\\win8\\SQLitePCLRaw.core.dll                                                      \r\nFalse  v4.0.30319     C:\\Users\\egagn\\AppData\\Local\\PackageManagement\\NuGet\\Packages\\SQLitePCLRaw.core.1.1.9\\lib\\win81\\SQLitePCLRaw.core.dll                                                     \r\nFalse  v4.0.30319     C:\\Users\\egagn\\AppData\\Local\\PackageManagement\\NuGet\\Packages\\SQLitePCLRaw.core.1.1.9\\lib\\wpa81\\SQLitePCLRaw.core.dll                                                     \r\nFalse  v4.0.30319     C:\\Users\\egagn\\AppData\\Local\\PackageManagement\\NuGet\\Packages\\SQLitePCLRaw.core.1.1.9\\lib\\Xamarin.iOS10\\SQLitePCLRaw.core.dll                                             \r\nFalse  v4.0.30319     C:\\Users\\egagn\\AppData\\Local\\PackageManagement\\NuGet\\Packages\\SQLitePCLRaw.core.1.1.9\\lib\\Xamarin.Mac20\\SQLitePCLRaw.core.dll                                             \r\n                                                                                                                                                                                                \r\n                                                                                                                                                                                                \r\nPS C:\\Users\\egagn>                                                                                                                                                                              \r\nPS C:\\Users\\egagn> $Connection = New-Object -TypeName Microsoft.Data.SQLite.SQLiteConnection                                                                                                    \r\nPS C:\\Users\\egagn> $Connection.ConnectionString = \"Data Source=C:\\vault.db\"                                                                                                                     \r\nThe following exception occurred while retrieving member \"ConnectionString\": \"Could not load file or assembly 'SQLitePCLRaw.core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=1488e028ca7ab\r\n535'. The system cannot find the file specified.\"                                                                                                                                               \r\nAt line:1 char:1                                                                                                                                                                                \r\n+ $Connection.ConnectionString = \"Data Source=C:\\vault.db\"                                                                                                                                      \r\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                                                                                                                                      \r\n+ CategoryInfo          : NotSpecified: (:) [], ExtendedTypeSystemException                                                                                                                     \r\n+ FullyQualifiedErrorId : CatchFromBaseGetMember                                                                                                                                                \r\n                                                                                                                                                                                                \r\nPS C:\\Users\\egagn>                                                                                                                                                                              \r\n```\r\n\r\nOh well, I don't expect you to solve all my problems so I'm happy to close this ticket anytime you see fit. It does seem like I'm trying to do something that just isn't easy yet. ",
      "created_at": "2018-01-30T01:22:03Z",
      "updated_at": "2018-01-30T01:22:03Z"
    },
    {
      "author": "MaximoTrinidad",
      "author_association": "NONE",
      "body": "Please make sure to also send a note to the package owners. \r\nThey also should be able to help.\r\n\r\nI'm glad I try to give you hand!  Don't give up!\r\n:)",
      "created_at": "2018-01-30T02:00:01Z",
      "updated_at": "2018-01-30T02:00:01Z"
    },
    {
      "author": "elijahgagne",
      "author_association": "NONE",
      "body": "Thanks for the encouragement, I will surely continue working on this and post a solution once I have it.",
      "created_at": "2018-01-30T13:23:49Z",
      "updated_at": "2018-01-30T13:23:49Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@MaximoTrinidad thanks for taking the time to help @elijahgagne \r\n\r\nSince you were able to get the package to install, as @MaximoTrinidad noted you should follow up with the package owners on dotnetcore compatibility.  (note that you can still reply to this thread while closed)",
      "created_at": "2018-02-01T02:58:58Z",
      "updated_at": "2018-02-01T02:58:58Z"
    }
  ],
  "created_at": "2018-01-28T01:56:45Z",
  "labels": [
    "Issue-Question",
    "Resolution-External"
  ],
  "number": 6050,
  "state": "closed",
  "title": "Question: How to import SQLite library",
  "updated_at": "2018-02-01T02:58:58Z"
}
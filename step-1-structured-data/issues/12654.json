{
  "_url": "https://github.com/PowerShell/PowerShell/issues/12654",
  "author": "he852100",
  "body": "<!--\r\n\r\nFor Windows PowerShell 5.1 issues, suggestions, or feature requests please use the following link instead:\r\nWindows PowerShell [UserVoice](https://windowsserver.uservoice.com/forums/301869-powershell)\r\n\r\nThis repository is **ONLY** for PowerShell Core 6 and PowerShell 7+ issues.\r\n\r\n- Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\r\n- Search the existing issues.\r\n- Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\r\n- Refer to the [known issues](https://docs.microsoft.com/powershell/scripting/whats-new/known-issues-ps6?view=powershell-6).\r\n\r\n-->\r\n\r\n# Steps to reproduce\r\nWhat do i need to do next?\r\n```powershell\r\nExport-PSSession -session $session -OutputModule s -Force -CommandName \u2018Get-winEvent\u2019 -AllowClobber -CommandType all\r\nRemove-PSSession -Session $session\r\nimport-module s -vb\r\nget-winevent  -FilterHashtable @{ LogName='Security'; StartTime=$Date;  Id='4625' }\r\n\r\n```\r\n\r\n# Expected behavior\r\n\r\n```none\r\n\r\n```\r\n\r\n# Actual behavior\r\n\r\n```none\r\nerror\r\n```\r\n\r\n# Environment data\r\n\r\n<!-- provide the output of $PSVersionTable -->\r\n\r\n```none\r\n**********************\r\nPowerShell transcript start\r\nStart time: 20200514100345\r\nUsername: localhost\\root\r\nRunAs User: localhost\\root\r\nConfiguration Name: \r\nMachine: localhost (Unix 4.9.112.0)\r\nHost Application: /root/.powershell-daily/pwsh.dll\r\nProcess ID: 30283\r\nPSVersion: 7.1.0-daily.20200501\r\nPSEdition: Core\r\nGitCommitId: 7.1.0-daily.20200501\r\nOS: Linux 4.9.112-perf #1 SMP PREEMPT Mon Jan 7 10:46:47 KST 2019\r\nPlatform: Unix\r\nPSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.10032.0, 6.0.0, 6.1.0, 6.2.0, 7.0.0, 7.1.0\r\nPSRemotingProtocolVersion: 2.3\r\nSerializationVersion: 1.1.0.1\r\nWSManStackVersion: 3.0\r\n**********************\r\nTranscript started, output file is /root/PowerShell_transcript.localhost.dgpP9ud7.20200514100345.txt\r\nPS sh> CommandInvocation(Write-Verbose): \"Write-Verbose\"\r\n>> ParameterBinding(Write-Verbose): name=\"Message\"; value=\"Command is not a simple pipeline and cannot be batched.\"\r\nPS sh> $session=new-PSSession -HostName 167.179.zxx  -Port xxx -UserName administrator\r\nPS sh> Export-PSSession -session $session -OutputModule s -Force -CommandName \u2018get-process\u2019 -AllowClobber -CommandType all\r\n\r\n\r\n        Directory: /root/.local/share/powershell/Modules/s\r\n\r\n\r\nMode                LastWriteTime         Length Name\r\n----                -------------         ------ ----\r\n-----       2020/5/14   \u4e0a\u534810:04             93 \u001b[38;2;210;105;30ms.format.ps1xml\u001b[0m\r\n-----       2020/5/14   \u4e0a\u534810:04            619 \u001b[38;2;210;105;30ms.psd1\u001b[0m\r\n-----       2020/5/14   \u4e0a\u534810:04          11890 \u001b[38;2;0;191;255ms.psm1\u001b[0m\r\n\r\nPS sh> Remove-PSSession -Session $session\r\nPS sh> import-module s -vb\r\nVERBOSE: Loading module from path '/root/.local/share/powershell/Modules/s/s.psd1'.\r\nVERBOSE: Importing function 'Get-Process'.\r\nPS sh> get-process\r\nCreating a new session for implicit remoting of \"Get-Process\" command...\r\nPS sh> TerminatingError(New-PSSessionOption): \"A parameter cannot be found that matches parameter name 'Culture'.\"\r\n>> TerminatingError(New-PSSessionOption): \"A parameter cannot be found that matches parameter name 'Culture'.\"\r\n>> TerminatingError(Get-PSImplicitRemotingSession): \"A parameter cannot be found that matches parameter name 'Culture'.\"\r\n>> TerminatingError(): \"Exception calling \"GetSteppablePipeline\" with \"1\" argument(s): \"A parameter cannot be found that matches parameter name 'Culture'.\"\"\r\n>> TerminatingError(): \"Exception calling \"GetSteppablePipeline\" with \"1\" argument(s): \"A parameter cannot be found that matches parameter name 'Culture'.\"\"\r\nException calling \"GetSteppablePipeline\" with \"1\" argument(s): \"A parameter cannot be found that matches parameter name 'Culture'.\"\r\n\r\n\u001b[91mParentContainsErrorRecordException: \u001b[0m/root/.local/share/powershell/Modules/s/s.psm1:309\r\n\u001b[96mLine |\r\n\u001b[96m 309 | \u001b[0m             \u001b[96m$steppablePipeline = $scriptCmd.GetSteppablePipeline($myI\u001b[0m \u2026\r\n\u001b[96m     | \u001b[91m             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\u001b[91m\u001b[96m     | \u001b[91mException calling \"GetSteppablePipeline\" with \"1\"\r\n\u001b[96m     | \u001b[91margument(s): \"A parameter cannot be found that\r\n\u001b[96m     | \u001b[91mmatches parameter name 'Culture'.\"\r\n\u001b[0m\r\nPS sh> Stop-Transcript\r\n**********************\r\nPowerShell transcript end\r\nEnd time: 20200514100452\r\n**********************\r\n```\r\n```powershell\r\nPS sh> invoke-command -Session $session {[cultureinfo]::currentculture|fl}\r\n\r\nParent                         : zh-Hans\r\nLCID                           : 2052\r\nKeyboardLayoutId               : 2052\r\nName                           : zh-CN\r\nIetfLanguageTag                : zh-CN\r\nDisplayName                    : \u4e2d\u6587\uff08\u7b80\u4f53\uff0c\u4e2d\u56fd\uff09\r\nNativeName                     : \u4e2d\u6587(\u4e2d\u56fd)\r\nEnglishName                    : Chinese (Simplified, China)\r\nTwoLetterISOLanguageName       : zh\r\nThreeLetterISOLanguageName     : zho\r\nThreeLetterWindowsLanguageName : CHS\r\nCompareInfo                    : CompareInfo - zh-CN\r\nTextInfo                       : TextInfo - zh-CN\r\nIsNeutralCulture               : False\r\nCultureTypes                   : SpecificCultures, InstalledWin32Cult\r\n                                 ures\r\nNumberFormat                   : System.Globalization.NumberFormatInf\r\n                                 o\r\nDateTimeFormat                 : System.Globalization.DateTimeFormatI\r\n                                 nfo\r\nCalendar                       : System.Globalization.GregorianCalend\r\n                                 ar\r\nOptionalCalendars              : {System.Globalization.GregorianCalen\r\n                                 dar}\r\nUseUserOverride                : True\r\nIsReadOnly                     : True\r\n\r\n\r\nPS sh> [cultureinfo]::currentculture|fl\r\n\r\nParent                         : zh\r\nLCID                           : 2052\r\nKeyboardLayoutId               : 2052\r\nName                           : zh-CN\r\nIetfLanguageTag                : zh-CN\r\nDisplayName                    : \u4e2d\u6587\uff08\u4e2d\u56fd\uff09\r\nNativeName                     : \u4e2d\u6587\uff08\u4e2d\u56fd\uff09\r\nEnglishName                    : Chinese (China)\r\nTwoLetterISOLanguageName       : zh\r\nThreeLetterISOLanguageName     : zho\r\nThreeLetterWindowsLanguageName : CHS\r\nCompareInfo                    : CompareInfo - zh-CN\r\nTextInfo                       : TextInfo - zh-CN\r\nIsNeutralCulture               : False\r\nCultureTypes                   : SpecificCultures\r\nNumberFormat                   : System.Globalization.NumberFormatInf\r\n                                 o\r\nDateTimeFormat                 : System.Globalization.DateTimeFormatI\r\n                                 nfo\r\nCalendar                       : System.Globalization.GregorianCalend\r\n                                 ar\r\nOptionalCalendars              : {System.Globalization.GregorianCalen\r\n                                 dar}\r\nUseUserOverride                : True\r\nIsReadOnly                     : True\r\n```\r\n",
  "closed_at": null,
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@PaulHigin Have you thoughts about:\r\n```\r\nPS sh> TerminatingError(New-PSSessionOption): \"A parameter cannot be found that matches parameter name 'Culture'.\"\r\n>> TerminatingError(New-PSSessionOption): \"A parameter cannot be found that matches parameter name 'Culture'.\"\r\n>> TerminatingError(Get-PSImplicitRemotingSession): \"A parameter cannot be found that matches parameter name 'Culture'.\"\r\n>> TerminatingError(): \"Exception calling \"GetSteppablePipeline\" with \"1\" argument(s): \"A parameter cannot be found that matches parameter name 'Culture'.\"\"\r\n>> TerminatingError(): \"Exception calling \"GetSteppablePipeline\" with \"1\" argument(s): \"A parameter cannot be found that matches parameter name 'Culture'.\"\"\r\n```",
      "created_at": "2020-05-14T10:01:55Z",
      "updated_at": "2020-05-14T10:01:55Z"
    },
    {
      "author": "PaulHigin",
      "author_association": "COLLABORATOR",
      "body": "PowerShell implicit remoting is currently incompatible with SSH remoting because it contains WinRM specific code that doesn't apply to SSH.  It assumes `PSSession` is equivalent to 'WinRM session', which is not longer true.  From what I can see this dependency is only in PSSessionOption, but there may be other places.  We need to have an Issue to fix this.",
      "created_at": "2020-05-14T15:55:58Z",
      "updated_at": "2020-05-14T15:55:58Z"
    }
  ],
  "created_at": "2020-05-14T02:13:00Z",
  "labels": [
    "Issue-Question",
    "OS-Linux"
  ],
  "number": 12654,
  "state": "open",
  "title": "How to do implicit processing\uff1f",
  "updated_at": "2020-05-14T15:55:58Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/8247",
  "author": "SteveL-MSFT",
  "body": "## PR Summary\r\n\r\nWhen formatting, the `Group` start and end added unnecessary newlines which resulted in double newlines in many cases.  Formatting changes are not considered breaking.\r\n\r\n```powershell\r\n(get-module | out-string).replace(\"`n\",\"\\n`n\")\r\n```\r\n\r\nBefore:\r\n\r\n```output\r\n\\n\r\nModuleType Version    Name                                ExportedCommands\\n\r\n---------- -------    ----                                ----------------\\n\r\nManifest   6.1.0.0    Microsoft.PowerShell.Management     {Add-Content, Clear-Content, Clear-Item, Clear-ItemProperty...}\\n\r\nManifest   6.1.0.0    Microsoft.PowerShell.Utility        {Add-Member, Add-Type, Clear-Variable, Compare-Object...}\\n\r\nScript     2.0.0      PSReadLine                          {Get-PSReadLineKeyHandler, Get-PSReadLineOption, Remove-PSReadLineKeyHandler, Set-PSReadLineKeyHandler...}\\n\r\n\\n\r\n\\n\r\n```\r\n\r\nAfter:\r\n\r\n```output\r\n\\n             \r\nModuleType Version    Name                                ExportedCommands\\n\r\n---------- -------    ----                                ----------------\\n\r\nManifest   6.1.0.0    Microsoft.PowerShell.Management     {Add-Content, Clear-Content, Clear-Item, Clear-ItemProperty...}\\n\r\nManifest   6.1.0.0    Microsoft.PowerShell.Utility        {Add-Member, Add-Type, Clear-Variable, Compare-Object...}\\n\r\nScript     2.0.0      PSReadLine                          {Get-PSReadLineKeyHandler, Get-PSReadLineOption, Remove-PSReadLineKeyHandler, Set-PSReadLineKeyHandler...}\\n\r\n\\n\r\n```\r\n\r\nThere are still a few cases where the final output has two newlines (but not three anymore!).  This is a bit more complicated to fix and would need to track state that either a newline was the last thing output or the item is the last in a collection and doesn't need a separator.\r\n\r\nFix https://github.com/PowerShell/PowerShell/issues/7186\r\n\r\n## PR Checklist\r\n\r\n- [x] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - Use the present tense and imperative mood when describing your changes\r\n- [x] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] [Change is not breaking](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)\r\n- [x] [Make sure all `.h`, `.cpp`, `.cs`, `.ps1` and `.psm1` files have the correct copyright header](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - If the PR is work in progress, please add the prefix `WIP:` to the beginning of the title and remove the prefix when the PR is ready.\r\n- **User-facing changes**\r\n    - [x] Not Applicable\r\n    - **OR**\r\n    - [ ] User-facing [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n        - [ ] Issue filed - Issue link:\r\n- **Testing - New and feature**\r\n    - [ ] Not Applicable or can only be tested interactively\r\n    - **OR**\r\n    - [x] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n        - [x] [Add `[feature]` if the change is significant or affects feature tests](https://github.com/PowerShell/PowerShell/blob/master/docs/testing-guidelines/testing-guidelines.md#requesting-additional-tests-for-a-pr)\r\n",
  "closed_at": "2018-11-14T03:28:06Z",
  "comments": [
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "What we get with:\r\n```c#\r\ndir | Format-Table -GroupBy Name\r\n```",
      "created_at": "2018-11-13T04:19:18Z",
      "updated_at": "2018-11-13T04:19:18Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "```powershell\r\n(get-process pwsh | format-list | Out-String).Replace(\"`n\",\"\\n`n\")\r\n```\r\n\r\nBefore:\r\n\r\n```output\r\n\\n\r\n\\n\r\nId      : 1626\\n\r\nHandles : 0\\n\r\nCPU     : 5697.7865177\\n\r\nSI      : 422\\n\r\nName    : pwsh\\n\r\n\\n\r\nId      : 18927\\n\r\nHandles : 0\\n\r\nCPU     : 480.0566228\\n\r\nSI      : 18920\\n\r\nName    : pwsh\\n\r\n\\n\r\nId      : 18928\\n\r\nHandles : 0\\n\r\nCPU     : 771.2722798\\n\r\nSI      : 422\\n\r\nName    : pwsh\\n\r\n\\n\r\n\\n\r\n\\n\r\n\r\n```\r\n\r\nAfter:\r\n```output\r\n\\n\r\nId      : 1626\\n\r\nHandles : 0\\n\r\nCPU     : 5696.2817117\\n\r\nSI      : 422\\n\r\nName    : pwsh\\n\r\n\\n\r\nId      : 18927\\n\r\nHandles : 0\\n\r\nCPU     : 474.75417\\n\r\nSI      : 18920\\n\r\nName    : pwsh\\n\r\n\\n\r\nId      : 18928\\n\r\nHandles : 0\\n\r\nCPU     : 769.8305049\\n\r\nSI      : 422\\n\r\nName    : pwsh\\n\r\n\\n\r\n\\n\r\n\r\n```",
      "created_at": "2018-11-13T06:46:23Z",
      "updated_at": "2018-11-13T06:51:49Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "```powershell\r\n(dir | select -first 3 |Format-Table -GroupBy Name | out-string).replace(\"`n\",\"\\n`n\")\r\n```\r\n\r\nBefore:\r\n```output\r\n\\n\r\n\\n\r\n    Directory: /Users/steve/repos/PowerShell\\n\r\n\\n\r\n\\n\r\nMode                LastWriteTime         Length Name\\n\r\n----                -------------         ------ ----\\n\r\nd-----           11/4/18  7:47 AM                assets\\n\r\n\\n\r\n\\n\r\n    Directory: /Users/steve/repos/PowerShell\\n\r\n\\n\r\n\\n\r\nMode                LastWriteTime         Length Name\\n\r\n----                -------------         ------ ----\\n\r\nd-----          10/26/18 10:24 AM                demos\\n\r\n\\n\r\n\\n\r\n    Directory: /Users/steve/repos/PowerShell\\n\r\n\\n\r\n\\n\r\nMode                LastWriteTime         Length Name\\n\r\n----                -------------         ------ ----\\n\r\nd-----          10/26/18 10:24 AM                docker\\n\r\n\\n\r\n\\n\r\n\r\n```\r\n\r\nAfter:\r\n```output\r\n\\n\r\n\\n\r\n    Directory: /Users/steve/repos/PowerShell\\n\r\n\\n\r\nMode                LastWriteTime         Length Name\\n\r\n----                -------------         ------ ----\\n\r\nd-----           11/4/18  7:47 AM                assets\\n\r\n\\n\r\n    Directory: /Users/steve/repos/PowerShell\\n\r\n\\n\r\nMode                LastWriteTime         Length Name\\n\r\n----                -------------         ------ ----\\n\r\nd-----          10/26/18 10:24 AM                demos\\n\r\n\\n\r\n    Directory: /Users/steve/repos/PowerShell\\n\r\n\\n\r\nMode                LastWriteTime         Length Name\\n\r\n----                -------------         ------ ----\\n\r\nd-----          10/26/18 10:24 AM                docker\\n\r\n\\n\r\n\r\n```\r\n",
      "created_at": "2018-11-13T06:48:39Z",
      "updated_at": "2018-11-13T06:54:00Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Is it ok to have one '\\n' before \"Directory ...\"?",
      "created_at": "2018-11-13T07:22:44Z",
      "updated_at": "2018-11-13T07:22:44Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@iSazonov you are asking if it's ok to separate the groups with just a single newline vs two?  Seems fine to me and just as readable visually.  In the future, we should leverage vt100 as a way to provide visual indicators rather than rely on whitespace only.",
      "created_at": "2018-11-13T15:21:09Z",
      "updated_at": "2018-11-13T15:21:09Z"
    },
    {
      "author": "adityapatwardhan",
      "author_association": "MEMBER",
      "body": "@iSazonov  Reminder to add `CL-XXX` labels.",
      "created_at": "2018-11-15T19:03:00Z",
      "updated_at": "2018-11-15T19:03:00Z"
    }
  ],
  "created_at": "2018-11-13T03:54:12Z",
  "number": 8247,
  "state": "closed",
  "title": "Remove extra newlines from formatting which resulted in necessary double newlines",
  "updated_at": "2018-11-15T19:03:01Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/17092",
  "author": "PaulHigin",
  "body": "### Prerequisites\n\n- [X] Write a descriptive title.\n- [X] Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\n- [X] Search the existing issues.\n- [X] Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\n- [X] Refer to [Differences between Windows PowerShell 5.1 and PowerShell](https://docs.microsoft.com/powershell/scripting/whats-new/differences-from-windows-powershell).\n\n### Steps to reproduce\n\nDaily CI builds are failing on Linux platforms because two script block logging tests are failing.  One reason for the failures I found on my local Ubuntu 18.04 Linux VM, is because the complex regex matching failed in some cases.  I fixed this by creating simpler matching, but the tests continued to fail in CI builds.  The failure in CI builds appears to be because the tests picked up the wrong log entries, as the log text did not look like a script block log.\n\n### Expected behavior\n\n```console\nCI script block logging tests to pass on Linux platforms\n```\n\n\n### Actual behavior\n\n```console\nCI script block logging tests failing due to regex match failure, and incorrect log entries.\n```\n\n\n### Error details\n\n_No response_\n\n### Environment data\n\n```powershell\nName                           Value\r\n----                           -----\r\nPSVersion                      7.3.0-preview.3\r\nPSEdition                      Core\r\nGitCommitId                    7.3.0-preview.3-25-geb72cedc331d54870d670c71f4bbc6544facf341\r\nOS                             Microsoft Windows 10.0.19044\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\n```\n\n\n### Visuals\n\nDescribing Basic SysLog tests on Linux\r\n+\r\n    [-] Verifies scriptblock logging 2.2s\r\n      Expected like wildcard '*test01.ps1*' to match 'Creating Scriptblock text (1 of 3):#012#\u23ce\u23ce# Module manifest for module 'Microsoft.Graph.Identity.SignIns'\u23ce\u23ce#\u23ce\u23ce# Generated by: Microsoft Corporation\u23ce\u23ce#\u23ce\u23ce# Generated on: 3/8/2022\u23ce\u23ce#\u23ce\u23ce\u23ce\u23ce@{\u23ce\u23ce\u23ce\u23ce# Script module or binary module file associated with this manifest.\u23ce\u23ceRootModule = './Microsoft.Graph.Identity.SignIns.psm1'\u23ce\u23ce\u23ce\u23ce# Version number of this module.\u23ce\u23ceModuleVersion = '1.9.3'\u23ce\u23ce\u23ce\u23ce# Supported PSEditions\u23ce\u23ceCompatiblePSEditions = 'Core', 'Desktop'\u23ce\u23ce\u23ce\u23ce# ID used to uniquely identify this module\u23ce\u23ceGUID = '8d8d2305-e4d0-4551-a5cd-dbce85325cea'\u23ce\u23ce\u23ce\u23ce# Author of this module\u23ce\u23ceAuthor = 'Microsoft Corporation'\u23ce\u23ce\u23ce\u23ce# Company or vendor of this module\u23ce\u23ceCompanyName = 'Microsoft Corporation'\u23ce\u23ce\u23ce\u23ce# Copyright statement for this module\u23ce\u23ceCopyright = 'Microsoft Corporation. All rights reserved.'\u23ce\u23ce\u23ce\u23ce# Description of the functionality provided by this module\u23ce\u23ceDescription = 'Microsoft Graph PowerShell Cmdlets'\u23ce\u23ce\u23ce\u23ce# Minimum version of the PowerShell engine required by this module\u23ce\u23cePowerShellVersion = '5.1'\u23ce\u23ce\u23ce\u23ce# Name of the PowerShell host required by this module\u23ce\u23ce# PowerShellHostName = ''\u23ce\u23ce\u23ce\u23ce# Minimum version of the PowerShell host required by this module\u23ce\u23ce# PowerShellHostVersion = ''\u23ce\u23ce\u23ce\u23ce# Minimum version of Microsoft .NET Framework required by this module. This prerequisite is valid for the PowerShell Desktop edition only.\u23ce\u23ceDotNetFrameworkVersion = '4.7.2'\u23ce\u23ce\u23ce\u23ce# Minimum version of the common language runtime (CLR) required by this module. This prerequisite is valid for the PowerShell Desktop edition only.\u23ce\u23ce# ClrVersion = ''\u23ce\u23ce\u23ce\u23ce# Processor architecture (None, X86, Amd64) required by this module\u23ce\u23ce# ProcessorArchitecture = ''\u23ce\u23ce\u23ce\u23ce# Modules that must be imported into the global environment prior to importing this module\u23ce\u23ceRequiredModules = @(@{ModuleName = 'Microsoft.Graph.Authentication'; ModuleVersion = '1.9.3'; })\u23ce\u23ce\u23ce\u23ce# Assemblies that must be loaded prior to importing this module\u23ce\u23ceRequiredAssemblies = './bin/Microsoft.Graph.Identity.SignIns.private.dll'\u23ce\u23ce\u23ce\u23ce# Script files (.ps1) that are run in the caller's environment prior to importing this module.\u23ce\u23ce# ScriptsToProcess = @()\u23ce\u23ce\u23ce\u23ce# Type files (.ps1xml) to be loaded when importing this module\u23ce\u23ce# TypesToProcess = @()\u23ce\u23ce\u23ce\u23ce# Format files (.ps1xml) to be loaded when importing this module\u23ce\u23ceFormatsToProcess = './Microsoft.Graph.Identity.SignIns.format.ps1xml'\u23ce\u23ce\u23ce\u23ce# Modules to import as nested modules of the module specified in RootModule/ModuleToProcess\u23ce\u23ce# NestedModules = @()\u23ce\u23ce\u23ce\u23ce# Functions to export from this module, for best performance, do not use wildcards and do not delete the entry, use an empty array if there are no functions to export.\u23ce\u23ceFunctionsToExport = 'Confirm-MgInformationProtectionSignature', \u23ce\u23ce               'Confirm-MgRiskyUserCompromised', 'Get-MgDataPolicyOperation', \u23ce\u23ce               'Get-MgIdentityConditionalAccessAuthenticationContextClassReference', \u23ce\u23ce               'Get-MgIdentityConditionalAccessNamedLocation', \u23ce\u23ce               'Get-MgIdentityConditionalAccessPolicy', 'Get-MgIdentityProvider', \u23ce\u23ce               'Get-MgIdentityUserFlow', 'Get-MgInformationProtection', \u23ce\u23ce               'Get-MgInformationProtectionBitlocker', \u23ce\u23ce               'Get-MgInformationProtectionBitlockerRecoveryKey', \u23ce\u23ce               'Get-MgInformationProtectionDataLossPreventionPolicy', \u23ce\u23ce               'Get-MgInformationProtectionPolicy', \u23ce\u23ce               'Get-MgInformationProtectionPolicyLabel', \u23ce\u23ce               'Get-MgInformationProtectionSensitivityPolicySetting', \u23ce\u23ce               'Get-MgInformationProtectionThreatAssessmentRequest', \u23ce\u23ce               'Get-MgInformationProtectionThreatAssessmentRequestResult', \u23ce\u23ce               'Get-MgOauth2PermissionGrant', 'Get-MgOauth2PermissionGrantDelta', \u23ce\u23ce               'Get-MgOrganizationCertificateBasedAuthConfiguration', \u23ce\u23ce               'Get-MgOrganizationCertificateBasedAuthConfigurationByRef', \u23ce\u23ce               'Get-MgPolicyAccessReviewPolicy', \u23ce\u23ce               'Get-MgPolicyActivityBasedTimeoutPolicy', \u23ce\u23ce               'Get-MgPolicyAdminConsentRequestPolicy', \u23ce\u23ce               'Get-MgPolicyAppManagementPolicy', \u23ce\u23ce               'Get-MgPolicyAppManagementPolicyApplyTo', \u23ce\u23ce               'Get-MgPolicyAppManagementPolicyApplyToByRef', \u23ce\u23ce               'Get-MgPolicyAuthenticationFlowPolicy', \u23ce\u23ce               'Get-MgPolicyAuthenticationMethodPolicy', \u23ce\u23ce               'Get-MgPolicyAuthorizationPolicy', \u23ce\u23ce               'Get-MgPolicyAuthorizationPolicyDefaultUserRoleOverride', \u23ce\u23ce               'Get-MgPolicyB2CAuthenticationMethodPolicy', \u23ce\u23ce               'Get-MgPolicyClaimMappingPolicy', \u23ce\u23ce               'Get-MgPolicyCrossTenantAccessPolicy', \u23ce\u23ce               'Get-MgPolicyCrossTenantAccessPolicyDefault', \u23ce\u23ce               'Get-MgPolicyCrossTenantAccessPolicyPartner', \u23ce\u23ce               'Get-MgPolicyDefaultAppManagementPolicy', \u23ce\u23ce               'Get-MgPolicyDirectoryRoleAccessReviewPolicy', \u23ce\u23ce               'Get-MgPolicyExternalIdentityPolicy', \u23ce\u23ce               'Get-MgPolicyFeatureRolloutPolicy', \u23ce\u23ce               'Get-MgPolicyFeatureRolloutPolicyApplyTo', \u23ce\u23ce               'Get-MgPolicyHomeRealmDiscoveryPolicy', \u23ce\u23ce               'Get-MgPolicyIdentitySecurityDefaultEnforcementPolicy', \u23ce\u23ce               'Get-MgPolicyMobileAppManagementPolicy', \u23ce\u23ce               'Get-MgPolicyMobileDeviceManagementPolicy', \u23ce\u23ce               'Get-MgPolicyPermissionGrantPolicy', \u23ce\u23ce               'Get-MgPolicyPermissionGrantPolicyExclude', \u23ce\u23ce               'Get-MgPolicyPermissionGrantPolicyInclude', \u23ce\u23ce               'Get-MgPolicyRoleManagementPolicy', \u23ce\u23ce               'Get-MgPolicyRoleManagementPolicyAssignment', \u23ce\u23ce               'Get-MgPolicyRoleManagementPolicyAssignmentPolicy', \u23ce\u23ce               'Get-MgPolicyRoleManagementPolicyAssignmentPolicyByRef', \u23ce\u23ce               'Get-MgPolicyRoleManagementPolicyEffectiveRule', \u23ce\u23ce               'Get-MgPolicyRoleManagementPolicyRule', \u23ce\u23ce               'Get-MgPolicyServicePrincipalCreationPolicy', \u23ce\u23ce               'Get-MgPolicyServicePrincipalCreationPolicyExclude', \u23ce\u23ce               'Get-MgPolicyServicePrincipalCreationPolicyInclude', \u23ce\u23ce               'Get-MgPolicyTokenIssuancePolicy', \u23ce\u23ce               'Get-MgPolicyTokenLifetimePolicy', 'Get-MgRiskDetection', \u23ce\u23ce               'Get-MgRiskyUser', 'Get-MgRiskyUserHistory', 'Get-MgTrustFramework', \u23ce\u23ce               'Get-MgTrustFrameworkKeySet', 'Get-MgTrustFrameworkKeySetActiveKey', \u23ce\u23ce               'Get-MgTrustFrameworkPolicy', 'Get-MgTrustFrameworkPolicyContent', \u23ce\u23ce               'Get-MgUserAuthenticationEmailMethod', \u23ce\u23ce               'Get-MgUserAuthenticationFido2Method', \u23ce\u23ce               'Get-MgUserAuthenticationMethod', \u23ce\u23ce               'Get-MgUserAuthenticationMicrosoftAuthenticatorMethod', \u23ce\u23ce               'Get-MgUserAuthenticationMicrosoftAuthenticatorMethodDevice', \u23ce\u23ce               'Get-MgUserAuthenticationOperation', \u23ce\u23ce               'Get-MgUserAuthenticationPasswordlessMicrosoftAuthenticatorMethod', \u23ce\u23ce               'Get-MgUserAuthenticationPasswordlessMicrosoftAuthenticatorMethodDevice', \u23ce\u23ce               'Get-MgUserAuthenticationPasswordMethod', \u23ce\u23ce               'Get-MgUserAuthenticationPhoneMethod', \u23ce\u23ce               'Get-MgUserAuthenticationSoftwareOathMethod', \u23ce\u23ce               'Get-MgUserAuthenticationTemporaryAccessPassMethod', \u23ce\u23ce               'Get-MgUserAuthenticationWindowHello', \u23ce\u23ce               'Get-MgUserAuthenticationWindowHelloForBusinessMethodDevice', \u23ce\u23ce               'Get-MgUserInformationProtection', \u23ce\u23ce               'Inv', but it did not match.\r\n      211:         $createdEvents[0].Message | Should -BeLike \"*$testFileName*\"\r\n      at <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Host/Logging.Tests.ps1: line 211\r\n    [-] Verifies scriptblock logging with null character 1.83s\r\n      Expected like wildcard '*test01.ps1*' to match 'Creating Scriptblock text (1 of 1):#012#\u23ce\u23ce# Module manifest for module 'Microsoft.Graph.Files'\u23ce\u23ce#\u23ce\u23ce# Generated by: Microsoft Corporation\u23ce\u23ce#\u23ce\u23ce# Generated on: 3/8/2022\u23ce\u23ce#\u23ce\u23ce\u23ce\u23ce@{\u23ce\u23ce\u23ce\u23ce# Script module or binary module file associated with this manifest.\u23ce\u23ceRootModule = './Microsoft.Graph.Files.psm1'\u23ce\u23ce\u23ce\u23ce# Version number of this module.\u23ce\u23ceModuleVersion = '1.9.3'\u23ce\u23ce\u23ce\u23ce# Supported PSEditions\u23ce\u23ceCompatiblePSEditions = 'Core', 'Desktop'\u23ce\u23ce\u23ce\u23ce# ID used to uniquely identify this module\u23ce\u23ceGUID = '474084f3-9317-4ff1-863f-808d6ff993c3'\u23ce\u23ce\u23ce\u23ce# Author of this module\u23ce\u23ceAuthor = 'Microsoft Corporation'\u23ce\u23ce\u23ce\u23ce# Company or vendor of this module\u23ce\u23ceCompanyName = 'Microsoft Corporation'\u23ce\u23ce\u23ce\u23ce# Copyright statement for this module\u23ce\u23ceCopyright = 'Microsoft Corporation. All rights reserved.'\u23ce\u23ce\u23ce\u23ce# Description of the functionality provided by this module\u23ce\u23ceDescription = 'Microsoft Graph PowerShell Cmdlets'\u23ce\u23ce\u23ce\u23ce# Minimum version of the PowerShell engine required by this module\u23ce\u23cePowerShellVersion = '5.1'\u23ce\u23ce\u23ce\u23ce# Name of the PowerShell host required by this module\u23ce\u23ce# PowerShellHostName = ''\u23ce\u23ce\u23ce\u23ce# Minimum version of the PowerShell host required by this module\u23ce\u23ce# PowerShellHostVersion = ''\u23ce\u23ce\u23ce\u23ce# Minimum version of Microsoft .NET Framework required by this module. This prerequisite is valid for the PowerShell Desktop edition only.\u23ce\u23ceDotNetFrameworkVersion = '4.7.2'\u23ce\u23ce\u23ce\u23ce# Minimum version of the common language runtime (CLR) required by this module. This prerequisite is valid for the PowerShell Desktop edition only.\u23ce\u23ce# ClrVersion = ''\u23ce\u23ce\u23ce\u23ce# Processor architecture (None, X86, Amd64) required by this module\u23ce\u23ce# ProcessorArchitecture = ''\u23ce\u23ce\u23ce\u23ce# Modules that must be imported into the global environment prior to importing this module\u23ce\u23ceRequiredModules = @(@{ModuleName = 'Microsoft.Graph.Authentication'; ModuleVersion = '1.9.3'; })\u23ce\u23ce\u23ce\u23ce# Assemblies that must be loaded prior to importing this module\u23ce\u23ceRequiredAssemblies = './bin/Microsoft.Graph.Files.private.dll'\u23ce\u23ce\u23ce\u23ce# Script files (.ps1) that are run in the caller's environment prior to importing this module.\u23ce\u23ce# ScriptsToProcess = @()\u23ce\u23ce\u23ce\u23ce# Type files (.ps1xml) to be loaded when importing this module\u23ce\u23ce# TypesToProcess = @()\u23ce\u23ce\u23ce\u23ce# Format files (.ps1xml) to be loaded when importing this module\u23ce\u23ceFormatsToProcess = './Microsoft.Graph.Files.format.ps1xml'\u23ce\u23ce\u23ce\u23ce# Modules to import as nested modules of the module specified in RootModule/ModuleToProcess\u23ce\u23ce# NestedModules = @()\u23ce\u23ce\u23ce\u23ce# Functions to export from this module, for best performance, do not use wildcards and do not delete the entry, use an empty array if there are no functions to export.\u23ce\u23ceFunctionsToExport = 'Add-MgDriveListContentTypeBaseTypeCopy', \u23ce\u23ce               'Add-MgDriveListContentTypeBaseTypeCopyFromContentTypeHub', \u23ce\u23ce               'Add-MgDriveListContentTypeCopy', \u23ce\u23ce               'Add-MgDriveListContentTypeCopyFromContentTypeHub', \u23ce\u23ce               'Add-MgShareListContentTypeBaseTypeCopy', \u23ce\u23ce               'Add-MgShareListContentTypeBaseTypeCopyFromContentTypeHub', \u23ce\u23ce               'Add-MgShareListContentTypeCopy', \u23ce\u23ce               'Add-MgShareListContentTypeCopyFromContentTypeHub', \u23ce\u23ce               'Copy-MgDriveListContentTypeBaseToDefaultContentLocation', \u23ce\u23ce               'Copy-MgDriveListContentTypeToDefaultContentLocation', \u23ce\u23ce               'Copy-MgShareListContentTypeBaseToDefaultContentLocation', \u23ce\u23ce               'Copy-MgShareListContentTypeToDefaultContentLocation', \u23ce\u23ce               'Get-MgDrive', 'Get-MgDriveActivity', 'Get-MgDriveBundle', \u23ce\u23ce               'Get-MgDriveBundleContent', 'Get-MgDriveFollowing', \u23ce\u23ce               'Get-MgDriveFollowingContent', 'Get-MgDriveItem', \u23ce\u23ce               'Get-MgDriveItemContent', 'Get-MgDriveList', \u23ce\u23ce               'Get-MgDriveListActivity', 'Get-MgDriveListColumn', \u23ce\u23ce               'Get-MgDriveListColumnSourceColumn', \u23ce\u23ce               'Get-MgDriveListColumnSourceColumnByRef', \u23ce\u23ce               'Get-MgDriveListContentType', 'Get-MgDriveListContentTypeBase', \u23ce\u23ce               'Get-MgDriveListContentTypeBaseByRef', \u23ce\u23ce               'Get-MgDriveListContentTypeBaseType', \u23ce\u23ce               'Get-MgDriveListContentTypeBaseTypeByRef', \u23ce\u23ce               'Get-MgDriveListContentTypeBaseTypeCompatibleHubContentType', \u23ce\u23ce               'Get-MgDriveListContentTypeColumn', \u23ce\u23ce               'Get-MgDriveListContentTypeColumnLink', \u23ce\u23ce               'Get-MgDriveListContentTypeColumnPosition', \u23ce\u23ce               'Get-MgDriveListContentTypeColumnPositionByRef', \u23ce\u23ce               'Get-MgDriveListContentTypeColumnSourceColumn', \u23ce\u23ce               'Get-MgDriveListContentTypeColumnSourceColumnByRef', \u23ce\u23ce               'Get-MgDriveListContentTypeCompatibleHubContentType', \u23ce\u23ce               'Get-MgDriveListDrive', 'Get-MgDriveListDriveByRef', \u23ce\u23ce               'Get-MgDriveListItem', 'Get-MgDriveListItemActivity', \u23ce\u23ce               'Get-MgDriveListItemAnalytic', 'Get-MgDriveListItemAnalyticByRef', \u23ce\u23ce               'Get-MgDriveListItemDelta', 'Get-MgDriveListItemDriveItem', \u23ce\u23ce               'Get-MgDriveListItemDriveItemByRef', 'Get-MgDriveListItemField', \u23ce\u23ce               'Get-MgDriveListItemVersion', 'Get-MgDriveListItemVersionField', \u23ce\u23ce               'Get-MgDriveListOperation', 'Get-MgDriveListSubscription', \u23ce\u23ce               'Get-MgDriveRoot', 'Get-MgDriveRootContent', 'Get-MgDriveSpecial', \u23ce\u23ce               'Get-MgDriveSpecialContent', 'Get-MgGroupDrive', \u23ce\u23ce               'Get-MgGroupDriveByRef', 'Get-MgShareDriveItem', \u23ce\u23ce               'Get-MgShareDriveItemByRef', 'Get-MgShareItem', \u23ce\u23ce               'Get-MgShareItemByRef', 'Get-MgShareList', 'Get-MgShareListActivity', \u23ce\u23ce               'Get-MgShareListColumn', 'Get-MgShareListColumnSourceColumn', \u23ce\u23ce               'Get-MgShareListColumnSourceColumnByRef', \u23ce\u23ce               'Get-MgShareListContentType', 'Get-MgShareListContentTypeBase', \u23ce\u23ce               'Get-MgShareListContentTypeBaseByRef', \u23ce\u23ce               'Get-MgShareListContentTypeBaseType', \u23ce\u23ce               'Get-MgShareListContentTypeBaseTypeByRef', \u23ce\u23ce               'Get-MgShareListContentTypeBaseTypeCompatibleHubContentType', \u23ce\u23ce               'Get-MgShareListContentTypeColumn', \u23ce\u23ce               'Get-MgShareListContentTypeColumnLink', \u23ce\u23ce               'Get-MgShareListContentTypeColumnPosition', \u23ce\u23ce               'Get-MgShareListContentTypeColumnPositionByRef', \u23ce\u23ce               'Get-MgShareListContentTypeColumnSourceColumn', \u23ce\u23ce               'Get-MgShareListContentTypeColumnSourceColumnByRef', \u23ce\u23ce               'Get-MgShareListContentTypeCompatibleHubContentType', \u23ce\u23ce               'Get-MgShareListDrive', 'Get-MgShareListDriveByRef', \u23ce\u23ce               'Get-MgShareListItem', 'Get-MgShareListItemActivity', \u23ce\u23ce               'Get-MgShareListItemAnalytic', 'Get-MgShareListItemAnalyticByRef', \u23ce\u23ce               'Get-MgShareListItemDelta', 'Get-MgShareListItemDriveItem', \u23ce\u23ce               'Get-MgShareListItemDriveItemByRef', 'Get-MgShareListItemField', \u23ce\u23ce               'Get-MgShareListItemVersion', 'Get-MgShareListItemVersionField', \u23ce\u23ce               'Get-MgShareListOperation', 'Get-MgShareListSubscription', \u23ce\u23ce               'Get-MgSharePermission', 'Get-MgShareRoot', 'Get-MgShareRootByRef', \u23ce\u23ce               'Get-MgShareSharedDriveItemSharedDriveItem', 'Get-MgShareSite', \u23ce\u23ce               'Get-MgShareSiteByRef', 'Get-MgUserDrive', 'Get-MgUserDriveByRef', \u23ce\u23ce               'Grant-MgSharePermission', 'Invoke-MgRecentDrive', \u23ce\u23ce               'Invoke-MgSharedDrive', 'Join-MgDriveListContentType', \u23ce\u23ce               'Join-MgDriveListContentTypeBas', but it did not match.\r\n      243:         $createdEvents[0].Message | Should -BeLike \"*$testFileName*\"\r\n      at <ScriptBlock>, /home/vsts/work/1/s/test/powershell/Host/Logging.Tests.ps1: line 243\r\n+\r\n",
  "closed_at": null,
  "comments": [],
  "created_at": "2022-03-31T18:32:29Z",
  "number": 17092,
  "state": "open",
  "title": "Scriptblock logging tests failing in CI for Linux platforms",
  "updated_at": "2022-03-31T18:32:29Z"
}
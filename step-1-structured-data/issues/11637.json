{
  "_url": "https://github.com/PowerShell/PowerShell/issues/11637",
  "author": "psmitt",
  "body": "<!--\r\n\r\nFor Windows PowerShell 5.1 issues, suggestions, or feature requests please use the following link instead:\r\nWindows PowerShell [UserVoice](https://windowsserver.uservoice.com/forums/301869-powershell)\r\n\r\nThis repository is **ONLY** for PowerShell Core 6 and PowerShell 7+ issues.\r\n\r\n- Make sure you are able to repro it on the [latest released version](https://github.com/PowerShell/PowerShell/releases)\r\n- Search the existing issues.\r\n- Refer to the [FAQ](https://github.com/PowerShell/PowerShell/blob/master/docs/FAQ.md).\r\n- Refer to the [known issues](https://docs.microsoft.com/powershell/scripting/whats-new/known-issues-ps6?view=powershell-6).\r\n\r\n-->\r\n\r\nI create a location stack, I make it default, then by popping stored location I empty it.\r\nAfter I change back the default stack to the unnamed, but the system does not handle that in the same way as before. Moreover, the named stack stays somehow in play, because if I push something\r\nto the unnamed stack even the previously used named stack receives it.\r\n\r\n# Steps to reproduce\r\n\r\n```powershell\r\nPS C:\\> Get-Location -Stack\r\nPS C:\\> Get-Location -StackName $null\r\nPS C:\\> Get-Location -StackName A\r\nGet-Location: Cannot process argument because the value of argument \"stackName\" is not valid. Change the value of the \"stackName\" argument and run the operation again.\r\nPS C:\\> Push-Location Z:\\ -StackName A\r\nPS Z:\\> Get-Location -Stack\r\nPS Z:\\> Get-Location -StackName $null\r\nPS Z:\\> Get-Location -StackName A\r\n\r\nPath\r\n----\r\nC:\\\r\n\r\nPS Z:\\> Set-Location -StackName A\r\nPS Z:\\> Pop-Location\r\nPS C:\\> Set-Location -StackName $null\r\nPS C:\\> Get-Location -Stack\r\nGet-Location: Cannot process argument because the value of argument \"stackName\" is not valid. Change the value of the \"stackName\" argument and run the operation again.\r\nPS C:\\> Get-Location -StackName $null\r\nGet-Location: Cannot process argument because the value of argument \"stackName\" is not valid. Change the value of the \"stackName\" argument and run the operation again.\r\nPS C:\\> Get-Location -StackName A\r\nGet-Location: Cannot process argument because the value of argument \"stackName\" is not valid. Change the value of the \"stackName\" argument and run the operation again.\r\nPS C:\\> Push-Location Z:\\\r\nPS Z:\\> Get-Location -Stack\r\n\r\nPath\r\n----\r\nC:\\\r\n\r\nPS Z:\\> Get-Location -StackName $null\r\n\r\nPath\r\n----\r\nC:\\\r\n\r\nPS Z:\\> Get-Location -StackName A\r\n\r\nPath\r\n----\r\nC:\\\r\n```\r\n\r\n# Expected behavior\r\n\r\n```none\r\nPS C:\\> Get-Location -Stack\r\nPS C:\\> Get-Location -StackName $null\r\nPS C:\\> Get-Location -StackName A\r\nGet-Location: Cannot process argument because the value of argument \"stackName\" is not valid. Change the value of the \"stackName\" argument and run the operation again.\r\nPS C:\\> Push-Location Z:\\ -StackName A\r\nPS Z:\\> Get-Location -Stack\r\nPS Z:\\> Get-Location -StackName $null\r\nPS Z:\\> Get-Location -StackName A\r\n\r\nPath\r\n----\r\nC:\\\r\n\r\nPS Z:\\> Set-Location -StackName A\r\nPS Z:\\> Pop-Location\r\nPS C:\\> Set-Location -StackName $null\r\nPS C:\\> Get-Location -Stack\r\nPS C:\\> Get-Location -StackName $null\r\nPS C:\\> Get-Location -StackName A\r\nGet-Location: Cannot process argument because the value of argument \"stackName\" is not valid. Change the value of the \"stackName\" argument and run the operation again.\r\nPS C:\\> Push-Location Z:\\\r\nPS Z:\\> Get-Location -Stack\r\n\r\nPath\r\n----\r\nC:\\\r\n\r\nPS Z:\\> Get-Location -StackName $null\r\n\r\nPath\r\n----\r\nC:\\\r\n\r\nPS Z:\\> Get-Location -StackName A\r\nGet-Location: Cannot process argument because the value of argument \"stackName\" is not valid. Change the value of the \"stackName\" argument and run the operation again.\r\n```\r\n\r\n# Actual behavior\r\n\r\n```none\r\nSee the Steps to reproduce section\r\n```\r\n\r\n# Environment data\r\n\r\n<!-- provide the output of $PSVersionTable -->\r\n\r\n```none\r\nPS Z:\\> $PSVersionTable\r\n\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.0.0-rc.2\r\nPSEdition                      Core\r\nGitCommitId                    7.0.0-rc.2\r\nOS                             Microsoft Windows 10.0.17763\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\n",
  "closed_at": null,
  "comments": [],
  "created_at": "2020-01-20T11:37:31Z",
  "number": 11637,
  "state": "open",
  "title": "Location stack misbehavior",
  "updated_at": "2020-08-20T19:13:46Z"
}
{
  "_url": "https://github.com/PowerShell/PowerShell/issues/4132",
  "author": "SteveL-MSFT",
  "body": "Now that we have moved to .Net Std 2.0 compatible CoreClr 2.0 and added capability to search GAC for assemblies, we need to make it easier for users to use Windows PowerShell modules from PSCore6 to get feedback on compatibility.\r\n\r\nThis change is only for Windows and appends the Windows PowerShell PSModulePath on startup.  Depending on the data/feedback we get, we can decide what to do (opt-in vs opt-out) as we get closer to a release candidate.\r\n\r\nOut-Default tests has to be updated to suppress the Warning message by not loading the profile.\r\n\r\nRelated #4056 \r\n\r\nBased on the customer data, we can decide a more permanent solution.",
  "closed_at": "2017-07-07T16:43:37Z",
  "comments": [
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "Although I intend for this to be temporary, I'll add a test case",
      "created_at": "2017-06-28T19:25:16Z",
      "updated_at": "2017-06-28T19:25:16Z"
    },
    {
      "author": "lzybkr",
      "author_association": "MEMBER",
      "body": "Because this is a temporary change - can we have a temporary test that will fail at some **fixed** point in the future - even if it's a nightly failure, that would be fine.\r\n\r\nThe point here - if we reach that point where the test starts failing, we need to take action, either implement this correctly (not via a profile script), remove it, or something else.",
      "created_at": "2017-06-29T18:44:41Z",
      "updated_at": "2017-06-29T18:44:41Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@lzybkr rather than having a temporary test, I've changed this to not be a 'fix' but related so we'll keep the issue open and will revisit after we get some customer data",
      "created_at": "2017-06-30T17:39:50Z",
      "updated_at": "2017-06-30T17:39:50Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@adityapatwardhan looks like I had some changes staged on a different computer that wasn't committed (Console Tests), can you take a quick look?",
      "created_at": "2017-07-03T15:24:07Z",
      "updated_at": "2017-07-03T15:24:07Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@lzybkr can you merge so we can get this in for beta.4?",
      "created_at": "2017-07-03T23:48:12Z",
      "updated_at": "2017-07-03T23:48:12Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@TravisEz13 can you merge this since @lzybkr is currently out of office?",
      "created_at": "2017-07-06T00:55:58Z",
      "updated_at": "2017-07-06T00:55:58Z"
    },
    {
      "author": "alexandair",
      "author_association": "CONTRIBUTOR",
      "body": "This change doesn't make sense on new Nano Server container.\r\nThis is what you see when you start microsoft/nanoserver-insider-powershell:\r\n\r\n\"WARNING: Appended Windows PowerShell PSModulePath\"\r\n\r\n```\r\nPS C:\\> $env:psmodulepath -split ';'\r\nPowerShell\\Modules\r\nc:\\program files\\powershell\\Modules\r\nC:\\Users\\ContainerUser\\Documents\\WindowsPowerShell\\Modules\r\nC:\\Program Files\\WindowsPowerShell\\Modules\r\nC:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\\r\n```\r\n\r\n3 of those 5 paths are unnecessary on new Nano Server.\r\n",
      "created_at": "2017-07-17T14:00:35Z",
      "updated_at": "2017-07-17T14:00:35Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@alexandair you are correct, NanoServer-Insider doesn't have Windows PowerShell Core 5.1 anymore.  Can you add a comment to https://github.com/PowerShell/PowerShell/issues/4056?  The final resolution to this will likely be adding a config setting to the startup json file and checking if full windows.  Thanks.",
      "created_at": "2017-07-17T15:52:10Z",
      "updated_at": "2017-07-17T15:52:10Z"
    },
    {
      "author": "alexandair",
      "author_association": "CONTRIBUTOR",
      "body": "@SteveL-MSFT Done.",
      "created_at": "2017-07-17T16:53:28Z",
      "updated_at": "2017-07-17T16:53:28Z"
    },
    {
      "author": "MathiasMagnus",
      "author_association": "NONE",
      "body": "Is there a way to turn off the warning? It's fairly annoying and I can give feedback without it reminding me on every startup.",
      "created_at": "2017-07-23T20:28:05Z",
      "updated_at": "2017-07-23T20:28:05Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@MathiasMagnus edit Microsoft.PowerShell_profile.ps1 in $PSHome and remove the Write-Warning line",
      "created_at": "2017-07-24T03:11:43Z",
      "updated_at": "2017-07-24T03:11:43Z"
    },
    {
      "author": "MathiasMagnus",
      "author_association": "NONE",
      "body": "@SteveL-MSFT Thanks. :)\r\n\r\nAs a sidenote: is it instructive to think that these are 1-to-1 mappings?\r\n\r\n| Powershell | Bash |\r\n| ------------ | ---- |\r\n| `$PSHOME\\Microsoft.PowerShell_profile.ps1` | `/etc/profile` |\r\n| `$PROFILE` | `~/.profile` |\r\n",
      "created_at": "2017-07-24T06:58:39Z",
      "updated_at": "2017-07-24T06:58:39Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@MathiasMagnus yes",
      "created_at": "2017-07-24T17:05:55Z",
      "updated_at": "2017-07-24T17:05:55Z"
    }
  ],
  "created_at": "2017-06-28T16:20:09Z",
  "number": 4132,
  "state": "closed",
  "title": "Enable Windows PowerShell PSModulePath by default on Windows",
  "updated_at": "2017-07-24T17:05:55Z"
}
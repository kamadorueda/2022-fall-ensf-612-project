{
  "_url": "https://github.com/PowerShell/PowerShell/issues/3395",
  "author": "iSazonov",
  "body": "It is first experimental implementation Get-Hash cmdlet for https://github.com/PowerShell/PowerShell-RFC/blob/master/2-Draft-Accepted/RFC0018-Get-StringHash.md\r\n\r\n1. According to the RFC the type of Encoding parameter is `FileSystemCmdletProviderEncoding` but I had to use `EncodingConversion class` because the API contains useful methods and can be easily _enhanced_ in future (to support full set of codepages). Now multiple Utility cmdlets uses it. In contrast, a code using `FileSystemCmdletProviderEncoding` type is distributed in FileProvider and it's hard to reuse it although it is designated as the preferred (?) in https://github.com/PowerShell/PowerShell-RFC/blob/master/1-Draft/RFC0020-DefaultFileEncoding.md We also talked about that we should rationalize the use of encoding so `EncodingConversion class` looks like the best option.\r\n2. Added `ValueFromPipelineByPropertyName` to `Path` parameter that is skipped in the RFC 0018.\r\n3. ~~After the implementation we can really see that `Path` and `InputString` parameters have the same type and cannot be both `ValueFromPipeline`. Perhaps here we understand that it is better for UX to have both options and we should split on `Get-FileHash` and `Get-StringHash` still. Until concluding on this I haven't added pipeline tests.~~ We follow `Select-String` pattern as suggested by @rkeithhill.\r\n4. ~~I wanted to implement `ValidateEncoding` attribute but was blocked so how to implement Tab Completion. I need help.~~ We should follow #4119.",
  "closed_at": "2018-03-27T00:39:27Z",
  "comments": [
    {
      "author": "rkeithhill",
      "author_association": "COLLABORATOR",
      "body": "RE # 3, try changing the InputString type to `PSObject[]` and then convert each PSObject ToString before hashing.  That should get you around the pipeline binding issue.  This pattern in common for cmdlets that take both an InputObject and Path parameters like `Select-String`.",
      "created_at": "2017-03-22T15:48:12Z",
      "updated_at": "2017-03-22T15:48:22Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@rkeithhill Thanks for workaround! The code looks not pretty. But I am ready to try this if community votes for this.\r\n\r\nCan we introduce new `Path` type to resolve such problems? (This can be a lot of work)\r\n```powershell\r\npublic class PSPath : PSObject\r\n{\r\n    string Path;\r\n    public string ToString()\r\n    {\r\n        return Path;\r\n    }\r\n}\r\n```",
      "created_at": "2017-03-23T03:49:06Z",
      "updated_at": "2017-03-23T03:49:06Z"
    },
    {
      "author": "rkeithhill",
      "author_association": "COLLABORATOR",
      "body": "If you look at the SelectStringCommand impl - https://github.com/PowerShell/PowerShell/blob/02b5f357a20e6dee9f8e60e3adb9025be3c94490/src/Microsoft.PowerShell.Commands.Utility/commands/utility/MatchString.cs#L1009  it appears you use the `FilenfoToString` argument transform attribute on the `Path/LiteralPath` parameters.",
      "created_at": "2017-03-23T04:27:12Z",
      "updated_at": "2017-03-23T04:27:12Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "How do the attribute help to resolve conflict of parameter bindings?",
      "created_at": "2017-03-23T13:20:04Z",
      "updated_at": "2017-03-23T13:20:04Z"
    },
    {
      "author": "rkeithhill",
      "author_association": "COLLABORATOR",
      "body": "Given that this attribute is private I've not had the chance to use it.  However, it makes `Select-String` work so I'm assuming here it should make `Get-Hash` work as well.  If you look at the parameter config for `Select-String` it is very similar to `Get-Hash`:\r\n```\r\n    Command: Microsoft.PowerShell.Utility/Select-String\r\n    Set:    File *\r\n\r\n\r\nName                   Aliases      Position Mandatory Pipeline ByName Provider        Type\r\n----                   -------      -------- --------- -------- ------ --------        ----\r\nAllMatches             {A*}         Named    False     False    False  All             SwitchParameter\r\nCaseSensitive          {Ca*}        Named    False     False    False  All             SwitchParameter\r\nContext                {Co*}        Named    False     False    False  All             Int32[]\r\nEncoding               {En*}        Named    False     False    False  All             String\r\nExclude                {Ex*}        Named    False     False    False  All             String[]\r\nInclude                {Inc*}       Named    False     False    False  All             String[]\r\nList                   {Lis*}       Named    False     False    False  All             SwitchParameter\r\nNotMatch               {N*}         Named    False     False    False  All             SwitchParameter\r\nPath                   {}           1        True      False    True   All             String[]\r\nPattern                {Patt*}      0        True      False    False  All             String[]\r\nQuiet                  {Q*}         Named    False     False    False  All             SwitchParameter\r\nSimpleMatch            {S*}         Named    False     False    False  All             SwitchParameter\r\n\r\n\r\n    Command: Microsoft.PowerShell.Utility/Select-String\r\n    Set:    Object\r\n\r\n\r\nName                   Aliases      Position Mandatory Pipeline ByName Provider        Type\r\n----                   -------      -------- --------- -------- ------ --------        ----\r\nAllMatches             {A*}         Named    False     False    False  All             SwitchParameter\r\nCaseSensitive          {Ca*}        Named    False     False    False  All             SwitchParameter\r\nContext                {Co*}        Named    False     False    False  All             Int32[]\r\nEncoding               {En*}        Named    False     False    False  All             String\r\nExclude                {Ex*}        Named    False     False    False  All             String[]\r\nInclude                {Inc*}       Named    False     False    False  All             String[]\r\nInputObject            {Inp*}       Named    True      True     False  All             PSObject\r\nList                   {Lis*}       Named    False     False    False  All             SwitchParameter\r\nNotMatch               {N*}         Named    False     False    False  All             SwitchParameter\r\nPattern                {Patt*}      0        True      False    False  All             String[]\r\nQuiet                  {Q*}         Named    False     False    False  All             SwitchParameter\r\nSimpleMatch            {S*}         Named    False     False    False  All             SwitchParameter\r\n\r\n\r\n    Command: Microsoft.PowerShell.Utility/Select-String\r\n    Set:    LiteralFile\r\n\r\n\r\nName                   Aliases      Position Mandatory Pipeline ByName Provider        Type\r\n----                   -------      -------- --------- -------- ------ --------        ----\r\nAllMatches             {A*}         Named    False     False    False  All             SwitchParameter\r\nCaseSensitive          {Ca*}        Named    False     False    False  All             SwitchParameter\r\nContext                {Co*}        Named    False     False    False  All             Int32[]\r\nEncoding               {En*}        Named    False     False    False  All             String\r\nExclude                {Ex*}        Named    False     False    False  All             String[]\r\nInclude                {Inc*}       Named    False     False    False  All             String[]\r\nList                   {Lis*}       Named    False     False    False  All             SwitchParameter\r\nLiteralPath            {PSPath, ... Named    True      False    True   All             String[]\r\nNotMatch               {N*}         Named    False     False    False  All             SwitchParameter\r\nPattern                {Patt*}      0        True      False    False  All             String[]\r\nQuiet                  {Q*}         Named    False     False    False  All             SwitchParameter\r\nSimpleMatch            {S*}         Named    False     False    False  All             SwitchParameter\r\n```\r\n`Path` and `LiteralPath` are pipeline bound by property name and are of type string[].  `InputObject` is bound by value and is of type PSObject.  Somehow Select-String takes both string input to search through (bound to InputObject) and FileInfo objects from Get-ChildItem/Item.",
      "created_at": "2017-03-23T15:37:57Z",
      "updated_at": "2017-03-23T15:37:57Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@TravisEz13 I have my hands full and thus re-assigned this PR to you. Could you please help drive it?",
      "created_at": "2017-06-23T15:58:40Z",
      "updated_at": "2017-06-23T18:05:44Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "I'll continue on next week.",
      "created_at": "2017-06-23T17:47:36Z",
      "updated_at": "2017-06-23T17:47:36Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@iSazonov No rush at all \ud83d\ude04 I was the assignee previously but I have too much on my plate right now and thus I reassigned this PR to Travis. That comment is just to let Travis know.",
      "created_at": "2017-06-23T18:03:03Z",
      "updated_at": "2017-06-23T18:05:34Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "@iSazonov We should close inactive PRs and reopen the PR when it's active.  Any issues?",
      "created_at": "2017-07-21T17:30:42Z",
      "updated_at": "2017-07-21T17:30:42Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "I'm going to give my time and finish my work.",
      "created_at": "2017-07-21T18:07:53Z",
      "updated_at": "2017-07-21T18:07:53Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Ready for a code review.\r\nI corrected the PR desciption and cleaned up test.\r\nWe have a conflict with #4119 for Encoding parameter.\r\n",
      "created_at": "2017-07-24T13:55:36Z",
      "updated_at": "2017-07-24T13:55:36Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "Please use the present tense, imperative style for commit messages and title per [Contribution Guide](https://github.com/PowerShell/PowerShell/blob/7a8589a8c516c3048b4555415b9ac13a24b6d6ed/.github/CONTRIBUTING.md#pull-request-submission)",
      "created_at": "2017-07-24T19:30:39Z",
      "updated_at": "2017-07-24T19:30:39Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "@BerheAbrha  Can you review to ensure this won't cause issues for PowerShell DSC?",
      "created_at": "2017-07-24T19:43:53Z",
      "updated_at": "2017-07-24T19:43:53Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "You have a test error in travis-ci",
      "created_at": "2017-07-25T16:21:18Z",
      "updated_at": "2017-07-25T16:21:18Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "@iSazonov  Can you fix the test issue?  Or can I close this until it's ready to be reviewed?",
      "created_at": "2017-08-04T22:07:30Z",
      "updated_at": "2017-08-04T22:07:30Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@TravisEz13 It is not test issue - it is temporary CI issue.",
      "created_at": "2017-08-05T20:24:08Z",
      "updated_at": "2017-08-05T20:24:08Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "@iSazonov If it happens again, ping someone one of the maintainers and we can restart the run.",
      "created_at": "2017-08-07T16:35:04Z",
      "updated_at": "2017-08-07T16:35:04Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@iSazonov himself is a maintainer now \ud83d\ude04 ",
      "created_at": "2017-08-07T16:37:00Z",
      "updated_at": "2017-08-07T16:37:00Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "I have no idea how to do it. Now I rename the last commit to restart CIs.",
      "created_at": "2017-08-08T02:57:15Z",
      "updated_at": "2017-08-08T02:57:15Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "@TravisEz13 Can we give Ilya permission to AppVeyor and Travis CI? I'm not sure if that requires one to be a member of PowerShell Org ...",
      "created_at": "2017-08-08T23:02:48Z",
      "updated_at": "2017-08-08T23:02:48Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "AppVeyor yes for this I need an email address associated with his GitHub account.  Travis-CI simply inherits permissions from github.  We should discuss this offline.",
      "created_at": "2017-08-11T17:19:21Z",
      "updated_at": "2017-08-11T17:19:21Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "@iSazonov merge conflicts need to be resolved",
      "created_at": "2017-12-15T23:53:52Z",
      "updated_at": "2017-12-15T23:53:52Z"
    },
    {
      "author": "TravisEz13",
      "author_association": "MEMBER",
      "body": "Tests are failing",
      "created_at": "2018-01-03T18:52:28Z",
      "updated_at": "2018-01-03T18:52:28Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "This is too old code. I will update it.",
      "created_at": "2018-01-04T18:02:31Z",
      "updated_at": "2018-01-04T18:02:31Z"
    },
    {
      "author": "stale[bot]",
      "author_association": "NONE",
      "body": "This PR has been automatically marked as stale because it has not had activity in the last 30 days. It will be closed if no further activity occurs within 10 days. Thank you for your contributions.\n",
      "created_at": "2018-03-16T23:47:25Z",
      "updated_at": "2018-03-16T23:47:25Z"
    },
    {
      "author": "stale[bot]",
      "author_association": "NONE",
      "body": "This PR has be automatically close because it is stale. If you wish to continue working on the PR, please first update the PR, then reopen it.\nThanks again for your contribution.\nCommunity members are welcome to grab these works.\n",
      "created_at": "2018-03-27T00:39:24Z",
      "updated_at": "2018-03-27T00:39:24Z"
    }
  ],
  "created_at": "2017-03-22T13:36:17Z",
  "number": 3395,
  "state": "closed",
  "title": "WIP - Implement Get-Hash cmdlet",
  "updated_at": "2020-05-15T13:27:28Z"
}
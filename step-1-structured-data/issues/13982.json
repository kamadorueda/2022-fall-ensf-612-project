{
  "_url": "https://github.com/PowerShell/PowerShell/issues/13982",
  "author": "GongT",
  "body": "## Steps to reproduce\r\n\r\n```powershell\r\n$DownloadFrom = 'https://github.com/PowerShell/PowerShell/releases/download/v7.1.0-rc.2/PowerShell-7.1.0-rc.2-win-x64.msi'\r\nInvoke-WebRequest -Resume -OutFile: 'D:/Test/pwsh.msi' -MaximumRetryCount 10 -RetryIntervalSec 5 -UserAgent gongt/test -Uri $DownloadFrom\r\n```\r\n\r\n## Expected behavior\r\n\r\nwork as [document](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/invoke-webrequest?view=powershell-7):\r\n\r\n*If the local file size is the same as the remote file size, then no action is taken and the cmdlet assumes the download already complete.*\r\n\r\n## Actual behavior\r\n\r\nIf the local file size is the same as the remote file size, got an error:\r\n```diff\r\n- Invoke-WebRequest: Object reference not set to an instance of an object.\r\n```\r\n\r\nValue of `$_.Exception`:\r\n```text\r\nSystem.NullReferenceException: Object reference not set to an instance of an object.\r\n   at Microsoft.PowerShell.Commands.WebRequestPSCmdlet.GetResponse(HttpClient client, HttpRequestMessage request, Boolean keepAuthorization)\r\n   at Microsoft.PowerShell.Commands.WebRequestPSCmdlet.ProcessRecord()\r\n   at System.Management.Automation.Cmdlet.DoProcessRecord()\r\n   at System.Management.Automation.CommandProcessor.ProcessRecord()\r\n```\r\n\r\n## Environment data\r\n\r\n<details>\r\n  <summary>Host 1 - Linux + 7.0.3</summary>\r\n<pre>\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.0.3\r\nPSEdition                      Core\r\nGitCommitId                    7.0.3\r\nOS                             Linux 5.8.13-200.fc32.x86_64 #1 SMP Thu Oct 1 21:49:42 UTC 2020\r\nPlatform                       Unix\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n</pre>\r\n</details>\r\n\r\n\r\n<details>\r\n  <summary>Host 2 - Windows + 7.0.3</summary>\r\n<pre>\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.0.3\r\nPSEdition                      Core\r\nGitCommitId                    7.0.3\r\nOS                             Microsoft Windows 10.0.19041\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n</pre>\r\n</details>\r\n\r\n\r\n<details>\r\n  <summary>Host 2 - Windows + 7.1.0-rc2</summary>\r\n<pre>\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.1.0-rc.2\r\nPSEdition                      Core\r\nGitCommitId                    7.1.0-rc.2\r\nOS                             Microsoft Windows 10.0.19041\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n</pre>\r\n</details>\r\n",
  "closed_at": "2022-04-09T01:12:50Z",
  "comments": [],
  "created_at": "2020-11-04T07:05:57Z",
  "labels": [
    "Issue-Bug",
    "WG-Cmdlets-Utility"
  ],
  "number": 13982,
  "state": "closed",
  "title": "\"Invoke-WebRequest -Resume\" fail when local size = remote",
  "updated_at": "2022-04-09T01:12:50Z"
}
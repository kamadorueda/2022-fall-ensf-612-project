{
  "_url": "https://github.com/PowerShell/PowerShell/issues/7742",
  "author": "SteveL-MSFT",
  "body": "## PR Summary\r\n\r\nCurrently, the MSI installer does a check to see if version of pwrshplugin.dll is compatible with PSCore6.  This requires WMF4 or newer.  If the check fails, the installer fails.  However, there are valid use cases where the user may not care about WinRM based remoting.  Fix is to change this to a warning message and also disable the checkbox to enable PSRemoting.\r\n\r\n![Screenshot](https://i.imgur.com/jXSth4B.png)\r\n\r\n## PR Checklist\r\n\r\n- [x] [PR has a meaningful title](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n    - Use the present tense and imperative mood when describing your changes\r\n- [x] [Summarized changes](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [x] [Change is not breaking](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#making-breaking-changes)\r\n- [x] [Make sure all `.h`, `.cpp`, `.cs`, `.ps1` and `.psm1` files have the correct copyright header](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n- [ ] This PR is ready to merge and is not [Work in Progress](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---work-in-progress).\r\n    - If the PR is work in progress, please add the prefix `WIP:` to the beginning of the title and remove the prefix when the PR is ready.\r\n- **User-facing changes**\r\n    - [x] Not Applicable\r\n    - **OR**\r\n    - [ ] User-facing [Documentation needed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#pull-request---submission)\r\n        - [ ] Issue filed - Issue link:\r\n- **Testing - New and feature**\r\n    - [x] Not Applicable or can only be tested interactively\r\n    - **OR**\r\n    - [ ] [Make sure you've added a new test if existing tests do not effectively test the code changed](https://github.com/PowerShell/PowerShell/blob/master/.github/CONTRIBUTING.md#before-submitting)\r\n        - [ ] [Add `[feature]` if the change is significant or affects feature tests](https://github.com/PowerShell/PowerShell/blob/master/docs/testing-guidelines/testing-guidelines.md#requesting-additional-tests-for-a-pr)\r\n",
  "closed_at": "2018-11-02T16:38:03Z",
  "comments": [
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "cc @bergmeister to help review",
      "created_at": "2018-09-08T01:51:28Z",
      "updated_at": "2018-09-08T01:51:28Z"
    },
    {
      "author": "alexandair",
      "author_association": "CONTRIBUTOR",
      "body": "Warning message:\r\n\"...required to enable PowerShell remoting over...\"",
      "created_at": "2018-09-08T07:54:05Z",
      "updated_at": "2018-09-08T07:54:05Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Could we make the link clickable?\r\nhttps://stackoverflow.com/questions/36717215/how-to-add-a-url-link-in-wix-installer",
      "created_at": "2018-09-10T07:03:32Z",
      "updated_at": "2018-09-10T07:07:18Z"
    },
    {
      "author": "bergmeister",
      "author_association": "CONTRIBUTOR",
      "body": "@iSazonov I remember that getting clickable hyperlinks to work in the past was not possible, but [this](https://stackoverflow.com/a/45813037/1810304) thread indicates that WiX 3.11 added this capability.",
      "created_at": "2018-09-10T12:40:56Z",
      "updated_at": "2018-09-10T16:30:25Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@iSazonov there is a hyperlink type control, but it's very limited.  I tried it and the main problem is that you don't have control of the font (compared to a text control).  So you have black text with blue hyperlink and the background can't be transparent (again, compared to a text control) and is white.\r\n\r\n@bergmeister the pop-up proved to be more difficult as Wix doesn't \"natively\" support such a thing and I'd have to create a custom dialog.  I tried it and the dialog was much more intrusive.  As for the location of the text, I originally wanted it right below the relevant checkbox, but, as far as I know, the control locations are static so when the text doesn't show, there would be a gap between the last two checkboxes.  I could rearrange the order of the checkboxes so that the `Enable Remoting` one is last.",
      "created_at": "2018-09-10T16:21:31Z",
      "updated_at": "2018-09-10T16:21:31Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "If the PR is targeted on 6.1.0 GA I believe we should merge \"as is\". Any other enhancement carries a risk to break something.",
      "created_at": "2018-09-10T17:04:02Z",
      "updated_at": "2018-09-10T17:04:02Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@iSazonov this is not required for GA.  We can take it for 6.2.  Anyone who wants to install PSCore6 and not WMF4 on downlevel can use the .zip pkg today.",
      "created_at": "2018-09-10T17:08:52Z",
      "updated_at": "2018-09-10T17:08:52Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "Then I suggest to insert pre-request check step on first place and accumulate all pre-request checks there like WMF4, libssl and so on. Results can be in text log. With a button to show. With blocking Next if the checks failed.",
      "created_at": "2018-09-10T17:43:47Z",
      "updated_at": "2018-09-10T17:43:47Z"
    },
    {
      "author": "anmenaga",
      "author_association": "CONTRIBUTOR",
      "body": "I restarted 'PowerShell-CI-linux' test run.",
      "created_at": "2018-09-10T18:15:40Z",
      "updated_at": "2018-09-10T18:15:40Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@iSazonov that's a good suggestion, we can use a warning icon for warnings and a red X for any blocking pre-reqs.  Let me think more about this after 6.1 GA.",
      "created_at": "2018-09-10T21:15:38Z",
      "updated_at": "2018-09-10T21:15:38Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "@SteveL-MSFT I know Exchange Server team use that in their installer.",
      "created_at": "2018-09-11T04:38:47Z",
      "updated_at": "2018-09-11T04:39:06Z"
    },
    {
      "author": "stale[bot]",
      "author_association": "NONE",
      "body": "This PR has been automatically marked as stale because it has not had activity in the last 30 days. It will be closed if no further activity occurs within 10 days.\nThank you for your contributions.\nCommunity members are welcome to grab these works.\n",
      "created_at": "2018-10-11T23:36:44Z",
      "updated_at": "2018-10-11T23:36:44Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "We could look WiX Bootstrapper.",
      "created_at": "2018-10-12T09:33:11Z",
      "updated_at": "2018-10-12T09:33:11Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "WiX Bootstrapper appears to help install dependencies.  However, it seems there's a set of users who want to use PSCore6 w/o installing WMF4 so I don't think the Bootstrapper will help here.  It would help with other dependencies that are required for .Net Core.",
      "created_at": "2018-11-02T03:50:59Z",
      "updated_at": "2018-11-02T03:50:59Z"
    },
    {
      "author": "iSazonov",
      "author_association": "COLLABORATOR",
      "body": "> there's a set of users who want to use PSCore6 w/o installing WMF4\r\n\r\nIs this supported? I think such users should install from zip, yes?",
      "created_at": "2018-11-02T04:57:11Z",
      "updated_at": "2018-11-02T04:57:11Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@iSazonov actually, that is an excellent point!  I agree that non-standard use should use the zip.  So in that case, we should look at Bootstrapper to help with pre-reqs.  I'm closing this PR and opened issue https://github.com/PowerShell/PowerShell/issues/8176",
      "created_at": "2018-11-02T16:38:03Z",
      "updated_at": "2018-11-02T16:38:03Z"
    },
    {
      "author": "bergmeister",
      "author_association": "CONTRIBUTOR",
      "body": "@SteveL-MSFT I think this PR would still be a change for the better for the moment since it is not blocking the whole installation any more but only the remoting bit. Does relying on the bootstrapper mean that we would also rely on the user having an Internet connection (that might not be available in certain environments or blocked)?",
      "created_at": "2018-11-02T19:24:30Z",
      "updated_at": "2018-11-02T19:24:30Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@bergmeister that is a good point about offline installs.  The Bootstrapper has capability to check for files before doing an install of a pre-req.  This means that if the customer has pre-installed the pre-reqs, then the Bootstrapper becomes a no-op.  It seems like the zip is sufficient for edge cases like where the user doesn't care about remoting.  If this is really a mainstream case and not an edge case, we can certainly revisit this.",
      "created_at": "2018-11-02T22:54:47Z",
      "updated_at": "2018-11-02T22:54:47Z"
    }
  ],
  "created_at": "2018-09-08T01:47:36Z",
  "number": 7742,
  "state": "closed",
  "title": "WIP: Change WMF4 pre-req check in MSI installer to a warning",
  "updated_at": "2020-03-10T21:01:06Z"
}
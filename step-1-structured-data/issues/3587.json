{
  "_url": "https://github.com/PowerShell/PowerShell/issues/3587",
  "author": "iSazonov",
  "body": "After moving to .Net Core 2.0 I build PowerShell by `Start-PSBuild -Clean`, I can build successfully but PowerShell dont start:\r\n```\r\nPowerShell\r\nCopyright (C) Microsoft Corporation. All rights reserved.\r\n\r\nThe shell cannot be started. A failure occurred during initialization:\r\nCould not load file or assembly 'Microsoft.CSharp, Version=4.0.3.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'. The system cannot find the file specified.\r\n\r\n```\r\n\r\nI see in AddType.cs \"Microsoft.CSharp, Version=4.0.0.0\" but in autogenerated CorePSTypeCatalog.cs \"Microsoft.CSharp, Version=4.0.3.0\"\r\n\r\nAlso in ActivityGenerator.cs and WebServiceProxy.cs we would mask `using Microsoft.CSharp;` by `#if !CORECLR`.\r\n\r\n/cc @daxian-dbw \r\n\r\n",
  "closed_at": "2017-04-18T20:12:36Z",
  "comments": [
    {
      "author": "anmenaga",
      "author_association": "CONTRIBUTOR",
      "body": "+1\r\nI observe the same initialization error on Windows 10 Enterprise.",
      "created_at": "2017-04-18T14:22:01Z",
      "updated_at": "2017-04-18T14:22:01Z"
    },
    {
      "author": "SteveL-MSFT",
      "author_association": "MEMBER",
      "body": "@daxian-dbw tells me this is a bug in dotnet, current workaround is to always use `-publish`",
      "created_at": "2017-04-18T16:50:43Z",
      "updated_at": "2017-04-18T16:50:43Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "When not specifying `-publish` with `Start-PSBuild` (using 'dotnet build'), the TPA list used by the host powershell.exe (dotnet.exe actually) contains a path to the incorrect `Microsoft.CSharp.dll`, which is of version `4.0.2.0`.\r\nI'm about to update the build script to always use `dotnet publish`. I will also open an issue in dotnet/corefx or dotnet/cli.",
      "created_at": "2017-04-18T16:52:37Z",
      "updated_at": "2017-04-18T16:52:37Z"
    },
    {
      "author": "daxian-dbw",
      "author_association": "MEMBER",
      "body": "The dotnet/cli issue is https://github.com/dotnet/cli/issues/6352",
      "created_at": "2017-04-18T17:43:53Z",
      "updated_at": "2017-04-18T17:43:53Z"
    },
    {
      "author": "adityapatwardhan",
      "author_association": "MEMBER",
      "body": "When using -publish I can successfully build and launch powershell. But launching using Start-DevPowershell does not work. It does not point to the publish directory. ",
      "created_at": "2017-04-18T19:00:39Z",
      "updated_at": "2017-04-18T19:00:39Z"
    }
  ],
  "created_at": "2017-04-18T13:44:34Z",
  "labels": [
    "Issue-Question",
    "Resolution-Fixed"
  ],
  "number": 3587,
  "state": "closed",
  "title": "Could not load file or assembly 'Microsoft.CSharp",
  "updated_at": "2017-04-20T14:02:50Z"
}